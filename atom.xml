<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Hexo</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://hus96r.coding-pages.com/"/>
  <updated>2020-05-27T03:32:14.488Z</updated>
  <id>https://hus96r.coding-pages.com/</id>
  
  <author>
    <name>BIX</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>2020å¹´DASCTFäº”æœˆçº¿ä¸Šèµ›</title>
    <link href="https://hus96r.coding-pages.com/2020/05/23/2020%E5%B9%B4DASCTF%E4%BA%94%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/"/>
    <id>https://hus96r.coding-pages.com/2020/05/23/2020%E5%B9%B4DASCTF%E4%BA%94%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/</id>
    <published>2020-05-23T12:00:53.000Z</published>
    <updated>2020-05-27T03:32:14.488Z</updated>
    
    <content type="html"><![CDATA[<h3 id="ViQinere"><a href="#ViQinere" class="headerlink" title="ViQinere"></a>ViQinere</h3><ul><li><p>64ä½elfæ–‡ä»¶, è½½å…¥idaåå‘ç°ä¸ä»¥å¾€çš„ä¸åŒ. å¾ˆå¤šå‡½æ•°éƒ½æ²¡æ˜¾ç¤ºå‡ºæ¥.</p></li><li><p>linuxä¸­è¿è¡Œä¸€ä¸‹, æ˜¾ç¤ºå¯¹flagåŠ å¯†, ç„¶åæ˜¯ä¸€äº›ä¹±ç .  åæ¥ç¾¤é‡Œé€šçŸ¥, è¿™ä¸ªæ˜¯æœ‰é¶æœºçš„.</p></li><li><p>ncè¿æ¥ä¸€ä¸‹, é‚£é¢˜ç›®çš„flagå°±æ˜¯å­˜æ”¾åœ¨æœ¬åœ°çš„, æ–‡ä»¶æ“ä½œå–å‡ºflag, ç»è¿‡åŠ å¯†. <img src="/2020/05/23/2020%E5%B9%B4DASCTF%E4%BA%94%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200523203121150.png" alt="image-20200523203121150"></p><a id="more"></a></li><li><p>æ¥ç€å†åœ¨idaä¸­çœ‹ä¸€ä¸‹, æœ‰å‡ ä¸ªå­—ç¬¦å¾ˆæ‡µ, åé¢æ‰å‘ç°å°±æ˜¯æ”¹å˜è¾“å‡ºå­—ç¬¦ä¸²æ ·å¼, è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆlinuxä¸­è¿è¡Œçš„æ—¶å€™ä¼šæœ‰æ¶‚é¸¦ä¸é—ªåŠ¨, <img src="/2020/05/23/2020%E5%B9%B4DASCTF%E4%BA%94%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200523204020172.png" alt="image-20200523204020172"></p></li><li><p>ç„¶åæ˜¯è¢«æ¶‚é¸¦çš„é‚£ä¸€æ®µå‘äº†, æ˜¾ç¤º <strong>Flag was encrypted by <a href="http://cc.TaQini.space" target="_blank" rel="noopener">http://cc.TaQini.space</a></strong> , ä¸€ç›´ä»¥ä¸ºåŠ å¯†å’Œè¿™ä¸ªæœ‰å…³,  å—¯â€¦åæ¥å‘ç°æ˜¯é¢˜ç›®ä½œè€…ç»™è‡ªå·±æ‰“çš„å¹¿å‘Š. </p></li><li><p>è™½ç„¶å¾ˆå¤šå‡½æ•°ä¸èƒ½æ˜¾ç¤ºå‡ºæ¥, ä½†ä¹Ÿæ˜¯èƒ½çŒœå‡ºæ¥ä½œç”¨. çœ‹çœ‹æ±‡ç¼–ä¼šæ›´æ¸…æ¥š. </p></li><li><p>æœ€åæ‰¾åˆ°åŠ å¯†å‡½æ•° <strong>sub_1249((__int64)byte_4080);</strong>, è¿™ä¸‹å°±å¥½åŠäº†.   è¿›å»å‡½æ•°å¯ä»¥çŸ¥é“, å¤§å†™å­—æ¯åŠ å¯†ä¸ºå¤§å†™å­—æ¯, å°å†™å­—æ¯åŠ å¯†ä¸ºå°å†™å­—æ¯, å…¶ä»–å­—ç¬¦ä¸å˜.<img src="/2020/05/23/2020%E5%B9%B4DASCTF%E4%BA%94%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200523204833774.png" alt="image-20200523204833774"></p></li><li><p>å¯¹äºé€†è¿™ä¸ªç®—æ³•, æ²¡æœ‰è¿‡å¤šçš„æƒ³, ç®—æ˜¯ç›´æ¥ç©·å°½çš„å§(ç®—æ³•å¤ªèœ).  å› ä¸ºå¤§å†™å­—æ¯å˜å¤§å†™å­—æ¯,å°å†™å­—æ¯å˜å°å†™å­—æ¯.</p></li><li><p>ä¸Šexp: </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sub_1209</span><span class="params">(<span class="keyword">int</span> a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(a &gt;= <span class="number">97</span> &amp;&amp; a &lt;= <span class="number">122</span>)</span><br><span class="line"><span class="keyword">return</span> a<span class="number">-97</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(a &gt;= <span class="number">65</span> &amp;&amp; a &lt;= <span class="number">90</span>)</span><br><span class="line"><span class="keyword">return</span> (a<span class="number">-65</span>)^<span class="number">0xFFFFFF80</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">return</span> a; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, v4 = <span class="number">0</span>, j = <span class="number">0</span>, v2 = <span class="number">0</span>, v5 = <span class="number">0</span>, v1 = <span class="number">0</span>; </span><br><span class="line"><span class="keyword">char</span> a[<span class="number">26</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">char</span> b[] = <span class="string">"TaQini"</span>;</span><br><span class="line"><span class="keyword">char</span> c[] = <span class="string">"FQD&#123;GfjuJ5UbLrWjZjpvErXkiAZzlvO0xTa!cwnLLAsy3B0iEvEy&#125;"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">a[i] = <span class="number">122</span>-i;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(c); i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>((c[i] &gt;= <span class="number">97</span> &amp;&amp; c[i] &lt;= <span class="number">122</span>))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">97</span>; j &lt;= <span class="number">122</span>; j++)</span><br><span class="line">&#123;</span><br><span class="line">v4 = sub_1209(j);</span><br><span class="line">v2 = sub_1209(b[v5 &amp; <span class="number">5</span>]);</span><br><span class="line"><span class="keyword">if</span>(c[i] == a[((v2&amp;<span class="number">0x7F</span>) + v4)%<span class="number">26</span>])</span><br><span class="line">&#123;</span><br><span class="line">c[i] = j;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125; </span><br><span class="line">v5++; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(c[i] &gt;= <span class="number">65</span> &amp;&amp; c[i] &lt;= <span class="number">90</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">65</span>; j &lt;= <span class="number">90</span>; j++)</span><br><span class="line">&#123;</span><br><span class="line">v4 = sub_1209(j);</span><br><span class="line">v1 = sub_1209(b[v5 &amp; <span class="number">5</span>]);</span><br><span class="line"><span class="keyword">if</span>(c[i] == a[(v4+(v1 &amp; <span class="number">0x7F</span>) + <span class="number">128</span>)%<span class="number">26</span>] - <span class="number">32</span>)</span><br><span class="line">&#123;</span><br><span class="line">c[i] = j;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125; </span><br><span class="line">v5++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(c);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>æœ€åè¡¥å……ä¸€ä¸‹å¯¹æ”¹å˜è¾“å‡ºå­—ç¬¦ä¸²çš„çŸ¥è¯†. ä¹Ÿæ˜¯åé¢å‡ºé¢˜å¸ˆå‚… <strong>TaQini</strong> å‘çš„.</p><table><thead><tr><th>\033[0m</th><th>å…³é—­æ‰€æœ‰å±æ€§</th></tr></thead><tbody><tr><td><strong>\033[01m</strong></td><td><strong>è®¾ç½®é«˜äº®åº¦</strong></td></tr><tr><td><strong>\033[04m</strong></td><td><strong>ä¸‹åˆ’çº¿</strong></td></tr><tr><td><strong>\033[05m</strong></td><td><strong>é—ªçƒ</strong></td></tr><tr><td><strong>\033[07m</strong></td><td><strong>åæ˜¾</strong></td></tr><tr><td><strong>\033[08m</strong></td><td><strong>æ¶ˆéš</strong></td></tr><tr><td><strong>\033[30m â€“ \033[37m</strong></td><td><strong>è®¾ç½®å‰æ™¯è‰²</strong></td></tr><tr><td><strong>\033[40m â€“ \033[47m</strong></td><td><strong>è®¾ç½®èƒŒæ™¯è‰²</strong></td></tr><tr><td><strong>\033[nA</strong></td><td><strong>å…‰æ ‡ä¸Šç§»nè¡Œ</strong></td></tr><tr><td><strong>\033[nB</strong></td><td><strong>å…‰æ ‡ä¸‹ç§»nè¡Œ</strong></td></tr><tr><td><strong>\033[nC</strong></td><td><strong>å…‰æ ‡å³ç§»nè¡Œ</strong></td></tr><tr><td><strong>\033[nD</strong></td><td><strong>å…‰æ ‡å·¦ç§»n</strong></td></tr><tr><td><strong>\033[y;xH</strong></td><td><strong>è®¾ç½®å…‰æ ‡ä½ç½®</strong></td></tr><tr><td><strong>\033[2J</strong></td><td><strong>æ¸…å±</strong></td></tr><tr><td><strong>\033[K</strong></td><td><strong>æ¸…é™¤ä»å…‰æ ‡åˆ°è¡Œå°¾çš„å†…å®¹</strong></td></tr><tr><td><strong>\033[s</strong></td><td><strong>ä¿å­˜å…‰æ ‡ä½ç½®</strong></td></tr><tr><td><strong>\033[u</strong></td><td><strong>æ¢å¤å…‰æ ‡ä½ç½®</strong></td></tr><tr><td><strong>\033[?25l</strong></td><td><strong>éšè—å…‰æ ‡</strong></td></tr><tr><td><strong>\033[?25h</strong></td><td><strong>æ˜¾ç¤ºå…‰æ ‡</strong></td></tr></tbody></table></li><li><p><strong>æ€»ç»“: é¢˜æœ¬æ¥å¾ˆç®€å•, ä¸»è¦å‡ æ¬¡è¢«å¸¦å…¥å‘. ä¹Ÿæ˜¯æ²¡ç»éªŒå§.</strong></p></li></ul><hr><h3 id="MiscVm"><a href="#MiscVm" class="headerlink" title="MiscVm"></a>MiscVm</h3><ul><li><p>ä¸‹è½½ä¸‹æ¥, 64ä½çš„æ— å£³elfæ–‡ä»¶å’Œä¸€ä¸ªæ“ä½œç æ–‡ä»¶.  æ“ä½œç å…¶å®é¢˜ä¸­ä¹Ÿæœ‰, è¿™é‡Œå•ç‹¬ç»™äº†æ–¹ä¾¿å¾ˆå¤š.</p></li><li><p>è½½å…¥ida. C++é€†å‘ç±»çš„, ä½†è¿˜å¥½éƒ½æ˜¯å¾ˆåŸºæœ¬çš„è¯­æ³•. <img src="/2020/05/23/2020%E5%B9%B4DASCTF%E4%BA%94%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200524075414831.png" alt="image-20200524075414831"></p></li><li><p>åˆ†åˆ«è¿›å»ä¸‰ä¸ªåŠ å¯†å‡½æ•°. ç¬¬ä¸€ä¸ª: <strong>sub_19E2((int64)&amp;v13</strong>, (__int64)&amp;v14);å¾ˆç®€å•,   å°±æ˜¯ 2ä¸ªæ•°çš„å€¼äº¤æ¢.</p><p><img src="/2020/05/23/2020%E5%B9%B4DASCTF%E4%BA%94%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200524075631032.png" alt="image-20200524075631032"></p></li><li><p>ç¬¬äºŒä¸ª: <strong>sub_1551((int64)&amp;v14, (int64)&amp;v13);</strong>,  å°±æ˜¯æŒ‰ç…§ç»™å®šé¡ºåºè¿›è¡Œç®€å•çš„å€¼äº¤æ¢.</p><p><img src="/2020/05/23/2020%E5%B9%B4DASCTF%E4%BA%94%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200524075954652.png" alt="image-20200524075954652"></p></li><li><p>ç¬¬ä¸‰ä¸ª: <strong>v8 = (unsigned int)sub_EEC(&amp;v14, &amp;v15, 0LL) != 0</strong>,   è¿™ä¸ªç›¸å¯¹äºè¦éº»çƒ¦ä¸€äº›, ä½†åˆ†æä¸€ä¸‹, æ€è·¯ç†æ¸…, é€†å›å»å°±å¥½äº†.</p><p><img src="/2020/05/23/2020%E5%B9%B4DASCTF%E4%BA%94%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200524083055817.png" alt="image-20200524083055817"></p></li><li><p>exp: Cè¯­è¨€å†™çš„, æ¯”è¾ƒå†—é•¿. </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">decode_4</span><span class="params">(<span class="keyword">int</span> a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>, temp = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">2000</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">j = i;</span><br><span class="line"></span><br><span class="line">j ^= <span class="number">10</span>;</span><br><span class="line">temp = (<span class="number">16</span>*j &gt;&gt; <span class="number">31</span>)&gt;&gt;<span class="number">28</span>;</span><br><span class="line"><span class="keyword">if</span>(a == j + (((temp + <span class="number">16</span>*(*(<span class="keyword">char</span> *)&amp;j))&amp;<span class="number">0xF</span>)-temp))</span><br><span class="line"><span class="keyword">break</span>; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">union</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ida_chars[<span class="number">152</span>];</span><br><span class="line"><span class="keyword">int</span> a[<span class="number">37</span>];</span><br><span class="line">&#125;A = &#123;</span><br><span class="line">   <span class="number">66</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">74</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">68</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>, <span class="number">123</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">51</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">  <span class="number">112</span>,   <span class="number">3</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">70</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">212</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">60</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">16</span>,   <span class="number">6</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">79</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">200</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">108</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">32</span>,   <span class="number">3</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">30</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">  <span class="number">144</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">111</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">48</span>,   <span class="number">6</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">70</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">144</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">59</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">16</span>,   <span class="number">6</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">29</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>, <span class="number">196</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">62</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">96</span>,   <span class="number">6</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">75</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">208</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>, <span class="number">108</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">16</span>,   <span class="number">3</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">70</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">136</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">51</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>, <span class="number">112</span>,   <span class="number">3</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">76</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">  <span class="number">204</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">125</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">36</span>, temp = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> d[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;, e[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> a1[<span class="number">100</span>] = &#123;<span class="number">3</span>,<span class="number">6</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">11</span>,<span class="number">1</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">6</span>,<span class="number">10</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">11</span>,<span class="number">1</span>,<span class="number">6</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">14</span>,<span class="number">1</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">9</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">6</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">9</span>,<span class="number">36</span>,<span class="number">3</span>,<span class="number">6</span>,<span class="number">36</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">3</span>,<span class="number">6</span>,<span class="number">5</span>,<span class="number">10</span>,<span class="number">9</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">10</span>,<span class="number">9</span>,<span class="number">3</span>,<span class="number">6</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">11</span>,<span class="number">1</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">6</span>,<span class="number">10</span>,<span class="number">9</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> b[<span class="number">100</span>] = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">19</span>,<span class="number">31</span>,<span class="number">25</span>,<span class="number">14</span>,<span class="number">23</span>,<span class="number">33</span>,<span class="number">13</span>,<span class="number">9</span>,<span class="number">24</span>,<span class="number">6</span>,<span class="number">26</span>,<span class="number">34</span>,<span class="number">17</span>,<span class="number">10</span>,<span class="number">8</span>,<span class="number">29</span>,<span class="number">12</span>,<span class="number">15</span>,<span class="number">22</span>,<span class="number">11</span>,<span class="number">18</span>,<span class="number">16</span>,<span class="number">32</span>,<span class="number">28</span>,<span class="number">21</span>,<span class="number">36</span>,<span class="number">20</span>,<span class="number">7</span>,<span class="number">5</span>,<span class="number">27</span>,<span class="number">30</span>,<span class="number">35</span>,<span class="number">37</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> c[<span class="number">100</span>] = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">31</span>,<span class="number">29</span>,<span class="number">7</span>,<span class="number">35</span>,<span class="number">14</span>,<span class="number">21</span>,<span class="number">9</span>,<span class="number">16</span>,<span class="number">27</span>,<span class="number">18</span>,<span class="number">25</span>,<span class="number">10</span>,<span class="number">20</span>,<span class="number">15</span>,<span class="number">17</span>,<span class="number">22</span>,<span class="number">28</span>,<span class="number">26</span>,<span class="number">36</span>,<span class="number">33</span>,<span class="number">32</span>,<span class="number">5</span>,<span class="number">8</span>,<span class="number">12</span>,<span class="number">23</span>,<span class="number">34</span>,<span class="number">13</span>,<span class="number">30</span>,<span class="number">24</span>,<span class="number">11</span>,<span class="number">19</span>,<span class="number">6</span>,<span class="number">37</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(i &gt;= <span class="number">-87</span>)</span><br><span class="line"><span class="keyword">switch</span>(a1[<span class="number">87</span>+i])</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">--j;</span><br><span class="line">--i;</span><br><span class="line">A.a[j] = (A.a[j] / <span class="number">16</span>)*<span class="number">2</span>;</span><br><span class="line">A.a[j] = A.a[j];</span><br><span class="line">A.a[j] /= <span class="number">2</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">A.a[j] -= <span class="number">128</span>;</span><br><span class="line">A.a[j] = A.a[j]*j;</span><br><span class="line">--i;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">A.a[++j] /= <span class="number">10</span>;</span><br><span class="line">--i;</span><br><span class="line"></span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">--j;</span><br><span class="line">--i;</span><br><span class="line">A.a[j] = decode_4(A.a[j]);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">A.a[j] = A.a[j];</span><br><span class="line">--i;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">A.a[j--] *= <span class="number">10</span>;</span><br><span class="line">--i;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">7</span>:</span><br><span class="line">A.a[j] -= <span class="number">128</span>;</span><br><span class="line">A.a[j] = ~A.a[j];</span><br><span class="line">--i;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">9</span>:</span><br><span class="line">--i;</span><br><span class="line">--j;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">10</span>:</span><br><span class="line">A.a[j] /= <span class="number">4</span>;</span><br><span class="line">--i;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">--i;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">  </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">37</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">d[c[i]<span class="number">-1</span>] = A.a[i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">37</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">e[b[i]<span class="number">-1</span>] = d[i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">4</span>; i &lt;= <span class="number">19</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">temp = e[i];</span><br><span class="line">e[i] = e[i+<span class="number">16</span>];</span><br><span class="line">e[i+<span class="number">16</span>] = temp;</span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">37</span>; i++)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%c"</span>, e[i]); </span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2020/05/23/2020%E5%B9%B4DASCTF%E4%BA%94%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200524083340342.png" alt="image-20200524083340342"></p></li><li><p><strong>æ€»ç»“: ç®—æ³•çš„é‡è¦æ€§</strong>.</p></li></ul><hr><h3 id="BScript"><a href="#BScript" class="headerlink" title="BScript"></a>BScript</h3><ul><li><p>æ„Ÿè§‰æœ‰ç‚¹æ„æ€.  ä¸»è¦å°±æ˜¯è€ƒå¯¹æ–‡ä»¶å†…å®¹çš„æå–, è¿˜æœ‰å°±æ˜¯æ‰¾è§„å¾‹!!!</p></li><li><p>ä¸‹è½½ä¸‹æ¥803ä¸ªexeæ–‡ä»¶.  éšä¾¿æ‰“å¼€ä¸€ä¸ªçœ‹è§ç®€å•çš„è¾“å…¥å¯¹æ¯”, å†æ‰“å¼€ä¸€ä¸ªè¿˜æ˜¯åŒæ ·çš„.ä½†æ²¡æœ‰å‘ç°ä¸è§£é¢˜ç›¸å…³çš„ä¸œè¥¿.</p></li><li><p>ä¹Ÿæ˜¯åé¢æƒ³ç€å†å»çœ‹çœ‹è¿™ä¸ªé¢˜æ‰å‘ç° æ¯ä¸ªexeæ–‡ä»¶è®©æˆ‘ä»¬è¾“å…¥çš„éƒ½æ˜¯ä¸€ä¸ªPEæ–‡ä»¶çš„ä¸€éƒ¨åˆ†, é‚£ ç†Ÿæ‚‰çš„ MZ(4D5A)å•Š.<img src="/2020/05/23/2020%E5%B9%B4DASCTF%E4%BA%94%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200524100310951.png" alt="image-20200524100310951"></p></li><li><p>æ¥ä¸‹æ¥å°±æ˜¯å»æ–‡ä»¶å†…å®¹äº†. ä½†æ˜¯æ¯ä¸ªç¨‹åºéƒ½æ˜¯åŠ äº†upxå£³çš„, å—¯å—¯..å› ä¸ºä¸ä¼šå†™è„šæœ¬å¼€å§‹è¿˜æƒ³æƒ³ç€æ‰‹åŠ¨å»æ, è¢«803ä¸ªç¨‹åºåŠé€€.</p></li><li><p>ç„¶åç”¨Cè¯­è¨€å†™äº†ä¸€ä¸ªä¸€ä¸ª.</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> a[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">83</span>; i &lt; <span class="number">804</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">sprintf</span>(a, <span class="string">"upx -d %d.exe"</span>, i);</span><br><span class="line">system(a);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2020/05/23/2020%E5%B9%B4DASCTF%E4%BA%94%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200524102949962.png" alt="image-20200524102949962"></p></li><li><p>ä¸‹é¢æå–æ¯ä¸ªç¨‹åºçš„ PEæ–‡ä»¶é‚£éƒ¨åˆ†çš„å†…å®¹. å¯æ˜¯æå®Œ, ä¿å­˜ä¸ºexeæ–‡ä»¶å, æ‰“ä¸å¼€â€¦idaéƒ½ä¸è¡Œ, çœ‹çœ‹äº†PEæ–‡ä»¶å†…å®¹å‘ç°åŒºæ®µéƒ½æ²¡æœ‰â€¦â€¦.</p></li><li><p>é‚£å°±æå–çš„å†…å®¹æœ‰é—®é¢˜, å¤šçœ‹äº†å‡ ä¸ªåŸæ¥çš„exeæ–‡ä»¶, å‘ç°æœç„¶ä¸ä¸€æ ·, æœ‰çš„æå–å†…å®¹çš„ä½ç½®ä¸ä¸€æ ·. ä½†803ä¸ªexeè®©æˆ‘æ€ä¹ˆæ‰¾â€¦</p></li><li><p>å¼€å§‹æ‰¾è§„å¾‹. åˆ—ä¸¾äº†å¾ˆå¤šè¿˜æ˜¯æ²¡å‘ç°. è¿™ä¹Ÿæ˜¯æœ¬é¢˜èŠ±è´¹æ—¶é—´æœ€å¤šçš„åœ°æ–¹â€¦â€¦..æ ¹æ®exeæ–‡ä»¶çš„å­—èŠ‚å¤§å°æ¥åŒºåˆ†â€¦æ”¹äº†ä¸€ä¸‹æå–å†…å®¹çš„ç¨‹åº.</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, n = <span class="number">779</span>, j = <span class="number">0</span>, lenth = <span class="number">0</span>; </span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> a[<span class="number">4000</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">FILE *fp = <span class="literal">NULL</span>;</span><br><span class="line"><span class="keyword">char</span> filename[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(n--)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">sprintf</span>(filename, <span class="string">"%d.exe"</span>, j++);</span><br><span class="line">fp = fopen(filename, <span class="string">"rb"</span>);</span><br><span class="line">fseek(fp, <span class="number">0</span>, SEEK_END);</span><br><span class="line">lenth = ftell(fp);</span><br><span class="line"><span class="keyword">if</span>(lenth == <span class="number">0xBDF1</span>)</span><br><span class="line">&#123;</span><br><span class="line">fseek(fp, <span class="number">0x1c20</span>, <span class="number">0</span>);</span><br><span class="line">fread(a, <span class="number">1</span>, <span class="number">0x20</span>, fp);</span><br><span class="line">fclose(fp);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%02X"</span>, a[i]);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">fseek(fp, <span class="number">0x1C40</span>, <span class="number">0</span>);</span><br><span class="line">fread(a, <span class="number">1</span>, <span class="number">0x40</span>, fp);</span><br><span class="line">fclose(fp);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">63</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%02X"</span>, a[i]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>ä»ç„¶æ‰“ä¸å¼€, ä½†æ˜¯è¿™æ¬¡åŒºæ®µéƒ½æ˜¯é½çš„, idaå¯ä»¥æ‰“å¼€å°±å¥½äº†. </p></li><li><p>è½½å…¥ida, å‘ç°æœ‰å¾ˆå¤šå¹²æ‰°é¡¹, ä½†å¯ä»¥åœ¨æ¯”è¾ƒå‡½æ•°ä¸Šé¢ä¸€ä¸ªçœ‹å‡ºæ˜¯ base64åŠ å¯†. æœ€åä¸å¯†æ–‡æ¯”è¾ƒ.</p><p><img src="/2020/05/23/2020%E5%B9%B4DASCTF%E4%BA%94%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200524101529508.png" alt="image-20200524101529508"></p></li><li><p>æ‰¾å¯†æ–‡. å¯ä»¥å‘ç°æ˜¯ç¨‹åºè¿è¡Œæ‰èµ‹å€¼çš„.</p><p><img src="/2020/05/23/2020%E5%B9%B4DASCTF%E4%BA%94%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200524101634787.png" alt="image-20200524101634787"></p></li><li><p>æå–å‡ºæ¥baseè§£å¯†ä¸€ä¸‹, å†md5å¾—åˆ°flag. <strong>e801bcbcc42d3120d910ccc46ae640dd</strong></p></li><li><p>æ€»ç»“: ç®—æ˜¯ç†Ÿæ‚‰äº†æ–‡ä»¶æ“ä½œå§.å“ˆå“ˆ</p></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;ViQinere&quot;&gt;&lt;a href=&quot;#ViQinere&quot; class=&quot;headerlink&quot; title=&quot;ViQinere&quot;&gt;&lt;/a&gt;ViQinere&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;64ä½elfæ–‡ä»¶, è½½å…¥idaåå‘ç°ä¸ä»¥å¾€çš„ä¸åŒ. å¾ˆå¤šå‡½æ•°éƒ½æ²¡æ˜¾ç¤ºå‡ºæ¥.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;linuxä¸­è¿è¡Œä¸€ä¸‹, æ˜¾ç¤ºå¯¹flagåŠ å¯†, ç„¶åæ˜¯ä¸€äº›ä¹±ç .  åæ¥ç¾¤é‡Œé€šçŸ¥, è¿™ä¸ªæ˜¯æœ‰é¶æœºçš„.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ncè¿æ¥ä¸€ä¸‹, é‚£é¢˜ç›®çš„flagå°±æ˜¯å­˜æ”¾åœ¨æœ¬åœ°çš„, æ–‡ä»¶æ“ä½œå–å‡ºflag, ç»è¿‡åŠ å¯†. &lt;img src=&quot;/2020/05/23/2020%E5%B9%B4DASCTF%E4%BA%94%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200523203121150.png&quot; alt=&quot;image-20200523203121150&quot;&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;
    
    </summary>
    
    
      <category term="DASCTFçº¿ä¸Š" scheme="https://hus96r.coding-pages.com/categories/DASCTF%E7%BA%BF%E4%B8%8A/"/>
    
    
      <category term="CTF" scheme="https://hus96r.coding-pages.com/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>æ”»é˜²ä¸–ç•Œ(4)</title>
    <link href="https://hus96r.coding-pages.com/2020/05/15/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(4)/"/>
    <id>https://hus96r.coding-pages.com/2020/05/15/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(4)/</id>
    <published>2020-05-15T02:27:16.000Z</published>
    <updated>2020-05-27T03:41:47.802Z</updated>
    
    <content type="html"><![CDATA[<h3 id="asong"><a href="#asong" class="headerlink" title="asong"></a>asong</h3><blockquote><p>ç®—æ˜¯å°ç™½ç¬¬ä¸€æ¬¡æ¥è§¦é€†å‘çœŸæ­£ç®—æ³•çš„é¢˜å§. åƒäº†ç®—æ³•çš„äº, é€†å‘è¿™ä¸ªç®—æ³•æƒ³äº†åŠå¤©ğŸ˜…</p></blockquote><h4 id="0x1åˆ†æ"><a href="#0x1åˆ†æ" class="headerlink" title="0x1åˆ†æ"></a>0x1åˆ†æ</h4><ul><li><p>ä¸‹è½½ä¸‹æ¥ä¸‰ä¸ªæ–‡ä»¶, ä½†è¿™ä¸æ˜¯æˆ‘ä»¥å‰é‡åˆ°çš„é‚£ç§åŒä¸€ä¸ªé¢˜ç»™ä¸åŒçš„ç‰ˆæœ¬.</p></li><li><p>ä¾æ¬¡çœ‹äº†ä¸‹, ä¸€ä¸ª64ä½elfæ–‡ä»¶æ— å£³, 2ä¸ªæ–‡æœ¬æ–‡ä»¶.  æ‰“å¼€æ–‡æœ¬æ–‡ä»¶å,æ²¡æœ‰å¤´ç»ª.  å°†elfæ–‡ä»¶è½½å…¥ida.</p></li><li><p>æ•´ä¸ªæµç¨‹å¼€å§‹çœ‹ä¸æ¸…æ¥šåšä»€ä¹ˆ, å¤šçœ‹å‡ æ¬¡æ˜ç™½äº†. å…ˆè¾“å…¥å­—ç¬¦ä¸², æ‰“å¼€ä¸€ä¸ªthat_girlæ–‡ä»¶è¯»ä¿¡æ¯, æœ€åå‘outæ–‡ä»¶å†™ä¿¡æ¯. ä½†è¿™æ€ä¹ˆå’Œflagè”ç³»èµ·æ¥å‘¢.  å…¶å®é‚£ä¸ªoutæ–‡ä»¶é‡Œçš„å°±æ˜¯å¯†æ–‡, æˆ‘ä»¬æ‰¾åˆ°é€†å‘ç®—æ³•, é€šè¿‡å¯†æ–‡æ±‚å‡ºæ˜æ–‡(å³æˆ‘ä»¬çš„è¾“å…¥, ä¹Ÿæ˜¯flag) <a id="more"></a></p></li><li><p>ä¸‹é¢å…·ä½“åˆ†ææ¯ä¸ªå‡½æ•°. ç¬¬ä¸€å‡½æ•°: <strong>sub_400B4C</strong> ç”±äºå¾ˆç®€å•, ç›´æ¥ç»™å‡ºå‡½æ•°åŠŸèƒ½.</p><p><img src="/2020/05/15/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(4)/image-20200515112040201.png" alt="image-20200515112040201"></p></li><li><p><strong>sub_400B4C</strong>: å…ˆåˆ¤æ–­, å†å– { } ä¹‹é—´çš„å†…å®¹.</p><p><img src="/2020/05/15/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(4)/image-20200515112333168.png" alt="image-20200515112333168"></p></li><li><p>ä¸‹é¢ä¸‹ä¸€ä¸ªå‡½æ•°, ä¹Ÿæ˜¯æˆ‘é‡åˆ°çš„éš¾ç‚¹å¼€å§‹:  <strong>v4å“ªé‡Œæ¥çš„åŠ ++*(_DWORD *)(4LL * v2 + v4);è¯­å¥çš„ä½œç”¨</strong></p><p><img src="/2020/05/15/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(4)/image-20200515113837252.png" alt="image-20200515113837252"></p><p><strong>sub_400936(&amp;buf)</strong>:</p><p><img src="/2020/05/15/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(4)/image-20200515170301682.png" alt="image-20200515170301682"></p></li><li><p>ç¬¬ä¸€æ¬¡é‡åˆ°, æ²¡æœ‰ç»éªŒ, åæ¥æ‰æƒ³åˆ°é€šè¿‡æ±‡ç¼–çš„æŸ¥çœ‹, v4å³æ˜¯æˆ‘ä»¬ä¼ äº†å‚æ•° a2(ä¹Ÿå°±æ˜¯ä¸»å‡½æ•°çš„v3), è¿™æ˜¯é€šè¿‡å¯„å­˜å™¨ä¼ é€’. 64ä½ä¸32ä½ç¨‹åºçš„åŒºåˆ«å§. ä½†è¯¥è¯­å¥åŠŸèƒ½è¿˜ä¸æ˜¯å¾ˆæ¸…æ¥š.<img src="/2020/05/15/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(4)/image-20200515114501031.png" alt="image-20200515114501031"></p><p><img src="/2020/05/15/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(4)/image-20200515114755333.png" alt="image-20200515114755333"></p></li><li><p>ç»§ç»­çœ‹ä¸‹ä¸€ä¸ªå‡½æ•°<strong>sub_400E54</strong>:  çœ‹åˆ°è¿™é‡Œ, å°±å¾ˆæ¸…æ™°äº†,  å°±æ˜¯å…ˆé€šè¿‡ç»Ÿè®¡<strong>that_girl</strong>æ–‡ä»¶ä¸­æ¯ä¸ªå­—ç¬¦å‡ºç°çš„æ¬¡æ•°, ç„¶åæŒ‰ç…§ä¸€å®šçš„é¡ºåºè¾“å…¥å­—ç¬¦, æŠŠæ¯ä¸ªå­—ç¬¦å‡ºç°çš„æ¬¡æ•°æŒ‰ä¸€å®šé¡ºåºç»™ä¸‹é¢çš„ v5 æ•°ç»„èµ‹å€¼.<strong>é‚£æ‰€ä»¥sub_400936è½¬æ¢å­—ç¬¦å‡½æ•°æˆ‘ä»¬æ˜¯ä¸ç”¨ç®¡çš„.</strong></p><p><img src="/2020/05/15/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(4)/image-20200515115440782.png" alt="image-20200515115440782"></p></li><li><p>ä¸‹é¢æ˜¯2ä¸ªåŠ å¯†å‡½æ•°,  æˆ‘ç®—æ³•å¤ªèœ, é€†ç®—æ³•æƒ³åŠå¤©ğŸ˜…, é¦–å…ˆ<strong>sub_400D33((unsigned __int8 *)v5);</strong></p><p><img src="/2020/05/15/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(4)/image-20200515120938171.png" alt="image-20200515120938171"></p></li><li><p>ç„¶å <strong>sub_400DB4(v5, v4);</strong> è§£é‡Šèµ·æ¥æœ‰ç‚¹æŠ½è±¡â€¦â€¦æ³¨æ„æ˜¯ä¸€ä¸ªå­—èŠ‚, æ‰€ä»¥å¤šå‡ºçš„ä½è¦èˆå¼ƒ<img src="/2020/05/15/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(4)/image-20200515125253662.png" alt="image-20200515125253662"></p></li><li><p>ä¸¾ä¸ªä¾‹å­:<img src="/2020/05/15/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(4)/image-20200515134001272.png" alt="image-20200515134001272"></p></li><li><p>æœ€åä¸€ä¸ªå‡½æ•°: <strong>sub_400CC0((__int64)v5, â€œoutâ€, v4);</strong>å°†åŠ å¯†åçš„å€¼å†™å…¥ outæ–‡ä»¶. </p></li></ul><h4 id="0x2é€†å‘è§£å¯†"><a href="#0x2é€†å‘è§£å¯†" class="headerlink" title="0x2é€†å‘è§£å¯†"></a>0x2é€†å‘è§£å¯†</h4><ul><li><p>ç›´æ¥exp:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">union</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ida[<span class="number">152</span>];</span><br><span class="line"><span class="keyword">int</span> change[<span class="number">38</span>];</span><br><span class="line">&#125;A = &#123;</span><br><span class="line">   <span class="number">22</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">6</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">2</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">30</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">24</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">9</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">21</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">7</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">18</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">10</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">8</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">12</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">17</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">23</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">13</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">4</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">3</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">14</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">  <span class="number">19</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">11</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">20</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">16</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">15</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">5</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">25</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">36</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">27</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">28</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">29</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">37</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">31</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">32</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">33</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">  <span class="number">26</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">34</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">35</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">0</span>,   <span class="number">0</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>, a[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;, temp = <span class="number">0</span>, lenth = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> b[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;, c[<span class="number">2000</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> count[<span class="number">127</span>] = &#123;<span class="number">0</span>&#125;, change_[<span class="number">38</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">char</span> flag[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">FILE *fp = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">fp = fopen(<span class="string">"out"</span>, <span class="string">"rb"</span>);<span class="comment">//å…ˆä»æ–‡ä»¶è¯»å–å¯†æ–‡</span></span><br><span class="line">lenth = fread(b, <span class="number">1</span>, <span class="number">100</span>, fp);<span class="comment">//è¿”å›è¯»å–æˆåŠŸä¸ªæ•°, ç¡®å®šå­—ç¬¦ä¸ªæ•°</span></span><br><span class="line">fclose(fp);</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//ç¬¬ä¸€å±‚è§£å¯†</span></span><br><span class="line">temp = b[lenth<span class="number">-1</span>]&amp;<span class="number">7</span>;    <span class="comment">//&amp;7  å–åä¸‰ä½æ•°æ®.</span></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; lenth; i++)</span><br><span class="line">&#123;<span class="comment">//ä»æ•´ä½“æ¥çœ‹å°±æ˜¯å°†æ•´ä¸ªæ•°æ®å³ç§»åŠ¨3ä½</span></span><br><span class="line">a[i] = (b[i] &gt;&gt; <span class="number">3</span>) | (temp &lt;&lt; <span class="number">5</span>);</span><br><span class="line">temp = b[i]&amp;<span class="number">7</span>;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">fp = fopen(<span class="string">"that_girl"</span>, <span class="string">"rb"</span>); <span class="comment">//æ‰“å¼€that_girl, ç»Ÿè®¡å­—ç¬¦æ•°.</span></span><br><span class="line">fread(c, <span class="number">1</span>, <span class="number">1742</span>, fp);</span><br><span class="line">fclose(fp); </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="keyword">sizeof</span>(c); i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(c[i] &gt;= <span class="number">65</span> &amp;&amp; c[i] &lt;= <span class="number">90</span>)  </span><br><span class="line">c[i] += <span class="number">32</span>;<span class="comment">//å› ä¸ºä¸åŒºåˆ†å¤§å°å†™, éƒ½è½¬æ¢ä¸ºå°å†™</span></span><br><span class="line"></span><br><span class="line">count[c[i]]++; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(A.change[i]) </span><br><span class="line">&#123;</span><br><span class="line">change_[j++] = A.change[i];  <span class="comment">//ç»Ÿè®¡æ¯ä¸ªå­—ç¬¦å‡ºç°æ¬¡æ•°</span></span><br><span class="line">i = A.change[i];  </span><br><span class="line">&#125;</span><br><span class="line">j -= <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">temp = a[<span class="number">0</span>], a[<span class="number">0</span>] = a[change_[j]];   <span class="comment">//ç¬¬äºŒå±‚è§£å¯†</span></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; lenth<span class="number">-2</span>; i++) <span class="comment">//æŒ‰ç…§ç»™å®šèµ‹å€¼æ‰¾åˆ°ä¸€ä¸ªæœªå˜çš„å€¼, å€’åºèµ‹å€¼å›å»å³å¯</span></span><br><span class="line">&#123;</span><br><span class="line">a[change_[j]] = a[change_[--j]];</span><br><span class="line">&#125;</span><br><span class="line">a[change_[j]] = temp; </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; lenth; i++) <span class="comment">//ç¬¬ä¸‰å±‚è§£å¯†, æ¯”å¯¹æ¯ä¸ªå­—ç¬¦å‡ºç°çš„æ¬¡æ•°çš„é¡ºåº,è¿›è€Œç¡®å®šè¾“å…¥é¡ºåº</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">127</span>; j++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(a[i] == count[j])</span><br><span class="line">&#123;</span><br><span class="line">flag[i] = j; </span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"QCTF&#123;%s&#125;"</span>, flag);   <span class="comment">//å¾—åˆ°flag.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2020/05/15/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(4)/image-20200515135919513.png" alt="image-20200515135919513"></p></li><li><p><strong>æ€»ç»“: (1)ç®—æ³•è¿˜æ˜¯å¤ªé‡è¦. ç®—æ³•ç¨å¾®å¥½ç‚¹çš„è¯, è¿™é“é¢˜å°±è½»æ¾å¾ˆå¤š.  (2)æ³¨æ„64ä½ç¨‹åºçš„ä¼ é€’å‚æ•°çš„æ–¹å¼</strong></p><p>â€‹          <strong>(3)è¦ä¹ æƒ¯çœ‹æ±‡ç¼–ä»£ç </strong></p></li></ul><hr><blockquote><h3 id="easyre-153"><a href="#easyre-153" class="headerlink" title="easyre-153"></a>easyre-153</h3></blockquote><blockquote><p>é¢˜å…¶å®å¾ˆç®€å•,  ä½†å·®ç‚¹åšåˆ°è‡ªé—­â€¦ å…¶å®èƒ½çŒœåˆ°flagæ€ä¹ˆç®—å‡ºæ¥, ä½†å¯¹ç¨‹åºçš„æ‰§è¡Œæƒ³ä¸æ˜ç™½.</p></blockquote><ul><li><p>32ä½elfæ–‡ä»¶åŠ äº†upxå£³, æ²¡æœ‰ä¿®æ”¹è¿‡çš„, ç›´æ¥upx -dè„±å£³æˆåŠŸ.<img src="/2020/05/15/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(4)/image-20200515184107394.png" alt="image-20200515184107394"></p></li><li><p>idaæ‰“å¼€, æ‰¾åˆ°ä¸»å‡½æ•°. ä¸€å¼€å§‹å°±è®¤ä¸ºç›´æ¥åŠ¨è·³æ§åˆ¶å‡½æ•°çš„èµ°å‘, åˆ°æœ€åä¸€ä¸ª <strong>lol</strong> å‡½æ•°å¾—åˆ°flag. ä½†æ˜¯åŠ¨æ€æ€»æ˜¯åœ¨readå‡½æ•°å¡ä½, èµ°ä¸äº†, ä½†è¿™é‡Œæˆ‘ä»¬å¹¶ä¸èƒ½ç›´æ¥è·³,å› ä¸ºè¿™ä¸ªå‡½æ•°æ˜¯å‘<strong>buf</strong>å†™å†…å®¹, æˆ‘ä»¬æœ€åçš„flagæ˜¯è¦ä½¿ç”¨bufçš„å†…å®¹. ç„¶ååˆè½¬ GDB è°ƒè¯•, åŒç„¶çš„ç»“æœ.    çº³é—·è¿™é¢˜äº†, å®ƒåˆ°åº•æ˜¯è¦åšä»€ä¹ˆ. å…¶å®çŒœä¹Ÿæ˜¯æŠŠä¸Šé¢ writeçš„é‚£éƒ¨åˆ†æ•°æ®ä½œä¸º buf çš„å†…å®¹, ç„¶ååœ¨lolå‡½æ•°å¾—åˆ° flag.  ä½†é—®é¢˜æ˜¯ ç¨‹åºåˆ°åº•åœ¨æä»€ä¹ˆâ€¦..</p><p><img src="/2020/05/15/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(4)/image-20200515185409497.png" alt="image-20200515185409497"></p></li><li><p>çœŸçš„åšåˆ°è‡ªé—­, åæ¥æ‰å‘ç°æˆ‘å¿½ç•¥ä¸Šé¢çš„ pipe()å‡½æ•°ä¸fork()å‡½æ•°. ç¬¬ä¸€æ¬¡è§åˆ°, ç™¾åº¦äº†ä¸‹, æ˜ç™½äº†â€¦â€¦.</p><blockquote><p>é¦–å…ˆæ˜¯ç®¡é“: 1.å…¶æœ¬è´¨æ˜¯ä¸€ä¸ªä¼ªæ–‡ä»¶(å®ä¸ºå†…æ ¸ç¼“å†²åŒº)</p><p>â€‹                     2.ç”±ä¸¤ä¸ªæ–‡ä»¶æè¿°ç¬¦å¼•ç”¨ï¼Œä¸€ä¸ªè¡¨ç¤ºè¯»ç«¯ï¼Œä¸€ä¸ªè¡¨ç¤ºå†™ç«¯ã€‚</p><p>â€‹                     3.è§„å®šæ•°æ®ä»ç®¡é“çš„å†™ç«¯æµå…¥ç®¡é“ï¼Œä»è¯»ç«¯æµå‡º</p><p>pipe()å‡½æ•°ç”¨äºåˆ›å»ºç®¡é“: 1.int pipe(int pipefd[2]); æˆåŠŸï¼š0ï¼›å¤±è´¥ï¼š-1ï¼Œè®¾ç½®errno</p><p>â€‹                                           2.å‡½æ•°è°ƒç”¨æˆåŠŸè¿”å›r/wä¸¤ä¸ªæ–‡ä»¶æè¿°ç¬¦ã€‚æ— éœ€openï¼Œä½†éœ€æ‰‹åŠ¨close</p><p>â€‹                                           3.è§„å®šï¼šfd[0] â†’ rï¼› fd[1] â†’ wï¼Œå°±åƒ0å¯¹åº”æ ‡å‡†è¾“å…¥ï¼Œ1å¯¹åº”æ ‡å‡†è¾“å‡ºä¸€æ ·ã€‚</p><p>â€‹                                           4.å‘ç®¡é“æ–‡ä»¶è¯»å†™æ•°æ®å…¶å®æ˜¯åœ¨è¯»å†™å†…æ ¸ç¼“å†²åŒº</p><p><strong>è¿™é‡Œå°±æ˜¯é€šè¿‡pipedes[1]å†™è¿›å†…å®¹,  ä»pipedes[0]å†™å‡º.</strong>                    </p></blockquote><blockquote><p>ç„¶åfork()å‡½æ•°. 1.forkï¼ˆï¼‰å‡½æ•°é€šè¿‡ç³»ç»Ÿè°ƒç”¨åˆ›å»ºä¸€ä¸ªä¸åŸæ¥è¿›ç¨‹å‡ ä¹å®Œå…¨ç›¸åŒçš„è¿›ç¨‹ï¼Œ</p><p>â€‹                            ä¹Ÿå°±æ˜¯ä¸¤ä¸ªè¿›ç¨‹å¯ä»¥åšå®Œå…¨ç›¸åŒçš„äº‹ï¼Œä½†å¦‚æœåˆå§‹å‚æ•°æˆ–è€…ä¼ å…¥çš„å˜é‡ä¸åŒï¼Œä¸¤ä¸ªè¿›ç¨‹                            ä¹Ÿå¯ä»¥åšä¸åŒçš„äº‹</p><p>â€‹                           2.ä¸€ä¸ªè¿›ç¨‹è°ƒç”¨forkï¼ˆï¼‰å‡½æ•°åï¼Œç³»ç»Ÿå…ˆç»™æ–°çš„è¿›ç¨‹åˆ†é…èµ„æºï¼Œä¾‹å¦‚å­˜å‚¨æ•°æ®å’Œä»£ç çš„ç©º                           é—´ã€‚ç„¶åæŠŠåŸæ¥çš„è¿›ç¨‹çš„æ‰€æœ‰å€¼éƒ½å¤åˆ¶åˆ°æ–°çš„æ–°è¿›ç¨‹ä¸­ï¼Œåªæœ‰å°‘æ•°å€¼ä¸åŸæ¥çš„è¿›ç¨‹å€¼                           ä¸åŒã€‚ç›¸å½“äºå…‹éš†äº†ä¸€ä¸ªè‡ªå·±</p><p>â€‹                           3.è°ƒç”¨forkå‡½æ•°ä¸€æ¬¡, è¿”å›2æ¬¡å€¼, è‹¥è¿”å›0åˆ™æ˜¯å­è¿›ç¨‹, è‹¥æ˜¯ä¸€ä¸ªæ•°åˆ™æ˜¯çˆ¶è¿›ç¨‹çš„è¿›ç¨‹å·.</p><p><strong>æ‰€ä»¥è¿™é‡Œå°±æ˜¯å…ˆåˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹,è¿”å›å€¼v5 == 0, è¿›å…¥å­è¿›ç¨‹å®Œæˆå†™å…¥æ•°æ®åç»“æŸè¿›ç¨‹, fork()è¿”å›æ–°çš„å€¼çˆ¶è¿›ç¨‹è¿›ç¨‹å·,ç„¶åæ‰§è¡Œåé¢çš„æ“ä½œ.</strong>        </p></blockquote></li><li><p>è¿™é‡ŒåŠ¨æ€è°ƒè¯•è¿™ç§åˆ›å»ºè¿›ç¨‹çš„ç¨‹åºæ˜¯ä¸é€šç•…çš„. é‚£å°±é€šè¿‡ä¿®æ”¹ç¨‹åº EIP, æŒ‰ç…§æœ¬æ¥è¦æ‰§è¡Œçš„é¡ºåºæ‰§è¡Œä¸€éå¾—åˆ°flag.(æ³¨æ„è¿™æ ·å¯èƒ½ä¼šæœ‰ä¸€ä¸ªé—®é¢˜: æ ˆä¸å¹³è¡¡, å› ä¸ºå‡½æ•°æ²¡æœ‰æ­£å¸¸è¿”å›, é‚£ä¼šå½±å“ä¸€äº›å‡½æ•°, æ¯”å¦‚scanf()å‡½æ•°æ‰§è¡Œåˆ°äº†, ä¸ä¼šè®©æˆ‘ä»¬è¾“å…¥, è€Œæ˜¯ç›´æ¥è·³è¿‡, è¿™å°±æ˜¯å †æ ˆæœ‰å€¼å®ƒå°±ç›´æ¥è¯»å–äº†)</p><p><img src="/2020/05/15/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(4)/image-20200515193103677.png" alt="image-20200515193103677"></p></li><li><p><strong>æ€»ç»“:(1)å¯¹äºç›²åŒºçš„çŸ¥è¯†, æèµ·æ¥è¿˜æ˜¯éº»çƒ¦, ç§¯ç´¯. (2)ç†Ÿæ‚‰äº†ä¿®æ”¹ EIP.</strong> </p></li></ul><hr><blockquote><h3 id="76å·å…¬è·¯"><a href="#76å·å…¬è·¯" class="headerlink" title="76å·å…¬è·¯"></a>76å·å…¬è·¯</h3></blockquote><ul><li><p>é¢˜ç›®çœ‹ä¼¼å¾ˆéš¾çš„æ ·å­, ä½†è‡ªå·±ç¡®å®è¢«é¢˜ç›®çš„ä¿¡æ¯è¯¯å¯¼äº†.</p></li><li><p>ä¸‹è½½å, 2ä¸ªæ–‡æœ¬ä¸€ä¸ª32ä½æ— å£³elfæ–‡ä»¶, å¹¶ä¸”é¢˜ç›®ä¿¡æ¯å°±ç»™äº† <strong>æˆ‘ä»¬è®¤ä¸ºæœ‰ä»½ç¡®åˆ‡çš„æ–‡æ¡£è®°å½•äº†æ¯ä¸ªåŒºåŸŸçš„åŠŸèƒ½ï¼Œè¯·ååŠ©æ‰¾å‡º</strong> è¿™ä¸ªæç¤º, æ‰€ä»¥è‡ªå·±åšé¢˜æ—¶å§‹ç»ˆæƒ³åˆ°æ€ä¹ˆå’Œæ–‡æœ¬è”ç³»èµ·æ¥, æ‰¾çº¿ç´¢. ä½†å…¶å®ä¸ç„¶</p></li><li><p>è½½å…¥idaå, æœç´¢äº†ä¸‹å­—ç¬¦ä¸², æ‰¾åˆ°äº†ä¸»å‡½æ•°, ä½†æ˜¯ä¸èƒ½è½¬åŒ–ä¸ºä¼ªä»£ç ,  å› ä¸ºä¹‹å‰äº†è§£è¿‡ç‚¹èŠ±æŒ‡ä»¤,å…¶ä¸­  <strong>E0</strong> æ€»æ˜¯å¹²æ‰°ä»£ç çš„. æ”¹ä¸º <strong>90</strong> nopæ‰å°±å¯ä»¥äº†. </p></li><li><p>è¿™é‡ŒåŒæ ·. æ”¹å®Œå, å¼€å§‹è¯»æ±‡ç¼–ä»£ç , é€»è¾‘å¾ˆç®€å•, å°±æ˜¯æç¤º, è®©æˆ‘ä»¬è¾“å…¥å­—ç¬¦, è¿›å»ä¸€ä¸ªå‡½æ•°åˆ¤æ–­.<img src="/2020/05/15/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(4)/image-20200521123259003.png" alt="image-20200521123259003"></p></li><li><p>è¿›å»åˆ¤æ–­å‡½æ•°, å¯ä»¥æŸ¥çœ‹ä¼ªä»£ç çš„. åˆ†æä¸€ä¸‹å°±çŸ¥é“æ˜¯è·Ÿç€ä¸€æ¡çº¿æŒ‰ç…§é¡ºåºæ£€ç´¢æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦ä¸². ä½†æ˜¯æ€ä¹ˆæ‰¾é¡ºåºå‘¢, å› ä¸ºæ–‡æœ¬æ–‡ä»¶è¿˜æ²¡ç”¨, æˆ‘å°±å§‹ç»ˆè®¤ä¸ºåœ¨æ–‡æœ¬æ–‡ä»¶æ‰¾, æ‰¾äº†åŠå¤©â€¦â€¦.æ— æœ</p></li><li><p>æœ€åå›åˆ°ç¨‹åºå‘ç°, å¯ä»¥æ‰¾åˆ°å…¥å£ç‚¹, é¡ºè—¤æ‘¸ç“œçš„å°±å¯ä»¥æ‰¾åˆ°äº†å•Š. å¯ä»¥çŸ¥é“ä»ç´¢å¼• <strong>v2</strong> ä»0å¼€å§‹, ç›´æ¥ä»è¿™é‡Œå‡ºå‘å°±å¥½äº†. ç›´åˆ°æ­£ç¡®é€€å‡ºå¾ªç¯.<img src="/2020/05/15/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(4)/image-20200521123808376.png" alt="image-20200521123808376"></p></li><li><p>æœ€åå¾—åˆ°flag: <strong>flag{09vdf7wefijbk}</strong>.</p></li><li><p><strong>æ€»ç»“: (1)ä¸è¦è®©é¢˜ç›®æŠŠè‡ªå·±çš„æ€è·¯å¸¦åäº†, æ€ç»´è¦å‘æ•£ä¸€äº›.</strong>  </p></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;asong&quot;&gt;&lt;a href=&quot;#asong&quot; class=&quot;headerlink&quot; title=&quot;asong&quot;&gt;&lt;/a&gt;asong&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;ç®—æ˜¯å°ç™½ç¬¬ä¸€æ¬¡æ¥è§¦é€†å‘çœŸæ­£ç®—æ³•çš„é¢˜å§. åƒäº†ç®—æ³•çš„äº, é€†å‘è¿™ä¸ªç®—æ³•æƒ³äº†åŠå¤©ğŸ˜…&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&quot;0x1åˆ†æ&quot;&gt;&lt;a href=&quot;#0x1åˆ†æ&quot; class=&quot;headerlink&quot; title=&quot;0x1åˆ†æ&quot;&gt;&lt;/a&gt;0x1åˆ†æ&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;ä¸‹è½½ä¸‹æ¥ä¸‰ä¸ªæ–‡ä»¶, ä½†è¿™ä¸æ˜¯æˆ‘ä»¥å‰é‡åˆ°çš„é‚£ç§åŒä¸€ä¸ªé¢˜ç»™ä¸åŒçš„ç‰ˆæœ¬.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ä¾æ¬¡çœ‹äº†ä¸‹, ä¸€ä¸ª64ä½elfæ–‡ä»¶æ— å£³, 2ä¸ªæ–‡æœ¬æ–‡ä»¶.  æ‰“å¼€æ–‡æœ¬æ–‡ä»¶å,æ²¡æœ‰å¤´ç»ª.  å°†elfæ–‡ä»¶è½½å…¥ida.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æ•´ä¸ªæµç¨‹å¼€å§‹çœ‹ä¸æ¸…æ¥šåšä»€ä¹ˆ, å¤šçœ‹å‡ æ¬¡æ˜ç™½äº†. å…ˆè¾“å…¥å­—ç¬¦ä¸², æ‰“å¼€ä¸€ä¸ªthat_girlæ–‡ä»¶è¯»ä¿¡æ¯, æœ€åå‘outæ–‡ä»¶å†™ä¿¡æ¯. ä½†è¿™æ€ä¹ˆå’Œflagè”ç³»èµ·æ¥å‘¢.  å…¶å®é‚£ä¸ªoutæ–‡ä»¶é‡Œçš„å°±æ˜¯å¯†æ–‡, æˆ‘ä»¬æ‰¾åˆ°é€†å‘ç®—æ³•, é€šè¿‡å¯†æ–‡æ±‚å‡ºæ˜æ–‡(å³æˆ‘ä»¬çš„è¾“å…¥, ä¹Ÿæ˜¯flag)&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;
    
    </summary>
    
    
      <category term="æ”»é˜²ä¸–ç•Œ" scheme="https://hus96r.coding-pages.com/categories/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/"/>
    
    
      <category term="CTF" scheme="https://hus96r.coding-pages.com/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>è®ºå‰‘åœº</title>
    <link href="https://hus96r.coding-pages.com/2020/05/12/%E8%AE%BA%E5%89%91%E5%9C%BA/"/>
    <id>https://hus96r.coding-pages.com/2020/05/12/%E8%AE%BA%E5%89%91%E5%9C%BA/</id>
    <published>2020-05-12T11:15:32.000Z</published>
    <updated>2020-05-27T03:42:08.721Z</updated>
    
    <content type="html"><![CDATA[<h3 id="Refresh-it"><a href="#Refresh-it" class="headerlink" title="Refresh it"></a>Refresh it</h3><ul><li><p>é¢˜ç›®ä¸‹è½½ä¸‹æ¥æ˜¯ä¸€ä¸ª.pcapngæ–‡ä»¶. å…ˆç”¨010editorçœ‹äº†çœ‹ä¼šä¸ä¼šåªæ˜¯ç®€å•çš„å°†æ–‡ä»¶æ ¼å¼æ”¹äº†, å› ä¸ºæ˜¯reverseé¢˜, çœ‹äº†ä¸€åœˆ, çš„å´æ˜¯æµé‡åŒ….</p></li><li><p>åœ¨wiresharkä¸­å°è¯•æœç´¢äº†é¢˜ç›®å…³é”®å­—refresh, æ²¡æœ‰å¾—åˆ°æœ‰ç”¨ä¿¡æ¯. åˆæ¥ç€å°è¯•äº†æœç´¢äº†å¾ˆå¤š, éƒ½æ— æœ. </p></li><li><p>è½¬åˆ°foremostå’Œbinwalkçœ‹çœ‹æ²¡æœ‰ä»€ä¹ˆéšè—æ–‡ä»¶.  ç¡®å®çœ‹åˆ°äº†2å¼ å›¾ç‰‡, æå–å‡ºæ¥ä½†æ‰“ä¸å¼€, è€ƒè™‘exeæ–‡ä»¶éšè—åœ¨å›¾ç‰‡æ–‡ä»¶ä¸­, æŸ¥çœ‹äº†å›¾ç‰‡æ–‡ä»¶ä¿¡æ¯, PEæ–‡ä»¶çš„å½±å­éƒ½æ²¡æœ‰ğŸ¤£.  æ²¡åŠæ³•äº†, é¢˜ç›®å…ˆæ”¾ä¸€æ®µæ—¶é—´. <a id="more"></a></p></li><li><p>è¿™åˆæ˜¯è¿‡äº†å‡ å¤©æ¥çœ‹è¿™ä¸ªé¢˜ç›®, æ„Ÿè§‰è‡ªå·±æ‰¾ä¸åˆ°ç›®æ ‡, åœ¨ç›²ç›®çš„æ‰¾â€¦å¾ˆå¤šåŠæ³•éƒ½è¯•äº†ä¸‹. å”¯ä¸€å¾—åˆ°çš„å°±æ˜¯å›¾ç‰‡.</p></li><li><p>çœ‹äº†çœ‹å›¾ç‰‡ä¿¡æ¯, å‘ç°F5 refrehsh. åˆä»é¢˜ç›®çš„ä¿¡æ¯, ä½ çœ‹åˆ°åˆ·æ–°æŒ‰é’®äº†å˜›. çªç„¶æƒ³åˆ°ä¹‹å‰åšè¿‡ä¸€ä¸ªæ‚é¡¹é¢˜æ˜¯F5-steganographyéšå†™. åé¢é‚£ä¸ªçš„refreshçŒœæµ‹æ˜¯å¯†ç . è¿å¿™å»è¯•äº†ä¸‹, é”™è¯¯â€¦. ä½†æ˜¯è¿™ä¸ªç¡®å®å¾ˆåƒæ˜¯è€ƒéšå†™.<img src="/2020/05/12/%E8%AE%BA%E5%89%91%E5%9C%BA/image-20200512194627578.png" alt="image-20200512194627578"></p></li><li><p>è€ƒè™‘æ˜¯binwalkæå–å›¾ç‰‡æœ‰æŸåæˆ–è€…ä¸å…¨çš„åŸå› , å› ä¸ºå›¾ç‰‡æ˜¯æ‰“ä¸å¼€çš„.  åˆè·‘å»wireshark. å› ä¸ºè¿™æ¬¡æ˜ç¡®æ˜¯æ‰¾å›¾ç‰‡, ç›´æ¥æœç´¢äº† jpg, æœç„¶å‡ºç°äº†ä¸ªå›¾ç‰‡<img src="/2020/05/12/%E8%AE%BA%E5%89%91%E5%9C%BA/image-20200512200418460.png" alt="image-20200512200418460"></p></li><li><p>è¿½è¸ªtcpæµæŠŠå›¾ç‰‡çš„äºŒè¿›åˆ¶ä»£ç å¤åˆ¶ä¸‹æ¥, winhexé‡å»ºä¸€ä¸ªæ–‡ä»¶ç²˜è´´ä¿å­˜.æ³¨æ„æ–‡ä»¶å¤´FF D8 æ–‡ä»¶å°¾ FF D9<img src="/2020/05/12/%E8%AE%BA%E5%89%91%E5%9C%BA/image-20200512200649037.png" alt="image-20200512200649037"></p></li><li><p>è¿™æ¬¡å›¾ç‰‡å¯ä»¥æ‰“å¼€äº†, æ˜¯ä¸ªåˆ·æ–°æŒ‰é’®, å†æ¬¡å»ç”¨F5éšå†™æ¥è§£å¯†. ç»ˆäºæˆåŠŸäº†â€¦.</p><p><img src="/2020/05/12/%E8%AE%BA%E5%89%91%E5%9C%BA/image-20200512200849581.png" alt="image-20200512200849581"></p></li><li><p><strong>æ€»ç»“: æ„Ÿè§‰èŠ±äº†å¾ˆå¤šæ—¶é—´, ç®€ç›´å°±æ˜¯æ‚é¡¹é¢˜å•Š. å¦å¤–é¢˜çš„æç¤ºä¿¡æ¯å¤ªå°‘. ç†Ÿæ‚‰äº†ä¸€äº›å·¥å…·çš„ä½¿ç”¨å§</strong></p></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;Refresh-it&quot;&gt;&lt;a href=&quot;#Refresh-it&quot; class=&quot;headerlink&quot; title=&quot;Refresh it&quot;&gt;&lt;/a&gt;Refresh it&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;é¢˜ç›®ä¸‹è½½ä¸‹æ¥æ˜¯ä¸€ä¸ª.pcapngæ–‡ä»¶. å…ˆç”¨010editorçœ‹äº†çœ‹ä¼šä¸ä¼šåªæ˜¯ç®€å•çš„å°†æ–‡ä»¶æ ¼å¼æ”¹äº†, å› ä¸ºæ˜¯reverseé¢˜, çœ‹äº†ä¸€åœˆ, çš„å´æ˜¯æµé‡åŒ….&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;åœ¨wiresharkä¸­å°è¯•æœç´¢äº†é¢˜ç›®å…³é”®å­—refresh, æ²¡æœ‰å¾—åˆ°æœ‰ç”¨ä¿¡æ¯. åˆæ¥ç€å°è¯•äº†æœç´¢äº†å¾ˆå¤š, éƒ½æ— æœ. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;è½¬åˆ°foremostå’Œbinwalkçœ‹çœ‹æ²¡æœ‰ä»€ä¹ˆéšè—æ–‡ä»¶.  ç¡®å®çœ‹åˆ°äº†2å¼ å›¾ç‰‡, æå–å‡ºæ¥ä½†æ‰“ä¸å¼€, è€ƒè™‘exeæ–‡ä»¶éšè—åœ¨å›¾ç‰‡æ–‡ä»¶ä¸­, æŸ¥çœ‹äº†å›¾ç‰‡æ–‡ä»¶ä¿¡æ¯, PEæ–‡ä»¶çš„å½±å­éƒ½æ²¡æœ‰ğŸ¤£.  æ²¡åŠæ³•äº†, é¢˜ç›®å…ˆæ”¾ä¸€æ®µæ—¶é—´.&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;
    
    </summary>
    
    
      <category term="è®ºå‰‘åœº" scheme="https://hus96r.coding-pages.com/categories/%E8%AE%BA%E5%89%91%E5%9C%BA/"/>
    
    
      <category term="CTF" scheme="https://hus96r.coding-pages.com/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>ASLR</title>
    <link href="https://hus96r.coding-pages.com/2020/05/12/ASLR/"/>
    <id>https://hus96r.coding-pages.com/2020/05/12/ASLR/</id>
    <published>2020-05-12T04:15:30.000Z</published>
    <updated>2020-05-27T03:34:52.806Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><strong>å¼€å§‹æ˜¯ä¸€é“CTFé¢˜åŠ äº†UPXå£³,  åˆ©ç”¨å †æ ˆå¹³è¡¡è„±å£³,import recè¿›è¡ŒIATä¿®å¤å,ç¨‹åºä¸èƒ½æ­£å¸¸æ‰“å¼€äº†.  åæ¥æ‰çŸ¥é“æ˜¯å¼€å¯äº†ASLR, å…³é—­åå³å¯æ‰“å¼€.  ä½†æœ‰ä¸€ä¸ªé—®é¢˜æƒ³äº†å¾ˆä¹….  ä¸ºä»€ä¹ˆå¼€å¯äº†ASLRçš„ç¨‹åºåœ¨æœ‰å£³æ—¶å¯ä»¥æ‰“å¼€, è„±å£³åå°±æ‰“ä¸å¼€äº†å‘¢? ç›®å‰è§‰å¾—æ˜¯ åŠ å£³ä¼šå¯¹PEæ–‡ä»¶çš„é‡å®šä½è¡¨è¿›è¡Œå‹ç¼©,åœ¨ODç›´æ¥dumpå‡ºçš„ç¨‹åºæ˜¯ä¸¢å¤±é‡å®šä½è¡¨çš„, è€Œç¨‹åºåˆæ˜¯å¼€å¯äº†ASLR,é‚£ç¨‹åºè‡ªç„¶ä¼šè®¿é—®åˆ°æ— æ•ˆçš„åœ°å€è€Œæ‰“ä¸å¼€</strong></p></blockquote><a id="more"></a><h6 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h6><ul><li><p>ASLR(åœ°å€ç©ºé—´å¸ƒå±€éšæœºåŒ–), ä¸€ç§é’ˆå¯¹ç¼“å†²åŒºæº¢å‡ºçš„å®‰å…¨ä¿æŠ¤æŠ€æœ¯. ä»Windows Vsita(å†…æ ¸ç‰ˆæœ¬<strong>6.0</strong>)å¼€å§‹é‡‡ç”¨, è€ŒWindows XPçš„å†…æ ¸ç‰ˆæœ¬æ˜¯<strong>5.1</strong>, æ‰€ä»¥æˆ‘ä»¬åœ¨Windows XPä¸‹è„±å¼€å¯äº†ASLR çš„å£³æ˜¯ä¸ä¼šæœ‰è¿™ä¸ªé—®é¢˜çš„.</p></li><li><p>ASLRå°±æ˜¯ä½¿æˆ‘ä»¬çš„PEæ–‡ä»¶åœ¨æ¯æ¬¡è½½å…¥å†…å­˜æ—¶èµ·å§‹åœ°å€éƒ½ä¼šå˜å¾—éšæœºåŒ–, å¢åŠ æ¶æ„ç”¨æˆ·ç¼–å†™æ¼æ´åˆ©ç”¨ä»£ç çš„éš¾åº¦(<strong>åœ¨ä¹‹å‰æˆ‘ä»¬çŸ¥é“åªæœ‰dllæ–‡ä»¶åœ¨ç†æƒ³åœ°å€ç©ºé—´è¢«å ç”¨äº†æ‰ä¼šè¿›è¡Œé‡å®šä½</strong>)</p></li><li><p>å¯¹äºASLRåŠŸèƒ½æˆ‘ä»¬ç³»ç»Ÿ(win10)æ˜¯é»˜è®¤å…³é—­çš„, æˆ‘ä»¬å¯ä»¥åœ¨è®¾ç½®çš„å®‰å…¨ä¸­å¿ƒæ‰“å¼€.<img src="/2020/05/12/ASLR/image-20200511184233641-1589256958059.png" alt="image-20200511184233641"></p><p>å¦å¤–å°±æ˜¯å¯æ‰§è¡Œæ–‡ä»¶çš„ASLR, æˆ‘ä»¬åœ¨æˆ‘ä»¬çš„ç¼–è¯‘å™¨ä¸Šä¹Ÿå¯ä»¥é€‰æ‹©æ˜¯å¦å¼•ç”¨è¯¥åŠŸèƒ½.<img src="/2020/05/12/ASLR/image-20200511185012962-1589256958060.png" alt="image-20200511185012962"></p></li></ul><h6 id="åˆ†æASLR"><a href="#åˆ†æASLR" class="headerlink" title="åˆ†æASLR."></a>åˆ†æASLR.</h6><ul><li><p>ä»¥VSç¼–è¯‘å™¨å†™ä¸€ä¸ªç¨‹åº, åˆ†åˆ«ç”Ÿæˆå¼€å¯äº†éšæœºåŸºå€ä¸æœªå¼€å¯çš„çš„ç‰ˆæœ¬æ¥åˆ†æ. (<strong>ä¸€å…±æœ‰ä¸‰ä¸ªåœ°æ–¹ä¸åŒ</strong>)</p><p><strong>(1)</strong>æœªå¼€å¯ASLRçš„ç¨‹åºçš„<strong>æ–‡ä»¶å¤´çš„Characteristics</strong>ä¼šå¤šä¸€ä¸ª <strong>IMAGE_FILE_RELOCS_STRIPPED   0X0001</strong> çš„å±æ€§, ç»è¿‡æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£å¯ä»¥çœ‹å¾—åˆ°å±æ€§è§£é‡Š, æ‰€ä»¥æˆ‘ä»¬å¼€å¯ASLRdçš„ç¨‹åºä¸ä¼šæœ‰è¿™ä¸ªå±æ€§<img src="/2020/05/12/ASLR/image-20200511200244008-1589256958060.png" alt="image-20200511200244008"></p><p>â€‹    ä¸‹é¢çœ‹ç¨‹åºå¯¹æ¯”:</p><p><img src="/2020/05/12/ASLR/image-20200511201513817-1589256958060.png" alt="image-20200511201513817"></p></li></ul><p>  <strong>(2)</strong>å¼€å¯äº†ASLRçš„ç¨‹åºçš„<strong>å¯é€‰å¤´çš„DllCharacteristics</strong>å¤šäº†<strong>IMAGE_DLLCHARACTERISTICS_DYNAMIC_BASE</strong></p><p>  <strong>0X0040</strong>çš„å±æ€§. åŒæ ·æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£. å³é‡å®šä½æ—¶éœ€è¦çš„å±æ€§.<img src="/2020/05/12/ASLR/image-20200511201801401-1589256958060.png" alt="image-20200511201801401"></p><p>  ç¨‹åºå¯¹æ¯”:<img src="/2020/05/12/ASLR/image-20200511202308748-1589204427416-1589204437657-1589256958060.png" alt="image-20200511202308748"></p><p>  <strong>(3)</strong>å¼€å¯äº†ASLRçš„ç¨‹åºä¼šå¤šä¸€ä¸ª <strong>.reloc</strong> èŠ‚(ä¸€èˆ¬æ™®é€šçš„exeæ–‡ä»¶æ˜¯ä¸éœ€è¦è¯¥èŠ‚çš„, ç”¨äºå¼€å¯ASLRçš„ç¨‹åºè¿›è¡Œé‡å®šä½, å½“ç„¶æˆ‘ä»¬å…³é—­äº†ASLRä¹Ÿå¯ä»¥æŠŠè¿™ä¸ªèŠ‚åˆ äº†)<img src="/2020/05/12/ASLR/image-20200511202858464-1589256958060.png" alt="image-20200511202858464"></p><h6 id="å…³é—­ASLR"><a href="#å…³é—­ASLR" class="headerlink" title="å…³é—­ASLR"></a>å…³é—­ASLR</h6><ul><li><p>ç”±ä¸Šé¢çš„åˆ†æçŸ¥é“æœ‰3å¤„ä¸åŒ, å…¶ä¸­ä¸Šé¢çš„<strong>(1)</strong>ä¸­æ˜¯å¼€å¯äº†ASLRçš„ç¨‹åºå°‘äº† <strong>IMAGE_FILE_RELOCS_STRIPPED   0X0001</strong>å±æ€§, æˆ‘ä»¬å¢åŠ ä¸Šè¿™ä¸ªå±æ€§å³å¯å…³é—­ASLR(å³ <strong>0102 -&gt; 0103</strong> / <strong>å¯¹åº”å±æ€§æ‰“ä¸Šå‹¾å³å¯</strong>).    å¦å¤–<strong>(2)</strong>ä¸­æ˜¯å¤šäº†<strong>DLL can move</strong>çš„å±æ€§,åˆ é™¤è¿™ä¸ªå±æ€§,åŒæ ·å¯ä»¥å…³é—­ASLR(å³ <strong>8140 -&gt; 8100</strong> / <strong>å¯¹åº”å±æ€§å–æ¶ˆæ‰“å‹¾å³å¯</strong> )</p><p>ä¸‹é¢ç¤ºä¾‹åœ¨010ç¼–è¯‘å™¨ä¸­ä¿®æ”¹æ•°å€¼æ¥å…³é—­ASLR.<img src="/2020/05/12/ASLR/image-20200511204613644-1589256958060.png" alt="image-20200511204613644"></p></li></ul><blockquote><p><strong>ä»¥ä¸Šæ˜¯å…³äºASLRçš„åˆ†æå³å…³é—­, å¦‚æœå¼€å¯äº†ASLR, æˆ‘ä»¬åœ¨è„±å£³ä¹‹å‰è¿˜æ˜¯å…ˆå…³é—­å®ƒæœ€å¥½,ä¹Ÿæ–¹ä¾¿è°ƒè¯•æ—¶IDAä¸ODä¸­åœ°å€çš„å¯¹åº”(å¦‚æœåªæ˜¯æƒ³åœ°å€å¯¹åº”, ä¹Ÿå¯ä»¥åœ¨IDAä¸­å¯åŠ¨æ—¶æŠŠManual loadå‹¾ä¸Š, æ‰‹åŠ¨è¾“å…¥åŠ è½½çš„åŸºåœ°å€å³å¯),  æ—¢ç„¶å…³é—­äº†ASLR, é‚£å¤šå‡ºçš„.relocèŠ‚ä¹Ÿå°±æ²¡ç”¨äº†, ä¸‹é¢æ‰‹åŠ¨åˆ é™¤è¯¥èŠ‚åŒº(è™½ç„¶æœ‰å¾ˆå¤šå·¥å…·å¯ä»¥ç›´æ¥å®ç°, è¿˜æ˜¯æ‰‹åŠ¨ç†Ÿæ‚‰ä¸‹PEç»“æ„)</strong></p></blockquote><h6 id="åˆ é™¤-relocèŠ‚åŒº"><a href="#åˆ é™¤-relocèŠ‚åŒº" class="headerlink" title="åˆ é™¤.relocèŠ‚åŒº."></a>åˆ é™¤.relocèŠ‚åŒº.</h6><ul><li><p>é¦–å…ˆæ¯ä¸ªèŠ‚éƒ½å¯¹åº”ä¸€ä¸ªèŠ‚åŒºå¤´çš„, é‚£å…ˆä»èŠ‚åŒºå¤´å¼€å§‹. ä½¿ç”¨010editorå¯ä»¥è½»æ¾åœ¨æœ€åä¸€èŠ‚åŒºå¤´æ‰¾åˆ°.  æˆ‘ä»¬å°†å…¶å…¨éƒ¨ç”¨0è¦†ç›–å¡«å……å³å¯.(æ³¨: ä¸èƒ½ç›´æ¥åˆ é™¤äº†, ä¸ç„¶PEæ–‡ä»¶çš„å¾ˆå¤šå±æ€§ä¼šå¯¹åº”ä¸ä¸Š)<img src="/2020/05/12/ASLR/image-20200511205903649-1589256958060.png" alt="image-20200511205903649"></p></li><li><p>ä¸‹é¢åˆ é™¤.relocæ•´ä¸ªèŠ‚åŒº(ä¸€èˆ¬è¿™ä¸ªèŠ‚åŒºéƒ½æ˜¯æ–°åŠ çš„,æ‰€ä»¥åœ¨æœ€å, æˆ‘ä»¬åªè¦æ‰¾åˆ°åç§»åœ°å€ç›´æ¥åˆ é™¤åˆ°æœ€åå³å¯), å¦‚å›¾, ç›´æ¥åˆ é™¤åˆ°æœ€åå³å¯. (è¿™é‡Œçš„Size: 600h, ä¸‹é¢æœ‰ç”¨)<img src="/2020/05/12/ASLR/image-20200511210742225-1589256958060.png" alt="image-20200511210742225"></p></li><li><p>åˆ é™¤å®Œå, æˆ‘ä»¬çŸ¥é“PEæ–‡ä»¶å¤´çš„<strong>_IMAGE_FILE_HEADER</strong>çš„<strong>NumberOfSections</strong>çš„å€¼ä¸€å®šè¦ä¸¥æ ¼çš„ä¸å®é™…èŠ‚åŒºå¯¹åº”, æ‰€ä»¥å»ä¿®æ”¹ <strong>_IMAGE_FILE_HEADER</strong>çš„<strong>NumberOfSections</strong>ä½¿å…¶å‡ä¸€.<img src="/2020/05/12/ASLR/image-20200511210943674-1589256958060.png" alt="image-20200511210943674">)<img src="/2020/05/12/ASLR/image-20200511211434269-1589256958060.png" alt="image-20200511211434269"></p></li><li><p>æœ€åè¿˜æœ‰ä¿®æ”¹ä¸€ä¸ªå±æ€§, å°±æ˜¯PEæ–‡ä»¶å¤´ <strong>_IMAGE_OPTIONAL_HEADER</strong></p><p>çš„<strong>SizeOfImage</strong>, ä¿®æ”¹ä¸ºå‡å» .relocèŠ‚åŒºåçš„å¤§å°  ä»ä¸Šé¢æˆ‘ä»¬çŸ¥é“.relocå¤§å°æ˜¯600h, è€Œè¯¥PEæ–‡ä»¶<strong>SectionAlignment(èŠ‚åœ¨å†…å­˜ä¸­çš„æœ€å°å•ä½ (å¯¹é½å•ä½) ä¸€èˆ¬ä¸º: 1000h)ä¸º1000h</strong>, 1000h &gt; 600h. ä»¥1000hå¯¹é½, æ‰€ä»¥æˆ‘ä»¬ç›´æ¥å°†<strong>SizeOfImage</strong>å‡å»1000hå³å¯.<img src="/2020/05/12/ASLR/image-20200511211537176-1589256958060.png" alt="image-20200511211537176">)<img src="/2020/05/12/ASLR/image-20200511212159056-1589256958060.png" alt="image-20200511212159056"></p><blockquote><p>å¦‚æœæƒ³å¢åŠ ä¸€ä¸ªèŠ‚åŒº, ä¹Ÿå¯ä»¥ä½¿ç”¨åŒæ ·çš„æ–¹æ³•</p></blockquote></li><li><p><strong>æœ€åä»¥ä¸Šæ˜¯å¯¹ç›®å‰ALSRå­¦ä¹ çš„æ€»ç»“(åˆšæ¥è§¦ä¸ä¹…),  å¦‚æœæœ‰é”™è¯¯çš„åœ°æ–¹è¯·å¤§å®¶æŒ‡æ­£.</strong> </p></li><li><p><strong>åŸCTFé¢˜ä¹Ÿé™„ä¸Š.</strong></p></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;å¼€å§‹æ˜¯ä¸€é“CTFé¢˜åŠ äº†UPXå£³,  åˆ©ç”¨å †æ ˆå¹³è¡¡è„±å£³,import recè¿›è¡ŒIATä¿®å¤å,ç¨‹åºä¸èƒ½æ­£å¸¸æ‰“å¼€äº†.  åæ¥æ‰çŸ¥é“æ˜¯å¼€å¯äº†ASLR, å…³é—­åå³å¯æ‰“å¼€.  ä½†æœ‰ä¸€ä¸ªé—®é¢˜æƒ³äº†å¾ˆä¹….  ä¸ºä»€ä¹ˆå¼€å¯äº†ASLRçš„ç¨‹åºåœ¨æœ‰å£³æ—¶å¯ä»¥æ‰“å¼€, è„±å£³åå°±æ‰“ä¸å¼€äº†å‘¢? ç›®å‰è§‰å¾—æ˜¯ åŠ å£³ä¼šå¯¹PEæ–‡ä»¶çš„é‡å®šä½è¡¨è¿›è¡Œå‹ç¼©,åœ¨ODç›´æ¥dumpå‡ºçš„ç¨‹åºæ˜¯ä¸¢å¤±é‡å®šä½è¡¨çš„, è€Œç¨‹åºåˆæ˜¯å¼€å¯äº†ASLR,é‚£ç¨‹åºè‡ªç„¶ä¼šè®¿é—®åˆ°æ— æ•ˆçš„åœ°å€è€Œæ‰“ä¸å¼€&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
    
      <category term="PE" scheme="https://hus96r.coding-pages.com/categories/PE/"/>
    
    
  </entry>
  
  <entry>
    <title>æ”»é˜²ä¸–ç•Œ (3)</title>
    <link href="https://hus96r.coding-pages.com/2020/05/03/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(3)/"/>
    <id>https://hus96r.coding-pages.com/2020/05/03/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(3)/</id>
    <published>2020-05-03T05:49:15.000Z</published>
    <updated>2020-05-27T03:41:02.471Z</updated>
    
    <content type="html"><![CDATA[<h3 id="easy-Maze"><a href="#easy-Maze" class="headerlink" title="easy_Maze"></a>easy_Maze</h3><ul><li><p>è¿™é“é¢˜è¿˜æ˜¯æŒºå¥½ç©çš„. </p></li><li><p>ç”±é¢˜ç›®æˆ‘ä»¬èƒ½çŸ¥é“æ˜¯å…³äºè¿·å®«çš„é¢˜. ä¸‹è½½ä¸‹æ¥æ˜¯elfæ–‡ä»¶, æŸ¥å£³åæ— å£³, åœ¨linuxä¸‹è¿è¡Œçœ‹çœ‹å¤§æ¦‚æµç¨‹. </p></li><li><p>è½½å…¥IDA, å…ˆåˆ†æäº†æ¥å—æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦çš„å‡½æ•°.  çŸ¥é“åœ¨å¤–é¢ä¸€å±‚çš„ä¸»å‡½æ•°æ˜¯å…ˆç”Ÿæˆä¸€ä¸ªæ¯è¡Œ7ä¸ªå…ƒç´ çš„æ•°ç»„. ç„¶åé€šè¿‡æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦æŒ‰æ§åˆ¶åœ¨çŸ©é˜µè¿·å®«ä¸­èµ°å‘, æœ€åæŒ‰ç…§è§„å®šçš„åˆ°è¾¾ä¸€ä¸ªç›®çš„åœ°.<a id="more"></a><img src="/2020/05/03/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(3)/image-20200504133456542.png" alt="image-20200504133456542"></p></li><li><p>æ¥ä¸‹æ¥è¿”å›å¤–ä¾§çš„ä¸»å‡½æ•°, å°±æ˜¯ç”ŸæˆçŸ©é˜µçš„äº†. é€šè¿‡ä¸Šé¢çš„49ä¸ªå…ƒç´ çŸ¥é“ä¸”ä¸‹é¢å‡½æ•°çš„å‚æ•°7, çŸ¥é“è§„æ¨¡ 7*7. <img src="/2020/05/03/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(3)/image-20200504133948097.png" alt="image-20200504133948097"></p></li><li><p>è¿›å…¥<strong>Step_0</strong> çœ‹çœ‹. å°±æ˜¯ç®€å•çš„æŠŠä¸Šé¢49ä¸ªå…ƒç´ èµ‹å€¼ç»™ v7 æ•°ç»„, ä¹Ÿå°è¯äº†æ•°ç»„æ˜¯7*7<img src="/2020/05/03/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(3)/image-20200506194728611.png" alt="image-20200506194728611"></p></li><li><p>æ¥ä¸‹æ¥ <strong>Step_1</strong>, çœ‹èµ·æ¥æ˜¯å¾ˆç®€æ´, ä½†é‡Œé¢çš„ <strong>getA</strong>ä¸ <strong>getAstart</strong> å‡½æ•° ç®—æ³•å¤ªå†—é•¿äº†.<img src="/2020/05/03/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(3)/image-20200506195403856.png" alt="image-20200506195403856"></p></li><li><p>è¿™ä¸ªæ—¶å€™, å¼€å§‹æˆ‘å°±æŠŠç”ŸæˆçŸ©é˜µçš„æ‰€æœ‰å‡½æ•°åŠæ•°æ®éƒ½å¤åˆ¶åˆ°<strong>VC</strong> ç¼–è¯‘å™¨ä¸­, å†æ ¹æ®æ ˆçš„ç‰¹ç‚¹æ”¹ä¸‹æ•°æ®çš„é¡ºåº(<strong>æ•°æ®å­˜æ”¾æ˜¯ä»ä¸‹å¾€ä¸Š, é‚£ä¹ˆæˆ‘ä»¬å–æ•°æ®æ—¶åœ°å€æ¯æ¬¡å‡1è€Œä¸æ˜¯åŠ ä¸€</strong>), ç„¶åè¿è¡Œæ‰“å°å‡ºçŸ©é˜µ. é—®é¢˜æ˜¯è¿è¡Œåä»€ä¹ˆä¹Ÿæ²¡æœ‰æ‰“å°, è°ƒè¯•å‘ç°ä¸€ä¸ªå‡½æ•°ä¸­çš„å†…å­˜ç©ºé—´å’Œå¦å¤–ä¸€ä¸ªå†²çª, ç›¸äº’è¦†ç›–å€¼. è¿™ä¸ªå‡½æ•°å¤ªå¤š,å…³è”æ€§å¤§, æ”¹èµ·æ¥ä¹Ÿéº»çƒ¦.</p></li><li><p>ç„¶åè½¬å‘GDBè°ƒè¯•, ä½†æ˜¯ä¸ç†Ÿç»ƒ. åˆè½¬å‘idaåŠ¨æ€è°ƒè¯•. é¦–å…ˆ<strong>åœ¨ IDA çš„å®‰è£…ç›®å½•/dbgsrc/æ‰¾åˆ° linux_server å’Œ linux_server64 æ‹·è´åˆ° linux</strong> ,åœ¨linuxä¸­è¿è¡Œ <strong>linux_server64</strong>, ç„¶ååœ¨Debuggerçš„ process options å¦‚ä¸‹å›¾æ ¼å¼é…ç½®. ç„¶åF9å¼€å§‹.</p><p><img src="/2020/05/03/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(3)/image-20200506202545180.png" alt="image-20200506202545180"></p></li><li><p>å…ˆä¸‹æ–­ç‚¹, æ‰¾åˆ°å‚¨å­˜çŸ©é˜µçš„ç©ºé—´çš„åœ°å€, æŠŠè¿™ä¸ªåœ°å€è½¬åˆ°æ•°æ®çª—å£è·Ÿéš, ç„¶åè¿è¡Œåˆ°ç”ŸæˆçŸ©é˜µçš„ä¸‹é¢ä¸€ä¸ªå‡½æ•°(ä¹Ÿå°±æ˜¯(<strong>Step_1</strong>ä¸‹é¢). åœ¨æ•°æ®çª—å£å‡ºç°æˆ‘ä»¬çš„æ•°æ®(intå‹), ç”±äºæ˜¯49ä¸ªå…ƒç´ , 49*4/16 = 12 â€¦4  ,é‚£å°±æ˜¯12è¡ŒåŠ 4ä¸ªæ•°æ®, <strong>shift+E</strong>æå–å‡ºCè¯­è¨€æ ¼å¼çš„æ•°æ®.<img src="/2020/05/03/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(3)/image-20200504135411101.png" alt="image-20200504135411101"></p></li><li><p>æ•°æ®å¾—åˆ°å, ç”¨Cè¯­è¨€æ‰“å°å‡ºæ¥å¥½è§‚å¯Ÿ, æ³¨æ„æ¯ä¸ªæ•°æ®4ä¸ªå­—èŠ‚(å°ç«¯). </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">union</span> <span class="comment">//æ¯ä¸ªæ•°æ®4ä¸ªå­—èŠ‚, ä¸”å°ç«¯. ç”¨è”åˆ</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ida_chars[<span class="number">196</span>];</span><br><span class="line"><span class="keyword">int</span> a[<span class="number">49</span>];</span><br><span class="line">&#125;A = &#123;</span><br><span class="line">    <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> (*p)[<span class="number">7</span>] = (<span class="keyword">int</span> (*)[<span class="number">7</span>])A.a;  <span class="comment">// å¼ºåˆ¶è½¬åŒ–ä¸ºæ•°ç»„æŒ‡é’ˆ, æ–¹ä¾¿åé¢æ‰“å°</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">7</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">7</span>; j++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d "</span>, p[i][j]);</span><br><span class="line">&#125; </span><br><span class="line"><span class="built_in">putchar</span>(<span class="number">10</span>);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2020/05/03/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(3)/image-20200506201841271.png" alt="image-20200506201841271"></p></li><li><p>æ ¹æ®æˆ‘ä»¬æ‰“æ¸¸æˆçš„ç†Ÿæ‚‰ aswd ,æœç€1èµ°åˆ°æœ€å.  <strong>ssddwdwdddsssaasasaaassddddwdds</strong> æœ€ååœ¨linuxä¸‹è¾“å…¥.</p><p><img src="/2020/05/03/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(3)/image-20200504140433640.png" alt="image-20200504140433640"></p></li><li><p><strong>æ€»ç»“: æ›´åŠ ç†Ÿæ‚‰äº†linuxåŠ¨æ€è°ƒè¯•çš„è¿ç”¨,  åŠ æ·±äº†æ•°ç»„æŒ‡é’ˆçš„ç†è§£.</strong></p></li></ul><hr><blockquote><h3 id="simple-check-100"><a href="#simple-check-100" class="headerlink" title="simple-check-100"></a>simple-check-100</h3></blockquote><ul><li><p>é¢˜ç›®æœ¬æ¥å¾ˆç®€å•, ä½†æ˜¯æœ‰å‘å•Šâ€¦</p></li><li><p>é¦–å…ˆ, é¢˜ç›®ä¸‹è½½ä¸‹æ¥, æœ‰ä¸‰ä¸ªç‰ˆæœ¬. ä¸‹æ„è¯†çš„é€‰æ‹©äº†ç†Ÿæ‚‰çš„.exeæ¥åˆ†æ. </p></li><li><p>æŸ¥å£³æ— å£³, ç”¨idaæ‰“å¼€. ç¬¬ä¸€ç›´è§‰å°±æ˜¯è¿™ä¸ªæœ€åçš„flagä¸æˆ‘ä»¬è¾“å…¥å­—ç¬¦æ²¡å…³ç³», ç›´æ¥ODåŠ¨æ€è°ƒè¯•è·³è¿‡åˆ¤æ–­æ¡ä»¶å°±å¥½äº†.</p></li><li><p>è¿˜æ˜¯å…ˆç»†çœ‹ä¸€ä¸‹æ ˆç©ºé—´, è™½ç„¶è¿˜æ˜¯å’Œæˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦æ²¡æœ‰å…³ç³». ä½†æ˜¯æœ‰é—®é¢˜å•Š,è¦ç”¨çš„åœ°å€äº¤å‰äº†.  æƒ³ç€ä¸‡ä¸€é¢˜å°±æ˜¯è¿™æ ·å‘¢, å…ˆå–ODè¯•ä¸€ä¸‹. ä¸å‡ºæ‰€æ–™, ä¹±ç ğŸ˜¢ </p></li><li><p>å¼€å§‹ä»”ç»†åˆ†æä¸‹è¿™ä¸ªé¢˜çš„æ ˆç©ºé—´, åœ¨ODåå¤è°ƒè¯•, å‘ç°æˆ‘ä»¬è¾“å…¥å­—ç¬¦çš„ç©ºé—´åªæœ‰19ä¸ªå­—èŠ‚å•Š, ä¸ºä»€ä¹ˆæˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦æ ˆç©ºé—´åœ¨ODä¸­è°ƒè¯•æœ‰19+32 = 51å­—èŠ‚ç©ºé—´.</p><p><img src="/2020/05/03/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(3)/image-20200506144401943.png" alt="image-20200506144401943"></p></li><li><p>çœ‹äº†åŠå¤©ä¸çŸ¥é“ä¸ºä»€ä¹ˆ, åé¢æ‰çœ‹è§ç¨‹åºä¸‹é¢æœ‰  <strong>v3 = alloca(32);</strong> ç™¾åº¦äº†ä¸€ä¸‹, è¿™ä¸ªæ˜¯å†æ ˆä¸Šç”³è¯·ç©ºé—´çš„å‡½æ•°. æ­£å¥½æ˜¯å¤šå‡ºæ¥çš„32. </p></li><li><p>ç»è¿‡åå¤è°ƒè¯•, è¿™ä¸ªé¢˜æ€ä¹ˆä¹Ÿå’Œæˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦æ²¡å…³ç³»å•Š, ç¨‹åºæ¯æ¬¡è¿‡äº†åˆ¤æ–­æ¡ä»¶, ç®—çš„éƒ½ä¸€æ ·. çœŸçš„å¥‡æ€ªäº†.</p></li><li><p>æœ€åæ²¡åŠæ³•äº†,æƒ³ä¸é€š.  å°±æœ€åå†æŠŠæ–‡ä»¶ä¸­è¿™ä¸ªç¨‹åºçš„linuxç‰ˆæœ¬è½½å…¥idaçœ‹çœ‹,  å—¯â€¦.è¿™ä¸ªç‰ˆæœ¬çš„æ ˆç©ºé—´å°±æ²¡æœ‰äº¤å‰. v7ä¸€ç›´åˆ°v34, æ²¡æœ‰åƒPEæ–‡ä»¶é‚£ä¸ªç‰ˆæœ¬åœ¨ä¸­é—´å¤šä¸€ä¸ªæŒ‡é’ˆ.<img src="/2020/05/03/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(3)/image-20200506145151730.png" alt="image-20200506145151730"></p></li><li><p>åœ¨linuxä¸‹åŠ¨æ€è°ƒè¯•.<img src="/2020/05/03/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(3)/image-20200506145627945.png" alt="image-20200506145627945"></p></li><li><p>ğŸ˜‚ä»€ä¹ˆé¬¼é¢˜. PEæ–‡ä»¶ç‰ˆæœ¬å±…ç„¶æ˜¯æœ‰é—®é¢˜çš„!!!</p></li><li><p><strong>æ€»ç»“: æ–‡ä»¶æœ‰å¤šä¸ªç‰ˆæœ¬çš„æ—¶å€™, æ³¨æ„!!! å¼ è§è¯†äº†. è™½ç„¶å¤šèŠ±äº†æ—¶é—´åœ¨PEä¸Šè€—, ä½†æ˜¯å¯¹æ ˆæ›´æ¸…æ¥šäº†.</strong></p></li></ul><hr><blockquote><h3 id="zorropub"><a href="#zorropub" class="headerlink" title="zorropub"></a>zorropub</h3></blockquote><ul><li><p>æŸ¥å£³æŸ¥ä½æ•°åè½½å…¥ida, æ•´ä½“æ€è·¯å¦‚ä¸‹.<img src="/2020/05/03/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(3)/image-20200508104152981.png" alt="image-20200508104152981"></p></li><li><p>é‚£å…¶å®æˆ‘ä»¬æ˜¯ä¸ç”¨ç®¡è¿™ä¸ª MD5 åŠ å¯†çš„ , ä¹Ÿä¸ä¼šè¿™ä¸ªè§£å¯†.  ç›´æ¥çˆ†ç ´æ‰¾åˆ° <strong>i</strong> å€¼ä»è€Œå¾—åˆ°éšæœºæ•°ç§å­.</p></li><li><p>é‚£é—®é¢˜æ¥äº†, çˆ†ç ´æ‰¾äº†ä¸€ä¸ª <strong>i</strong> å€¼æ˜¯1023, å°±åœ¨linuxå†™äº†exp(<strong>ä¸èƒ½åœ¨windowä¸‹, å› ä¸ºç”Ÿæˆéšæœºæ•°ä¸åŒ</strong>). ä½†å¾—åˆ°çš„æ•°æ®éƒ½æ˜¯ä¹±ç çš„, æˆ‘è¿˜æ˜¯ä¸€ç›´ä»¥ä¸ºé—®é¢˜å‡ºç°åœ¨ <strong>LOBYTE(å–æœ€ä½å­—èŠ‚ä½)</strong> å› ä¸ºç¬¬ä¸€æ¬¡æ¥è§¦. </p></li><li><p>æœ€åæ‰æƒ³èµ·é‚£ä¸ª <strong>i</strong> çš„å€¼, å®ƒå¯èƒ½ä¸æ˜¯å”¯ä¸€çš„. å¼€å§‹å†™exp, å–å¤§èŒƒå›´çš„æ•°æ®çˆ†ç ´, æœç„¶å¯¹äº†â€¦â€¦</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> *c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> b = <span class="number">0</span>, f = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> flag[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">srand(a);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">29</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">                b = rand()%<span class="number">1000</span>;</span><br><span class="line">                flag[i] = b^c[<span class="number">4</span>*i];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(flag[i] &gt; <span class="number">126</span> || flag[i] &lt; <span class="number">32</span>)</span><br><span class="line">f = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!f)</span><br><span class="line"><span class="built_in">puts</span>(flag);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, b = <span class="number">0</span>, j = <span class="number">0</span>, cnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> a[<span class="number">1000</span>] = &#123;</span><br><span class="line">  <span class="number">200</span>,   <span class="number">3</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">50</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">206</span>,   <span class="number">2</span>,</span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">2</span>,   <span class="number">3</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,</span><br><span class="line">  <span class="number">184</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">126</span>,   <span class="number">3</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">136</span>,   <span class="number">1</span>,</span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">73</span>,   <span class="number">3</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">2</span>,   <span class="number">0</span>,   <span class="number">0</span>,</span><br><span class="line">   <span class="number">94</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">52</span>,   <span class="number">2</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">84</span>,   <span class="number">3</span>,</span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>, <span class="number">163</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">150</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,</span><br><span class="line">   <span class="number">64</span>,   <span class="number">3</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">40</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">252</span>,   <span class="number">2</span>,</span><br><span class="line">   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">3</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">142</span>,   <span class="number">2</span>,   <span class="number">0</span>,   <span class="number">0</span>,</span><br><span class="line">   <span class="number">38</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">27</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">42</span>,   <span class="number">3</span>,</span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>, <span class="number">245</span>,   <span class="number">2</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">95</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,</span><br><span class="line">  <span class="number">104</span>,   <span class="number">3</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">235</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">121</span>,   <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">29</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">78</span>,   <span class="number">2</span>,   <span class="number">0</span>,   <span class="number">0</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">char</span> flag[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">100000</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">j = i;</span><br><span class="line"><span class="keyword">while</span>(j)</span><br><span class="line">&#123;</span><br><span class="line">cnt++;</span><br><span class="line">j &amp;= j<span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(cnt &gt; <span class="number">10</span>)</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(cnt == <span class="number">10</span>)</span><br><span class="line">func(i,  a);</span><br><span class="line"></span><br><span class="line">cnt = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2020/05/03/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(3)/image-20200508105155224.png" alt="image-20200508105155224"></p></li><li><p>ç„¶ååšå®Œ, è¿˜æ˜¯å»çœ‹çœ‹å¤§ä½¬çš„writeup. æƒ³çœ‹çœ‹é‚£ä¸ªmd5æ€è§£å¯†, ä½†æ˜¯æ²¡æœ‰.  å´å‘ç°å¥½å¤šéƒ½æ˜¯ç”¨çš„pwntoolså·¥å…·æ¥çˆ†ç ´çš„, è‡ªå·±ä¹Ÿå»è¯•äº†ä¸‹, ç¡®å®ç®€å•å¾ˆå¤š.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line">a = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">16</span>, <span class="number">0xffff</span>):</span><br><span class="line">    cnt = <span class="number">0</span></span><br><span class="line">    j = i</span><br><span class="line">    <span class="keyword">while</span>(j):</span><br><span class="line">        cnt += <span class="number">1</span></span><br><span class="line">        j &amp;= j<span class="number">-1</span></span><br><span class="line">    <span class="keyword">if</span> cnt == <span class="number">10</span>:</span><br><span class="line">        a.append(i)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    p = process(<span class="string">"./11"</span>)</span><br><span class="line">    p.recv()</span><br><span class="line">    p.sendline(<span class="string">'1'</span>)</span><br><span class="line">    p.sendline(str(i))</span><br><span class="line">    ans = p.recv()</span><br><span class="line">    <span class="keyword">if</span> <span class="string">"NULL"</span> <span class="keyword">in</span> text:</span><br><span class="line">        <span class="keyword">print</span> (text)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    p.close()</span><br></pre></td></tr></table></figure></li><li><p><strong>æ€»ç»“: (1)æ—¢ç„¶æ˜¯çˆ†ç ´å°±è¦æ³¨æ„æœ‰å¤šç§æƒ…å†µ (2) LOBYTE æ˜¯idaçš„å®å®šä¹‰, å–æœ€ä½å­—èŠ‚ä½. (3)æ›´åŠ ç†Ÿæ‚‰pwntoolså·¥å…·çš„ä½¿ç”¨.</strong></p></li></ul><hr><blockquote><h3 id="BABYRE"><a href="#BABYRE" class="headerlink" title="BABYRE"></a>BABYRE</h3></blockquote><ul><li><p>é¢˜ç›®ä¸éš¾, ä½†æ˜¯ç¬¬ä¸€æ¬¡é‡åˆ°è¿™æ ·çš„é¢˜.</p></li><li><p>64ä½elfæ–‡ä»¶, idaæ‰“å¼€å, å’Œä»¥å¾€çš„æ–‡ä»¶ä¸ä¸€æ ·, å¼€å§‹æœ‰ä¸€æ®µå¾ªç¯è®¡ç®—èµ‹å€¼çš„æ“ä½œ,ä½†æ˜¯åˆæ˜¯çœ‹ä¸åˆ°åˆ°åº•æ˜¯èµ‹å€¼ç»™äº†è°.<img src="/2020/05/03/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(3)/image-20200512134025680.png" alt="image-20200512134025680"></p></li><li><p>é‚£å°±åŠ¨æ€è°ƒè¯•è·Ÿæ¥çœ‹çœ‹, åˆ°äº†åˆ¤æ–­æ¡ä»¶çš„æ—¶å€™. æ˜ç™½äº†å°±æ˜¯ç±»ä¼¼åŠ å£³çš„ç¨‹åºæ‰“å¼€ä¼šå…ˆè¿›è¡Œè§£å‹ç”Ÿæˆä»£ç . è¿™é‡Œå¼€å§‹é‚£ä¸€æ®µå¾ªç¯ä½œç”¨, å°±æ”¹å˜æˆ‘ä»¬ä»£ç çš„.</p></li><li><p>è·Ÿè¿›åˆ¤æ–­å‡½æ•°, ç®—æ³•å¾ˆç®€å•,ç›´æ¥è¯»æ±‡ç¼–,  å°±æ˜¯ä¸€ä¸ªå¼‚æˆ–æ“ä½œç„¶åå¯¹æ¯”. </p><p><img src="/2020/05/03/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(3)/image-20200512133918795.png" alt="image-20200512133918795"></p></li><li><p>exp:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> a[] = &#123;<span class="number">0x66</span>, <span class="number">0x6D</span>, <span class="number">0x63</span>, <span class="number">0x64</span>, <span class="number">0x7F</span>, <span class="number">0x6B</span>, <span class="number">0x37</span>, <span class="number">0x64</span>,  <span class="number">0x3B</span>, <span class="number">0x56</span>, <span class="number">0x60</span>, <span class="number">0x3B</span>, <span class="number">0x6E</span>, <span class="number">0x70</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> flag[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;; </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt;= <span class="number">13</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">flag[i] = a[i] ^ i; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(flag);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>æ€»ç»“: ç®—æ˜¯é•¿è§è¯†å§.</strong></p></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;easy-Maze&quot;&gt;&lt;a href=&quot;#easy-Maze&quot; class=&quot;headerlink&quot; title=&quot;easy_Maze&quot;&gt;&lt;/a&gt;easy_Maze&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;è¿™é“é¢˜è¿˜æ˜¯æŒºå¥½ç©çš„. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ç”±é¢˜ç›®æˆ‘ä»¬èƒ½çŸ¥é“æ˜¯å…³äºè¿·å®«çš„é¢˜. ä¸‹è½½ä¸‹æ¥æ˜¯elfæ–‡ä»¶, æŸ¥å£³åæ— å£³, åœ¨linuxä¸‹è¿è¡Œçœ‹çœ‹å¤§æ¦‚æµç¨‹. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;è½½å…¥IDA, å…ˆåˆ†æäº†æ¥å—æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦çš„å‡½æ•°.  çŸ¥é“åœ¨å¤–é¢ä¸€å±‚çš„ä¸»å‡½æ•°æ˜¯å…ˆç”Ÿæˆä¸€ä¸ªæ¯è¡Œ7ä¸ªå…ƒç´ çš„æ•°ç»„. ç„¶åé€šè¿‡æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦æŒ‰æ§åˆ¶åœ¨çŸ©é˜µè¿·å®«ä¸­èµ°å‘, æœ€åæŒ‰ç…§è§„å®šçš„åˆ°è¾¾ä¸€ä¸ªç›®çš„åœ°.&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;
    
    </summary>
    
    
      <category term="æ”»é˜²ä¸–ç•Œ" scheme="https://hus96r.coding-pages.com/categories/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/"/>
    
    
      <category term="CTF" scheme="https://hus96r.coding-pages.com/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>æ”»é˜²ä¸–ç•Œ (2)</title>
    <link href="https://hus96r.coding-pages.com/2020/04/29/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(2)/"/>
    <id>https://hus96r.coding-pages.com/2020/04/29/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(2)/</id>
    <published>2020-04-29T06:53:15.000Z</published>
    <updated>2020-05-27T03:40:40.324Z</updated>
    
    <content type="html"><![CDATA[<h3 id="Windows-Reverse2"><a href="#Windows-Reverse2" class="headerlink" title="Windows_Reverse2"></a>Windows_Reverse2</h3><ul><li><p>é¦–å…ˆ,å› ä¸ºæ˜¯ä¸ª.exeæ–‡ä»¶, å…ˆæ‰“å¼€çœ‹ä¸€ä¸‹ç¨‹åºæ˜¯åšä»€ä¹ˆçš„, å‡ºç° <strong>input code:</strong> ä¹Ÿå°±æ˜¯è®©æˆ‘ä»¬è¾“å…¥ä¸€ä¸ªå¯†ç éªŒè¯.</p></li><li><p>ç”¨idaæ‰“å¼€, è¿˜æ˜¯å…ˆ shift + 12 æœç´¢ä¸€ä¸‹å­—ç¬¦ä¸², ç„¶è€Œå¹¶æ²¡æœ‰å‘ç°æˆ‘ä»¬æ‰“å¼€ç¨‹åºçœ‹åˆ°çš„ *<em>input code: *</em>,å¹¶ä¸”ç¨‹åºå‡½æ•°ä¹Ÿå¾ˆå°‘, é‚£å°±æ˜¯åŠ å£³äº†çš„. å¼€å§‹ä¹Ÿå¿˜äº†ç”¨è½¯ä»¶æŸ¥ä¸€ä¸‹å£³.</p></li><li><p>é‚£ä¹ˆç”¨ODæ‰“å¼€, ä½¿ç”¨å †æ ˆå¹³è¡¡çš„æ–¹æ³•, æ‰¾åˆ°ç¨‹åºçš„ OEP, ç„¶ådump, ä½†æ˜¯æ³¨æ„æ”¹ä¸€ä¸‹åŠ è½½çš„åˆå§‹åœ°å€å’Œå…¥å£ç‚¹,   è¿™ä¸ªç¨‹åºå¹¶ä¸æ˜¯ 0x400000å¼€å§‹, æ¯æ¬¡åŠ è½½éƒ½æ˜¯ä¸ä¸€æ ·çš„åœ°å€,åº”è¯¥æ˜¯ ASLRä¿æŠ¤æŠ€æœ¯å§, ä¹‹å‰æœ‰äº†è§£è¿‡ä¸€äº›.é€šè¿‡å†…å­˜çª—å£, çŸ¥é“äº†æ˜¯ 0x1F0000.<a id="more"></a></p><p><img src="/2020/04/29/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(2)/image-20200429150859645.png" alt="image-20200429150859645"></p></li><li><p>dumpå‡ºå,ä½†æ˜¯æ‰“ä¸å¼€, ä¹‹å‰å­¦ä¹ è„±å£³æ—¶äº†è§£è¿‡,ä½†æ˜¯æ²¡æœ‰å®è·µ. å°±å»ä¸‹è½½<strong>import rec</strong>,ä½†æ‰“å¼€æ‰¾ä¸åˆ°æ¡Œé¢çš„æ–‡ä»¶,  è¯•äº†å¥½å‡ ä¸ªä¹Ÿä¸è¡Œ, ç™¾åº¦ä¹Ÿæ— æœ. ä¹Ÿä¸æƒ³ç”¨è„±å£³è½¯ä»¶,ä¸»è¦æƒ³æ“ä½œä¸€ä¸‹. å…¶å®å¯¹äºå»idaåç¼–è¯‘å·²ç»è¶³å¤Ÿäº†,å› ä¸ºé‚£ä¸ªåªæ˜¯ä¼šå½±å“åŠ¨æ€é“¾æ¥çš„å‡½æ•°.</p></li><li><p>idaå†æ¬¡æ‰“å¼€å, æ‰¾åˆ°ä¸»å‡½æ•°, è½¬æ¢ä¸ºä¼ªä»£ç , é€»è¾‘å¾ˆç®€å•, å°±æ˜¯æŠŠæˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦å…ˆè¿›è¡Œåˆ¤æ–­,ç„¶åè¿›è¡ŒåŠ å¯†,ä¸ç¼–ç çš„å­—ç¬¦å¯¹æ¯”. å…ˆçœ‹åˆ¤æ–­å‡½æ•°.</p><p><img src="/2020/04/29/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(2)/image-20200429152407648-1590489723012.png" alt="image-20200429152407648"></p></li><li><p>ç„¶åçœ‹å…³é”®çš„åŠ å¯†å‡½æ•°, å‘ç°æœ€ä¸‹é¢è¿˜æœ‰ä¸€ä¸ªå‡½æ•° sub_A71000.</p><p><img src="/2020/04/29/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(2)/image-20200429162141561-1590490034442.png" alt="image-20200429162141561"></p></li><li><p>sub_A7100, åˆšå¼€å§‹çœ‹è¿™ä¸ªå‡½æ•°è§‰å¾—å¾ˆéº»çƒ¦, ä½†æ˜¯ä»ä»¥å‰åšçš„é¢˜æ¥çœ‹, å¹¶ä¸”è¿™ä¸ªå‡½æ•°æœ‰ &gt;&gt; è¿ç®—ç¬¦. å¯ä»¥å¾€baseç¼–ç è€ƒè™‘, é‚£å°±å…ˆçœ‹çœ‹æœ‰æ²¡æœ‰baseç¼–ç çš„æ ‡å¿—.</p><p><img src="/2020/04/29/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(2)/image-20200429155217177-1590489885930.png" alt="image-20200429155217177"></p></li><li><p>åˆ°äº†è¿™é‡Œ , å¯ä»¥çŸ¥é“, ç¨‹åºåªæ˜¯æ ‡å‡†ç æ¢äº†ä¸€ä¸‹. æˆ‘ä»¬å°±ç”¨ç¨‹åºç¼–ç çš„æ•°æ®å’Œ 0x76 å¼‚æˆ–è¿ç®—å¾—åˆ° å¾—åˆ°è¿™é‡Œçš„base64 çš„ç . ç„¶åè¿™ä¸ªç å»è§£ç åé¢ç”¨æ¥åšæ¯”è¾ƒçš„å­—ç¬¦,å¾—åˆ°ç¬¬ä¸€æ¬¡è½¬æ¢åçš„ç»“æœ. ä½†æ˜¯å¼‚æˆ–è¿ç®—å, æˆ‘ä»¬å‘ç°è¿™ä¸ªç å°±æ˜¯base64æ ‡å‡†ç .</p><p><img src="/2020/04/29/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(2)/image-20200429160021209-1590489939494.png" alt="image-20200429160021209"></p></li><li><p>æœ€å, çŸ¥é“å¼€å§‹æ˜¯æŠŠæˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦è¿›è¡Œæ•°å€¼è½¬æ¢çš„, é‚£ä¹ˆæœ€åè§£ç åæˆ‘ä»¬ä¹Ÿè¦è¿˜åŸä¸€ä¸‹. æ‡’å¾—Cè¯­è¨€è‡ªå·±å†™äº†, ç”¨ python çš„ hex(). æœ€å flagå°±æ˜¯  <strong>ADEBDEAEC7BE</strong> </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">s =  base64.b64decode(<span class="string">'reverse+'</span>)</span><br><span class="line"><span class="keyword">print</span> (type(s)) / åˆšå­¦python,æŸ¥çœ‹ä¸€ä¸‹æ˜¯ä»€ä¹ˆç±»å‹,å› ä¸ºç”¨hex(), å‘ç° list, tupleéƒ½æ²¡æœ‰ hex().</span><br><span class="line"><span class="keyword">print</span> (s.hex().upper())</span><br></pre></td></tr></table></figure><p><img src="/2020/04/29/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(2)/image-20200501113755270-1590490003811.png" alt="image-20200501113755270"></p></li><li><p><strong>æ€»ç»“: 1.é¢˜ç›®æœ‰æ—¶å€™çœ‹èµ·æ¥ä»£ç å¾ˆå†—é•¿, ä½†é€»è¾‘ä¸éš¾çš„, ç»†å¿ƒåˆ†æä¸€ä¸‹.  è¦æ³¨æ„baseå®¶æ—çš„ç¼–ç ä¸è§£ç .   2.æ­£åœ¨å­¦ä¹ pythonä¸­, æ¯æ¬¡å†™pythonè„šæœ¬éƒ½æœ‰æ”¶è·.</strong></p></li></ul><table><thead><tr><th>å­—ç¬¦ä¸²å‰æ·»åŠ r , è¡¨ç¤ºåç»­çš„å­—ç¬¦ä¸²åŸæ ·è¾“å‡º, ä¸è¿›è¡Œè½¬ä¹‰. å¦‚ \\ è½¬ä¹‰åä¸º \</th></tr></thead><tbody><tr><td><strong>å­—ç¬¦ä¸²å‰æ·»åŠ b, åé¢å­—ç¬¦ä¸²æ˜¯bytes ç±»å‹</strong></td></tr><tr><td><strong>åœ¨ Python3 ä¸­ï¼Œbytes å’Œ str çš„äº’ç›¸è½¬æ¢æ–¹å¼æ˜¯:str.encode(â€˜utf-8â€™)   bytes.decode(â€˜utf-8â€™)</strong></td></tr></tbody></table><hr><h3 id="Windows-Reverse1"><a href="#Windows-Reverse1" class="headerlink" title="Windows_Reverse1"></a>Windows_Reverse1</h3><ul><li><p>é¦–å…ˆè¿™é“é¢˜ä¸ä¸Šé¢çš„ä¸€é“æ˜¯ä¸€èµ·çš„, åšäº†ä¸Šé¢çš„ä¸€é“é¢˜, è§‰å¾—åº”è¯¥è¿˜æ˜¯æœ‰å£³çš„, æŸ¥ä¸€ä¸‹æ˜¯ upx.</p></li><li><p>è½½å…¥ODè¿˜æ˜¯ä½¿ç”¨å †æ ˆå¹³è¡¡çš„åŸç†è„±å£³, å‘ç°åŒæ ·æ˜¯æ¯æ¬¡è½½å…¥çš„åœ°å€ä¸ä¸€æ ·, è„±å£³åè¿˜æ˜¯ä¸èƒ½è¿è¡Œ, è¿˜æ˜¯è¦ä¿®å¤è¾“å…¥è¡¨, ä½†import recåˆæ‰¾ä¸åˆ°æˆ‘ç”µè„‘çš„æ–‡ä»¶â€¦â€¦.å°±å…ˆæŠŠé¢˜åšäº†å†æ¥ç ”ç©¶.</p></li><li><p>idaè½½å…¥åååˆ†ç®€æ´. ä¸€ä¸ªåŠ å¯†å‡½æ•°åè¿›è¡Œåˆ¤æ–­. çœ‹åŠ å¯†å‡½æ•°.<img src="/2020/04/29/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(2)/image-20200430190548596-1590490212309.png" alt="image-20200430190548596"></p></li><li><p>å› ä¸ºä¸Šé¢çš„ Reverse1 ä¹Ÿæ˜¯åˆåŒæ ·çš„é—®é¢˜(<strong>ä¸åŒçš„å˜é‡å¦‚ä½•è”ç³»åœ¨ä¸€èµ·çš„</strong>), å˜é‡åœ°å€æ˜¯ç›¸åŒçš„. å°±å…ˆçœ‹çœ‹ä¸Šé¢ <strong>v1çš„åœ°å€, å‘ç°æ˜¯ ecx ä¼ æ¥çš„</strong>, é‚£å†çœ‹çœ‹ä¸Šä¸€å±‚å‡½æ•°çš„ ecx . å‘ç°åœ¨è°ƒç”¨è¿™ä¸ªåŠ å¯†å‡½æ•°ä¹‹å‰æœ‰ä¸€ä¸ªecxèµ‹å€¼. <strong>è€Œè¦ç”¨æ¥æœ€åæ¯”è¾ƒçš„ v4å˜é‡, å®ƒçš„åœ°å€å’Œä¼ ç»™ecxæ˜¯ä¸€æ ·çš„</strong>.  <strong><em>é‚£è¿™é‡Œå°±æ˜¯é€šè¿‡å¯„å­˜å™¨ä¼ é€’çš„å‚æ•°.</em></strong></p></li><li><p>ä¸Šé¢çš„ä»£ç è§‰å¾—å¥‡æ€ª, æ€€ç–‘æ˜¯idaçš„åŸå› , æŠŠåŸç¨‹åºåˆ° OD åŠ¨æ€è°ƒè¯•çœ‹ä¸€ä¸‹åŠ å¯†å‡½æ•°.  æ¸…æ™°å¾ˆå¤š.</p><p><img src="/2020/04/29/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(2)/image-20200430192452991-1590490227510.png" alt="image-20200430192452991"></p><p>æ‰€ä»¥è¿™ä¸ªå‡½æ•°å°±æ˜¯é€šè¿‡æˆ‘ä»¬è¾“å…¥çš„ASCIIä¸ºç´¢å¼•å€¼æ¥ä¾æ¬¡å–å‡ºç¼–ç å­—ç¬¦çš„æ•°æ®, æœ€å<strong>DDCTF{reverseME}</strong>è¿›è¡Œæ¯”è¾ƒ.</p></li><li><p>å¯ä»¥çœ‹åˆ°æ˜¯ä» 0x402FF8 ä¸ºé¦–åœ°å€å¼€å§‹ç´¢å¼•, ä½†æ˜¯ä»idaä¸­å¯ä»¥çŸ¥é“ å¯æ‰“å°å­—ç¬¦æ˜¯ä»0x403018å¼€å§‹çš„.<img src="/2020/04/29/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(2)/image-20200430200350749-1590490244163.png" alt="image-20200430200350749"></p></li><li><p>æœ€å,æˆ‘é‡åˆ°çš„å¾ˆå¤§çš„å‘â€¦..ğŸ¤£, å­—ç¬¦ä¸²å¤åˆ¶ä¸‹æ¥å, æˆ‘æ²¡æœ‰å¤„ç†å…¶ä¸­çš„  \  çš„å­—ç¬¦, é‚£ä¹ˆå°±è¢«é»˜è®¤ä¸ºè½¬ä¹‰å­—ç¬¦äº†, å¯¼è‡´2ä¸ªå­—ç¬¦å˜æˆä¸€ä¸ª, æœ€åç»“æœè‚¯å®šé”™.  èŠ±äº†å¥½å¤šæ—¶é—´æ‰¾è¿™ä¸ªé”™è¯¯, è¿˜æ˜¯æ²¡æœ‰åœ¨ç»†èŠ‚ä¸Šæ³¨æ„ğŸ˜¢.   <strong>exp:</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> a[] = <span class="string">"~&#125;|&#123;zyxwvutsrqponmlkjihgfedcba`_^]\\[ZYXWVUTSRQPONMLKJIHGFEDCBA@?&gt;=&lt;;:9876543210/.-,+*)(',27h,'&amp;%$#\"! "</span>; </span><br><span class="line"><span class="keyword">char</span> b[] = <span class="string">"DDCTF&#123;reverseME&#125;"</span>;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> flag[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(b); i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="built_in">strlen</span>(a); j++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(a[j] == b[i])</span><br><span class="line">&#123;</span><br><span class="line">flag[i] = j + <span class="number">0x20</span>;</span><br><span class="line"><span class="keyword">break</span>; </span><br><span class="line">&#125; </span><br><span class="line">&#125; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(flag);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>åšå®Œå,å¼€å§‹å»äº†è§£ <strong>ASLR</strong>, çŸ¥é“äº†å¼€å¯ASLRçš„PEæ–‡ä»¶ä¼šå¤šäº†ä¸€ä¸ª.relocèŠ‚åŒº, ä¸”IMAGE_OPTIONAL_HEADER32ç»“æ„ä¸­çš„DllCharacteristicså¤šäº†ä¸€ä¸ªå±æ€§. å¦‚æœä¸€ä¸ªç¨‹åºå¼€å¯äº†ASLRä¿æŠ¤, æˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªDllCharacteristicsçš„å€¼ä»<strong>8140</strong>æ”¹ä¸º<strong>8100</strong>ä»è€Œå…³é—­ASLR.<img src="/2020/04/29/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(2)/image-20200430204438115-1590490290134.png" alt="image-20200430204438115"></p></li><li><p><strong>æ€»ç»“: (1)ä¸€ä¸ªç¨‹åºä¸­çš„å‚æ•°å¯èƒ½ä¼šä»¥å¯„å­˜å™¨çš„æ¥ä¼ é€’ (2)å­—ç¬¦ä¸²ä¸­æ³¨æ„ \ å­—ç¬¦, è¦ç”¨ \\æ¥è¡¨ç¤º \ å­—ç¬¦. (3)ç¨‹åºçš„ASLRçš„å¼€å¯æ ‡å¿—åŠå…³é—­æ–¹æ³•.</strong> </p></li></ul><hr><h3 id="gametime"><a href="#gametime" class="headerlink" title="gametime"></a>gametime</h3><ul><li><p>é¦–å…ˆæŸ¥å£³, å‘ç°æ— å£³. æ‰“å¼€ç¨‹åºçœ‹ä¸€ä¸‹.   æœç„¶æ˜¯ä¸€ä¸ªæ¸¸æˆ, ç®€å•çš„çœ‹äº†ä¸€ä¸‹, æ˜¯è®©æˆ‘ä»¬åœ¨è§„å®šæ—¶é—´è¾“å…¥å±å¹•ä¸Šæ˜¾ç¤ºçš„å­—ç¬¦. </p></li><li><p>idaæ‰“å¼€, çœ‹ä¼ªä»£ç , å¾ˆå†—é•¿,  å‘ä¸‹æµè§ˆä¸€ä¸‹å¯ä»¥çœ‹è§å¥½å‡ ä¸ªåˆ¤æ–­å‡½æ•°. ä¸”éƒ½æ˜¯ä¸€ä¸ªå‡½æ•°, ç¨‹åºè‚¯å®šä¸åº”è¯¥æ˜¯é€€å‡º. æˆ‘ä»¬çš„ç›®çš„å°±æ˜¯è®©å®ƒçš„è¿”å›å€¼ä¸º <strong>é0</strong></p><p><img src="/2020/04/29/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(2)/image-20200501104557726-1590490317124.png" alt="image-20200501104557726"></p></li><li><p>è¿›å…¥ sub_401507 çœ‹çœ‹. å‘ç°è¿˜æœ‰ä¸ªåˆ¤æ–­çš„åœ°æ–¹, <strong>æˆ‘ä»¬çš„ç›®çš„: è®©å®ƒè¿”å›1</strong> è®°å½•ä¸‹åœ°å€. <strong>0x00401563</strong>. <img src="/2020/04/29/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(2)/image-20200501105251204-1590490324745.png" alt="image-20200501105251204"></p></li><li><p>æ­¤æ—¶ç¨‹åºä¸‹é¢è¿˜æœ‰ç±»ä¼¼çš„åˆ¤æ–­å‡½æ•°, é‚£ä¹ˆç›¸åŒçš„æ–¹æ³•, å…ˆæ‰¾åˆ°åœ°å€, è®°å½•ä¸‹æ¥.</p></li><li><p>æœ€åå‘ç°, ç¨‹åºçš„æ ¸å¿ƒåˆ¤æ–­å‡½æ•°å°±åªæœ‰2ä¸ª.  åœ°å€åˆ†åˆ«ä¸º:  <strong>0x00401563</strong> ,  <strong>0x004014DB</strong> </p></li><li><p>æŠŠç¨‹åºè½½å…¥OD. è·³åˆ°æˆ‘ä»¬æ‰¾åˆ°çš„åœ°å€, å‘ç°åœ°å€å¯¹ä¸ä¸Š, é‚£ç¨‹åºæ˜¯å¼€å¯äº† ASLR çš„, ä½†æ˜¯ RVA æ˜¯ä¸€æ ·çš„, ç®€å•çš„ç®—ä¸€ä¸‹å°±å¯ä»¥äº†.   å¦å¤–ä¸€ä¸ªåœ°å€, ç›¸åŒçš„æ“ä½œ.<img src="/2020/04/29/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(2)/image-20200501110440340-1590490372567.png" alt="image-20200501110440340"></p></li><li><p>æœ€åF9è¿è¡Œ, æ¸¸æˆè¿›è¡Œä¸€æ®µæ—¶é—´, å‡ºç°flag. <img src="/2020/04/29/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(2)/image-20200501110942866.png" alt="image-20200501110942866"></p></li><li><p><strong>æ€»ç»“: ç®€å•çš„åŠ¨æ€è°ƒè¯•çš„åº”ç”¨, æ³¨æ„åœ°å€æ˜¯ä¸æ˜¯ image base.</strong></p></li></ul><hr><h3 id="Replace"><a href="#Replace" class="headerlink" title="Replace"></a>Replace</h3><ul><li><p>é¦–å…ˆæŸ¥å£³, å‘ç°æ˜¯ upx. è½½å…¥OD, å‡†å¤‡è„±å£³, ä½†æ˜¯å‘ç° <strong>VA</strong> ä¸æ˜¯é»˜è®¤åŠ è½½çš„0x400000, åº”è¯¥æ˜¯å¼€å¯äº† ASLR.  è½¬åˆ°010editor,æ‰¾åˆ° <strong>struct DLL_CHARACTERISTICS DllCharacteristics</strong>, å°†8140æ”¹ä¸º8100.<img src="/2020/04/29/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(2)/image-20200502082437777-1590490407479.png" alt="image-20200502082437777"></p></li><li><p>æ¥ä¸‹æ¥, é‡æ–°è½½å…¥OD,ä½¿ç”¨å †æ ˆå¹³è¡¡æ‰¾åˆ°ç¨‹åº EOP, ç„¶å dump.</p></li><li><p>è„±å£³åè½½å…¥IDA, ç¨‹åºé€»è¾‘ç®€å•, é¦–å…ˆé™åˆ¶é•¿åº¦ &lt;= 37, ç„¶åä¸€ä¸ªåˆ¤æ–­å‡½æ•°, æˆ‘ä»¬è¿›å…¥: ç®—æ³•ä¹Ÿä¸éš¾.<img src="/2020/04/29/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(2)/image-20200502083116266-1590490428595.png" alt="image-20200502083116266"></p></li><li><p>exp:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> a[] = &#123;</span><br><span class="line">   <span class="number">50</span>,  <span class="number">97</span>,  <span class="number">52</span>,  <span class="number">57</span>, <span class="number">102</span>,  <span class="number">54</span>,  <span class="number">57</span>,  <span class="number">99</span>,  <span class="number">51</span>,  <span class="number">56</span>, </span><br><span class="line">   <span class="number">51</span>,  <span class="number">57</span>,  <span class="number">53</span>,  <span class="number">99</span>, <span class="number">100</span>, <span class="number">101</span>,  <span class="number">57</span>,  <span class="number">54</span>, <span class="number">100</span>,  <span class="number">54</span>, </span><br><span class="line">  <span class="number">100</span>, <span class="number">101</span>,  <span class="number">57</span>,  <span class="number">54</span>, <span class="number">100</span>,  <span class="number">54</span>, <span class="number">102</span>,  <span class="number">52</span>, <span class="number">101</span>,  <span class="number">48</span>, </span><br><span class="line">   <span class="number">50</span>,  <span class="number">53</span>,  <span class="number">52</span>,  <span class="number">56</span>,  <span class="number">52</span>,  <span class="number">57</span>,  <span class="number">53</span>,  <span class="number">52</span>, <span class="number">100</span>,  <span class="number">54</span>, </span><br><span class="line">   <span class="number">49</span>,  <span class="number">57</span>,  <span class="number">53</span>,  <span class="number">52</span>,  <span class="number">52</span>,  <span class="number">56</span>, <span class="number">100</span>, <span class="number">101</span>, <span class="number">102</span>,  <span class="number">54</span>, </span><br><span class="line">  <span class="number">101</span>,  <span class="number">50</span>, <span class="number">100</span>,  <span class="number">97</span>, <span class="number">100</span>,  <span class="number">54</span>,  <span class="number">55</span>,  <span class="number">55</span>,  <span class="number">56</span>,  <span class="number">54</span>, </span><br><span class="line">  <span class="number">101</span>,  <span class="number">50</span>,  <span class="number">49</span>, <span class="number">100</span>,  <span class="number">53</span>,  <span class="number">97</span>, <span class="number">100</span>,  <span class="number">97</span>, <span class="number">101</span>,  <span class="number">54</span>, </span><br><span class="line">    <span class="number">0</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">char</span> b[] = &#123;</span><br><span class="line">   <span class="number">97</span>,  <span class="number">52</span>,  <span class="number">57</span>, <span class="number">102</span>,  <span class="number">54</span>,  <span class="number">57</span>,  <span class="number">99</span>,  <span class="number">51</span>,  <span class="number">56</span>, </span><br><span class="line">   <span class="number">51</span>,  <span class="number">57</span>,  <span class="number">53</span>,  <span class="number">99</span>, <span class="number">100</span>, <span class="number">101</span>,  <span class="number">57</span>,  <span class="number">54</span>, <span class="number">100</span>,  <span class="number">54</span>, </span><br><span class="line">  <span class="number">100</span>, <span class="number">101</span>,  <span class="number">57</span>,  <span class="number">54</span>, <span class="number">100</span>,  <span class="number">54</span>, <span class="number">102</span>,  <span class="number">52</span>, <span class="number">101</span>,  <span class="number">48</span>, </span><br><span class="line">   <span class="number">50</span>,  <span class="number">53</span>,  <span class="number">52</span>,  <span class="number">56</span>,  <span class="number">52</span>,  <span class="number">57</span>,  <span class="number">53</span>,  <span class="number">52</span>, <span class="number">100</span>,  <span class="number">54</span>, </span><br><span class="line">   <span class="number">49</span>,  <span class="number">57</span>,  <span class="number">53</span>,  <span class="number">52</span>,  <span class="number">52</span>,  <span class="number">56</span>, <span class="number">100</span>, <span class="number">101</span>, <span class="number">102</span>,  <span class="number">54</span>, </span><br><span class="line">  <span class="number">101</span>,  <span class="number">50</span>, <span class="number">100</span>,  <span class="number">97</span>, <span class="number">100</span>,  <span class="number">54</span>,  <span class="number">55</span>,  <span class="number">55</span>,  <span class="number">56</span>,  <span class="number">54</span>, </span><br><span class="line">  <span class="number">101</span>,  <span class="number">50</span>,  <span class="number">49</span>, <span class="number">100</span>,  <span class="number">53</span>,  <span class="number">97</span>, <span class="number">100</span>,  <span class="number">97</span>, <span class="number">101</span>,  <span class="number">54</span>, </span><br><span class="line">    <span class="number">0</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> flag[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> c[] = &#123;</span><br><span class="line">   <span class="number">99</span>, <span class="number">124</span>, <span class="number">119</span>, <span class="number">123</span>, <span class="number">242</span>, <span class="number">107</span>, <span class="number">111</span>, <span class="number">197</span>,  <span class="number">48</span>,   <span class="number">1</span>, </span><br><span class="line">  <span class="number">103</span>,  <span class="number">43</span>, <span class="number">254</span>, <span class="number">215</span>, <span class="number">171</span>, <span class="number">118</span>, <span class="number">202</span>, <span class="number">130</span>, <span class="number">201</span>, <span class="number">125</span>, </span><br><span class="line">  <span class="number">250</span>,  <span class="number">89</span>,  <span class="number">71</span>, <span class="number">240</span>, <span class="number">173</span>, <span class="number">212</span>, <span class="number">162</span>, <span class="number">175</span>, <span class="number">156</span>, <span class="number">164</span>, </span><br><span class="line">  <span class="number">114</span>, <span class="number">192</span>, <span class="number">183</span>, <span class="number">253</span>, <span class="number">147</span>,  <span class="number">38</span>,  <span class="number">54</span>,  <span class="number">63</span>, <span class="number">247</span>, <span class="number">204</span>, </span><br><span class="line">   <span class="number">52</span>, <span class="number">165</span>, <span class="number">229</span>, <span class="number">241</span>, <span class="number">113</span>, <span class="number">216</span>,  <span class="number">49</span>,  <span class="number">21</span>,   <span class="number">4</span>, <span class="number">199</span>, </span><br><span class="line">   <span class="number">35</span>, <span class="number">195</span>,  <span class="number">24</span>, <span class="number">150</span>,   <span class="number">5</span>, <span class="number">154</span>,   <span class="number">7</span>,  <span class="number">18</span>, <span class="number">128</span>, <span class="number">226</span>, </span><br><span class="line">  <span class="number">235</span>,  <span class="number">39</span>, <span class="number">178</span>, <span class="number">117</span>,   <span class="number">9</span>, <span class="number">131</span>,  <span class="number">44</span>,  <span class="number">26</span>,  <span class="number">27</span>, <span class="number">110</span>, </span><br><span class="line">   <span class="number">90</span>, <span class="number">160</span>,  <span class="number">82</span>,  <span class="number">59</span>, <span class="number">214</span>, <span class="number">179</span>,  <span class="number">41</span>, <span class="number">227</span>,  <span class="number">47</span>, <span class="number">132</span>, </span><br><span class="line">   <span class="number">83</span>, <span class="number">209</span>,   <span class="number">0</span>, <span class="number">237</span>,  <span class="number">32</span>, <span class="number">252</span>, <span class="number">177</span>,  <span class="number">91</span>, <span class="number">106</span>, <span class="number">203</span>, </span><br><span class="line">  <span class="number">190</span>,  <span class="number">57</span>,  <span class="number">74</span>,  <span class="number">76</span>,  <span class="number">88</span>, <span class="number">207</span>, <span class="number">208</span>, <span class="number">239</span>, <span class="number">170</span>, <span class="number">251</span>, </span><br><span class="line">   <span class="number">67</span>,  <span class="number">77</span>,  <span class="number">51</span>, <span class="number">133</span>,  <span class="number">69</span>, <span class="number">249</span>,   <span class="number">2</span>, <span class="number">127</span>,  <span class="number">80</span>,  <span class="number">60</span>, </span><br><span class="line">  <span class="number">159</span>, <span class="number">168</span>,  <span class="number">81</span>, <span class="number">163</span>,  <span class="number">64</span>, <span class="number">143</span>, <span class="number">146</span>, <span class="number">157</span>,  <span class="number">56</span>, <span class="number">245</span>, </span><br><span class="line">  <span class="number">188</span>, <span class="number">182</span>, <span class="number">218</span>,  <span class="number">33</span>,  <span class="number">16</span>, <span class="number">255</span>, <span class="number">243</span>, <span class="number">210</span>, <span class="number">205</span>,  <span class="number">12</span>, </span><br><span class="line">   <span class="number">19</span>, <span class="number">236</span>,  <span class="number">95</span>, <span class="number">151</span>,  <span class="number">68</span>,  <span class="number">23</span>, <span class="number">196</span>, <span class="number">167</span>, <span class="number">126</span>,  <span class="number">61</span>, </span><br><span class="line">  <span class="number">100</span>,  <span class="number">93</span>,  <span class="number">25</span>, <span class="number">115</span>,  <span class="number">96</span>, <span class="number">129</span>,  <span class="number">79</span>, <span class="number">220</span>,  <span class="number">34</span>,  <span class="number">42</span>, </span><br><span class="line">  <span class="number">144</span>, <span class="number">136</span>,  <span class="number">70</span>, <span class="number">238</span>, <span class="number">184</span>,  <span class="number">20</span>, <span class="number">222</span>,  <span class="number">94</span>,  <span class="number">11</span>, <span class="number">219</span>, </span><br><span class="line">  <span class="number">224</span>,  <span class="number">50</span>,  <span class="number">58</span>,  <span class="number">10</span>,  <span class="number">73</span>,   <span class="number">6</span>,  <span class="number">36</span>,  <span class="number">92</span>, <span class="number">194</span>, <span class="number">211</span>, </span><br><span class="line">  <span class="number">172</span>,  <span class="number">98</span>, <span class="number">145</span>, <span class="number">149</span>, <span class="number">228</span>, <span class="number">121</span>, <span class="number">231</span>, <span class="number">200</span>,  <span class="number">55</span>, <span class="number">109</span>, </span><br><span class="line">  <span class="number">141</span>, <span class="number">213</span>,  <span class="number">78</span>, <span class="number">169</span>, <span class="number">108</span>,  <span class="number">86</span>, <span class="number">244</span>, <span class="number">234</span>, <span class="number">101</span>, <span class="number">122</span>, </span><br><span class="line">  <span class="number">174</span>,   <span class="number">8</span>, <span class="number">186</span>, <span class="number">120</span>,  <span class="number">37</span>,  <span class="number">46</span>,  <span class="number">28</span>, <span class="number">166</span>, <span class="number">180</span>, <span class="number">198</span>, </span><br><span class="line">  <span class="number">232</span>, <span class="number">221</span>, <span class="number">116</span>,  <span class="number">31</span>,  <span class="number">75</span>, <span class="number">189</span>, <span class="number">139</span>, <span class="number">138</span>, <span class="number">112</span>,  <span class="number">62</span>, </span><br><span class="line">  <span class="number">181</span>, <span class="number">102</span>,  <span class="number">72</span>,   <span class="number">3</span>, <span class="number">246</span>,  <span class="number">14</span>,  <span class="number">97</span>,  <span class="number">53</span>,  <span class="number">87</span>, <span class="number">185</span>, </span><br><span class="line">  <span class="number">134</span>, <span class="number">193</span>,  <span class="number">29</span>, <span class="number">158</span>, <span class="number">225</span>, <span class="number">248</span>, <span class="number">152</span>,  <span class="number">17</span>, <span class="number">105</span>, <span class="number">217</span>, </span><br><span class="line">  <span class="number">142</span>, <span class="number">148</span>, <span class="number">155</span>,  <span class="number">30</span>, <span class="number">135</span>, <span class="number">233</span>, <span class="number">206</span>,  <span class="number">85</span>,  <span class="number">40</span>, <span class="number">223</span>, </span><br><span class="line">  <span class="number">140</span>, <span class="number">161</span>, <span class="number">137</span>,  <span class="number">13</span>, <span class="number">191</span>, <span class="number">230</span>,  <span class="number">66</span>, <span class="number">104</span>,  <span class="number">65</span>, <span class="number">153</span>, </span><br><span class="line">   <span class="number">45</span>,  <span class="number">15</span>, <span class="number">176</span>,  <span class="number">84</span>, <span class="number">187</span>,  <span class="number">22</span>,  <span class="number">72</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">35</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> temp = <span class="number">0</span>, temp1 = <span class="number">0</span>, q = <span class="number">0</span>, w = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">127</span>; j++)</span><br><span class="line">&#123;</span><br><span class="line"> temp = (j &gt;&gt; <span class="number">4</span>) % <span class="number">16</span>; </span><br><span class="line"> temp1 = (<span class="number">16</span>*j &gt;&gt; <span class="number">4</span>) % <span class="number">16</span>;</span><br><span class="line"> q = a[<span class="number">2</span>*i];</span><br><span class="line"> <span class="keyword">if</span>(q &lt; <span class="number">48</span> || q &gt; <span class="number">57</span>)</span><br><span class="line"> q = q<span class="number">-87</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">q = q<span class="number">-48</span>;</span><br><span class="line">q = q*<span class="number">16</span>;</span><br><span class="line"></span><br><span class="line">w = b[<span class="number">2</span>*i];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(w &lt; <span class="number">48</span> || w &gt; <span class="number">57</span>)</span><br><span class="line">w = w<span class="number">-87</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">w = w<span class="number">-48</span>; </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> <span class="keyword">if</span>(c[<span class="number">16</span>*temp + temp1] == ((w+q) ^ <span class="number">0x19</span>))</span><br><span class="line"> &#123;</span><br><span class="line"> flag[i] = j;</span><br><span class="line"><span class="keyword">break</span>; </span><br><span class="line"> &#125; </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(flag); </span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2020/04/29/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(2)/image-20200502083319440-1590490435324.png" alt="image-20200502083319440"></p></li><li><p><strong>æ€»ç»“: &gt;&gt; è¿ç®—ç¬¦ç§»åŠ¨nä½å°±ç›¸å½“äºé™¤ä»¥2^n. ä¸” % çš„ä¼˜å…ˆçº§å¤§äº &gt;&gt;</strong></p></li></ul><hr><h3 id="notsequence"><a href="#notsequence" class="headerlink" title="notsequence"></a>notsequence</h3><ul><li><p>è‡ªå·±ç®—æ³•å¤ªèœäº†, è¿™é“é¢˜çš„2ä¸ªå‡½æ•°å§‹ç»ˆæ²¡çœ‹æ‡‚â€¦ çœ‹äº†writeup, æ¨è¾‰ä¸‰è§’å½¢!</p></li><li><p>çœ‹äº†writeup, è‡ªå·±æ…¢æ…¢çš„åˆ†æäº†ä¸‹. é¦–å…ˆ, check1å‡½æ•°.</p><p><img src="/2020/04/29/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(2)/image-20200502131757195-1590490442991.png" alt="image-20200502131757195"></p></li><li><p>ç„¶åæ˜¯check2.</p><p><img src="/2020/04/29/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(2)/image-20200502133008194-1590490446814.png" alt="image-20200502133008194"></p></li><li><p>ç»è¿‡è¿™2ä¸ªå‡½æ•°åˆ¤æ–­, å°±èƒ½çŸ¥é“æ˜¯å¦æ˜¯æ¨è¾‰ä¸‰è§’å½¢äº†. æŠŠå‰20è¡Œçš„æ•°æ®ç»è¿‡md5åŠ å¯†å°±æ˜¯flag.</p></li><li><p>æœ€å, é¢˜è‡ªå·±è™½ç„¶æ¯åšå‡ºæ¥, å€’æ˜¯é€šè¿‡è¿™ä¸ªé¢˜é‡æ–°è®¤è¯†äº†æ¨è¾‰ä¸‰è§’å½¢. å†™äº†Cè¯­è¨€å’Œpythonçš„ç‰ˆæœ¬. ä¹Ÿæ˜¯æƒ³æ‰“å°å‡ºæ¥çœ‹çœ‹, ä¸”è‡ªå·±åˆšæ¥è§¦python, ä»£ç ä¹±è€Œé•¿.</p><p><strong>python3:</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">createL</span><span class="params">(l)</span>:</span></span><br><span class="line">    L = [<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">1</span>, len(l)):</span><br><span class="line">        L.append(l[x] + l[x<span class="number">-1</span>])</span><br><span class="line">    L.append(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> L</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">printL</span><span class="params">(L, W)</span>:</span></span><br><span class="line">    s = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> L:</span><br><span class="line">        s += str(x) + <span class="string">" "</span></span><br><span class="line">    print(s.center(W))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">str_</span><span class="params">(s, L)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> L:</span><br><span class="line">        s += str(x)</span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">L = [<span class="number">1</span>]</span><br><span class="line">s = <span class="string">""</span></span><br><span class="line">row = int(input(<span class="string">"è¯·è¾“å…¥è¡Œæ•°: "</span>))</span><br><span class="line">width =row* <span class="number">6</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(row):</span><br><span class="line">    printL(L, width)</span><br><span class="line">    s = str_(s, L)</span><br><span class="line">    L = createL(L)</span><br><span class="line">print(s)</span><br><span class="line">m = hashlib.md5(s.encode()).hexdigest()</span><br><span class="line">print(<span class="string">"md5åŠ å¯†å:%s"</span> % m)</span><br></pre></td></tr></table></figure><p><strong>C:</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt; </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> *<span class="title">creat</span><span class="params">(<span class="keyword">int</span> *L, <span class="keyword">int</span> lenth)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> *p = (<span class="keyword">int</span> *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">int</span>)*(lenth+<span class="number">1</span>));</span><br><span class="line"></span><br><span class="line">p[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">1</span>; i &lt; lenth; i++)</span><br><span class="line">p[i] = L[i<span class="number">-1</span>] + L[i];</span><br><span class="line"></span><br><span class="line">p[lenth] = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> p;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(<span class="keyword">int</span> *L, <span class="keyword">int</span> blank_l, <span class="keyword">int</span> lenth)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; blank_l; i++)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"  "</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; lenth; i++)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%4d"</span>, L[i]); </span><br><span class="line"></span><br><span class="line"><span class="built_in">putchar</span>(<span class="number">10</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">char</span> *<span class="title">translate</span><span class="params">(<span class="keyword">int</span> *L, <span class="keyword">int</span> lenth)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> *p = (<span class="keyword">char</span> *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">char</span>)*<span class="number">100</span>), temp[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">memset</span>(p, <span class="number">0</span>, <span class="keyword">sizeof</span>(<span class="keyword">char</span>));</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; lenth; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">sprintf</span>(temp, <span class="string">"%d"</span>, L[i]);</span><br><span class="line"><span class="built_in">strcat</span>(p, temp); </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> p;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> n = <span class="number">0</span>, i = <span class="number">0</span>, *p = <span class="literal">NULL</span>;</span><br><span class="line"><span class="keyword">char</span> a[<span class="number">1000</span>] = &#123;<span class="number">0</span>&#125;; </span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"è¯·è¾“å…¥è¡Œæ•°: "</span>);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">&#123;</span><br><span class="line">p = creat(p, i);</span><br><span class="line"><span class="built_in">print</span>(p, n-i, i+<span class="number">1</span>);</span><br><span class="line"><span class="built_in">strcat</span>(a, (<span class="keyword">char</span> *)translate(p, i+<span class="number">1</span>));</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"\næ‰€æœ‰æ•°å€¼ç»„æˆçš„å­—ç¬¦ä¸²ä¸º: %s"</span>, a); </span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>æ€»ç»“: åœ¨çœ‹ä¸æ‡‚ä»£ç çš„æ—¶å€™, åº”è¯¥æŠŠèƒ½å†™å‡ºæ¥çš„å€¼éƒ½åˆ—ä¸¾å‡ºæ¥, è§‚å¯Ÿä¸€ä¸‹è§„å¾‹.</strong></p></li></ul><hr><h3 id="SignIn"><a href="#SignIn" class="headerlink" title="SignIn"></a>SignIn</h3><ul><li><p>è¿™é“é¢˜æ›´åƒæ˜¯æ˜¯cryptoçš„é¢˜, åˆæ¬¡äº†è§£äº†ä¸‹Rsa.</p></li><li><p>ç¨‹åºä¸‹è½½ä¸‹æ¥, æœ‰ä¸€ç³»åˆ—ä¸è®¤è¯†çš„å‡½æ•°, å¤§æ¦‚çŸ¥é“ç”¨æ³•, è¿˜æ˜¯å…ˆå–æŸ¥äº†æŸ¥.<img src="/2020/04/29/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(2)/image-20200503094008020-1590490467616.png" alt="image-20200503094008020"></p></li><li><p>GMP(The GNU Multiple Precision Arithmetic Library)åˆå«GNUå¤šç²¾åº¦ç®—æœ¯åº“ï¼Œæ˜¯ä¸€ä¸ªæä¾›äº†å¾ˆå¤šæ“ä½œé«˜ç²¾åº¦çš„å¤§æ•´æ•°ï¼Œæµ®ç‚¹æ•°çš„è¿ç®—çš„ç®—æœ¯åº“ï¼Œå‡ ä¹æ²¡æœ‰ä»€ä¹ˆç²¾åº¦æ–¹é¢çš„é™åˆ¶ï¼ŒåŠŸèƒ½ä¸°å¯Œ. å‡ ä¸ªå¸¸ç”¨çš„:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">æ·»åŠ å¤´æ–‡ä»¶ï¼š<span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;gmp.h&gt; </span></span></span><br><span class="line"></span><br><span class="line">ã€€ã€€cmdç¼–è¯‘å‘½ä»¤ï¼šgcc myprogram.c -lgmp -lm -o myprogram</span><br><span class="line"></span><br><span class="line">ã€€ã€€å£°æ˜ä¸€ä¸ªgmpçš„æ•´æ•°rop ï¼š<span class="keyword">mpz_t</span> rop;</span><br><span class="line"></span><br><span class="line">ã€€ã€€æŠŠå­—ç¬¦ä¸²åˆå§‹åŒ–ä¸ºgmpå¤§æ•´æ•°ï¼š<span class="function"><span class="keyword">int</span> <span class="title">mpz_init_set_str</span><span class="params">(<span class="keyword">mpz_t</span> rop, <span class="keyword">char</span>*str, <span class="keyword">int</span> base)</span></span>; </span><br><span class="line"></span><br><span class="line">ã€€ã€€é‡Šæ”¾ç©ºé—´ï¼š<span class="function"><span class="keyword">void</span>  <span class="title">mpz_clear</span><span class="params">(<span class="keyword">mpz_t</span> rop)</span></span>;<span class="comment">//å£°æ˜äº†ä¸€ä¸ªå˜é‡ï¼Œåœ¨ç¨‹åºçš„æœ€åä¸€å®šè¦é‡Šæ”¾ï¼Œä¸ç„¶ä¼šæŠ¥é”™</span></span><br><span class="line"></span><br><span class="line">ã€€ã€€åŠ æ³•ï¼š<span class="function"><span class="keyword">void</span> <span class="title">mpz_add</span><span class="params">(<span class="keyword">mpz_t</span> rop, <span class="keyword">mpz_t</span> op1, <span class="keyword">mpz_t</span> op2)</span></span>;  <span class="comment">//rop = op1 + op2</span></span><br><span class="line"></span><br><span class="line">ã€€ã€€å‡æ³•ï¼š<span class="function"><span class="keyword">void</span> <span class="title">mpz_sub</span><span class="params">(<span class="keyword">mpz_t</span> rop, <span class="keyword">mpz_t</span> op1, <span class="keyword">mpz_t</span> op2)</span></span>;  <span class="comment">//rop = op1 - op2</span></span><br><span class="line"></span><br><span class="line">ã€€ã€€ä¹˜æ³•ï¼š<span class="function"><span class="keyword">void</span> <span class="title">mpz_mul</span><span class="params">(<span class="keyword">mpz_t</span> rop, <span class="keyword">mpz_t</span> op1, <span class="keyword">mpz_t</span> op2)</span></span>; <span class="comment">//rop = op1 * op2</span></span><br><span class="line"></span><br><span class="line">ã€€ã€€é™¤æ³•ï¼š<span class="function"><span class="keyword">void</span> <span class="title">mpz_cdiv_q</span> <span class="params">(<span class="keyword">mpz_t</span> q, <span class="keyword">mpz_t</span> n, <span class="keyword">mpz_t</span> d)</span></span>;  <span class="comment">//q = n/d,è¿™ä¸ªæœ‰å¾ˆå¤šç§ç±»å‹ï¼Œå…·ä½“çš„çœ‹ä½¿ç”¨æ‰‹å†Œ</span></span><br><span class="line"></span><br><span class="line">ã€€ã€€å¹‚è¿ç®—ï¼š<span class="function"><span class="keyword">void</span> <span class="title">mpz_pow_ui</span> <span class="params">(<span class="keyword">mpz_t</span> rop, <span class="keyword">mpz_t</span> base, <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">int</span> <span class="built_in">exp</span>)</span></span>;  <span class="comment">//rop = base^exp</span></span><br><span class="line">  void mpz_powm (mpz_t rop, const mpz_t base, const mpz_t exp, const mpz_t mod)  ä½œç”¨: Set rop to base^exp mod mod. è¿™æ˜¯è¿™é“é¢˜ä¸­ç”¨åˆ°çš„. ä¹Ÿæ˜¯rsaåŠ å¯†è§£å¯†å¸¸ç”¨çš„.</span><br><span class="line">          </span><br><span class="line"></span><br><span class="line">ã€€ã€€å¼€æ–¹ï¼š<span class="function"><span class="keyword">void</span> <span class="title">mpz_sqrt</span> <span class="params">(<span class="keyword">mpz_t</span> rop, <span class="keyword">mpz_t</span> op)</span></span>; <span class="comment">//rop = opå¼€æ–¹çš„å‘ä¸‹å–æ•´</span></span><br></pre></td></tr></table></figure></li><li><p>æ•´ä¸ªæµç¨‹, æ˜¾ç„¶æ˜¯rsaåŠ å¯†.  </p><table><thead><tr><th align="center">æ­¥éª¤</th><th>è¯´æ˜</th><th>æè¿°</th><th>å¤‡æ³¨</th></tr></thead><tbody><tr><td align="center">1</td><td>æ‰¾å‡ºè´¨æ•°</td><td>P ã€Q</td><td>-</td></tr><tr><td align="center">2</td><td>è®¡ç®—å…¬å…±æ¨¡æ•°</td><td>N = P * Q</td><td>-</td></tr><tr><td align="center">3</td><td>æ¬§æ‹‰å‡½æ•°</td><td>Ï†(N) = (P-1)(Q-1)</td><td>-</td></tr><tr><td align="center">4</td><td>è®¡ç®—å…¬é’¥E</td><td>1 &lt; E &lt; Ï†(N)</td><td>Eçš„å–å€¼å¿…é¡»æ˜¯æ•´æ•°  E å’Œ Ï†(N) å¿…é¡»æ˜¯äº’è´¨æ•°</td></tr><tr><td align="center">5</td><td>è®¡ç®—ç§é’¥D</td><td>E * D % Ï†(N) = 1</td><td>-</td></tr><tr><td align="center">6</td><td>åŠ å¯†</td><td>C ï¼ M ^E mod N</td><td>Cï¼šå¯†æ–‡  Mï¼šæ˜æ–‡</td></tr><tr><td align="center">7</td><td>è§£å¯†</td><td>M ï¼C ^D mod N</td><td>Cï¼šå¯†æ–‡  Mï¼šæ˜æ–‡</td></tr></tbody></table></li><li><p>ä½†æ˜¯ä¹‹å‰æœ‰ä¸€ä¸ªsub_96Aå‡½æ•°.(æœ€ä¸Šé¢çš„ç®­å¤´æ‰€ç¤º), ç°åœ¨è¿›å…¥è¿™ä¸ªå‡½æ•°çœ‹çœ‹. è¿™é‡Œæ˜¯ä»å­—ç¬¦çš„ASCIIè½¬åŒ–ä¸º16è¿›åˆ¶, <strong>(æœ€ä¸Šé¢çš„ Windows_Reverse2æœ‰ä» 16è¿›åˆ¶è½¬åŒ–ä¸ºå­—ç¬¦çš„ç®—æ³•, éƒ½æŒºç®€æ´çš„)</strong><img src="/2020/04/29/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(2)/image-20200503094306385-1590490481485.png" alt="image-20200503094306385"></p></li><li><p>æ•´ä¸ªç¨‹åºå°±æ˜¯å°†æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦, å…ˆè½¬åŒ–ä¸º16è¿›åˆ¶æ•°å€¼å­—ç¬¦, å†å˜æˆä¸€ä¸ªå¤§æ•°ä½œä¸ºæ˜æ–‡. ç»è¿‡  <strong>C ï¼ M ^E mod N</strong>, åŠ å¯†åå’Œç¼–ç çš„å¯†æ–‡è¿›è¡Œå¯¹æ¯”. é¦–å…ˆè¿™é‡Œçš„ E = v5 = 65537. Mæ˜¯æ˜æ–‡. N = v4 = 103461035900816914121390101299049044413950405173712170434161686539878160984549. æ ¹æ®è§£å¯†è¿‡ç¨‹, æˆ‘ä»¬å…ˆæŠŠ N åˆ†è§£æˆ p q , å¯ä»¥å»åœ¨çº¿åˆ†è§£.<img src="/2020/04/29/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(2)/image-20200503095605681-1590490490248.png" alt="image-20200503095605681"></p></li><li><p>ç„¶åä½¿ç”¨ pythonçš„gmpy2åº“å…ˆæ±‚é€†å…ƒå¾—åˆ°<strong>D</strong>. æœ€åç”¨  <strong>M ï¼C ^D mod N</strong>  è§£å¯†å¹¶ä»16è¿›åˆ¶è½¬åŒ–ä¸ºå­—ç¬¦. è¿™ä¸ªgmpy2çš„åº“çš„å®‰è£…è¿˜è´¹äº†äº›æ—¶é—´..ğŸ¤£ <strong>exp:</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">p = <span class="number">282164587459512124844245113950593348271</span></span><br><span class="line">q = <span class="number">366669102002966856876605669837014229419</span></span><br><span class="line">N = <span class="number">103461035900816914121390101299049044413950405173712170434161686539878160984549</span></span><br><span class="line">c = <span class="number">0xad939ff59f6e70bcbfad406f2494993757eee98b91bc244184a377520d06fc35</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">d = gmpy2.invert(e, (p<span class="number">-1</span>)*(q<span class="number">-1</span>))</span><br><span class="line">m = gmpy2.powmod(c, d, p*q)</span><br><span class="line"></span><br><span class="line">print(bytes.fromhex(hex(m)[<span class="number">2</span>:])</span><br></pre></td></tr></table></figure></li></ul><p><img src="/2020/04/29/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(2)/image-20200503101307822-1590490496701.png" alt="image-20200503101307822"></p><ul><li><strong>æ€»ç»“: (1)å¯¹rsaæœ‰äº†åˆæ­¥çš„äº†è§£, å­¦ä¼šäº†ç®€å•çš„åŠ å¯†è§£å¯†æ–¹æ³•. (2)GMPç®—æ•°åº“çš„è®¤è¯†. (3)å­—ç¬¦çš„ASCIIè½¬16è¿›åˆ¶çš„ç®€æ´ç®—æ³•.</strong></li></ul><hr><h3 id="BabyXor"><a href="#BabyXor" class="headerlink" title="BabyXor"></a>BabyXor</h3><ul><li><p>é¦–å…ˆ, æ˜æ˜å¯ä»¥ç›´æ¥ODåŠ¨æ€è°ƒè¯•, å¾ˆå¿«å¾—åˆ°flag.  ä½†æ˜¯æˆ‘ç”¨idaæŠŠé¢˜åšå®Œ, æ‰ä¸€ä¸‹å­æƒ³èµ·.ğŸ¤£</p></li><li><p>å‘ç°æœ‰å£³, è½½å…¥ODä½¿ç”¨å †æ ˆå¹³è¡¡è„±å£³. è½½å…¥ida, å‘ç°mainå‡½æ•°é‡Œæœ‰å¾ˆå¤šå‡½æ•°, ä¸Šä¸‹åˆ†æäº†ä¸‹, å‘ç°éƒ½æ˜¯å¹²æ‰°çš„å‡½æ•°. <img src="/2020/04/29/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(2)/image-20200503173759296-1590490519677.png" alt="image-20200503173759296"></p><p>ç¡®å®šç›®æ ‡, å°±æ˜¯é€šè¿‡è¿™å‡ ä¸ªå‡½æ•°ä»ç¼–ç çš„æ•°æ®ä¸­å–å‡ºå­—ç¬¦ç»è¿‡ä¸€äº›ç®€å•çš„å¼‚æˆ–è¿ç®—, å­˜æ”¾å†ä¸€ä¸ªå†…å­˜ç©ºé—´. ä½†æ˜¯ä¸æˆ‘ä»¬è¾“å…¥æ•°æ®æ²¡æœ‰å…³ç³». (è¿™æ—¶å€™, å°±å¯ä»¥ç›´æ¥å–ODåŠ¨æ€è°ƒè¯•ç›´æ¥å¾—åˆ°flagçš„, å”‰, æˆ‘ç®—å‡ºæ¥æ‰æƒ³èµ·)</p></li><li><p>ä¸€ä¸ªç–‘é—®çš„åœ°æ–¹<img src="/2020/04/29/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(2)/image-20200503174247305-1590490527077.png" alt="image-20200503174247305"></p></li><li><p>ç„¶åçœ‹äº†çœ‹æ±‡ç¼–ä»£ç . è¿˜æ˜¯ä¸æ¸…æ¥š.  <img src="/2020/04/29/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(2)/image-20200503174332262-1590490532558.png" alt="image-20200503174332262"></p></li><li><p>è¿›å»ODè°ƒè¯•çœ‹çœ‹.å‘ç°ä»£ç åˆæ˜¯ä¸€ä¸ªæ ·. ä¸è¿‡è¿™ä¸‹å°±æ¸…æ¥šäº†. å…ˆå–åœ°å€çš„å€¼. <strong>è®°ä½è¿™ç‚¹</strong><img src="/2020/04/29/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(2)/image-20200503174534451-1590490539636.png" alt="image-20200503174534451"></p></li><li><p><strong>exp:</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">union</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ida_chars[<span class="number">56</span>];</span><br><span class="line"><span class="keyword">int</span> a[<span class="number">14</span>];</span><br><span class="line">&#125;A = &#123;</span><br><span class="line">  <span class="number">102</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">109</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">99</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">100</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">55</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">53</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">48</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">48</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">107</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">58</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">60</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">59</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">32</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">union</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ida[<span class="number">56</span>];</span><br><span class="line"><span class="keyword">int</span> a[<span class="number">14</span>];</span><br><span class="line">&#125; B = &#123;</span><br><span class="line">   <span class="number">55</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">111</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">56</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">98</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">54</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">  <span class="number">124</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">55</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">51</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">52</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">118</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">51</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">98</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">100</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>, <span class="number">122</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">union</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ida_[<span class="number">56</span>];</span><br><span class="line"><span class="keyword">int</span> a[<span class="number">14</span>];</span><br><span class="line">&#125;C = &#123;</span><br><span class="line">   <span class="number">26</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">81</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">5</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">17</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">84</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">86</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">85</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">89</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">29</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">9</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">93</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">18</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span></span><br><span class="line">&#125;; </span><br><span class="line"><span class="keyword">char</span> f1[<span class="number">14</span>] = &#123;<span class="number">0</span>&#125;, f2[<span class="number">14</span>] = &#123;<span class="number">0</span>&#125;, f3[<span class="number">14</span>] = &#123;<span class="number">0</span>&#125;, ftemp[<span class="number">14</span>] = &#123;<span class="number">0</span>&#125;, temp = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> flag[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">14</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">f1[i] = A.a[i] ^ i; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">f2[<span class="number">0</span>] = B.a[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">1</span>; i &lt; <span class="number">14</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">f2[i] = A.a[i] ^ B.a[i] ^ A.a[i<span class="number">-1</span>]; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">13</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">temp = C.a[i+<span class="number">1</span>] ^ f2[i]; </span><br><span class="line">ftemp[i] = temp ^ i;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">f3[<span class="number">0</span>] = <span class="number">0x2D</span>;</span><br><span class="line"><span class="built_in">strcat</span>(f3, ftemp);</span><br><span class="line"></span><br><span class="line"><span class="built_in">strcat</span>(flag, f1);</span><br><span class="line"><span class="built_in">strcat</span>(flag, f2);</span><br><span class="line"><span class="built_in">strcat</span>(flag, f3);</span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(flag); </span><br><span class="line"></span><br><span class="line"> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><p><img src="/2020/04/29/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(2)/image-20200503174824411-1590490553835.png" alt="image-20200503174824411"></p><ul><li>ä¸‹é¢è¯´ä¸€æ­¥åˆ°ä½.æ‰¾åˆ°æœ€åä¸€ä¸ªå‡½æ•°æœ€åèµ‹å€¼ä»£ç çš„åœ°å€. å¤åˆ¶ä¸‹æ¥<img src="/2020/04/29/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(2)/image-20200503175027583-1590490558591.png" alt="image-20200503175027583"></li><li>è¿›å»OD, è·³åˆ°è¿™ä¸ªåœ°å€ä¸‹æ–­ç‚¹, è¿è¡Œèµ·æ¥. çœ‹æ•°æ®çª—å£. <img src="/2020/04/29/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(2)/image-20200503175154926-1590490566331.png" alt="image-20200503175154926"></li><li><strong>æ€»ç»“: (1)æ³¨æ„è¿™ç§flagå’Œè¾“å…¥å­—ç¬¦æ— å…³çš„çš„é¢˜. (2)è¿™é‡Œ idaä¸­çš„å†…å­˜å–å€¼ä¸ODä¸­çš„å·®å¼‚.</strong></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;Windows-Reverse2&quot;&gt;&lt;a href=&quot;#Windows-Reverse2&quot; class=&quot;headerlink&quot; title=&quot;Windows_Reverse2&quot;&gt;&lt;/a&gt;Windows_Reverse2&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;é¦–å…ˆ,å› ä¸ºæ˜¯ä¸ª.exeæ–‡ä»¶, å…ˆæ‰“å¼€çœ‹ä¸€ä¸‹ç¨‹åºæ˜¯åšä»€ä¹ˆçš„, å‡ºç° &lt;strong&gt;input code:&lt;/strong&gt; ä¹Ÿå°±æ˜¯è®©æˆ‘ä»¬è¾“å…¥ä¸€ä¸ªå¯†ç éªŒè¯.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ç”¨idaæ‰“å¼€, è¿˜æ˜¯å…ˆ shift + 12 æœç´¢ä¸€ä¸‹å­—ç¬¦ä¸², ç„¶è€Œå¹¶æ²¡æœ‰å‘ç°æˆ‘ä»¬æ‰“å¼€ç¨‹åºçœ‹åˆ°çš„ *&lt;em&gt;input code: *&lt;/em&gt;,å¹¶ä¸”ç¨‹åºå‡½æ•°ä¹Ÿå¾ˆå°‘, é‚£å°±æ˜¯åŠ å£³äº†çš„. å¼€å§‹ä¹Ÿå¿˜äº†ç”¨è½¯ä»¶æŸ¥ä¸€ä¸‹å£³.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;é‚£ä¹ˆç”¨ODæ‰“å¼€, ä½¿ç”¨å †æ ˆå¹³è¡¡çš„æ–¹æ³•, æ‰¾åˆ°ç¨‹åºçš„ OEP, ç„¶ådump, ä½†æ˜¯æ³¨æ„æ”¹ä¸€ä¸‹åŠ è½½çš„åˆå§‹åœ°å€å’Œå…¥å£ç‚¹,   è¿™ä¸ªç¨‹åºå¹¶ä¸æ˜¯ 0x400000å¼€å§‹, æ¯æ¬¡åŠ è½½éƒ½æ˜¯ä¸ä¸€æ ·çš„åœ°å€,åº”è¯¥æ˜¯ ASLRä¿æŠ¤æŠ€æœ¯å§, ä¹‹å‰æœ‰äº†è§£è¿‡ä¸€äº›.é€šè¿‡å†…å­˜çª—å£, çŸ¥é“äº†æ˜¯ 0x1F0000.&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;
    
    </summary>
    
    
      <category term="æ”»é˜²ä¸–ç•Œ" scheme="https://hus96r.coding-pages.com/categories/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/"/>
    
    
      <category term="CTF" scheme="https://hus96r.coding-pages.com/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>.cpp é€†å‘</title>
    <link href="https://hus96r.coding-pages.com/2020/04/27/cpp-%E9%80%86%E5%90%91/"/>
    <id>https://hus96r.coding-pages.com/2020/04/27/cpp-%E9%80%86%E5%90%91/</id>
    <published>2020-04-27T11:35:58.000Z</published>
    <updated>2020-05-27T03:35:23.580Z</updated>
    
    <content type="html"><![CDATA[<h3 id="ç™¾è¶Šæ¯2018-crazy"><a href="#ç™¾è¶Šæ¯2018-crazy" class="headerlink" title="ç™¾è¶Šæ¯2018: crazy"></a>ç™¾è¶Šæ¯2018: crazy</h3><ul><li><p>é¦–å…ˆ, è¿™é“é¢˜çš„ç®—æ³•å¾ˆç®€å•, å°±æ˜¯è€ƒå¼•ç”¨C++çš„å­—ç¬¦ä¸²ç±»çš„å‡½æ•°. ä½†æ˜¯è‡ªå·±ä¹ŸæŒ–æ˜äº†ä¸€äº›æ„Ÿè§‰æœ‰ç”¨çš„ä¸œè¥¿, ä¸»è¦æ˜¯é€šè¿‡è¿™é“é¢˜æ€»ç»“ c++å­—ç¬¦ä¸²ç±».</p></li><li><p>æ‹–å…¥ExeinfoPe, é¢˜ç›®æ˜¯64ä¸ºelfæ–‡ä»¶, ç”¨64ä¸ºidaæ‰“å¼€.</p></li><li><p>æ‰¾åˆ°ä¸»å‡½æ•°,  æŸ¥çœ‹ä¼ªä»£ç , å‘ç°å¾ˆå†—é•¿, ä½†å¤§å¤šæ•°éƒ½æ˜¯é‚£äº›å­—ç¬¦ä¸²ç±»å‡½æ•°å’Œæ— ç”¨çš„ä¿¡æ¯. æˆ‘ä»¬å¯ä»¥å…ˆé€šè¿‡ç‚¹å‡»æœ€åæ¯”è¾ƒè¦ç”¨åˆ°çš„å­—ç¬¦ä¸²çš„åç§°, è¿™æ—¶ä¼šæŠŠæ‰€æœ‰ç›¸åŒåç§°éƒ½é«˜äº®æ˜¾ç¤ºå‡ºæ¥, å°±å¯ä»¥é€šè¿‡é€»è¾‘åˆ¤æ–­å‡ºé‚£äº›æ˜¯å…³é”®å‡½æ•°å’Œå˜é‡.<a id="more"></a></p></li><li><p>ç¬¬ä¸€ä¸ªå…³é”®å‡½æ•°  <strong>HighTemplar::HighTemplar((DarkTemplar *)&amp;v23, (__int64)&amp;input);</strong> </p><p><img src="/2020/04/27/cpp-%E9%80%86%E5%90%91/image-20200427213407581.png" alt="image-20200427213407581"></p></li><li><p>ç¬¬äºŒä¸ªå…³é”®å‡½æ•° <strong>HighTemplar::calculate((HighTemplar *)&amp;v23);</strong></p><p><img src="/2020/04/27/cpp-%E9%80%86%E5%90%91/image-20200427213610870.png" alt="image-20200427213610870"></p></li><li><p>ç¬¬ä¸‰ä¸ªå…³é”®å‡½æ•° <strong>HighTemplar::getSerial((HighTemplar *)&amp;v23)</strong></p><p><img src="/2020/04/27/cpp-%E9%80%86%E5%90%91/image-20200427213959893.png" alt="image-20200427213959893"></p></li><li><p>æœ€åwp: ä½†æ˜¯è¦å¼•èµ·æ³¨æ„çš„æ˜¯è¿™ä¸ªflagçœŸçš„å¥‡æ€ª, å¼€å§‹ä»¥ä¸ºç®—é”™äº†,æ£€æŸ¥å‡ é, æœ€åå°±æ˜¯è¿™ä¸ª <strong>tMx<del>qdstOs</del>crvtwb~aOba}qddtbrtcd</strong>  å†åŠ ä¸Šflag{}.</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> a[] = <span class="string">"327a6c4304ad5938eaf0efb6cc3e53dc"</span>;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> flag[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(a); i++)</span><br><span class="line">&#123;</span><br><span class="line">a[i] = (a[i] - <span class="number">11</span>) ^ <span class="number">0x13</span>;</span><br><span class="line">a[i] = (a[i] - <span class="number">23</span>) ^ <span class="number">0x50</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(a);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>æ€»ç»“:</strong></p></li><li><p>å…ˆè¯´ä¸€ä¸‹åšè¿™ä¸ªé¢˜æƒ³è¿‡çš„ä¸€ä¸ªé—®é¢˜.  æˆ‘ä»¬çŸ¥é“ <strong>rodata</strong> æ®µæ˜¯åªè¯»çš„, å­˜æ”¾å¸¸é‡ç­‰, ä½†æ˜¯è¿™é‡Œå´æœ‰å­—ç¬¦ä¸²åœ°å€çš„èµ‹å€¼, ä»–æŠŠ <strong>0x401EA0</strong> åœ°å€çš„å€¼æ”¹å˜äº†, ä½†ä¸ºä»€ä¹ˆå¯ä»¥è¿™æ ·å‘¢, æŸ¥äº†èµ„æ–™, ä¹Ÿæƒ³äº†å¾ˆä¹…, æœ€åè®¤ä¸ºåº”è¯¥æ˜¯å­˜æ”¾çš„æŒ‡é’ˆ,è€Œä¸”æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™ä¸€æ®µéƒ½æ˜¯8å­—èŠ‚çš„å¢åŠ , éƒ½æ˜¯ä¸€ä¸ªæŒ‡é’ˆ 8å­—èŠ‚çš„å¤§å°.</p><p><img src="/2020/04/27/cpp-%E9%80%86%E5%90%91/image-20200427215217839.png" alt="image-20200427215217839"></p><p>è¿™é‡Œä¹Ÿé€šè¿‡æŸ¥èµ„æ–™, çŸ¥é“äº†ä»¥å‰å­¦ä¹ æŒ‡é’ˆçš„ç–‘é—®.</p><p><img src="/2020/04/27/cpp-%E9%80%86%E5%90%91/image-20200427215908475.png" alt="image-20200427215908475"></p><p><strong>å› ä¸ºæˆ‘ä»¬åˆå§‹åŒ–ä¸€ä¸ªæ•°ç»„æ—¶,æ•°ç»„çš„åˆå§‹å€¼æ”¾åœ¨rodataæ®µé‡Œé¢.æ•°ç»„å¯¹åº”å¼€è¾Ÿçš„ç©ºé—´ä¸Šçš„æ•°å€¼å­˜æ”¾åœ¨æ ˆä¸Š,ç¼–è¯‘å™¨ä¼šå»è®¿é—®rodataæ®µä¸Šçš„åˆå§‹å€¼ç„¶åå–æ¥åˆå§‹åŒ–å±€éƒ¨å˜é‡ï¼Œå› æ­¤æ•°ç»„çš„å€¼æ‰èƒ½ä¿®æ”¹. è€ŒæŒ‡é’ˆæŒ‡å‘çš„æ˜¯rodataæ®µï¼Œæ˜¯ä¸èƒ½è¢«ä¿®æ”¹çš„</strong>.</p></li><li><p>ç¬¬äºŒä¸ªå°±æ˜¯é€šè¿‡c++å®˜æ–¹æ‰‹å†Œçš„æŸ¥è¯¢å¯¹å„ç§c++å¼•ç”¨çš„å„ç§å­—ç¬¦ä¸²çš„æ€»ç»“. ä¸‹é¢çš„ a b ä¸ºå­—ç¬¦æ•°ç»„.</p><table><thead><tr><th align="left">std::__cxx11::basic_string&lt;char,std::char_traits<char>,std::allocator<char>&gt;::operator[](a, i)</char></char></th></tr></thead><tbody><tr><td align="left">å³ <strong>a[i]</strong> çš„æ„æ€, å¦‚æœoperatoråé¢æ²¡æœ‰ <strong>[]</strong>, é‚£å°±æ˜¯  <strong>a+i</strong></td></tr><tr><td align="left">std::__cxx11::basic_string&lt;char,std::char_traits<char>,std::allocator<char>&gt;::basic_string(a, b, lenth)</char></char></td></tr><tr><td align="left">å³  <strong>strncpy(a, b, lenth)</strong>  ç¬¬ä¸‰ä¸ªå‚æ•°å¯é€‰</td></tr><tr><td align="left">std::allocator<char>::~allocator(a)  <strong>å‘ç°åªè¦å‰é¢æœ‰ä¸ª ~ çš„éƒ½æ˜¯é‡Šæ”¾</strong>.</char></td></tr><tr><td align="left">å³ <strong>free(a)</strong></td></tr><tr><td align="left">std::__cxx11::basic_string&lt;char,std::char_traits<char>,std::allocator<char>&gt;::length(a)</char></char></td></tr><tr><td align="left">å³ <strong>strlen(a)</strong></td></tr><tr><td align="left">std::operator&lt;&lt;&lt;std::char_traits<char>&gt;(&amp;std::cout, â€œhelloâ€) åé¢æ€»è·Ÿç€ä¸‹é¢ä¸€å¥. <strong>å…³é”®æ˜¯count</strong></char></td></tr><tr><td align="left">std::ostream::operator&lt;&lt;(v1, (__int64)&amp;std::endl&lt;char,std::char_traits<char>&gt;)                                                                     å³  <strong>printf(â€œhelloâ€)</strong></char></td></tr><tr><td align="left">std::operator&gt;&gt;&lt;char,std::char_traits<char>,std::allocator<char>&gt;(&amp;std::cin, &amp;a) <strong>å…³é”®æ˜¯in</strong></char></char></td></tr><tr><td align="left">å³ <strong>gets(a)</strong></td></tr></tbody></table><hr></li></ul><h3 id="easyCpp"><a href="#easyCpp" class="headerlink" title="easyCpp"></a>easyCpp</h3><blockquote><p>C++é€†å‘çš„é¢˜, åˆšå¼€å§‹æ¥è§¦å¾ˆå¤šä»£ç çœ‹ä¸æ‡‚,æ„Ÿè§‰å¯è¯»æ€§ä½.  ä½†æ˜¯çœ‹å¤šäº†, è¿˜æ˜¯ä¼šå¥½å¾ˆå¤š. æ˜¯ä¸€ä¸ªæ…¢æ…¢ç†Ÿæ‚‰stlçš„è¿‡ç¨‹å§.</p></blockquote><ul><li><p>ç»è¿‡äº†ä¸€äº›CPPé€†å‘é¢˜çš„æŠ˜ç£¨, è¿™ä¸ªé¢˜å¤§å¤šæ•°å‡½æ•°è¿æ‡µå¸¦çŒœçš„çœ‹èµ·æ¥è¿˜å¥½, ä½†æ˜¯é‡åˆ°äº†ä¸€ä¸ªä¸ä»”ç»†çš„é”™è¯¯, æƒ³äº†å¾ˆä¹…â€¦..</p></li><li><p>64ä½elfæ–‡ä»¶, è½½å…¥ida, å‡½æ•°çš„å¤§éƒ¨åˆ†è¿˜æ˜¯çœ‹æ‡‚äº†. 2ä¸ªå…³é”®å‡½æ•°.  <strong>transform  accumulate</strong></p><p><img src="/2020/04/27/cpp-%E9%80%86%E5%90%91/image-20200510182506239.png" alt="image-20200510182506239"></p></li><li><p>å…ˆè¿›å…¥ transform. ç®—æ³•ä¹Ÿæ˜¯å¾ˆç®€å•, å°±æ˜¯å‡½æ•°è¯»èµ·æ¥æ›´éº»çƒ¦.</p><p><img src="/2020/04/27/cpp-%E9%80%86%E5%90%91/image-20200510182650313.png" alt="image-20200510182650313"></p></li><li><p>ä¸‹é¢ accumulate. è¿™ä¸ªçœ‹èµ·æ¥å°±ä¸æ˜¯é‚£ä¹ˆå®¹æ˜“äº†, æœ‰å¾ˆå¤šåœ°å€ä¼ è¿‡æ¥ä¼ è¿‡å»å°±å¾ˆæ··æ·†. é‚£å°±idaåŠ¨æ€è°ƒè¯•çœ‹çœ‹è¿™ä¸ªå‡½æ•°æ˜¯åšä»€ä¹ˆ.(ä¹Ÿæ˜¯è¿™é‡Œè‡ªå·±æƒ³äº†å¾ˆä¹…çš„é”™è¯¯, è™½ç„¶å¾ˆç®€å•çš„, å¯èƒ½æ˜¯stlæŠŠè‡ªå·±ææ˜äº†å§).</p><p><img src="/2020/04/27/cpp-%E9%80%86%E5%90%91/image-20200510183307210.png" alt="image-20200510183307210"></p></li><li><p>å‘ç°é”™è¯¯, é‡æ–°è°ƒè¯•åå¾—åˆ°ç»è¿‡ accumulate å‡½æ•°åçš„ç»“æœ. æŠŠç»“æœéƒ½è®°å½•ä¸‹æ¥å. å‘ç°åªæ˜¯æŠŠ transformå‡½æ•°åçš„ç»“æœè¿›è¡Œäº†é€†åº.<img src="/2020/04/27/cpp-%E9%80%86%E5%90%91/image-20200510183543551.png" alt="image-20200510183543551"></p></li><li><p>å¼€å§‹å†™ exp:  å¾—åˆ° <strong>987 -377 -610 -754 -843 -898 -932 -953 -966 -974 -979 -982 -984 -985 -986 -986</strong>. æœ€ååœ¨linuxä¸‹è¿è¡Œç¨‹åºè¾“å…¥.</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">fib</span><span class="params">(<span class="keyword">int</span> a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!a || a == <span class="number">1</span>)</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> fib(a<span class="number">-1</span>) + fib(a<span class="number">-2</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> flag[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;, i = <span class="number">0</span>; </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt;= <span class="number">15</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">flag[i] = fib(i); </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">15</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d "</span>, flag[i] = (i &lt; <span class="number">15</span> ? flag[i] - flag[<span class="number">15</span>]:flag[i]));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2020/04/27/cpp-%E9%80%86%E5%90%91/image-20200510184751024.png" alt="image-20200510184751024"></p></li><li><p><strong>æ€»ç»“: (1)æ³¨æ„ä¼ é€’çš„å‚æ•°æ˜¯æŒ‡é’ˆè¿˜æ˜¯å€¼. (2)cppé€†å‘å¤ªå¤šæ•°éƒ½æœ‰ä¸€ä¸ªæ¨¡æ¿ä¸€æ ·, åŠ¨æ€è°ƒè¯•æ³¨æ„åœ°å€çš„å¯»æ‰¾.</strong></p></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;ç™¾è¶Šæ¯2018-crazy&quot;&gt;&lt;a href=&quot;#ç™¾è¶Šæ¯2018-crazy&quot; class=&quot;headerlink&quot; title=&quot;ç™¾è¶Šæ¯2018: crazy&quot;&gt;&lt;/a&gt;ç™¾è¶Šæ¯2018: crazy&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;é¦–å…ˆ, è¿™é“é¢˜çš„ç®—æ³•å¾ˆç®€å•, å°±æ˜¯è€ƒå¼•ç”¨C++çš„å­—ç¬¦ä¸²ç±»çš„å‡½æ•°. ä½†æ˜¯è‡ªå·±ä¹ŸæŒ–æ˜äº†ä¸€äº›æ„Ÿè§‰æœ‰ç”¨çš„ä¸œè¥¿, ä¸»è¦æ˜¯é€šè¿‡è¿™é“é¢˜æ€»ç»“ c++å­—ç¬¦ä¸²ç±».&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æ‹–å…¥ExeinfoPe, é¢˜ç›®æ˜¯64ä¸ºelfæ–‡ä»¶, ç”¨64ä¸ºidaæ‰“å¼€.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æ‰¾åˆ°ä¸»å‡½æ•°,  æŸ¥çœ‹ä¼ªä»£ç , å‘ç°å¾ˆå†—é•¿, ä½†å¤§å¤šæ•°éƒ½æ˜¯é‚£äº›å­—ç¬¦ä¸²ç±»å‡½æ•°å’Œæ— ç”¨çš„ä¿¡æ¯. æˆ‘ä»¬å¯ä»¥å…ˆé€šè¿‡ç‚¹å‡»æœ€åæ¯”è¾ƒè¦ç”¨åˆ°çš„å­—ç¬¦ä¸²çš„åç§°, è¿™æ—¶ä¼šæŠŠæ‰€æœ‰ç›¸åŒåç§°éƒ½é«˜äº®æ˜¾ç¤ºå‡ºæ¥, å°±å¯ä»¥é€šè¿‡é€»è¾‘åˆ¤æ–­å‡ºé‚£äº›æ˜¯å…³é”®å‡½æ•°å’Œå˜é‡.&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;
    
    </summary>
    
    
    
      <category term="CTF" scheme="https://hus96r.coding-pages.com/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>2020å¹´DASCTFå››æœˆçº¿ä¸Šèµ›</title>
    <link href="https://hus96r.coding-pages.com/2020/04/25/2020%E5%B9%B4DASCTF%E5%9B%9B%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/"/>
    <id>https://hus96r.coding-pages.com/2020/04/25/2020%E5%B9%B4DASCTF%E5%9B%9B%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/</id>
    <published>2020-04-25T11:27:55.000Z</published>
    <updated>2020-05-27T03:32:53.138Z</updated>
    
    <content type="html"><![CDATA[<h3 id="Bluetooth"><a href="#Bluetooth" class="headerlink" title="Bluetooth"></a>Bluetooth</h3><p>ä¸‹è½½ä¸‹æ¥æ˜¯ä¸€ä¸ªæµé‡åŒ…, é¢˜ç›®ä¹Ÿæ²¡æœ‰æç¤º, å°±å…ˆç”¨binwalkçœ‹èƒ½ä¸èƒ½æå–å‡ºä»€ä¹ˆ. ç›´æ¥ <strong>binwalk -e</strong>, ä»€ä¹ˆä¹Ÿæ²¡æœ‰, </p><p>ä½†æ˜¯æˆ‘ä»¬å¾€ä¸‹çœ‹ä¸€ä¸‹, æ˜¯æœ‰ä¸ªå‹ç¼©åŒ…. é‚£å°±æ‰‹åŠ¨æå–å§. <strong>dd if=3.pcapng bs=1 skip=24437 of=3.zip</strong> </p><p><img src="/2020/04/25/2020%E5%B9%B4DASCTF%E5%9B%9B%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200425202118617-1590546897888.png" alt="image-20200425202118617"></p><p>è¿™æ¬¡, æ–‡ä»¶æ‰€åœ¨ç›®å½•å‡ºç°äº†ä¸€ä¸ªå‹ç¼©åŒ…, å°è¯•æ‰“å¼€ä½†æ˜¯æœ‰å¯†ç , ä½†æ˜¯æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®ƒæç¤ºä¿¡æ¯: </p><p><img src="/2020/04/25/2020%E5%B9%B4DASCTF%E5%9B%9B%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200425202435440-1590546907450.png" alt="image-20200425202435440"></p><a id="more"></a><p>è¯´å¯†ç è“ç‰™çš„pin, æˆ‘ä¹Ÿæ˜¯åˆšåˆšæ¥è§¦è¿™ä¸ªwireshareè¿™ä¸ªè½¯ä»¶, ç™¾åº¦äº†ä¸€ä¸‹, å°±æ˜¯æˆ‘ä»¬è¿æ¥è“ç‰™æ—¶çš„é‚£ä¸ªæ•°å­—.  ä½†æ˜¯æˆ‘æ˜¯ä¸çŸ¥é“æ€ä¹ˆæ‰¾è¿™ä¸ªä¸œè¥¿,å°±ç™¾åº¦æ€ä¹ˆç”¨wiresharkæŠ“è“ç‰™çš„åŒ…, ä½†æ²¡æœ‰çš„å¾—åˆ°æœ‰ç”¨æ¶ˆæ¯, æœ‰çš„è¿˜è¦ä»€ä¹ˆè“ç‰™é©±åŠ¨. å°±è‡ªå·±å»æœç´¢bluetooth, æ‰¾äº†ä¸€åœˆä¹Ÿæ²¡æœ‰å¾—åˆ°é‚£ä¸ªpin.  æˆ‘å°±åˆè·‘å»æ‰“æš´åŠ›ç ´è§£çš„æ‰“ç®—, ä½†åˆæ²¡æœ‰7zå‹ç¼©åŒ…æš´åŠ›ç ´è§£å¯†ç çš„å·¥å…·, åˆå»å„å¤§è®ºå›æ‰¾, æ‰¾åˆ°äº†ä½†æ²¡ç”¨ğŸ˜‚. æš‚æ—¶æ”¾ä¸‹äº†è¿™ä¸ªé¢˜, å»åšreverse, reverseçš„2ä¸ªé¢˜åšçš„è¿˜æ¯”è¾ƒé¡ºåˆ©.  å›æ¥ç»§ç»­çœ‹è¿™ä¸ªé¢˜, è¿™æ¬¡å¹²è„†ç›´æ¥æœ pin è¯•è¯•, å‡ºç° PINè¯·æ±‚, PINè¯·æ±‚å›åº”, PINè¯·æ±‚å›åº”å®Œæˆ, </p><p><img src="/2020/04/25/2020%E5%B9%B4DASCTF%E5%9B%9B%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200425203534918-1590546913901.png" alt="image-20200425203534918"></p><p>é‚£ä¹ˆè¿™PINè¯·æ±‚å›åº”çš„å¯èƒ½æ€§å°±æœ€å¤§äº†, ç‚¹è¿›å»:å¯ä»¥çœ‹åˆ° PIN Code : 141854.  </p><p><img src="/2020/04/25/2020%E5%B9%B4DASCTF%E5%9B%9B%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200425203900340-1590546919828.png" alt="image-20200425203900340"></p><p>æœ€åè¾“å…¥å‹ç¼©åŒ…å¾—åˆ°flag.</p><p><img src="/2020/04/25/2020%E5%B9%B4DASCTF%E5%9B%9B%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200425204118569-1590546940841.png" alt="image-20200425204118569"></p><hr><h3 id="reverseç¬¬äºŒé¢˜"><a href="#reverseç¬¬äºŒé¢˜" class="headerlink" title="reverseç¬¬äºŒé¢˜."></a>reverseç¬¬äºŒé¢˜.</h3><p>é¢˜ç›®ä¸‹è½½å, ç”¨idaæ‰“å¼€, æ‰¾åˆ°ä¸»å‡½æ•°, é€»è¾‘ä¸Šå¾ˆæ¸…æ™°, è¯´æ˜¯å°†flagä¸æˆ‘ä»¬è¾“å…¥çš„æ•°å­—æ··åˆåœ¨äº†ä¸€èµ·. ç¨‹åºå°±åšäº†å°†æˆ‘ä»¬è¾“å…¥çš„æ•°å­—ä¸å·²ç»ç¼–ç äº†çš„ä¸€äº›æ•°æ®è¿›è¡Œå¼‚æˆ–è¿ç®—ç„¶åè¾“å‡ºçš„æ“ä½œ.</p><p><img src="/2020/04/25/2020%E5%B9%B4DASCTF%E5%9B%9B%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200426191831676-1590546936568.png" alt="image-20200426191831676"></p><p>å¼€å§‹æƒ³çš„æ˜¯ä¼šä¸ä¼šç›´æ¥å°±æ˜¯å·²ç»ç¼–ç çš„æ•°æ®, çœ‹äº†çœ‹ASCII,ä¸å¯èƒ½æ˜¯.  </p><p>é‚£æœ‰å¯èƒ½å°±æ˜¯å°†æˆ‘ä»¬è¾“å…¥çš„æ•°æ®ä¸ç¼–ç çš„æ•°æ®è¿›è¡Œæˆ–è¿ç®—åè¾“å‡ºçš„æ˜¯flag. é‚£ä¹ˆæŒ‰ç…§flagçš„æ ¼å¼, æ ¹æ®é¢˜ç›®è¯´ æœ€åçš„flagè¾“å…¥çš„æ˜¯ flag{}/DACTF{}ä¸­çš„æ•°æ®, é‚£ä¹ˆè¿™é‡Œçš„flagä¹Ÿå°±æ˜¯è¿™2ç§æ ¼å¼äº†. </p><p>è¿™æ ·å°±å¥½åŠäº†, ä»–ä»¬æœ«å°¾éƒ½æ˜¯ <strong>}</strong> æˆ‘ä»¬æŠŠç¼–ç æ•°æ®çš„æœ€åä¸€ä½ 61 , æ‰¾åˆ°ä¸€ä¸ªæ•°å­—ä¸å®ƒå¼‚æˆ–è¿ç®—ä½çš„å€¼ä¸º <strong>}</strong> çš„ASCII 125, å°±è¡Œäº†. å¾—åˆ°64, æœ€åæŠŠç¼–ç çš„æ‰€æœ‰æ•°æ®ä¸<strong>64</strong>è¿›è¡Œä¸€ä¸ªå¼‚æˆ–è¿ç®—å°±å¾—åˆ°flag. </p><p><strong>ä½†æ˜¯æå–æ•°å­—æ—¶,æˆ‘ä»¬å¯ä»¥ç›´æ¥æŠŠä»£ç å¤åˆ¶åˆ°ç¼–è¯‘ä¸­, ä½†æ˜¯æ³¨æ„, è¿™ä¸æ˜¯æ•°ç»„, æ ¹æ®æ ˆçš„ç‰¹ç‚¹, è¦å€’ç€éå†.</strong></p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;Bluetooth&quot;&gt;&lt;a href=&quot;#Bluetooth&quot; class=&quot;headerlink&quot; title=&quot;Bluetooth&quot;&gt;&lt;/a&gt;Bluetooth&lt;/h3&gt;&lt;p&gt;ä¸‹è½½ä¸‹æ¥æ˜¯ä¸€ä¸ªæµé‡åŒ…, é¢˜ç›®ä¹Ÿæ²¡æœ‰æç¤º, å°±å…ˆç”¨binwalkçœ‹èƒ½ä¸èƒ½æå–å‡ºä»€ä¹ˆ. ç›´æ¥ &lt;strong&gt;binwalk -e&lt;/strong&gt;, ä»€ä¹ˆä¹Ÿæ²¡æœ‰, &lt;/p&gt;
&lt;p&gt;ä½†æ˜¯æˆ‘ä»¬å¾€ä¸‹çœ‹ä¸€ä¸‹, æ˜¯æœ‰ä¸ªå‹ç¼©åŒ…. é‚£å°±æ‰‹åŠ¨æå–å§. &lt;strong&gt;dd if=3.pcapng bs=1 skip=24437 of=3.zip&lt;/strong&gt; &lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/2020/04/25/2020%E5%B9%B4DASCTF%E5%9B%9B%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200425202118617-1590546897888.png&quot; alt=&quot;image-20200425202118617&quot;&gt;&lt;/p&gt;
&lt;p&gt;è¿™æ¬¡, æ–‡ä»¶æ‰€åœ¨ç›®å½•å‡ºç°äº†ä¸€ä¸ªå‹ç¼©åŒ…, å°è¯•æ‰“å¼€ä½†æ˜¯æœ‰å¯†ç , ä½†æ˜¯æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®ƒæç¤ºä¿¡æ¯: &lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/2020/04/25/2020%E5%B9%B4DASCTF%E5%9B%9B%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200425202435440-1590546907450.png&quot; alt=&quot;image-20200425202435440&quot;&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="DASCTFçº¿ä¸Š" scheme="https://hus96r.coding-pages.com/categories/DASCTF%E7%BA%BF%E4%B8%8A/"/>
    
    
      <category term="CTF" scheme="https://hus96r.coding-pages.com/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>BUUCTF</title>
    <link href="https://hus96r.coding-pages.com/2020/04/23/BUUCTF/"/>
    <id>https://hus96r.coding-pages.com/2020/04/23/BUUCTF/</id>
    <published>2020-04-23T11:05:34.000Z</published>
    <updated>2020-05-27T03:35:11.094Z</updated>
    
    <content type="html"><![CDATA[<h3 id="CrackRTF1"><a href="#CrackRTF1" class="headerlink" title="CrackRTF1"></a>CrackRTF1</h3><p>ä»åˆšå¼€å§‹æ¥è§¦ BUUCTF , åšåˆ°é€†å‘çš„è¿™é“é¢˜, çœ‹äº†writeup ä¹Ÿè§‰å¾—éš¾, å°±åœæ»äº†ä¸€æ®µæ—¶é—´. åˆ°è®ºå‰‘åœºå’Œæ”»é˜²ä¸–ç•Œåšäº†20å¤šå¤©(æœŸé—´ä¹Ÿå¼€å§‹äº†pwn), ä»Šå¤©çªç„¶æƒ³åˆ°è¿™é“é¢˜(ä¸€ç›´æ”¾åœ¨æ¡Œé¢é¡¶éƒ¨).</p><p>å¼€å§‹æ‰“å¼€idaåˆ†ææ—¶, å‘ç°é€»è¾‘æ˜¯å¤šä¹ˆçš„æ¸…æ™°, ä½†æ˜¯å½“è¿›å…¥ç¬¬ä¸€ä¸ªå…³é”®å‡½æ•°æ—¶, æƒ³èµ·äº†ä¸Šæ¬¡çš„éš¾ç‚¹. (1)å¯¹hashå¾ˆé™Œç”Ÿ, ä¸çŸ¥é“ä¸ºä»€ä¹ˆhashä¸å¯é€†, å¿…é¡»è¦çˆ†ç ´. (2)å½“æ—¶ä¸€ç‚¹pythonéƒ½æ²¡æ¥è§¦è¿‡, å¯¹äºè¦å†™pythonè„šæœ¬çˆ†ç ´, å°±è§‰å¾—å¾ˆçƒ¦(å½“ç„¶ç»è¿‡ä¸æ–­çš„å­¦ä¹ , è¿™20å¤šå¤©, æ¥è§¦å¹¶å¼€å§‹å­¦ä¹ äº›python). (3)è¿™é‡Œç¬¬äºŒæ¬¡è¾“å…¥, å› ä¸ºæ²¡æœ‰é™åˆ¶æ¡ä»¶, è¿˜ä¸èƒ½çˆ†ç ´, åé¢åˆæ˜¯ä¸€äº›ä»æ²¡å¬è¯´è¿‡çš„æ“ä½œ.(ä½†å…¶å®è¿™æ¬¡å†æ¥çœ‹, å…¶å®å°±æ˜¯è¦ç”¨<strong>Resource Hacker</strong>è¿™ä¸ªå·¥å…·æŸ¥çœ‹.exeæ–‡ä»¶é‡Œçš„èµ„æºæ–‡ä»¶, ç»è¿‡ä¸€äº›é€»è¾‘ä¸Šçš„æ“ä½œ)<a id="more"></a></p><p>é¦–å…ˆ, çŸ¥é“æ˜¯ç³»ç»Ÿè°ƒç”¨çš„å‡½æ•°, å½“æ—¶å°±æ¯ä¸ªéƒ½ç™¾åº¦äº†ä¸‹, ä¹Ÿæ˜¯å¾ˆéº»çƒ¦çš„(ä½†æ˜¯é€†å‘çš„è·¯å°±æ˜¯è¿™æ ·, è¦çŸ¥é“çš„å¾ˆå¤šå¾ˆå¤š, åªæœ‰è‡ªå·±æ…¢æ…¢çš„ç§¯ç´¯).è®°å¾—æ•´ä¸ªå‡½æ•°ä½œç”¨å°±æ˜¯ è°ƒç”¨ä¸€ä¸ªhashåŠ å¯†å‡½æ•°. å…·ä½“æ˜¯é‚£ä¸ªhash, å¯ä»¥æŸ¥çœ‹å®˜æ–¹çš„ä»‹ç», ä»è¿™é‡Œçš„ç¼–å· : <strong>0x8004</strong> å»æ‰¾å¯¹åº”çš„åŠ å¯†, ç»è¿‡æŸ¥è¯¢æ˜¯ sha1.</p><p><img src="/2020/04/23/BUUCTF/image-20200423194434469.png" alt="image-20200423194434469"></p><p>å› ä¸ºhashä¸å¯é€†, ä½†æ˜¯è¿™é‡Œæœ‰å­—ç¬¦ä¸²é•¿åº¦æ˜¯ 6 ä½, ä¸”è½¬åŒ–ä¸ºæ•´æ•°å &gt;= 100000, é‚£ä¹ˆèŒƒå›´å°±ç¡®å®šäº†: 100000 - 999999, ä¸‹é¢çˆ†ç ´è„šæœ¬: å¾—åˆ° <strong>123321@DBApp</strong>, é‚£ä¹ˆæˆ‘ä»¬è¾“å…¥å°±æ˜¯ ; <strong>123321</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">flag = <span class="string">"@DBApp"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">100000</span>, <span class="number">999999</span>):</span><br><span class="line">    s = str(i) + flag</span><br><span class="line">    x = hashlib.sha1(s.encode())</span><br><span class="line">    <span class="keyword">if</span> <span class="string">"6E32D0943418C2C33385BC35A1470250DD8923A9"</span>.lower() == x.hexdigest():</span><br><span class="line">        <span class="keyword">print</span> (str(i) + flag)</span><br></pre></td></tr></table></figure><p> æ¥ä¸‹æ¥, è¾“å…¥ç¬¬äºŒä¸ªå­—ç¬¦ä¸², ä½†æ˜¯è¦åŠ ä¸Šä¸Šé¢çš„<strong>123321@DBApp</strong> ç„¶åhashåŠ å¯†æ“ä½œ.ä½†æ˜¯è¿™æ¬¡çš„ç¼–å·æ”¹å˜äº† <strong>0x8003 : mad5</strong>, è¿™æ¬¡æ²¡æœ‰é™åˆ¶æ¡ä»¶, çˆ†ç ´ä¸è¡Œäº†.</p><p>ç»è¿‡çœ‹å¤§ç¥ä»¬çš„æ“ä½œ, çŸ¥é“äº†å¯ä»¥é€šè¿‡ä¸‹é¢ä¸€ä¸ªå‡½æ•°.è¿™ä¸ªå‡½æ•°å’Œæˆ‘ä»¬çš„fopené‚£äº›æ–‡ä»¶æ“ä½œä¸åŒ. </p><p>è¿™ä¸ª FindResourceAæ˜¯æ‰“å¼€è¿™ä¸ª.exeæ–‡ä»¶ä¸­èµ„æºæ–‡ä»¶çš„æ–‡ä»¶.(è¿™ç‚¹ç¬¬ä¸€æ¬¡çŸ¥é“, è¿˜æœ‰è¿™ç§æ“ä½œ!!!, ç»è¿‡ç™¾åº¦, å‘ç°å¯ä»¥å°†è‡ªå·±çš„èµ„æºæ–‡ä»¶åŠ å…¥.exeæ–‡ä»¶ä¸­), æ‰“å¼€AAAå, å°†é‡Œé¢çš„å†…å®¹ä¸æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦è¿›è¡Œå¼‚æˆ–æ“ä½œ, æœ€åå°†å†…å®¹å†™å…¥æ–°åˆ›å»ºä¸€ä¸ª dbapp.rtf æ–‡ä»¶. è¿™é‡Œå¤§ç¥çš„è¯´æ³•éƒ½æ˜¯, å› ä¸ºæ˜¯å†™è¿›.rtf æ–‡ä»¶é‚£ä¹ˆå¼€å§‹å†™å…¥çš„å¿…ç„¶æ˜¯æ–‡ä»¶å¤´, æˆ‘ä»¬å°±å¯ä»¥éšä¾¿åˆ›å»ºä¸€ä¸ª.rtfæ–‡ä»¶, æŸ¥çœ‹æ–‡ä»¶å¤´å†…å®¹. å¯ä»¥çœ‹åˆ°æ˜¯ <strong>{\rtf1</strong>, æ­£å¥½æ˜¯6ä½,æˆ‘ä»¬æœ€åè¾“å…¥çš„ä¹Ÿæ˜¯6ä½, é‚£ä¹ˆæŠŠä»–å’ŒAAAæ–‡ä»¶ä¸­çš„å‰6ä½å¼‚æˆ–ä¸€ä¸‹, å°±å¾—åˆ°æˆ‘ä»¬è¾“å…¥çš„äº†. </p><h3 id><a href="#" class="headerlink" title></a><img src="/2020/04/23/BUUCTF/image-20200423200957999.png" alt="image-20200423200957999"></h3><p><img src="/2020/04/23/BUUCTF/image-20200423202735198.png" alt="image-20200423202735198"></p><p><img src="/2020/04/23/BUUCTF/image-20200423202025893.png" alt="image-20200423202025893"></p><p>ä¸‹é¢è„šæœ¬: æœ€åå¾—åˆ° <strong>~!3a@0</strong>, è¾“å…¥ç¨‹åºå, ä¼šåˆ›å»ºä¸€ä¸ª dbapp.rtf æ–‡ä»¶, æ‰“å¼€å³æ˜¯flag.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="number">0x05</span>, <span class="number">0x7D</span>, <span class="number">0x41</span>, <span class="number">0x15</span>, <span class="number">0x26</span>, <span class="number">0x01</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"></span><br><span class="line">rtf = <span class="string">"&#123;\\rtf1"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(rtf)):</span><br><span class="line">    x = ord(rtf[i]) ^ a[i]</span><br><span class="line">    flag += chr(x)</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><p>ä½†å¯¹äºæœ€åçš„ <strong>å› ä¸ºæ˜¯å†™è¿›.rtf æ–‡ä»¶é‚£ä¹ˆå¼€å§‹å†™å…¥çš„å¿…ç„¶æ˜¯æ–‡ä»¶å¤´</strong> æˆ‘æ˜¯æ„Ÿè§‰å¥‡æ€ªçš„, ä»–åˆ›å»ºäº†ä¸€ä¸ªdbapp.rtf æ–‡ä»¶, å†™å…¥çš„ä¸å°±æ˜¯æ–‡ä»¶çš„å†…å®¹å—, ä¸ºä»€ä¹ˆæ–‡ä»¶å¤´éƒ½è¦æˆ‘ä»¬æ¥å†™å…¥. å™¢, å› ä¸ºä»¥å‰å­¦ä¹ æ–‡ä»¶æ“ä½œçš„æ—¶å€™éƒ½æ˜¯å¾€.txtæ–‡ä»¶é‡Œå†™å†…å®¹, é‚£ä¸ªæ²¡æœ‰æ–‡ä»¶å¤´è¿™ä¸€è¯´, æ‰€ä»¥å¯ä»¥ä¸€å¼€å§‹å†™è¿›å†…å®¹. å†™å…¥çš„å®è´¨è¿˜æ˜¯å¡«å……äºŒè¿›åˆ¶çš„01. æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬è¦å…ˆå†™ .rtfæ–‡ä»¶å¤´. </p><p><img src="/2020/04/23/BUUCTF/image-20200423204326824.png" alt="image-20200423204326824"></p><p>æœ€å, .rtfæ–‡ä»¶ä¸ docx dox ç±»ä¼¼, <strong><em>\</em>å¯Œæ–‡æœ¬æ ¼å¼\</strong>ï¼ˆ*<em>Rich Text Format*</em>ï¼‰å³*<em>RTFæ ¼å¼*</em>ï¼Œåˆç§°*<em>å¤šæ–‡æœ¬æ ¼å¼*</em>ï¼Œæ˜¯ç”±<a href="https://baike.baidu.com/item/å¾®è½¯" target="_blank" rel="noopener">å¾®è½¯</a>å…¬å¸å¼€å‘çš„è·¨å¹³å°<a href="https://baike.baidu.com/item/æ–‡æ¡£" target="_blank" rel="noopener">æ–‡æ¡£</a>æ ¼å¼ã€‚å¤§å¤šæ•°çš„<a href="https://baike.baidu.com/item/æ–‡å­—å¤„ç†" target="_blank" rel="noopener">æ–‡å­—å¤„ç†</a>è½¯ä»¶éƒ½èƒ½è¯»å–å’Œä¿å­˜RTFæ–‡æ¡£ã€‚**</p><p>macå…ˆåˆ›å»ºçš„æ–‡æœ¬æ–‡ä»¶, é»˜è®¤éƒ½æ˜¯ .rtf.</p><p>å¿ƒå¾—: å¦‚æœåšåˆ°æ„Ÿè§‰å¾ˆåƒåŠ›çš„é¢˜å¯ä»¥å…ˆæ”¾ä¸€æ”¾, ç­‰å­¦ä¹ ä¸€æ®µæ—¶é—´, çŸ¥è¯†ç§¯ç´¯çš„æ›´å¤šäº†å†æ¥çœ‹, ä¸è¦æ­»ç£•!</p><p>å½“ä¸€æ¡è·¯ä¸åŒæ—¶, æ³¨æ„å…¶ä»–å‡½æ•°çš„åŠŸèƒ½, æƒ³å®ƒçš„å­˜åœ¨ä¸ºä»€ä¹ˆ. </p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;CrackRTF1&quot;&gt;&lt;a href=&quot;#CrackRTF1&quot; class=&quot;headerlink&quot; title=&quot;CrackRTF1&quot;&gt;&lt;/a&gt;CrackRTF1&lt;/h3&gt;&lt;p&gt;ä»åˆšå¼€å§‹æ¥è§¦ BUUCTF , åšåˆ°é€†å‘çš„è¿™é“é¢˜, çœ‹äº†writeup ä¹Ÿè§‰å¾—éš¾, å°±åœæ»äº†ä¸€æ®µæ—¶é—´. åˆ°è®ºå‰‘åœºå’Œæ”»é˜²ä¸–ç•Œåšäº†20å¤šå¤©(æœŸé—´ä¹Ÿå¼€å§‹äº†pwn), ä»Šå¤©çªç„¶æƒ³åˆ°è¿™é“é¢˜(ä¸€ç›´æ”¾åœ¨æ¡Œé¢é¡¶éƒ¨).&lt;/p&gt;
&lt;p&gt;å¼€å§‹æ‰“å¼€idaåˆ†ææ—¶, å‘ç°é€»è¾‘æ˜¯å¤šä¹ˆçš„æ¸…æ™°, ä½†æ˜¯å½“è¿›å…¥ç¬¬ä¸€ä¸ªå…³é”®å‡½æ•°æ—¶, æƒ³èµ·äº†ä¸Šæ¬¡çš„éš¾ç‚¹. (1)å¯¹hashå¾ˆé™Œç”Ÿ, ä¸çŸ¥é“ä¸ºä»€ä¹ˆhashä¸å¯é€†, å¿…é¡»è¦çˆ†ç ´. (2)å½“æ—¶ä¸€ç‚¹pythonéƒ½æ²¡æ¥è§¦è¿‡, å¯¹äºè¦å†™pythonè„šæœ¬çˆ†ç ´, å°±è§‰å¾—å¾ˆçƒ¦(å½“ç„¶ç»è¿‡ä¸æ–­çš„å­¦ä¹ , è¿™20å¤šå¤©, æ¥è§¦å¹¶å¼€å§‹å­¦ä¹ äº›python). (3)è¿™é‡Œç¬¬äºŒæ¬¡è¾“å…¥, å› ä¸ºæ²¡æœ‰é™åˆ¶æ¡ä»¶, è¿˜ä¸èƒ½çˆ†ç ´, åé¢åˆæ˜¯ä¸€äº›ä»æ²¡å¬è¯´è¿‡çš„æ“ä½œ.(ä½†å…¶å®è¿™æ¬¡å†æ¥çœ‹, å…¶å®å°±æ˜¯è¦ç”¨&lt;strong&gt;Resource Hacker&lt;/strong&gt;è¿™ä¸ªå·¥å…·æŸ¥çœ‹.exeæ–‡ä»¶é‡Œçš„èµ„æºæ–‡ä»¶, ç»è¿‡ä¸€äº›é€»è¾‘ä¸Šçš„æ“ä½œ)&lt;/p&gt;
    
    </summary>
    
    
      <category term="BUUCTF" scheme="https://hus96r.coding-pages.com/categories/BUUCTF/"/>
    
    
      <category term="CTF" scheme="https://hus96r.coding-pages.com/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>æ”»é˜²ä¸–ç•Œ (1)</title>
    <link href="https://hus96r.coding-pages.com/2020/04/09/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(1)/"/>
    <id>https://hus96r.coding-pages.com/2020/04/09/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(1)/</id>
    <published>2020-04-09T01:53:27.000Z</published>
    <updated>2020-05-27T03:40:21.891Z</updated>
    
    <content type="html"><![CDATA[<h3 id="misc"><a href="#misc" class="headerlink" title="misc:"></a>misc:</h3><p>èœç‹—æˆªè·äº†ä¸€ä»½æŠ¥æ–‡å¦‚ä¸‹</p><p>ä»æŠ¥æ–‡ä¸­å¯ä»¥è”æƒ³åˆ°æ˜¯md5åŠ å¯†, ä½†è¯•äº†ä¸€ä¸‹, å‘ç°ä¸å¯¹. å†çœ‹æŠ¥æ–‡ä¸­å­—æ¯åªæ˜¯ a-f , æ‰€ä»¥å¯èƒ½æ˜¯åå…­è¿›åˆ¶æ•°, åˆä¸€èˆ¬éƒ½æ˜¯ä¸€ä¸ªå­—èŠ‚ä¸€ä¸ªå­—ç¬¦, è€Œä¸€ä¸ªå­—èŠ‚å­˜æ”¾äºŒä¸ªåå…­è¿›åˆ¶æ•°. æˆ‘ä»¬å°±2ä¸ªä¸€ç»„è½¬æ¢æˆåè¿›åˆ¶, ä½†æ˜¯å¤§äºäº†127, å¯æ‰“å°å­—ç¬¦ASCIIèŒƒå›´åœ¨<strong>0-127</strong>,  é‚£æˆ‘ä»¬çŸ¥é“ <code>}</code>å­—ç¬¦çš„ASCIIåå…­è¿›åˆ¶ä¸º <strong>0X7D</strong>,  å†çœ‹æŠ¥æ–‡æœ€å2ä¸ªå­—ç¬¦ç»„æˆçš„åå…­è¿›åˆ¶æ•° <strong>0xf2</strong>, ä¸€èˆ¬æˆ‘ä»¬å¯ä»¥æœ‰è¿™ä¸ªæ€è·¯,æ±‚å·®å€¼ ä½†ä¹Ÿæœ‰æœ€åæ²¡æœ‰ç”¨ <strong>}</strong>ç»“å°¾çš„, è¿™é‡Œå°±ä¸æ˜¯.ğŸ˜‚. ä½†å…¶å®æƒ³åˆ°è¦æŠŠå­—ç¬¦æ‰“å°å‡ºæ¥, è€Œå­—ç¬¦ASCII<strong>0-127</strong>, é‚£å°±ç›´æ¥è¯•ä¸€è¯•å‡128, ä¸€ä¸‹å­å°±å¯¹äº†, å“ˆå“ˆğŸ˜.<a id="more"></a></p><p>ä¸‹é¢æ˜¯Cè¯­è¨€å†™çš„, 2ä¸ªä¸€ç»„è½¬æ¢æˆåè¿›åˆ¶æ•°, æœ€åå˜æˆå¯æ‰“å°å­—ç¬¦:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> a[] = <span class="string">"c8e9aca0c6f2e5f3e8c4efe7a1a0d4e8e5a0e6ece1e7a0e9f3baa0e8eafae3f9e4eafae2eae4e3eaebfaebe3f5e7e9f3e4e3e8eaf9eaf3e2e4e6f2"</span>;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, lenth  = <span class="built_in">strlen</span>(a), sum = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> b[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;, j = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; lenth; i += <span class="number">2</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(a[i] &gt;= <span class="number">97</span> &amp;&amp; a[i] &lt;= <span class="number">122</span>)</span><br><span class="line">a[i] -= <span class="number">87</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(a[i] &gt;= <span class="number">65</span> &amp;&amp; a[i] &lt;=  <span class="number">90</span>) </span><br><span class="line">a[i] -= <span class="number">55</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">a[i] -= <span class="number">48</span>; </span><br><span class="line"></span><br><span class="line">sum = sum*<span class="number">16</span> + a[i];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(a[i+<span class="number">1</span>])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(a[i+<span class="number">1</span>] &gt;= <span class="number">97</span> &amp;&amp; a[i+<span class="number">1</span>] &lt;= <span class="number">122</span>)</span><br><span class="line">a[i+<span class="number">1</span>] -= <span class="number">87</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(a[i+<span class="number">1</span>] &gt;= <span class="number">65</span> &amp;&amp; a[i+<span class="number">1</span>] &lt;=  <span class="number">90</span>) </span><br><span class="line">a[i+<span class="number">1</span>] -= <span class="number">55</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">a[i+<span class="number">1</span>] -= <span class="number">48</span>;</span><br><span class="line"></span><br><span class="line">sum = sum*<span class="number">16</span> + a[i+<span class="number">1</span>]; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(sum &gt; <span class="number">127</span>)</span><br><span class="line">sum -= <span class="number">128</span>;</span><br><span class="line"></span><br><span class="line">b[j++] = sum, sum = <span class="number">0</span>; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(b);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h3 id="reverse1"><a href="#reverse1" class="headerlink" title="reverse1:"></a><strong>reverse1:</strong></h3><p>é¦–å…ˆæ‹¿åˆ°é¢˜, è¿˜æ˜¯æ‹–è¿›<strong>Exeinfope</strong>æŸ¥çœ‹ä¸€ä¸‹æ˜¯å¦æœ‰å£³:</p><p><img src="/2020/04/09/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(1)/image-20200409121215784-1590549058520.png" alt="image-20200409121215784"></p><p>å—¯æ²¡æœ‰.</p><p>æ‹–è¿›ida, æ‰¾åˆ°ä¸»å‡½æ•°, æµè§ˆä¸€ä¸‹ç¨‹åºåŠŸèƒ½, ä¸€ä¸ªæ¸¸æˆ, å¥½åƒæ˜¯é€šè¿‡ç‚¹äº®æ‰€æœ‰ç¯è·å¾—flag. é‚£ä¹ˆå¿…å®šæœ‰ä¸€ä¸ªåˆ¤æ–­æ¡ä»¶, å¾€ä¸‹çœ‹ä¸»å‡½æ•°, æ˜¾è€Œæ˜“è§:</p><p><img src="/2020/04/09/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(1)/image-20200409121557118-1590549064830.png" alt="image-20200409121557118"></p><p>é‚£ä¹ˆä¸‹é¢ä¸€ä¸ªå‡½æ•°å°±æ˜¯å…³é”®å‡½æ•°äº†, è¿›å»å‘ç°å°±æ˜¯å°†flagè®¡ç®—å‡ºæ¥, 56ä½é•¿åº¦, è¿˜æ˜¯æ‡’å¾—è‡ªå·±å†™ç¨‹åºæ¥ç®—.</p><p>æˆ‘ä»¬å¯ä»¥åœ¨idaä¸­æ‰¾åˆ° <strong>åˆ¤æ–­æ¡ä»¶</strong>é‚£é‡Œçš„çš„åœ°å€,: 0045F5D1</p><p><img src="/2020/04/09/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(1)/image-20200409122019635-1590549068676.png" alt="image-20200409122019635"></p><p>å†é€šè¿‡OD,çœ‹åŠ è½½çš„ VA(è™šæ‹Ÿå†…å­˜åœ°å€) :</p><p><img src="/2020/04/09/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(1)/image-20200409203440087-1590549086887.png" alt="image-20200409203440087"></p><p>é‚£ä¹ˆç”±äº åŠ¨æ€å’Œé™æ€çš„VAå¯èƒ½ä¸åŒï¼Œä½†æ˜¯å®ƒä»¬çš„RVAè¿˜æ˜¯ä¸€æ ·çš„ã€‚æˆ‘ä»¬ä½¿ç”¨åœ¨idaä¸­çš„æ‰¾åˆ°VA - imagebase = RVA. å†åŠ ä¸ŠODä¸­çš„VA, å³å¾—åˆ°åœ¨ODä¸­çš„åœ°å€: 0091F5D1. è¿™æ ·æˆ‘ä»¬ç›´æ¥åœ¨ODä¸­æ‰¾åˆ°è¿™ä¸ªåœ°å€: å¦‚ä¸‹å›¾, çœ‹åˆ°å¾ˆå¤š jnz. æ‰€ä»¥æˆ‘ä»¬çš„ç›®çš„æ˜¯è®©å®ƒéƒ½ä¸è·³è½¬, å¯ä»¥æ¯ä¸ªåœ°æ–¹éƒ½ nopäº†, ä½†æˆ‘ä»¬å¯ä»¥å¾€ä¸‹çœ‹, ç›´æ¥æ‰¾åˆ°å®ƒæœ€ååº”è¯¥å»åˆ°çš„å‡½æ•°åœ°å€(è®°ä¸ºA), é€šè¿‡æ‰“è¡¥ä¸æŠŠjnz xxxx, (å›¾ä¸­0091F5D8) æ”¹ä¸º jmp A.</p><p><img src="/2020/04/09/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(1)/image-20200409204018803-1590549093480.png" alt="image-20200409204018803"></p><p>æœ€åä¸€æŒ‰ F9  è¿è¡Œ, å‡ºç°  flag  .</p><p><img src="/2020/04/09/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(1)/image-20200409204652301-1590549096561.png" alt="image-20200409204652301"></p><hr><h3 id="reverse2"><a href="#reverse2" class="headerlink" title="reverse2:"></a>reverse2:</h3><p>æ‹¿åˆ°é¢˜æ˜¯Cæºç , ç›´æ¥åˆ†æå°±å¥½äº†, æ‰¾åˆ°ä¸»å‡½æ•°çœ‹ä¸€ä¸‹. æ˜ç¡®ç›®æ ‡, è¾“å…¥å­—ç¬¦ä¸², ä¹Ÿå°±æ˜¯flag, è¿›è¡Œä¸€ç³»åˆ—æ“ä½œå’ŒæŒ‡å®šå­—ç¬¦ä¸²æ¯”è¾ƒ. æ‰¾åˆ°æ¯”è¾ƒçš„åœ°æ–¹å¾ˆå®¹æ˜“æ¨å‡º:è¿™é‡Œresult  == 0;</p><p><img src="/2020/04/09/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(1)/image-20200415170640341-1590549110220.png" alt="image-20200415170640341"></p><p>é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥çŸ¥é“ä¸‹é¢å‡½æ•°çš„å¼‚æˆ–è¿ç®—ç»“æœä¸º0, é‚£ä¹ˆå³å‘ç”Ÿå¼‚æˆ–è¿ç®—çš„2ä¸ªæ•°ç›¸ç­‰.</p><p><img src="/2020/04/09/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(1)/image-20200415170736593-1590549112522.png" alt="image-20200415170736593"></p><p>æœ€åå°±æ˜¯éšæœºæ•°çš„é€‰å–äº†, æˆ‘ä»¬çŸ¥é“å®ƒæ˜¯ &lt;= 64çš„, é‚£ä¹ˆå†™ä¸€ä¸ªCç¨‹åº, æŠŠæ‰€æœ‰ç»“æœæ‰“å°å‡ºæ¥, æ‰¾åˆ°ç¬¦åˆçš„å³å¯.</p><p><img src="/2020/04/09/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(1)/image-20200415171038960-1590549115097.png" alt="image-20200415171038960"></p><p>æœ€åä»è¿™é“é¢˜, çŸ¥é“äº†, 1.<code>pthread_t</code>æ˜¯<code>unsigned long</code>å®å®šä¹‰çš„, 8ä¸ªå­—èŠ‚æ•´å‹æ•°æ®.2.<code>rand()%m</code>ä¹Ÿæ˜¯<code>random(m)</code>å®å®šä¹‰çš„.  </p><hr><h3 id="secret-galaxy-300"><a href="#secret-galaxy-300" class="headerlink" title="secret-galaxy-300"></a>secret-galaxy-300</h3><p>é¦–å…ˆé¢˜ä¸‹è½½ä¸‹æ¥, å‘ç°å‡†å¤‡äº†3ä¸ªä¸åŒçš„ç‰ˆæœ¬, å°±åˆ†æå¸¸è§çš„PEæ–‡ä»¶.  æƒ³å…ˆæ‰“å¼€.exeæ–‡ä»¶, ä½†æ˜¯é—ªä¸€ä¸‹å°±é€€å‡ºäº†, æ ¹æœ¬çœ‹ä¸åˆ°ç¨‹åºæ˜¯åšä»€ä¹ˆçš„.</p><p>é¦–å…ˆæŸ¥å£³, å‘ç°æ— å£³.ğŸ˜ å…ˆç”¨idaæ‰“å¼€, æ‰¾åˆ°mainå‡½æ•°.å‘ç°æ˜¯ä»å·²ç»ç¼–ç çš„å­—ç¬¦ä¸²å–å‡ºæ¥, åœ¨æ‰“å°åœ¨å±å¹•ä¸Š. è½½å…¥OD, ä¸‹æ–­ç‚¹, çœ‹åˆ°åº•æ‰“å°äº†ä»€ä¹ˆ:  åˆ—å‡ºå‡ ä¸ªé“¶æ²³; æ˜¯å¦æ˜¯æœ‰ç”Ÿç‰©å­˜åœ¨; å®ƒä»¬è·ç¦»åœ°çƒçš„è·ç¦». ä½†è¿™ä¸ªå’Œflagæœ‰ä»€ä¹ˆå…³ç³»å‘¢.ğŸ˜¢. æƒ³ä¸åˆ°è”ç³», å›åˆ°idaä¸­å†çœ‹çœ‹. </p><p><img src="/2020/04/09/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(1)/image-20200415192448626-1590549120154.png" alt="image-20200415192448626"></p><p>å‘ç°å·²ç»ç¼–ç çš„å­—ç¬¦æœ‰ä¸€ä¸ªæ²¡è¢«æ‰“å°å‡ºæ¥. å°± ctrl + x, çœ‹å“ªé‡Œè°ƒç”¨äº†å®ƒ, è·Ÿè¿›å».</p><p><img src="/2020/04/09/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(1)/image-20200415193002493-1590549136439.png" alt="image-20200415193002493"></p><p>å‘ç°éƒ½æ˜¯èµ‹å€¼æ“ä½œ, ä¸”æœ€åä¸€ä¸ªèµ‹å€¼0, å¾ˆå¯èƒ½æ˜¯ flag çš„å­—ç¬¦ä¸².è®°å½•å¼€å§‹å’Œç»“æŸçš„åœ°å€, å» OD ä¸­åŠ¨æ€è°ƒè¯•.</p><p><img src="/2020/04/09/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(1)/image-20200415194242898-1590549138934.png" alt="image-20200415194242898"></p><p>ODä¸­åœ¨2ä¸ªåœ°å€, ä¸‹æ–­ç‚¹, å¹¶åœ¨å¼€å§‹è®°å½•ä¸‹èµ‹å€¼å­˜æ”¾æ•°æ®çš„åœ°å€, æŠŠå®ƒåœ¨æ•°æ®çª—å£ä¸­è·Ÿéš. F9æ‰§è¡Œå‡ºç°å­—ç¬¦ä¸².</p><p><img src="/2020/04/09/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(1)/image-20200415193726368-1590549141490.png" alt="image-20200415193726368"></p><p>å¿ƒå¾—: æ³¨æ„æ–‡ä»¶ä¸­ç¼–ç äº†ä½†æ˜¯æ²¡æœ‰ä½¿ç”¨çš„å­—ç¬¦ä¸². </p><hr><h3 id="Newbie-calculations"><a href="#Newbie-calculations" class="headerlink" title="Newbie_calculations:"></a>Newbie_calculations:</h3><p>é¦–å…ˆä»é¢˜ç›®çœ‹å‡º, æ˜¯æ–°æ‰‹è®¡ç®—, æƒ³åˆ°åº”è¯¥å’Œè®¡ç®—æœ‰å…³çš„. </p><p>é¢˜ç›®ä¸‹è½½ä¸‹æ¥, æ‰“å¼€å, åªæ˜¯æ‰“å°  <strong>Your flag is:</strong> ,å°±å¡ä½äº†, ä¹Ÿæ²¡æœ‰è®©è¾“å…¥ä¿¡æ¯. åœ¨è‡ªå·±å†™Cç¨‹åºä¹Ÿé‡åˆ°è¿‡è¿™ç§é—®é¢˜, åº”è¯¥æ˜¯ç¨‹åºæœ‰ä»€ä¹ˆæ­»å¾ªç¯, æˆ–è€…å¤§é‡è€—æ—¶é—´çš„ç®—æ³•.</p><p>è½½å…¥ida, æ‰¾åˆ°mainå‡½æ•°, æœç„¶æœ‰å¾ˆå¤šå‡½æ•°, è·Ÿè¿›å…¶ä¸­ä¸€ä¸ªåå‘ç° v4 = -1, åé¢åˆç”¨æ¥å¾ªç¯, å› ä¸ºè‡ªå·±è¡¥ç ä¸æ˜¯å¾ˆæ¸…æ¥š, å¼€å§‹åªæ˜¯æƒ³åˆ°è¿™ä¸æ˜¯æ­»å¾ªç¯å˜›, ä¸”å’Œè‡ªå·±ä¹‹å‰çš„æƒ³çš„ä¸€æ ·. ç„¶åå¤©çœŸçš„è®¤ä¸º, å®ƒå¯èƒ½æ²¡ç”¨, è·³è¿‡å®ƒ, ç›´æ¥æ‰§è¡Œåé¢çš„æˆ–è®¸å¯ä»¥æ‰¾åˆ°ç­”æ¡ˆ, å°±çœŸçš„å»OD, æ‰“è¡¥ä¸, ç¨‹åºç›´æ¥å¥”æºƒ. </p><p><img src="/2020/04/09/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(1)/image-20200417124955377-1590549145811.png" alt="image-20200417124955377"></p><p> è¿™ä¸ªæ—¶å€™å‘ç°æœ‰å¾ˆå¤šå‡½æ•°, éƒ½æ˜¯ä¸€æ ·çš„, å¥½åƒåªæœ‰3ä¸ªå‡½æ•°åœ¨å“ªé‡Œè°ƒç”¨. ä½†æƒ³åˆ°éº»çƒ¦,å‘ç°è®¡ç®—å’Œè¡¥ç ç›¸å…³, ç„¶åè‡ªå·±å†™ç®€å•çš„ç¨‹åºç¨‹åºå¤ä¹ äº†ä¸‹è¡¥ç ,  <strong>-1-128 = 127, 127+1 = -128;</strong>, å†ç»“åˆä¹‹å‰çœ‹åˆ°çš„è¡¥ç å’Œæ—¶é’ŸåŸç†å¾ˆåƒ, è‡ªå·±æ€»ç»“äº†ä¸‹, å¯ä»¥æŠŠè¿™ä¸ªè®¡ç®—æƒ³æˆæ˜¯ä¸€ä¸ªåœ†åœˆ, ä»¥ä¸€ä¸ªå­—èŠ‚8ä½æ¥çœ‹, æˆ‘ä»¬çŸ¥é“èŒƒå›´æ˜¯  <strong>-128 - 127</strong> </p><p><img src="/2020/04/09/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(1)/image-20200417131746746-1590549170275.png" alt="image-20200417131746746"></p><p>çŸ¥é“ä¸€ä¸ªå‘¨æœŸçš„å¤§å°æ˜¯ <strong>256</strong>.  é‚£ä¹ˆæœ‰ <strong>-1+1= 0</strong> ä¹Ÿå¯ä»¥å†™æˆ <strong>-1 - 255 = 0</strong>, ç›¸å½“äº -1 é€†æ—¶é’ˆè½¬äº† ä¸€åœˆå°‘1çš„è·ç¦», é‚£ä¹ˆå°±æ˜¯0çš„ä½ç½®, å› ä¸ºå¦‚æœè½¬äº†ä¸€åœˆçš„è¯, å›åˆ°åŸä½ç½®,. é¡ºæ—¶é’ˆåŠ æ³•ä¹Ÿæ˜¯ä¸€æ ·çš„åŸç†, <strong>0 + 256 = 0</strong>;</p><p>çŸ¥é“äº†è¿™ä¸€ç‚¹, é‚£ä¹ˆè¿™é“é¢˜å°±å¾ˆå®¹æ˜“äº†.è¦ä½¿ v4 == 0, é‚£ä¹ˆç›¸å½“äº v4é€†æ—¶é’ˆæ—‹è½¬ä¸€åœˆå°‘a2çš„è·ç¦», ç›¸å½“äº v4 += a2,</p><p>é‚£ä¹ˆåŒæ ·çš„é“ç†, â€“*a ç»è¿‡å¾ªç¯å, ç›¸å½“äºé€†æ—¶é’ˆæ—‹è½¬ä¸€åœˆå°‘a2çš„è·ç¦», å°±æ˜¯ *a1 += a2; è¡¥ç çœŸçš„ç¥å¥‡.ğŸ˜</p><p><img src="/2020/04/09/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(1)/image-20200417133116275-1590549174848.png" alt="image-20200417133116275"></p><p>åé¢çš„2ä¸ªå‡½æ•°åŒç†åˆ†æ.  å°†è¯¥ä¸‰ä¸ªå‡½æ•°åˆ†åˆ«æ”¹å†™æˆå¯¹åº”çš„ä¹˜, å‡, åŠ :</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> *<span class="title">sub_401100</span><span class="params">(<span class="keyword">int</span> *a, <span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">*a = (*a) * b;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span>  a; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> *<span class="title">sub_401220</span><span class="params">(<span class="keyword">int</span> *a, <span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">*a = (*a) - b;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> *<span class="title">sub_401000</span><span class="params">(<span class="keyword">int</span> *a, <span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">*a = (*a) + b; </span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> *v3; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v4;</span><br><span class="line">  <span class="keyword">int</span> *v5; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v6; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v7; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v8; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v9; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v10; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v11; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v12; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v13; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v14; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v15; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v16; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v17; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v18; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v19; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v20; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v21; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v22; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v23; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v24; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v25; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v26; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v27; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v28; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v29; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v30; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v31; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v32; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v33; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v34; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v35; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v36; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v37; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v38; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v39; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v40; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v41; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v42; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v43; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v44; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v45; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v46; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v47; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v48; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v49; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v50; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v51; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v52; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v53; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v54; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v55; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v56; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v57; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v58; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v59; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v60; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v61; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v62; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v63; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v64; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v65; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v66; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v67; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v68; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v69; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v70; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v71; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v72; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v73; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v74; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v75; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v76; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v77; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v78; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v79; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v80; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v81; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v82; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v83; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v84; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v85; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v86; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v87; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v88; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v89; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v90; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v91; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v92; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v93; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v94; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v95; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v96; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v97; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v98; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v99; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v100; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v101; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v102; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v103; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v104; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v105; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v106; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v107; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v108; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v109; <span class="comment">// ST1C_4</span></span><br><span class="line">  <span class="keyword">int</span> *v110; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v111; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v112; <span class="comment">// ST20_4</span></span><br><span class="line">  <span class="keyword">int</span> *v113; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v114; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v115; <span class="comment">// ST20_4</span></span><br><span class="line">  <span class="keyword">int</span> *v116; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> i; <span class="comment">// [esp+4h] [ebp-90h]</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> j; <span class="comment">// [esp+8h] [ebp-8Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v120[<span class="number">32</span>]; <span class="comment">// [esp+Ch] [ebp-88h]</span></span><br><span class="line">  <span class="keyword">int</span> v121; <span class="comment">// [esp+8Ch] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">32</span>; ++i )</span><br><span class="line">    v120[i] = <span class="number">1</span>;</span><br><span class="line">  v121 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Your flag is:"</span>);</span><br><span class="line">  v3 = sub_401100(v120, <span class="number">1000000000</span>);</span><br><span class="line">  v4 = sub_401220(v3, <span class="number">999999950</span>);</span><br><span class="line">  sub_401100(v4, <span class="number">2</span>);</span><br><span class="line">  v5 = sub_401000(&amp;v120[<span class="number">1</span>], <span class="number">5000000</span>);</span><br><span class="line">  v6 = sub_401220(v5, <span class="number">6666666</span>);</span><br><span class="line">  v7 = sub_401000(v6, <span class="number">1666666</span>);</span><br><span class="line">  v8 = sub_401000(v7, <span class="number">45</span>);</span><br><span class="line">  v9 = sub_401100(v8, <span class="number">2</span>);</span><br><span class="line">  sub_401000(v9, <span class="number">5</span>);</span><br><span class="line">  v10 = sub_401100(&amp;v120[<span class="number">2</span>], <span class="number">1000000000</span>);</span><br><span class="line">  v11 = sub_401220(v10, <span class="number">999999950</span>);</span><br><span class="line">  v12 = sub_401100(v11, <span class="number">2</span>);</span><br><span class="line">  sub_401000(v12, <span class="number">2</span>);</span><br><span class="line">  v13 = sub_401000(&amp;v120[<span class="number">3</span>], <span class="number">55</span>);</span><br><span class="line">  v14 = sub_401220(v13, <span class="number">3</span>);</span><br><span class="line">  v15 = sub_401000(v14, <span class="number">4</span>);</span><br><span class="line">  sub_401220(v15, <span class="number">1</span>);</span><br><span class="line">  v16 = sub_401100(&amp;v120[<span class="number">4</span>], <span class="number">100000000</span>);</span><br><span class="line">  v17 = sub_401220(v16, <span class="number">99999950</span>);</span><br><span class="line">  v18 = sub_401100(v17, <span class="number">2</span>);</span><br><span class="line">  sub_401000(v18, <span class="number">2</span>);</span><br><span class="line">  v19 = sub_401220(&amp;v120[<span class="number">5</span>], <span class="number">1</span>);</span><br><span class="line">  v20 = sub_401100(v19, <span class="number">1000000000</span>);</span><br><span class="line">  v21 = sub_401000(v20, <span class="number">55</span>);</span><br><span class="line">  sub_401220(v21, <span class="number">3</span>);</span><br><span class="line">  v22 = sub_401100(&amp;v120[<span class="number">6</span>], <span class="number">1000000</span>);</span><br><span class="line">  v23 = sub_401220(v22, <span class="number">999975</span>);</span><br><span class="line">  sub_401100(v23, <span class="number">4</span>);</span><br><span class="line">  v24 = sub_401000(&amp;v120[<span class="number">7</span>], <span class="number">55</span>);</span><br><span class="line">  v25 = sub_401220(v24, <span class="number">33</span>);</span><br><span class="line">  v26 = sub_401000(v25, <span class="number">44</span>);</span><br><span class="line">  sub_401220(v26, <span class="number">11</span>);</span><br><span class="line">  v27 = sub_401100(&amp;v120[<span class="number">8</span>], <span class="number">10</span>);</span><br><span class="line">  v28 = sub_401220(v27, <span class="number">5</span>);</span><br><span class="line">  v29 = sub_401100(v28, <span class="number">8</span>);</span><br><span class="line">  sub_401000(v29, <span class="number">9</span>);</span><br><span class="line">  v30 = sub_401000(&amp;v120[<span class="number">9</span>], <span class="number">0</span>);</span><br><span class="line">  v31 = sub_401220(v30, <span class="number">0</span>);</span><br><span class="line">  v32 = sub_401000(v31, <span class="number">11</span>);</span><br><span class="line">  v33 = sub_401220(v32, <span class="number">11</span>);</span><br><span class="line">  sub_401000(v33, <span class="number">53</span>);</span><br><span class="line">  v34 = sub_401000(&amp;v120[<span class="number">10</span>], <span class="number">49</span>);</span><br><span class="line">  v35 = sub_401220(v34, <span class="number">2</span>);</span><br><span class="line">  v36 = sub_401000(v35, <span class="number">4</span>);</span><br><span class="line">  sub_401220(v36, <span class="number">2</span>);</span><br><span class="line">  v37 = sub_401100(&amp;v120[<span class="number">11</span>], <span class="number">1000000</span>);</span><br><span class="line">  v38 = sub_401220(v37, <span class="number">999999</span>);</span><br><span class="line">  v39 = sub_401100(v38, <span class="number">4</span>);</span><br><span class="line">  sub_401000(v39, <span class="number">50</span>);</span><br><span class="line">  v40 = sub_401000(&amp;v120[<span class="number">12</span>], <span class="number">1</span>);</span><br><span class="line">  v41 = sub_401000(v40, <span class="number">1</span>);</span><br><span class="line">  v42 = sub_401000(v41, <span class="number">1</span>);</span><br><span class="line">  v43 = sub_401000(v42, <span class="number">1</span>);</span><br><span class="line">  v44 = sub_401000(v43, <span class="number">1</span>);</span><br><span class="line">  v45 = sub_401000(v44, <span class="number">1</span>);</span><br><span class="line">  v46 = sub_401000(v45, <span class="number">10</span>);</span><br><span class="line">  sub_401000(v46, <span class="number">32</span>);</span><br><span class="line">  v47 = sub_401100(&amp;v120[<span class="number">13</span>], <span class="number">10</span>);</span><br><span class="line">  v48 = sub_401220(v47, <span class="number">5</span>);</span><br><span class="line">  v49 = sub_401100(v48, <span class="number">8</span>);</span><br><span class="line">  v50 = sub_401000(v49, <span class="number">9</span>);</span><br><span class="line">  sub_401000(v50, <span class="number">48</span>);</span><br><span class="line">  v51 = sub_401220(&amp;v120[<span class="number">14</span>], <span class="number">1</span>);</span><br><span class="line">  v52 = sub_401100(v51, <span class="number">-294967296</span>);</span><br><span class="line">  v53 = sub_401000(v52, <span class="number">55</span>);</span><br><span class="line">  sub_401220(v53, <span class="number">3</span>);</span><br><span class="line">  v54 = sub_401000(&amp;v120[<span class="number">15</span>], <span class="number">1</span>);</span><br><span class="line">  v55 = sub_401000(v54, <span class="number">2</span>);</span><br><span class="line">  v56 = sub_401000(v55, <span class="number">3</span>);</span><br><span class="line">  v57 = sub_401000(v56, <span class="number">4</span>);</span><br><span class="line">  v58 = sub_401000(v57, <span class="number">5</span>);</span><br><span class="line">  v59 = sub_401000(v58, <span class="number">6</span>);</span><br><span class="line">  v60 = sub_401000(v59, <span class="number">7</span>);</span><br><span class="line">  sub_401000(v60, <span class="number">20</span>);</span><br><span class="line">  v61 = sub_401100(&amp;v120[<span class="number">16</span>], <span class="number">10</span>);</span><br><span class="line">  v62 = sub_401220(v61, <span class="number">5</span>);</span><br><span class="line">  v63 = sub_401100(v62, <span class="number">8</span>);</span><br><span class="line">  v64 = sub_401000(v63, <span class="number">9</span>);</span><br><span class="line">  sub_401000(v64, <span class="number">48</span>);</span><br><span class="line">  v65 = sub_401000(&amp;v120[<span class="number">17</span>], <span class="number">7</span>);</span><br><span class="line">  v66 = sub_401000(v65, <span class="number">6</span>);</span><br><span class="line">  v67 = sub_401000(v66, <span class="number">5</span>);</span><br><span class="line">  v68 = sub_401000(v67, <span class="number">4</span>);</span><br><span class="line">  v69 = sub_401000(v68, <span class="number">3</span>);</span><br><span class="line">  v70 = sub_401000(v69, <span class="number">2</span>);</span><br><span class="line">  v71 = sub_401000(v70, <span class="number">1</span>);</span><br><span class="line">  sub_401000(v71, <span class="number">20</span>);</span><br><span class="line">  v72 = sub_401000(&amp;v120[<span class="number">18</span>], <span class="number">7</span>);</span><br><span class="line">  v73 = sub_401000(v72, <span class="number">2</span>);</span><br><span class="line">  v74 = sub_401000(v73, <span class="number">4</span>);</span><br><span class="line">  v75 = sub_401000(v74, <span class="number">3</span>);</span><br><span class="line">  v76 = sub_401000(v75, <span class="number">6</span>);</span><br><span class="line">  v77 = sub_401000(v76, <span class="number">5</span>);</span><br><span class="line">  v78 = sub_401000(v77, <span class="number">1</span>);</span><br><span class="line">  sub_401000(v78, <span class="number">20</span>);</span><br><span class="line">  v79 = sub_401100(&amp;v120[<span class="number">19</span>], <span class="number">1000000</span>);</span><br><span class="line">  v80 = sub_401220(v79, <span class="number">999999</span>);</span><br><span class="line">  v81 = sub_401100(v80, <span class="number">4</span>);</span><br><span class="line">  v82 = sub_401000(v81, <span class="number">50</span>);</span><br><span class="line">  sub_401220(v82, <span class="number">1</span>);</span><br><span class="line">  v83 = sub_401220(&amp;v120[<span class="number">20</span>], <span class="number">1</span>);</span><br><span class="line">  v84 = sub_401100(v83, <span class="number">-294967296</span>);</span><br><span class="line">  v85 = sub_401000(v84, <span class="number">49</span>);</span><br><span class="line">  sub_401220(v85, <span class="number">1</span>);</span><br><span class="line">  v86 = sub_401220(&amp;v120[<span class="number">21</span>], <span class="number">1</span>);</span><br><span class="line">  v87 = sub_401100(v86, <span class="number">1000000000</span>);</span><br><span class="line">  v88 = sub_401000(v87, <span class="number">54</span>);</span><br><span class="line">  v89 = sub_401220(v88, <span class="number">1</span>);</span><br><span class="line">  v90 = sub_401000(v89, <span class="number">1000000000</span>);</span><br><span class="line">  sub_401220(v90, <span class="number">1000000000</span>);</span><br><span class="line">  v91 = sub_401000(&amp;v120[<span class="number">22</span>], <span class="number">49</span>);</span><br><span class="line">  v92 = sub_401220(v91, <span class="number">1</span>);</span><br><span class="line">  v93 = sub_401000(v92, <span class="number">2</span>);</span><br><span class="line">  sub_401220(v93, <span class="number">1</span>);</span><br><span class="line">  v94 = sub_401100(&amp;v120[<span class="number">23</span>], <span class="number">10</span>);</span><br><span class="line">  v95 = sub_401220(v94, <span class="number">5</span>);</span><br><span class="line">  v96 = sub_401100(v95, <span class="number">8</span>);</span><br><span class="line">  v97 = sub_401000(v96, <span class="number">9</span>);</span><br><span class="line">  sub_401000(v97, <span class="number">48</span>);</span><br><span class="line">  v98 = sub_401000(&amp;v120[<span class="number">24</span>], <span class="number">1</span>);</span><br><span class="line">  v99 = sub_401000(v98, <span class="number">3</span>);</span><br><span class="line">  v100 = sub_401000(v99, <span class="number">3</span>);</span><br><span class="line">  v101 = sub_401000(v100, <span class="number">3</span>);</span><br><span class="line">  v102 = sub_401000(v101, <span class="number">6</span>);</span><br><span class="line">  v103 = sub_401000(v102, <span class="number">6</span>);</span><br><span class="line">  v104 = sub_401000(v103, <span class="number">6</span>);</span><br><span class="line">  sub_401000(v104, <span class="number">20</span>);</span><br><span class="line">  v105 = sub_401000(&amp;v120[<span class="number">25</span>], <span class="number">55</span>);</span><br><span class="line">  v106 = sub_401220(v105, <span class="number">33</span>);</span><br><span class="line">  v107 = sub_401000(v106, <span class="number">44</span>);</span><br><span class="line">  v108 = sub_401220(v107, <span class="number">11</span>);</span><br><span class="line">  sub_401000(v108, <span class="number">42</span>);</span><br><span class="line">  sub_401000(&amp;v120[<span class="number">26</span>], v120[<span class="number">25</span>]);</span><br><span class="line">  sub_401000(&amp;v120[<span class="number">27</span>], v120[<span class="number">12</span>]);</span><br><span class="line">  v109 = v120[<span class="number">27</span>];</span><br><span class="line">  v110 = sub_401220(&amp;v120[<span class="number">28</span>], <span class="number">1</span>);</span><br><span class="line">  v111 = sub_401000(v110, v109);</span><br><span class="line">  sub_401220(v111, <span class="number">1</span>);</span><br><span class="line">  v112 = v120[<span class="number">23</span>];</span><br><span class="line">  v113 = sub_401220(&amp;v120[<span class="number">29</span>], <span class="number">1</span>);</span><br><span class="line">  v114 = sub_401100(v113, <span class="number">1000000</span>);</span><br><span class="line">  sub_401000(v114, v112);</span><br><span class="line">  v115 = v120[<span class="number">27</span>];</span><br><span class="line">  v116 = sub_401000(&amp;v120[<span class="number">30</span>], <span class="number">1</span>);</span><br><span class="line">  sub_401100(v116, v115);</span><br><span class="line">  sub_401000(&amp;v120[<span class="number">31</span>], v120[<span class="number">30</span>]);</span><br><span class="line">  </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"CTF&#123;"</span>);</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">32</span>; ++j )</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%c"</span>, (v120[j]));</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"&#125;\n"</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h3 id="reverse-for-the-holy-grail-350"><a href="#reverse-for-the-holy-grail-350" class="headerlink" title="reverse-for-the-holy-grail-350"></a>reverse-for-the-holy-grail-350</h3><p>åˆæ˜¯C++çš„é¢˜, å¯¹äºåˆå­¦, æˆ‘çœ‹è¿™ä¸ªæœ‰äº›è¿˜æ˜¯å¾ˆåƒåŠ›çš„, æœ‰äº›å‡½æ•°åŠŸèƒ½è¿è’™å¸¦çŒœ. å…¶å®é™ä¸‹å¿ƒæ¥åˆ†æ, é€»è¾‘è¿˜æ˜¯å¾ˆç®€å•.</p><p><img src="/2020/04/09/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(1)/image-20200421172942651-1590549186380.png" alt="image-20200421172942651"></p><p>æ‰¾åˆ°å…³é”®å‡½æ•°è¿›å»å, çœ‹èµ·æ¥å¾ˆå¤š, ä½†é€»è¾‘ä¹Ÿæ˜¯ä¸éš¾çš„. </p><p><img src="/2020/04/09/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(1)/image-20200421173112461-1590549193146.png" alt="image-20200421173112461"></p><p>è¿™æ˜¯ç¨‹åºçš„ç®—æ³•, æˆ‘æŒ¨ä¸ªè®°å½•äº†ä¸‹æ¥â€¦â€¦..æˆ‘åœ¨åˆ°è¿™æ­¥çš„æ—¶å€™, å°±æ˜¯åœ¨çº ç»“é‚£ä¸ªå–ä½™å¤šè§£çš„é—®é¢˜, æƒ³åˆ°ç®—èµ·æ¥å¾ˆçƒ¦, ä½†ç”±äºæ˜¯å¯è¾“å…¥çš„å­—ç¬¦, æˆ‘ä»¬ç”¨éå†å³å¯ (0-127)</p><p><img src="/2020/04/09/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(1)/image-20200421173211318-1590549201703.png" alt="image-20200421173211318"></p><p>æœ€åé™„ä¸Š,  ä»£ç :</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> first[] = &#123;<span class="number">0x41</span>, <span class="number">0x69</span>, <span class="number">0x6e</span>, <span class="number">0x45</span>, <span class="number">0x6f</span>, <span class="number">0x61</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> second[] = &#123;<span class="number">0x2ef</span>, <span class="number">0x2c4</span>, <span class="number">0x2dc</span>, <span class="number">0x2c7</span>, <span class="number">0x2de</span>, <span class="number">0x2fc</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> third[] = &#123;<span class="number">0x1d7</span>, <span class="number">0xc</span>, <span class="number">0x244</span>, <span class="number">0x25e</span>, <span class="number">0x93</span>, <span class="number">0x6c</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> mod[<span class="number">18</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, n = <span class="number">666</span>, j = <span class="number">0</span>, z = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> flag[<span class="number">20</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">18</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">mod[i] = n;</span><br><span class="line">n += n%<span class="number">5</span>; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">18</span>; i += <span class="number">3</span>)</span><br><span class="line">&#123;</span><br><span class="line">flag[i] = first[j];</span><br><span class="line"></span><br><span class="line">flag[i+<span class="number">2</span>] = second[j] ^ mod[i+<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(z = <span class="number">0</span>; z &lt; <span class="number">127</span>; z++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>((flag[i] ^ mod[i])*(z^mod[i+<span class="number">1</span>]) % second[j] == third[j])</span><br><span class="line">&#123;</span><br><span class="line">flag[i+<span class="number">1</span>] = z;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">j++;</span><br><span class="line"> </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">18</span>; i++)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%c"</span>, flag[i]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ€»ç»“: ç¨‹åºä¸­æ³¨æ„çœ‹æ¸…ä¼ å…¥å‚æ•°æ—¶,æ˜¯ä¸€ä¸ªå­—èŠ‚, è¿˜æ˜¯ä¸€ä¸ªintç±»å‹(4ä¸ªå­—èŠ‚); å–ä½™è¿ç®—, é€†å‘æ—¶, ä¸€èˆ¬éå†å³å¯.</p><hr><h3 id="elrond32"><a href="#elrond32" class="headerlink" title="elrond32"></a>elrond32</h3><p>é¦–å…ˆ, ä¸‹è½½ä¸‹æ¥, ç”¨idaæ‰“å¼€, å‘ç°æ²¡æœ‰è¾“å…¥çš„åœ°æ–¹. æˆ–è®¸æ˜¯éšè—èµ·æ¥äº†. å°±åœ¨linuxä¸­è¿è¡Œä¸€ä¸‹æ¥çœ‹, æœç„¶æ²¡æœ‰è¾“å…¥, åªæ˜¯è¾“å‡ºéªŒè¯å¤±è´¥.</p><p>å›åˆ°ida, é€»è¾‘ä¹Ÿå¾ˆæ¸…æ¥š, å°±æ˜¯ä¸€ä¸ªå‡½æ•°çš„è¿”å›å€¼ é0 å³å¯, è¿›å…¥å…³é”®å‡½æ•°: ä¹Ÿå¾ˆç®€å•, å°±æ˜¯ä¸€ä¸ªé€’å½’è°ƒç”¨. ä»0å¼€å§‹, æ¯æ¬¡ (a1) éƒ½ç¬¦åˆç›¸åº”çš„å€¼ä¸”æœ€è¦æœ€åçš„è·³å‡ºé€’å½’å³å¯.é€šè¿‡è¿™ä¸ªæˆ‘ä»¬å°±çŸ¥é“äº† a1æ•°ç»„çš„å€¼.  ç®—äº†ä¸€ä¸‹ a2çš„å€¼ä¸º: 0 7 1 3 6 5 9 4 2, è€Œ2æ²¡æœ‰å°±è·³å‡º. æŒ‰ç…§è¿™ä¸ªé¡ºåºå– (a1) .</p><p><img src="/2020/04/09/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C(1)/image-20200421190646720-1590549218465.png" alt="image-20200421190646720"></p><p>å…¶å®æµè§ˆç¨‹åºçš„æ—¶å€™, å·²ç»çœ‹è¿‡ éªŒè¯é€šè¿‡ä¸‹é¢çš„ä¸€ä¸ªå‡½æ•°, å°±æ˜¯è®©33ä¸ªå·²ç»ç¼–ç äº†çš„å­—ç¬¦ä¸æˆ‘ä»¬å¾—åˆ°çš„ (a1)å¼‚æˆ–è¿ç®—, å†æ‰“å°å‡ºflag. ä¸‹é¢Cä»£ç :</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> a[] = &#123;<span class="number">105</span>, <span class="number">115</span>, <span class="number">101</span>, <span class="number">110</span>, <span class="number">103</span>, <span class="number">97</span>, <span class="number">114</span>, <span class="number">100</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">union</span></span><br><span class="line">&#123;<span class="keyword">char</span> b[<span class="number">1000</span>];</span><br><span class="line"><span class="keyword">int</span> n[<span class="number">33</span>];</span><br><span class="line">&#125;A = &#123;</span><br><span class="line">   <span class="number">15</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">31</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">4</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">9</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">28</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">18</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">66</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">9</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">12</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">68</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">13</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">7</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">9</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">6</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">45</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">55</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">89</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">30</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">89</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">15</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">8</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">28</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">35</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">54</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">7</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">85</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">2</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">12</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">8</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">65</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">10</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">20</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> flag[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt;= <span class="number">32</span>; i++)</span><br><span class="line"><span class="built_in">putchar</span>(A.n[i] ^ a[i % <span class="number">8</span>]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;misc&quot;&gt;&lt;a href=&quot;#misc&quot; class=&quot;headerlink&quot; title=&quot;misc:&quot;&gt;&lt;/a&gt;misc:&lt;/h3&gt;&lt;p&gt;èœç‹—æˆªè·äº†ä¸€ä»½æŠ¥æ–‡å¦‚ä¸‹&lt;/p&gt;
&lt;p&gt;ä»æŠ¥æ–‡ä¸­å¯ä»¥è”æƒ³åˆ°æ˜¯md5åŠ å¯†, ä½†è¯•äº†ä¸€ä¸‹, å‘ç°ä¸å¯¹. å†çœ‹æŠ¥æ–‡ä¸­å­—æ¯åªæ˜¯ a-f , æ‰€ä»¥å¯èƒ½æ˜¯åå…­è¿›åˆ¶æ•°, åˆä¸€èˆ¬éƒ½æ˜¯ä¸€ä¸ªå­—èŠ‚ä¸€ä¸ªå­—ç¬¦, è€Œä¸€ä¸ªå­—èŠ‚å­˜æ”¾äºŒä¸ªåå…­è¿›åˆ¶æ•°. æˆ‘ä»¬å°±2ä¸ªä¸€ç»„è½¬æ¢æˆåè¿›åˆ¶, ä½†æ˜¯å¤§äºäº†127, å¯æ‰“å°å­—ç¬¦ASCIIèŒƒå›´åœ¨&lt;strong&gt;0-127&lt;/strong&gt;,  é‚£æˆ‘ä»¬çŸ¥é“ &lt;code&gt;}&lt;/code&gt;å­—ç¬¦çš„ASCIIåå…­è¿›åˆ¶ä¸º &lt;strong&gt;0X7D&lt;/strong&gt;,  å†çœ‹æŠ¥æ–‡æœ€å2ä¸ªå­—ç¬¦ç»„æˆçš„åå…­è¿›åˆ¶æ•° &lt;strong&gt;0xf2&lt;/strong&gt;, ä¸€èˆ¬æˆ‘ä»¬å¯ä»¥æœ‰è¿™ä¸ªæ€è·¯,æ±‚å·®å€¼ ä½†ä¹Ÿæœ‰æœ€åæ²¡æœ‰ç”¨ &lt;strong&gt;}&lt;/strong&gt;ç»“å°¾çš„, è¿™é‡Œå°±ä¸æ˜¯.ğŸ˜‚. ä½†å…¶å®æƒ³åˆ°è¦æŠŠå­—ç¬¦æ‰“å°å‡ºæ¥, è€Œå­—ç¬¦ASCII&lt;strong&gt;0-127&lt;/strong&gt;, é‚£å°±ç›´æ¥è¯•ä¸€è¯•å‡128, ä¸€ä¸‹å­å°±å¯¹äº†, å“ˆå“ˆğŸ˜.&lt;/p&gt;
    
    </summary>
    
    
      <category term="æ”»é˜²ä¸–ç•Œ" scheme="https://hus96r.coding-pages.com/categories/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/"/>
    
    
      <category term="CTF" scheme="https://hus96r.coding-pages.com/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>leetcode</title>
    <link href="https://hus96r.coding-pages.com/2020/03/14/leetcode/"/>
    <id>https://hus96r.coding-pages.com/2020/03/14/leetcode/</id>
    <published>2020-03-14T05:58:53.000Z</published>
    <updated>2020-05-27T03:39:37.020Z</updated>
    
    <content type="html"><![CDATA[<h3 id="æ‘©å°”æŠ•ç¥¨"><a href="#æ‘©å°”æŠ•ç¥¨" class="headerlink" title="æ‘©å°”æŠ•ç¥¨"></a>æ‘©å°”æŠ•ç¥¨</h3><p>ä¸ªäººæ€»ç»“:</p><p>åœ¨ä¸€ç¾¤ä»¥å°é˜Ÿä¸ºç»„çš„æˆ˜äº‰ä¸­, 2ä¸ªé‡åˆ°è‹¥ä¸æ˜¯åŒé˜Ÿçš„å°±åŒæ–¹é˜µäº¡, è‹¥2ä¸ªäººæ˜¯åŒé˜Ÿçš„å°±ç»“åˆèµ·æ¥.è¿™æ ·ä¸€ç›´ä¸‹å», æœ€åç•™ä¸‹æ¥çš„äºº, å°†æ˜¯è¿™åœºæˆ˜äº‰ä¸­æœ€å¤šçš„äººçš„å°é˜Ÿçš„.è¯¥ç®—æ³•å¯ä»¥è§£å†³ è®¡ç®—ä¸€ä¸ªæ•°ç»„ä¸­å‡ºç°æ¬¡æ•°æœ€å¤šçš„å…ƒç´ . ( ä»ç¬¬ä¸€ä¸ªæ•°å¼€å§‹count=1ï¼Œé‡åˆ°ç›¸åŒçš„å°±åŠ 1ï¼Œé‡åˆ°ä¸åŒçš„å°±å‡1ï¼Œå‡åˆ°0å°±é‡æ–°æ¢ä¸ªæ•°å¼€å§‹è®¡æ•°ï¼Œæ€»èƒ½æ‰¾åˆ°æœ€å¤šçš„é‚£ä¸ª )<a id="more"></a></p><p><img src="/2020/03/14/leetcode/image-20200314141207184-1590548390775.png" alt="image-20200314141207184"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">majorityElement</span><span class="params">(<span class="keyword">int</span>* nums, <span class="keyword">int</span> numsSize)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> count = <span class="number">0</span>, ans = <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; numsSize; i++)</span><br><span class="line">  &#123;</span><br><span class="line">â€‹    <span class="keyword">if</span>(nums[ans] == nums[i])</span><br><span class="line">â€‹      count++;</span><br><span class="line">â€‹    <span class="keyword">else</span></span><br><span class="line">â€‹      count--;</span><br><span class="line">      </span><br><span class="line">â€‹    <span class="keyword">if</span>(count == <span class="number">0</span>)</span><br><span class="line">â€‹      ans = i+<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">â€‹    <span class="keyword">if</span>(count &gt; numsSize/<span class="number">2</span>)</span><br><span class="line">â€‹      <span class="keyword">break</span>; </span><br><span class="line">  &#125;</span><br><span class="line">    </span><br><span class="line">  <span class="keyword">return</span> nums[ans];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="åŠ¨æ€è§„åˆ’"><a href="#åŠ¨æ€è§„åˆ’" class="headerlink" title="åŠ¨æ€è§„åˆ’"></a>åŠ¨æ€è§„åˆ’</h3><p>å°†ä¸€ä¸ªé—®é¢˜, åˆ†æˆè‹¥å¹²ä¸ªçš„å­é—®é¢˜è§£å†³ </p><pre><code>dp[i]è¡¨ç¤ºnums[0]åˆ°nums[i]ï¼Œå«nums[i]çš„æœ€é•¿ä¸Šå‡å­åºåˆ—ï¼›å¦‚æœnums[j] &lt; nums[i],å°±dp[i]=max(dp[i],dp[j]+1)æ¯æ¬¡ä¿å­˜æœ€å¤§é•¿åº¦res=max(res,dp[i]) ////å› ä¸ºæœ€åä¸€ä¸ªå…ƒç´ nums[n],ä¸ä¸€å®šåœ¨æœ€é•¿å­åºåˆ—ä¸­å¦‚[10,9,2,5,3,7,101,6][10,9,2,5,3,7,101,6],dp[0]=1[10,9,2,5,3,7,101,6],dp[1]=1[10,9,2,5,3,7,101,6],dp[2]=1[10,9,2,5,3,7,101,6],dp[3]=dp[2]+1 //res=2[10,9,2,5,3,7,101,6],dp[4]=dp[2]+1 //res=2[10,9,2,5,3,7,101,6],dp[5]=dp[3]+1 //res=3[10,9,2,5,3,7,101,6],dp[6]=dp[5]+1 //res=4[10,9,2,5,3,7,101,6],dp[7]=dp[4]+1 //res=4</code></pre><p><img src="/2020/03/14/leetcode/image-20200314142330565-1590548403309.png" alt="image-20200314142330565"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lengthOfLIS</span><span class="params">(<span class="keyword">int</span>* nums, <span class="keyword">int</span> numsSize)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(numsSize == <span class="number">0</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">  <span class="keyword">int</span> <span class="built_in">max</span> = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">int</span> dp[numsSize];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; numsSize; i++)</span><br><span class="line">  &#123;</span><br><span class="line">â€‹    dp[i] = <span class="number">1</span>;</span><br><span class="line">    </span><br><span class="line">â€‹    <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; i; j++) </span><br><span class="line">â€‹    <span class="keyword">if</span>(nums[i] &gt; nums[j])</span><br><span class="line">â€‹    dp[i] = dp[i] &gt; dp[j]+<span class="number">1</span> ? dp[i]:dp[j]+<span class="number">1</span>;</span><br><span class="line">      </span><br><span class="line">â€‹    <span class="keyword">if</span>(dp[i] &gt; <span class="built_in">max</span>)</span><br><span class="line">â€‹    <span class="built_in">max</span> = dp[i];</span><br><span class="line">  &#125; </span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">max</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ—‹è½¬çŸ©é˜µ"><a href="#æ—‹è½¬çŸ©é˜µ" class="headerlink" title="æ—‹è½¬çŸ©é˜µ"></a>æ—‹è½¬çŸ©é˜µ</h3><p>å¯¹äºçŸ©é˜µä¸­æ¯ä¸€è¡Œéƒ½æ—‹è½¬90Â°, åœ¨ä¸å ç”¨é¢å¤–ç©ºé—´æƒ…å†µä¸‹. å¯ä»¥å…ˆæŠŠæ•´ä¸ªçŸ©é˜µè½¬ç½®ä¸€ä¸‹, å†å·¦å³çš„2çš„æ•°äº¤æ¢ä¸€ä¸‹ä½ç½®å³å®ç°.</p><p><img src="/2020/03/14/leetcode/image-20200425195006467-1590548409622.png" alt="image-20200425195006467"></p><p>é¢˜è§£:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rotate</span><span class="params">(<span class="keyword">int</span>** matrix, <span class="keyword">int</span> matrixSize, <span class="keyword">int</span>* matrixColSize)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; matrixSize; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = i+<span class="number">1</span>; j &lt; *matrixColSize; j++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> temp = matrix[i][j];</span><br><span class="line">matrix[i][j] = matrix[j][i];</span><br><span class="line">matrix[j][i] = temp;</span><br><span class="line">&#125; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> mid = matrixSize &gt;&gt; <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; matrixSize; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; mid; j++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> temp = matrix[i][j];</span><br><span class="line">matrix[i][j] = matrix[i][matrixSize-j<span class="number">-1</span>];</span><br><span class="line">matrix[i][matrixSize-j<span class="number">-1</span>] = temp;</span><br><span class="line">&#125; </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h3 id="åˆ†å‰²å­—ç¬¦ä¸²"><a href="#åˆ†å‰²å­—ç¬¦ä¸²" class="headerlink" title="åˆ†å‰²å­—ç¬¦ä¸²"></a>åˆ†å‰²å­—ç¬¦ä¸²</h3><p><strong>ä¸€é“é¢˜ä¸éš¾çš„é¢˜, ä½†æ˜¯è§‰å¾—æ€æƒ³åº”è¯¥è®°ä¸€ä¸‹.</strong></p><p><img src="/2020/03/14/leetcode/image-20200426184623169-1590548415836.png" alt="image-20200426184623169"></p><p>ç¬¬ä¸€ä¸ªæ€è·¯æ˜¯: åªç®¡å·¦è¾¹, ç»Ÿè®¡å·¦è¾¹0å’Œ1å‡ºç°çš„æ¬¡æ•°, åªè¦ä»å·¦åˆ°å³å¾ªç¯, 0å‡ºç°çš„æ¬¡æ•°ä¸1å‡ºç°çš„æ¬¡æ•°ä¹‹å·®æ¯”ç¬¬ä¸€ä¸ªæ¯”å¼€å§‹å¤§, é‚£ä¹ˆæˆ‘ä»¬çš„ç¡®å®šåˆ†å‰²çš„ä½ç½®å°±å¯ä»¥å¾€åç§».å¾ªç¯ä¸€é, æ‰¾åˆ°äº†ä½ç½®, å†åˆ†åˆ«ç›¸åŠ .</p><p><strong>ç¬¬äºŒä¸ªæ€è·¯:</strong> å…ˆæŠŠæ‰€æœ‰çš„ 1 éƒ½ç»Ÿè®¡å‡ºæ¥, å†å·¦å¾€å³å¾ªç¯, åªè¦æ˜¯å­—ç¬¦0å°±åŠ 1, å­—ç¬¦1å°±å‡1.  é™„ä¸Šç¬¬äºŒä¸ªæ€è·¯ä»£ç : Cè¯­è¨€</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">maxScore</span><span class="params">(<span class="keyword">char</span> * s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">0</span>, count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(s); i++)</span><br><span class="line">count += (s[i] == <span class="number">49</span> ? <span class="number">1</span> : <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(s); i++)</span><br><span class="line">&#123;</span><br><span class="line">count += (s[i] == <span class="number">0</span> ? <span class="number">1</span> : <span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line">ans = (ans &gt; count ? ans : count);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>python3</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">maxScore</span><span class="params">(self, s: str)</span> -&gt; int:</span></span><br><span class="line">        count = s.count(<span class="string">'1'</span>)</span><br><span class="line">        ans = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> s[:<span class="number">-1</span>]:</span><br><span class="line">            <span class="keyword">if</span> i == <span class="string">'0'</span>:</span><br><span class="line">                count += <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                count -= <span class="number">1</span></span><br><span class="line">            ans = max(ans, count)</span><br><span class="line">        <span class="keyword">return</span> ans</span><br></pre></td></tr></table></figure><p>æœ€å, åŒç„¶çš„ç®—æ³•, pythonè™½ç„¶æ–¹ä¾¿,ä½†æ˜¯pythonåœ¨æ—¶é—´å’Œç©ºé—´å¤æ‚åº¦ä¸Š, æ¯”Cè¯­è¨€å¤§å¥½å¤š.</p><hr><h3 id="å¼‚æˆ–è¿ç®—"><a href="#å¼‚æˆ–è¿ç®—" class="headerlink" title="å¼‚æˆ–è¿ç®—"></a>å¼‚æˆ–è¿ç®—</h3><blockquote><p><strong>å¼‚æˆ–è¿ç®—çš„è¿ç”¨, å¯¹é€†å‘åˆ†ææœ‰å¸®åŠ©.</strong></p></blockquote><ul><li><p>é¦–å…ˆå¼‚æˆ–è¿ç®—çš„æ€§è´¨æœ‰.</p><table><thead><tr><th>äº¤æ¢å¾‹</th><th>a ^ b  = b ^ a</th></tr></thead><tbody><tr><td><strong>ç»“åˆå¾‹</strong></td><td><strong>(a ^ b) ^ c = a ^ (b ^ c)</strong></td></tr><tr><td><strong>å¯¹äºä»»ä½•æ•°a</strong></td><td><strong>x ^ x = 0,  x ^ 0 = x</strong></td></tr><tr><td><strong>è‡ªåæ€§</strong></td><td><strong>a ^ b = c  -&gt;  c ^ b = a</strong></td></tr></tbody></table></li><li><p>ç¬¬ä¸€ç§é¢˜å‹: (è¦æ±‚æ˜¯ ç©ºé—´å¤æ‚åº¦ 0(1), æ—¶é—´å¤æ‚åº¦ 0(n))</p><p>åœ¨ä¸€ä¸ªæ•°ç»„ <code>nums</code> ä¸­é™¤ä¸€ä¸ªæ•°å­—åªå‡ºç°ä¸€æ¬¡ä¹‹å¤–, å…¶ä»–æ•°å­—éƒ½å‡ºç°äº†2æ¬¡. è¯·æ‰¾å‡ºé‚£ä¸ªåªå‡ºç°ä¸€æ¬¡çš„æ•°å­—.</p><p><strong>æ€è·¯ä¸€: ç”¨æ•°å­¦çš„æ–¹æ³•,  é¦–å…ˆè®©è®©æ•°ç»„ä¸­éé‡å¤çš„æ•°å­—éƒ½ç›¸åŠ åç­‰2<code>(sum(set(nums)))*2</code>, ç„¶åè®©sè¯¥æ•°ç»„æ±‚å’Œ<code>(sum(nums))</code>, 2è€…åªå·®å¾—åˆ°ç­”æ¡ˆ.</strong></p><p><strong>æ€è·¯äºŒ: ç”±å¼‚æˆ–è¿ç®—çš„æ€§è´¨, æˆ‘ä»¬è®©æ‰€æœ‰çš„å…ƒç´ å¼‚æˆ–è¿ç®—, ç»“æœå°±æ˜¯ç­”æ¡ˆ</strong></p></li><li><p>ç¬¬äºŒç§é¢˜å‹, æ˜¯ç¬¬ä¸€ç§çš„å»¶ä¼¸.</p><p><img src="/2020/03/14/leetcode/image-20200428123916375-1590548423589.png" alt="image-20200428123916375"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span>* <span class="title">singleNumbers</span><span class="params">(<span class="keyword">int</span>* nums, <span class="keyword">int</span> numsSize, <span class="keyword">int</span>* returnSize)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> sum = <span class="number">0</span>, flag = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> *ans = (<span class="keyword">int</span> *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">int</span>)*<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">memset</span>(ans, <span class="number">0</span>, <span class="keyword">sizeof</span>(<span class="keyword">int</span>)*<span class="number">2</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; numsSize; i++)</span><br><span class="line">sum ^= nums[i];    /æœ‰ç¬¬ä¸€ä¸ªé¢˜å‹, æˆ‘ä»¬çŸ¥é“æœ€åç»“æœæ˜¯ä¸ç›¸åŒä¸¤ä¸ªæ•°çš„å¼‚æˆ–ç»“æœ.</span><br><span class="line"></span><br><span class="line">flag = (-sum)&amp;sum;  /å–sumçš„æ‰€æœ‰ä½ä¸­ç¬¬ä¸€ä¸ªä¸º<span class="number">1</span>çš„ä½.</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; numsSize; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(flag &amp; nums[i])   /å°†ä¸ç›¸åŒçš„ä¸¤ä¸ªæ•°è¿›è¡Œåˆ†ç»„, ä¾æ®ä¸Šé¢è®¡ç®—çš„flag.</span><br><span class="line">ans[<span class="number">0</span>] ^= nums[i];</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">ans[<span class="number">1</span>] ^= nums[i]; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">    *returnSize = <span class="number">2</span>;</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;æ‘©å°”æŠ•ç¥¨&quot;&gt;&lt;a href=&quot;#æ‘©å°”æŠ•ç¥¨&quot; class=&quot;headerlink&quot; title=&quot;æ‘©å°”æŠ•ç¥¨&quot;&gt;&lt;/a&gt;æ‘©å°”æŠ•ç¥¨&lt;/h3&gt;&lt;p&gt;ä¸ªäººæ€»ç»“:&lt;/p&gt;
&lt;p&gt;åœ¨ä¸€ç¾¤ä»¥å°é˜Ÿä¸ºç»„çš„æˆ˜äº‰ä¸­, 2ä¸ªé‡åˆ°è‹¥ä¸æ˜¯åŒé˜Ÿçš„å°±åŒæ–¹é˜µäº¡, è‹¥2ä¸ªäººæ˜¯åŒé˜Ÿçš„å°±ç»“åˆèµ·æ¥.è¿™æ ·ä¸€ç›´ä¸‹å», æœ€åç•™ä¸‹æ¥çš„äºº, å°†æ˜¯è¿™åœºæˆ˜äº‰ä¸­æœ€å¤šçš„äººçš„å°é˜Ÿçš„.è¯¥ç®—æ³•å¯ä»¥è§£å†³ è®¡ç®—ä¸€ä¸ªæ•°ç»„ä¸­å‡ºç°æ¬¡æ•°æœ€å¤šçš„å…ƒç´ . ( ä»ç¬¬ä¸€ä¸ªæ•°å¼€å§‹count=1ï¼Œé‡åˆ°ç›¸åŒçš„å°±åŠ 1ï¼Œé‡åˆ°ä¸åŒçš„å°±å‡1ï¼Œå‡åˆ°0å°±é‡æ–°æ¢ä¸ªæ•°å¼€å§‹è®¡æ•°ï¼Œæ€»èƒ½æ‰¾åˆ°æœ€å¤šçš„é‚£ä¸ª )&lt;/p&gt;
    
    </summary>
    
    
      <category term="ç®—æ³•" scheme="https://hus96r.coding-pages.com/categories/%E7%AE%97%E6%B3%95/"/>
    
    
  </entry>
  
  <entry>
    <title>å­¦ä¹ æ±‡ç¼–åœ¨ä¸‹è½½dosboxå’Œmasmé‡åˆ°çš„é—®é¢˜</title>
    <link href="https://hus96r.coding-pages.com/2020/02/19/%E5%AD%A6%E4%B9%A0%E6%B1%87%E7%BC%96%E5%9C%A8%E4%B8%8B%E8%BD%BDdosbox%E5%92%8Cmasm%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98/"/>
    <id>https://hus96r.coding-pages.com/2020/02/19/%E5%AD%A6%E4%B9%A0%E6%B1%87%E7%BC%96%E5%9C%A8%E4%B8%8B%E8%BD%BDdosbox%E5%92%8Cmasm%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98/</id>
    <published>2020-02-19T11:00:33.000Z</published>
    <updated>2020-05-27T03:42:36.368Z</updated>
    
    <content type="html"><![CDATA[<p>ç”±äºç°åœ¨çš„è®¡ç®—æœºæ˜¯64ä½, è€Œdebugæ˜¯å½“å¹´åœ¨16ä½çš„è®¡ç®—æœºä¸Šæçš„, åœ¨32ä½è®¡ç®—æœºä¸­, å¾®è½¯è¿˜åœ¨ç³»ç»ŸåŒå¢åŠ äº†debugè¿™ä¸ªå·¥å…·, ä½†æ˜¯åˆ°äº†64ä½, å´æ²¡æœ‰åŠ , æ‰€ä»¥æˆ‘ä»¬è¦è‡ªå·±å»ä¸‹è½½ä¸€ä¸ª dosbox å¼€æºçš„dosæ¨¡æ‹Ÿå™¨, ç„¶åå°†debugåœ¨dosboxä¸­è¿è¡Œ.å½“ç„¶è¿™äº›éƒ½æ˜¯æ²¡é—®é¢˜çš„.é—®é¢˜æ˜¯: <a id="more"></a></p><p>åœ¨ä¸‹è½½masmå, ç”±äºç¬¬ä¸€æ¬¡æ¥è§¦, ç¼–å†™å¥½æºç¨‹åºå, ç”¨æŒ‡ä»¤ masm   xxx.asm .ä½†æ˜¯ä¸€ç›´æŠ¥ A2044çš„é”™è¯¯, å°±ç™¾åº¦, çŸ¥ä¹çš„åˆ°é—®é¢˜, éƒ½è¯´è¾“å…¥çš„æ ¼å¼é”™è¯¯, æˆ–è€…æœ‰éæ³•å­—ç¬¦. ä½†æ˜¯æˆ‘ä¸€ä¸ªä¸€ä¸ªç…§ç€æ‰“çš„ ,ä¸å¯èƒ½å•Š.å°±è¿™æ ·ç—›è‹¦äº†ä¸€æ™šä¸Š, ç¬¬äºŒå¤©èµ·æ¥, è¿˜æ˜¯ä¸çŸ¥é“ä¸ºä»€ä¹ˆ, å°±æŠ±ç€è¯•ä¸€è¯•(å¥”æºƒäº†),æ¢äº†ä¸ªmasmç‰ˆæœ¬, è¿™æ¬¡æˆåŠŸäº†. ä½†æ˜¯åœ¨ç¼–å†™ä¸€ä¸ªæ–°çš„æºç¨‹åº, åˆæ˜¯è¿™ä¸ªé”™è¯¯, å†æ¬¡å´©,()/(ã„’oã„’)/~~,.</p><p>çªç„¶æˆ‘æƒ³åˆ°, ä¼šä¸ä¼šæ˜¯ç¼–ç æ ¼å¼çš„é”™è¯¯å‘¢, (æ¢äº†UTF-8)ä¸€æ¢,æœç„¶æ˜¯!!!!!.</p><p>æ‰€ä»¥åœ¨ä»¥åå†æœ‰ç±»ä¼¼çš„é—®é¢˜, ä¸€å®šè¦æƒ³å…¨é¢å“ªé‡Œæœ‰é”™è¯¯, æ—¢ç„¶ç½‘ä¸Šéƒ½è¯´äº†æ ¼å¼æˆ–è€…éæ³•å­—ç¬¦, é‚£æ€ä¹ˆæ²¡æƒ³åˆ°ç¼–ç é—®é¢˜å‘¢,.</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç”±äºç°åœ¨çš„è®¡ç®—æœºæ˜¯64ä½, è€Œdebugæ˜¯å½“å¹´åœ¨16ä½çš„è®¡ç®—æœºä¸Šæçš„, åœ¨32ä½è®¡ç®—æœºä¸­, å¾®è½¯è¿˜åœ¨ç³»ç»ŸåŒå¢åŠ äº†debugè¿™ä¸ªå·¥å…·, ä½†æ˜¯åˆ°äº†64ä½, å´æ²¡æœ‰åŠ , æ‰€ä»¥æˆ‘ä»¬è¦è‡ªå·±å»ä¸‹è½½ä¸€ä¸ª dosbox å¼€æºçš„dosæ¨¡æ‹Ÿå™¨, ç„¶åå°†debugåœ¨dosboxä¸­è¿è¡Œ.å½“ç„¶è¿™äº›éƒ½æ˜¯æ²¡é—®é¢˜çš„.é—®é¢˜æ˜¯:&lt;/p&gt;
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>PTA</title>
    <link href="https://hus96r.coding-pages.com/2019/11/17/PTA/"/>
    <id>https://hus96r.coding-pages.com/2019/11/17/PTA/</id>
    <published>2019-11-17T12:28:06.000Z</published>
    <updated>2020-05-27T03:39:55.928Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>PTAç»ƒç»ƒæ‰‹,ç»†èŠ‚æ–¹é¢æœ‰æ”¶è·çš„åœ°æ–¹.</p></blockquote><a id="more"></a><h3 id="1-PTAä¸Šæ²¡æœ‰ä¸€ä¸‹æƒ³åˆ°æ–¹æ³•çš„é¢˜"><a href="#1-PTAä¸Šæ²¡æœ‰ä¸€ä¸‹æƒ³åˆ°æ–¹æ³•çš„é¢˜" class="headerlink" title="1.PTAä¸Šæ²¡æœ‰ä¸€ä¸‹æƒ³åˆ°æ–¹æ³•çš„é¢˜."></a>1.PTAä¸Šæ²¡æœ‰ä¸€ä¸‹æƒ³åˆ°æ–¹æ³•çš„é¢˜.</h3><p><img src="/2019/11/17/PTA/image-20200407130405852.png" alt="image-20200407130405852"></p><p>ä¸‹é¢é™„ä¸Šä»£ç :</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> m = <span class="number">0</span>, n = <span class="number">0</span>, hours = <span class="number">0</span>, minute = <span class="number">0</span>, end_time = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;m, &amp;n);</span><br><span class="line"></span><br><span class="line">hours = m/<span class="number">100</span>, minute = m%<span class="number">100</span>;  <span class="comment">//éœ€è¦å­¦ä¹ çš„åœ°æ–¹.</span></span><br><span class="line"></span><br><span class="line">hours += n/<span class="number">60</span>, minute += n-(n/<span class="number">60</span>)*<span class="number">60</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(minute &gt;= <span class="number">60</span>) </span><br><span class="line">hours += <span class="number">1</span>, minute -= <span class="number">60</span>; <span class="comment">//éœ€è¦æ³¨æ„çš„åœ°æ–¹.</span></span><br><span class="line"><span class="keyword">if</span>(minute &lt; <span class="number">0</span>)</span><br><span class="line">hours -=<span class="number">1</span>, minute += <span class="number">60</span>; <span class="comment">//éœ€è¦æ³¨æ„çš„åœ°æ–¹.</span></span><br><span class="line"></span><br><span class="line">end_time = hours*<span class="number">100</span> + minute; </span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d"</span>, end_time);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-PTAä¸­åšä¸€é“é¢˜-æ³¨æ„ç»†èŠ‚å¿ƒå¾—"><a href="#2-PTAä¸­åšä¸€é“é¢˜-æ³¨æ„ç»†èŠ‚å¿ƒå¾—" class="headerlink" title="2.PTAä¸­åšä¸€é“é¢˜, æ³¨æ„ç»†èŠ‚å¿ƒå¾—."></a>2.PTAä¸­åšä¸€é“é¢˜, æ³¨æ„ç»†èŠ‚å¿ƒå¾—.</h3><p><img src="/2019/11/17/PTA/image-20200413132934160.png" alt="image-20200413132934160"></p><p>ä¸‹é¢é™„ä¸Šä»£ç :</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> c = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(b)</span><br><span class="line">&#123;</span><br><span class="line">c = a%b;  <span class="comment">//æ±‚æœ€å¤§å…¬çº¦æ•°ä¸­, è¿™é‡Œæ˜¯  %  ä¸è¦è¯¯å†™ /  ;</span></span><br><span class="line">a = b;</span><br><span class="line">b = c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> N = <span class="number">0</span>, temp = <span class="number">0</span>, g = <span class="number">0</span>, temp_N = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> a = <span class="number">0</span>, b = <span class="number">0</span>, <span class="built_in">min</span> = <span class="number">0</span>, sum_a = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;N);</span><br><span class="line">temp_N = N;  </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(; N; N--)     <span class="comment">//å¼€å§‹è¾“å…¥çš„æ˜¯Nä¸ªæ•°, ä½†æ˜¯è¿™é‡Œå¾ªç¯åå˜æˆäº†0, æ‰€ä»¥åé¢å°±ä¸èƒ½ç›´æ¥ç”¨Näº†, </span></span><br><span class="line">&#123;<span class="comment">//ä½†æ˜¯å†™ç¨‹åºæ—¶æ€»æ˜¯å¿½ç•¥äº†è¿™ç‚¹, åé¢ç›´æ¥ç”¨N, å¯¼è‡´äº†å‡ºé”™è¿˜æ‰¾åŠå¤©.</span></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d/%d"</span>, &amp;a, &amp;b);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">min</span>)</span><br><span class="line">&#123;</span><br><span class="line">temp = <span class="built_in">min</span>; </span><br><span class="line"><span class="built_in">min</span> = (<span class="built_in">min</span>*b)/gcd(<span class="built_in">min</span>, b);</span><br><span class="line">sum_a *= (<span class="built_in">min</span>/temp), sum_a += (<span class="built_in">min</span>/b)*a; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">min</span> = b, sum_a += a;</span><br><span class="line"></span><br><span class="line">g = gcd(sum_a, <span class="built_in">min</span>);</span><br><span class="line">sum_a /= g, <span class="built_in">min</span> /= g;</span><br><span class="line">&#125; </span><br><span class="line">N = temp_N;</span><br><span class="line"></span><br><span class="line"><span class="built_in">min</span> *= N;</span><br><span class="line">g = gcd(sum_a, <span class="built_in">min</span>);</span><br><span class="line">sum_a /= g, <span class="built_in">min</span> /= g;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">min</span> &gt; <span class="number">1</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d/%d"</span>, sum_a, <span class="built_in">min</span>);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d"</span>, sum_a);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-åˆ é™¤å­å­—ç¬¦ä¸²çš„ä¸€é“å¥½é¢˜-æ–¹æ³•å¯ä»¥æŒæ¡"><a href="#3-åˆ é™¤å­å­—ç¬¦ä¸²çš„ä¸€é“å¥½é¢˜-æ–¹æ³•å¯ä»¥æŒæ¡" class="headerlink" title="3.åˆ é™¤å­å­—ç¬¦ä¸²çš„ä¸€é“å¥½é¢˜.  (æ–¹æ³•å¯ä»¥æŒæ¡)"></a>3.åˆ é™¤å­å­—ç¬¦ä¸²çš„ä¸€é“å¥½é¢˜.  (æ–¹æ³•å¯ä»¥æŒæ¡)</h3><p><img src="/2019/11/17/PTA/image-20200414093531965.png" alt="image-20200414093531965"></p><p>ä¸‹é¢é¢˜è§£:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> *p = <span class="literal">NULL</span>;</span><br><span class="line"><span class="keyword">char</span> s[<span class="number">81</span>] = &#123;<span class="number">0</span>&#125;, t[<span class="number">80</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">gets(s), gets(t);</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(p = <span class="built_in">strstr</span>(s, t)) <span class="comment">//é¦–å…ˆæ‰¾åˆ°å­å­—ç¬¦ä¸²çš„ä½ç½®.</span></span><br><span class="line">&#123;</span><br><span class="line">*p = <span class="string">'\0'</span>;  <span class="comment">//å°†å…¶å­—ç¬¦ä¸²åˆ†å¼€.</span></span><br><span class="line"><span class="built_in">strcat</span>(s, p+<span class="built_in">strlen</span>(t));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(s);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-ä¸€é“é¢˜å› ä¸ºæ²¡æœ‰æ³¨æ„-é˜¶ä¹˜å¹¶ä¸æ˜¯-a-a-2-èŠ±äº†å¾ˆå¤šæ—¶é—´æ‰¾é”™"><a href="#4-ä¸€é“é¢˜å› ä¸ºæ²¡æœ‰æ³¨æ„-é˜¶ä¹˜å¹¶ä¸æ˜¯-a-a-2-èŠ±äº†å¾ˆå¤šæ—¶é—´æ‰¾é”™" class="headerlink" title="4.ä¸€é“é¢˜å› ä¸ºæ²¡æœ‰æ³¨æ„, é˜¶ä¹˜å¹¶ä¸æ˜¯  a *= a+2, èŠ±äº†å¾ˆå¤šæ—¶é—´æ‰¾é”™."></a>4.ä¸€é“é¢˜å› ä¸ºæ²¡æœ‰æ³¨æ„, é˜¶ä¹˜å¹¶ä¸æ˜¯  a *= a+2, èŠ±äº†å¾ˆå¤šæ—¶é—´æ‰¾é”™.</h3><p><img src="/2019/11/17/PTA/image-20200415160332020.png" alt="image-20200415160332020"></p><p>ä¸‹é¢ä»£ç :</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">double</span> i = <span class="number">2</span>;</span><br><span class="line"><span class="keyword">double</span> sum = <span class="number">2</span>, x = <span class="number">0</span>, a = <span class="number">1</span>, b = <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%lf"</span>, &amp;x);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>( ; <span class="number">2</span>*a/b &gt;= x; a *= i, b *= (<span class="number">2</span>*(i++) + <span class="number">1</span>))  <span class="comment">// è¿™é‡Œä¸€å®šè¦æ³¨æ„ä¸æ˜¯ a *= a+1, b *= b+2</span></span><br><span class="line">sum += <span class="number">2</span>*a/b;</span><br><span class="line"></span><br><span class="line">sum += <span class="number">2</span>*a/b</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%.6lf"</span>, sum);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5-å¹³é¢å‘é‡åŠ æ³•"><a href="#5-å¹³é¢å‘é‡åŠ æ³•" class="headerlink" title="5.å¹³é¢å‘é‡åŠ æ³•"></a>5.å¹³é¢å‘é‡åŠ æ³•</h3><p><img src="/2019/11/17/PTA/image-20200526092314780.png" alt="image-20200526092314780"></p><ul><li>å¯ä»¥çœ‹åˆ°é¢˜ç›®å°±æ˜¯ç®€å•çš„åŠ æ³•, ä½†æ˜¯è¿™é‡Œè€ƒäº†ä¸ªçŸ¥è¯†ç‚¹, æ­£æ˜¯æˆ‘ä¸çŸ¥é“çš„. æ‰€ä»¥æ”¹äº†å¥½å‡ æ¬¡.</li><li>å› ä¸ºåœ¨Cè¯­è¨€æ•´æ•°éƒ½æ˜¯ä¸ç®¡å››èˆäº”å…¥çš„, ç›´æ¥èˆå¼ƒå°æ•°éƒ¨åˆ†. åˆ°äº†æµ®ç‚¹æ•°æˆ‘é»˜è®¤ä»¥ä¸ºä¿ç•™å‡ ä½å°æ•°æ—¶,ä¹Ÿæ˜¯ç›´æ¥èˆå¼ƒå¤šä½™å°æ•°éƒ¨åˆ†, ä½†å…¶å®æ˜¯å››èˆäº”å…¥.</li><li>ä¸‹é¢é¢˜è§£.</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">double</span> a = <span class="number">0</span>, b = <span class="number">0</span>, c = <span class="number">0</span>, d = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">double</span> m = <span class="number">0</span>, n = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%lf %lf %lf %lf"</span>, &amp;a, &amp;b, &amp;c, &amp;d);</span><br><span class="line">m = a+c, n = b+d; </span><br><span class="line"><span class="keyword">if</span>(m &gt; <span class="number">-0.05</span> &amp;&amp; m &lt; <span class="number">0</span>)</span><br><span class="line">m = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(n &gt; <span class="number">-0.05</span> &amp;&amp; n &lt; <span class="number">0</span>)</span><br><span class="line">n = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"(%.1lf, %.1lf)"</span>, m, n);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;PTAç»ƒç»ƒæ‰‹,ç»†èŠ‚æ–¹é¢æœ‰æ”¶è·çš„åœ°æ–¹.&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
    
      <category term="ç®—æ³•" scheme="https://hus96r.coding-pages.com/categories/%E7%AE%97%E6%B3%95/"/>
    
    
  </entry>
  
  <entry>
    <title>æˆ‘çš„åšå®¢</title>
    <link href="https://hus96r.coding-pages.com/2019/11/17/%E6%88%91%E7%9A%84%E5%8D%9A%E5%AE%A2/"/>
    <id>https://hus96r.coding-pages.com/2019/11/17/%E6%88%91%E7%9A%84%E5%8D%9A%E5%AE%A2/</id>
    <published>2019-11-17T09:50:16.000Z</published>
    <updated>2020-05-27T03:42:29.250Z</updated>
    
    <content type="html"><![CDATA[<p><code>hexo</code>é»˜è®¤æ— æ³•è‡ªåŠ¨å¤„ç†æ–‡ç« æ’å…¥æœ¬åœ°å›¾ç‰‡ï¼Œéœ€è¦é€šè¿‡æ‰©å±•æ’ä»¶æ”¯æŒã€‚</p><h2 id="å›¾ç‰‡è·¯å¾„é—®é¢˜"><a href="#å›¾ç‰‡è·¯å¾„é—®é¢˜" class="headerlink" title="å›¾ç‰‡è·¯å¾„é—®é¢˜"></a>å›¾ç‰‡è·¯å¾„é—®é¢˜</h2><p>é…ç½®<code>_config.yml</code>é‡Œé¢çš„<code>post_asset_folder:false</code>è¿™ä¸ªé€‰é¡¹è®¾ç½®ä¸º<code>true</code>ã€‚</p><p>å®‰è£…<a href="https://github.com/7ym0n/hexo-asset-image.git" target="_blank" rel="noopener">hexo-asset-image</a>ï¼Œè¿è¡Œ<code>hexo n &quot;xxxx&quot;</code>æ¥ç”Ÿæˆmdåšæ–‡æ—¶ï¼Œ<code>/source/_posts</code>æ–‡ä»¶å¤¹å†…é™¤äº†xxxx.mdæ–‡ä»¶è¿˜æœ‰ä¸€ä¸ªåŒåçš„æ–‡ä»¶å¤¹ï¼ŒæŠŠå›¾ç‰‡æ”¾å…¥è¯¥æ–‡ä»¶å¤¹ã€‚</p><p>ä½¿ç”¨<code>![xxx](xxx/xxx.png)</code>ç›´æ¥æ’å…¥å›¾ç‰‡å³å¯ã€‚<a id="more"></a></p><h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><p>ç”±äºhexo3ç‰ˆæœ¬åå¯¹å¾ˆå¤šæ’ä»¶æ”¯æŒæœ‰é—®é¢˜ï¼Œ<a href="https://github.com/CodeFalling/hexo-asset-image.git" target="_blank" rel="noopener">hexo-asset-image</a>æ’ä»¶åœ¨å¤„ç†<code>data.permalink</code>é“¾æ¥æ—¶å‡ºç°è·¯å¾„é”™è¯¯ï¼ŒæŠŠå¹´æœˆå»æ‰äº†ï¼Œå¯¼è‡´æœ€åç”Ÿæˆçš„è·¯å¾„ä¸º<code>%d/xxx/xxx</code>éœ€è¦å¯¹å…¶åšå…¼å®¹å¤„ç†ã€‚é€šè¿‡åˆ¤æ–­å½“å‰ç‰ˆæœ¬æ˜¯å¦ç­‰äº<code>3</code>çš„ç‰ˆæœ¬åšä¸åŒçš„è·¯å¾„åˆ†å‰²ã€‚</p><p>åœ¨ä»£ç ä¸­åŠ å…¥ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> version = <span class="built_in">String</span>(hexo.version).split(<span class="string">'.'</span>);</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹<code>date.permalink</code>å¤„ç†ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> link = data.permalink;  </span><br><span class="line"><span class="keyword">if</span>(version.length &gt; <span class="number">0</span> &amp;&amp; <span class="built_in">Number</span>(version[<span class="number">0</span>]) == <span class="number">3</span>) </span><br><span class="line">    <span class="keyword">var</span> beginPos = getPosition(link, <span class="string">'/'</span>, <span class="number">1</span>) + <span class="number">1</span>; </span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">    <span class="keyword">var</span> beginPos = getPosition(link, <span class="string">'/'</span>, <span class="number">3</span>) + <span class="number">1</span>;</span><br></pre></td></tr></table></figure><p>é‡æ–°ç”Ÿæˆé™æ€æ–‡ä»¶å³å¯æ­£ç¡®æ˜¾ç¤ºã€‚</p><p>å¯ç›´æ¥å®‰è£…å·²ç»ä¿®æ”¹è¿‡å¾—æ’ä»¶<code>npm install https://github.com/7ym0n/hexo-asset-image --sa</code></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;code&gt;hexo&lt;/code&gt;é»˜è®¤æ— æ³•è‡ªåŠ¨å¤„ç†æ–‡ç« æ’å…¥æœ¬åœ°å›¾ç‰‡ï¼Œéœ€è¦é€šè¿‡æ‰©å±•æ’ä»¶æ”¯æŒã€‚&lt;/p&gt;
&lt;h2 id=&quot;å›¾ç‰‡è·¯å¾„é—®é¢˜&quot;&gt;&lt;a href=&quot;#å›¾ç‰‡è·¯å¾„é—®é¢˜&quot; class=&quot;headerlink&quot; title=&quot;å›¾ç‰‡è·¯å¾„é—®é¢˜&quot;&gt;&lt;/a&gt;å›¾ç‰‡è·¯å¾„é—®é¢˜&lt;/h2&gt;&lt;p&gt;é…ç½®&lt;code&gt;_config.yml&lt;/code&gt;é‡Œé¢çš„&lt;code&gt;post_asset_folder:false&lt;/code&gt;è¿™ä¸ªé€‰é¡¹è®¾ç½®ä¸º&lt;code&gt;true&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å®‰è£…&lt;a href=&quot;https://github.com/7ym0n/hexo-asset-image.git&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;hexo-asset-image&lt;/a&gt;ï¼Œè¿è¡Œ&lt;code&gt;hexo n &amp;quot;xxxx&amp;quot;&lt;/code&gt;æ¥ç”Ÿæˆmdåšæ–‡æ—¶ï¼Œ&lt;code&gt;/source/_posts&lt;/code&gt;æ–‡ä»¶å¤¹å†…é™¤äº†xxxx.mdæ–‡ä»¶è¿˜æœ‰ä¸€ä¸ªåŒåçš„æ–‡ä»¶å¤¹ï¼ŒæŠŠå›¾ç‰‡æ”¾å…¥è¯¥æ–‡ä»¶å¤¹ã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨&lt;code&gt;![xxx](xxx/xxx.png)&lt;/code&gt;ç›´æ¥æ’å…¥å›¾ç‰‡å³å¯ã€‚&lt;/p&gt;
    
    </summary>
    
    
    
  </entry>
  
</feed>
