<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 4.2.1"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/2.ico"><link rel="icon" type="image/png" sizes="16x16" href="/images/2.ico"><link rel="mask-icon" href="/images/logo.svg" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/all.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"www.bxnop.cn",root:"/",scheme:"Gemini",version:"7.8.0",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!0,show_result:!0,style:null},back2top:{enable:!0,sidebar:!0,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><meta name="description" content="åˆšåˆšæ¥è§¦ä¿¡æ¯å®‰å…¨ï¼Œä»å¼€å§‹åœ¨æ”»é˜²ä¸–ç•Œåˆ·é¢˜çš„éƒ¨åˆ†è®°å½•ã€‚"><meta property="og:type" content="article"><meta property="og:title" content="é€†å‘ç»ƒä¹ "><meta property="og:url" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/index.html"><meta property="og:site_name" content="Bxb0&#39;s blog"><meta property="og:description" content="åˆšåˆšæ¥è§¦ä¿¡æ¯å®‰å…¨ï¼Œä»å¼€å§‹åœ¨æ”»é˜²ä¸–ç•Œåˆ·é¢˜çš„éƒ¨åˆ†è®°å½•ã€‚"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200409121215784-1590549058520-1591952582454.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200409121557118-1590549064830-1591952588146.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200409122019635-1590549068676-1591952593224.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200409203440087-1590549086887-1591952596805.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200409204018803-1590549093480-1591952609729.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200409204652301-1590549096561-1591952613467.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200415170640341-1590549110220-1591952617886.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200415170736593-1590549112522-1591952621317.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200415171038960-1590549115097-1591952634770.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200415192448626-1590549120154-1591952639860.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200415193002493-1590549136439-1591952646896.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200415193726368-1590549141490-1591952651993.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200415194242898-1590549138934-1591952658378.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200417124955377-1590549145811-1591952671849.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200417131746746-1590549170275-1591952678402.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200417133116275-1590549174848-1591952682724.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200421172942651-1590549186380-1591952692434.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200421173112461-1590549193146-1591952706873.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200421173211318-1590549201703-1591952713057.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200421190646720-1590549218465-1591952718294.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200427213407581.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200427213610870.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200427213959893.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200427215217839.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200427215908475.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200510182506239.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200510182650313.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200510183307210.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200510183543551.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200510184751024.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200429150859645-1591162094958.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200429152407648-1590489723012-1591162107894.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200429155217177-1590489885930-1591162119539.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200429160021209-1590489939494-1591162126116.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200429162141561-1590490034442-1591162136025.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200501113755270-1590490003811-1591162636827.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200430190548596-1590490212309-1591162149285.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200430192452991-1590490227510-1591162179011.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200430200350749-1590490244163-1591162185500.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200430204438115-1590490290134-1591162198441.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200501104557726-1590490317124-1591162209414.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200501105251204-1590490324745-1591162219087.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200501110440340-1590490372567-1591162227662.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200501110942866-1591162259944.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200502082437777-1590490407479-1591162332414.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200502083116266-1590490428595-1591162345446.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200502083319440-1590490435324-1591162365723.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200502131757195-1590490442991-1591162417995.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200502133008194-1590490446814-1591162443875.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200503094008020-1590490467616-1591162454456.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200503094306385-1590490481485-1591162474450.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200503095605681-1590490490248-1591162483535.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200503101307822-1590490496701-1591162599070.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200503173759296-1590490519677-1591162520630.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200503174247305-1590490527077-1591162527371.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200503174332262-1590490532558-1591162533239.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200503174534451-1590490539636-1591162540789.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200503174824411-1590490553835-1591162556782.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200503175027583-1590490558591-1591162567556.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200503175154926-1590490566331-1591162575032.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200504133456542-1592290152904.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200504133948097-1592290160103.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200506194728611-1592290641234.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200506195403856-1592290472100.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200506202545180-1592290263125.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200504135411101-1592290168306.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200506201841271-1592290342688.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200504140433640-1592290514404.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200506144401943-1592290592390.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200506145151730-1592290606770.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200506145627945-1592290617965.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200508104152981-1592290667231.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200508105155224-1592290710459.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200512134025680-1592290738761.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200512133918795-1592290773581.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200515112040201-1591166378815.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200515112333168-1591166382914.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200515113837252-1591166387143.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200515170301682-1591166983676.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200515114501031-1591166391168.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200515114755333-1591166411300.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200515115440782-1591166415194.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200515120938171-1591166420082.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200515125253662-1591166423427.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200515134001272-1591166447078.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200515135919513-1591166487828.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200515184107394-1591167002031.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200515185409497-1591167023660.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200515193103677-1591167041257.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200521123259003-1591167068213.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200521123808376-1591167075180.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200528115958609-1591167079725.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200528121109201-1591167091052.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200528122051072-1591167097050.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200528163112618-1591167101638.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200530123951599-1591167111011.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200530124201413-1591167113886.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200602151634347.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200602154318790.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200919201636653.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200924200352664.png"><meta property="article:published_time" content="2020-04-09T01:53:27.000Z"><meta property="article:modified_time" content="2021-08-08T03:19:22.621Z"><meta property="article:author" content="ooo"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200409121215784-1590549058520-1591952582454.png"><link rel="canonical" href="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"en"}</script><title>é€†å‘ç»ƒä¹  | Bxb0's blog</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="alternate" href="/atom.xml" title="Bxb0's blog" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="Toggle navigation bar"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">Bxb0's blog</h1><span class="logo-line-after"><i></i></span></a></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul id="menu" class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i> Home</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i> Categories<span class="badge">14</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i> Archives<span class="badge">40</span></a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> Search</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocapitalize="off" placeholder="Searching..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"><div id="no-result"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></div></header><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content post posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en"><link itemprop="mainEntityOfPage" href="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.gif"><meta itemprop="name" content="ooo"><meta itemprop="description" content="0x446e37fb"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Bxb0's blog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> é€†å‘ç»ƒä¹ </h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i></span> <span class="post-meta-item-text">Posted on</span> <time title="Created: 2020-04-09 09:53:27" itemprop="dateCreated datePublished" datetime="2020-04-09T09:53:27+08:00">2020-04-09</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i></span> <span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Reverse/" itemprop="url" rel="index"><span itemprop="name">Reverse</span></a></span></span><br><span class="post-meta-item" title="Symbols count in article"><span class="post-meta-item-icon"><i class="far fa-file-word"></i></span> <span class="post-meta-item-text">Symbols count in article:</span> <span>37k</span></span><span class="post-meta-item" title="Reading time"><span class="post-meta-item-icon"><i class="far fa-clock"></i></span> <span class="post-meta-item-text">Reading time &asymp;</span> <span>34 mins.</span></span></div></header><div class="post-body" itemprop="articleBody"><p>åˆšåˆšæ¥è§¦ä¿¡æ¯å®‰å…¨ï¼Œä»å¼€å§‹åœ¨æ”»é˜²ä¸–ç•Œåˆ·é¢˜çš„éƒ¨åˆ†è®°å½•ã€‚<a id="more"></a></p><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><p>èœç‹—æˆªè·äº†ä¸€ä»½æŠ¥æ–‡å¦‚ä¸‹</p><p>ä»æŠ¥æ–‡ä¸­å¯ä»¥è”æƒ³åˆ°æ˜¯md5åŠ å¯†ï¼Œä½†è¯•äº†ä¸€ä¸‹, å‘ç°ä¸å¯¹ã€‚ å†çœ‹æŠ¥æ–‡ä¸­å­—æ¯åªæ˜¯ a-f ï¼Œæ‰€ä»¥å¯èƒ½æ˜¯åå…­è¿›åˆ¶æ•°ï¼Œåˆä¸€èˆ¬éƒ½æ˜¯ä¸€ä¸ªå­—èŠ‚ä¸€ä¸ªå­—ç¬¦ï¼Œ è€Œä¸€ä¸ªå­—èŠ‚å­˜æ”¾äºŒä¸ªåå…­è¿›åˆ¶æ•°ã€‚æˆ‘ä»¬å°±2ä¸ªä¸€ç»„è½¬æ¢æˆåè¿›åˆ¶ï¼Œä½†æ˜¯å¤§äºäº†127ï¼Œ å¯æ‰“å°å­—ç¬¦ASCIIèŒƒå›´åœ¨<strong>0-127</strong>ï¼Œ é‚£æˆ‘ä»¬çŸ¥é“ <code>}</code>å­—ç¬¦çš„ASCIIåå…­è¿›åˆ¶ä¸º <strong>0X7D</strong>ï¼Œå†çœ‹æŠ¥æ–‡æœ€å2ä¸ªå­—ç¬¦ç»„æˆçš„åå…­è¿›åˆ¶æ•° <strong>0xf2</strong>ï¼Œä¸€èˆ¬æˆ‘ä»¬å¯ä»¥æœ‰è¿™ä¸ªæ€è·¯ï¼Œæ±‚å·®å€¼ï¼Œä½†ä¹Ÿæœ‰æœ€åæ²¡æœ‰ç”¨ <strong>}</strong>ç»“å°¾çš„ï¼Œè¿™é‡Œå°±ä¸æ˜¯ã€‚ä½†å…¶å®æƒ³åˆ°è¦æŠŠå­—ç¬¦æ‰“å°å‡ºæ¥, è€Œå­—ç¬¦ASCII<strong>0-127</strong>ï¼Œé‚£å°±ç›´æ¥è¯•ä¸€è¯•å‡128ï¼Œä¸€ä¸‹å­å°±å¯¹äº†ï¼Œå“ˆã€‚</p><p>ä¸‹é¢æ˜¯Cè¯­è¨€å†™çš„ï¼Œ2ä¸ªä¸€ç»„è½¬æ¢æˆåè¿›åˆ¶æ•°, æœ€åå˜æˆå¯æ‰“å°å­—ç¬¦ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> a[] = <span class="string">"c8e9aca0c6f2e5f3e8c4efe7a1a0d4e8e5a0e6ece1e7a0e9f3baa0e8eafae3f9e4eafae2eae4e3eaebfaebe3f5e7e9f3e4e3e8eaf9eaf3e2e4e6f2"</span>;</span><br><span class="line">	<span class="keyword">int</span> i = <span class="number">0</span>, lenth  = <span class="built_in">strlen</span>(a), sum = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">char</span> b[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;, j = <span class="number">0</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; lenth; i += <span class="number">2</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(a[i] &gt;= <span class="number">97</span> &amp;&amp; a[i] &lt;= <span class="number">122</span>)</span><br><span class="line">			a[i] -= <span class="number">87</span>;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(a[i] &gt;= <span class="number">65</span> &amp;&amp; a[i] &lt;=  <span class="number">90</span>) </span><br><span class="line">			a[i] -= <span class="number">55</span>;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			a[i] -= <span class="number">48</span>; </span><br><span class="line">		</span><br><span class="line">		sum = sum*<span class="number">16</span> + a[i];</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(a[i+<span class="number">1</span>])</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>(a[i+<span class="number">1</span>] &gt;= <span class="number">97</span> &amp;&amp; a[i+<span class="number">1</span>] &lt;= <span class="number">122</span>)</span><br><span class="line">				a[i+<span class="number">1</span>] -= <span class="number">87</span>;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(a[i+<span class="number">1</span>] &gt;= <span class="number">65</span> &amp;&amp; a[i+<span class="number">1</span>] &lt;=  <span class="number">90</span>) </span><br><span class="line">				a[i+<span class="number">1</span>] -= <span class="number">55</span>;</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				a[i+<span class="number">1</span>] -= <span class="number">48</span>;</span><br><span class="line">			</span><br><span class="line">			sum = sum*<span class="number">16</span> + a[i+<span class="number">1</span>]; </span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">while</span>(sum &gt; <span class="number">127</span>)</span><br><span class="line">		sum -= <span class="number">128</span>;</span><br><span class="line">		</span><br><span class="line">		b[j++] = sum, sum = <span class="number">0</span>; </span><br><span class="line">	&#125; </span><br><span class="line">	</span><br><span class="line">	<span class="built_in">puts</span>(b);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="reverse1"><a href="#reverse1" class="headerlink" title="reverse1"></a>reverse1</h3><p>é¦–å…ˆæ‹¿åˆ°é¢˜, è¿˜æ˜¯æ‹–è¿›<strong>Exeinfope</strong>æŸ¥çœ‹ä¸€ä¸‹æ˜¯å¦æœ‰å£³:</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200409121215784-1590549058520-1591952582454.png" alt="image-20200409121215784-1590549058520"></p><p>å—¯æ²¡æœ‰.</p><p>æ‹–è¿›ida, æ‰¾åˆ°ä¸»å‡½æ•°, æµè§ˆä¸€ä¸‹ç¨‹åºåŠŸèƒ½, ä¸€ä¸ªæ¸¸æˆ, å¥½åƒæ˜¯é€šè¿‡ç‚¹äº®æ‰€æœ‰ç¯è·å¾—flag. é‚£ä¹ˆå¿…å®šæœ‰ä¸€ä¸ªåˆ¤æ–­æ¡ä»¶, å¾€ä¸‹çœ‹ä¸»å‡½æ•°, æ˜¾è€Œæ˜“è§:</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200409121557118-1590549064830-1591952588146.png" alt="image-20200409121557118-1590549064830"></p><p>é‚£ä¹ˆä¸‹é¢ä¸€ä¸ªå‡½æ•°å°±æ˜¯å…³é”®å‡½æ•°äº†, è¿›å»å‘ç°å°±æ˜¯å°†flagè®¡ç®—å‡ºæ¥, 56ä½é•¿åº¦, è¿˜æ˜¯æ‡’å¾—è‡ªå·±å†™ç¨‹åºæ¥ç®—.</p><p>æˆ‘ä»¬å¯ä»¥åœ¨idaä¸­æ‰¾åˆ° <strong>åˆ¤æ–­æ¡ä»¶</strong>é‚£é‡Œçš„çš„åœ°å€,: 0045F5D1</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200409122019635-1590549068676-1591952593224.png" alt="image-20200409122019635-1590549068676"></p><p>å†é€šè¿‡OD,çœ‹åŠ è½½çš„ VA(è™šæ‹Ÿå†…å­˜åœ°å€) :</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200409203440087-1590549086887-1591952596805.png" alt="image-20200409203440087-1590549086887"></p><p>é‚£ä¹ˆç”±äº åŠ¨æ€å’Œé™æ€çš„VAå¯èƒ½ä¸åŒï¼Œä½†æ˜¯å®ƒä»¬çš„RVAè¿˜æ˜¯ä¸€æ ·çš„ã€‚æˆ‘ä»¬ä½¿ç”¨åœ¨idaä¸­çš„æ‰¾åˆ°VA - imagebase = RVA. å†åŠ ä¸ŠODä¸­çš„VA, å³å¾—åˆ°åœ¨ODä¸­çš„åœ°å€: 0091F5D1. è¿™æ ·æˆ‘ä»¬ç›´æ¥åœ¨ODä¸­æ‰¾åˆ°è¿™ä¸ªåœ°å€: å¦‚ä¸‹å›¾, çœ‹åˆ°å¾ˆå¤š jnz. æ‰€ä»¥æˆ‘ä»¬çš„ç›®çš„æ˜¯è®©å®ƒéƒ½ä¸è·³è½¬, å¯ä»¥æ¯ä¸ªåœ°æ–¹éƒ½ nopäº†, ä½†æˆ‘ä»¬å¯ä»¥å¾€ä¸‹çœ‹, ç›´æ¥æ‰¾åˆ°å®ƒæœ€ååº”è¯¥å»åˆ°çš„å‡½æ•°åœ°å€(è®°ä¸ºA), é€šè¿‡æ‰“è¡¥ä¸æŠŠjnz xxxx, (å›¾ä¸­0091F5D8) æ”¹ä¸º jmp A.</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200409204018803-1590549093480-1591952609729.png" alt="image-20200409204018803-1590549093480"></p><p>æœ€åä¸€æŒ‰ F9 è¿è¡Œ, å‡ºç° flag .</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200409204652301-1590549096561-1591952613467.png" alt="image-20200409204652301-1590549096561"></p><h3 id="reverse2"><a href="#reverse2" class="headerlink" title="reverse2"></a>reverse2</h3><p>æ‹¿åˆ°é¢˜æ˜¯Cæºç , ç›´æ¥åˆ†æå°±å¥½äº†, æ‰¾åˆ°ä¸»å‡½æ•°çœ‹ä¸€ä¸‹. æ˜ç¡®ç›®æ ‡, è¾“å…¥å­—ç¬¦ä¸², ä¹Ÿå°±æ˜¯flag, è¿›è¡Œä¸€ç³»åˆ—æ“ä½œå’ŒæŒ‡å®šå­—ç¬¦ä¸²æ¯”è¾ƒ. æ‰¾åˆ°æ¯”è¾ƒçš„åœ°æ–¹å¾ˆå®¹æ˜“æ¨å‡º:è¿™é‡Œresult == 0;</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200415170640341-1590549110220-1591952617886.png" alt="image-20200415170640341-1590549110220"></p><p>é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥çŸ¥é“ä¸‹é¢å‡½æ•°çš„å¼‚æˆ–è¿ç®—ç»“æœä¸º0, é‚£ä¹ˆå³å‘ç”Ÿå¼‚æˆ–è¿ç®—çš„2ä¸ªæ•°ç›¸ç­‰.</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200415170736593-1590549112522-1591952621317.png" alt="image-20200415170736593-1590549112522"></p><p>æœ€åå°±æ˜¯éšæœºæ•°çš„é€‰å–äº†, æˆ‘ä»¬çŸ¥é“å®ƒæ˜¯ &lt;= 64çš„, é‚£ä¹ˆå†™ä¸€ä¸ªCç¨‹åº, æŠŠæ‰€æœ‰ç»“æœæ‰“å°å‡ºæ¥, æ‰¾åˆ°ç¬¦åˆçš„å³å¯.</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200415171038960-1590549115097-1591952634770.png" alt="image-20200415171038960-1590549115097"></p><p>æœ€åä»è¿™é“é¢˜, çŸ¥é“äº†, 1.<code>pthread_t</code>æ˜¯<code>unsigned long</code>å®å®šä¹‰çš„, 8ä¸ªå­—èŠ‚æ•´å‹æ•°æ®.2.<code>rand()%m</code>ä¹Ÿæ˜¯<code>random(m)</code>å®å®šä¹‰çš„.</p><h3 id="secret-galaxy-300"><a href="#secret-galaxy-300" class="headerlink" title="secret-galaxy-300"></a>secret-galaxy-300</h3><p>é¦–å…ˆé¢˜ä¸‹è½½ä¸‹æ¥, å‘ç°å‡†å¤‡äº†3ä¸ªä¸åŒçš„ç‰ˆæœ¬, å°±åˆ†æå¸¸è§çš„PEæ–‡ä»¶. æƒ³å…ˆæ‰“å¼€.exeæ–‡ä»¶, ä½†æ˜¯é—ªä¸€ä¸‹å°±é€€å‡ºäº†, æ ¹æœ¬çœ‹ä¸åˆ°ç¨‹åºæ˜¯åšä»€ä¹ˆçš„.</p><p>é¦–å…ˆæŸ¥å£³, å‘ç°æ— å£³.ğŸ˜ å…ˆç”¨idaæ‰“å¼€, æ‰¾åˆ°mainå‡½æ•°.å‘ç°æ˜¯ä»å·²ç»ç¼–ç çš„å­—ç¬¦ä¸²å–å‡ºæ¥, åœ¨æ‰“å°åœ¨å±å¹•ä¸Š. è½½å…¥OD, ä¸‹æ–­ç‚¹, çœ‹åˆ°åº•æ‰“å°äº†ä»€ä¹ˆ: åˆ—å‡ºå‡ ä¸ªé“¶æ²³; æ˜¯å¦æ˜¯æœ‰ç”Ÿç‰©å­˜åœ¨; å®ƒä»¬è·ç¦»åœ°çƒçš„è·ç¦». ä½†è¿™ä¸ªå’Œflagæœ‰ä»€ä¹ˆå…³ç³»å‘¢.ğŸ˜¢. æƒ³ä¸åˆ°è”ç³», å›åˆ°idaä¸­å†çœ‹çœ‹.</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200415192448626-1590549120154-1591952639860.png" alt="image-20200415192448626-1590549120154"></p><p>å‘ç°å·²ç»ç¼–ç çš„å­—ç¬¦æœ‰ä¸€ä¸ªæ²¡è¢«æ‰“å°å‡ºæ¥. å°± ctrl + x, çœ‹å“ªé‡Œè°ƒç”¨äº†å®ƒ, è·Ÿè¿›å».</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200415193002493-1590549136439-1591952646896.png" alt="image-20200415193002493-1590549136439"></p><p>å‘ç°éƒ½æ˜¯èµ‹å€¼æ“ä½œ, ä¸”æœ€åä¸€ä¸ªèµ‹å€¼0, å¾ˆå¯èƒ½æ˜¯ flag çš„å­—ç¬¦ä¸².è®°å½•å¼€å§‹å’Œç»“æŸçš„åœ°å€, å» OD ä¸­åŠ¨æ€è°ƒè¯•.</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200415193726368-1590549141490-1591952651993.png" alt="image-20200415193726368-1590549141490"></p><p>ODä¸­åœ¨2ä¸ªåœ°å€, ä¸‹æ–­ç‚¹, å¹¶åœ¨å¼€å§‹è®°å½•ä¸‹èµ‹å€¼å­˜æ”¾æ•°æ®çš„åœ°å€, æŠŠå®ƒåœ¨æ•°æ®çª—å£ä¸­è·Ÿéš. F9æ‰§è¡Œå‡ºç°å­—ç¬¦ä¸².</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200415194242898-1590549138934-1591952658378.png" alt="image-20200415194242898-1590549138934"></p><p>å¿ƒå¾—: æ³¨æ„æ–‡ä»¶ä¸­ç¼–ç äº†ä½†æ˜¯æ²¡æœ‰ä½¿ç”¨çš„å­—ç¬¦ä¸².</p><h3 id="Newbie-calculations"><a href="#Newbie-calculations" class="headerlink" title="Newbie_calculations"></a>Newbie_calculations</h3><p>é¦–å…ˆä»é¢˜ç›®çœ‹å‡º, æ˜¯æ–°æ‰‹è®¡ç®—, æƒ³åˆ°åº”è¯¥å’Œè®¡ç®—æœ‰å…³çš„.</p><p>é¢˜ç›®ä¸‹è½½ä¸‹æ¥, æ‰“å¼€å, åªæ˜¯æ‰“å° <strong>Your flag is:</strong> ,å°±å¡ä½äº†, ä¹Ÿæ²¡æœ‰è®©è¾“å…¥ä¿¡æ¯. åœ¨è‡ªå·±å†™Cç¨‹åºä¹Ÿé‡åˆ°è¿‡è¿™ç§é—®é¢˜, åº”è¯¥æ˜¯ç¨‹åºæœ‰ä»€ä¹ˆæ­»å¾ªç¯, æˆ–è€…å¤§é‡è€—æ—¶é—´çš„ç®—æ³•.</p><p>è½½å…¥ida, æ‰¾åˆ°mainå‡½æ•°, æœç„¶æœ‰å¾ˆå¤šå‡½æ•°, è·Ÿè¿›å…¶ä¸­ä¸€ä¸ªåå‘ç° v4 = -1, åé¢åˆç”¨æ¥å¾ªç¯, å› ä¸ºè‡ªå·±è¡¥ç ä¸æ˜¯å¾ˆæ¸…æ¥š, å¼€å§‹åªæ˜¯æƒ³åˆ°è¿™ä¸æ˜¯æ­»å¾ªç¯å˜›, ä¸”å’Œè‡ªå·±ä¹‹å‰çš„æƒ³çš„ä¸€æ ·. ç„¶åå¤©çœŸçš„è®¤ä¸º, å®ƒå¯èƒ½æ²¡ç”¨, è·³è¿‡å®ƒ, ç›´æ¥æ‰§è¡Œåé¢çš„æˆ–è®¸å¯ä»¥æ‰¾åˆ°ç­”æ¡ˆ, å°±çœŸçš„å»OD, æ‰“è¡¥ä¸, ç¨‹åºç›´æ¥å¥”æºƒ.</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200417124955377-1590549145811-1591952671849.png" alt="image-20200417124955377-1590549145811"></p><p> è¿™ä¸ªæ—¶å€™å‘ç°æœ‰å¾ˆå¤šå‡½æ•°, éƒ½æ˜¯ä¸€æ ·çš„, å¥½åƒåªæœ‰3ä¸ªå‡½æ•°åœ¨å“ªé‡Œè°ƒç”¨. ä½†æƒ³åˆ°éº»çƒ¦,å‘ç°è®¡ç®—å’Œè¡¥ç ç›¸å…³, ç„¶åè‡ªå·±å†™ç®€å•çš„ç¨‹åºç¨‹åºå¤ä¹ äº†ä¸‹è¡¥ç , <strong>-1-128 = 127, 127+1 = -128;</strong>, å†ç»“åˆä¹‹å‰çœ‹åˆ°çš„è¡¥ç å’Œæ—¶é’ŸåŸç†å¾ˆåƒ, è‡ªå·±æ€»ç»“äº†ä¸‹, å¯ä»¥æŠŠè¿™ä¸ªè®¡ç®—æƒ³æˆæ˜¯ä¸€ä¸ªåœ†åœˆ, ä»¥ä¸€ä¸ªå­—èŠ‚8ä½æ¥çœ‹, æˆ‘ä»¬çŸ¥é“èŒƒå›´æ˜¯ <strong>-128 - 127</strong></p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200417131746746-1590549170275-1591952678402.png" alt="image-20200417131746746-1590549170275"></p><p>çŸ¥é“ä¸€ä¸ªå‘¨æœŸçš„å¤§å°æ˜¯ <strong>256</strong>. é‚£ä¹ˆæœ‰ <strong>-1+1= 0</strong> ä¹Ÿå¯ä»¥å†™æˆ <strong>-1 - 255 = 0</strong>, ç›¸å½“äº -1 é€†æ—¶é’ˆè½¬äº† ä¸€åœˆå°‘1çš„è·ç¦», é‚£ä¹ˆå°±æ˜¯0çš„ä½ç½®, å› ä¸ºå¦‚æœè½¬äº†ä¸€åœˆçš„è¯, å›åˆ°åŸä½ç½®,. é¡ºæ—¶é’ˆåŠ æ³•ä¹Ÿæ˜¯ä¸€æ ·çš„åŸç†, <strong>0 + 256 = 0</strong>;</p><p>çŸ¥é“äº†è¿™ä¸€ç‚¹, é‚£ä¹ˆè¿™é“é¢˜å°±å¾ˆå®¹æ˜“äº†.è¦ä½¿ v4 == 0, é‚£ä¹ˆç›¸å½“äº v4é€†æ—¶é’ˆæ—‹è½¬ä¸€åœˆå°‘a2çš„è·ç¦», ç›¸å½“äº v4 += a2,</p><p>é‚£ä¹ˆåŒæ ·çš„é“ç†, â€“*a ç»è¿‡å¾ªç¯å, ç›¸å½“äºé€†æ—¶é’ˆæ—‹è½¬ä¸€åœˆå°‘a2çš„è·ç¦», å°±æ˜¯ *a1 += a2; è¡¥ç çœŸçš„ç¥å¥‡.ğŸ˜</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200417133116275-1590549174848-1591952682724.png" alt="image-20200417133116275-1590549174848"></p><p>åé¢çš„2ä¸ªå‡½æ•°åŒç†åˆ†æ. å°†è¯¥ä¸‰ä¸ªå‡½æ•°åˆ†åˆ«æ”¹å†™æˆå¯¹åº”çš„ä¹˜, å‡, åŠ :</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> *<span class="title">sub_401100</span><span class="params">(<span class="keyword">int</span> *a, <span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	*a = (*a) * b;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span>  a; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> *<span class="title">sub_401220</span><span class="params">(<span class="keyword">int</span> *a, <span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	*a = (*a) - b;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> *<span class="title">sub_401000</span><span class="params">(<span class="keyword">int</span> *a, <span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	*a = (*a) + b; </span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> *v3; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v4;</span><br><span class="line">  <span class="keyword">int</span> *v5; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v6; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v7; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v8; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v9; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v10; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v11; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v12; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v13; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v14; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v15; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v16; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v17; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v18; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v19; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v20; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v21; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v22; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v23; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v24; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v25; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v26; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v27; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v28; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v29; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v30; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v31; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v32; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v33; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v34; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v35; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v36; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v37; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v38; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v39; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v40; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v41; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v42; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v43; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v44; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v45; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v46; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v47; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v48; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v49; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v50; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v51; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v52; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v53; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v54; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v55; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v56; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v57; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v58; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v59; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v60; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v61; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v62; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v63; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v64; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v65; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v66; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v67; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v68; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v69; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v70; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v71; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v72; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v73; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v74; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v75; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v76; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v77; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v78; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v79; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v80; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v81; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v82; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v83; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v84; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v85; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v86; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v87; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v88; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v89; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v90; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v91; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v92; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v93; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v94; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v95; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v96; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v97; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v98; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v99; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v100; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v101; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v102; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v103; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v104; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v105; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v106; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v107; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v108; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v109; <span class="comment">// ST1C_4</span></span><br><span class="line">  <span class="keyword">int</span> *v110; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v111; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v112; <span class="comment">// ST20_4</span></span><br><span class="line">  <span class="keyword">int</span> *v113; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v114; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v115; <span class="comment">// ST20_4</span></span><br><span class="line">  <span class="keyword">int</span> *v116; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> i; <span class="comment">// [esp+4h] [ebp-90h]</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> j; <span class="comment">// [esp+8h] [ebp-8Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v120[<span class="number">32</span>]; <span class="comment">// [esp+Ch] [ebp-88h]</span></span><br><span class="line">  <span class="keyword">int</span> v121; <span class="comment">// [esp+8Ch] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">32</span>; ++i )</span><br><span class="line">    v120[i] = <span class="number">1</span>;</span><br><span class="line">  v121 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Your flag is:"</span>);</span><br><span class="line">  v3 = sub_401100(v120, <span class="number">1000000000</span>);</span><br><span class="line">  v4 = sub_401220(v3, <span class="number">999999950</span>);</span><br><span class="line">  sub_401100(v4, <span class="number">2</span>);</span><br><span class="line">  v5 = sub_401000(&amp;v120[<span class="number">1</span>], <span class="number">5000000</span>);</span><br><span class="line">  v6 = sub_401220(v5, <span class="number">6666666</span>);</span><br><span class="line">  v7 = sub_401000(v6, <span class="number">1666666</span>);</span><br><span class="line">  v8 = sub_401000(v7, <span class="number">45</span>);</span><br><span class="line">  v9 = sub_401100(v8, <span class="number">2</span>);</span><br><span class="line">  sub_401000(v9, <span class="number">5</span>);</span><br><span class="line">  v10 = sub_401100(&amp;v120[<span class="number">2</span>], <span class="number">1000000000</span>);</span><br><span class="line">  v11 = sub_401220(v10, <span class="number">999999950</span>);</span><br><span class="line">  v12 = sub_401100(v11, <span class="number">2</span>);</span><br><span class="line">  sub_401000(v12, <span class="number">2</span>);</span><br><span class="line">  v13 = sub_401000(&amp;v120[<span class="number">3</span>], <span class="number">55</span>);</span><br><span class="line">  v14 = sub_401220(v13, <span class="number">3</span>);</span><br><span class="line">  v15 = sub_401000(v14, <span class="number">4</span>);</span><br><span class="line">  sub_401220(v15, <span class="number">1</span>);</span><br><span class="line">  v16 = sub_401100(&amp;v120[<span class="number">4</span>], <span class="number">100000000</span>);</span><br><span class="line">  v17 = sub_401220(v16, <span class="number">99999950</span>);</span><br><span class="line">  v18 = sub_401100(v17, <span class="number">2</span>);</span><br><span class="line">  sub_401000(v18, <span class="number">2</span>);</span><br><span class="line">  v19 = sub_401220(&amp;v120[<span class="number">5</span>], <span class="number">1</span>);</span><br><span class="line">  v20 = sub_401100(v19, <span class="number">1000000000</span>);</span><br><span class="line">  v21 = sub_401000(v20, <span class="number">55</span>);</span><br><span class="line">  sub_401220(v21, <span class="number">3</span>);</span><br><span class="line">  v22 = sub_401100(&amp;v120[<span class="number">6</span>], <span class="number">1000000</span>);</span><br><span class="line">  v23 = sub_401220(v22, <span class="number">999975</span>);</span><br><span class="line">  sub_401100(v23, <span class="number">4</span>);</span><br><span class="line">  v24 = sub_401000(&amp;v120[<span class="number">7</span>], <span class="number">55</span>);</span><br><span class="line">  v25 = sub_401220(v24, <span class="number">33</span>);</span><br><span class="line">  v26 = sub_401000(v25, <span class="number">44</span>);</span><br><span class="line">  sub_401220(v26, <span class="number">11</span>);</span><br><span class="line">  v27 = sub_401100(&amp;v120[<span class="number">8</span>], <span class="number">10</span>);</span><br><span class="line">  v28 = sub_401220(v27, <span class="number">5</span>);</span><br><span class="line">  v29 = sub_401100(v28, <span class="number">8</span>);</span><br><span class="line">  sub_401000(v29, <span class="number">9</span>);</span><br><span class="line">  v30 = sub_401000(&amp;v120[<span class="number">9</span>], <span class="number">0</span>);</span><br><span class="line">  v31 = sub_401220(v30, <span class="number">0</span>);</span><br><span class="line">  v32 = sub_401000(v31, <span class="number">11</span>);</span><br><span class="line">  v33 = sub_401220(v32, <span class="number">11</span>);</span><br><span class="line">  sub_401000(v33, <span class="number">53</span>);</span><br><span class="line">  v34 = sub_401000(&amp;v120[<span class="number">10</span>], <span class="number">49</span>);</span><br><span class="line">  v35 = sub_401220(v34, <span class="number">2</span>);</span><br><span class="line">  v36 = sub_401000(v35, <span class="number">4</span>);</span><br><span class="line">  sub_401220(v36, <span class="number">2</span>);</span><br><span class="line">  v37 = sub_401100(&amp;v120[<span class="number">11</span>], <span class="number">1000000</span>);</span><br><span class="line">  v38 = sub_401220(v37, <span class="number">999999</span>);</span><br><span class="line">  v39 = sub_401100(v38, <span class="number">4</span>);</span><br><span class="line">  sub_401000(v39, <span class="number">50</span>);</span><br><span class="line">  v40 = sub_401000(&amp;v120[<span class="number">12</span>], <span class="number">1</span>);</span><br><span class="line">  v41 = sub_401000(v40, <span class="number">1</span>);</span><br><span class="line">  v42 = sub_401000(v41, <span class="number">1</span>);</span><br><span class="line">  v43 = sub_401000(v42, <span class="number">1</span>);</span><br><span class="line">  v44 = sub_401000(v43, <span class="number">1</span>);</span><br><span class="line">  v45 = sub_401000(v44, <span class="number">1</span>);</span><br><span class="line">  v46 = sub_401000(v45, <span class="number">10</span>);</span><br><span class="line">  sub_401000(v46, <span class="number">32</span>);</span><br><span class="line">  v47 = sub_401100(&amp;v120[<span class="number">13</span>], <span class="number">10</span>);</span><br><span class="line">  v48 = sub_401220(v47, <span class="number">5</span>);</span><br><span class="line">  v49 = sub_401100(v48, <span class="number">8</span>);</span><br><span class="line">  v50 = sub_401000(v49, <span class="number">9</span>);</span><br><span class="line">  sub_401000(v50, <span class="number">48</span>);</span><br><span class="line">  v51 = sub_401220(&amp;v120[<span class="number">14</span>], <span class="number">1</span>);</span><br><span class="line">  v52 = sub_401100(v51, <span class="number">-294967296</span>);</span><br><span class="line">  v53 = sub_401000(v52, <span class="number">55</span>);</span><br><span class="line">  sub_401220(v53, <span class="number">3</span>);</span><br><span class="line">  v54 = sub_401000(&amp;v120[<span class="number">15</span>], <span class="number">1</span>);</span><br><span class="line">  v55 = sub_401000(v54, <span class="number">2</span>);</span><br><span class="line">  v56 = sub_401000(v55, <span class="number">3</span>);</span><br><span class="line">  v57 = sub_401000(v56, <span class="number">4</span>);</span><br><span class="line">  v58 = sub_401000(v57, <span class="number">5</span>);</span><br><span class="line">  v59 = sub_401000(v58, <span class="number">6</span>);</span><br><span class="line">  v60 = sub_401000(v59, <span class="number">7</span>);</span><br><span class="line">  sub_401000(v60, <span class="number">20</span>);</span><br><span class="line">  v61 = sub_401100(&amp;v120[<span class="number">16</span>], <span class="number">10</span>);</span><br><span class="line">  v62 = sub_401220(v61, <span class="number">5</span>);</span><br><span class="line">  v63 = sub_401100(v62, <span class="number">8</span>);</span><br><span class="line">  v64 = sub_401000(v63, <span class="number">9</span>);</span><br><span class="line">  sub_401000(v64, <span class="number">48</span>);</span><br><span class="line">  v65 = sub_401000(&amp;v120[<span class="number">17</span>], <span class="number">7</span>);</span><br><span class="line">  v66 = sub_401000(v65, <span class="number">6</span>);</span><br><span class="line">  v67 = sub_401000(v66, <span class="number">5</span>);</span><br><span class="line">  v68 = sub_401000(v67, <span class="number">4</span>);</span><br><span class="line">  v69 = sub_401000(v68, <span class="number">3</span>);</span><br><span class="line">  v70 = sub_401000(v69, <span class="number">2</span>);</span><br><span class="line">  v71 = sub_401000(v70, <span class="number">1</span>);</span><br><span class="line">  sub_401000(v71, <span class="number">20</span>);</span><br><span class="line">  v72 = sub_401000(&amp;v120[<span class="number">18</span>], <span class="number">7</span>);</span><br><span class="line">  v73 = sub_401000(v72, <span class="number">2</span>);</span><br><span class="line">  v74 = sub_401000(v73, <span class="number">4</span>);</span><br><span class="line">  v75 = sub_401000(v74, <span class="number">3</span>);</span><br><span class="line">  v76 = sub_401000(v75, <span class="number">6</span>);</span><br><span class="line">  v77 = sub_401000(v76, <span class="number">5</span>);</span><br><span class="line">  v78 = sub_401000(v77, <span class="number">1</span>);</span><br><span class="line">  sub_401000(v78, <span class="number">20</span>);</span><br><span class="line">  v79 = sub_401100(&amp;v120[<span class="number">19</span>], <span class="number">1000000</span>);</span><br><span class="line">  v80 = sub_401220(v79, <span class="number">999999</span>);</span><br><span class="line">  v81 = sub_401100(v80, <span class="number">4</span>);</span><br><span class="line">  v82 = sub_401000(v81, <span class="number">50</span>);</span><br><span class="line">  sub_401220(v82, <span class="number">1</span>);</span><br><span class="line">  v83 = sub_401220(&amp;v120[<span class="number">20</span>], <span class="number">1</span>);</span><br><span class="line">  v84 = sub_401100(v83, <span class="number">-294967296</span>);</span><br><span class="line">  v85 = sub_401000(v84, <span class="number">49</span>);</span><br><span class="line">  sub_401220(v85, <span class="number">1</span>);</span><br><span class="line">  v86 = sub_401220(&amp;v120[<span class="number">21</span>], <span class="number">1</span>);</span><br><span class="line">  v87 = sub_401100(v86, <span class="number">1000000000</span>);</span><br><span class="line">  v88 = sub_401000(v87, <span class="number">54</span>);</span><br><span class="line">  v89 = sub_401220(v88, <span class="number">1</span>);</span><br><span class="line">  v90 = sub_401000(v89, <span class="number">1000000000</span>);</span><br><span class="line">  sub_401220(v90, <span class="number">1000000000</span>);</span><br><span class="line">  v91 = sub_401000(&amp;v120[<span class="number">22</span>], <span class="number">49</span>);</span><br><span class="line">  v92 = sub_401220(v91, <span class="number">1</span>);</span><br><span class="line">  v93 = sub_401000(v92, <span class="number">2</span>);</span><br><span class="line">  sub_401220(v93, <span class="number">1</span>);</span><br><span class="line">  v94 = sub_401100(&amp;v120[<span class="number">23</span>], <span class="number">10</span>);</span><br><span class="line">  v95 = sub_401220(v94, <span class="number">5</span>);</span><br><span class="line">  v96 = sub_401100(v95, <span class="number">8</span>);</span><br><span class="line">  v97 = sub_401000(v96, <span class="number">9</span>);</span><br><span class="line">  sub_401000(v97, <span class="number">48</span>);</span><br><span class="line">  v98 = sub_401000(&amp;v120[<span class="number">24</span>], <span class="number">1</span>);</span><br><span class="line">  v99 = sub_401000(v98, <span class="number">3</span>);</span><br><span class="line">  v100 = sub_401000(v99, <span class="number">3</span>);</span><br><span class="line">  v101 = sub_401000(v100, <span class="number">3</span>);</span><br><span class="line">  v102 = sub_401000(v101, <span class="number">6</span>);</span><br><span class="line">  v103 = sub_401000(v102, <span class="number">6</span>);</span><br><span class="line">  v104 = sub_401000(v103, <span class="number">6</span>);</span><br><span class="line">  sub_401000(v104, <span class="number">20</span>);</span><br><span class="line">  v105 = sub_401000(&amp;v120[<span class="number">25</span>], <span class="number">55</span>);</span><br><span class="line">  v106 = sub_401220(v105, <span class="number">33</span>);</span><br><span class="line">  v107 = sub_401000(v106, <span class="number">44</span>);</span><br><span class="line">  v108 = sub_401220(v107, <span class="number">11</span>);</span><br><span class="line">  sub_401000(v108, <span class="number">42</span>);</span><br><span class="line">  sub_401000(&amp;v120[<span class="number">26</span>], v120[<span class="number">25</span>]);</span><br><span class="line">  sub_401000(&amp;v120[<span class="number">27</span>], v120[<span class="number">12</span>]);</span><br><span class="line">  v109 = v120[<span class="number">27</span>];</span><br><span class="line">  v110 = sub_401220(&amp;v120[<span class="number">28</span>], <span class="number">1</span>);</span><br><span class="line">  v111 = sub_401000(v110, v109);</span><br><span class="line">  sub_401220(v111, <span class="number">1</span>);</span><br><span class="line">  v112 = v120[<span class="number">23</span>];</span><br><span class="line">  v113 = sub_401220(&amp;v120[<span class="number">29</span>], <span class="number">1</span>);</span><br><span class="line">  v114 = sub_401100(v113, <span class="number">1000000</span>);</span><br><span class="line">  sub_401000(v114, v112);</span><br><span class="line">  v115 = v120[<span class="number">27</span>];</span><br><span class="line">  v116 = sub_401000(&amp;v120[<span class="number">30</span>], <span class="number">1</span>);</span><br><span class="line">  sub_401100(v116, v115);</span><br><span class="line">  sub_401000(&amp;v120[<span class="number">31</span>], v120[<span class="number">30</span>]);</span><br><span class="line">  </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"CTF&#123;"</span>);</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">32</span>; ++j )</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%c"</span>, (v120[j]));</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"&#125;\n"</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="reverse-for-the-holy-grail-350"><a href="#reverse-for-the-holy-grail-350" class="headerlink" title="reverse-for-the-holy-grail-350"></a>reverse-for-the-holy-grail-350</h3><p>åˆæ˜¯C++çš„é¢˜, å¯¹äºåˆå­¦, æˆ‘çœ‹è¿™ä¸ªæœ‰äº›è¿˜æ˜¯å¾ˆåƒåŠ›çš„, æœ‰äº›å‡½æ•°åŠŸèƒ½è¿è’™å¸¦çŒœ. å…¶å®é™ä¸‹å¿ƒæ¥åˆ†æ, é€»è¾‘è¿˜æ˜¯å¾ˆç®€å•.</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200421172942651-1590549186380-1591952692434.png" alt="image-20200421172942651-1590549186380"></p><p>æ‰¾åˆ°å…³é”®å‡½æ•°è¿›å»å, çœ‹èµ·æ¥å¾ˆå¤š, ä½†é€»è¾‘ä¹Ÿæ˜¯ä¸éš¾çš„.</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200421173112461-1590549193146-1591952706873.png" alt="image-20200421173112461-1590549193146"></p><p>è¿™æ˜¯ç¨‹åºçš„ç®—æ³•, æˆ‘æŒ¨ä¸ªè®°å½•äº†ä¸‹æ¥â€¦â€¦..æˆ‘åœ¨åˆ°è¿™æ­¥çš„æ—¶å€™, å°±æ˜¯åœ¨çº ç»“é‚£ä¸ªå–ä½™å¤šè§£çš„é—®é¢˜, æƒ³åˆ°ç®—èµ·æ¥å¾ˆçƒ¦, ä½†ç”±äºæ˜¯å¯è¾“å…¥çš„å­—ç¬¦, æˆ‘ä»¬ç”¨éå†å³å¯ (0-127)</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200421173211318-1590549201703-1591952713057.png" alt="image-20200421173211318-1590549201703"></p><p>æœ€åé™„ä¸Š, ä»£ç :</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> first[] = &#123;<span class="number">0x41</span>, <span class="number">0x69</span>, <span class="number">0x6e</span>, <span class="number">0x45</span>, <span class="number">0x6f</span>, <span class="number">0x61</span>&#125;;</span><br><span class="line">	<span class="keyword">int</span> second[] = &#123;<span class="number">0x2ef</span>, <span class="number">0x2c4</span>, <span class="number">0x2dc</span>, <span class="number">0x2c7</span>, <span class="number">0x2de</span>, <span class="number">0x2fc</span>&#125;;</span><br><span class="line">	<span class="keyword">int</span> third[] = &#123;<span class="number">0x1d7</span>, <span class="number">0xc</span>, <span class="number">0x244</span>, <span class="number">0x25e</span>, <span class="number">0x93</span>, <span class="number">0x6c</span>&#125;;</span><br><span class="line">	<span class="keyword">int</span> mod[<span class="number">18</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">	<span class="keyword">int</span> i = <span class="number">0</span>, n = <span class="number">666</span>, j = <span class="number">0</span>, z = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> flag[<span class="number">20</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">18</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		mod[i] = n;</span><br><span class="line">		n += n%<span class="number">5</span>; </span><br><span class="line">	&#125; </span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">18</span>; i += <span class="number">3</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		flag[i] = first[j];</span><br><span class="line">		</span><br><span class="line">		flag[i+<span class="number">2</span>] = second[j] ^ mod[i+<span class="number">2</span>];</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">for</span>(z = <span class="number">0</span>; z &lt; <span class="number">127</span>; z++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>((flag[i] ^ mod[i])*(z^mod[i+<span class="number">1</span>]) % second[j] == third[j])</span><br><span class="line">			&#123;</span><br><span class="line">				flag[i+<span class="number">1</span>] = z;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125; </span><br><span class="line">		&#125; </span><br><span class="line">		</span><br><span class="line">		j++;</span><br><span class="line">	 </span><br><span class="line">	&#125; </span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">18</span>; i++)</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%c"</span>, flag[i]);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ€»ç»“: ç¨‹åºä¸­æ³¨æ„çœ‹æ¸…ä¼ å…¥å‚æ•°æ—¶,æ˜¯ä¸€ä¸ªå­—èŠ‚, è¿˜æ˜¯ä¸€ä¸ªintç±»å‹(4ä¸ªå­—èŠ‚); å–ä½™è¿ç®—, é€†å‘æ—¶, ä¸€èˆ¬éå†å³å¯.</p><h3 id="elrond32"><a href="#elrond32" class="headerlink" title="elrond32"></a>elrond32</h3><p>é¦–å…ˆ, ä¸‹è½½ä¸‹æ¥, ç”¨idaæ‰“å¼€, å‘ç°æ²¡æœ‰è¾“å…¥çš„åœ°æ–¹. æˆ–è®¸æ˜¯éšè—èµ·æ¥äº†. å°±åœ¨linuxä¸­è¿è¡Œä¸€ä¸‹æ¥çœ‹, æœç„¶æ²¡æœ‰è¾“å…¥, åªæ˜¯è¾“å‡ºéªŒè¯å¤±è´¥.</p><p>å›åˆ°ida, é€»è¾‘ä¹Ÿå¾ˆæ¸…æ¥š, å°±æ˜¯ä¸€ä¸ªå‡½æ•°çš„è¿”å›å€¼ é0 å³å¯, è¿›å…¥å…³é”®å‡½æ•°: ä¹Ÿå¾ˆç®€å•, å°±æ˜¯ä¸€ä¸ªé€’å½’è°ƒç”¨. ä»0å¼€å§‹, æ¯æ¬¡ (a1) éƒ½ç¬¦åˆç›¸åº”çš„å€¼ä¸”æœ€è¦æœ€åçš„è·³å‡ºé€’å½’å³å¯.é€šè¿‡è¿™ä¸ªæˆ‘ä»¬å°±çŸ¥é“äº† a1æ•°ç»„çš„å€¼. ç®—äº†ä¸€ä¸‹ a2çš„å€¼ä¸º: 0 7 1 3 6 5 9 4 2, è€Œ2æ²¡æœ‰å°±è·³å‡º. æŒ‰ç…§è¿™ä¸ªé¡ºåºå– (a1) .</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200421190646720-1590549218465-1591952718294.png" alt="image-20200421190646720-1590549218465"></p><p>å…¶å®æµè§ˆç¨‹åºçš„æ—¶å€™, å·²ç»çœ‹è¿‡ éªŒè¯é€šè¿‡ä¸‹é¢çš„ä¸€ä¸ªå‡½æ•°, å°±æ˜¯è®©33ä¸ªå·²ç»ç¼–ç äº†çš„å­—ç¬¦ä¸æˆ‘ä»¬å¾—åˆ°çš„ (a1)å¼‚æˆ–è¿ç®—, å†æ‰“å°å‡ºflag. ä¸‹é¢Cä»£ç :</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> a[] = &#123;<span class="number">105</span>, <span class="number">115</span>, <span class="number">101</span>, <span class="number">110</span>, <span class="number">103</span>, <span class="number">97</span>, <span class="number">114</span>, <span class="number">100</span>&#125;;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">union</span></span><br><span class="line">	&#123;	<span class="keyword">char</span> b[<span class="number">1000</span>];</span><br><span class="line">		<span class="keyword">int</span> n[<span class="number">33</span>];</span><br><span class="line">	&#125;A = &#123;</span><br><span class="line">   <span class="number">15</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">31</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">4</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">9</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">28</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">18</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">66</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">9</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">12</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">68</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">13</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">7</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">9</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">6</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">45</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">55</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">89</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">30</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">89</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">15</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">8</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">28</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">35</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">54</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">7</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">85</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">2</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">12</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">8</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">65</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">10</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">20</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span></span><br><span class="line">&#125;;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">char</span> flag[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">	<span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt;= <span class="number">32</span>; i++)</span><br><span class="line">	<span class="built_in">putchar</span>(A.n[i] ^ a[i % <span class="number">8</span>]);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ç™¾è¶Šæ¯2018-crazy"><a href="#ç™¾è¶Šæ¯2018-crazy" class="headerlink" title="ç™¾è¶Šæ¯2018-crazy"></a>ç™¾è¶Šæ¯2018-crazy</h3><p>é¦–å…ˆï¼Œè¿™é“é¢˜çš„ç®—æ³•å¾ˆç®€å•ï¼Œå°±æ˜¯è€ƒå¼•ç”¨C++çš„å­—ç¬¦ä¸²ç±»çš„å‡½æ•°ã€‚ ä½†æ˜¯è‡ªå·±ä¹ŸæŒ–æ˜äº†ä¸€äº›æ„Ÿè§‰æœ‰ç”¨çš„ä¸œè¥¿ï¼Œä¸»è¦æ˜¯é€šè¿‡è¿™é“é¢˜æ€»ç»“ c++å­—ç¬¦ä¸²ç±»ã€‚</p><p>æ‹–å…¥ExeinfoPeï¼Œé¢˜ç›®æ˜¯64ä¸ºelfæ–‡ä»¶ï¼Œç”¨64ä¸ºidaæ‰“å¼€ã€‚</p><p>æ‰¾åˆ°ä¸»å‡½æ•°ï¼Œ æŸ¥çœ‹ä¼ªä»£ç ï¼Œå‘ç°å¾ˆå†—é•¿ï¼Œä½†å¤§å¤šæ•°éƒ½æ˜¯é‚£äº›å­—ç¬¦ä¸²ç±»å‡½æ•°å’Œæ— ç”¨çš„ä¿¡æ¯ã€‚ æˆ‘ä»¬å¯ä»¥å…ˆé€šè¿‡ç‚¹å‡»æœ€åæ¯”è¾ƒè¦ç”¨åˆ°çš„å­—ç¬¦ä¸²çš„åç§°ï¼Œè¿™æ—¶ä¼šæŠŠæ‰€æœ‰ç›¸åŒåç§°éƒ½é«˜äº®æ˜¾ç¤ºå‡ºæ¥ï¼Œå°±å¯ä»¥é€šè¿‡é€»è¾‘åˆ¤æ–­å‡ºé‚£äº›æ˜¯å…³é”®å‡½æ•°å’Œå˜é‡ã€‚</p><p>ç¬¬ä¸€ä¸ªå…³é”®å‡½æ•° <strong>HighTemplar::HighTemplar((DarkTemplar *)&amp;v23ï¼Œ(__int64)&amp;input);</strong></p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200427213407581.png" alt="image-20200427213407581"></p><p>ç¬¬äºŒä¸ªå…³é”®å‡½æ•° <strong>HighTemplar::calculate((HighTemplar *)&amp;v23);</strong></p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200427213610870.png" alt="image-20200427213610870"></p><p>ç¬¬ä¸‰ä¸ªå…³é”®å‡½æ•° <strong>HighTemplar::getSerial((HighTemplar *)&amp;v23)</strong></p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200427213959893.png" alt="image-20200427213959893"></p><p>æœ€åwpï¼šä½†æ˜¯è¦å¼•èµ·æ³¨æ„çš„æ˜¯è¿™ä¸ªflagçœŸçš„å¥‡æ€ªï¼Œå¼€å§‹ä»¥ä¸ºç®—é”™äº†ï¼Œæ£€æŸ¥å‡ éï¼Œæœ€åå°±æ˜¯è¿™ä¸ª <strong>tMx~qdstOs~crvtwb~aOba}qddtbrtcd</strong> å†åŠ ä¸Šflag{}</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> a[] = <span class="string">"327a6c4304ad5938eaf0efb6cc3e53dc"</span>;</span><br><span class="line">	<span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">char</span> flag[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(a); i++)</span><br><span class="line">	&#123;</span><br><span class="line">		a[i] = (a[i] - <span class="number">11</span>) ^ <span class="number">0x13</span>;</span><br><span class="line">		a[i] = (a[i] - <span class="number">23</span>) ^ <span class="number">0x50</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">puts</span>(a);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ€»ç»“ï¼š</strong>å…ˆè¯´ä¸€ä¸‹åšè¿™ä¸ªé¢˜æƒ³è¿‡çš„ä¸€ä¸ªé—®é¢˜ã€‚ æˆ‘ä»¬çŸ¥é“ <strong>rodata</strong> æ®µæ˜¯åªè¯»çš„ï¼Œå­˜æ”¾å¸¸é‡ç­‰ï¼Œä½†æ˜¯è¿™é‡Œå´æœ‰å­—ç¬¦ä¸²åœ°å€çš„èµ‹å€¼ï¼Œä»–æŠŠ <strong>0x401EA0</strong> åœ°å€çš„å€¼æ”¹å˜äº†ï¼Œä½†ä¸ºä»€ä¹ˆå¯ä»¥è¿™æ ·å‘¢ï¼ŒæŸ¥äº†èµ„æ–™ï¼Œä¹Ÿæƒ³äº†å¾ˆä¹…ï¼Œæœ€åè®¤ä¸ºåº”è¯¥æ˜¯å­˜æ”¾çš„æŒ‡é’ˆ,è€Œä¸”æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™ä¸€æ®µéƒ½æ˜¯8å­—èŠ‚çš„å¢åŠ ï¼Œéƒ½æ˜¯ä¸€ä¸ªæŒ‡é’ˆ 8å­—èŠ‚çš„å¤§å°ã€‚</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200427215217839.png" alt="image-20200427215217839"></p><p>è¿™é‡Œä¹Ÿé€šè¿‡æŸ¥èµ„æ–™ï¼ŒçŸ¥é“äº†ä»¥å‰å­¦ä¹ æŒ‡é’ˆçš„ç–‘é—®ã€‚</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200427215908475.png" alt="image-20200427215908475"></p><p><strong>å› ä¸ºæˆ‘ä»¬åˆå§‹åŒ–ä¸€ä¸ªæ•°ç»„æ—¶,æ•°ç»„çš„åˆå§‹å€¼æ”¾åœ¨rodataæ®µé‡Œé¢ã€‚æ•°ç»„å¯¹åº”å¼€è¾Ÿçš„ç©ºé—´ä¸Šçš„æ•°å€¼å­˜æ”¾åœ¨æ ˆä¸Š,ç¼–è¯‘å™¨ä¼šå»è®¿é—®rodataæ®µä¸Šçš„åˆå§‹å€¼ç„¶åå–æ¥åˆå§‹åŒ–å±€éƒ¨å˜é‡ï¼Œå› æ­¤æ•°ç»„çš„å€¼æ‰èƒ½ä¿®æ”¹ã€‚ è€ŒæŒ‡é’ˆæŒ‡å‘çš„æ˜¯rodataæ®µï¼Œæ˜¯ä¸èƒ½è¢«ä¿®æ”¹çš„</strong>ã€‚</p><p>ç¬¬äºŒä¸ªå°±æ˜¯é€šè¿‡c++å®˜æ–¹æ‰‹å†Œçš„æŸ¥è¯¢å¯¹å„ç§c++å¼•ç”¨çš„å„ç§å­—ç¬¦ä¸²çš„æ€»ç»“ã€‚ ä¸‹é¢çš„ a b ä¸ºå­—ç¬¦æ•°ç»„ã€‚</p><table><thead><tr><th align="left">std::__cxx11::basic_string&lt;char,std::char_traits<char>,std::allocator<char>&gt;::operator<a href="aï¼Œi"></a></char></char></th></tr></thead><tbody><tr><td align="left">å³ <strong>a[i]</strong> çš„æ„æ€ï¼Œå¦‚æœoperatoråé¢æ²¡æœ‰ <strong>[]</strong>ï¼Œé‚£å°±æ˜¯ <strong>a+i</strong></td></tr><tr><td align="left">std::__cxx11::basic_string&lt;char,std::char_traits<char>,std::allocator<char>&gt;::basic_string(aï¼Œbï¼Œlenth)</char></char></td></tr><tr><td align="left">å³ <strong>strncpy(aï¼Œbï¼Œlenth)</strong> ç¬¬ä¸‰ä¸ªå‚æ•°å¯é€‰</td></tr><tr><td align="left">std::allocator<char>::~allocator(a) <strong>å‘ç°åªè¦å‰é¢æœ‰ä¸ª ~ çš„éƒ½æ˜¯é‡Šæ”¾</strong>ã€‚</char></td></tr><tr><td align="left">å³ <strong>free(a)</strong></td></tr><tr><td align="left">std::__cxx11::basic_string&lt;char,std::char_traits<char>,std::allocator<char>&gt;::length(a)</char></char></td></tr><tr><td align="left">å³ <strong>strlen(a)</strong></td></tr><tr><td align="left">std::operator&lt;&lt;&lt;std::char_traits<char>&gt;(&amp;std::coutï¼Œâ€helloâ€) åé¢æ€»è·Ÿç€ä¸‹é¢ä¸€å¥ã€‚ <strong>å…³é”®æ˜¯count</strong></char></td></tr><tr><td align="left">std::ostream::operator&lt;&lt;(v1ï¼Œ(__int64)&amp;std::endl&lt;char,std::char_traits<char>&gt;) å³ <strong>printf(â€œhelloâ€)</strong></char></td></tr><tr><td align="left">std::operator&gt;&gt;&lt;char,std::char_traits<char>,std::allocator<char>&gt;(&amp;std::cinï¼Œ&amp;a) <strong>å…³é”®æ˜¯in</strong></char></char></td></tr><tr><td align="left">å³ <strong>gets(a)</strong></td></tr></tbody></table><hr><h3 id="easyCpp"><a href="#easyCpp" class="headerlink" title="easyCpp"></a>easyCpp</h3><blockquote><p>C++é€†å‘çš„é¢˜ï¼Œåˆšå¼€å§‹æ¥è§¦å¾ˆå¤šä»£ç çœ‹ä¸æ‡‚,æ„Ÿè§‰å¯è¯»æ€§ä½ã€‚ ä½†æ˜¯çœ‹å¤šäº†ï¼Œè¿˜æ˜¯ä¼šå¥½å¾ˆå¤šã€‚ æ˜¯ä¸€ä¸ªæ…¢æ…¢ç†Ÿæ‚‰stlçš„è¿‡ç¨‹å§ã€‚</p></blockquote><p>ç»è¿‡äº†ä¸€äº›CPPé€†å‘é¢˜çš„æŠ˜ç£¨ï¼Œè¿™ä¸ªé¢˜å¤§å¤šæ•°å‡½æ•°è¿æ‡µå¸¦çŒœçš„çœ‹èµ·æ¥è¿˜å¥½ï¼Œä½†æ˜¯é‡åˆ°äº†ä¸€ä¸ªä¸ä»”ç»†çš„é”™è¯¯ï¼Œæƒ³äº†å¾ˆä¹…ã€‚ã€‚ã€‚ã€‚ã€‚</p><p>64ä½elfæ–‡ä»¶ï¼Œè½½å…¥idaï¼Œå‡½æ•°çš„å¤§éƒ¨åˆ†è¿˜æ˜¯çœ‹æ‡‚äº†ã€‚ 2ä¸ªå…³é”®å‡½æ•°ã€‚ <strong>transform accumulate</strong></p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200510182506239.png" alt="image-20200510182506239"></p><p>å…ˆè¿›å…¥ transformã€‚ ç®—æ³•ä¹Ÿæ˜¯å¾ˆç®€å•ï¼Œå°±æ˜¯å‡½æ•°è¯»èµ·æ¥æ›´éº»çƒ¦ã€‚</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200510182650313.png" alt="image-20200510182650313"></p><p>ä¸‹é¢ accumulateã€‚ è¿™ä¸ªçœ‹èµ·æ¥å°±ä¸æ˜¯é‚£ä¹ˆå®¹æ˜“äº†ï¼Œæœ‰å¾ˆå¤šåœ°å€ä¼ è¿‡æ¥ä¼ è¿‡å»å°±å¾ˆæ··æ·†ã€‚ é‚£å°±idaåŠ¨æ€è°ƒè¯•çœ‹çœ‹è¿™ä¸ªå‡½æ•°æ˜¯åšä»€ä¹ˆã€‚(ä¹Ÿæ˜¯è¿™é‡Œè‡ªå·±æƒ³äº†å¾ˆä¹…çš„é”™è¯¯ï¼Œè™½ç„¶å¾ˆç®€å•çš„ï¼Œå¯èƒ½æ˜¯stlæŠŠè‡ªå·±ææ˜äº†å§)ã€‚</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200510183307210.png" alt="image-20200510183307210"></p><p>å‘ç°é”™è¯¯ï¼Œé‡æ–°è°ƒè¯•åå¾—åˆ°ç»è¿‡ accumulate å‡½æ•°åçš„ç»“æœã€‚ æŠŠç»“æœéƒ½è®°å½•ä¸‹æ¥åã€‚ å‘ç°åªæ˜¯æŠŠ transformå‡½æ•°åçš„ç»“æœè¿›è¡Œäº†é€†åºã€‚<img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200510183543551.png" alt="image-20200510183543551"></p><p>å¼€å§‹å†™ exp: å¾—åˆ° <strong>987 -377 -610 -754 -843 -898 -932 -953 -966 -974 -979 -982 -984 -985 -986 -986</strong>ã€‚ æœ€ååœ¨linuxä¸‹è¿è¡Œç¨‹åºè¾“å…¥ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdioã€‚h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">fib</span><span class="params">(<span class="keyword">int</span> a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(!a || a == <span class="number">1</span>)</span><br><span class="line">	<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> fib(a<span class="number">-1</span>) + fib(a<span class="number">-2</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> flag[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;, i = <span class="number">0</span>; </span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt;= <span class="number">15</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		flag[i] = fib(i); </span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">15</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%d "</span>, flag[i] = (i &lt; <span class="number">15</span> ? flag[i] - flag[<span class="number">15</span>]:flag[i]));</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200510184751024.png" alt="image-20200510184751024"></p><p><strong>æ€»ç»“ï¼šæ³¨æ„ä¼ é€’çš„å‚æ•°æ˜¯æŒ‡é’ˆè¿˜æ˜¯å€¼ã€‚</strong></p><h3 id="Windows-Reverse2"><a href="#Windows-Reverse2" class="headerlink" title="Windows_Reverse2"></a>Windows_Reverse2</h3><p>é¦–å…ˆ,å› ä¸ºæ˜¯ä¸ª.exeæ–‡ä»¶, å…ˆæ‰“å¼€çœ‹ä¸€ä¸‹ç¨‹åºæ˜¯åšä»€ä¹ˆçš„, å‡ºç° <strong>input code:</strong> ä¹Ÿå°±æ˜¯è®©æˆ‘ä»¬è¾“å…¥ä¸€ä¸ªå¯†ç éªŒè¯.</p><p>ç”¨idaæ‰“å¼€, è¿˜æ˜¯å…ˆ shift + 12 æœç´¢ä¸€ä¸‹å­—ç¬¦ä¸², ç„¶è€Œå¹¶æ²¡æœ‰å‘ç°æˆ‘ä»¬æ‰“å¼€ç¨‹åºçœ‹åˆ°çš„ *<em>input code: *</em>,å¹¶ä¸”ç¨‹åºå‡½æ•°ä¹Ÿå¾ˆå°‘, é‚£å°±æ˜¯åŠ å£³äº†çš„. å¼€å§‹ä¹Ÿå¿˜äº†ç”¨è½¯ä»¶æŸ¥ä¸€ä¸‹å£³.</p><p>é‚£ä¹ˆç”¨ODæ‰“å¼€, ä½¿ç”¨å †æ ˆå¹³è¡¡çš„æ–¹æ³•, æ‰¾åˆ°ç¨‹åºçš„ OEP, ç„¶ådump, ä½†æ˜¯æ³¨æ„æ”¹ä¸€ä¸‹åŠ è½½çš„åˆå§‹åœ°å€å’Œå…¥å£ç‚¹, è¿™ä¸ªç¨‹åºå¹¶ä¸æ˜¯ 0x400000å¼€å§‹, æ¯æ¬¡åŠ è½½éƒ½æ˜¯ä¸ä¸€æ ·çš„åœ°å€,åº”è¯¥æ˜¯ ASLRä¿æŠ¤æŠ€æœ¯å§, ä¹‹å‰æœ‰äº†è§£è¿‡ä¸€äº›.é€šè¿‡å†…å­˜çª—å£, çŸ¥é“äº†æ˜¯ 0x1F0000.&lt;!â€“</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200429150859645-1591162094958.png" alt="image-20200429150859645"></p><p>dumpå‡ºå,ä½†æ˜¯æ‰“ä¸å¼€, ä¹‹å‰å­¦ä¹ è„±å£³æ—¶äº†è§£è¿‡,ä½†æ˜¯æ²¡æœ‰å®è·µ. å°±å»ä¸‹è½½<strong>import rec</strong>,ä½†æ‰“å¼€æ‰¾ä¸åˆ°æ¡Œé¢çš„æ–‡ä»¶, è¯•äº†å¥½å‡ ä¸ªä¹Ÿä¸è¡Œ, ç™¾åº¦ä¹Ÿæ— æœ. ä¹Ÿä¸æƒ³ç”¨è„±å£³è½¯ä»¶,ä¸»è¦æƒ³æ“ä½œä¸€ä¸‹. å…¶å®å¯¹äºå»idaåç¼–è¯‘å·²ç»è¶³å¤Ÿäº†,å› ä¸ºé‚£ä¸ªåªæ˜¯ä¼šå½±å“åŠ¨æ€é“¾æ¥çš„å‡½æ•°.</p><p>idaå†æ¬¡æ‰“å¼€å, æ‰¾åˆ°ä¸»å‡½æ•°, è½¬æ¢ä¸ºä¼ªä»£ç , é€»è¾‘å¾ˆç®€å•, å°±æ˜¯æŠŠæˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦å…ˆè¿›è¡Œåˆ¤æ–­,ç„¶åè¿›è¡ŒåŠ å¯†,ä¸ç¼–ç çš„å­—ç¬¦å¯¹æ¯”. å…ˆçœ‹åˆ¤æ–­å‡½æ•°.</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200429152407648-1590489723012-1591162107894.png" alt="image-20200429152407648-1590489723012"></p><p>ç„¶åçœ‹å…³é”®çš„åŠ å¯†å‡½æ•°, å‘ç°æœ€ä¸‹é¢è¿˜æœ‰ä¸€ä¸ªå‡½æ•° sub_A71000.</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200429155217177-1590489885930-1591162119539.png" alt="image-20200429155217177-1590489885930"></p><p>sub_A7100, åˆšå¼€å§‹çœ‹è¿™ä¸ªå‡½æ•°è§‰å¾—å¾ˆéº»çƒ¦, ä½†æ˜¯ä»ä»¥å‰åšçš„é¢˜æ¥çœ‹, å¹¶ä¸”è¿™ä¸ªå‡½æ•°æœ‰ &gt;&gt; è¿ç®—ç¬¦. å¯ä»¥å¾€baseç¼–ç è€ƒè™‘, é‚£å°±å…ˆçœ‹çœ‹æœ‰æ²¡æœ‰baseç¼–ç çš„æ ‡å¿—.</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200429160021209-1590489939494-1591162126116.png" alt="image-20200429160021209-1590489939494"></p><p>åˆ°äº†è¿™é‡Œ , å¯ä»¥çŸ¥é“, ç¨‹åºåªæ˜¯æ ‡å‡†ç æ¢äº†ä¸€ä¸‹. æˆ‘ä»¬å°±ç”¨ç¨‹åºç¼–ç çš„æ•°æ®å’Œ 0x76 å¼‚æˆ–è¿ç®—å¾—åˆ° å¾—åˆ°è¿™é‡Œçš„base64 çš„ç . ç„¶åè¿™ä¸ªç å»è§£ç åé¢ç”¨æ¥åšæ¯”è¾ƒçš„å­—ç¬¦,å¾—åˆ°ç¬¬ä¸€æ¬¡è½¬æ¢åçš„ç»“æœ. ä½†æ˜¯å¼‚æˆ–è¿ç®—å, æˆ‘ä»¬å‘ç°è¿™ä¸ªç å°±æ˜¯base64æ ‡å‡†ç .</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200429162141561-1590490034442-1591162136025.png" alt="image-20200429162141561-1590490034442"></p><p>æœ€å, çŸ¥é“å¼€å§‹æ˜¯æŠŠæˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦è¿›è¡Œæ•°å€¼è½¬æ¢çš„, é‚£ä¹ˆæœ€åè§£ç åæˆ‘ä»¬ä¹Ÿè¦è¿˜åŸä¸€ä¸‹. æ‡’å¾—Cè¯­è¨€è‡ªå·±å†™äº†, ç”¨ python çš„ hex(). æœ€å flagå°±æ˜¯ <strong>ADEBDEAEC7BE</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">s =  base64.b64decode(<span class="string">'reverse+'</span>)</span><br><span class="line"><span class="keyword">print</span> (type(s)) / åˆšå­¦python,æŸ¥çœ‹ä¸€ä¸‹æ˜¯ä»€ä¹ˆç±»å‹,å› ä¸ºç”¨hex(), å‘ç° list, tupleéƒ½æ²¡æœ‰ hex().</span><br><span class="line"><span class="keyword">print</span> (s.hex().upper())</span><br></pre></td></tr></table></figure><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200501113755270-1590490003811-1591162636827.png" alt="image-20200501113755270-1590490003811"></p><p><strong>æ€»ç»“: 1.é¢˜ç›®æœ‰æ—¶å€™çœ‹èµ·æ¥ä»£ç å¾ˆå†—é•¿, ä½†é€»è¾‘ä¸éš¾çš„, ç»†å¿ƒåˆ†æä¸€ä¸‹. è¦æ³¨æ„baseå®¶æ—çš„ç¼–ç ä¸è§£ç . 2.æ­£åœ¨å­¦ä¹ pythonä¸­, æ¯æ¬¡å†™pythonè„šæœ¬éƒ½æœ‰æ”¶è·.</strong></p><table><thead><tr><th>å­—ç¬¦ä¸²å‰æ·»åŠ r , è¡¨ç¤ºåç»­çš„å­—ç¬¦ä¸²åŸæ ·è¾“å‡º, ä¸è¿›è¡Œè½¬ä¹‰. å¦‚ \\ è½¬ä¹‰åä¸º \</th></tr></thead><tbody><tr><td><strong>å­—ç¬¦ä¸²å‰æ·»åŠ b, åé¢å­—ç¬¦ä¸²æ˜¯bytes ç±»å‹</strong></td></tr><tr><td><strong>åœ¨ Python3 ä¸­ï¼Œbytes å’Œ str çš„äº’ç›¸è½¬æ¢æ–¹å¼æ˜¯:str.encode(â€˜utf-8â€™) bytes.decode(â€˜utf-8â€™)</strong></td></tr></tbody></table><h3 id="Windows-Reverse1"><a href="#Windows-Reverse1" class="headerlink" title="Windows_Reverse1"></a>Windows_Reverse1</h3><p>é¦–å…ˆè¿™é“é¢˜ä¸ä¸Šé¢çš„ä¸€é“æ˜¯ä¸€èµ·çš„, åšäº†ä¸Šé¢çš„ä¸€é“é¢˜, è§‰å¾—åº”è¯¥è¿˜æ˜¯æœ‰å£³çš„, æŸ¥ä¸€ä¸‹æ˜¯ upx.</p><p>è½½å…¥ODè¿˜æ˜¯ä½¿ç”¨å †æ ˆå¹³è¡¡çš„åŸç†è„±å£³, å‘ç°åŒæ ·æ˜¯æ¯æ¬¡è½½å…¥çš„åœ°å€ä¸ä¸€æ ·, è„±å£³åè¿˜æ˜¯ä¸èƒ½è¿è¡Œ, è¿˜æ˜¯è¦ä¿®å¤è¾“å…¥è¡¨, ä½†import recåˆæ‰¾ä¸åˆ°æˆ‘ç”µè„‘çš„æ–‡ä»¶â€¦â€¦.å°±å…ˆæŠŠé¢˜åšäº†å†æ¥ç ”ç©¶.</p><p>idaè½½å…¥åååˆ†ç®€æ´. ä¸€ä¸ªåŠ å¯†å‡½æ•°åè¿›è¡Œåˆ¤æ–­. çœ‹åŠ å¯†å‡½æ•°.<img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200430190548596-1590490212309-1591162149285.png" alt="image-20200430190548596-1590490212309"></p><p>å› ä¸ºä¸Šé¢çš„ Reverse1 ä¹Ÿæ˜¯åˆåŒæ ·çš„é—®é¢˜(<strong>ä¸åŒçš„å˜é‡å¦‚ä½•è”ç³»åœ¨ä¸€èµ·çš„</strong>), å˜é‡åœ°å€æ˜¯ç›¸åŒçš„. å°±å…ˆçœ‹çœ‹ä¸Šé¢ <strong>v1çš„åœ°å€, å‘ç°æ˜¯ ecx ä¼ æ¥çš„</strong>, é‚£å†çœ‹çœ‹ä¸Šä¸€å±‚å‡½æ•°çš„ ecx . å‘ç°åœ¨è°ƒç”¨è¿™ä¸ªåŠ å¯†å‡½æ•°ä¹‹å‰æœ‰ä¸€ä¸ªecxèµ‹å€¼. <strong>è€Œè¦ç”¨æ¥æœ€åæ¯”è¾ƒçš„ v4å˜é‡, å®ƒçš„åœ°å€å’Œä¼ ç»™ecxæ˜¯ä¸€æ ·çš„</strong>. <strong><em>é‚£è¿™é‡Œå°±æ˜¯é€šè¿‡å¯„å­˜å™¨ä¼ é€’çš„å‚æ•°.</em></strong></p><p>ä¸Šé¢çš„ä»£ç è§‰å¾—å¥‡æ€ª, æ€€ç–‘æ˜¯idaçš„åŸå› , æŠŠåŸç¨‹åºåˆ° OD åŠ¨æ€è°ƒè¯•çœ‹ä¸€ä¸‹åŠ å¯†å‡½æ•°. æ¸…æ™°å¾ˆå¤š.</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200430192452991-1590490227510-1591162179011.png" alt="image-20200430192452991-1590490227510"></p><p>æ‰€ä»¥è¿™ä¸ªå‡½æ•°å°±æ˜¯é€šè¿‡æˆ‘ä»¬è¾“å…¥çš„ASCIIä¸ºç´¢å¼•å€¼æ¥ä¾æ¬¡å–å‡ºç¼–ç å­—ç¬¦çš„æ•°æ®, æœ€å<strong>DDCTF{reverseME}</strong>è¿›è¡Œæ¯”è¾ƒ.</p><p>å¯ä»¥çœ‹åˆ°æ˜¯ä» 0x402FF8 ä¸ºé¦–åœ°å€å¼€å§‹ç´¢å¼•, ä½†æ˜¯ä»idaä¸­å¯ä»¥çŸ¥é“ å¯æ‰“å°å­—ç¬¦æ˜¯ä»0x403018å¼€å§‹çš„.<img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200430200350749-1590490244163-1591162185500.png" alt="image-20200430200350749-1590490244163"></p><p>æœ€å,æˆ‘é‡åˆ°çš„å¾ˆå¤§çš„å‘â€¦..ğŸ¤£, å­—ç¬¦ä¸²å¤åˆ¶ä¸‹æ¥å, æˆ‘æ²¡æœ‰å¤„ç†å…¶ä¸­çš„ \ çš„å­—ç¬¦, é‚£ä¹ˆå°±è¢«é»˜è®¤ä¸ºè½¬ä¹‰å­—ç¬¦äº†, å¯¼è‡´2ä¸ªå­—ç¬¦å˜æˆä¸€ä¸ª, æœ€åç»“æœè‚¯å®šé”™. èŠ±äº†å¥½å¤šæ—¶é—´æ‰¾è¿™ä¸ªé”™è¯¯, è¿˜æ˜¯æ²¡æœ‰åœ¨ç»†èŠ‚ä¸Šæ³¨æ„ğŸ˜¢. <strong>exp:</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> a[] = <span class="string">"~&#125;|&#123;zyxwvutsrqponmlkjihgfedcba`_^]\\[ZYXWVUTSRQPONMLKJIHGFEDCBA@?&gt;=&lt;;:9876543210/.-,+*)(',27h,'&amp;%$#\"! "</span>; </span><br><span class="line">	<span class="keyword">char</span> b[] = <span class="string">"DDCTF&#123;reverseME&#125;"</span>;</span><br><span class="line">	<span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">char</span> flag[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">	 </span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(b); i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="built_in">strlen</span>(a); j++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>(a[j] == b[i])</span><br><span class="line">			&#123;</span><br><span class="line">				flag[i] = j + <span class="number">0x20</span>;</span><br><span class="line">				<span class="keyword">break</span>; </span><br><span class="line">			&#125; </span><br><span class="line">		&#125; </span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">puts</span>(flag);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åšå®Œå,å¼€å§‹å»äº†è§£ <strong>ASLR</strong>, çŸ¥é“äº†å¼€å¯ASLRçš„PEæ–‡ä»¶ä¼šå¤šäº†ä¸€ä¸ª.relocèŠ‚åŒº, ä¸”IMAGE_OPTIONAL_HEADER32ç»“æ„ä¸­çš„DllCharacteristicså¤šäº†ä¸€ä¸ªå±æ€§. å¦‚æœä¸€ä¸ªç¨‹åºå¼€å¯äº†ASLRä¿æŠ¤, æˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªDllCharacteristicsçš„å€¼ä»<strong>8140</strong>æ”¹ä¸º<strong>8100</strong>ä»è€Œå…³é—­ASLR.<img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200430204438115-1590490290134-1591162198441.png" alt="image-20200430204438115-1590490290134"></p><p><strong>æ€»ç»“: (1)ä¸€ä¸ªç¨‹åºä¸­çš„å‚æ•°å¯èƒ½ä¼šä»¥å¯„å­˜å™¨çš„æ¥ä¼ é€’ (2)å­—ç¬¦ä¸²ä¸­æ³¨æ„ \ å­—ç¬¦, è¦ç”¨ \\æ¥è¡¨ç¤º \ å­—ç¬¦. (3)ç¨‹åºçš„ASLRçš„å¼€å¯æ ‡å¿—åŠå…³é—­æ–¹æ³•.</strong></p><h3 id="gametime"><a href="#gametime" class="headerlink" title="gametime"></a>gametime</h3><p>é¦–å…ˆæŸ¥å£³, å‘ç°æ— å£³. æ‰“å¼€ç¨‹åºçœ‹ä¸€ä¸‹. æœç„¶æ˜¯ä¸€ä¸ªæ¸¸æˆ, ç®€å•çš„çœ‹äº†ä¸€ä¸‹, æ˜¯è®©æˆ‘ä»¬åœ¨è§„å®šæ—¶é—´è¾“å…¥å±å¹•ä¸Šæ˜¾ç¤ºçš„å­—ç¬¦.</p><p>idaæ‰“å¼€, çœ‹ä¼ªä»£ç , å¾ˆå†—é•¿, å‘ä¸‹æµè§ˆä¸€ä¸‹å¯ä»¥çœ‹è§å¥½å‡ ä¸ªåˆ¤æ–­å‡½æ•°. ä¸”éƒ½æ˜¯ä¸€ä¸ªå‡½æ•°, ç¨‹åºè‚¯å®šä¸åº”è¯¥æ˜¯é€€å‡º. æˆ‘ä»¬çš„ç›®çš„å°±æ˜¯è®©å®ƒçš„è¿”å›å€¼ä¸º <strong>é0</strong></p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200501104557726-1590490317124-1591162209414.png" alt="image-20200501104557726-1590490317124"></p><p>è¿›å…¥ sub_401507 çœ‹çœ‹. å‘ç°è¿˜æœ‰ä¸ªåˆ¤æ–­çš„åœ°æ–¹, <strong>æˆ‘ä»¬çš„ç›®çš„: è®©å®ƒè¿”å›1</strong> è®°å½•ä¸‹åœ°å€. <strong>0x00401563</strong>. <img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200501105251204-1590490324745-1591162219087.png" alt="image-20200501105251204-1590490324745"></p><p>æ­¤æ—¶ç¨‹åºä¸‹é¢è¿˜æœ‰ç±»ä¼¼çš„åˆ¤æ–­å‡½æ•°, é‚£ä¹ˆç›¸åŒçš„æ–¹æ³•, å…ˆæ‰¾åˆ°åœ°å€, è®°å½•ä¸‹æ¥.</p><p>æœ€åå‘ç°, ç¨‹åºçš„æ ¸å¿ƒåˆ¤æ–­å‡½æ•°å°±åªæœ‰2ä¸ª. åœ°å€åˆ†åˆ«ä¸º: <strong>0x00401563</strong> , <strong>0x004014DB</strong></p><p>æŠŠç¨‹åºè½½å…¥OD. è·³åˆ°æˆ‘ä»¬æ‰¾åˆ°çš„åœ°å€, å‘ç°åœ°å€å¯¹ä¸ä¸Š, é‚£ç¨‹åºæ˜¯å¼€å¯äº† ASLR çš„, ä½†æ˜¯ RVA æ˜¯ä¸€æ ·çš„, ç®€å•çš„ç®—ä¸€ä¸‹å°±å¯ä»¥äº†. å¦å¤–ä¸€ä¸ªåœ°å€, ç›¸åŒçš„æ“ä½œ.<img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200501110440340-1590490372567-1591162227662.png" alt="image-20200501110440340-1590490372567"></p><p>æœ€åF9è¿è¡Œ, æ¸¸æˆè¿›è¡Œä¸€æ®µæ—¶é—´, å‡ºç°flag. <img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200501110942866-1591162259944.png" alt="image-20200501110942866"></p><p><strong>æ€»ç»“: ç®€å•çš„åŠ¨æ€è°ƒè¯•çš„åº”ç”¨, æ³¨æ„åœ°å€æ˜¯ä¸æ˜¯ image base.</strong></p><h3 id="Replace"><a href="#Replace" class="headerlink" title="Replace"></a>Replace</h3><p>é¦–å…ˆæŸ¥å£³, å‘ç°æ˜¯ upx. è½½å…¥OD, å‡†å¤‡è„±å£³, ä½†æ˜¯å‘ç° <strong>VA</strong> ä¸æ˜¯é»˜è®¤åŠ è½½çš„0x400000, åº”è¯¥æ˜¯å¼€å¯äº† ASLR. è½¬åˆ°010editor,æ‰¾åˆ° <strong>struct DLL_CHARACTERISTICS DllCharacteristics</strong>, å°†8140æ”¹ä¸º8100.<img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200502082437777-1590490407479-1591162332414.png" alt="image-20200502082437777-1590490407479"></p><p>æ¥ä¸‹æ¥, é‡æ–°è½½å…¥OD,ä½¿ç”¨å †æ ˆå¹³è¡¡æ‰¾åˆ°ç¨‹åº EOP, ç„¶å dump.</p><p>è„±å£³åè½½å…¥IDA, ç¨‹åºé€»è¾‘ç®€å•, é¦–å…ˆé™åˆ¶é•¿åº¦ &lt;= 37, ç„¶åä¸€ä¸ªåˆ¤æ–­å‡½æ•°, æˆ‘ä»¬è¿›å…¥: ç®—æ³•ä¹Ÿä¸éš¾.<img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200502083116266-1590490428595-1591162345446.png" alt="image-20200502083116266-1590490428595"></p><p>exp:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> a[] = &#123;</span><br><span class="line">   <span class="number">50</span>,  <span class="number">97</span>,  <span class="number">52</span>,  <span class="number">57</span>, <span class="number">102</span>,  <span class="number">54</span>,  <span class="number">57</span>,  <span class="number">99</span>,  <span class="number">51</span>,  <span class="number">56</span>, </span><br><span class="line">   <span class="number">51</span>,  <span class="number">57</span>,  <span class="number">53</span>,  <span class="number">99</span>, <span class="number">100</span>, <span class="number">101</span>,  <span class="number">57</span>,  <span class="number">54</span>, <span class="number">100</span>,  <span class="number">54</span>, </span><br><span class="line">  <span class="number">100</span>, <span class="number">101</span>,  <span class="number">57</span>,  <span class="number">54</span>, <span class="number">100</span>,  <span class="number">54</span>, <span class="number">102</span>,  <span class="number">52</span>, <span class="number">101</span>,  <span class="number">48</span>, </span><br><span class="line">   <span class="number">50</span>,  <span class="number">53</span>,  <span class="number">52</span>,  <span class="number">56</span>,  <span class="number">52</span>,  <span class="number">57</span>,  <span class="number">53</span>,  <span class="number">52</span>, <span class="number">100</span>,  <span class="number">54</span>, </span><br><span class="line">   <span class="number">49</span>,  <span class="number">57</span>,  <span class="number">53</span>,  <span class="number">52</span>,  <span class="number">52</span>,  <span class="number">56</span>, <span class="number">100</span>, <span class="number">101</span>, <span class="number">102</span>,  <span class="number">54</span>, </span><br><span class="line">  <span class="number">101</span>,  <span class="number">50</span>, <span class="number">100</span>,  <span class="number">97</span>, <span class="number">100</span>,  <span class="number">54</span>,  <span class="number">55</span>,  <span class="number">55</span>,  <span class="number">56</span>,  <span class="number">54</span>, </span><br><span class="line">  <span class="number">101</span>,  <span class="number">50</span>,  <span class="number">49</span>, <span class="number">100</span>,  <span class="number">53</span>,  <span class="number">97</span>, <span class="number">100</span>,  <span class="number">97</span>, <span class="number">101</span>,  <span class="number">54</span>, </span><br><span class="line">    <span class="number">0</span></span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">char</span> b[] = &#123;</span><br><span class="line">   <span class="number">97</span>,  <span class="number">52</span>,  <span class="number">57</span>, <span class="number">102</span>,  <span class="number">54</span>,  <span class="number">57</span>,  <span class="number">99</span>,  <span class="number">51</span>,  <span class="number">56</span>, </span><br><span class="line">   <span class="number">51</span>,  <span class="number">57</span>,  <span class="number">53</span>,  <span class="number">99</span>, <span class="number">100</span>, <span class="number">101</span>,  <span class="number">57</span>,  <span class="number">54</span>, <span class="number">100</span>,  <span class="number">54</span>, </span><br><span class="line">  <span class="number">100</span>, <span class="number">101</span>,  <span class="number">57</span>,  <span class="number">54</span>, <span class="number">100</span>,  <span class="number">54</span>, <span class="number">102</span>,  <span class="number">52</span>, <span class="number">101</span>,  <span class="number">48</span>, </span><br><span class="line">   <span class="number">50</span>,  <span class="number">53</span>,  <span class="number">52</span>,  <span class="number">56</span>,  <span class="number">52</span>,  <span class="number">57</span>,  <span class="number">53</span>,  <span class="number">52</span>, <span class="number">100</span>,  <span class="number">54</span>, </span><br><span class="line">   <span class="number">49</span>,  <span class="number">57</span>,  <span class="number">53</span>,  <span class="number">52</span>,  <span class="number">52</span>,  <span class="number">56</span>, <span class="number">100</span>, <span class="number">101</span>, <span class="number">102</span>,  <span class="number">54</span>, </span><br><span class="line">  <span class="number">101</span>,  <span class="number">50</span>, <span class="number">100</span>,  <span class="number">97</span>, <span class="number">100</span>,  <span class="number">54</span>,  <span class="number">55</span>,  <span class="number">55</span>,  <span class="number">56</span>,  <span class="number">54</span>, </span><br><span class="line">  <span class="number">101</span>,  <span class="number">50</span>,  <span class="number">49</span>, <span class="number">100</span>,  <span class="number">53</span>,  <span class="number">97</span>, <span class="number">100</span>,  <span class="number">97</span>, <span class="number">101</span>,  <span class="number">54</span>, </span><br><span class="line">    <span class="number">0</span></span><br><span class="line">			&#125;;</span><br><span class="line">	<span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">char</span> flag[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">char</span> c[] = &#123;</span><br><span class="line">   <span class="number">99</span>, <span class="number">124</span>, <span class="number">119</span>, <span class="number">123</span>, <span class="number">242</span>, <span class="number">107</span>, <span class="number">111</span>, <span class="number">197</span>,  <span class="number">48</span>,   <span class="number">1</span>, </span><br><span class="line">  <span class="number">103</span>,  <span class="number">43</span>, <span class="number">254</span>, <span class="number">215</span>, <span class="number">171</span>, <span class="number">118</span>, <span class="number">202</span>, <span class="number">130</span>, <span class="number">201</span>, <span class="number">125</span>, </span><br><span class="line">  <span class="number">250</span>,  <span class="number">89</span>,  <span class="number">71</span>, <span class="number">240</span>, <span class="number">173</span>, <span class="number">212</span>, <span class="number">162</span>, <span class="number">175</span>, <span class="number">156</span>, <span class="number">164</span>, </span><br><span class="line">  <span class="number">114</span>, <span class="number">192</span>, <span class="number">183</span>, <span class="number">253</span>, <span class="number">147</span>,  <span class="number">38</span>,  <span class="number">54</span>,  <span class="number">63</span>, <span class="number">247</span>, <span class="number">204</span>, </span><br><span class="line">   <span class="number">52</span>, <span class="number">165</span>, <span class="number">229</span>, <span class="number">241</span>, <span class="number">113</span>, <span class="number">216</span>,  <span class="number">49</span>,  <span class="number">21</span>,   <span class="number">4</span>, <span class="number">199</span>, </span><br><span class="line">   <span class="number">35</span>, <span class="number">195</span>,  <span class="number">24</span>, <span class="number">150</span>,   <span class="number">5</span>, <span class="number">154</span>,   <span class="number">7</span>,  <span class="number">18</span>, <span class="number">128</span>, <span class="number">226</span>, </span><br><span class="line">  <span class="number">235</span>,  <span class="number">39</span>, <span class="number">178</span>, <span class="number">117</span>,   <span class="number">9</span>, <span class="number">131</span>,  <span class="number">44</span>,  <span class="number">26</span>,  <span class="number">27</span>, <span class="number">110</span>, </span><br><span class="line">   <span class="number">90</span>, <span class="number">160</span>,  <span class="number">82</span>,  <span class="number">59</span>, <span class="number">214</span>, <span class="number">179</span>,  <span class="number">41</span>, <span class="number">227</span>,  <span class="number">47</span>, <span class="number">132</span>, </span><br><span class="line">   <span class="number">83</span>, <span class="number">209</span>,   <span class="number">0</span>, <span class="number">237</span>,  <span class="number">32</span>, <span class="number">252</span>, <span class="number">177</span>,  <span class="number">91</span>, <span class="number">106</span>, <span class="number">203</span>, </span><br><span class="line">  <span class="number">190</span>,  <span class="number">57</span>,  <span class="number">74</span>,  <span class="number">76</span>,  <span class="number">88</span>, <span class="number">207</span>, <span class="number">208</span>, <span class="number">239</span>, <span class="number">170</span>, <span class="number">251</span>, </span><br><span class="line">   <span class="number">67</span>,  <span class="number">77</span>,  <span class="number">51</span>, <span class="number">133</span>,  <span class="number">69</span>, <span class="number">249</span>,   <span class="number">2</span>, <span class="number">127</span>,  <span class="number">80</span>,  <span class="number">60</span>, </span><br><span class="line">  <span class="number">159</span>, <span class="number">168</span>,  <span class="number">81</span>, <span class="number">163</span>,  <span class="number">64</span>, <span class="number">143</span>, <span class="number">146</span>, <span class="number">157</span>,  <span class="number">56</span>, <span class="number">245</span>, </span><br><span class="line">  <span class="number">188</span>, <span class="number">182</span>, <span class="number">218</span>,  <span class="number">33</span>,  <span class="number">16</span>, <span class="number">255</span>, <span class="number">243</span>, <span class="number">210</span>, <span class="number">205</span>,  <span class="number">12</span>, </span><br><span class="line">   <span class="number">19</span>, <span class="number">236</span>,  <span class="number">95</span>, <span class="number">151</span>,  <span class="number">68</span>,  <span class="number">23</span>, <span class="number">196</span>, <span class="number">167</span>, <span class="number">126</span>,  <span class="number">61</span>, </span><br><span class="line">  <span class="number">100</span>,  <span class="number">93</span>,  <span class="number">25</span>, <span class="number">115</span>,  <span class="number">96</span>, <span class="number">129</span>,  <span class="number">79</span>, <span class="number">220</span>,  <span class="number">34</span>,  <span class="number">42</span>, </span><br><span class="line">  <span class="number">144</span>, <span class="number">136</span>,  <span class="number">70</span>, <span class="number">238</span>, <span class="number">184</span>,  <span class="number">20</span>, <span class="number">222</span>,  <span class="number">94</span>,  <span class="number">11</span>, <span class="number">219</span>, </span><br><span class="line">  <span class="number">224</span>,  <span class="number">50</span>,  <span class="number">58</span>,  <span class="number">10</span>,  <span class="number">73</span>,   <span class="number">6</span>,  <span class="number">36</span>,  <span class="number">92</span>, <span class="number">194</span>, <span class="number">211</span>, </span><br><span class="line">  <span class="number">172</span>,  <span class="number">98</span>, <span class="number">145</span>, <span class="number">149</span>, <span class="number">228</span>, <span class="number">121</span>, <span class="number">231</span>, <span class="number">200</span>,  <span class="number">55</span>, <span class="number">109</span>, </span><br><span class="line">  <span class="number">141</span>, <span class="number">213</span>,  <span class="number">78</span>, <span class="number">169</span>, <span class="number">108</span>,  <span class="number">86</span>, <span class="number">244</span>, <span class="number">234</span>, <span class="number">101</span>, <span class="number">122</span>, </span><br><span class="line">  <span class="number">174</span>,   <span class="number">8</span>, <span class="number">186</span>, <span class="number">120</span>,  <span class="number">37</span>,  <span class="number">46</span>,  <span class="number">28</span>, <span class="number">166</span>, <span class="number">180</span>, <span class="number">198</span>, </span><br><span class="line">  <span class="number">232</span>, <span class="number">221</span>, <span class="number">116</span>,  <span class="number">31</span>,  <span class="number">75</span>, <span class="number">189</span>, <span class="number">139</span>, <span class="number">138</span>, <span class="number">112</span>,  <span class="number">62</span>, </span><br><span class="line">  <span class="number">181</span>, <span class="number">102</span>,  <span class="number">72</span>,   <span class="number">3</span>, <span class="number">246</span>,  <span class="number">14</span>,  <span class="number">97</span>,  <span class="number">53</span>,  <span class="number">87</span>, <span class="number">185</span>, </span><br><span class="line">  <span class="number">134</span>, <span class="number">193</span>,  <span class="number">29</span>, <span class="number">158</span>, <span class="number">225</span>, <span class="number">248</span>, <span class="number">152</span>,  <span class="number">17</span>, <span class="number">105</span>, <span class="number">217</span>, </span><br><span class="line">  <span class="number">142</span>, <span class="number">148</span>, <span class="number">155</span>,  <span class="number">30</span>, <span class="number">135</span>, <span class="number">233</span>, <span class="number">206</span>,  <span class="number">85</span>,  <span class="number">40</span>, <span class="number">223</span>, </span><br><span class="line">  <span class="number">140</span>, <span class="number">161</span>, <span class="number">137</span>,  <span class="number">13</span>, <span class="number">191</span>, <span class="number">230</span>,  <span class="number">66</span>, <span class="number">104</span>,  <span class="number">65</span>, <span class="number">153</span>, </span><br><span class="line">   <span class="number">45</span>,  <span class="number">15</span>, <span class="number">176</span>,  <span class="number">84</span>, <span class="number">187</span>,  <span class="number">22</span>,  <span class="number">72</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span></span><br><span class="line">&#125;;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">35</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">int</span> temp = <span class="number">0</span>, temp1 = <span class="number">0</span>, q = <span class="number">0</span>, w = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">127</span>; j++)</span><br><span class="line">		&#123;</span><br><span class="line">			 temp = (j &gt;&gt; <span class="number">4</span>) % <span class="number">16</span>; </span><br><span class="line">			 temp1 = (<span class="number">16</span>*j &gt;&gt; <span class="number">4</span>) % <span class="number">16</span>;</span><br><span class="line">			 q = a[<span class="number">2</span>*i];</span><br><span class="line">			 <span class="keyword">if</span>(q &lt; <span class="number">48</span> || q &gt; <span class="number">57</span>)</span><br><span class="line">			 	q = q<span class="number">-87</span>;</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				q = q<span class="number">-48</span>;</span><br><span class="line">			q = q*<span class="number">16</span>;</span><br><span class="line">			</span><br><span class="line">			w = b[<span class="number">2</span>*i];</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">if</span>(w &lt; <span class="number">48</span> || w &gt; <span class="number">57</span>)</span><br><span class="line">				w = w<span class="number">-87</span>;</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				w = w<span class="number">-48</span>; </span><br><span class="line">			 </span><br><span class="line">			 </span><br><span class="line">			 <span class="keyword">if</span>(c[<span class="number">16</span>*temp + temp1] == ((w+q) ^ <span class="number">0x19</span>))</span><br><span class="line">			 &#123;</span><br><span class="line">			 	flag[i] = j;</span><br><span class="line">				<span class="keyword">break</span>; </span><br><span class="line">			 &#125; </span><br><span class="line">		&#125;</span><br><span class="line">		 </span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">puts</span>(flag); </span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200502083319440-1590490435324-1591162365723.png" alt="image-20200502083319440-1590490435324"></p><p><strong>æ€»ç»“: &gt;&gt; è¿ç®—ç¬¦ç§»åŠ¨nä½å°±ç›¸å½“äºé™¤ä»¥2^n. ä¸” % çš„ä¼˜å…ˆçº§å¤§äº &gt;&gt;</strong></p><h3 id="notsequence"><a href="#notsequence" class="headerlink" title="notsequence"></a>notsequence</h3><p>è‡ªå·±ç®—æ³•å¤ªèœäº†, è¿™é“é¢˜çš„2ä¸ªå‡½æ•°å§‹ç»ˆæ²¡çœ‹æ‡‚â€¦ çœ‹äº†writeup, æ¨è¾‰ä¸‰è§’å½¢!</p><p>çœ‹äº†writeup, è‡ªå·±æ…¢æ…¢çš„åˆ†æäº†ä¸‹. é¦–å…ˆ, check1å‡½æ•°.</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200502131757195-1590490442991-1591162417995.png" alt="image-20200502131757195-1590490442991"></p><p>ç„¶åæ˜¯check2.</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200502133008194-1590490446814-1591162443875.png" alt="image-20200502133008194-1590490446814"></p><p>ç»è¿‡è¿™2ä¸ªå‡½æ•°åˆ¤æ–­, å°±èƒ½çŸ¥é“æ˜¯å¦æ˜¯æ¨è¾‰ä¸‰è§’å½¢äº†. æŠŠå‰20è¡Œçš„æ•°æ®ç»è¿‡md5åŠ å¯†å°±æ˜¯flag.</p><p>æœ€å, é¢˜è‡ªå·±è™½ç„¶æ¯åšå‡ºæ¥, å€’æ˜¯é€šè¿‡è¿™ä¸ªé¢˜é‡æ–°è®¤è¯†äº†æ¨è¾‰ä¸‰è§’å½¢. å†™äº†Cè¯­è¨€å’Œpythonçš„ç‰ˆæœ¬. ä¹Ÿæ˜¯æƒ³æ‰“å°å‡ºæ¥çœ‹çœ‹, ä¸”è‡ªå·±åˆšæ¥è§¦python, ä»£ç ä¹±è€Œé•¿.</p><p><strong>python3:</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">createL</span><span class="params">(l)</span>:</span></span><br><span class="line">    L = [<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">1</span>, len(l)):</span><br><span class="line">        L.append(l[x] + l[x<span class="number">-1</span>])</span><br><span class="line">    L.append(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> L</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">printL</span><span class="params">(L, W)</span>:</span></span><br><span class="line">    s = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> L:</span><br><span class="line">        s += str(x) + <span class="string">" "</span></span><br><span class="line">    print(s.center(W))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">str_</span><span class="params">(s, L)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> L:</span><br><span class="line">        s += str(x)</span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">L = [<span class="number">1</span>]</span><br><span class="line">s = <span class="string">""</span></span><br><span class="line">row = int(input(<span class="string">"è¯·è¾“å…¥è¡Œæ•°: "</span>))</span><br><span class="line">width =row* <span class="number">6</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(row):</span><br><span class="line">    printL(L, width)</span><br><span class="line">    s = str_(s, L)</span><br><span class="line">    L = createL(L)</span><br><span class="line">print(s)</span><br><span class="line">m = hashlib.md5(s.encode()).hexdigest()</span><br><span class="line">print(<span class="string">"md5åŠ å¯†å:%s"</span> % m)</span><br></pre></td></tr></table></figure><p>expï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt; </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> *<span class="title">creat</span><span class="params">(<span class="keyword">int</span> *L, <span class="keyword">int</span> lenth)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> *p = (<span class="keyword">int</span> *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">int</span>)*(lenth+<span class="number">1</span>));</span><br><span class="line">	</span><br><span class="line">	p[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">1</span>; i &lt; lenth; i++)</span><br><span class="line">	p[i] = L[i<span class="number">-1</span>] + L[i];</span><br><span class="line">	</span><br><span class="line">	p[lenth] = <span class="number">1</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> p;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(<span class="keyword">int</span> *L, <span class="keyword">int</span> blank_l, <span class="keyword">int</span> lenth)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; blank_l; i++)</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"  "</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; lenth; i++)</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%4d"</span>, L[i]); </span><br><span class="line">	</span><br><span class="line">	<span class="built_in">putchar</span>(<span class="number">10</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">char</span> *<span class="title">translate</span><span class="params">(<span class="keyword">int</span> *L, <span class="keyword">int</span> lenth)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">char</span> *p = (<span class="keyword">char</span> *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">char</span>)*<span class="number">100</span>), temp[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">memset</span>(p, <span class="number">0</span>, <span class="keyword">sizeof</span>(<span class="keyword">char</span>));</span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; lenth; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">sprintf</span>(temp, <span class="string">"%d"</span>, L[i]);</span><br><span class="line">		<span class="built_in">strcat</span>(p, temp); </span><br><span class="line">	&#125; </span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> p;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> n = <span class="number">0</span>, i = <span class="number">0</span>, *p = <span class="literal">NULL</span>;</span><br><span class="line">	<span class="keyword">char</span> a[<span class="number">1000</span>] = &#123;<span class="number">0</span>&#125;; </span><br><span class="line">	</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"è¯·è¾“å…¥è¡Œæ•°: "</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		p = creat(p, i);</span><br><span class="line">		<span class="built_in">print</span>(p, n-i, i+<span class="number">1</span>);</span><br><span class="line">		<span class="built_in">strcat</span>(a, (<span class="keyword">char</span> *)translate(p, i+<span class="number">1</span>));</span><br><span class="line">	&#125; </span><br><span class="line">	</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"\næ‰€æœ‰æ•°å€¼ç»„æˆçš„å­—ç¬¦ä¸²ä¸º: %s"</span>, a); </span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ€»ç»“: åœ¨çœ‹ä¸æ‡‚ä»£ç çš„æ—¶å€™, åº”è¯¥æŠŠèƒ½å†™å‡ºæ¥çš„å€¼éƒ½åˆ—ä¸¾å‡ºæ¥, è§‚å¯Ÿä¸€ä¸‹è§„å¾‹.</strong></p><h3 id="SignIn"><a href="#SignIn" class="headerlink" title="SignIn"></a>SignIn</h3><p>è¿™é“é¢˜æ›´åƒæ˜¯æ˜¯cryptoçš„é¢˜, åˆæ¬¡äº†è§£äº†ä¸‹Rsa.</p><p>ç¨‹åºä¸‹è½½ä¸‹æ¥, æœ‰ä¸€ç³»åˆ—ä¸è®¤è¯†çš„å‡½æ•°, å¤§æ¦‚çŸ¥é“ç”¨æ³•, è¿˜æ˜¯å…ˆå–æŸ¥äº†æŸ¥.<img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200503094008020-1590490467616-1591162454456.png" alt="image-20200503094008020-1590490467616"></p><p>GMP(The GNU Multiple Precision Arithmetic Library)åˆå«GNUå¤šç²¾åº¦ç®—æœ¯åº“ï¼Œæ˜¯ä¸€ä¸ªæä¾›äº†å¾ˆå¤šæ“ä½œé«˜ç²¾åº¦çš„å¤§æ•´æ•°ï¼Œæµ®ç‚¹æ•°çš„è¿ç®—çš„ç®—æœ¯åº“ï¼Œå‡ ä¹æ²¡æœ‰ä»€ä¹ˆç²¾åº¦æ–¹é¢çš„é™åˆ¶ï¼ŒåŠŸèƒ½ä¸°å¯Œ. å‡ ä¸ªå¸¸ç”¨çš„:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">æ·»åŠ å¤´æ–‡ä»¶ï¼š<span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;gmp.h&gt; </span></span></span><br><span class="line"></span><br><span class="line">ã€€ã€€cmdç¼–è¯‘å‘½ä»¤ï¼šgcc myprogram.c -lgmp -lm -o myprogram</span><br><span class="line"></span><br><span class="line">ã€€ã€€å£°æ˜ä¸€ä¸ªgmpçš„æ•´æ•°rop ï¼š<span class="keyword">mpz_t</span> rop;</span><br><span class="line"></span><br><span class="line">ã€€ã€€æŠŠå­—ç¬¦ä¸²åˆå§‹åŒ–ä¸ºgmpå¤§æ•´æ•°ï¼š<span class="function"><span class="keyword">int</span> <span class="title">mpz_init_set_str</span><span class="params">(<span class="keyword">mpz_t</span> rop, <span class="keyword">char</span>*str, <span class="keyword">int</span> base)</span></span>; </span><br><span class="line"></span><br><span class="line">ã€€ã€€é‡Šæ”¾ç©ºé—´ï¼š<span class="function"><span class="keyword">void</span>  <span class="title">mpz_clear</span><span class="params">(<span class="keyword">mpz_t</span> rop)</span></span>;<span class="comment">//å£°æ˜äº†ä¸€ä¸ªå˜é‡ï¼Œåœ¨ç¨‹åºçš„æœ€åä¸€å®šè¦é‡Šæ”¾ï¼Œä¸ç„¶ä¼šæŠ¥é”™</span></span><br><span class="line"></span><br><span class="line">ã€€ã€€åŠ æ³•ï¼š<span class="function"><span class="keyword">void</span> <span class="title">mpz_add</span><span class="params">(<span class="keyword">mpz_t</span> rop, <span class="keyword">mpz_t</span> op1, <span class="keyword">mpz_t</span> op2)</span></span>;  <span class="comment">//rop = op1 + op2</span></span><br><span class="line"></span><br><span class="line">ã€€ã€€å‡æ³•ï¼š<span class="function"><span class="keyword">void</span> <span class="title">mpz_sub</span><span class="params">(<span class="keyword">mpz_t</span> rop, <span class="keyword">mpz_t</span> op1, <span class="keyword">mpz_t</span> op2)</span></span>;  <span class="comment">//rop = op1 - op2</span></span><br><span class="line"></span><br><span class="line">ã€€ã€€ä¹˜æ³•ï¼š<span class="function"><span class="keyword">void</span> <span class="title">mpz_mul</span><span class="params">(<span class="keyword">mpz_t</span> rop, <span class="keyword">mpz_t</span> op1, <span class="keyword">mpz_t</span> op2)</span></span>; <span class="comment">//rop = op1 * op2</span></span><br><span class="line"></span><br><span class="line">ã€€ã€€é™¤æ³•ï¼š<span class="function"><span class="keyword">void</span> <span class="title">mpz_cdiv_q</span> <span class="params">(<span class="keyword">mpz_t</span> q, <span class="keyword">mpz_t</span> n, <span class="keyword">mpz_t</span> d)</span></span>;  <span class="comment">//q = n/d,è¿™ä¸ªæœ‰å¾ˆå¤šç§ç±»å‹ï¼Œå…·ä½“çš„çœ‹ä½¿ç”¨æ‰‹å†Œ</span></span><br><span class="line"></span><br><span class="line">ã€€ã€€å¹‚è¿ç®—ï¼š<span class="function"><span class="keyword">void</span> <span class="title">mpz_pow_ui</span> <span class="params">(<span class="keyword">mpz_t</span> rop, <span class="keyword">mpz_t</span> base, <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">int</span> <span class="built_in">exp</span>)</span></span>;  <span class="comment">//rop = base^exp</span></span><br><span class="line">		  void mpz_powm (mpz_t rop, const mpz_t base, const mpz_t exp, const mpz_t mod)  ä½œç”¨: Set rop to base^exp mod mod. è¿™æ˜¯è¿™é“é¢˜ä¸­ç”¨åˆ°çš„. ä¹Ÿæ˜¯rsaåŠ å¯†è§£å¯†å¸¸ç”¨çš„.</span><br><span class="line">          </span><br><span class="line"></span><br><span class="line">ã€€ã€€å¼€æ–¹ï¼š<span class="function"><span class="keyword">void</span> <span class="title">mpz_sqrt</span> <span class="params">(<span class="keyword">mpz_t</span> rop, <span class="keyword">mpz_t</span> op)</span></span>; <span class="comment">//rop = opå¼€æ–¹çš„å‘ä¸‹å–æ•´</span></span><br></pre></td></tr></table></figure><p>æ•´ä¸ªæµç¨‹, æ˜¾ç„¶æ˜¯rsaåŠ å¯†.</p><table><thead><tr><th align="center">æ­¥éª¤</th><th>è¯´æ˜</th><th>æè¿°</th><th>å¤‡æ³¨</th></tr></thead><tbody><tr><td align="center">1</td><td>æ‰¾å‡ºè´¨æ•°</td><td>P ã€Q</td><td>-</td></tr><tr><td align="center">2</td><td>è®¡ç®—å…¬å…±æ¨¡æ•°</td><td>N = P * Q</td><td>-</td></tr><tr><td align="center">3</td><td>æ¬§æ‹‰å‡½æ•°</td><td>Ï†(N) = (P-1)(Q-1)</td><td>-</td></tr><tr><td align="center">4</td><td>è®¡ç®—å…¬é’¥E</td><td>1 &lt; E &lt; Ï†(N)</td><td>Eçš„å–å€¼å¿…é¡»æ˜¯æ•´æ•° E å’Œ Ï†(N) å¿…é¡»æ˜¯äº’è´¨æ•°</td></tr><tr><td align="center">5</td><td>è®¡ç®—ç§é’¥D</td><td>E * D % Ï†(N) = 1</td><td>-</td></tr><tr><td align="center">6</td><td>åŠ å¯†</td><td>C ï¼ M ^E mod N</td><td>Cï¼šå¯†æ–‡ Mï¼šæ˜æ–‡</td></tr><tr><td align="center">7</td><td>è§£å¯†</td><td>M ï¼C ^D mod N</td><td>Cï¼šå¯†æ–‡ Mï¼šæ˜æ–‡</td></tr></tbody></table><p>ä½†æ˜¯ä¹‹å‰æœ‰ä¸€ä¸ªsub_96Aå‡½æ•°.(æœ€ä¸Šé¢çš„ç®­å¤´æ‰€ç¤º), ç°åœ¨è¿›å…¥è¿™ä¸ªå‡½æ•°çœ‹çœ‹. è¿™é‡Œæ˜¯ä»å­—ç¬¦çš„ASCIIè½¬åŒ–ä¸º16è¿›åˆ¶, <strong>(æœ€ä¸Šé¢çš„ Windows_Reverse2æœ‰ä» 16è¿›åˆ¶è½¬åŒ–ä¸ºå­—ç¬¦çš„ç®—æ³•, éƒ½æŒºç®€æ´çš„)</strong><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200503094306385-1590490481485-1591162474450.png" alt="image-20200503094306385-1590490481485"></p><p>æ•´ä¸ªç¨‹åºå°±æ˜¯å°†æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦, å…ˆè½¬åŒ–ä¸º16è¿›åˆ¶æ•°å€¼å­—ç¬¦, å†å˜æˆä¸€ä¸ªå¤§æ•°ä½œä¸ºæ˜æ–‡. ç»è¿‡ <strong>C ï¼ M ^E mod N</strong>, åŠ å¯†åå’Œç¼–ç çš„å¯†æ–‡è¿›è¡Œå¯¹æ¯”. é¦–å…ˆè¿™é‡Œçš„ E = v5 = 65537. Mæ˜¯æ˜æ–‡. N = v4 = 103461035900816914121390101299049044413950405173712170434161686539878160984549. æ ¹æ®è§£å¯†è¿‡ç¨‹, æˆ‘ä»¬å…ˆæŠŠ N åˆ†è§£æˆ p q , å¯ä»¥å»åœ¨çº¿åˆ†è§£.<img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200503095605681-1590490490248-1591162483535.png" alt="image-20200503095605681-1590490490248"></p><p>ç„¶åä½¿ç”¨ pythonçš„gmpy2åº“å…ˆæ±‚é€†å…ƒå¾—åˆ°<strong>D</strong>. æœ€åç”¨ <strong>M ï¼C ^D mod N</strong> è§£å¯†å¹¶ä»16è¿›åˆ¶è½¬åŒ–ä¸ºå­—ç¬¦. è¿™ä¸ªgmpy2çš„åº“çš„å®‰è£…è¿˜è´¹äº†äº›æ—¶é—´..ğŸ¤£ <strong>exp:</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">p = <span class="number">282164587459512124844245113950593348271</span></span><br><span class="line">q = <span class="number">366669102002966856876605669837014229419</span></span><br><span class="line">N = <span class="number">103461035900816914121390101299049044413950405173712170434161686539878160984549</span></span><br><span class="line">c = <span class="number">0xad939ff59f6e70bcbfad406f2494993757eee98b91bc244184a377520d06fc35</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">d = gmpy2.invert(e, (p<span class="number">-1</span>)*(q<span class="number">-1</span>))</span><br><span class="line">m = gmpy2.powmod(c, d, p*q)</span><br><span class="line"></span><br><span class="line">print(bytes.fromhex(hex(m)[<span class="number">2</span>:])</span><br></pre></td></tr></table></figure><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200503101307822-1590490496701-1591162599070.png" alt="image-20200503101307822-1590490496701"></p><p><strong>æ€»ç»“: (1)å¯¹rsaæœ‰äº†åˆæ­¥çš„äº†è§£, å­¦ä¼šäº†ç®€å•çš„åŠ å¯†è§£å¯†æ–¹æ³•. (2)GMPç®—æ•°åº“çš„è®¤è¯†. (3)å­—ç¬¦çš„ASCIIè½¬16è¿›åˆ¶çš„ç®€æ´ç®—æ³•.</strong></p><h3 id="BabyXor"><a href="#BabyXor" class="headerlink" title="BabyXor"></a>BabyXor</h3><p>é¦–å…ˆ, æ˜æ˜å¯ä»¥ç›´æ¥ODåŠ¨æ€è°ƒè¯•, å¾ˆå¿«å¾—åˆ°flag. ä½†æ˜¯æˆ‘ç”¨idaæŠŠé¢˜åšå®Œ, æ‰ä¸€ä¸‹å­æƒ³èµ·.ğŸ¤£</p><p>å‘ç°æœ‰å£³, è½½å…¥ODä½¿ç”¨å †æ ˆå¹³è¡¡è„±å£³. è½½å…¥ida, å‘ç°mainå‡½æ•°é‡Œæœ‰å¾ˆå¤šå‡½æ•°, ä¸Šä¸‹åˆ†æäº†ä¸‹, å‘ç°éƒ½æ˜¯å¹²æ‰°çš„å‡½æ•°. <img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200503173759296-1590490519677-1591162520630.png" alt="image-20200503173759296-1590490519677"></p><p>ç¡®å®šç›®æ ‡, å°±æ˜¯é€šè¿‡è¿™å‡ ä¸ªå‡½æ•°ä»ç¼–ç çš„æ•°æ®ä¸­å–å‡ºå­—ç¬¦ç»è¿‡ä¸€äº›ç®€å•çš„å¼‚æˆ–è¿ç®—, å­˜æ”¾å†ä¸€ä¸ªå†…å­˜ç©ºé—´. ä½†æ˜¯ä¸æˆ‘ä»¬è¾“å…¥æ•°æ®æ²¡æœ‰å…³ç³». (è¿™æ—¶å€™, å°±å¯ä»¥ç›´æ¥å–ODåŠ¨æ€è°ƒè¯•ç›´æ¥å¾—åˆ°flagçš„, å”‰, æˆ‘ç®—å‡ºæ¥æ‰æƒ³èµ·)</p><p>ä¸€ä¸ªç–‘é—®çš„åœ°æ–¹<img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200503174247305-1590490527077-1591162527371.png" alt="image-20200503174247305-1590490527077"></p><p>ç„¶åçœ‹äº†çœ‹æ±‡ç¼–ä»£ç . è¿˜æ˜¯ä¸æ¸…æ¥š. <img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200503174332262-1590490532558-1591162533239.png" alt="image-20200503174332262-1590490532558"></p><p>è¿›å»ODè°ƒè¯•çœ‹çœ‹.å‘ç°ä»£ç åˆæ˜¯ä¸€ä¸ªæ ·. ä¸è¿‡è¿™ä¸‹å°±æ¸…æ¥šäº†. å…ˆå–åœ°å€çš„å€¼. <strong>è®°ä½è¿™ç‚¹</strong><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200503174534451-1590490539636-1591162540789.png" alt="image-20200503174534451-1590490539636"></p><p>è§£é¢˜è„šæœ¬ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">union</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">unsigned</span> <span class="keyword">char</span> ida_chars[<span class="number">56</span>];</span><br><span class="line">		<span class="keyword">int</span> a[<span class="number">14</span>];</span><br><span class="line">	&#125;A = &#123;</span><br><span class="line">  			<span class="number">102</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">109</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">99</span>,   <span class="number">0</span>, </span><br><span class="line">   			<span class="number">0</span>,   <span class="number">0</span>, <span class="number">100</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   			<span class="number">55</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">53</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">48</span>,   <span class="number">0</span>, </span><br><span class="line">    		<span class="number">0</span>,   <span class="number">0</span>,  <span class="number">48</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">107</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   			<span class="number">58</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">60</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">59</span>,   <span class="number">0</span>, </span><br><span class="line">    		<span class="number">0</span>,   <span class="number">0</span>,  <span class="number">32</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span></span><br><span class="line">			&#125;;</span><br><span class="line">			</span><br><span class="line">	<span class="keyword">union</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">unsigned</span> <span class="keyword">char</span> ida[<span class="number">56</span>];</span><br><span class="line">		<span class="keyword">int</span> a[<span class="number">14</span>];</span><br><span class="line">	&#125; B = &#123;</span><br><span class="line">   			<span class="number">55</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">111</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">56</span>,   <span class="number">0</span>, </span><br><span class="line">    		<span class="number">0</span>,   <span class="number">0</span>,  <span class="number">98</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">54</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">  			<span class="number">124</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">55</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">51</span>,   <span class="number">0</span>, </span><br><span class="line">   			 <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">52</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">118</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   			<span class="number">51</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">98</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">100</span>,   <span class="number">0</span>, </span><br><span class="line">    		<span class="number">0</span>,   <span class="number">0</span>, <span class="number">122</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span></span><br><span class="line">			&#125;;</span><br><span class="line">			</span><br><span class="line">	<span class="keyword">union</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">unsigned</span> <span class="keyword">char</span> ida_[<span class="number">56</span>];</span><br><span class="line">		<span class="keyword">int</span> a[<span class="number">14</span>];</span><br><span class="line">	&#125;C = &#123;</span><br><span class="line">   			<span class="number">26</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    		<span class="number">0</span>,   <span class="number">0</span>,  <span class="number">81</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">5</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   			<span class="number">17</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">84</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">86</span>,   <span class="number">0</span>, </span><br><span class="line">    		<span class="number">0</span>,   <span class="number">0</span>,  <span class="number">85</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">89</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   			<span class="number">29</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">9</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">93</span>,   <span class="number">0</span>, </span><br><span class="line">    		<span class="number">0</span>,   <span class="number">0</span>,  <span class="number">18</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span></span><br><span class="line">			&#125;; </span><br><span class="line">	<span class="keyword">char</span> f1[<span class="number">14</span>] = &#123;<span class="number">0</span>&#125;, f2[<span class="number">14</span>] = &#123;<span class="number">0</span>&#125;, f3[<span class="number">14</span>] = &#123;<span class="number">0</span>&#125;, ftemp[<span class="number">14</span>] = &#123;<span class="number">0</span>&#125;, temp = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">char</span> flag[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">	<span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">14</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		f1[i] = A.a[i] ^ i; </span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	f2[<span class="number">0</span>] = B.a[<span class="number">0</span>];</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">1</span>; i &lt; <span class="number">14</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		f2[i] = A.a[i] ^ B.a[i] ^ A.a[i<span class="number">-1</span>]; </span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">13</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		temp = C.a[i+<span class="number">1</span>] ^ f2[i]; </span><br><span class="line">		ftemp[i] = temp ^ i;  </span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	f3[<span class="number">0</span>] = <span class="number">0x2D</span>;</span><br><span class="line">	<span class="built_in">strcat</span>(f3, ftemp);		</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">strcat</span>(flag, f1);</span><br><span class="line">	<span class="built_in">strcat</span>(flag, f2);</span><br><span class="line">	<span class="built_in">strcat</span>(flag, f3);</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">puts</span>(flag); </span><br><span class="line">	</span><br><span class="line">	 <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200503174824411-1590490553835-1591162556782.png" alt="image-20200503174824411-1590490553835"></p><p>ä¸‹é¢è¯´ä¸€æ­¥åˆ°ä½.æ‰¾åˆ°æœ€åä¸€ä¸ªå‡½æ•°æœ€åèµ‹å€¼ä»£ç çš„åœ°å€. å¤åˆ¶ä¸‹æ¥<img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200503175027583-1590490558591-1591162567556.png" alt="image-20200503175027583-1590490558591"></p><p>è¿›å»OD, è·³åˆ°è¿™ä¸ªåœ°å€ä¸‹æ–­ç‚¹, è¿è¡Œèµ·æ¥. çœ‹æ•°æ®çª—å£. <img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200503175154926-1590490566331-1591162575032.png" alt="image-20200503175154926-1590490566331"></p><p><strong>æ€»ç»“: (1)æ³¨æ„è¿™ç§flagå’Œè¾“å…¥å­—ç¬¦æ— å…³çš„çš„é¢˜. (2)è¿™é‡Œ idaä¸­çš„å†…å­˜å–å€¼ä¸ODä¸­çš„å·®å¼‚.</strong></p><h3 id="easy-Maze"><a href="#easy-Maze" class="headerlink" title="easy_Maze"></a>easy_Maze</h3><p>è¿™é“é¢˜å¯¹æ–°æ‰‹è¿˜æ˜¯å¾ˆå¥½.</p><p>ç”±é¢˜ç›®æˆ‘ä»¬èƒ½çŸ¥é“æ˜¯å…³äºè¿·å®«çš„é¢˜. ä¸‹è½½ä¸‹æ¥æ˜¯elfæ–‡ä»¶, æŸ¥å£³åæ— å£³, åœ¨linuxä¸‹è¿è¡Œçœ‹çœ‹å¤§æ¦‚æµç¨‹.</p><p>è½½å…¥IDA, å…ˆåˆ†æäº†æ¥å—æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦çš„å‡½æ•°. çŸ¥é“åœ¨å¤–é¢ä¸€å±‚çš„ä¸»å‡½æ•°æ˜¯å…ˆç”Ÿæˆä¸€ä¸ªæ¯è¡Œ7ä¸ªå…ƒç´ çš„æ•°ç»„. ç„¶åé€šè¿‡æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦æŒ‰æ§åˆ¶åœ¨çŸ©é˜µè¿·å®«ä¸­èµ°å‘, æœ€åæŒ‰ç…§è§„å®šçš„åˆ°è¾¾ä¸€ä¸ªç›®çš„åœ°.<img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200504133456542-1592290152904.png" alt="image-20200504133456542"></p><p>æ¥ä¸‹æ¥è¿”å›å¤–ä¾§çš„ä¸»å‡½æ•°, å°±æ˜¯ç”ŸæˆçŸ©é˜µçš„äº†. é€šè¿‡ä¸Šé¢çš„49ä¸ªå…ƒç´ çŸ¥é“ä¸”ä¸‹é¢å‡½æ•°çš„å‚æ•°7, çŸ¥é“è§„æ¨¡ 7*7. <img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200504133948097-1592290160103.png" alt="image-20200504133948097"></p><p>è¿›å…¥<strong>Step_0</strong> çœ‹çœ‹. å°±æ˜¯ç®€å•çš„æŠŠä¸Šé¢49ä¸ªå…ƒç´ èµ‹å€¼ç»™ v7 æ•°ç»„, ä¹Ÿå°è¯äº†æ•°ç»„æ˜¯7*7</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200506194728611-1592290641234.png" alt="image-20200506194728611"></p><p>æ¥ä¸‹æ¥ <strong>Step_1</strong>, çœ‹èµ·æ¥æ˜¯å¾ˆç®€æ´, ä½†é‡Œé¢çš„ <strong>getA</strong>ä¸ <strong>getAstart</strong> å‡½æ•° ç®—æ³•å¤ªå†—é•¿äº†.</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200506195403856-1592290472100.png" alt="image-20200506195403856"></p><p>è¿™ä¸ªæ—¶å€™, å¼€å§‹æˆ‘å°±æŠŠç”ŸæˆçŸ©é˜µçš„æ‰€æœ‰å‡½æ•°åŠæ•°æ®éƒ½å¤åˆ¶åˆ°<strong>VC</strong> ç¼–è¯‘å™¨ä¸­, å†æ ¹æ®æ ˆçš„ç‰¹ç‚¹æ”¹ä¸‹æ•°æ®çš„é¡ºåº(<strong>æ•°æ®å­˜æ”¾æ˜¯ä»ä¸‹å¾€ä¸Š, é‚£ä¹ˆæˆ‘ä»¬å–æ•°æ®æ—¶åœ°å€æ¯æ¬¡å‡1è€Œä¸æ˜¯åŠ ä¸€</strong>), ç„¶åè¿è¡Œæ‰“å°å‡ºçŸ©é˜µ. é—®é¢˜æ˜¯è¿è¡Œåä»€ä¹ˆä¹Ÿæ²¡æœ‰æ‰“å°, è°ƒè¯•å‘ç°ä¸€ä¸ªå‡½æ•°ä¸­çš„å†…å­˜ç©ºé—´å’Œå¦å¤–ä¸€ä¸ªå†²çª, ç›¸äº’è¦†ç›–å€¼. è¿™ä¸ªå‡½æ•°å¤ªå¤š,å…³è”æ€§å¤§, æ”¹èµ·æ¥ä¹Ÿéº»çƒ¦.</p><p>ç„¶åè½¬å‘GDBè°ƒè¯•, ä½†æ˜¯ä¸ç†Ÿç»ƒ. åˆè½¬å‘idaåŠ¨æ€è°ƒè¯•. é¦–å…ˆ<strong>åœ¨ IDA çš„å®‰è£…ç›®å½•/dbgsrc/æ‰¾åˆ° linux_server å’Œ linux_server64 æ‹·è´åˆ° linux</strong> ,åœ¨linuxä¸­è¿è¡Œ <strong>linux_server64</strong>, ç„¶ååœ¨Debuggerçš„ process options å¦‚ä¸‹å›¾æ ¼å¼é…ç½®. ç„¶åF9å¼€å§‹.</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200506202545180-1592290263125.png" alt="image-20200506202545180"></p><p>å…ˆä¸‹æ–­ç‚¹, æ‰¾åˆ°å‚¨å­˜çŸ©é˜µçš„ç©ºé—´çš„åœ°å€, æŠŠè¿™ä¸ªåœ°å€è½¬åˆ°æ•°æ®çª—å£è·Ÿéš, ç„¶åè¿è¡Œåˆ°ç”ŸæˆçŸ©é˜µçš„ä¸‹é¢ä¸€ä¸ªå‡½æ•°(ä¹Ÿå°±æ˜¯(<strong>Step_1</strong>ä¸‹é¢). åœ¨æ•°æ®çª—å£å‡ºç°æˆ‘ä»¬çš„æ•°æ®(intå‹), ç”±äºæ˜¯49ä¸ªå…ƒç´ , 49*4/16 = 12 â€¦4 ,é‚£å°±æ˜¯12è¡ŒåŠ 4ä¸ªæ•°æ®, <strong>shift+E</strong>æå–å‡ºCè¯­è¨€æ ¼å¼çš„æ•°æ®.<img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200504135411101-1592290168306.png" alt="image-20200504135411101"></p><p>æ•°æ®å¾—åˆ°å, ç”¨Cè¯­è¨€æ‰“å°å‡ºæ¥å¥½è§‚å¯Ÿ, æ³¨æ„æ¯ä¸ªæ•°æ®4ä¸ªå­—èŠ‚(å°ç«¯).</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">union</span> 	<span class="comment">//æ¯ä¸ªæ•°æ®4ä¸ªå­—èŠ‚, ä¸”å°ç«¯. ç”¨è”åˆ</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">unsigned</span> <span class="keyword">char</span> ida_chars[<span class="number">196</span>];</span><br><span class="line">		<span class="keyword">int</span> a[<span class="number">49</span>];</span><br><span class="line">	&#125;A = &#123;</span><br><span class="line">    		<span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    		<span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    		<span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line">    		<span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    		<span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    		<span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    		<span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    		<span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    		<span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    		<span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    		<span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    		<span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    		<span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    		<span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    		<span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    		<span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    		<span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line">    		<span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    		<span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    		<span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span></span><br><span class="line">		&#125;;</span><br><span class="line">	<span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> (*p)[<span class="number">7</span>] = (<span class="keyword">int</span> (*)[<span class="number">7</span>])A.a;  <span class="comment">// å¼ºåˆ¶è½¬åŒ–ä¸ºæ•°ç»„æŒ‡é’ˆ, æ–¹ä¾¿åé¢æ‰“å°</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">7</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">7</span>; j++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"%d "</span>, p[i][j]);</span><br><span class="line">		&#125; </span><br><span class="line">		<span class="built_in">putchar</span>(<span class="number">10</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	 </span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	 </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200506201841271-1592290342688.png" alt="image-20200506201841271"></p><p>æ ¹æ®æˆ‘ä»¬æ‰“æ¸¸æˆçš„ç†Ÿæ‚‰ aswd ,æœç€1èµ°åˆ°æœ€å. <strong>ssddwdwdddsssaasasaaassddddwdds</strong> æœ€ååœ¨linuxä¸‹è¾“å…¥.</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200504140433640-1592290514404.png" alt="image-20200504140433640"></p><p><strong>æ€»ç»“: æ›´åŠ ç†Ÿæ‚‰äº†linuxåŠ¨æ€è°ƒè¯•çš„è¿ç”¨, åŠ æ·±äº†æ•°ç»„æŒ‡é’ˆçš„ç†è§£.</strong></p><h3 id="simple-check-100"><a href="#simple-check-100" class="headerlink" title="simple-check-100"></a>simple-check-100</h3><p>é¢˜ç›®æœ¬æ¥å¾ˆç®€å•, ä½†æ˜¯æœ‰å‘å•Šâ€¦</p><p>é¦–å…ˆ, é¢˜ç›®ä¸‹è½½ä¸‹æ¥, æœ‰ä¸‰ä¸ªç‰ˆæœ¬. ä¸‹æ„è¯†çš„é€‰æ‹©äº†ç†Ÿæ‚‰çš„.exeæ¥åˆ†æ.</p><p>æŸ¥å£³æ— å£³, ç”¨idaæ‰“å¼€. ç¬¬ä¸€ç›´è§‰å°±æ˜¯è¿™ä¸ªæœ€åçš„flagä¸æˆ‘ä»¬è¾“å…¥å­—ç¬¦æ²¡å…³ç³», ç›´æ¥ODåŠ¨æ€è°ƒè¯•è·³è¿‡åˆ¤æ–­æ¡ä»¶å°±å¥½äº†.</p><p>è¿˜æ˜¯å…ˆç»†çœ‹ä¸€ä¸‹æ ˆç©ºé—´, è™½ç„¶è¿˜æ˜¯å’Œæˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦æ²¡æœ‰å…³ç³». ä½†æ˜¯æœ‰é—®é¢˜å•Š,è¦ç”¨çš„åœ°å€äº¤å‰äº†. æƒ³ç€ä¸‡ä¸€é¢˜å°±æ˜¯è¿™æ ·å‘¢, å…ˆå–ODè¯•ä¸€ä¸‹. ä¸å‡ºæ‰€æ–™, ä¹±ç ğŸ˜¢</p><p>å¼€å§‹ä»”ç»†åˆ†æä¸‹è¿™ä¸ªé¢˜çš„æ ˆç©ºé—´, åœ¨ODåå¤è°ƒè¯•, å‘ç°æˆ‘ä»¬è¾“å…¥å­—ç¬¦çš„ç©ºé—´åªæœ‰19ä¸ªå­—èŠ‚å•Š, ä¸ºä»€ä¹ˆæˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦æ ˆç©ºé—´åœ¨ODä¸­è°ƒè¯•æœ‰19+32 = 51å­—èŠ‚ç©ºé—´.</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200506144401943-1592290592390.png" alt="image-20200506144401943"></p><p>çœ‹äº†åŠå¤©ä¸çŸ¥é“ä¸ºä»€ä¹ˆ, åé¢æ‰çœ‹è§ç¨‹åºä¸‹é¢æœ‰ <strong>v3 = alloca(32);</strong> ç™¾åº¦äº†ä¸€ä¸‹, è¿™ä¸ªæ˜¯å†æ ˆä¸Šç”³è¯·ç©ºé—´çš„å‡½æ•°. æ­£å¥½æ˜¯å¤šå‡ºæ¥çš„32.</p><p>ç»è¿‡åå¤è°ƒè¯•, è¿™ä¸ªé¢˜æ€ä¹ˆä¹Ÿå’Œæˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦æ²¡å…³ç³»å•Š, ç¨‹åºæ¯æ¬¡è¿‡äº†åˆ¤æ–­æ¡ä»¶, ç®—çš„éƒ½ä¸€æ ·. çœŸçš„å¥‡æ€ªäº†.</p><p>æœ€åæ²¡åŠæ³•äº†,æƒ³ä¸é€š. å°±æœ€åå†æŠŠæ–‡ä»¶ä¸­è¿™ä¸ªç¨‹åºçš„linuxç‰ˆæœ¬è½½å…¥idaçœ‹çœ‹, å—¯â€¦.è¿™ä¸ªç‰ˆæœ¬çš„æ ˆç©ºé—´å°±æ²¡æœ‰äº¤å‰. v7ä¸€ç›´åˆ°v34, æ²¡æœ‰åƒPEæ–‡ä»¶é‚£ä¸ªç‰ˆæœ¬åœ¨ä¸­é—´å¤šä¸€ä¸ªæŒ‡é’ˆ.<img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200506145151730-1592290606770.png" alt="image-20200506145151730"></p><p>åœ¨linuxä¸‹åŠ¨æ€è°ƒè¯•.<img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200506145627945-1592290617965.png" alt="image-20200506145627945"></p><p>ğŸ˜‚ä»€ä¹ˆé¬¼é¢˜. PEæ–‡ä»¶ç‰ˆæœ¬å±…ç„¶æ˜¯æœ‰é—®é¢˜çš„!!!</p><p><strong>æ€»ç»“: æ–‡ä»¶æœ‰å¤šä¸ªç‰ˆæœ¬çš„æ—¶å€™, æ³¨æ„!!! å¼ è§è¯†äº†. è™½ç„¶å¤šèŠ±äº†æ—¶é—´åœ¨PEä¸Šè€—, ä½†æ˜¯å¯¹æ ˆæ›´æ¸…æ¥šäº†.</strong></p><hr><h3 id="zorropub"><a href="#zorropub" class="headerlink" title="zorropub"></a>zorropub</h3><p>æŸ¥å£³æŸ¥ä½æ•°åè½½å…¥ida, æ•´ä½“æ€è·¯å¦‚ä¸‹.<img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200508104152981-1592290667231.png" alt="image-20200508104152981"></p><p>é‚£å…¶å®æˆ‘ä»¬æ˜¯ä¸ç”¨ç®¡è¿™ä¸ª MD5 åŠ å¯†çš„ , ä¹Ÿä¸ä¼šè¿™ä¸ªè§£å¯†. ç›´æ¥çˆ†ç ´æ‰¾åˆ° <strong>i</strong> å€¼ä»è€Œå¾—åˆ°éšæœºæ•°ç§å­.</p><p>é‚£é—®é¢˜æ¥äº†, çˆ†ç ´æ‰¾äº†ä¸€ä¸ª <strong>i</strong> å€¼æ˜¯1023, å°±åœ¨linuxå†™äº†exp(<strong>ä¸èƒ½åœ¨windowä¸‹, å› ä¸ºç”Ÿæˆéšæœºæ•°ä¸åŒ</strong>). ä½†å¾—åˆ°çš„æ•°æ®éƒ½æ˜¯ä¹±ç çš„, æˆ‘è¿˜æ˜¯ä¸€ç›´ä»¥ä¸ºé—®é¢˜å‡ºç°åœ¨ <strong>LOBYTE(å–æœ€ä½å­—èŠ‚ä½)</strong> å› ä¸ºç¬¬ä¸€æ¬¡æ¥è§¦.</p><p>æœ€åæ‰æƒ³èµ·é‚£ä¸ª <strong>i</strong> çš„å€¼, å®ƒå¯èƒ½ä¸æ˜¯å”¯ä¸€çš„. å¼€å§‹å†™exp, å–å¤§èŒƒå›´çš„æ•°æ®çˆ†ç ´, æœç„¶å¯¹äº†â€¦â€¦</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> *c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> b = <span class="number">0</span>, f = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">char</span> flag[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">	srand(a);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">29</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">                b = rand()%<span class="number">1000</span>;</span><br><span class="line">                flag[i] = b^c[<span class="number">4</span>*i];</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(flag[i] &gt; <span class="number">126</span> || flag[i] &lt; <span class="number">32</span>)</span><br><span class="line">		f = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!f)</span><br><span class="line">	<span class="built_in">puts</span>(flag);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i = <span class="number">0</span>, b = <span class="number">0</span>, j = <span class="number">0</span>, cnt = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> a[<span class="number">1000</span>] = &#123;</span><br><span class="line">  		<span class="number">200</span>,   <span class="number">3</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">50</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">206</span>,   <span class="number">2</span>,</span><br><span class="line">    		<span class="number">0</span>,   <span class="number">0</span>,   <span class="number">2</span>,   <span class="number">3</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,</span><br><span class="line">  		<span class="number">184</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">126</span>,   <span class="number">3</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">136</span>,   <span class="number">1</span>,</span><br><span class="line">    		<span class="number">0</span>,   <span class="number">0</span>,  <span class="number">73</span>,   <span class="number">3</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">127</span>,   <span class="number">2</span>,   <span class="number">0</span>,   <span class="number">0</span>,</span><br><span class="line">   		<span class="number">94</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">52</span>,   <span class="number">2</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">84</span>,   <span class="number">3</span>,</span><br><span class="line">    		<span class="number">0</span>,   <span class="number">0</span>, <span class="number">163</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">150</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,</span><br><span class="line">   		<span class="number">64</span>,   <span class="number">3</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">40</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">252</span>,   <span class="number">2</span>,</span><br><span class="line">   		<span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">3</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">142</span>,   <span class="number">2</span>,   <span class="number">0</span>,   <span class="number">0</span>,</span><br><span class="line">   		<span class="number">38</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">27</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">42</span>,   <span class="number">3</span>,</span><br><span class="line">    		<span class="number">0</span>,   <span class="number">0</span>, <span class="number">245</span>,   <span class="number">2</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">95</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,</span><br><span class="line">  		<span class="number">104</span>,   <span class="number">3</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">235</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>, <span class="number">121</span>,   <span class="number">0</span>,</span><br><span class="line">    		<span class="number">0</span>,   <span class="number">0</span>,  <span class="number">29</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">78</span>,   <span class="number">2</span>,   <span class="number">0</span>,   <span class="number">0</span></span><br><span class="line">			&#125;;</span><br><span class="line">	<span class="keyword">char</span> flag[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">100000</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		j = i;</span><br><span class="line">		<span class="keyword">while</span>(j)</span><br><span class="line">		&#123;</span><br><span class="line">			cnt++;</span><br><span class="line">			j &amp;= j<span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(cnt &gt; <span class="number">10</span>)</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(cnt == <span class="number">10</span>)</span><br><span class="line">		func(i,  a);</span><br><span class="line"></span><br><span class="line">		cnt = <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200508105155224-1592290710459.png" alt="image-20200508105155224"></p><p>ç„¶ååšå®Œ, è¿˜æ˜¯å»çœ‹çœ‹å¤§ä½¬çš„writeup. æƒ³çœ‹çœ‹é‚£ä¸ªmd5æ€è§£å¯†, ä½†æ˜¯æ²¡æœ‰. å´å‘ç°å¥½å¤šéƒ½æ˜¯ç”¨çš„pwntoolså·¥å…·æ¥çˆ†ç ´çš„, è‡ªå·±ä¹Ÿå»è¯•äº†ä¸‹, ç¡®å®ç®€å•å¾ˆå¤š.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line">a = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">16</span>, <span class="number">0xffff</span>):</span><br><span class="line">    cnt = <span class="number">0</span></span><br><span class="line">    j = i</span><br><span class="line">    <span class="keyword">while</span>(j):</span><br><span class="line">        cnt += <span class="number">1</span></span><br><span class="line">        j &amp;= j<span class="number">-1</span></span><br><span class="line">    <span class="keyword">if</span> cnt == <span class="number">10</span>:</span><br><span class="line">        a.append(i)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    p = process(<span class="string">"./11"</span>)</span><br><span class="line">    p.recv()</span><br><span class="line">    p.sendline(<span class="string">'1'</span>)</span><br><span class="line">    p.sendline(str(i))</span><br><span class="line">    ans = p.recv()</span><br><span class="line">    <span class="keyword">if</span> <span class="string">"NULL"</span> <span class="keyword">in</span> text:</span><br><span class="line">        <span class="keyword">print</span> (text)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    p.close()</span><br></pre></td></tr></table></figure><p><strong>æ€»ç»“: (1)æ—¢ç„¶æ˜¯çˆ†ç ´å°±è¦æ³¨æ„æœ‰å¤šç§æƒ…å†µ (2) LOBYTE æ˜¯idaçš„å®å®šä¹‰, å–æœ€ä½å­—èŠ‚ä½. (3)æ›´åŠ ç†Ÿæ‚‰pwntoolså·¥å…·çš„ä½¿ç”¨.</strong></p><h3 id="BABYRE"><a href="#BABYRE" class="headerlink" title="BABYRE"></a>BABYRE</h3><p>é¢˜ç›®ä¸éš¾, ä½†æ˜¯ç¬¬ä¸€æ¬¡é‡åˆ°è¿™æ ·çš„é¢˜.</p><p>64ä½elfæ–‡ä»¶, idaæ‰“å¼€å, å’Œä»¥å¾€çš„æ–‡ä»¶ä¸ä¸€æ ·, å¼€å§‹æœ‰ä¸€æ®µå¾ªç¯è®¡ç®—èµ‹å€¼çš„æ“ä½œ,ä½†æ˜¯åˆæ˜¯çœ‹ä¸åˆ°åˆ°åº•æ˜¯èµ‹å€¼ç»™äº†è°.<img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200512134025680-1592290738761.png" alt="image-20200512134025680"></p><p>é‚£å°±åŠ¨æ€è°ƒè¯•è·Ÿæ¥çœ‹çœ‹, åˆ°äº†åˆ¤æ–­æ¡ä»¶çš„æ—¶å€™. æ˜ç™½äº†å°±æ˜¯ç±»ä¼¼åŠ å£³çš„ç¨‹åºæ‰“å¼€ä¼šå…ˆè¿›è¡Œè§£å‹ç”Ÿæˆä»£ç . è¿™é‡Œå¼€å§‹é‚£ä¸€æ®µå¾ªç¯ä½œç”¨, å°±æ”¹å˜æˆ‘ä»¬ä»£ç çš„.</p><p>è·Ÿè¿›åˆ¤æ–­å‡½æ•°, ç®—æ³•å¾ˆç®€å•,ç›´æ¥è¯»æ±‡ç¼–, å°±æ˜¯ä¸€ä¸ªå¼‚æˆ–æ“ä½œç„¶åå¯¹æ¯”.</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200512133918795-1592290773581.png" alt="image-20200512133918795"></p><p>exp:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a[] = &#123;<span class="number">0x66</span>, <span class="number">0x6D</span>, <span class="number">0x63</span>, <span class="number">0x64</span>, <span class="number">0x7F</span>, <span class="number">0x6B</span>, <span class="number">0x37</span>, <span class="number">0x64</span>,  <span class="number">0x3B</span>, <span class="number">0x56</span>, <span class="number">0x60</span>, <span class="number">0x3B</span>, <span class="number">0x6E</span>, <span class="number">0x70</span>&#125;;</span><br><span class="line">	<span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">char</span> flag[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;; </span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt;= <span class="number">13</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		flag[i] = a[i] ^ i; </span><br><span class="line">	&#125; </span><br><span class="line">	</span><br><span class="line">	<span class="built_in">puts</span>(flag);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ€»ç»“: ç®—æ˜¯é•¿è§è¯†å§.</strong></p><p>æ”»é˜²ä¸–ç•Œåˆ·é¢˜è®°å½•ï¼ˆ4ï¼‰ã€‚</p><h3 id="asong"><a href="#asong" class="headerlink" title="asong"></a>asong</h3><h4 id="0x1åˆ†æ"><a href="#0x1åˆ†æ" class="headerlink" title="0x1åˆ†æ"></a>0x1åˆ†æ</h4><p>ä¸‹è½½ä¸‹æ¥ä¸‰ä¸ªæ–‡ä»¶ã€‚</p><p>ä¾æ¬¡çœ‹äº†ä¸‹, ä¸€ä¸ª64ä½elfæ–‡ä»¶æ— å£³, 2ä¸ªæ–‡æœ¬æ–‡ä»¶. æ‰“å¼€æ–‡æœ¬æ–‡ä»¶å,æ²¡æœ‰å¤´ç»ª. å°†elfæ–‡ä»¶è½½å…¥idaã€‚</p><p>æ•´ä¸ªæµç¨‹å¼€å§‹çœ‹ä¸æ¸…æ¥šåšä»€ä¹ˆ, å¤šçœ‹å‡ æ¬¡æ˜ç™½äº†. å…ˆè¾“å…¥å­—ç¬¦ä¸², æ‰“å¼€ä¸€ä¸ªthat_girlæ–‡ä»¶è¯»ä¿¡æ¯, æœ€åå‘outæ–‡ä»¶å†™ä¿¡æ¯. ä½†è¿™æ€ä¹ˆå’Œflagè”ç³»èµ·æ¥å‘¢. å…¶å®é‚£ä¸ªoutæ–‡ä»¶é‡Œçš„å°±æ˜¯å¯†æ–‡, æˆ‘ä»¬æ‰¾åˆ°é€†å‘ç®—æ³•, é€šè¿‡å¯†æ–‡æ±‚å‡ºæ˜æ–‡(å³æˆ‘ä»¬çš„è¾“å…¥, ä¹Ÿæ˜¯flag)</p><p>ä¸‹é¢å…·ä½“åˆ†ææ¯ä¸ªå‡½æ•°. ç¬¬ä¸€å‡½æ•°: <strong>sub_400B4C</strong> ç”±äºå¾ˆç®€å•, ç›´æ¥ç»™å‡ºå‡½æ•°åŠŸèƒ½.</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200515112040201-1591166378815.png" alt="image-20200515112040201"></p><p><strong>sub_400B4C</strong>: å…ˆåˆ¤æ–­, å†å– { } ä¹‹é—´çš„å†…å®¹.</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200515112333168-1591166382914.png" alt="image-20200515112333168"></p><p>ä¸‹é¢ä¸‹ä¸€ä¸ªå‡½æ•°, ç–‘é—®ï¼š<strong>v4å“ªé‡Œæ¥çš„åŠ ++*(_DWORD *)(4LL * v2 + v4);è¯­å¥çš„ä½œç”¨</strong></p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200515113837252-1591166387143.png" alt="image-20200515113837252"></p><p><strong>sub_400936(&amp;buf)</strong>:</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200515170301682-1591166983676.png" alt="image-20200515170301682"></p><p>ç¬¬ä¸€æ¬¡é‡åˆ°, æ²¡æœ‰ç»éªŒ, åæ¥æ‰æƒ³åˆ°é€šè¿‡æ±‡ç¼–çš„æŸ¥çœ‹, v4å³æ˜¯æˆ‘ä»¬ä¼ äº†å‚æ•° a2(ä¹Ÿå°±æ˜¯ä¸»å‡½æ•°çš„v3), è¿™æ˜¯é€šè¿‡å¯„å­˜å™¨ä¼ é€’. 64ä½ä¸32ä½ç¨‹åºçš„åŒºåˆ«. ä½†è¯¥è¯­å¥åŠŸèƒ½è¿˜ä¸æ˜¯å¾ˆæ¸…æ¥š.<img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200515114501031-1591166391168.png" alt="image-20200515114501031"></p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200515114755333-1591166411300.png" alt="image-20200515114755333"></p><p>ç»§ç»­çœ‹ä¸‹ä¸€ä¸ªå‡½æ•°<strong>sub_400E54</strong>: çœ‹åˆ°è¿™é‡Œ, å°±å¾ˆæ¸…æ™°äº†, å°±æ˜¯å…ˆé€šè¿‡ç»Ÿè®¡<strong>that_girl</strong>æ–‡ä»¶ä¸­æ¯ä¸ªå­—ç¬¦å‡ºç°çš„æ¬¡æ•°, ç„¶åæŒ‰ç…§ä¸€å®šçš„é¡ºåºè¾“å…¥å­—ç¬¦, æŠŠæ¯ä¸ªå­—ç¬¦å‡ºç°çš„æ¬¡æ•°æŒ‰ä¸€å®šé¡ºåºç»™ä¸‹é¢çš„ v5 æ•°ç»„èµ‹å€¼.<strong>é‚£æ‰€ä»¥sub_400936è½¬æ¢å­—ç¬¦å‡½æ•°æˆ‘ä»¬æ˜¯ä¸ç”¨ç®¡çš„.</strong></p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200515115440782-1591166415194.png" alt="image-20200515115440782"></p><p>ä¸‹é¢æ˜¯2ä¸ªåŠ å¯†å‡½æ•°, æˆ‘ç®—æ³•å¤ªèœ, é€†ç®—æ³•æƒ³åŠå¤©ğŸ˜…, é¦–å…ˆ<strong>sub_400D33((unsigned __int8 *)v5);</strong></p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200515120938171-1591166420082.png" alt="image-20200515120938171"></p><p>ç„¶å <strong>sub_400DB4(v5, v4);</strong> è§£é‡Šèµ·æ¥æœ‰ç‚¹æŠ½è±¡â€¦â€¦æ³¨æ„æ˜¯ä¸€ä¸ªå­—èŠ‚, æ‰€ä»¥å¤šå‡ºçš„ä½è¦èˆå¼ƒ<img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200515125253662-1591166423427.png" alt="image-20200515125253662"></p><p>ä¸¾ä¸ªä¾‹å­:</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200515134001272-1591166447078.png" alt="image-20200515134001272"></p><p>æœ€åä¸€ä¸ªå‡½æ•°: <strong>sub_400CC0((__int64)v5, â€œoutâ€, v4);</strong>å°†åŠ å¯†åçš„å€¼å†™å…¥ outæ–‡ä»¶.</p><h4 id="0x2é€†å‘è§£å¯†"><a href="#0x2é€†å‘è§£å¯†" class="headerlink" title="0x2é€†å‘è§£å¯†"></a>0x2é€†å‘è§£å¯†</h4><p>exp:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">union</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">unsigned</span> <span class="keyword">char</span> ida[<span class="number">152</span>];</span><br><span class="line">		<span class="keyword">int</span> change[<span class="number">38</span>];</span><br><span class="line">	&#125;A = &#123;</span><br><span class="line">   			<span class="number">22</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">6</span>,   <span class="number">0</span>, </span><br><span class="line">   			<span class="number">0</span>,   <span class="number">0</span>,   <span class="number">2</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">30</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   			<span class="number">24</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">9</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line">   			<span class="number">0</span>,   <span class="number">0</span>,  <span class="number">21</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">7</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   			<span class="number">18</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">10</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">8</span>,   <span class="number">0</span>, </span><br><span class="line">    		<span class="number">0</span>,   <span class="number">0</span>,  <span class="number">12</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">17</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   			<span class="number">23</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">13</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">4</span>,   <span class="number">0</span>, </span><br><span class="line">    		<span class="number">0</span>,   <span class="number">0</span>,   <span class="number">3</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">14</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">  			<span class="number">19</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">11</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">20</span>,   <span class="number">0</span>, </span><br><span class="line">    		<span class="number">0</span>,   <span class="number">0</span>,  <span class="number">16</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">15</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    		<span class="number">5</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">25</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">36</span>,   <span class="number">0</span>, </span><br><span class="line">    		<span class="number">0</span>,   <span class="number">0</span>,  <span class="number">27</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">28</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   			<span class="number">29</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">37</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">31</span>,   <span class="number">0</span>, </span><br><span class="line">    		<span class="number">0</span>,   <span class="number">0</span>,  <span class="number">32</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">33</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">  			<span class="number">26</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">34</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">35</span>,   <span class="number">0</span>, </span><br><span class="line">   			<span class="number">0</span>,   <span class="number">0</span></span><br><span class="line">				&#125;;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>, a[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;, temp = <span class="number">0</span>, lenth = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">char</span> b[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;, c[<span class="number">2000</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">	<span class="keyword">int</span> count[<span class="number">127</span>] = &#123;<span class="number">0</span>&#125;, change_[<span class="number">38</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">	<span class="keyword">char</span> flag[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">	</span><br><span class="line">	FILE *fp = <span class="literal">NULL</span>;</span><br><span class="line">	</span><br><span class="line">	fp = fopen(<span class="string">"out"</span>, <span class="string">"rb"</span>);      <span class="comment">//å…ˆä»æ–‡ä»¶è¯»å–å¯†æ–‡	  </span></span><br><span class="line">	lenth = fread(b, <span class="number">1</span>, <span class="number">100</span>, fp); <span class="comment">//è¿”å›è¯»å–æˆåŠŸä¸ªæ•°, ç¡®å®šå­—ç¬¦ä¸ªæ•°</span></span><br><span class="line">	fclose(fp);</span><br><span class="line">    					</span><br><span class="line">	temp = b[lenth<span class="number">-1</span>]&amp;<span class="number">7</span>; <span class="comment">//&amp;7  å–åä¸‰ä½æ•°æ®.</span></span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; lenth; i++)						</span><br><span class="line">	&#123;						</span><br><span class="line">		a[i] = (b[i] &gt;&gt; <span class="number">3</span>) | (temp &lt;&lt; <span class="number">5</span>);</span><br><span class="line">		temp = b[i]&amp;<span class="number">7</span>;<span class="comment">//ä»æ•´ä½“æ¥çœ‹å°±æ˜¯å°†æ•´ä¸ªæ•°æ®å³ç§»åŠ¨3ä½</span></span><br><span class="line">	&#125; </span><br><span class="line">	</span><br><span class="line">	fp = fopen(<span class="string">"that_girl"</span>, <span class="string">"rb"</span>); <span class="comment">//æ‰“å¼€that_girl, ç»Ÿè®¡å­—ç¬¦æ•°.</span></span><br><span class="line">	fread(c, <span class="number">1</span>, <span class="number">1742</span>, fp);</span><br><span class="line">	fclose(fp); </span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="keyword">sizeof</span>(c); i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(c[i] &gt;= <span class="number">65</span> &amp;&amp; c[i] &lt;= <span class="number">90</span>)  </span><br><span class="line">			c[i] += <span class="number">32</span>;	<span class="comment">//å› ä¸ºä¸åŒºåˆ†å¤§å°å†™, éƒ½è½¬æ¢ä¸ºå°å†™		</span></span><br><span class="line">			</span><br><span class="line">		count[c[i]]++; </span><br><span class="line">	&#125; </span><br><span class="line">	</span><br><span class="line">	i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>(A.change[i]) </span><br><span class="line">	&#123;</span><br><span class="line">		change_[j++] = A.change[i];  <span class="comment">//ç»Ÿè®¡æ¯ä¸ªå­—ç¬¦å‡ºç°æ¬¡æ•°</span></span><br><span class="line">		i = A.change[i];  </span><br><span class="line">	&#125;</span><br><span class="line">	j -= <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">	temp = a[<span class="number">0</span>], a[<span class="number">0</span>] = a[change_[j]];  <span class="comment">//ç¬¬äºŒå±‚è§£å¯†</span></span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; lenth<span class="number">-2</span>; i++) <span class="comment">//æŒ‰ç…§ç»™å®šèµ‹å€¼æ‰¾åˆ°ä¸€ä¸ªæœªå˜çš„å€¼, å€’åºèµ‹å€¼å›å»å³å¯		</span></span><br><span class="line">	&#123;</span><br><span class="line">		a[change_[j]] = a[change_[--j]];</span><br><span class="line">	&#125;</span><br><span class="line">	a[change_[j]] = temp; </span><br><span class="line">	</span><br><span class="line">	 </span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; lenth; i++)<span class="comment">//ç¬¬ä¸‰å±‚è§£å¯†,æ¯”å¯¹æ¯ä¸ªå­—ç¬¦å‡ºç°çš„æ¬¡æ•°çš„é¡ºåº,è¿›è€Œç¡®å®šè¾“å…¥é¡ºåº</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">127</span>; j++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>(a[i] == count[j])</span><br><span class="line">			&#123;</span><br><span class="line">				flag[i] = j; </span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; </span><br><span class="line">	&#125; </span><br><span class="line">	</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"QCTF&#123;%s&#125;"</span>, flag); <span class="comment">//å¾—åˆ°flag.</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200515135919513-1591166487828.png" alt="image-20200515135919513"></p><p><strong>æ€»ç»“: (1ï¼‰ç®—æ³•å¥½çš„è¯, è¿™é“é¢˜å°±è½»æ¾å¾ˆå¤šã€‚(2)æ³¨æ„64ä½ç¨‹åºçš„ä¼ é€’å‚æ•°çš„æ–¹å¼ã€‚</strong></p><h3 id="easyre-153"><a href="#easyre-153" class="headerlink" title="easyre-153"></a>easyre-153</h3><blockquote><p>é¢˜å…¶å®å¾ˆç®€å•, èƒ½çŒœåˆ°flagæ€ä¹ˆç®—å‡ºæ¥, ä½†å¯¹ç¨‹åºçš„æ‰§è¡Œæƒ³ä¸æ˜ç™½ï¼ŒèŠ±äº†äº›æ—¶é—´ã€‚</p></blockquote><p>32ä½elfæ–‡ä»¶åŠ äº†upxå£³, æ²¡æœ‰ä¿®æ”¹è¿‡çš„, ç›´æ¥upx -dè„±å£³æˆåŠŸ.<img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200515184107394-1591167002031.png" alt="image-20200515184107394"></p><p>idaæ‰“å¼€, æ‰¾åˆ°ä¸»å‡½æ•°. ä¸€å¼€å§‹å°±è®¤ä¸ºç›´æ¥åŠ¨è·³æ§åˆ¶å‡½æ•°çš„èµ°å‘, åˆ°æœ€åä¸€ä¸ª <strong>lol</strong> å‡½æ•°å¾—åˆ°flag. ä½†æ˜¯åŠ¨æ€æ€»æ˜¯åœ¨readå‡½æ•°å¡ä½, èµ°ä¸äº†, ä½†è¿™é‡Œæˆ‘ä»¬å¹¶ä¸èƒ½ç›´æ¥è·³,å› ä¸ºè¿™ä¸ªå‡½æ•°æ˜¯å‘<strong>buf</strong>å†™å†…å®¹, æˆ‘ä»¬æœ€åçš„flagæ˜¯è¦ä½¿ç”¨bufçš„å†…å®¹. ç„¶ååˆè½¬ GDB è°ƒè¯•, åŒç„¶çš„ç»“æœ. çº³é—·è¿™é¢˜äº†, å®ƒåˆ°åº•æ˜¯è¦åšä»€ä¹ˆ. å…¶å®çŒœä¹Ÿæ˜¯æŠŠä¸Šé¢ writeçš„é‚£éƒ¨åˆ†æ•°æ®ä½œä¸º buf çš„å†…å®¹, ç„¶ååœ¨lolå‡½æ•°å¾—åˆ° flag. ä½†é—®é¢˜æ˜¯ ç¨‹åºåˆ°åº•åœ¨æä»€ä¹ˆâ€¦..</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200515185409497-1591167023660.png" alt="image-20200515185409497"></p><p>çœŸçš„åšåˆ°è‡ªé—­, åæ¥æ‰å‘ç°æˆ‘å¿½ç•¥ä¸Šé¢çš„ pipe()å‡½æ•°ä¸fork()å‡½æ•°. ç¬¬ä¸€æ¬¡è§åˆ°, ç™¾åº¦äº†ä¸‹, æ˜ç™½äº†â€¦</p><blockquote><p>é¦–å…ˆæ˜¯ç®¡é“: 1.å…¶æœ¬è´¨æ˜¯ä¸€ä¸ªä¼ªæ–‡ä»¶(å®ä¸ºå†…æ ¸ç¼“å†²åŒº)</p><p>â€‹ 2.ç”±ä¸¤ä¸ªæ–‡ä»¶æè¿°ç¬¦å¼•ç”¨ï¼Œä¸€ä¸ªè¡¨ç¤ºè¯»ç«¯ï¼Œä¸€ä¸ªè¡¨ç¤ºå†™ç«¯ã€‚</p><p>â€‹ 3.è§„å®šæ•°æ®ä»ç®¡é“çš„å†™ç«¯æµå…¥ç®¡é“ï¼Œä»è¯»ç«¯æµå‡º</p><p>pipe()å‡½æ•°ç”¨äºåˆ›å»ºç®¡é“: 1.int pipe(int pipefd[2]); æˆåŠŸï¼š0ï¼›å¤±è´¥ï¼š-1ï¼Œè®¾ç½®errno</p><p>â€‹ 2.å‡½æ•°è°ƒç”¨æˆåŠŸè¿”å›r/wä¸¤ä¸ªæ–‡ä»¶æè¿°ç¬¦ã€‚æ— éœ€openï¼Œä½†éœ€æ‰‹åŠ¨close</p><p>â€‹ 3.è§„å®šï¼šfd[0] â†’ rï¼› fd[1] â†’ wï¼Œå°±åƒ0å¯¹åº”æ ‡å‡†è¾“å…¥ï¼Œ1å¯¹åº”æ ‡å‡†è¾“å‡ºä¸€æ ·ã€‚</p><p>â€‹ 4.å‘ç®¡é“æ–‡ä»¶è¯»å†™æ•°æ®å…¶å®æ˜¯åœ¨è¯»å†™å†…æ ¸ç¼“å†²åŒº</p><p><strong>è¿™é‡Œå°±æ˜¯é€šè¿‡pipedes[1]å†™è¿›å†…å®¹, ä»pipedes[0]å†™å‡º.</strong></p></blockquote><blockquote><p>ç„¶åfork()å‡½æ•°. 1.forkï¼ˆï¼‰å‡½æ•°é€šè¿‡ç³»ç»Ÿè°ƒç”¨åˆ›å»ºä¸€ä¸ªä¸åŸæ¥è¿›ç¨‹å‡ ä¹å®Œå…¨ç›¸åŒçš„è¿›ç¨‹ï¼Œ</p><p>â€‹ ä¹Ÿå°±æ˜¯ä¸¤ä¸ªè¿›ç¨‹å¯ä»¥åšå®Œå…¨ç›¸åŒçš„äº‹ï¼Œä½†å¦‚æœåˆå§‹å‚æ•°æˆ–è€…ä¼ å…¥çš„å˜é‡ä¸åŒï¼Œä¸¤ä¸ªè¿›ç¨‹ ä¹Ÿå¯ä»¥åšä¸åŒçš„äº‹</p><p>â€‹ 2.ä¸€ä¸ªè¿›ç¨‹è°ƒç”¨forkï¼ˆï¼‰å‡½æ•°åï¼Œç³»ç»Ÿå…ˆç»™æ–°çš„è¿›ç¨‹åˆ†é…èµ„æºï¼Œä¾‹å¦‚å­˜å‚¨æ•°æ®å’Œä»£ç çš„ç©º é—´ã€‚ç„¶åæŠŠåŸæ¥çš„è¿›ç¨‹çš„æ‰€æœ‰å€¼éƒ½å¤åˆ¶åˆ°æ–°çš„æ–°è¿›ç¨‹ä¸­ï¼Œåªæœ‰å°‘æ•°å€¼ä¸åŸæ¥çš„è¿›ç¨‹å€¼ ä¸åŒã€‚ç›¸å½“äºå…‹éš†äº†ä¸€ä¸ªè‡ªå·±</p><p>â€‹ 3.è°ƒç”¨forkå‡½æ•°ä¸€æ¬¡, è¿”å›2æ¬¡å€¼, è‹¥è¿”å›0åˆ™æ˜¯å­è¿›ç¨‹, è‹¥æ˜¯ä¸€ä¸ªæ•°åˆ™æ˜¯çˆ¶è¿›ç¨‹çš„è¿›ç¨‹å·.</p><p><strong>æ‰€ä»¥è¿™é‡Œå°±æ˜¯å…ˆåˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹,è¿”å›å€¼v5 == 0, è¿›å…¥å­è¿›ç¨‹å®Œæˆå†™å…¥æ•°æ®åç»“æŸè¿›ç¨‹, fork()è¿”å›æ–°çš„å€¼çˆ¶è¿›ç¨‹è¿›ç¨‹å·,ç„¶åæ‰§è¡Œåé¢çš„æ“ä½œ.</strong></p></blockquote><p>è¿™é‡ŒåŠ¨æ€è°ƒè¯•è¿™ç§åˆ›å»ºè¿›ç¨‹çš„ç¨‹åºæ˜¯ä¸é€šç•…çš„. é‚£å°±é€šè¿‡ä¿®æ”¹ç¨‹åº EIP, æŒ‰ç…§æœ¬æ¥è¦æ‰§è¡Œçš„é¡ºåºæ‰§è¡Œä¸€éå¾—åˆ°flag.(æ³¨æ„è¿™æ ·å¯èƒ½ä¼šæœ‰ä¸€ä¸ªé—®é¢˜: æ ˆä¸å¹³è¡¡, å› ä¸ºå‡½æ•°æ²¡æœ‰æ­£å¸¸è¿”å›, é‚£ä¼šå½±å“ä¸€äº›å‡½æ•°, æ¯”å¦‚scanf()å‡½æ•°æ‰§è¡Œåˆ°äº†, ä¸ä¼šè®©æˆ‘ä»¬è¾“å…¥, è€Œæ˜¯ç›´æ¥è·³è¿‡, è¿™å°±æ˜¯å †æ ˆæœ‰å€¼å®ƒå°±ç›´æ¥è¯»å–äº†)</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200515193103677-1591167041257.png" alt="image-20200515193103677"></p><p><strong>æ€»ç»“:(1)å¯¹äºç›²åŒºçš„çŸ¥è¯†, æèµ·æ¥è¿˜æ˜¯éº»çƒ¦ï¼Œç§¯ç´¯å§ã€‚ (2)ç†Ÿæ‚‰äº†ä¿®æ”¹ EIPã€‚</strong></p><h3 id="76å·å…¬è·¯"><a href="#76å·å…¬è·¯" class="headerlink" title="76å·å…¬è·¯"></a>76å·å…¬è·¯</h3><p>é¢˜ç›®çœ‹ä¼¼å¾ˆéš¾çš„æ ·å­, ä½†è‡ªå·±ç¡®å®è¢«é¢˜ç›®çš„ä¿¡æ¯è¯¯å¯¼äº†.</p><p>ä¸‹è½½å, 2ä¸ªæ–‡æœ¬ä¸€ä¸ª32ä½æ— å£³elfæ–‡ä»¶, å¹¶ä¸”é¢˜ç›®ä¿¡æ¯å°±ç»™äº† <strong>æˆ‘ä»¬è®¤ä¸ºæœ‰ä»½ç¡®åˆ‡çš„æ–‡æ¡£è®°å½•äº†æ¯ä¸ªåŒºåŸŸçš„åŠŸèƒ½ï¼Œè¯·ååŠ©æ‰¾å‡º</strong> è¿™ä¸ªæç¤º, æ‰€ä»¥è‡ªå·±åšé¢˜æ—¶å§‹ç»ˆæƒ³åˆ°æ€ä¹ˆå’Œæ–‡æœ¬è”ç³»èµ·æ¥, æ‰¾çº¿ç´¢. ä½†å…¶å®ä¸ç„¶</p><p>è½½å…¥idaå, æœç´¢äº†ä¸‹å­—ç¬¦ä¸², æ‰¾åˆ°äº†ä¸»å‡½æ•°, ä½†æ˜¯ä¸èƒ½è½¬åŒ–ä¸ºä¼ªä»£ç , å› ä¸ºä¹‹å‰äº†è§£è¿‡ç‚¹èŠ±æŒ‡ä»¤,å…¶ä¸­ <strong>E0</strong> æ€»æ˜¯å¹²æ‰°ä»£ç çš„. æ”¹ä¸º <strong>90</strong> nopæ‰å°±å¯ä»¥äº†.</p><p>è¿™é‡ŒåŒæ ·. æ”¹å®Œå, å¼€å§‹è¯»æ±‡ç¼–ä»£ç , é€»è¾‘å¾ˆç®€å•, å°±æ˜¯æç¤º, è®©æˆ‘ä»¬è¾“å…¥å­—ç¬¦, è¿›å»ä¸€ä¸ªå‡½æ•°åˆ¤æ–­.<img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200521123259003-1591167068213.png" alt="image-20200521123259003"></p><p>è¿›å»åˆ¤æ–­å‡½æ•°, å¯ä»¥æŸ¥çœ‹ä¼ªä»£ç çš„. åˆ†æä¸€ä¸‹å°±çŸ¥é“æ˜¯è·Ÿç€ä¸€æ¡çº¿æŒ‰ç…§é¡ºåºæ£€ç´¢æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦ä¸². ä½†æ˜¯æ€ä¹ˆæ‰¾é¡ºåºå‘¢, å› ä¸ºæ–‡æœ¬æ–‡ä»¶è¿˜æ²¡ç”¨, æˆ‘å°±å§‹ç»ˆè®¤ä¸ºåœ¨æ–‡æœ¬æ–‡ä»¶æ‰¾, æ‰¾äº†åŠå¤©â€¦â€¦.æ— æœ</p><p>æœ€åå›åˆ°ç¨‹åºå‘ç°, å¯ä»¥æ‰¾åˆ°å…¥å£ç‚¹, é¡ºè—¤æ‘¸ç“œçš„å°±å¯ä»¥æ‰¾åˆ°äº†å•Š. å¯ä»¥çŸ¥é“ä»ç´¢å¼• <strong>v2</strong> ä»0å¼€å§‹, ç›´æ¥ä»è¿™é‡Œå‡ºå‘å°±å¥½äº†. ç›´åˆ°æ­£ç¡®é€€å‡ºå¾ªç¯.<img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200521123808376-1591167075180.png" alt="image-20200521123808376"></p><p>æœ€åå¾—åˆ°flag: <strong>flag{09vdf7wefijbk}</strong>.</p><p><strong>æ€»ç»“: (1)ä¸è¦è®©é¢˜ç›®æŠŠè‡ªå·±çš„æ€è·¯å¸¦åäº†, æ€ç»´è¦å‘æ•£ä¸€äº›.</strong></p><h3 id="reverse-box"><a href="#reverse-box" class="headerlink" title="reverse-box"></a>reverse-box</h3><p>é¢˜ç›®ä¸‹è½½ä¸‹æ¥ï¼Œå¼„åŠå¤©å§‹ç»ˆè§‰å¾—æœ‰é—®é¢˜ã€‚ç™¾åº¦å‘ç°é¢˜ç›®å°‘ç»™äº†è¾“å‡ºå­—ç¬¦ä¸²ã€‚</p><p>å¼€å§‹å†æ¬¡çœ‹é¢˜ï¼Œè¢«è‡ªå·±å‘æƒ¨äº†ã€‚ã€‚ã€‚å› ä¸ºç”Ÿæˆæ•°æ®è¡¨çš„å‡½æ•°ä¸­è‡ªå·±åªçœ‹åˆ°äº†ç”Ÿæˆçš„éšæœºæ•°èµ‹å€¼äº†ç»™äº†æ•°æ®è¡¨çš„ç¬¬ä¸€æ¬¡å…ƒç´ ï¼Œé‚£æ•´ä¸ªé¢˜å°±æœ‰ç‚¹å¥‡æ€ªäº†ã€‚çœ‹äº†åˆçœ‹ï¼Œæ‰å‘å…ˆæœ€åç”¨åˆ°äº†éšæœºæ•°ç”Ÿæˆæ•°æ®çš„ï¼Œåªæ˜¯å±å¹•å®¹ä¸ä¸‹äº†ã€‚ã€‚ã€‚</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200528115958609-1591167079725.png" alt="image-20200528115958609"></p><p>å¦å¤–å°±æ˜¯å…ˆå°†æ¯æ¬¡ç”Ÿæˆç´¢å¼•å€¼ v7 ç”¨Cè¯­è¨€å†™å‡ºæ¥åæ‰“å°çœ‹çœ‹ï¼Œ ä½†å¤§å¤šæ•°æ˜¯è´Ÿæ•°ï¼Œå¾ˆå¤§çš„æ•°ã€‚è¿™æ˜¾ç„¶ä¸å¯¹çš„ï¼Œå› ä¸ºæˆ‘ä»¬è¿è¡Œç¨‹åºæ—¶è¾“å…¥çš„å‚æ•°éƒ½æ˜¯å¯æ‰“å°å­—ç¬¦ ï¼ˆASCII: 32-127ï¼‰ï¼Œä¼ªä»£ç ä¸é è°±ï¼Œæœæ–­å»çœ‹çœ‹äº†æ±‡ç¼–ã€‚</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200528121109201-1591167091052.png" alt="image-20200528121109201"></p><p>å¦å¤–å°±æ˜¯ ä¼ªä»£ç ä¸­çš„ __ROR__äº†ï¼Œçœ‹äº†æ±‡ç¼–çŸ¥é“äº† ror æŒ‡ä»¤ï¼Œå°†æ•°æ®æƒ³å³ä½ç§»åŠ¨æŒ‡å®šçš„ä½æ•°ã€‚ä»¥ä¸ºåªæ˜¯ç®€å•çš„ &gt;&gt; ï¼Œå°±è¿™æ ·å†™äº†æ•´ä¸ªé¢˜çš„çˆ†ç ´ä»£ç ã€‚ä½†æ˜¯å§‹ç»ˆä¸å¯¹ï¼ŒèŠ±äº†å¾ˆæ—¶é—´ï¼Œä¸ç”˜å¿ƒï¼Œå°±idaä¸­åŠ¨è°ƒï¼ŒCè¯­è¨€ä¸­è°ƒè¯•ï¼Œæ¯ä¸ªæ­¥éª¤å¯¹æ¯”ç»“æœï¼Œæ‰æ‰¾åˆ°æ˜¯ ror è¿™é‡Œé”™äº†ã€‚ã€‚ã€‚ åŸæ¥ ror æ˜¯å³ç§»åŠ¨ä½åä¼šæŠŠå¤šä½™çš„ä½ç§»åŠ¨åˆ°æœ€å·¦è¾¹ï¼Œå³ä¸€ä¸ªåœ†åœˆè½¬ï¼Œè¿™æ˜¯å¾ªç¯ç§»ä½ã€‚</p><p>exp:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">generate</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> *result)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> v7 = <span class="number">1</span>, v2 = <span class="number">0</span>, v3 = <span class="number">0</span>, temp = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> v4 = <span class="number">0</span>, v5 = <span class="number">0</span>, v8 = <span class="number">1</span>, v9 = <span class="number">0</span>;</span><br><span class="line">	result[<span class="number">0</span>] = a;</span><br><span class="line">	<span class="keyword">do</span></span><br><span class="line">	&#123;</span><br><span class="line">		v2 = v7 ^ <span class="number">2</span> * v7;</span><br><span class="line">		<span class="keyword">if</span>((v7 &amp; <span class="number">0x80</span>) == <span class="number">0</span>)</span><br><span class="line">			v3 = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			v3 = <span class="number">27</span>;</span><br><span class="line">        </span><br><span class="line">		v7 = v2 ^ v3;		</span><br><span class="line">		v7 = v7 &amp; <span class="number">0xFF</span>;	 			</span><br><span class="line">        	v4 = (<span class="number">4</span> * (<span class="number">2</span> * v8 ^ v8) ^ <span class="number">2</span> * v8 ^ v8)&amp;<span class="number">0xff</span>;</span><br><span class="line">        	v9 = ((<span class="number">16</span> * v4 ^ v4)&amp;<span class="number">0xff</span>);</span><br><span class="line">        </span><br><span class="line">    		<span class="keyword">if</span> ( v9 &gt;= <span class="number">0</span> &amp;&amp; v9 &lt;= <span class="number">127</span> )</span><br><span class="line">      			v5 = <span class="number">0</span>;</span><br><span class="line">    		<span class="keyword">else</span></span><br><span class="line">      			v5 = <span class="number">9</span>;</span><br><span class="line">    		v8 = (v9 ^ v5);</span><br><span class="line">        </span><br><span class="line">		<span class="keyword">if</span>(v7 &lt; <span class="number">127</span>)</span><br><span class="line">    		result[v7] = (((v8 &gt;&gt; <span class="number">4</span>) | ((v8 &amp; <span class="number">0xF</span>) &lt;&lt; <span class="number">4</span>)) ^ ((v8 &gt;&gt; <span class="number">5</span>) | ((v8&amp;<span class="number">0x1F</span>) &lt;&lt; <span class="number">3</span>)) ^ ((v8 &gt;&gt; <span class="number">6</span>) | ((v8&amp;<span class="number">0x3F</span>)&lt;&lt;<span class="number">2</span>) ) ^ ((v8 &gt;&gt; <span class="number">7</span>) | ((v8&amp;<span class="number">0xFF</span>)&lt;&lt;<span class="number">1</span>) ) ^ (v8 ^ a))&amp;<span class="number">0xff</span>;</span><br><span class="line">        </span><br><span class="line">	&#125;<span class="keyword">while</span>(v7 != <span class="number">1</span>); </span><br><span class="line">&#125;</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> *result = (<span class="keyword">int</span> *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">int</span>)*<span class="number">127</span>);</span><br><span class="line">	<span class="keyword">int</span> i = <span class="number">0</span>, value = <span class="number">0</span>, j = <span class="number">0</span>;	</span><br><span class="line">	<span class="keyword">char</span> a[] = <span class="string">"95eeaf95ef94234999582f722f492f72b19a7aaf72e6e776b57aee722fe77ab5ad9aaeb156729676ae7a236d99b1df4a"</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">1</span>; i &lt; <span class="number">256</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		generate(i, result);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(result[<span class="number">84</span>] == <span class="number">0x95</span>)</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(a); i += <span class="number">2</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(a[i] &gt;= <span class="number">48</span> &amp;&amp; a[i] &lt;= <span class="number">57</span>)</span><br><span class="line">			a[i] -= <span class="number">48</span>;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			a[i] -= <span class="number">87</span>;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(a[i+<span class="number">1</span>] &gt;= <span class="number">48</span> &amp;&amp; a[i+<span class="number">1</span>] &lt;= <span class="number">57</span>)</span><br><span class="line">			a[i+<span class="number">1</span>] -= <span class="number">48</span>;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			a[i+<span class="number">1</span>] -= <span class="number">87</span>;</span><br><span class="line">			</span><br><span class="line">		value = a[i+<span class="number">1</span>] | a[i]*<span class="number">16</span>;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">for</span>(j = <span class="number">32</span>; j &lt; <span class="number">127</span>; j++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>(result[j] == value)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">"%c"</span>, j);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		</span><br><span class="line">		&#125; </span><br><span class="line">	&#125;	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200528122051072-1591167097050.png" alt="image-20200528122051072"></p><p>åšå®Œå»çœ‹äº†çœ‹ç½‘ä¸Šçš„ writeupï¼Œ å‘ç°éƒ½æ˜¯ç”¨gdbå†™è„šæœ¬æçš„ï¼Œç„¶åå»å­¦ä¹ äº†ä¸‹ã€‚</p><p>ä½¿ç”¨ gdbçš„ define å‘½ä»¤å¯ä»¥å®šä¹‰ä¸€ç³»åˆ—çš„gdbæŒ‡ä»¤ã€‚é¦–å…ˆæ‰¾åˆ°è¦ä¸‹æ–­ç‚¹åœ°å€ï¼Œè¿™ä¸ªåœ¨idaä¸­å¾ˆå®¹æ˜“ã€‚</p><p>è¿™é‡Œæœ‰2ä¸­æ–¹æ³•ï¼Œæ‰§è¡Œgdbè„šæœ¬ï¼Œä¸€ï¼šç›´æ¥è¾“å…¥defienå‘½ä»¤ï¼Œè¾“å…¥æŒ‡ä»¤ï¼Œæœ€åæ‰§è¡Œã€‚äºŒï¼šå•ç‹¬å†™æˆä¸€ä¸ªè„šæœ¬æ–‡ä»¶ä½¿ç”¨ source æ¥æ‰§è¡Œã€‚</p><p>è¿™é‡Œç›´æ¥å†™çš„è„šæœ¬æ–‡ä»¶ä½¿ç”¨ sourceæ‰§è¡Œã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">set $i = <span class="number">0</span></span><br><span class="line">set $total = <span class="number">256</span></span><br><span class="line"><span class="keyword">while</span>($i &lt; $total)</span><br><span class="line">  b *<span class="number">0x80485b4</span></span><br><span class="line">  b *<span class="number">0x8048707</span></span><br><span class="line">  run T</span><br><span class="line">  set $i = $i+<span class="number">1</span></span><br><span class="line">  set *(char*)($ebp<span class="number">-0xc</span>) = $i</span><br><span class="line">  <span class="keyword">continue</span></span><br><span class="line">  <span class="keyword">if</span> ($eax == <span class="number">0x95</span>)</span><br><span class="line">    <span class="keyword">print</span> $i</span><br><span class="line">    x/<span class="number">127</span>xb $esp+<span class="number">0x1c</span></span><br><span class="line">    set $i = <span class="number">256</span></span><br><span class="line">  stop</span><br><span class="line">end</span><br></pre></td></tr></table></figure><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200528163112618-1591167101638.png" alt="image-20200528163112618"></p><p>å› ä¸ºå¯æ‰“å°å­—ç¬¦çš„ASCIIï¼š32-127ï¼Œæ‰€ä»¥æˆ‘ä»¬æ‰“å°å‡ºå‰128ä¸ªæ•°æ®å³å¯ã€‚æœ€åè§£å¯†ã€‚pythonç¡®å®æ–¹ä¾¿ï¼Œå„ç§æ–¹æ³•ç›´æ¥è°ƒç”¨å³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">list =  [<span class="number">0xd6</span>,<span class="number">0xc9</span>,<span class="number">0xc2</span>,<span class="number">0xce</span>,<span class="number">0x47</span>,<span class="number">0xde</span>,<span class="number">0xda</span>,<span class="number">0x70</span></span><br><span class="line">	,<span class="number">0x85</span>,<span class="number">0xb4</span>,<span class="number">0xd2</span>,<span class="number">0x9e</span>,<span class="number">0x4b</span>,<span class="number">0x62</span>,<span class="number">0x1e</span>,<span class="number">0xc3</span></span><br><span class="line">	,<span class="number">0x7f</span>,<span class="number">0x37</span>,<span class="number">0x7c</span>,<span class="number">0xc8</span>,<span class="number">0x4f</span>,<span class="number">0xec</span>,<span class="number">0xf2</span>,<span class="number">0x45</span></span><br><span class="line">	,<span class="number">0x18</span>,<span class="number">0x61</span>,<span class="number">0x17</span>,<span class="number">0x1a</span>,<span class="number">0x29</span>,<span class="number">0x11</span>,<span class="number">0xc7</span>,<span class="number">0x75</span></span><br><span class="line">	,<span class="number">0x02</span>,<span class="number">0x48</span>,<span class="number">0x26</span>,<span class="number">0x93</span>,<span class="number">0x83</span>,<span class="number">0x8a</span>,<span class="number">0x42</span>,<span class="number">0x79</span></span><br><span class="line">	,<span class="number">0x81</span>,<span class="number">0x10</span>,<span class="number">0x50</span>,<span class="number">0x44</span>,<span class="number">0xc4</span>,<span class="number">0x6d</span>,<span class="number">0x84</span>,<span class="number">0xa0</span></span><br><span class="line">	,<span class="number">0xb1</span>,<span class="number">0x72</span>,<span class="number">0x96</span>,<span class="number">0x76</span>,<span class="number">0xad</span>,<span class="number">0x23</span>,<span class="number">0xb0</span>,<span class="number">0x2f</span></span><br><span class="line">	,<span class="number">0xb2</span>,<span class="number">0xa7</span>,<span class="number">0x35</span>,<span class="number">0x57</span>,<span class="number">0x5e</span>,<span class="number">0x92</span>,<span class="number">0x07</span>,<span class="number">0xc0</span></span><br><span class="line">	,<span class="number">0xbc</span>,<span class="number">0x36</span>,<span class="number">0x99</span>,<span class="number">0xaf</span>,<span class="number">0xae</span>,<span class="number">0xdb</span>,<span class="number">0xef</span>,<span class="number">0x15</span></span><br><span class="line">	,<span class="number">0xe7</span>,<span class="number">0x8e</span>,<span class="number">0x63</span>,<span class="number">0x06</span>,<span class="number">0x9c</span>,<span class="number">0x56</span>,<span class="number">0x9a</span>,<span class="number">0x31</span></span><br><span class="line">	,<span class="number">0xe6</span>,<span class="number">0x64</span>,<span class="number">0xb5</span>,<span class="number">0x58</span>,<span class="number">0x95</span>,<span class="number">0x49</span>,<span class="number">0x04</span>,<span class="number">0xee</span></span><br><span class="line">	,<span class="number">0xdf</span>,<span class="number">0x7e</span>,<span class="number">0x0b</span>,<span class="number">0x8c</span>,<span class="number">0xff</span>,<span class="number">0xf9</span>,<span class="number">0xed</span>,<span class="number">0x7a</span></span><br><span class="line">	,<span class="number">0x65</span>,<span class="number">0x5a</span>,<span class="number">0x1f</span>,<span class="number">0x4e</span>,<span class="number">0xf6</span>,<span class="number">0xf8</span>,<span class="number">0x86</span>,<span class="number">0x30</span></span><br><span class="line">	,<span class="number">0xf0</span>,<span class="number">0x4c</span>,<span class="number">0xb7</span>,<span class="number">0xca</span>,<span class="number">0xe5</span>,<span class="number">0x89</span>,<span class="number">0x2a</span>,<span class="number">0x1d</span></span><br><span class="line">	,<span class="number">0xe4</span>,<span class="number">0x16</span>,<span class="number">0xf5</span>,<span class="number">0x3a</span>,<span class="number">0x27</span>,<span class="number">0x28</span>,<span class="number">0x8d</span>,<span class="number">0x40</span></span><br><span class="line">	,<span class="number">0x09</span>,<span class="number">0x03</span>,<span class="number">0x6f</span>,<span class="number">0x94</span>,<span class="number">0xa5</span>,<span class="number">0x4a</span>,<span class="number">0x46</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line">s = <span class="string">"95eeaf95ef94234999582f722f492f72b19a7aaf72e6e776b57aee722fe77ab5ad9aaeb156729676ae7a236d99b1df4a"</span>;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(s), <span class="number">2</span>):</span><br><span class="line">    s1 = int(s[i:i+<span class="number">2</span>], <span class="number">16</span>)</span><br><span class="line">    flag += chr(list.index(s1))</span><br><span class="line"><span class="keyword">print</span> (flag)</span><br></pre></td></tr></table></figure><p><strong>æ€»ç»“ï¼šè¿™é“é¢˜æ”¶è·è¿˜æ˜¯å¾ˆå¤§ã€‚1ï¼šå¯¹idaä¸­æ±‡ç¼–è¯­è¨€çš„è§£è¯»æ›´ç†Ÿæ‚‰äº†äº›ï¼Œæ³¨æ„å„ç§ al å–æœ€ä½å­—èŠ‚æ•°æ®ã€‚ 2ï¼šroræŒ‡ä»¤çš„äº†è§£ï¼ŒåŠå¯¹ä»–çš„Cè¯­è¨€ç”¨æ³•ï¼šå¦‚ <code>ror aï¼Œ3</code> é‚£Cè¯­è¨€ä¸ºï¼š<code>((a&gt;&gt;3ï¼‰| ((a&amp;7) &lt;&lt; 5))</code>ã€‚ 3ï¼šä½¿ç”¨gdbå†™è„šæœ¬ã€‚</strong></p><blockquote><p><strong>gdbè„šæœ¬ä¸­çš„ æŸ¥çœ‹å†…å­˜å†…å®¹çš„æ–¹æ³•ï¼šx/&lt;n/f/u&gt;<addr> nã€fã€uæ˜¯å¯é€‰çš„å‚æ•°ã€‚</addr></strong></p><p><strong>nï¼šæ˜¾ç¤ºçš„å†…å­˜å•å…ƒçš„ä¸ªæ•°ï¼Œfï¼šè¡¨ç¤ºæ˜¾ç¤ºçš„æ ¼å¼ï¼Œå…¶ä¸­ï¼šsï¼šå­—ç¬¦ä¸²æ˜¾ç¤ºï¼Œxï¼šæŒ‰åå…­è¿›åˆ¶æ ¼å¼æ˜¾ç¤ºï¼Œdï¼šæŒ‰åè¿›åˆ¶æ ¼å¼æ˜¾ç¤ºå˜é‡</strong></p><p><strong>uï¼šæŒ‰åå…­è¿›åˆ¶æ ¼å¼æ˜¾ç¤ºæ— ç¬¦å·æ•´å‹ï¼Œtï¼šæŒ‰äºŒè¿›åˆ¶æ ¼å¼æ˜¾ç¤ºï¼Œ oï¼šæŒ‰å…«è¿›åˆ¶æ ¼å¼æ˜¾ç¤ºï¼Œcï¼šæŒ‰å­—ç¬¦æ ¼å¼æ˜¾ç¤ºå˜é‡ã€‚</strong></p><p><strong>æœ€åçš„uè¡¨ç¤ºæ¯ä¸ªå•å…ƒçš„å¤§å°ï¼Œå…¶ä¸­ï¼šbè¡¨ç¤ºå•å­—èŠ‚ï¼Œhè¡¨ç¤ºåŒå­—èŠ‚ï¼Œwè¡¨ç¤ºå››å­— èŠ‚ï¼Œgè¡¨ç¤ºå…«å­—èŠ‚ã€‚</strong></p><p><strong>é‚£ä¸Šé¢è„šæœ¬å†™çš„ x/127xb è¡¨ç¤ºå°† 127ä¸ªçš„å•å­—èŠ‚å•å…ƒçš„æ•°æ®æŒ‰16è¿›åˆ¶æ ¼å¼æ˜¾ç¤ºå‡ºæ¥ã€‚</strong></p></blockquote><h3 id="What-does-this-button-do"><a href="#What-does-this-button-do" class="headerlink" title="What-does-this-button-do"></a>What-does-this-button-do</h3><blockquote><p>å¾ˆç®€å•çš„ä¸€é“å®‰å“é€†å‘ï¼Œä¸ºä»€ä¹ˆåˆ†æ•°é‚£ä¹ˆé«˜ã€‚ã€‚ã€‚</p></blockquote><p>ä¸‹è½½è§£å‹åå¾—åˆ°ä¸€å †æ–‡ä»¶ï¼Œå¯¹å®‰å“é€†å‘æ²¡æ·±å…¥äº†è§£è¿‡ï¼Œç›´æ¥æ‰¾åˆ° .dexæ–‡ä»¶ï¼Œä½¿ç”¨å¼ºå¤§çš„ ApkToolkit å·¥å…·è½¬ .dexæ–‡ä»¶ä¸º .jaræ–‡ä»¶ã€‚</p><p>æ¥ç€å°±æ˜¯ä½¿ç”¨ jd-gui æ‰“å¼€ï¼Œçœ‹åç¼–è¯‘çš„javaä»£ç ã€‚</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200530123951599-1591167111011.png" alt="image-20200530123951599"></p><p>çœ‹ FlagActivity.classï¼Œå°±æ˜¯ç›´æ¥å–å‡ºflagã€‚</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200530124201413-1591167113886.png" alt="image-20200530124201413"></p><p>æ‰“å°å‡ºæ¥å°±å¥½äº†ã€‚flag: <strong>flag{w4nn4_j4r_my_d3x}</strong></p><p><strong>æ€»ç»“ï¼šå®‰å“é€†å‘ä¹Ÿæ˜¯é‡åˆ°ä¸€é“ï¼Œç„¶ååšæ¥è¯•è¯•çœ‹ï¼Œä½†ä¹Ÿåªèƒ½åšå¾ˆç®€å•çš„ï¼Œæš‚æ—¶ç†Ÿæ‚‰å·¥å…·å§ã€‚</strong></p><h3 id="re5-packed-movement"><a href="#re5-packed-movement" class="headerlink" title="re5-packed-movement"></a>re5-packed-movement</h3><blockquote><p>å¯¹äºå…¨æ˜¯movæŒ‡ä»¤ï¼Œè¿™é“é¢˜çœ‹äº†writeupåšçš„ï¼Œå­¦ä¹ äº†idaä¸­è„šæœ¬çš„ä½¿ç”¨ã€‚</p></blockquote><p>32ä½elfæ–‡ä»¶åŠ äº†upxå£³ï¼Œç›´æ¥ä½¿ç”¨ upx -dã€‚</p><p>æ‰“å¼€å…¨æ˜¯movæŒ‡ä»¤ï¼Œå¿ƒæƒ³è¿™åˆæ˜¯ä»€ä¹ˆéªšæ“ä½œï¼Œä¸€æ³¢æ“ä½œåè¿˜æ˜¯ä¸ä¼šã€‚åé¢å‘ç°éƒ½æ˜¯ç”¨idaè„šæœ¬å®ç°ï¼Œé‚£å…¶å®ä¹Ÿå¯ä»¥ç”¨gdbè„šæœ¬ã€‚</p><p>å­¦ä¹ ä¸€ç•ªidaè„šæœ¬åŠidcçš„è¯­æ³•ï¼Œå¼€å§‹åšé¢˜ã€‚å…ˆæ‰¾åˆ°ä»£ç æ®µåœ°å€ï¼Œå› ä¸ºè€ƒè™‘flagæ˜¯é€šè¿‡ç«‹å³æ•°movæŒ‡ä»¤èµ‹å€¼çš„ã€‚</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200602151634347.png" alt="image-20200602151634347"></p><p>å†™è„šæœ¬æœç´¢å››ä¸ªå­—èŠ‚çš„æ‰€æœ‰å¯æ‰“å°å­—ç¬¦ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">start=<span class="number">0x0804829C</span></span><br><span class="line">end=<span class="number">0x08060B3A</span></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"><span class="keyword">while</span> start&lt;end:</span><br><span class="line">    <span class="keyword">if</span> (Byte(start) &lt;= ord(<span class="string">'9'</span>) <span class="keyword">and</span> Byte(start)&gt;=ord(<span class="string">'0'</span>)) <span class="keyword">or</span> (Byte(start)&lt;=ord(<span class="string">'z'</span>) <span class="keyword">and</span> 		                Byte(start)&gt;=ord(<span class="string">'a'</span>)) <span class="keyword">or</span> (Byte(start)&lt;=ord(<span class="string">'Z'</span>) <span class="keyword">and</span> Byte(start)&gt;=ord(<span class="string">'A'</span>)) <span class="keyword">or</span> </span><br><span class="line">      (Byte(start) == ord(<span class="string">'&#125;'</span>)) <span class="keyword">or</span> (Byte(start) == ord(<span class="string">'&#123;'</span>)) <span class="keyword">or</span> (Byte(start) == ord(<span class="string">'_'</span>)) <span class="keyword">or</span> </span><br><span class="line">      (Byte(start) == ord(<span class="string">'@'</span>)) <span class="keyword">or</span> (Byte(start) == ord(<span class="string">'!'</span>)) <span class="keyword">or</span> (Byte(start) == ord(<span class="string">'#'</span>)) <span class="keyword">or</span> 		    (Byte(start) == ord(<span class="string">'&amp;'</span>)) <span class="keyword">or</span> (Byte(start) == ord(<span class="string">'*'</span>)):</span><br><span class="line">        <span class="keyword">if</span> Byte(start) <span class="keyword">and</span> (Byte(start+<span class="number">1</span>)==<span class="number">0</span>) <span class="keyword">and</span> (Byte(start+<span class="number">2</span>)==<span class="number">0</span>) <span class="keyword">and</span> (Byte(start+<span class="number">3</span>)==<span class="number">0</span>):</span><br><span class="line">            print(chr(Byte(start)))</span><br><span class="line">            flag += chr(Byte(start))</span><br><span class="line">    start += <span class="number">1</span></span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œã€‚</p><p><img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200602154318790.png" alt="image-20200602154318790"></p><p><strong>æ€»ç»“ï¼šå¯¹idaè„šæœ¬è¿›è¡Œäº†å­¦ä¹ ï¼Œå¼€å§‹å¯¹idaæ‰§è¡Œè„šæœ¬æœ‰æ‰€äº†è§£ã€‚</strong></p><h3 id="æ¢…æ´¥ç¾æ²»éƒ"><a href="#æ¢…æ´¥ç¾æ²»éƒ" class="headerlink" title="æ¢…æ´¥ç¾æ²»éƒ"></a>æ¢…æ´¥ç¾æ²»éƒ</h3><p>å¾ˆç®€å•ä¸€ä¸ªé¢˜ç›®ï¼Œå…³é”®å°±æ˜¯ä¸€ç‚¹ï¼Œä½¿ç”¨äº†å‡½æ•°AddVectoredExceptionHandlerï¼ˆï¼‰ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">PVOID <span class="title">AddVectoredExceptionHandler</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">  ULONG                       First,</span></span></span><br><span class="line"><span class="function"><span class="params">  PVECTORED_EXCEPTION_HANDLER Handler <span class="comment">//è¦æ³¨å†Œçš„å¼‚å¸¸å¤„ç†ç¨‹åºã€‚</span></span></span></span><br><span class="line"><span class="function"><span class="params">)</span></span>;</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£å¯çŸ¥ï¼Œæ­¤å‡½æ•°ä½œç”¨ï¼š<strong>æ³¨å†Œä¸€ä¸ªå¼‚å¸¸å¤„ç†ç¨‹åº</strong>ã€‚å³å½“æˆ‘ä»¬çš„ç¨‹åºä¸­å‡ºç°å¼‚å¸¸åä¼šæ‰§è¡Œçš„å‡½æ•°ã€‚</p><p>ç¨‹åºåœ¨æ­¤å¤„è§¦å‘å¼‚å¸¸ï¼š<img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200919201636653.png" alt="image-20200919201636653"></p><h3 id="easy-go"><a href="#easy-go" class="headerlink" title="easy_go"></a>easy_go</h3><p>goè¯­è¨€å†™çš„ç¨‹åºï¼Œè°·æ­Œäº†ä¸‹å»é™¤ç¬¦å·è¡¨golangç¼–è¯‘çš„ç¨‹åºçš„å¤„ç†æ–¹æ³•ã€‚</p><p>å¯ä»¥ä½¿ç”¨ä¸€ä¸ªè„šæœ¬<a href="https://github.com/sibears/IDAGolangHelper.git" target="_blank" rel="noopener">IDAGolangHelper</a>æ¥è¿˜åŸç¬¦å·è¡¨ï¼Œé‚£å°†æå¤§æ–¹ä¾¿æˆ‘ä»¬åˆ†æç¨‹åºã€‚</p><p>ä½†æ˜¯ida7.0å› ä¸ºç‰ˆæœ¬ä½çš„åŸå› ï¼Œä½¿ç”¨è¿™ä¸ªè„šæœ¬ä¼šæœ‰é—®é¢˜ã€‚ç„¶åæ‰¾åˆ°è§£å†³åŠæ³•ï¼š<a href="https://blog.csdn.net/qq_21063873/article/details/104335240" target="_blank" rel="noopener">https://blog.csdn.net/qq_21063873/article/details/104335240</a></p><p>æˆåŠŸè¿˜åŸç¬¦å·è¡¨åï¼Œæ‰¾åˆ°main_mainå‡½æ•°ï¼Œä¸»é€»è¾‘è¿˜æ˜¯èƒ½æ¸…æ¥šï¼Œä½†ç»†èŠ‚çš„åœ°æ–¹çœŸçš„éš¾çœ‹ã€‚ã€‚</p><p>å‘ç°base64ç›¸å…³çš„å‡½æ•°ï¼š<img src="/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/image-20200924200352664.png" alt="image-20200924200352664"></p><p>ç„¶ååŠ¨è°ƒæƒ³çœ‹çœ‹è‡ªå·±è¾“å…¥çš„å­—ç¬¦ä¸²å­˜æ”¾åœ¨å“ªé‡Œä¹Ÿæ‰¾ä¸åˆ°ã€‚ã€‚ã€‚ä½†æ˜¯åŠ¨è°ƒå‡ºäº†2ä¸ªå­—ç¬¦ä¸²ï¼Œå…¶ä¸­ä¸€ä¸ªæ­£å¥½æ˜¯64ä½ï¼Œè€ƒè™‘æ˜¯å˜å¼‚çš„base64åŠ å¯†ï¼Œå¦ä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯è¾“å…¥flagçš„å¯†æ–‡ã€‚</p><p>å†™è„šæœ¬å°è¯•è§£ï¼šè¿˜çœŸçš„å¾—åˆ°flagã€‚ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">base1 = <span class="string">'6789_-abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ012345'</span></span><br><span class="line">t = <span class="string">'tGRBtXMZgD6ZhalBtCUTgWgZfnkTgqoNsnAVsmUYsGtCt9pEtDEYsql3'</span></span><br><span class="line">base = <span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'</span></span><br><span class="line">ans = <span class="string">''</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> t:</span><br><span class="line">	ans += base[base1.index(i)]</span><br><span class="line">print(ans)</span><br><span class="line">print(base64.b64decode(ans))</span><br><span class="line"></span><br><span class="line"><span class="comment">#flag&#123;92094daf-33c9-431e-a85a-8bfbd5df98ad&#125;</span></span><br></pre></td></tr></table></figure></div><div><ul class="post-copyright"><li class="post-copyright-author"> <strong>Post author:</strong> ooo</li><li class="post-copyright-link"> <strong>Post link:</strong> <a href="https://www.bxnop.cn/2020/04/09/%E9%80%86%E5%90%91%E7%BB%83%E4%B9%A0/" title="é€†å‘ç»ƒä¹ ">https://www.bxnop.cn/2020/04/09/é€†å‘ç»ƒä¹ /</a></li><li class="post-copyright-license"> <strong>Copyright Notice:</strong> All articles in this blog are licensed under<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i> BY-NC-SA</a> unless stating additionally.</li></ul></div><div><div><div style="text-align:center;color:#ccc;font-size:14px">-------------æœ¬æ–‡ç»“æŸ<i class="fa fa-paw"></i>æ„Ÿè°¢æ‚¨çš„é˜…è¯»-------------</div></div></div><footer class="post-footer"><div class="post-nav"><div class="post-nav-item"><a href="/2020/03/14/leetcode/" rel="prev" title="leetcode"><i class="fa fa-chevron-left"></i> leetcode</a></div><div class="post-nav-item"> <a href="/2020/04/23/BUUCTF/" rel="next" title="BUUCTF">BUUCTF<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc"> Table of Contents</li><li class="sidebar-nav-overview"> Overview</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Misc"><span class="nav-number">1.</span> <span class="nav-text">Misc</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Reverse"><span class="nav-number">2.</span> <span class="nav-text">Reverse</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#reverse1"><span class="nav-number">2.1.</span> <span class="nav-text">reverse1</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#reverse2"><span class="nav-number">2.2.</span> <span class="nav-text">reverse2</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#secret-galaxy-300"><span class="nav-number">2.3.</span> <span class="nav-text">secret-galaxy-300</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Newbie-calculations"><span class="nav-number">2.4.</span> <span class="nav-text">Newbie_calculations</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#reverse-for-the-holy-grail-350"><span class="nav-number">2.5.</span> <span class="nav-text">reverse-for-the-holy-grail-350</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#elrond32"><span class="nav-number">2.6.</span> <span class="nav-text">elrond32</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ç™¾è¶Šæ¯2018-crazy"><span class="nav-number">2.7.</span> <span class="nav-text">ç™¾è¶Šæ¯2018-crazy</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#easyCpp"><span class="nav-number">2.8.</span> <span class="nav-text">easyCpp</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Windows-Reverse2"><span class="nav-number">2.9.</span> <span class="nav-text">Windows_Reverse2</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Windows-Reverse1"><span class="nav-number">2.10.</span> <span class="nav-text">Windows_Reverse1</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#gametime"><span class="nav-number">2.11.</span> <span class="nav-text">gametime</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Replace"><span class="nav-number">2.12.</span> <span class="nav-text">Replace</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#notsequence"><span class="nav-number">2.13.</span> <span class="nav-text">notsequence</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SignIn"><span class="nav-number">2.14.</span> <span class="nav-text">SignIn</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#BabyXor"><span class="nav-number">2.15.</span> <span class="nav-text">BabyXor</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#easy-Maze"><span class="nav-number">2.16.</span> <span class="nav-text">easy_Maze</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#simple-check-100"><span class="nav-number">2.17.</span> <span class="nav-text">simple-check-100</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#zorropub"><span class="nav-number">2.18.</span> <span class="nav-text">zorropub</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#BABYRE"><span class="nav-number">2.19.</span> <span class="nav-text">BABYRE</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#asong"><span class="nav-number">2.20.</span> <span class="nav-text">asong</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#0x1åˆ†æ"><span class="nav-number">2.20.1.</span> <span class="nav-text">0x1åˆ†æ</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#0x2é€†å‘è§£å¯†"><span class="nav-number">2.20.2.</span> <span class="nav-text">0x2é€†å‘è§£å¯†</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#easyre-153"><span class="nav-number">2.21.</span> <span class="nav-text">easyre-153</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#76å·å…¬è·¯"><span class="nav-number">2.22.</span> <span class="nav-text">76å·å…¬è·¯</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#reverse-box"><span class="nav-number">2.23.</span> <span class="nav-text">reverse-box</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#What-does-this-button-do"><span class="nav-number">2.24.</span> <span class="nav-text">What-does-this-button-do</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#re5-packed-movement"><span class="nav-number">2.25.</span> <span class="nav-text">re5-packed-movement</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æ¢…æ´¥ç¾æ²»éƒ"><span class="nav-number">2.26.</span> <span class="nav-text">æ¢…æ´¥ç¾æ²»éƒ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#easy-go"><span class="nav-number">2.27.</span> <span class="nav-text">easy_go</span></a></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><p class="site-author-name" itemprop="name">ooo</p><div class="site-description" itemprop="description">0x446e37fb</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">40</span> <span class="site-state-item-name">posts</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/"><span class="site-state-item-count">14</span> <span class="site-state-item-name">categories</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/"><span class="site-state-item-count">3</span> <span class="site-state-item-name">tags</span></a></div></nav></div><div class="cc-license motion-element" itemprop="license"> <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a></div><div class="links-of-blogroll motion-element"><div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i> Links</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"> <a href="https://hack-for.fun/" title="https:&#x2F;&#x2F;hack-for.fun&#x2F;" rel="noopener" target="_blank">M0nk3y</a></li><li class="links-of-blogroll-item"> <a href="http://i0gan.cn:81/" title="http:&#x2F;&#x2F;i0gan.cn:81&#x2F;" rel="noopener" target="_blank">i0gan</a></li><li class="links-of-blogroll-item"> <a href="http://happi0.gitee.io/" title="http:&#x2F;&#x2F;happi0.gitee.io&#x2F;" rel="noopener" target="_blank">happi0</a></li><li class="links-of-blogroll-item"> <a href="https://vino0o0o.github.io/" title="https:&#x2F;&#x2F;vino0o0o.github.io&#x2F;" rel="noopener" target="_blank">Vino0o0o</a></li></ul></div></div><div class="back-to-top motion-element"><i class="fa fa-arrow-up"></i> <span>0%</span></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> &copy; <span itemprop="copyrightYear">2021</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">ooo</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-chart-area"></i></span> <span class="post-meta-item-text">Symbols count total:</span> <span title="Symbols count total">296k</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-coffee"></i></span> <span class="post-meta-item-text">Reading time total &asymp;</span> <span title="Reading time total">4:29</span></div></div></footer></div><script src="/lib/anime.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script><script type="text/javascript" src="/js/src/clicklove.js"></script><script type="text/javascript" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,model:{jsonPath:"/live2dw/assets/wanko.model.json"},display:{position:"left",width:150,height:300},mobile:{show:!0},log:!1})</script></body></html>