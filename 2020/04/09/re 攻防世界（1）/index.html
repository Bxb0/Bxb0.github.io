<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 4.2.1"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png"><link rel="mask-icon" href="/images/logo.svg" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/all.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"www.bxnop.cn",root:"/",scheme:"Gemini",version:"7.8.0",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!0,show_result:!0,style:null},back2top:{enable:!0,sidebar:!0,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><meta name="description" content="misc:菜狗截获了一份报文如下 从报文中可以联想到是md5加密, 但试了一下, 发现不对. 再看报文中字母只是 a-f , 所以可能是十六进制数, 又一般都是一个字节一个字符, 而一个字节存放二个十六进制数. 我们就2个一组转换成十进制, 但是大于了127, 可打印字符ASCII范围在0-127,  那我们知道 }字符的ASCII十六进制为 0X7D,  再看报文最后2个字符组成的十六进制数 0"><meta property="og:type" content="article"><meta property="og:title" content="re 攻防世界（1）"><meta property="og:url" content="https://www.bxnop.cn/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/index.html"><meta property="og:site_name" content="Bxnop&#39;s blog"><meta property="og:description" content="misc:菜狗截获了一份报文如下 从报文中可以联想到是md5加密, 但试了一下, 发现不对. 再看报文中字母只是 a-f , 所以可能是十六进制数, 又一般都是一个字节一个字符, 而一个字节存放二个十六进制数. 我们就2个一组转换成十进制, 但是大于了127, 可打印字符ASCII范围在0-127,  那我们知道 }字符的ASCII十六进制为 0X7D,  再看报文最后2个字符组成的十六进制数 0"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200409121215784-1590549058520-1591952582454.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200409121557118-1590549064830-1591952588146.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200409122019635-1590549068676-1591952593224.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200409203440087-1590549086887-1591952596805.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200409204018803-1590549093480-1591952609729.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200409204652301-1590549096561-1591952613467.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200415170640341-1590549110220-1591952617886.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200415170736593-1590549112522-1591952621317.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200415171038960-1590549115097-1591952634770.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200415192448626-1590549120154-1591952639860.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200415193002493-1590549136439-1591952646896.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200415193726368-1590549141490-1591952651993.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200415194242898-1590549138934-1591952658378.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200417124955377-1590549145811-1591952671849.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200417131746746-1590549170275-1591952678402.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200417133116275-1590549174848-1591952682724.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200421172942651-1590549186380-1591952692434.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200421173112461-1590549193146-1591952706873.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200421173211318-1590549201703-1591952713057.png"><meta property="og:image" content="https://www.bxnop.cn/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200421190646720-1590549218465-1591952718294.png"><meta property="article:published_time" content="2020-04-09T01:53:27.000Z"><meta property="article:modified_time" content="2020-06-12T09:06:47.737Z"><meta property="article:author" content="BIX"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://www.bxnop.cn/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200409121215784-1590549058520-1591952582454.png"><link rel="canonical" href="https://www.bxnop.cn/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"en"}</script><title>re 攻防世界（1） | Bxnop's blog</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="alternate" href="/atom.xml" title="Bxnop's blog" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="Toggle navigation bar"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">Bxnop's blog</h1><span class="logo-line-after"><i></i></span></a></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul id="menu" class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i> Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i> About</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i> Tags<span class="badge">2</span></a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i> Categories<span class="badge">10</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i> Archives<span class="badge">25</span></a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> Search</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocapitalize="off" placeholder="Searching..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"><div id="no-result"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></div></header><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content post posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en"><link itemprop="mainEntityOfPage" href="https://www.bxnop.cn/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.gif"><meta itemprop="name" content="BIX"><meta itemprop="description" content="0x446e37fb"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Bxnop's blog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> re 攻防世界（1）</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i></span> <span class="post-meta-item-text">Posted on</span> <time title="Created: 2020-04-09 09:53:27" itemprop="dateCreated datePublished" datetime="2020-04-09T09:53:27+08:00">2020-04-09</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i></span> <span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Reverse/" itemprop="url" rel="index"><span itemprop="name">Reverse</span></a></span></span><br><span class="post-meta-item" title="Symbols count in article"><span class="post-meta-item-icon"><i class="far fa-file-word"></i></span> <span class="post-meta-item-text">Symbols count in article:</span> <span>11k</span></span><span class="post-meta-item" title="Reading time"><span class="post-meta-item-icon"><i class="far fa-clock"></i></span> <span class="post-meta-item-text">Reading time &asymp;</span> <span>10 mins.</span></span></div></header><div class="post-body" itemprop="articleBody"><h2 id="misc"><a href="#misc" class="headerlink" title="misc:"></a>misc:</h2><p>菜狗截获了一份报文如下</p><p>从报文中可以联想到是md5加密, 但试了一下, 发现不对. 再看报文中字母只是 a-f , 所以可能是十六进制数, 又一般都是一个字节一个字符, 而一个字节存放二个十六进制数. 我们就2个一组转换成十进制, 但是大于了127, 可打印字符ASCII范围在<strong>0-127</strong>, 那我们知道 <code>}</code>字符的ASCII十六进制为 <strong>0X7D</strong>, 再看报文最后2个字符组成的十六进制数 <strong>0xf2</strong>, 一般我们可以有这个思路,求差值 但也有最后没有用 <strong>}</strong>结尾的, 这里就不是.😂. 但其实想到要把字符打印出来, 而字符ASCII<strong>0-127</strong>, 那就直接试一试减128, 一下子就对了, 哈哈😁.<a id="more"></a></p><p>下面是C语言写的, 2个一组转换成十进制数, 最后变成可打印字符:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> a[] = <span class="string">"c8e9aca0c6f2e5f3e8c4efe7a1a0d4e8e5a0e6ece1e7a0e9f3baa0e8eafae3f9e4eafae2eae4e3eaebfaebe3f5e7e9f3e4e3e8eaf9eaf3e2e4e6f2"</span>;</span><br><span class="line">	<span class="keyword">int</span> i = <span class="number">0</span>, lenth  = <span class="built_in">strlen</span>(a), sum = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">char</span> b[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;, j = <span class="number">0</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; lenth; i += <span class="number">2</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(a[i] &gt;= <span class="number">97</span> &amp;&amp; a[i] &lt;= <span class="number">122</span>)</span><br><span class="line">			a[i] -= <span class="number">87</span>;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(a[i] &gt;= <span class="number">65</span> &amp;&amp; a[i] &lt;=  <span class="number">90</span>) </span><br><span class="line">			a[i] -= <span class="number">55</span>;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			a[i] -= <span class="number">48</span>; </span><br><span class="line">		</span><br><span class="line">		sum = sum*<span class="number">16</span> + a[i];</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(a[i+<span class="number">1</span>])</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>(a[i+<span class="number">1</span>] &gt;= <span class="number">97</span> &amp;&amp; a[i+<span class="number">1</span>] &lt;= <span class="number">122</span>)</span><br><span class="line">				a[i+<span class="number">1</span>] -= <span class="number">87</span>;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(a[i+<span class="number">1</span>] &gt;= <span class="number">65</span> &amp;&amp; a[i+<span class="number">1</span>] &lt;=  <span class="number">90</span>) </span><br><span class="line">				a[i+<span class="number">1</span>] -= <span class="number">55</span>;</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				a[i+<span class="number">1</span>] -= <span class="number">48</span>;</span><br><span class="line">			</span><br><span class="line">			sum = sum*<span class="number">16</span> + a[i+<span class="number">1</span>]; </span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">while</span>(sum &gt; <span class="number">127</span>)</span><br><span class="line">		sum -= <span class="number">128</span>;</span><br><span class="line">		</span><br><span class="line">		b[j++] = sum, sum = <span class="number">0</span>; </span><br><span class="line">	&#125; </span><br><span class="line">	</span><br><span class="line">	<span class="built_in">puts</span>(b);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="reverse1"><a href="#reverse1" class="headerlink" title="reverse1:"></a>reverse1:</h2><p>首先拿到题, 还是拖进<strong>Exeinfope</strong>查看一下是否有壳:</p><p><img src="/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200409121215784-1590549058520-1591952582454.png" alt="image-20200409121215784-1590549058520"></p><p>嗯没有.</p><p>拖进ida, 找到主函数, 浏览一下程序功能, 一个游戏, 好像是通过点亮所有灯获得flag. 那么必定有一个判断条件, 往下看主函数, 显而易见:</p><p><img src="/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200409121557118-1590549064830-1591952588146.png" alt="image-20200409121557118-1590549064830"></p><p>那么下面一个函数就是关键函数了, 进去发现就是将flag计算出来, 56位长度, 还是懒得自己写程序来算.</p><p>我们可以在ida中找到 <strong>判断条件</strong>那里的的地址,: 0045F5D1</p><p><img src="/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200409122019635-1590549068676-1591952593224.png" alt="image-20200409122019635-1590549068676"></p><p>再通过OD,看加载的 VA(虚拟内存地址) :</p><p><img src="/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200409203440087-1590549086887-1591952596805.png" alt="image-20200409203440087-1590549086887"></p><p>那么由于 动态和静态的VA可能不同，但是它们的RVA还是一样的。我们使用在ida中的找到VA - imagebase = RVA. 再加上OD中的VA, 即得到在OD中的地址: 0091F5D1. 这样我们直接在OD中找到这个地址: 如下图, 看到很多 jnz. 所以我们的目的是让它都不跳转, 可以每个地方都 nop了, 但我们可以往下看, 直接找到它最后应该去到的函数地址(记为A), 通过打补丁把jnz xxxx, (图中0091F5D8) 改为 jmp A.</p><p><img src="/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200409204018803-1590549093480-1591952609729.png" alt="image-20200409204018803-1590549093480"></p><p>最后一按 F9 运行, 出现 flag .</p><p><img src="/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200409204652301-1590549096561-1591952613467.png" alt="image-20200409204652301-1590549096561"></p><hr><h2 id="reverse2"><a href="#reverse2" class="headerlink" title="reverse2:"></a>reverse2:</h2><p>拿到题是C源码, 直接分析就好了, 找到主函数看一下. 明确目标, 输入字符串, 也就是flag, 进行一系列操作和指定字符串比较. 找到比较的地方很容易推出:这里result == 0;</p><p><img src="/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200415170640341-1590549110220-1591952617886.png" alt="image-20200415170640341-1590549110220"></p><p>那么我们就可以知道下面函数的异或运算结果为0, 那么即发生异或运算的2个数相等.</p><p><img src="/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200415170736593-1590549112522-1591952621317.png" alt="image-20200415170736593-1590549112522"></p><p>最后就是随机数的选取了, 我们知道它是 &lt;= 64的, 那么写一个C程序, 把所有结果打印出来, 找到符合的即可.</p><p><img src="/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200415171038960-1590549115097-1591952634770.png" alt="image-20200415171038960-1590549115097"></p><p>最后从这道题, 知道了, 1.<code>pthread_t</code>是<code>unsigned long</code>宏定义的, 8个字节整型数据.2.<code>rand()%m</code>也是<code>random(m)</code>宏定义的.</p><hr><h2 id="secret-galaxy-300"><a href="#secret-galaxy-300" class="headerlink" title="secret-galaxy-300"></a>secret-galaxy-300</h2><p>首先题下载下来, 发现准备了3个不同的版本, 就分析常见的PE文件. 想先打开.exe文件, 但是闪一下就退出了, 根本看不到程序是做什么的.</p><p>首先查壳, 发现无壳.😁 先用ida打开, 找到main函数.发现是从已经编码的字符串取出来, 在打印在屏幕上. 载入OD, 下断点, 看到底打印了什么: 列出几个银河; 是否是有生物存在; 它们距离地球的距离. 但这个和flag有什么关系呢.😢. 想不到联系, 回到ida中再看看.</p><p><img src="/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200415192448626-1590549120154-1591952639860.png" alt="image-20200415192448626-1590549120154"></p><p>发现已经编码的字符有一个没被打印出来. 就 ctrl + x, 看哪里调用了它, 跟进去.</p><p><img src="/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200415193002493-1590549136439-1591952646896.png" alt="image-20200415193002493-1590549136439"></p><p>发现都是赋值操作, 且最后一个赋值0, 很可能是 flag 的字符串.记录开始和结束的地址, 去 OD 中动态调试.</p><p><img src="/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200415193726368-1590549141490-1591952651993.png" alt="image-20200415193726368-1590549141490"></p><p>OD中在2个地址, 下断点, 并在开始记录下赋值存放数据的地址, 把它在数据窗口中跟随. F9执行出现字符串.</p><p><img src="/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200415194242898-1590549138934-1591952658378.png" alt="image-20200415194242898-1590549138934"></p><p>心得: 注意文件中编码了但是没有使用的字符串.</p><hr><h2 id="Newbie-calculations"><a href="#Newbie-calculations" class="headerlink" title="Newbie_calculations:"></a>Newbie_calculations:</h2><p>首先从题目看出, 是新手计算, 想到应该和计算有关的.</p><p>题目下载下来, 打开后, 只是打印 <strong>Your flag is:</strong> ,就卡住了, 也没有让输入信息. 在自己写C程序也遇到过这种问题, 应该是程序有什么死循环, 或者大量耗时间的算法.</p><p>载入ida, 找到main函数, 果然有很多函数, 跟进其中一个后发现 v4 = -1, 后面又用来循环, 因为自己补码不是很清楚, 开始只是想到这不是死循环嘛, 且和自己之前的想的一样. 然后天真的认为, 它可能没用, 跳过它, 直接执行后面的或许可以找到答案, 就真的去OD, 打补丁, 程序直接奔溃.</p><p><img src="/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200417124955377-1590549145811-1591952671849.png" alt="image-20200417124955377-1590549145811"></p><p> 这个时候发现有很多函数, 都是一样的, 好像只有3个函数在哪里调用. 但想到麻烦,发现计算和补码相关, 然后自己写简单的程序程序复习了下补码, <strong>-1-128 = 127, 127+1 = -128;</strong>, 再结合之前看到的补码和时钟原理很像, 自己总结了下, 可以把这个计算想成是一个圆圈, 以一个字节8位来看, 我们知道范围是 <strong>-128 - 127</strong></p><p><img src="/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200417131746746-1590549170275-1591952678402.png" alt="image-20200417131746746-1590549170275"></p><p>知道一个周期的大小是 <strong>256</strong>. 那么有 <strong>-1+1= 0</strong> 也可以写成 <strong>-1 - 255 = 0</strong>, 相当于 -1 逆时针转了 一圈少1的距离, 那么就是0的位置, 因为如果转了一圈的话, 回到原位置,. 顺时针加法也是一样的原理, <strong>0 + 256 = 0</strong>;</p><p>知道了这一点, 那么这道题就很容易了.要使 v4 == 0, 那么相当于 v4逆时针旋转一圈少a2的距离, 相当于 v4 += a2,</p><p>那么同样的道理, –*a 经过循环后, 相当于逆时针旋转一圈少a2的距离, 就是 *a1 += a2; 补码真的神奇.😁</p><p><img src="/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200417133116275-1590549174848-1591952682724.png" alt="image-20200417133116275-1590549174848"></p><p>后面的2个函数同理分析. 将该三个函数分别改写成对应的乘, 减, 加:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> *<span class="title">sub_401100</span><span class="params">(<span class="keyword">int</span> *a, <span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	*a = (*a) * b;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span>  a; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> *<span class="title">sub_401220</span><span class="params">(<span class="keyword">int</span> *a, <span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	*a = (*a) - b;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> *<span class="title">sub_401000</span><span class="params">(<span class="keyword">int</span> *a, <span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	*a = (*a) + b; </span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> *v3; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v4;</span><br><span class="line">  <span class="keyword">int</span> *v5; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v6; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v7; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v8; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v9; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v10; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v11; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v12; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v13; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v14; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v15; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v16; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v17; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v18; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v19; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v20; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v21; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v22; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v23; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v24; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v25; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v26; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v27; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v28; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v29; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v30; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v31; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v32; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v33; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v34; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v35; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v36; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v37; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v38; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v39; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v40; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v41; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v42; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v43; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v44; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v45; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v46; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v47; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v48; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v49; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v50; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v51; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v52; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v53; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v54; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v55; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v56; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v57; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v58; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v59; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v60; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v61; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v62; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v63; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v64; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v65; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v66; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v67; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v68; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v69; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v70; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v71; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v72; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v73; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v74; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v75; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v76; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v77; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v78; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v79; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v80; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v81; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v82; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v83; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v84; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v85; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v86; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v87; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v88; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v89; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v90; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v91; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v92; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v93; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v94; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v95; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v96; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v97; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v98; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v99; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v100; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v101; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v102; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v103; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v104; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v105; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v106; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v107; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v108; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v109; <span class="comment">// ST1C_4</span></span><br><span class="line">  <span class="keyword">int</span> *v110; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v111; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v112; <span class="comment">// ST20_4</span></span><br><span class="line">  <span class="keyword">int</span> *v113; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *v114; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v115; <span class="comment">// ST20_4</span></span><br><span class="line">  <span class="keyword">int</span> *v116; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> i; <span class="comment">// [esp+4h] [ebp-90h]</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> j; <span class="comment">// [esp+8h] [ebp-8Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v120[<span class="number">32</span>]; <span class="comment">// [esp+Ch] [ebp-88h]</span></span><br><span class="line">  <span class="keyword">int</span> v121; <span class="comment">// [esp+8Ch] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">32</span>; ++i )</span><br><span class="line">    v120[i] = <span class="number">1</span>;</span><br><span class="line">  v121 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Your flag is:"</span>);</span><br><span class="line">  v3 = sub_401100(v120, <span class="number">1000000000</span>);</span><br><span class="line">  v4 = sub_401220(v3, <span class="number">999999950</span>);</span><br><span class="line">  sub_401100(v4, <span class="number">2</span>);</span><br><span class="line">  v5 = sub_401000(&amp;v120[<span class="number">1</span>], <span class="number">5000000</span>);</span><br><span class="line">  v6 = sub_401220(v5, <span class="number">6666666</span>);</span><br><span class="line">  v7 = sub_401000(v6, <span class="number">1666666</span>);</span><br><span class="line">  v8 = sub_401000(v7, <span class="number">45</span>);</span><br><span class="line">  v9 = sub_401100(v8, <span class="number">2</span>);</span><br><span class="line">  sub_401000(v9, <span class="number">5</span>);</span><br><span class="line">  v10 = sub_401100(&amp;v120[<span class="number">2</span>], <span class="number">1000000000</span>);</span><br><span class="line">  v11 = sub_401220(v10, <span class="number">999999950</span>);</span><br><span class="line">  v12 = sub_401100(v11, <span class="number">2</span>);</span><br><span class="line">  sub_401000(v12, <span class="number">2</span>);</span><br><span class="line">  v13 = sub_401000(&amp;v120[<span class="number">3</span>], <span class="number">55</span>);</span><br><span class="line">  v14 = sub_401220(v13, <span class="number">3</span>);</span><br><span class="line">  v15 = sub_401000(v14, <span class="number">4</span>);</span><br><span class="line">  sub_401220(v15, <span class="number">1</span>);</span><br><span class="line">  v16 = sub_401100(&amp;v120[<span class="number">4</span>], <span class="number">100000000</span>);</span><br><span class="line">  v17 = sub_401220(v16, <span class="number">99999950</span>);</span><br><span class="line">  v18 = sub_401100(v17, <span class="number">2</span>);</span><br><span class="line">  sub_401000(v18, <span class="number">2</span>);</span><br><span class="line">  v19 = sub_401220(&amp;v120[<span class="number">5</span>], <span class="number">1</span>);</span><br><span class="line">  v20 = sub_401100(v19, <span class="number">1000000000</span>);</span><br><span class="line">  v21 = sub_401000(v20, <span class="number">55</span>);</span><br><span class="line">  sub_401220(v21, <span class="number">3</span>);</span><br><span class="line">  v22 = sub_401100(&amp;v120[<span class="number">6</span>], <span class="number">1000000</span>);</span><br><span class="line">  v23 = sub_401220(v22, <span class="number">999975</span>);</span><br><span class="line">  sub_401100(v23, <span class="number">4</span>);</span><br><span class="line">  v24 = sub_401000(&amp;v120[<span class="number">7</span>], <span class="number">55</span>);</span><br><span class="line">  v25 = sub_401220(v24, <span class="number">33</span>);</span><br><span class="line">  v26 = sub_401000(v25, <span class="number">44</span>);</span><br><span class="line">  sub_401220(v26, <span class="number">11</span>);</span><br><span class="line">  v27 = sub_401100(&amp;v120[<span class="number">8</span>], <span class="number">10</span>);</span><br><span class="line">  v28 = sub_401220(v27, <span class="number">5</span>);</span><br><span class="line">  v29 = sub_401100(v28, <span class="number">8</span>);</span><br><span class="line">  sub_401000(v29, <span class="number">9</span>);</span><br><span class="line">  v30 = sub_401000(&amp;v120[<span class="number">9</span>], <span class="number">0</span>);</span><br><span class="line">  v31 = sub_401220(v30, <span class="number">0</span>);</span><br><span class="line">  v32 = sub_401000(v31, <span class="number">11</span>);</span><br><span class="line">  v33 = sub_401220(v32, <span class="number">11</span>);</span><br><span class="line">  sub_401000(v33, <span class="number">53</span>);</span><br><span class="line">  v34 = sub_401000(&amp;v120[<span class="number">10</span>], <span class="number">49</span>);</span><br><span class="line">  v35 = sub_401220(v34, <span class="number">2</span>);</span><br><span class="line">  v36 = sub_401000(v35, <span class="number">4</span>);</span><br><span class="line">  sub_401220(v36, <span class="number">2</span>);</span><br><span class="line">  v37 = sub_401100(&amp;v120[<span class="number">11</span>], <span class="number">1000000</span>);</span><br><span class="line">  v38 = sub_401220(v37, <span class="number">999999</span>);</span><br><span class="line">  v39 = sub_401100(v38, <span class="number">4</span>);</span><br><span class="line">  sub_401000(v39, <span class="number">50</span>);</span><br><span class="line">  v40 = sub_401000(&amp;v120[<span class="number">12</span>], <span class="number">1</span>);</span><br><span class="line">  v41 = sub_401000(v40, <span class="number">1</span>);</span><br><span class="line">  v42 = sub_401000(v41, <span class="number">1</span>);</span><br><span class="line">  v43 = sub_401000(v42, <span class="number">1</span>);</span><br><span class="line">  v44 = sub_401000(v43, <span class="number">1</span>);</span><br><span class="line">  v45 = sub_401000(v44, <span class="number">1</span>);</span><br><span class="line">  v46 = sub_401000(v45, <span class="number">10</span>);</span><br><span class="line">  sub_401000(v46, <span class="number">32</span>);</span><br><span class="line">  v47 = sub_401100(&amp;v120[<span class="number">13</span>], <span class="number">10</span>);</span><br><span class="line">  v48 = sub_401220(v47, <span class="number">5</span>);</span><br><span class="line">  v49 = sub_401100(v48, <span class="number">8</span>);</span><br><span class="line">  v50 = sub_401000(v49, <span class="number">9</span>);</span><br><span class="line">  sub_401000(v50, <span class="number">48</span>);</span><br><span class="line">  v51 = sub_401220(&amp;v120[<span class="number">14</span>], <span class="number">1</span>);</span><br><span class="line">  v52 = sub_401100(v51, <span class="number">-294967296</span>);</span><br><span class="line">  v53 = sub_401000(v52, <span class="number">55</span>);</span><br><span class="line">  sub_401220(v53, <span class="number">3</span>);</span><br><span class="line">  v54 = sub_401000(&amp;v120[<span class="number">15</span>], <span class="number">1</span>);</span><br><span class="line">  v55 = sub_401000(v54, <span class="number">2</span>);</span><br><span class="line">  v56 = sub_401000(v55, <span class="number">3</span>);</span><br><span class="line">  v57 = sub_401000(v56, <span class="number">4</span>);</span><br><span class="line">  v58 = sub_401000(v57, <span class="number">5</span>);</span><br><span class="line">  v59 = sub_401000(v58, <span class="number">6</span>);</span><br><span class="line">  v60 = sub_401000(v59, <span class="number">7</span>);</span><br><span class="line">  sub_401000(v60, <span class="number">20</span>);</span><br><span class="line">  v61 = sub_401100(&amp;v120[<span class="number">16</span>], <span class="number">10</span>);</span><br><span class="line">  v62 = sub_401220(v61, <span class="number">5</span>);</span><br><span class="line">  v63 = sub_401100(v62, <span class="number">8</span>);</span><br><span class="line">  v64 = sub_401000(v63, <span class="number">9</span>);</span><br><span class="line">  sub_401000(v64, <span class="number">48</span>);</span><br><span class="line">  v65 = sub_401000(&amp;v120[<span class="number">17</span>], <span class="number">7</span>);</span><br><span class="line">  v66 = sub_401000(v65, <span class="number">6</span>);</span><br><span class="line">  v67 = sub_401000(v66, <span class="number">5</span>);</span><br><span class="line">  v68 = sub_401000(v67, <span class="number">4</span>);</span><br><span class="line">  v69 = sub_401000(v68, <span class="number">3</span>);</span><br><span class="line">  v70 = sub_401000(v69, <span class="number">2</span>);</span><br><span class="line">  v71 = sub_401000(v70, <span class="number">1</span>);</span><br><span class="line">  sub_401000(v71, <span class="number">20</span>);</span><br><span class="line">  v72 = sub_401000(&amp;v120[<span class="number">18</span>], <span class="number">7</span>);</span><br><span class="line">  v73 = sub_401000(v72, <span class="number">2</span>);</span><br><span class="line">  v74 = sub_401000(v73, <span class="number">4</span>);</span><br><span class="line">  v75 = sub_401000(v74, <span class="number">3</span>);</span><br><span class="line">  v76 = sub_401000(v75, <span class="number">6</span>);</span><br><span class="line">  v77 = sub_401000(v76, <span class="number">5</span>);</span><br><span class="line">  v78 = sub_401000(v77, <span class="number">1</span>);</span><br><span class="line">  sub_401000(v78, <span class="number">20</span>);</span><br><span class="line">  v79 = sub_401100(&amp;v120[<span class="number">19</span>], <span class="number">1000000</span>);</span><br><span class="line">  v80 = sub_401220(v79, <span class="number">999999</span>);</span><br><span class="line">  v81 = sub_401100(v80, <span class="number">4</span>);</span><br><span class="line">  v82 = sub_401000(v81, <span class="number">50</span>);</span><br><span class="line">  sub_401220(v82, <span class="number">1</span>);</span><br><span class="line">  v83 = sub_401220(&amp;v120[<span class="number">20</span>], <span class="number">1</span>);</span><br><span class="line">  v84 = sub_401100(v83, <span class="number">-294967296</span>);</span><br><span class="line">  v85 = sub_401000(v84, <span class="number">49</span>);</span><br><span class="line">  sub_401220(v85, <span class="number">1</span>);</span><br><span class="line">  v86 = sub_401220(&amp;v120[<span class="number">21</span>], <span class="number">1</span>);</span><br><span class="line">  v87 = sub_401100(v86, <span class="number">1000000000</span>);</span><br><span class="line">  v88 = sub_401000(v87, <span class="number">54</span>);</span><br><span class="line">  v89 = sub_401220(v88, <span class="number">1</span>);</span><br><span class="line">  v90 = sub_401000(v89, <span class="number">1000000000</span>);</span><br><span class="line">  sub_401220(v90, <span class="number">1000000000</span>);</span><br><span class="line">  v91 = sub_401000(&amp;v120[<span class="number">22</span>], <span class="number">49</span>);</span><br><span class="line">  v92 = sub_401220(v91, <span class="number">1</span>);</span><br><span class="line">  v93 = sub_401000(v92, <span class="number">2</span>);</span><br><span class="line">  sub_401220(v93, <span class="number">1</span>);</span><br><span class="line">  v94 = sub_401100(&amp;v120[<span class="number">23</span>], <span class="number">10</span>);</span><br><span class="line">  v95 = sub_401220(v94, <span class="number">5</span>);</span><br><span class="line">  v96 = sub_401100(v95, <span class="number">8</span>);</span><br><span class="line">  v97 = sub_401000(v96, <span class="number">9</span>);</span><br><span class="line">  sub_401000(v97, <span class="number">48</span>);</span><br><span class="line">  v98 = sub_401000(&amp;v120[<span class="number">24</span>], <span class="number">1</span>);</span><br><span class="line">  v99 = sub_401000(v98, <span class="number">3</span>);</span><br><span class="line">  v100 = sub_401000(v99, <span class="number">3</span>);</span><br><span class="line">  v101 = sub_401000(v100, <span class="number">3</span>);</span><br><span class="line">  v102 = sub_401000(v101, <span class="number">6</span>);</span><br><span class="line">  v103 = sub_401000(v102, <span class="number">6</span>);</span><br><span class="line">  v104 = sub_401000(v103, <span class="number">6</span>);</span><br><span class="line">  sub_401000(v104, <span class="number">20</span>);</span><br><span class="line">  v105 = sub_401000(&amp;v120[<span class="number">25</span>], <span class="number">55</span>);</span><br><span class="line">  v106 = sub_401220(v105, <span class="number">33</span>);</span><br><span class="line">  v107 = sub_401000(v106, <span class="number">44</span>);</span><br><span class="line">  v108 = sub_401220(v107, <span class="number">11</span>);</span><br><span class="line">  sub_401000(v108, <span class="number">42</span>);</span><br><span class="line">  sub_401000(&amp;v120[<span class="number">26</span>], v120[<span class="number">25</span>]);</span><br><span class="line">  sub_401000(&amp;v120[<span class="number">27</span>], v120[<span class="number">12</span>]);</span><br><span class="line">  v109 = v120[<span class="number">27</span>];</span><br><span class="line">  v110 = sub_401220(&amp;v120[<span class="number">28</span>], <span class="number">1</span>);</span><br><span class="line">  v111 = sub_401000(v110, v109);</span><br><span class="line">  sub_401220(v111, <span class="number">1</span>);</span><br><span class="line">  v112 = v120[<span class="number">23</span>];</span><br><span class="line">  v113 = sub_401220(&amp;v120[<span class="number">29</span>], <span class="number">1</span>);</span><br><span class="line">  v114 = sub_401100(v113, <span class="number">1000000</span>);</span><br><span class="line">  sub_401000(v114, v112);</span><br><span class="line">  v115 = v120[<span class="number">27</span>];</span><br><span class="line">  v116 = sub_401000(&amp;v120[<span class="number">30</span>], <span class="number">1</span>);</span><br><span class="line">  sub_401100(v116, v115);</span><br><span class="line">  sub_401000(&amp;v120[<span class="number">31</span>], v120[<span class="number">30</span>]);</span><br><span class="line">  </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"CTF&#123;"</span>);</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">32</span>; ++j )</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%c"</span>, (v120[j]));</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"&#125;\n"</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="reverse-for-the-holy-grail-350"><a href="#reverse-for-the-holy-grail-350" class="headerlink" title="reverse-for-the-holy-grail-350"></a>reverse-for-the-holy-grail-350</h2><p>又是C++的题, 对于初学, 我看这个有些还是很吃力的, 有些函数功能连蒙带猜. 其实静下心来分析, 逻辑还是很简单.</p><p><img src="/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200421172942651-1590549186380-1591952692434.png" alt="image-20200421172942651-1590549186380"></p><p>找到关键函数进去后, 看起来很多, 但逻辑也是不难的.</p><p><img src="/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200421173112461-1590549193146-1591952706873.png" alt="image-20200421173112461-1590549193146"></p><p>这是程序的算法, 我挨个记录了下来……..我在到这步的时候, 就是在纠结那个取余多解的问题, 想到算起来很烦, 但由于是可输入的字符, 我们用遍历即可 (0-127)</p><p><img src="/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200421173211318-1590549201703-1591952713057.png" alt="image-20200421173211318-1590549201703"></p><p>最后附上, 代码:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> first[] = &#123;<span class="number">0x41</span>, <span class="number">0x69</span>, <span class="number">0x6e</span>, <span class="number">0x45</span>, <span class="number">0x6f</span>, <span class="number">0x61</span>&#125;;</span><br><span class="line">	<span class="keyword">int</span> second[] = &#123;<span class="number">0x2ef</span>, <span class="number">0x2c4</span>, <span class="number">0x2dc</span>, <span class="number">0x2c7</span>, <span class="number">0x2de</span>, <span class="number">0x2fc</span>&#125;;</span><br><span class="line">	<span class="keyword">int</span> third[] = &#123;<span class="number">0x1d7</span>, <span class="number">0xc</span>, <span class="number">0x244</span>, <span class="number">0x25e</span>, <span class="number">0x93</span>, <span class="number">0x6c</span>&#125;;</span><br><span class="line">	<span class="keyword">int</span> mod[<span class="number">18</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">	<span class="keyword">int</span> i = <span class="number">0</span>, n = <span class="number">666</span>, j = <span class="number">0</span>, z = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> flag[<span class="number">20</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">18</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		mod[i] = n;</span><br><span class="line">		n += n%<span class="number">5</span>; </span><br><span class="line">	&#125; </span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">18</span>; i += <span class="number">3</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		flag[i] = first[j];</span><br><span class="line">		</span><br><span class="line">		flag[i+<span class="number">2</span>] = second[j] ^ mod[i+<span class="number">2</span>];</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">for</span>(z = <span class="number">0</span>; z &lt; <span class="number">127</span>; z++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>((flag[i] ^ mod[i])*(z^mod[i+<span class="number">1</span>]) % second[j] == third[j])</span><br><span class="line">			&#123;</span><br><span class="line">				flag[i+<span class="number">1</span>] = z;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125; </span><br><span class="line">		&#125; </span><br><span class="line">		</span><br><span class="line">		j++;</span><br><span class="line">	 </span><br><span class="line">	&#125; </span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">18</span>; i++)</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%c"</span>, flag[i]);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>总结: 程序中注意看清传入参数时,是一个字节, 还是一个int类型(4个字节); 取余运算, 逆向时, 一般遍历即可.</p><hr><h2 id="elrond32"><a href="#elrond32" class="headerlink" title="elrond32"></a>elrond32</h2><p>首先, 下载下来, 用ida打开, 发现没有输入的地方. 或许是隐藏起来了. 就在linux中运行一下来看, 果然没有输入, 只是输出验证失败.</p><p>回到ida, 逻辑也很清楚, 就是一个函数的返回值 非0 即可, 进入关键函数: 也很简单, 就是一个递归调用. 从0开始, 每次 (a1) 都符合相应的值且最要最后的跳出递归即可.通过这个我们就知道了 a1数组的值. 算了一下 a2的值为: 0 7 1 3 6 5 9 4 2, 而2没有就跳出. 按照这个顺序取 (a1) .</p><p><img src="/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/image-20200421190646720-1590549218465-1591952718294.png" alt="image-20200421190646720-1590549218465"></p><p>其实浏览程序的时候, 已经看过 验证通过下面的一个函数, 就是让33个已经编码了的字符与我们得到的 (a1)异或运算, 再打印出flag. 下面C代码:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> a[] = &#123;<span class="number">105</span>, <span class="number">115</span>, <span class="number">101</span>, <span class="number">110</span>, <span class="number">103</span>, <span class="number">97</span>, <span class="number">114</span>, <span class="number">100</span>&#125;;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">union</span></span><br><span class="line">	&#123;	<span class="keyword">char</span> b[<span class="number">1000</span>];</span><br><span class="line">		<span class="keyword">int</span> n[<span class="number">33</span>];</span><br><span class="line">	&#125;A = &#123;</span><br><span class="line">   <span class="number">15</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">31</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">4</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">9</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">28</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">18</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">66</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">9</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">12</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">68</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">13</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">7</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">9</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">6</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">45</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">55</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">89</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">30</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">89</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">15</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">8</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">28</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">35</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">54</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">7</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">85</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">2</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">12</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">8</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line">   <span class="number">65</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">10</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,  <span class="number">20</span>,   <span class="number">0</span>, </span><br><span class="line">    <span class="number">0</span>,   <span class="number">0</span></span><br><span class="line">&#125;;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">char</span> flag[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">	<span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt;= <span class="number">32</span>; i++)</span><br><span class="line">	<span class="built_in">putchar</span>(A.n[i] ^ a[i % <span class="number">8</span>]);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div><ul class="post-copyright"><li class="post-copyright-author"> <strong>Post author:</strong> BIX</li><li class="post-copyright-link"> <strong>Post link:</strong> <a href="https://www.bxnop.cn/2020/04/09/re%20%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%EF%BC%881%EF%BC%89/" title="re 攻防世界（1）">https://www.bxnop.cn/2020/04/09/re 攻防世界（1）/</a></li><li class="post-copyright-license"> <strong>Copyright Notice:</strong> All articles in this blog are licensed under<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i> BY-NC-SA</a> unless stating additionally.</li></ul></div><div><div><div style="text-align:center;color:#ccc;font-size:14px">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div></div></div><footer class="post-footer"><div class="post-nav"><div class="post-nav-item"><a href="/2020/03/14/leetcode/" rel="prev" title="leetcode"><i class="fa fa-chevron-left"></i> leetcode</a></div><div class="post-nav-item"> <a href="/2020/04/23/BUUCTF/" rel="next" title="BUUCTF">BUUCTF<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc"> Table of Contents</li><li class="sidebar-nav-overview"> Overview</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#misc"><span class="nav-number">1.</span> <span class="nav-text">misc:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#reverse1"><span class="nav-number">2.</span> <span class="nav-text">reverse1:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#reverse2"><span class="nav-number">3.</span> <span class="nav-text">reverse2:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#secret-galaxy-300"><span class="nav-number">4.</span> <span class="nav-text">secret-galaxy-300</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Newbie-calculations"><span class="nav-number">5.</span> <span class="nav-text">Newbie_calculations:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#reverse-for-the-holy-grail-350"><span class="nav-number">6.</span> <span class="nav-text">reverse-for-the-holy-grail-350</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#elrond32"><span class="nav-number">7.</span> <span class="nav-text">elrond32</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><p class="site-author-name" itemprop="name">BIX</p><div class="site-description" itemprop="description">0x446e37fb</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">25</span> <span class="site-state-item-name">posts</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/"><span class="site-state-item-count">10</span> <span class="site-state-item-name">categories</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/"><span class="site-state-item-count">2</span> <span class="site-state-item-name">tags</span></a></div></nav></div><div class="cc-license motion-element" itemprop="license"> <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a></div></div><div class="back-to-top motion-element"><i class="fa fa-arrow-up"></i> <span>0%</span></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> &copy; <span itemprop="copyrightYear">2020</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">BIX</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-chart-area"></i></span> <span class="post-meta-item-text">Symbols count total:</span> <span title="Symbols count total">131k</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-coffee"></i></span> <span class="post-meta-item-text">Reading time total &asymp;</span> <span title="Reading time total">1:59</span></div></div></footer></div><script src="/lib/anime.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script><script type="text/javascript" src="/js/src/clicklove.js"></script><script type="text/javascript" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,model:{jsonPath:"/live2dw/assets/wanko.model.json"},display:{position:"left",width:150,height:300},mobile:{show:!1},log:!1})</script></body></html>