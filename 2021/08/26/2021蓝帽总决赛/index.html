<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 4.2.1"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/2.ico"><link rel="icon" type="image/png" sizes="16x16" href="/images/2.ico"><link rel="mask-icon" href="/images/logo.svg" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/all.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"bxb0.github.io",root:"/",scheme:"Gemini",version:"7.8.0",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!0,show_result:!0,style:null},back2top:{enable:!0,sidebar:!0,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><meta name="description" content="因为疫情原因，本来的北京国际会议中心的总决赛改成了线上，模式也从原来的awdplus改成了CTF解题赛，每个方向2个题。 这里来记录两道逆向题解，其中第二题因为在题目中嵌入了一个rsa问题，比赛时一直卡着。"><meta property="og:type" content="article"><meta property="og:title" content="2021蓝帽总决赛"><meta property="og:url" content="https://bxb0.github.io/2021/08/26/2021%E8%93%9D%E5%B8%BD%E6%80%BB%E5%86%B3%E8%B5%9B/index.html"><meta property="og:site_name" content="Bxb0&#39;s blog"><meta property="og:description" content="因为疫情原因，本来的北京国际会议中心的总决赛改成了线上，模式也从原来的awdplus改成了CTF解题赛，每个方向2个题。 这里来记录两道逆向题解，其中第二题因为在题目中嵌入了一个rsa问题，比赛时一直卡着。"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://bxb0.github.io/2021/08/26/2021%E8%93%9D%E5%B8%BD%E6%80%BB%E5%86%B3%E8%B5%9B/image-20210827115605895.png"><meta property="og:image" content="https://bxb0.github.io/2021/08/26/2021%E8%93%9D%E5%B8%BD%E6%80%BB%E5%86%B3%E8%B5%9B/dnZxkKX4hrNo9QI.png"><meta property="og:image" content="https://bxb0.github.io/2021/08/26/2021%E8%93%9D%E5%B8%BD%E6%80%BB%E5%86%B3%E8%B5%9B/d1xvJuFYPj6hUTm.png"><meta property="og:image" content="https://bxb0.github.io/2021/08/26/2021%E8%93%9D%E5%B8%BD%E6%80%BB%E5%86%B3%E8%B5%9B/f73BUQgtNKLo6Tb.png"><meta property="og:image" content="https://bxb0.github.io/2021/08/26/2021%E8%93%9D%E5%B8%BD%E6%80%BB%E5%86%B3%E8%B5%9B/image-20210827120432079.png"><meta property="og:image" content="https://bxb0.github.io/2021/08/26/2021%E8%93%9D%E5%B8%BD%E6%80%BB%E5%86%B3%E8%B5%9B/image-20210827133938306.png"><meta property="og:image" content="https://bxb0.github.io/2021/08/26/2021%E8%93%9D%E5%B8%BD%E6%80%BB%E5%86%B3%E8%B5%9B/image-20210827150600761.png"><meta property="og:image" content="https://bxb0.github.io/2021/08/26/2021%E8%93%9D%E5%B8%BD%E6%80%BB%E5%86%B3%E8%B5%9B/image-20210831121607930.png"><meta property="og:image" content="https://bxb0.github.io/2021/08/26/2021%E8%93%9D%E5%B8%BD%E6%80%BB%E5%86%B3%E8%B5%9B/image-20210827161449207.png"><meta property="article:published_time" content="2021-08-26T03:48:49.000Z"><meta property="article:modified_time" content="2022-01-09T09:31:03.857Z"><meta property="article:author" content="ooo"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://bxb0.github.io/2021/08/26/2021%E8%93%9D%E5%B8%BD%E6%80%BB%E5%86%B3%E8%B5%9B/image-20210827115605895.png"><link rel="canonical" href="https://bxb0.github.io/2021/08/26/2021%E8%93%9D%E5%B8%BD%E6%80%BB%E5%86%B3%E8%B5%9B/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"en"}</script><title>2021蓝帽总决赛 | Bxb0's blog</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="alternate" href="/atom.xml" title="Bxb0's blog" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="Toggle navigation bar"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">Bxb0's blog</h1><span class="logo-line-after"><i></i></span></a></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul id="menu" class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i> Home</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i> Categories<span class="badge">15</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i> Archives<span class="badge">46</span></a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> Search</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocapitalize="off" placeholder="Searching..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"><div id="no-result"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></div></header><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content post posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en"><link itemprop="mainEntityOfPage" href="https://bxb0.github.io/2021/08/26/2021%E8%93%9D%E5%B8%BD%E6%80%BB%E5%86%B3%E8%B5%9B/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.gif"><meta itemprop="name" content="ooo"><meta itemprop="description" content="0x446e37fb"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Bxb0's blog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> 2021蓝帽总决赛</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i></span> <span class="post-meta-item-text">Posted on</span> <time title="Created: 2021-08-26 11:48:49" itemprop="dateCreated datePublished" datetime="2021-08-26T11:48:49+08:00">2021-08-26</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i></span> <span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/CTF/" itemprop="url" rel="index"><span itemprop="name">CTF</span></a></span></span><br><span class="post-meta-item" title="Symbols count in article"><span class="post-meta-item-icon"><i class="far fa-file-word"></i></span> <span class="post-meta-item-text">Symbols count in article:</span> <span>19k</span></span><span class="post-meta-item" title="Reading time"><span class="post-meta-item-icon"><i class="far fa-clock"></i></span> <span class="post-meta-item-text">Reading time &asymp;</span> <span>17 mins.</span></span></div></header><div class="post-body" itemprop="articleBody"><p>因为疫情原因，本来的北京国际会议中心的总决赛改成了线上，模式也从原来的awdplus改成了CTF解题赛，每个方向2个题。</p><p>这里来记录两道逆向题解，其中第二题因为在题目中嵌入了一个rsa问题，比赛时一直卡着。<a id="more"></a></p><h3 id="abc"><a href="#abc" class="headerlink" title="abc"></a>abc</h3><p>题目中加了下面这种混淆，就是把要用的字符串或数据运算解密出来：</p><p><img src="/2021/08/26/2021%E8%93%9D%E5%B8%BD%E6%80%BB%E5%86%B3%E8%B5%9B/image-20210827115605895.png" alt="image-20210827115605895"></p><p>然后很多的同一类型花指令，简单用idapython去除一下就好，主要看看函数大体就可以了，调试就很快。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> ida_bytes <span class="keyword">import</span> *</span><br><span class="line">addr = <span class="number">0x400640</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> addr &lt;= <span class="number">0x401592</span>:</span><br><span class="line">    <span class="keyword">if</span> get_byte(addr) == <span class="number">0xe8</span> <span class="keyword">and</span> get_byte(addr+<span class="number">1</span>) == <span class="number">0x0</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">17</span>):</span><br><span class="line">            <span class="keyword">if</span> i <span class="keyword">not</span> <span class="keyword">in</span> [<span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>]:</span><br><span class="line">                patch_byte(addr+i, <span class="number">0x90</span>)</span><br><span class="line">            <span class="keyword">elif</span> i == <span class="number">10</span>:</span><br><span class="line">                patch_byte(addr+i, <span class="number">0xe8</span>)</span><br><span class="line">    addr += <span class="number">1</span></span><br><span class="line">print(<span class="string">'*'</span>*<span class="number">100</span>)</span><br></pre></td></tr></table></figure><p>对输入下内存断点，断到处理输入的核心函数：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> __fastcall __<span class="function">noreturn <span class="title">sub_401308</span><span class="params">(__int64 a1, __int64 a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v2; <span class="comment">// rax</span></span><br><span class="line">  __int64 v3; <span class="comment">// rbp</span></span><br><span class="line">  <span class="keyword">char</span> *v4; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// ecx</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( *(<span class="keyword">int</span> *)(v3 - <span class="number">16</span>) &gt;= v2 )</span><br><span class="line">  &#123;</span><br><span class="line">    *(_BYTE *)(v3 - <span class="number">128</span>) = __ROR4__(__ROL4__(<span class="number">-1109410466</span>, <span class="number">15</span>) ^ <span class="number">0xDEADBEEF</span>, <span class="number">10</span>);</span><br><span class="line">    *(_BYTE *)(v3 - <span class="number">127</span>) = __ROR4__(__ROL4__(<span class="number">-1109410466</span>, <span class="number">15</span>) ^ <span class="number">0xDEADBEEF</span>, <span class="number">10</span>);</span><br><span class="line">    *(_BYTE *)(v3 - <span class="number">126</span>) = __ROR4__(__ROL4__(<span class="number">-2048934564</span>, <span class="number">15</span>) ^ <span class="number">0xDEADBEEF</span>, <span class="number">10</span>);</span><br><span class="line">    <span class="keyword">for</span> ( *(_DWORD *)(v3 - <span class="number">16</span>) = __ROR4__(__ROL4__(<span class="number">2111815003</span>, <span class="number">15</span>) ^ <span class="number">0xDEADBEEF</span>, <span class="number">10</span>);</span><br><span class="line">          (<span class="keyword">unsigned</span> __int64)*(<span class="keyword">int</span> *)(v3 - <span class="number">16</span>) &lt; <span class="number">3</span>;</span><br><span class="line">          *(_DWORD *)(v3 - <span class="number">16</span>) = *(_DWORD *)(v3 - <span class="number">16</span>) - <span class="number">118</span> + <span class="number">119</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      sub_4014B2();</span><br><span class="line">      *(_BYTE *)(*(<span class="keyword">int</span> *)(v3 - <span class="number">16</span>) + v3 - <span class="number">128</span>) = ~*(_BYTE *)(*(<span class="keyword">int</span> *)(v3 - <span class="number">16</span>) + v3 - <span class="number">128</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    sub_401718();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    ++*(_DWORD *)(v3 - <span class="number">16</span>);</span><br><span class="line">    sub_40133C();</span><br><span class="line">    v5 = *v4;</span><br><span class="line">    <span class="keyword">switch</span> ( v5 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">'#'</span>:</span><br><span class="line">        sub_400A65();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">'$'</span>:</span><br><span class="line">        sub_40085B(a1, a2);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">'%'</span>:</span><br><span class="line">        sub_400B6D();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">'@'</span>:</span><br><span class="line">        sub_40095D(a1, a2);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line">        sub_4013EE();</span><br><span class="line">        sub_400C6F(a1, a2);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>调试可以知道，我们的输入要对应case语句的4个参数。</p><p>看到第一个case对应的处理函数：就是对box进行数据换位置。</p><p><img src="/2021/08/26/2021%E8%93%9D%E5%B8%BD%E6%80%BB%E5%86%B3%E8%B5%9B/dnZxkKX4hrNo9QI.png" alt="image-20210824170542878"></p><p>再看最后的判断条件:</p><p><img src="/2021/08/26/2021%E8%93%9D%E5%B8%BD%E6%80%BB%E5%86%B3%E8%B5%9B/d1xvJuFYPj6hUTm.png" alt="image-20210824171449397"></p><p>从上可以抽象出来是一个4*4的华容道游戏。</p><p>开始我是写的一个dfs来搜索，因为限定条件比较少，很花时间，算法太菜了：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt; </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> enc[] = &#123;<span class="number">1</span>, <span class="number">0x0A</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">0x0D</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">-1</span>, <span class="number">7</span>, <span class="number">0x0B</span>, <span class="number">0x0E</span>, <span class="number">0x0F</span>, <span class="number">0x0C</span>, <span class="number">8</span>&#125;;</span><br><span class="line"><span class="keyword">char</span> d[] = <span class="string">"#$%@"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span>  </span><br><span class="line"><span class="keyword">char</span> flag[<span class="number">200</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fun1</span><span class="params">(<span class="keyword">char</span> *a, <span class="keyword">int</span> index)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> tmp = a[index];</span><br><span class="line">	a[index] = a[index+<span class="number">1</span>];</span><br><span class="line">	a[index+<span class="number">1</span>] = tmp;	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fun2</span><span class="params">(<span class="keyword">char</span> *a, <span class="keyword">int</span> index)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> tmp = a[index];</span><br><span class="line">	a[index] = a[index<span class="number">-4</span>];</span><br><span class="line">	a[index<span class="number">-4</span>] = tmp;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fun3</span><span class="params">(<span class="keyword">char</span> *a, <span class="keyword">int</span> index)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> tmp = a[index];</span><br><span class="line">	a[index] = a[index<span class="number">-1</span>];</span><br><span class="line">	a[index<span class="number">-1</span>] = tmp;	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fun4</span><span class="params">(<span class="keyword">char</span> *a, <span class="keyword">int</span> index)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> tmp = a[index];</span><br><span class="line">	a[index] = a[index+<span class="number">4</span>];</span><br><span class="line">	a[index+<span class="number">4</span>] = tmp;</span><br><span class="line">		</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find_index</span><span class="params">(<span class="keyword">char</span> *a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> index = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(a[i] == <span class="number">-1</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			index = i;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> index;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">check</span><span class="params">(<span class="keyword">char</span> *a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">15</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(a[i] != i+<span class="number">1</span>)</span><br><span class="line">			<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">char</span> *a, <span class="keyword">int</span> <span class="built_in">step</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(check(a))</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"found: %s"</span>, flag);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(<span class="built_in">step</span> &gt; <span class="number">16</span>)</span><br><span class="line">		<span class="keyword">return</span> ;</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">puts</span>(flag);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">	&#123;	</span><br><span class="line">		<span class="keyword">char</span> *tmp = (<span class="keyword">char</span> *)alloca(<span class="number">16</span>);</span><br><span class="line">		<span class="built_in">memcpy</span>(tmp, enc, <span class="number">16</span>);</span><br><span class="line">		<span class="keyword">int</span> index = find_index(enc);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>((i == <span class="number">0</span> &amp;&amp; (index%<span class="number">4</span>) &gt;= <span class="number">3</span>) || (i == <span class="number">1</span> &amp;&amp; (index/<span class="number">4</span>) &lt;= <span class="number">0</span>) || (i == <span class="number">2</span> &amp;&amp; (index%<span class="number">4</span>) &lt;= <span class="number">0</span>) || (i == <span class="number">3</span> &amp;&amp; (index/<span class="number">4</span>) &gt;= <span class="number">3</span>))</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">			</span><br><span class="line">		<span class="keyword">if</span>(i == <span class="number">0</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			flag[<span class="built_in">step</span>] = d[i];</span><br><span class="line">			fun1(enc, index);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(i == <span class="number">1</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			flag[<span class="built_in">step</span>] = d[i];</span><br><span class="line">			fun2(enc, index);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(i == <span class="number">2</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			flag[<span class="built_in">step</span>] = d[i];</span><br><span class="line">			fun3(enc, index);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(i == <span class="number">3</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			flag[<span class="built_in">step</span>] = d[i];</span><br><span class="line">			fun4(enc, index);</span><br><span class="line">		&#125;</span><br><span class="line">		dfs(enc, <span class="built_in">step</span>+<span class="number">1</span>);</span><br><span class="line">		<span class="built_in">memcpy</span>(enc, tmp, <span class="number">16</span>);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%d, "</span>, enc[i]);</span><br><span class="line">	&#125;</span><br><span class="line"><span class="comment">/*	for(int i = 0; i &lt; 4; i++)</span></span><br><span class="line"><span class="comment">	&#123;</span></span><br><span class="line"><span class="comment">		for(int j = 0; j &lt; 4; j++)</span></span><br><span class="line"><span class="comment">		&#123;</span></span><br><span class="line"><span class="comment">			printf("%02d ", enc[4*i+j]);</span></span><br><span class="line"><span class="comment">		&#125;</span></span><br><span class="line"><span class="comment">		putchar(10);</span></span><br><span class="line"><span class="comment">	&#125;*/</span></span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	dfs(enc, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>最后找到github上一个解华容道的项目<a href="https://github.com/Dpxx/Klotski-15puzzles" target="_blank" rel="noopener">https://github.com/Dpxx/Klotski-15puzzles</a></p><p>快的离谱：</p><p><img src="/2021/08/26/2021%E8%93%9D%E5%B8%BD%E6%80%BB%E5%86%B3%E8%B5%9B/f73BUQgtNKLo6Tb.png" alt="image-20210824171658704"></p><p>最后转化一下：<strong>$$##$$%%@@##$$%%@@</strong></p><h3 id="en"><a href="#en" class="headerlink" title="en"></a>en</h3><p>这个题目最后也只有2解。我比赛时一直卡在rsa算法上，没想到逆向题还真就嵌入一个rsa的题。</p><p>通过这个题学习基本的pyc文件，对对抗混淆做好基础。</p><p>看题目的给的密文，加上看pyc文件中的字符串可以猜测是rsa加密。</p><p>尝试使用uncompyle6对该pyc文件反编译，报错。</p><p><img src="/2021/08/26/2021%E8%93%9D%E5%B8%BD%E6%80%BB%E5%86%B3%E8%B5%9B/image-20210827120432079.png" alt="image-20210827120432079"></p><p>这个问题了解过的原因基本上就是对字节码加了混淆，如下面举例这个。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">|   <span class="number">1</span>           <span class="number">0</span> JUMP_ABSOLUTE        [<span class="number">71</span> <span class="number">06</span> <span class="number">00</span>]     <span class="number">6</span> </span><br><span class="line">|               <span class="number">3</span> LOAD_CONST           [<span class="number">64</span> FF FF] <span class="number">65535</span> (FAKE!)</span><br><span class="line">|         &gt;&gt;    <span class="number">6</span> LOAD_CONST           [<span class="number">64</span> <span class="number">00</span> <span class="number">00</span>]     <span class="number">0</span> (Hello World)</span><br><span class="line">|               <span class="number">9</span> PRINT_ITEM           [<span class="number">47</span> -- --]</span><br><span class="line">|              <span class="number">10</span> PRINT_NEWLINE        [<span class="number">48</span> -- --]</span><br><span class="line">|              <span class="number">11</span> LOAD_CONST           [<span class="number">64</span> <span class="number">01</span> <span class="number">00</span>]     <span class="number">1</span> (<span class="literal">None</span>)</span><br><span class="line">|              <span class="number">14</span> RETURN_VALUE         [<span class="number">53</span> -- --]</span><br></pre></td></tr></table></figure><p>我们看到第二条指令<strong>3 LOAD_CONST [64 FF FF] 65535</strong>，对于如何解析这个指令我们可以看到这两篇官方文档：<a href="https://docs.python.org/2/library/dis.html" target="_blank" rel="noopener">https://docs.python.org/2/library/dis.html</a> <a href="https://github.com/Python/cpython/blob/2.7/Include/opcode.h" target="_blank" rel="noopener">https://github.com/Python/cpython/blob/2.7/Include/opcode.h</a></p><p><strong>64 FF FF</strong>是实际在pyc文件中存放的字节码，也是这一条指令的组成，其中64是表示操作指令，FF FF表示所带参数。（在字节码对象的co_code中分为无参数指令（1字节）和有参数指令（3字节））。</p><p><img src="/2021/08/26/2021%E8%93%9D%E5%B8%BD%E6%80%BB%E5%86%B3%E8%B5%9B/image-20210827133938306.png" alt="image-20210827133938306"></p><p>所以第二条指令的意思就是加载代码对象的常量表的第65535项到栈顶，常量表是存储了一个PyCodeObject中的常量的数组。而这里的index是65535，显然是超过了这个数组的大小。报的错也是数组越界。</p><p>但是第一条指令是一个绝对跳转，它跳到了编号为6的位置（也就是用&gt;&gt;符号标明了的）进而跳过他后面一条错误指令（3 LOAD_CONST）的执行。</p><p>所以实际执行的指令其实是这样：</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">|               <span class="number">6</span> LOAD_CONST           [<span class="number">64</span> <span class="number">00</span> <span class="number">00</span>]     <span class="number">0</span> (Hello World)</span><br><span class="line">|               <span class="number">9</span> PRINT_ITEM           [<span class="number">47</span> -- --]</span><br><span class="line">|              <span class="number">10</span> PRINT_NEWLINE        [<span class="number">48</span> -- --]</span><br><span class="line">|              <span class="number">11</span> LOAD_CONST           [<span class="number">64</span> <span class="number">01</span> <span class="number">00</span>]     <span class="number">1</span> (None)</span><br><span class="line">|              <span class="number">14</span> RETURN_VALUE         [<span class="number">53</span> -- --]</span><br></pre></td></tr></table></figure><p>我们实验一下如何看一个PyCodeObject中常量的个数，如下所示。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">p</span><span class="params">()</span>:</span></span><br><span class="line"><span class="meta">... </span>    a = <span class="number">12</span></span><br><span class="line"><span class="meta">... </span>    b = <span class="number">13</span></span><br><span class="line">...</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>p.__code__</span><br><span class="line">&lt;code object p at <span class="number">0x000002509037CEA0</span>, file <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>p = p.__code__</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>p.co_consts</span><br><span class="line">(<span class="literal">None</span>, <span class="number">12</span>, <span class="number">13</span>)</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure><p>这里提到了PyCodeObject，那什么是PyCodeObject呢。</p><p>从code.h头文件中找到它的结构：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Bytecode object */</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">    PyObject_HEAD</span><br><span class="line">    <span class="keyword">int</span> co_argcount;        <span class="comment">/* #arguments, except *args */</span></span><br><span class="line">    <span class="keyword">int</span> co_nlocals;     <span class="comment">/* #local variables */</span></span><br><span class="line">    <span class="keyword">int</span> co_stacksize;       <span class="comment">/* #entries needed for evaluation stack */</span></span><br><span class="line">    <span class="keyword">int</span> co_flags;       <span class="comment">/* CO_..., see below */</span></span><br><span class="line">    PyObject *co_code;      <span class="comment">/* instruction opcodes */</span></span><br><span class="line">    PyObject *co_consts;    <span class="comment">/* list (constants used) */</span></span><br><span class="line">    PyObject *co_names;     <span class="comment">/* list of strings (names used) */</span></span><br><span class="line">    PyObject *co_varnames;  <span class="comment">/* tuple of strings (local variable names) */</span></span><br><span class="line">    PyObject *co_freevars;  <span class="comment">/* tuple of strings (free variable names) */</span></span><br><span class="line">    PyObject *co_cellvars;      <span class="comment">/* tuple of strings (cell variable names) */</span></span><br><span class="line">    <span class="comment">/* The rest doesn't count for hash/cmp */</span></span><br><span class="line">    PyObject *co_filename;  <span class="comment">/* string (where it was loaded from) */</span></span><br><span class="line">    PyObject *co_name;      <span class="comment">/* string (name, for reference) */</span></span><br><span class="line">    <span class="keyword">int</span> co_firstlineno;     <span class="comment">/* first source line number */</span></span><br><span class="line">    PyObject *co_lnotab;    <span class="comment">/* string (encoding addr&lt;-&gt;lineno mapping) See</span></span><br><span class="line"><span class="comment">                   Objects/lnotab_notes.txt for details. */</span></span><br><span class="line">    <span class="keyword">void</span> *co_zombieframe;     <span class="comment">/* for optimization only (see frameobject.c) */</span></span><br><span class="line">    PyObject *co_weakreflist;   <span class="comment">/* to support weakrefs to code objects */</span></span><br><span class="line">&#125; PyCodeObject;</span><br></pre></td></tr></table></figure><p>在我们写好python代码，执行的时候它是先编译成pyc字节码，再通过解释执行pyc字节码。pyc文件PyCodeObject对象的持久化保存方式。 它按照python代码中代码的作用域来划分成PyCodeObject的。</p><p>写了如下简单的py代码来实验：</p><p>它就应该是有3个PyCodeObject的，一个整体的module，和funa，q</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">funa</span><span class="params">()</span>:</span></span><br><span class="line">	a = <span class="number">1</span></span><br><span class="line">	print(a)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">q</span><span class="params">()</span>:</span></span><br><span class="line">	a = <span class="number">2</span></span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">funb</span><span class="params">(self)</span>:</span></span><br><span class="line">		b = <span class="number">3</span></span><br><span class="line">		print(b)</span><br><span class="line"></span><br><span class="line">funa()</span><br><span class="line">q().funb()</span><br></pre></td></tr></table></figure><p>编译：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 -m py_compile 1.py</span><br></pre></td></tr></table></figure><p>载入生成的1.pyc文件到010editor使用模板查看：一个大的module对象的object consts包括了funa，q的PyCodeObject对象。</p><p><img src="/2021/08/26/2021%E8%93%9D%E5%B8%BD%E6%80%BB%E5%86%B3%E8%B5%9B/image-20210827150600761.png" alt="image-20210827150600761"></p><p>整体上来说这个pyc文件格式是很简单的，很多结构都是：<strong>类型+长度+内容</strong> 的格式。</p><p>回到做题的时候来。上面是用绝对跳转跳过错误代码的混淆字节码方式，其它还有虚假分支，重叠之类等，他们的原理其实都是差不多的，和x86平台下加的一般花指令极其类似。</p><p>然后回到这个题目上来，因为使用uncomple6没有反编译成功，我去尝试了使用<strong>marshal</strong>来反序列化pyc文件中的PyCodeObject，再使用diss模块进行反汇编。</p><blockquote><p>注意：</p><p>pyc文件由三部分组成<strong>magic number + 源代码文件信息 + PyCodeObject</strong></p><p>不同版本的python编译的pyc文件的<strong>magic number + 源代码文件信息</strong>都是不同的。</p><p>python2.7中除了4字节的<strong>magic number</strong>还有4字节的时间戳，所以<strong>PyCodeObject</strong>在第8个字节后面。</p><p>python3.5与python3.6在python2.7的基础上还多了4字节的源文件大小，所以<strong>PyCodeObject</strong>在12字节后面。</p><p>python3.7以上还增加了校验hash值，当4-8字节为全0时表示没有启用hash校验，其后的8-16字节表示时间戳与源文件大小；但当4-8字节为0100 0000或者0300 0000时，8-16字节表示文件的hash值。所以<strong>PyCodeObject</strong>在16字节后面。</p></blockquote><p>我们来看一下这个pyc文件头部信息：<strong>420D0D0A</strong>表示python版本为3.7，它的4-8字节全0表明后面的8-16字节为时间戳与源文件大小。</p><p><img src="/2021/08/26/2021%E8%93%9D%E5%B8%BD%E6%80%BB%E5%86%B3%E8%B5%9B/image-20210831121607930.png" alt="image-20210831121607930"></p><p>从上可以知道这个文件的PyCodeObject在16字节后面，因此下面的代码中使用的<strong>f.seek(16)</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> marshal, dis</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'en.pyc'</span>, <span class="string">'rb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">	f.seek(<span class="number">16</span>)</span><br><span class="line">	code = marshal.load(f)</span><br><span class="line">f.close()</span><br><span class="line">print(dis.dis(code))</span><br></pre></td></tr></table></figure><p>可是在使用marshal进行反序列化时就出现了问题。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">"1.py"</span>, line 4, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">    code = marshal.load(f)</span><br><span class="line">ValueError: bad marshal data (unknown <span class="built_in">type</span> code)</span><br></pre></td></tr></table></figure><p>这是python版本不匹配出现的问题，该pyc文件是python3.7编译的，而我的环境是python3.8。</p><p>最后使用<strong>pycdas</strong>成功反汇编了一部分，看到没有反汇编成功的提示：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Error disassembling en.pyc: vector::_M_range_check: __n (<span class="built_in">which</span> is 63) &gt;= this-&gt;size() (<span class="built_in">which</span> is 14)</span><br></pre></td></tr></table></figure><p>根据提示把对应的数字改小就可以了。</p><p>最后得到全部的反汇编结果：可能部分指令是不正确的，因为我上面对pyc文件的修改也是大概来的。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br></pre></td><td class="code"><pre><span class="line">en.pyc (Python <span class="number">3.7</span>)</span><br><span class="line">[Code]</span><br><span class="line">    File Name: /somewhere/encrypt.py</span><br><span class="line">    Object Name: &lt;module&gt;</span><br><span class="line">    Arg Count: <span class="number">0</span></span><br><span class="line">    KW Only Arg Count: <span class="number">0</span></span><br><span class="line">    Locals: <span class="number">0</span></span><br><span class="line">    Stack Size: <span class="number">3</span></span><br><span class="line">    Flags: <span class="number">0x00000040</span> (CO_NOFREE)</span><br><span class="line">    [Names]</span><br><span class="line">        <span class="string">'gmpy2'</span></span><br><span class="line">        <span class="string">'g'</span></span><br><span class="line">        <span class="string">'Crypto.Util.number'</span></span><br><span class="line">        <span class="string">'long_to_bytes'</span></span><br><span class="line">        <span class="string">'bytes_to_long'</span></span><br><span class="line">        <span class="string">'random'</span></span><br><span class="line">        <span class="string">'gen_num'</span></span><br><span class="line">        <span class="string">'gen_prime'</span></span><br><span class="line">        <span class="string">'po'</span></span><br><span class="line">        <span class="string">'e2'</span></span><br><span class="line">        <span class="string">'__name__'</span></span><br><span class="line">        <span class="string">'sys'</span></span><br><span class="line">        <span class="string">'len'</span></span><br><span class="line">        <span class="string">'argv'</span></span><br><span class="line">        <span class="string">'encode'</span></span><br><span class="line">        <span class="string">'base64'</span></span><br><span class="line">        <span class="string">'B'</span></span><br><span class="line">        <span class="string">'b64decode'</span></span><br><span class="line">        <span class="string">'flag'</span></span><br><span class="line">    [Var Names]</span><br><span class="line">    [Free Vars]</span><br><span class="line">    [Cell Vars]</span><br><span class="line">    [Constants]</span><br><span class="line">        <span class="number">0</span></span><br><span class="line">        <span class="literal">None</span></span><br><span class="line">        (</span><br><span class="line">            <span class="string">'long_to_bytes'</span></span><br><span class="line">            <span class="string">'bytes_to_long'</span></span><br><span class="line">        )</span><br><span class="line">        [Code]</span><br><span class="line">            File Name: /somewhere/encrypt.py</span><br><span class="line">            Object Name: gen_num</span><br><span class="line">            Arg Count: <span class="number">1</span></span><br><span class="line">            KW Only Arg Count: <span class="number">0</span></span><br><span class="line">            Locals: <span class="number">3</span></span><br><span class="line">            Stack Size: <span class="number">6</span></span><br><span class="line">            Flags: <span class="number">0x00000043</span> (CO_OPTIMIZED | CO_NEWLOCALS | CO_NOFREE)</span><br><span class="line">            [Names]</span><br><span class="line">                <span class="string">'range'</span></span><br><span class="line">                <span class="string">'random'</span></span><br><span class="line">                <span class="string">'choice'</span></span><br><span class="line">            [Var Names]</span><br><span class="line">                <span class="string">'n_bits'</span></span><br><span class="line">                <span class="string">'res'</span></span><br><span class="line">                <span class="string">'i'</span></span><br><span class="line">            [Free Vars]</span><br><span class="line">            [Cell Vars]</span><br><span class="line">            [Constants]</span><br><span class="line">                <span class="literal">None</span></span><br><span class="line">                <span class="number">0</span></span><br><span class="line">                <span class="number">1</span></span><br><span class="line">            [Disassembly]</span><br><span class="line">                <span class="number">0</span>       LOAD_CONST              <span class="number">1</span>: <span class="number">0</span></span><br><span class="line">                <span class="number">2</span>       STORE_FAST              <span class="number">1</span>: res</span><br><span class="line">                <span class="number">4</span>       SETUP_LOOP              <span class="number">50</span> (to <span class="number">56</span>)</span><br><span class="line">                <span class="number">6</span>       LOAD_GLOBAL             <span class="number">0</span>: range</span><br><span class="line">                <span class="number">8</span>       LOAD_FAST               <span class="number">0</span>: n_bits</span><br><span class="line">                <span class="number">10</span>      CALL_FUNCTION           <span class="number">1</span></span><br><span class="line">                <span class="number">12</span>      GET_ITER                </span><br><span class="line">                <span class="number">14</span>      FOR_ITER                <span class="number">38</span> (to <span class="number">54</span>)</span><br><span class="line">                <span class="number">16</span>      STORE_FAST              <span class="number">2</span>: i</span><br><span class="line">                <span class="number">18</span>      LOAD_FAST               <span class="number">1</span>: res</span><br><span class="line">                <span class="number">20</span>      LOAD_CONST              <span class="number">1</span>: <span class="number">0</span></span><br><span class="line">                <span class="number">22</span>      COMPARE_OP              <span class="number">3</span> (!=)</span><br><span class="line">                <span class="number">24</span>      POP_JUMP_IF_FALSE       <span class="number">34</span></span><br><span class="line">                <span class="number">26</span>      LOAD_FAST               <span class="number">1</span>: res</span><br><span class="line">                <span class="number">28</span>      LOAD_CONST              <span class="number">2</span>: <span class="number">1</span></span><br><span class="line">                <span class="number">30</span>      INPLACE_LSHIFT          </span><br><span class="line">                <span class="number">32</span>      STORE_FAST              <span class="number">1</span>: res</span><br><span class="line">                <span class="number">34</span>      LOAD_FAST               <span class="number">1</span>: res</span><br><span class="line">                <span class="number">36</span>      LOAD_GLOBAL             <span class="number">1</span>: random</span><br><span class="line">                <span class="number">38</span>      LOAD_METHOD             <span class="number">2</span>: choice</span><br><span class="line">                <span class="number">40</span>      LOAD_CONST              <span class="number">1</span>: <span class="number">0</span></span><br><span class="line">                <span class="number">42</span>      LOAD_CONST              <span class="number">2</span>: <span class="number">1</span></span><br><span class="line">                <span class="number">44</span>      BUILD_LIST              <span class="number">2</span></span><br><span class="line">                <span class="number">46</span>      CALL_METHOD             <span class="number">1</span></span><br><span class="line">                <span class="number">48</span>      UNARY_POSITIVE          </span><br><span class="line">                <span class="number">50</span>      STORE_FAST              <span class="number">1</span>: res</span><br><span class="line">                <span class="number">52</span>      JUMP_ABSOLUTE           <span class="number">14</span></span><br><span class="line">                <span class="number">54</span>      POP_BLOCK               </span><br><span class="line">                <span class="number">56</span>      LOAD_FAST               <span class="number">1</span>: res</span><br><span class="line">                <span class="number">58</span>      RETURN_VALUE            </span><br><span class="line">        <span class="string">'gen_num'</span></span><br><span class="line">        [Code]</span><br><span class="line">            File Name: /somewhere/encrypt.py</span><br><span class="line">            Object Name: gen_prime</span><br><span class="line">            Arg Count: <span class="number">1</span></span><br><span class="line">            KW Only Arg Count: <span class="number">0</span></span><br><span class="line">            Locals: <span class="number">3</span></span><br><span class="line">            Stack Size: <span class="number">3</span></span><br><span class="line">            Flags: <span class="number">0x00000043</span> (CO_OPTIMIZED | CO_NEWLOCALS | CO_NOFREE)</span><br><span class="line">            [Names]</span><br><span class="line">                <span class="string">'gen_num'</span></span><br><span class="line">                <span class="string">'g'</span></span><br><span class="line">                <span class="string">'is_prime'</span></span><br><span class="line">            [Var Names]</span><br><span class="line">                <span class="string">'n_bits'</span></span><br><span class="line">                <span class="string">'res'</span></span><br><span class="line">                <span class="string">'b'</span></span><br><span class="line">            [Free Vars]</span><br><span class="line">            [Cell Vars]</span><br><span class="line">            [Constants]</span><br><span class="line">                <span class="literal">None</span></span><br><span class="line">                <span class="number">1</span></span><br><span class="line">                <span class="number">0</span></span><br><span class="line">            [Disassembly]</span><br><span class="line">                <span class="number">0</span>       LOAD_GLOBAL             <span class="number">0</span>: gen_num</span><br><span class="line">                <span class="number">2</span>       LOAD_FAST               <span class="number">0</span>: n_bits</span><br><span class="line">                <span class="number">4</span>       CALL_FUNCTION           <span class="number">1</span></span><br><span class="line">                <span class="number">6</span>       STORE_FAST              <span class="number">1</span>: res</span><br><span class="line">                <span class="number">8</span>       SETUP_LOOP              <span class="number">54</span> (to <span class="number">64</span>)</span><br><span class="line">                <span class="number">10</span>      LOAD_GLOBAL             <span class="number">1</span>: g</span><br><span class="line">                <span class="number">12</span>      LOAD_METHOD             <span class="number">2</span>: is_prime</span><br><span class="line">                <span class="number">14</span>      LOAD_FAST               <span class="number">1</span>: res</span><br><span class="line">                <span class="number">16</span>      CALL_METHOD             <span class="number">1</span></span><br><span class="line">                <span class="number">18</span>      POP_JUMP_IF_TRUE        <span class="number">62</span></span><br><span class="line">                <span class="number">20</span>      LOAD_CONST              <span class="number">1</span>: <span class="number">1</span></span><br><span class="line">                <span class="number">22</span>      STORE_FAST              <span class="number">2</span>: b</span><br><span class="line">                <span class="number">24</span>      SETUP_LOOP              <span class="number">34</span> (to <span class="number">60</span>)</span><br><span class="line">                <span class="number">26</span>      LOAD_FAST               <span class="number">2</span>: b</span><br><span class="line">                <span class="number">28</span>      LOAD_CONST              <span class="number">2</span>: <span class="number">0</span></span><br><span class="line">                <span class="number">30</span>      COMPARE_OP              <span class="number">3</span> (!=)</span><br><span class="line">                <span class="number">32</span>      POP_JUMP_IF_FALSE       <span class="number">58</span></span><br><span class="line">                <span class="number">34</span>      LOAD_FAST               <span class="number">1</span>: res</span><br><span class="line">                <span class="number">36</span>      LOAD_FAST               <span class="number">2</span>: b</span><br><span class="line">                <span class="number">38</span>      BINARY_XOR              </span><br><span class="line">                <span class="number">40</span>      LOAD_FAST               <span class="number">1</span>: res</span><br><span class="line">                <span class="number">42</span>      LOAD_FAST               <span class="number">2</span>: b</span><br><span class="line">                <span class="number">44</span>      BINARY_AND              </span><br><span class="line">                <span class="number">46</span>      LOAD_CONST              <span class="number">1</span>: <span class="number">1</span></span><br><span class="line">                <span class="number">48</span>      BINARY_LSHIFT           </span><br><span class="line">                <span class="number">50</span>      ROT_TWO                 </span><br><span class="line">                <span class="number">52</span>      STORE_FAST              <span class="number">1</span>: res</span><br><span class="line">                <span class="number">54</span>      STORE_FAST              <span class="number">2</span>: b</span><br><span class="line">                <span class="number">56</span>      JUMP_ABSOLUTE           <span class="number">26</span></span><br><span class="line">                <span class="number">58</span>      POP_BLOCK               </span><br><span class="line">                <span class="number">60</span>      JUMP_ABSOLUTE           <span class="number">10</span></span><br><span class="line">                <span class="number">62</span>      POP_BLOCK               </span><br><span class="line">                <span class="number">64</span>      LOAD_FAST               <span class="number">1</span>: res</span><br><span class="line">                <span class="number">66</span>      RETURN_VALUE            </span><br><span class="line">        <span class="string">'gen_prime'</span></span><br><span class="line">        [Code]</span><br><span class="line">            File Name: /somewhere/encrypt.py</span><br><span class="line">            Object Name: po</span><br><span class="line">            Arg Count: <span class="number">3</span></span><br><span class="line">            KW Only Arg Count: <span class="number">0</span></span><br><span class="line">            Locals: <span class="number">5</span></span><br><span class="line">            Stack Size: <span class="number">2</span></span><br><span class="line">            Flags: <span class="number">0x00000043</span> (CO_OPTIMIZED | CO_NEWLOCALS | CO_NOFREE)</span><br><span class="line">            [Names]</span><br><span class="line">            [Var Names]</span><br><span class="line">                <span class="string">'a'</span></span><br><span class="line">                <span class="string">'b'</span></span><br><span class="line">                <span class="string">'n'</span></span><br><span class="line">                <span class="string">'res'</span></span><br><span class="line">                <span class="string">'aa'</span></span><br><span class="line">            [Free Vars]</span><br><span class="line">            [Cell Vars]</span><br><span class="line">            [Constants]</span><br><span class="line">                <span class="literal">None</span></span><br><span class="line">                <span class="number">1</span></span><br><span class="line">                <span class="number">0</span></span><br><span class="line">            [Disassembly]</span><br><span class="line">                <span class="number">0</span>       LOAD_CONST              <span class="number">1</span>: <span class="number">1</span></span><br><span class="line">                <span class="number">2</span>       STORE_FAST              <span class="number">3</span>: res</span><br><span class="line">                <span class="number">4</span>       LOAD_FAST               <span class="number">0</span>: a</span><br><span class="line">                <span class="number">6</span>       STORE_FAST              <span class="number">4</span>: aa</span><br><span class="line">                <span class="number">8</span>       SETUP_LOOP              <span class="number">52</span> (to <span class="number">62</span>)</span><br><span class="line">                <span class="number">10</span>      LOAD_FAST               <span class="number">1</span>: b</span><br><span class="line">                <span class="number">12</span>      LOAD_CONST              <span class="number">2</span>: <span class="number">0</span></span><br><span class="line">                <span class="number">14</span>      COMPARE_OP              <span class="number">3</span> (!=)</span><br><span class="line">                <span class="number">16</span>      POP_JUMP_IF_FALSE       <span class="number">60</span></span><br><span class="line">                <span class="number">18</span>      LOAD_FAST               <span class="number">1</span>: b</span><br><span class="line">                <span class="number">20</span>      LOAD_CONST              <span class="number">1</span>: <span class="number">1</span></span><br><span class="line">                <span class="number">22</span>      BINARY_AND              </span><br><span class="line">                <span class="number">24</span>      LOAD_CONST              <span class="number">1</span>: <span class="number">1</span></span><br><span class="line">                <span class="number">26</span>      COMPARE_OP              <span class="number">2</span> (==)</span><br><span class="line">                <span class="number">28</span>      POP_JUMP_IF_FALSE       <span class="number">42</span></span><br><span class="line">                <span class="number">30</span>      LOAD_FAST               <span class="number">3</span>: res</span><br><span class="line">                <span class="number">32</span>      LOAD_FAST               <span class="number">4</span>: aa</span><br><span class="line">                <span class="number">34</span>      BINARY_MULTIPLY         </span><br><span class="line">                <span class="number">36</span>      LOAD_FAST               <span class="number">2</span>: n</span><br><span class="line">                <span class="number">38</span>      BINARY_MODULO           </span><br><span class="line">                <span class="number">40</span>      STORE_FAST              <span class="number">3</span>: res</span><br><span class="line">                <span class="number">42</span>      LOAD_FAST               <span class="number">4</span>: aa</span><br><span class="line">                <span class="number">44</span>      LOAD_FAST               <span class="number">4</span>: aa</span><br><span class="line">                <span class="number">46</span>      INPLACE_MULTIPLY        </span><br><span class="line">                <span class="number">48</span>      STORE_FAST              <span class="number">4</span>: aa</span><br><span class="line">                <span class="number">50</span>      LOAD_FAST               <span class="number">1</span>: b</span><br><span class="line">                <span class="number">52</span>      LOAD_CONST              <span class="number">1</span>: <span class="number">1</span></span><br><span class="line">                <span class="number">54</span>      INPLACE_RSHIFT          </span><br><span class="line">                <span class="number">56</span>      STORE_FAST              <span class="number">1</span>: b</span><br><span class="line">                <span class="number">58</span>      JUMP_ABSOLUTE           <span class="number">10</span></span><br><span class="line">                <span class="number">60</span>      POP_BLOCK               </span><br><span class="line">                <span class="number">62</span>      LOAD_FAST               <span class="number">3</span>: res</span><br><span class="line">                <span class="number">64</span>      LOAD_FAST               <span class="number">2</span>: n</span><br><span class="line">                <span class="number">66</span>      BINARY_MODULO           </span><br><span class="line">                <span class="number">68</span>      RETURN_VALUE            </span><br><span class="line">        <span class="string">'po'</span></span><br><span class="line">        [Code]</span><br><span class="line">            File Name: /somewhere/encrypt.py</span><br><span class="line">            Object Name: e2</span><br><span class="line">            Arg Count: <span class="number">1</span></span><br><span class="line">            KW Only Arg Count: <span class="number">0</span></span><br><span class="line">            Locals: <span class="number">14</span></span><br><span class="line">            Stack Size: <span class="number">5</span></span><br><span class="line">            Flags: <span class="number">0x00000043</span> (CO_OPTIMIZED | CO_NEWLOCALS | CO_NOFREE)</span><br><span class="line">            [Names]</span><br><span class="line">                <span class="string">'type'</span></span><br><span class="line">                <span class="string">'bytes'</span></span><br><span class="line">                <span class="string">'AssertionError'</span></span><br><span class="line">                <span class="string">'len'</span></span><br><span class="line">                <span class="string">'bytes_to_long'</span></span><br><span class="line">                <span class="string">'gen_prime'</span></span><br><span class="line">                <span class="string">'g'</span></span><br><span class="line">                <span class="string">'next_prime'</span></span><br><span class="line">                <span class="string">'long_to_bytes'</span></span><br><span class="line">                <span class="string">'pow'</span></span><br><span class="line">                <span class="string">'print'</span></span><br><span class="line">                <span class="string">'str'</span></span><br><span class="line">                <span class="string">'digits'</span></span><br><span class="line">                <span class="string">'hex'</span></span><br><span class="line">            [Var Names]</span><br><span class="line">                <span class="string">'m'</span></span><br><span class="line">                <span class="string">'l'</span></span><br><span class="line">                <span class="string">'m1'</span></span><br><span class="line">                <span class="string">'m2'</span></span><br><span class="line">                <span class="string">'p'</span></span><br><span class="line">                <span class="string">'q'</span></span><br><span class="line">                <span class="string">'pp'</span></span><br><span class="line">                <span class="string">'qq'</span></span><br><span class="line">                <span class="string">'e'</span></span><br><span class="line">                <span class="string">'ee'</span></span><br><span class="line">                <span class="string">'n'</span></span><br><span class="line">                <span class="string">'nn'</span></span><br><span class="line">                <span class="string">'c1'</span></span><br><span class="line">                <span class="string">'c2'</span></span><br><span class="line">            [Free Vars]</span><br><span class="line">            [Cell Vars]</span><br><span class="line">            [Constants]</span><br><span class="line">                <span class="literal">None</span></span><br><span class="line">                <span class="number">512</span></span><br><span class="line">                <span class="number">2</span></span><br><span class="line">                <span class="number">1024</span></span><br><span class="line">                <span class="number">2333</span></span><br><span class="line">                <span class="number">65535</span></span><br><span class="line">            [Disassembly]</span><br><span class="line">                <span class="number">0</span>       LOAD_GLOBAL             <span class="number">0</span>: type</span><br><span class="line">                <span class="number">2</span>       LOAD_FAST               <span class="number">0</span>: m</span><br><span class="line">                <span class="number">4</span>       CALL_FUNCTION           <span class="number">1</span></span><br><span class="line">                <span class="number">6</span>       LOAD_GLOBAL             <span class="number">1</span>: bytes</span><br><span class="line">                <span class="number">8</span>       COMPARE_OP              <span class="number">2</span> (==)</span><br><span class="line">                <span class="number">10</span>      POP_JUMP_IF_TRUE        <span class="number">32</span></span><br><span class="line">                <span class="number">12</span>      LOAD_GLOBAL             <span class="number">2</span>: AssertionError</span><br><span class="line">                <span class="number">14</span>      RAISE_VARARGS           <span class="number">1</span></span><br><span class="line">                <span class="number">16</span>      LOAD_GLOBAL             <span class="number">11</span>: str</span><br><span class="line">                <span class="number">18</span>      LOAD_FAST               <span class="number">11</span>: nn</span><br><span class="line">                <span class="number">20</span>      CALL_FUNCTION           <span class="number">31</span></span><br><span class="line">                <span class="number">22</span>      LOAD_CONST              <span class="number">1</span>: <span class="number">512</span></span><br><span class="line">                <span class="number">24</span>      COMPARE_OP              <span class="number">0</span> (&lt;)</span><br><span class="line">                <span class="number">26</span>      POP_JUMP_IF_TRUE        <span class="number">47</span></span><br><span class="line">                <span class="number">28</span>      LOAD_GLOBAL             <span class="number">2</span>: AssertionError</span><br><span class="line">                <span class="number">30</span>      RAISE_VARARGS           <span class="number">1</span></span><br><span class="line">                <span class="number">32</span>      LOAD_GLOBAL             <span class="number">3</span>: len</span><br><span class="line">                <span class="number">34</span>      LOAD_FAST               <span class="number">0</span>: m</span><br><span class="line">                <span class="number">36</span>      CALL_FUNCTION           <span class="number">1</span></span><br><span class="line">                <span class="number">38</span>      LOAD_CONST              <span class="number">2</span>: <span class="number">2</span></span><br><span class="line">                <span class="number">40</span>      BINARY_FLOOR_DIVIDE     </span><br><span class="line">                <span class="number">42</span>      STORE_FAST              <span class="number">1</span>: l</span><br><span class="line">                <span class="number">44</span>      LOAD_GLOBAL             <span class="number">4</span>: bytes_to_long</span><br><span class="line">                <span class="number">46</span>      LOAD_FAST               <span class="number">0</span>: m</span><br><span class="line">                <span class="number">48</span>      LOAD_CONST              <span class="number">0</span>: <span class="literal">None</span></span><br><span class="line">                <span class="number">50</span>      LOAD_FAST               <span class="number">1</span>: l</span><br><span class="line">                <span class="number">52</span>      BUILD_SLICE             <span class="number">2</span></span><br><span class="line">                <span class="number">54</span>      BINARY_SUBSCR           </span><br><span class="line">                <span class="number">56</span>      CALL_FUNCTION           <span class="number">1</span></span><br><span class="line">                <span class="number">58</span>      STORE_FAST              <span class="number">2</span>: m1</span><br><span class="line">                <span class="number">60</span>      LOAD_GLOBAL             <span class="number">4</span>: bytes_to_long</span><br><span class="line">                <span class="number">62</span>      LOAD_FAST               <span class="number">0</span>: m</span><br><span class="line">                <span class="number">64</span>      LOAD_FAST               <span class="number">1</span>: l</span><br><span class="line">                <span class="number">66</span>      LOAD_CONST              <span class="number">0</span>: <span class="literal">None</span></span><br><span class="line">                <span class="number">68</span>      BUILD_SLICE             <span class="number">2</span></span><br><span class="line">                <span class="number">70</span>      BINARY_SUBSCR           </span><br><span class="line">                <span class="number">72</span>      CALL_FUNCTION           <span class="number">1</span></span><br><span class="line">                <span class="number">74</span>      STORE_FAST              <span class="number">3</span>: m2</span><br><span class="line">                <span class="number">76</span>      LOAD_GLOBAL             <span class="number">5</span>: gen_prime</span><br><span class="line">                <span class="number">78</span>      LOAD_CONST              <span class="number">3</span>: <span class="number">1024</span></span><br><span class="line">                <span class="number">80</span>      CALL_FUNCTION           <span class="number">1</span></span><br><span class="line">                <span class="number">82</span>      STORE_FAST              <span class="number">4</span>: p</span><br><span class="line">                <span class="number">84</span>      LOAD_GLOBAL             <span class="number">5</span>: gen_prime</span><br><span class="line">                <span class="number">86</span>      LOAD_CONST              <span class="number">3</span>: <span class="number">1024</span></span><br><span class="line">                <span class="number">88</span>      CALL_FUNCTION           <span class="number">1</span></span><br><span class="line">                <span class="number">90</span>      STORE_FAST              <span class="number">5</span>: q</span><br><span class="line">                <span class="number">92</span>      LOAD_GLOBAL             <span class="number">6</span>: g</span><br><span class="line">                <span class="number">94</span>      LOAD_METHOD             <span class="number">7</span>: next_prime</span><br><span class="line">                <span class="number">96</span>      LOAD_FAST               <span class="number">4</span>: p</span><br><span class="line">                <span class="number">98</span>      LOAD_CONST              <span class="number">4</span>: <span class="number">2333</span></span><br><span class="line">                <span class="number">100</span>     BINARY_ADD              </span><br><span class="line">                <span class="number">102</span>     CALL_METHOD             <span class="number">1</span></span><br><span class="line">                <span class="number">104</span>     STORE_FAST              <span class="number">6</span>: pp</span><br><span class="line">                <span class="number">106</span>     LOAD_GLOBAL             <span class="number">6</span>: g</span><br><span class="line">                <span class="number">108</span>     LOAD_METHOD             <span class="number">7</span>: next_prime</span><br><span class="line">                <span class="number">110</span>     LOAD_FAST               <span class="number">5</span>: q</span><br><span class="line">                <span class="number">112</span>     LOAD_CONST              <span class="number">4</span>: <span class="number">2333</span></span><br><span class="line">                <span class="number">114</span>     BINARY_ADD              </span><br><span class="line">                <span class="number">116</span>     CALL_METHOD             <span class="number">1</span></span><br><span class="line">                <span class="number">118</span>     STORE_FAST              <span class="number">7</span>: qq</span><br><span class="line">                <span class="number">120</span>     LOAD_GLOBAL             <span class="number">6</span>: g</span><br><span class="line">                <span class="number">122</span>     LOAD_METHOD             <span class="number">7</span>: next_prime</span><br><span class="line">                <span class="number">124</span>     LOAD_CONST              <span class="number">5</span>: <span class="number">65535</span></span><br><span class="line">                <span class="number">126</span>     CALL_METHOD             <span class="number">1</span></span><br><span class="line">                <span class="number">128</span>     STORE_FAST              <span class="number">8</span>: e</span><br><span class="line">                <span class="number">130</span>     LOAD_GLOBAL             <span class="number">6</span>: g</span><br><span class="line">                <span class="number">132</span>     LOAD_METHOD             <span class="number">7</span>: next_prime</span><br><span class="line">                <span class="number">134</span>     LOAD_FAST               <span class="number">8</span>: e</span><br><span class="line">                <span class="number">136</span>     CALL_METHOD             <span class="number">1</span></span><br><span class="line">                <span class="number">138</span>     STORE_FAST              <span class="number">9</span>: ee</span><br><span class="line">                <span class="number">140</span>     LOAD_FAST               <span class="number">4</span>: p</span><br><span class="line">                <span class="number">142</span>     LOAD_FAST               <span class="number">5</span>: q</span><br><span class="line">                <span class="number">144</span>     BINARY_MULTIPLY         </span><br><span class="line">                <span class="number">146</span>     STORE_FAST              <span class="number">10</span>: n</span><br><span class="line">                <span class="number">148</span>     LOAD_FAST               <span class="number">6</span>: pp</span><br><span class="line">                <span class="number">150</span>     LOAD_FAST               <span class="number">7</span>: qq</span><br><span class="line">                <span class="number">152</span>     BINARY_MULTIPLY         </span><br><span class="line">                <span class="number">154</span>     STORE_FAST              <span class="number">11</span>: nn</span><br><span class="line">                <span class="number">156</span>     LOAD_GLOBAL             <span class="number">8</span>: long_to_bytes</span><br><span class="line">                <span class="number">158</span>     LOAD_GLOBAL             <span class="number">9</span>: pow</span><br><span class="line">                <span class="number">160</span>     LOAD_FAST               <span class="number">2</span>: m1</span><br><span class="line">                <span class="number">162</span>     LOAD_FAST               <span class="number">8</span>: e</span><br><span class="line">                <span class="number">164</span>     LOAD_FAST               <span class="number">10</span>: n</span><br><span class="line">                <span class="number">166</span>     CALL_FUNCTION           <span class="number">3</span></span><br><span class="line">                <span class="number">168</span>     CALL_FUNCTION           <span class="number">1</span></span><br><span class="line">                <span class="number">170</span>     STORE_FAST              <span class="number">12</span>: c1</span><br><span class="line">                <span class="number">172</span>     LOAD_GLOBAL             <span class="number">8</span>: long_to_bytes</span><br><span class="line">                <span class="number">174</span>     LOAD_GLOBAL             <span class="number">9</span>: pow</span><br><span class="line">                <span class="number">176</span>     LOAD_FAST               <span class="number">3</span>: m2</span><br><span class="line">                <span class="number">178</span>     LOAD_FAST               <span class="number">9</span>: ee</span><br><span class="line">                <span class="number">180</span>     LOAD_FAST               <span class="number">11</span>: nn</span><br><span class="line">                <span class="number">182</span>     CALL_FUNCTION           <span class="number">3</span></span><br><span class="line">                <span class="number">184</span>     CALL_FUNCTION           <span class="number">1</span></span><br><span class="line">                <span class="number">186</span>     STORE_FAST              <span class="number">13</span>: c2</span><br><span class="line">                <span class="number">188</span>     LOAD_GLOBAL             <span class="number">10</span>: <span class="keyword">print</span></span><br><span class="line">                <span class="number">190</span>     LOAD_GLOBAL             <span class="number">11</span>: str</span><br><span class="line">                <span class="number">192</span>     LOAD_FAST               <span class="number">10</span>: n</span><br><span class="line">                <span class="number">194</span>     CALL_FUNCTION           <span class="number">1</span></span><br><span class="line">                <span class="number">196</span>     LOAD_FAST               <span class="number">11</span>: nn</span><br><span class="line">                <span class="number">198</span>     LOAD_METHOD             <span class="number">12</span>: digits</span><br><span class="line">                <span class="number">200</span>     CALL_METHOD             <span class="number">0</span></span><br><span class="line">                <span class="number">202</span>     LOAD_FAST               <span class="number">12</span>: c1</span><br><span class="line">                <span class="number">204</span>     LOAD_FAST               <span class="number">13</span>: c2</span><br><span class="line">                <span class="number">206</span>     BINARY_ADD              </span><br><span class="line">                <span class="number">208</span>     LOAD_METHOD             <span class="number">13</span>: hex</span><br><span class="line">                <span class="number">210</span>     CALL_METHOD             <span class="number">0</span></span><br><span class="line">                <span class="number">212</span>     CALL_FUNCTION           <span class="number">3</span></span><br><span class="line">                <span class="number">214</span>     POP_TOP                 </span><br><span class="line">                <span class="number">216</span>     LOAD_FAST               <span class="number">12</span>: c1</span><br><span class="line">                <span class="number">218</span>     LOAD_FAST               <span class="number">13</span>: c2</span><br><span class="line">                <span class="number">220</span>     BINARY_ADD              </span><br><span class="line">                <span class="number">222</span>     RETURN_VALUE            </span><br><span class="line">        <span class="string">'e2'</span></span><br><span class="line">        <span class="string">'__main__'</span></span><br><span class="line">        <span class="number">2</span></span><br><span class="line">        <span class="number">1</span></span><br><span class="line">        <span class="string">b'ZmxhZ3t0aGlzaXNhZmFrZWZsYWdhZ2Fhc2FzaGRhc2hkc2hkaH0='</span></span><br><span class="line">    [Disassembly]</span><br><span class="line">        <span class="number">0</span>       JUMP_ABSOLUTE           <span class="number">4</span></span><br><span class="line">        <span class="number">2</span>       LOAD_CONST              <span class="number">11</span>: <span class="string">'__main__'</span></span><br><span class="line">        <span class="number">4</span>       LOAD_CONST              <span class="number">0</span>: <span class="number">0</span></span><br><span class="line">        <span class="number">6</span>       LOAD_CONST              <span class="number">1</span>: <span class="literal">None</span></span><br><span class="line">        <span class="number">8</span>       IMPORT_NAME             <span class="number">0</span>: gmpy2</span><br><span class="line">        <span class="number">10</span>      STORE_NAME              <span class="number">1</span>: g</span><br><span class="line">        <span class="number">12</span>      LOAD_CONST              <span class="number">0</span>: <span class="number">0</span></span><br><span class="line">        <span class="number">14</span>      LOAD_CONST              <span class="number">2</span>: (<span class="string">'long_to_bytes'</span>, <span class="string">'bytes_to_long'</span>)</span><br><span class="line">        <span class="number">16</span>      IMPORT_NAME             <span class="number">2</span>: Crypto.Util.number</span><br><span class="line">        <span class="number">18</span>      IMPORT_FROM             <span class="number">3</span>: long_to_bytes</span><br><span class="line">        <span class="number">20</span>      STORE_NAME              <span class="number">3</span>: long_to_bytes</span><br><span class="line">        <span class="number">22</span>      IMPORT_FROM             <span class="number">4</span>: bytes_to_long</span><br><span class="line">        <span class="number">24</span>      STORE_NAME              <span class="number">4</span>: bytes_to_long</span><br><span class="line">        <span class="number">26</span>      POP_TOP                 </span><br><span class="line">        <span class="number">28</span>      LOAD_CONST              <span class="number">0</span>: <span class="number">0</span></span><br><span class="line">        <span class="number">30</span>      LOAD_CONST              <span class="number">1</span>: <span class="literal">None</span></span><br><span class="line">        <span class="number">32</span>      IMPORT_NAME             <span class="number">5</span>: random</span><br><span class="line">        <span class="number">34</span>      STORE_NAME              <span class="number">5</span>: random</span><br><span class="line">        <span class="number">36</span>      LOAD_CONST              <span class="number">3</span>: &lt;CODE&gt; gen_num</span><br><span class="line">        <span class="number">38</span>      LOAD_CONST              <span class="number">4</span>: <span class="string">'gen_num'</span></span><br><span class="line">        <span class="number">40</span>      MAKE_FUNCTION           <span class="number">0</span></span><br><span class="line">        <span class="number">42</span>      STORE_NAME              <span class="number">6</span>: gen_num</span><br><span class="line">        <span class="number">44</span>      LOAD_CONST              <span class="number">5</span>: &lt;CODE&gt; gen_prime</span><br><span class="line">        <span class="number">46</span>      LOAD_CONST              <span class="number">6</span>: <span class="string">'gen_prime'</span></span><br><span class="line">        <span class="number">48</span>      MAKE_FUNCTION           <span class="number">0</span></span><br><span class="line">        <span class="number">50</span>      STORE_NAME              <span class="number">7</span>: gen_prime</span><br><span class="line">        <span class="number">52</span>      LOAD_CONST              <span class="number">7</span>: &lt;CODE&gt; po</span><br><span class="line">        <span class="number">54</span>      LOAD_CONST              <span class="number">8</span>: <span class="string">'po'</span></span><br><span class="line">        <span class="number">56</span>      MAKE_FUNCTION           <span class="number">0</span></span><br><span class="line">        <span class="number">58</span>      STORE_NAME              <span class="number">8</span>: po</span><br><span class="line">        <span class="number">60</span>      LOAD_CONST              <span class="number">9</span>: &lt;CODE&gt; e2</span><br><span class="line">        <span class="number">62</span>      LOAD_CONST              <span class="number">10</span>: <span class="string">'e2'</span></span><br><span class="line">        <span class="number">64</span>      MAKE_FUNCTION           <span class="number">0</span></span><br><span class="line">        <span class="number">66</span>      STORE_NAME              <span class="number">9</span>: e2</span><br><span class="line">        <span class="number">68</span>      LOAD_NAME               <span class="number">10</span>: __name__</span><br><span class="line">        <span class="number">70</span>      LOAD_CONST              <span class="number">11</span>: <span class="string">'__main__'</span></span><br><span class="line">        <span class="number">72</span>      COMPARE_OP              <span class="number">2</span> (==)</span><br><span class="line">        <span class="number">74</span>      POP_JUMP_IF_FALSE       <span class="number">144</span></span><br><span class="line">        <span class="number">76</span>      LOAD_CONST              <span class="number">0</span>: <span class="number">0</span></span><br><span class="line">        <span class="number">78</span>      LOAD_CONST              <span class="number">1</span>: <span class="literal">None</span></span><br><span class="line">        <span class="number">80</span>      IMPORT_NAME             <span class="number">11</span>: sys</span><br><span class="line">        <span class="number">82</span>      STORE_NAME              <span class="number">11</span>: sys</span><br><span class="line">        <span class="number">84</span>      LOAD_NAME               <span class="number">12</span>: len</span><br><span class="line">        <span class="number">86</span>      LOAD_NAME               <span class="number">11</span>: sys</span><br><span class="line">        <span class="number">88</span>      LOAD_ATTR               <span class="number">13</span>: argv</span><br><span class="line">        <span class="number">90</span>      CALL_FUNCTION           <span class="number">1</span></span><br><span class="line">        <span class="number">92</span>      LOAD_CONST              <span class="number">12</span>: <span class="number">2</span></span><br><span class="line">        <span class="number">94</span>      COMPARE_OP              <span class="number">5</span> (&gt;=)</span><br><span class="line">        <span class="number">96</span>      POP_JUMP_IF_FALSE       <span class="number">118</span></span><br><span class="line">        <span class="number">98</span>      LOAD_NAME               <span class="number">9</span>: e2</span><br><span class="line">        <span class="number">100</span>     LOAD_NAME               <span class="number">11</span>: sys</span><br><span class="line">        <span class="number">102</span>     LOAD_ATTR               <span class="number">13</span>: argv</span><br><span class="line">        <span class="number">104</span>     LOAD_CONST              <span class="number">13</span>: <span class="number">1</span></span><br><span class="line">        <span class="number">106</span>     BINARY_SUBSCR           </span><br><span class="line">        <span class="number">108</span>     LOAD_METHOD             <span class="number">14</span>: encode</span><br><span class="line">        <span class="number">110</span>     CALL_METHOD             <span class="number">0</span></span><br><span class="line">        <span class="number">112</span>     CALL_FUNCTION           <span class="number">1</span></span><br><span class="line">        <span class="number">114</span>     POP_TOP                 </span><br><span class="line">        <span class="number">116</span>     JUMP_FORWARD            <span class="number">26</span> (to <span class="number">144</span>)</span><br><span class="line">        <span class="number">118</span>     LOAD_CONST              <span class="number">0</span>: <span class="number">0</span></span><br><span class="line">        <span class="number">120</span>     LOAD_CONST              <span class="number">1</span>: <span class="literal">None</span></span><br><span class="line">        <span class="number">122</span>     IMPORT_NAME             <span class="number">15</span>: base64</span><br><span class="line">        <span class="number">124</span>     STORE_NAME              <span class="number">16</span>: B</span><br><span class="line">        <span class="number">126</span>     LOAD_NAME               <span class="number">16</span>: B</span><br><span class="line">        <span class="number">128</span>     LOAD_METHOD             <span class="number">17</span>: b64decode</span><br><span class="line">        <span class="number">130</span>     LOAD_CONST              <span class="number">14</span>: <span class="string">b'ZmxhZ3t0aGlzaXNhZmFrZWZsYWdhZ2Fhc2FzaGRhc2hkc2hkaH0='</span></span><br><span class="line">        <span class="number">132</span>     CALL_METHOD             <span class="number">1</span></span><br><span class="line">        <span class="number">134</span>     STORE_NAME              <span class="number">18</span>: flag</span><br><span class="line">        <span class="number">136</span>     LOAD_NAME               <span class="number">9</span>: e2</span><br><span class="line">        <span class="number">138</span>     LOAD_NAME               <span class="number">18</span>: flag</span><br><span class="line">        <span class="number">140</span>     CALL_FUNCTION           <span class="number">1</span></span><br><span class="line">        <span class="number">142</span>     POP_TOP                 </span><br><span class="line">        <span class="number">144</span>     LOAD_CONST              <span class="number">1</span>: <span class="literal">None</span></span><br><span class="line">        <span class="number">146</span>     RETURN_VALUE</span><br></pre></td></tr></table></figure><p>都是很简单的代码，稍微熟悉下指令结构就能很快知道代码的功能。</p><p>开始是一个gen_numer的方法：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen_num</span><span class="params">(n_bits)</span>:</span></span><br><span class="line">	res = <span class="number">1</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(n_bits):</span><br><span class="line">		<span class="keyword">if</span> res != <span class="number">0</span>:</span><br><span class="line">			res &lt;&lt;= <span class="number">1</span></span><br><span class="line">			res |= random.choice([<span class="number">0</span>, <span class="number">1</span>])</span><br></pre></td></tr></table></figure><p>然后gem_prime的方法：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen_prime</span><span class="params">(n_bits)</span>:</span></span><br><span class="line">	res = gen_num(n_bits)</span><br><span class="line">	<span class="keyword">while</span> !gmpy2.is_prime(res):</span><br><span class="line">		b = <span class="number">1</span></span><br><span class="line">		<span class="keyword">while</span> b != <span class="number">0</span>:</span><br><span class="line">			res, b = res^b, (res&amp;b) &lt;&lt; <span class="number">1</span></span><br><span class="line">	<span class="keyword">return</span> res</span><br></pre></td></tr></table></figure><p>接着是一个powmod运算：这个它是用模重复平方实现的。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">po</span><span class="params">(a, b, n)</span>:</span></span><br><span class="line">	res = <span class="number">1</span></span><br><span class="line">	aa = a</span><br><span class="line">	<span class="keyword">while</span> b != <span class="number">0</span>:</span><br><span class="line">		<span class="keyword">if</span> b&amp;<span class="number">1</span> == <span class="number">1</span>:</span><br><span class="line">			res = res*aa%n</span><br><span class="line">			aa *= aa</span><br><span class="line">			b &gt;&gt; <span class="number">1</span></span><br><span class="line">	res = res%n</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> res</span><br></pre></td></tr></table></figure><p>再就是本题的关键加密函数e2，从反汇编结果来看这里也是对代码加了混淆的，因为我们的参数是bytes形式的，所以肯定跳过那个异常执行，但是反汇编或反编译器工具就没有那么智能了。</p><p><img src="/2021/08/26/2021%E8%93%9D%E5%B8%BD%E6%80%BB%E5%86%B3%E8%B5%9B/image-20210827161449207.png" alt="image-20210827161449207"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">e2</span><span class="params">(m)</span>:</span></span><br><span class="line">	<span class="keyword">if</span> type(m) == bytes:</span><br><span class="line">		l = len(m)//<span class="number">2</span></span><br><span class="line">		m1 = bytes_to_long(m[:l])</span><br><span class="line">		m2 = bytes_to_long(m[l:])</span><br><span class="line">		p = gen_prime(<span class="number">1024</span>)</span><br><span class="line">		q = gen_prime(<span class="number">1024</span>)</span><br><span class="line">		pp = gmpy2.next_prime(p+<span class="number">2333</span>)</span><br><span class="line">		qq = gmpy2.next_prime(q+<span class="number">2333</span>)</span><br><span class="line">		e = gmpy2.next_prime(<span class="number">65535</span>)</span><br><span class="line">		ee = gmpy2.next_prime(e)</span><br><span class="line">		n = p*q</span><br><span class="line">		nn = pp*qq</span><br><span class="line">		c1 = long_to_bytes(pow(m1, e, n))</span><br><span class="line">		c2 = long_to_bytes(pow(m2, ee, nn))</span><br><span class="line">		print(n)</span><br><span class="line">		print(nn)</span><br><span class="line">		print((c1+c2).hex())</span><br></pre></td></tr></table></figure><p>最后就是main函数的地方：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">	<span class="keyword">if</span> len(sys.argv) &gt;= <span class="number">2</span>:</span><br><span class="line">		e2(sys.argv[<span class="number">1</span>].encode())</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		flag = base64.b64decode(<span class="string">'ZmxhZ3t0aGlzaXNhZmFrZWZsYWdhZ2Fhc2FzaGRhc2hkc2hkaH0='</span>)</span><br><span class="line">		e2(flag)</span><br></pre></td></tr></table></figure><p>至此我将整个pyc文件手动的读代码恢复到了原始的py文件。</p><p>比赛时我也只是关心了那个加密函数e2，生成素数算法就是随机生成素数而已。</p><p>加密就是用2对rsa公钥加密对我们明文分为2组加密，然后密文给了2组公钥的n与nn：</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">p = </span><br><span class="line">q = </span><br><span class="line">pp = gmpy2.next_prime(p+2333)</span><br><span class="line">qq = gmpy2.next_prime(q+2333)</span><br><span class="line">n = p*q</span><br><span class="line">nn = pp*qq</span><br><span class="line"></span><br><span class="line">n与nn已知</span><br></pre></td></tr></table></figure><p>开始还以为可以直接用factor把n分解出来，并不行，比赛时也是卡在了怎么根据以上的条件求解出p，q，pp，qq</p><p>以前在逆向中遇到的rsa都是n可以直接分解的，这次还真就在逆向中放一个要利用信安数学相关知识来分解n的题。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">10300808326934539089496666241808264289631957459372648156286399524715435483257526083909012656240599916663153630994400397551123967736269088895097145175999170121832669199408651009372742448196961434772052680714475103278704994244915332148949308972258132346198706995878511207707020032852291909422169657384059305615332901933166314692127020030962059133945677194815714731744932280037687773557589292839426111679593131496468880818820566335362063945141576571029271455695757725169819071536590541808603312689890186432713168331831945391117398124164372551511615664022982639779869597584768094658974144703654232643726744397158318139843</span> <span class="number">10300808326934539089496666241808264289631957459372648156286399524715435483257526083909012656240599916663153630994400397551123967736269088895097145175999170121832669199408651009372742448196961434772052680714475103278704994244915332148949308972258132346198706995878511207707020032852291909422169657384059306119730985949350246133999803589372738154347587848281413687500584822677442973180875153089761224816081452749380588888095064009160267372694200256546854314017937003988172151851703041691419537865664897608475932582537945754540823276273979713144072687287826518630644255675609067675836382036436064703619178779628644141463</span> <span class="number">22</span>cca5150ca0bb2132f68302dc7441e52b91ae7252e44cc13ed83e58253a9aaaa55e095ba36748dff7ea21fff553f8c4656e77a508b64da054f1381b7e2d0600bcec6ed9e1cc8d14c2362aaef7a972a714f88e5afb2d39e2d77d0c22a449ca2cfb0802c138f20e0ecbd3c174151cdb8e8ca6d89aa3c503615ebfbc851af5ac51dcfa8b5869b775b57a27b9e4346979180d89b303cae2c5d9e6cabb3c9947837bd8f92333532d4b54dd72ea354000600066328f6f4329147df195ec78a7ab9d39973ce0fd6511e7a0de54737bee64476ba531604f0375b08adf7d768c41ba9e2ba88468d126561a134de79dc0217c1c56d219ca6747103618e46f35281feb9e6050c93e32e26e21ee2c3d495f60db2fad9f9a5c570c9f97aee698024ebff6163ef26e32958872db7c593d7f41f90981b8db45aa01085be1e61f7603ecf3d5c032dd90dea791cd9825299548c0cbe7dadabc157048a7fd5cd4bcb1cfeaf0bd2d679f66ceb0b1c33ec04bd20317f872c85d500a3475833f983fdee59b3f61a731e2a8b9a60bd7d840f46e97f06dd4fd8ad1cb4d13a82da01938801c33835ceaf34e1cf62ebdde7ac68b17c2a236b64ffacd2a0e7258571ce570871aea9ff309df63c0a3abcfa0c05d159a82f9fa3f3ad73944e4ae33c3432c8b65c0d6fe9b560220b14abe5886188fc1e6afa4bb4395669618387224422acf20b519af902225e270</span><br></pre></td></tr></table></figure></div><div><ul class="post-copyright"><li class="post-copyright-author"> <strong>Post author:</strong> ooo</li><li class="post-copyright-link"> <strong>Post link:</strong> <a href="https://bxb0.github.io/2021/08/26/2021%E8%93%9D%E5%B8%BD%E6%80%BB%E5%86%B3%E8%B5%9B/" title="2021蓝帽总决赛">https://bxb0.github.io/2021/08/26/2021蓝帽总决赛/</a></li><li class="post-copyright-license"> <strong>Copyright Notice:</strong> All articles in this blog are licensed under<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i> BY-NC-SA</a> unless stating additionally.</li></ul></div><div><div><div style="text-align:center;color:#ccc;font-size:14px">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div></div></div><footer class="post-footer"><div class="post-nav"><div class="post-nav-item"><a href="/2021/08/16/InCTF-2021/" rel="prev" title="InCTF-2021"><i class="fa fa-chevron-left"></i> InCTF-2021</a></div><div class="post-nav-item"> <a href="/2021/09/01/2021WMCTF/" rel="next" title="2021WMCTF">2021WMCTF<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc"> Table of Contents</li><li class="sidebar-nav-overview"> Overview</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#abc"><span class="nav-number">1.</span> <span class="nav-text">abc</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#en"><span class="nav-number">2.</span> <span class="nav-text">en</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><p class="site-author-name" itemprop="name">ooo</p><div class="site-description" itemprop="description">0x446e37fb</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">46</span> <span class="site-state-item-name">posts</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/"><span class="site-state-item-count">15</span> <span class="site-state-item-name">categories</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/"><span class="site-state-item-count">3</span> <span class="site-state-item-name">tags</span></a></div></nav></div><div class="cc-license motion-element" itemprop="license"> <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a></div><div class="links-of-blogroll motion-element"><div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i> Links</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"> <a href="http://i0gan.cn:81/" title="http:&#x2F;&#x2F;i0gan.cn:81&#x2F;" rel="noopener" target="_blank">i0gan</a></li><li class="links-of-blogroll-item"> <a href="https://hack-for.fun/" title="https:&#x2F;&#x2F;hack-for.fun&#x2F;" rel="noopener" target="_blank">M0nk3y</a></li><li class="links-of-blogroll-item"> <a href="http://happi0.gitee.io/" title="http:&#x2F;&#x2F;happi0.gitee.io&#x2F;" rel="noopener" target="_blank">happi0</a></li><li class="links-of-blogroll-item"> <a href="https://vino0o0o.github.io/" title="https:&#x2F;&#x2F;vino0o0o.github.io&#x2F;" rel="noopener" target="_blank">Vino0o0o</a></li></ul></div></div><div class="back-to-top motion-element"><i class="fa fa-arrow-up"></i> <span>0%</span></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> &copy; <span itemprop="copyrightYear">2022</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">ooo</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-chart-area"></i></span> <span class="post-meta-item-text">Symbols count total:</span> <span title="Symbols count total">371k</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-coffee"></i></span> <span class="post-meta-item-text">Reading time total &asymp;</span> <span title="Reading time total">5:38</span></div></div></footer></div><script src="/lib/anime.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script><script type="text/javascript" src="/js/src/clicklove.js"></script><script type="text/javascript" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,model:{jsonPath:"/live2dw/assets/wanko.model.json"},display:{position:"left",width:150,height:300},mobile:{show:!0},log:!1})</script></body></html>