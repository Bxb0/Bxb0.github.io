<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 4.2.1"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/2.ico"><link rel="icon" type="image/png" sizes="16x16" href="/images/2.ico"><link rel="mask-icon" href="/images/logo.svg" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/all.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"bxb0.github.io",root:"/",scheme:"Gemini",version:"7.8.0",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!0,show_result:!0,style:null},back2top:{enable:!0,sidebar:!0,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><meta name="description" content="个人解题赛，做完了逆向题，总排名第5。"><meta property="og:type" content="article"><meta property="og:title" content="2021MRCTF"><meta property="og:url" content="https://bxb0.github.io/2021/04/12/2021MRCTF/index.html"><meta property="og:site_name" content="Bxb0&#39;s blog"><meta property="og:description" content="个人解题赛，做完了逆向题，总排名第5。"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://i.loli.net/2021/04/12/51u7kH9FpMJdqsv.png"><meta property="og:image" content="https://i.loli.net/2021/04/12/NRJXFg6s3hcDoEz.png"><meta property="og:image" content="https://i.loli.net/2021/04/12/MYQAVZPiWKBgCzX.png"><meta property="og:image" content="https://i.loli.net/2021/04/12/u2mL6S4ovfjPykR.png"><meta property="og:image" content="https://i.loli.net/2021/04/12/AJnycbCNZvKH8kF.png"><meta property="og:image" content="https://i.loli.net/2021/04/12/RXUsE7vLtpea9gl.png"><meta property="og:image" content="https://i.loli.net/2021/04/12/2i1PyKHlcACXqog.png"><meta property="og:image" content="https://i.loli.net/2021/04/12/NsBlrSXueFjwH2C.png"><meta property="og:image" content="https://i.loli.net/2021/04/12/szbXIDkcymFJGUo.png"><meta property="og:image" content="https://i.loli.net/2021/04/14/2xEwBcXAsW4thbu.png"><meta property="og:image" content="https://i.loli.net/2021/04/12/wfFu2ZJQS6IL4N1.png"><meta property="og:image" content="https://i.loli.net/2021/04/12/O6b8jr5AfghM9q3.png"><meta property="og:image" content="https://i.loli.net/2021/04/12/FjxvnrsNSMdKLcD.png"><meta property="og:image" content="https://i.loli.net/2021/04/12/f7tDeKoRiP6YsQd.png"><meta property="og:image" content="https://i.loli.net/2021/04/12/CrNxG7igVQHTWja.png"><meta property="og:image" content="https://i.loli.net/2021/04/12/DqVs6Xo5rTMIWlA.png"><meta property="og:image" content="https://i.loli.net/2021/04/12/RC47oJFqrIK2vaN.png"><meta property="og:image" content="https://i.loli.net/2021/04/12/p2RIdzDjMWwXZqG.png"><meta property="og:image" content="https://i.loli.net/2021/04/12/RKEgf5mp1rlGXyQ.png"><meta property="og:image" content="https://i.loli.net/2021/04/12/rtjRiSdXNP5Klcg.png"><meta property="og:image" content="https://i.loli.net/2021/04/12/r5QGPNgA2azXcWR.png"><meta property="og:image" content="https://i.loli.net/2021/04/12/sGjmcnix6TPkBAq.png"><meta property="og:image" content="https://i.loli.net/2021/04/14/mJj6gvVdWCaYAhw.png"><meta property="og:image" content="https://i.loli.net/2021/04/12/EW7mQ3A2kHTtMJc.png"><meta property="og:image" content="https://i.loli.net/2021/04/12/yiX6IH4obUWvgTM.png"><meta property="og:image" content="https://i.loli.net/2021/04/12/65g7iN1jonLYG2D.png"><meta property="og:image" content="https://i.loli.net/2021/04/12/oG3p7UKMH2av6BN.png"><meta property="og:image" content="https://i.loli.net/2021/04/12/b72eDcHfSz43XPd.png"><meta property="og:image" content="https://i.loli.net/2021/04/12/JcSsjlAgELORaku.png"><meta property="article:published_time" content="2021-04-12T12:59:14.000Z"><meta property="article:modified_time" content="2021-05-26T00:41:41.824Z"><meta property="article:author" content="ooo"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://i.loli.net/2021/04/12/51u7kH9FpMJdqsv.png"><link rel="canonical" href="https://bxb0.github.io/2021/04/12/2021MRCTF/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"en"}</script><title>2021MRCTF | Bxb0's blog</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="alternate" href="/atom.xml" title="Bxb0's blog" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="Toggle navigation bar"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">Bxb0's blog</h1><span class="logo-line-after"><i></i></span></a></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul id="menu" class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i> Home</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i> Categories<span class="badge">16</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i> Archives<span class="badge">49</span></a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> Search</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocapitalize="off" placeholder="Searching..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"><div id="no-result"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></div></header><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content post posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en"><link itemprop="mainEntityOfPage" href="https://bxb0.github.io/2021/04/12/2021MRCTF/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.gif"><meta itemprop="name" content="ooo"><meta itemprop="description" content="0x446e37fb"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Bxb0's blog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> 2021MRCTF</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i></span> <span class="post-meta-item-text">Posted on</span> <time title="Created: 2021-04-12 20:59:14" itemprop="dateCreated datePublished" datetime="2021-04-12T20:59:14+08:00">2021-04-12</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i></span> <span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/CTF/" itemprop="url" rel="index"><span itemprop="name">CTF</span></a></span></span><br><span class="post-meta-item" title="Symbols count in article"><span class="post-meta-item-icon"><i class="far fa-file-word"></i></span> <span class="post-meta-item-text">Symbols count in article:</span> <span>10k</span></span><span class="post-meta-item" title="Reading time"><span class="post-meta-item-icon"><i class="far fa-clock"></i></span> <span class="post-meta-item-text">Reading time &asymp;</span> <span>10 mins.</span></span></div></header><div class="post-body" itemprop="articleBody"><p>个人解题赛，做完了逆向题，总排名第5。<a id="more"></a></p><p><img src="https://i.loli.net/2021/04/12/51u7kH9FpMJdqsv.png" alt="image-20210412210153457"></p><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="Real-CHECKIN"><a href="#Real-CHECKIN" class="headerlink" title="Real_CHECKIN"></a>Real_CHECKIN</h3><p>换表base64加密，找到表：abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/</p><p>密文：tvjdvez7D0vSyZbnzv90mf9nuKnurL8YBZiXiseHFq==</p><p>简单写一下换表脚本：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">s = <span class="string">"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/"</span></span><br><span class="line">table = <span class="string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"</span>;</span><br><span class="line">enc = <span class="string">"tvjdvez7D0vSyZbnzv90mf9nuKnurL8YBZiXiseHFq=="</span></span><br><span class="line">ans = enc.translate(str.maketrans(table, s))</span><br><span class="line"></span><br><span class="line">print(base64.b64decode(ans))</span><br><span class="line"></span><br><span class="line"><span class="comment">#MRCTF&#123;wElc0Me_t0_MRCTF_2o21!!!&#125;</span></span><br></pre></td></tr></table></figure><h3 id="Dynamic-Debug"><a href="#Dynamic-Debug" class="headerlink" title="Dynamic Debug"></a>Dynamic Debug</h3><p>来到main函数，首先对输入的字符的长度进行了一个判断：</p><p><img src="https://i.loli.net/2021/04/12/NRJXFg6s3hcDoEz.png" alt="image-20210411224811890"></p><p>到关键函数sub_402500（），不能直接反编译，那就简单的分析一下汇编，开始是花指令之类的东西，后面也就是简单比较输入是否为：MRCTF{IS_THIS_REAL?ASK_YOURSELF}，很明显这是假的。</p><p><img src="https://i.loli.net/2021/04/12/MYQAVZPiWKBgCzX.png" alt="image-20210411225042628"></p><p>调试一波找到对代码修改的地方：其实不关心细节，直接动调跟进我们输入字符后的函数，直接就是解密后的代码，修复一下即可。这里我做题时ida和犯病了一样，动调得到那个解密后的代码怎么都不对，，后面单步步入找原因，再次到达解密后的代码又对了，现在想模拟一下当时出错的情况，看原因，又一直不错（。。</p><p><img src="https://i.loli.net/2021/04/12/u2mL6S4ovfjPykR.png" alt="image-20210411225843676"></p><p>这里手动patch不太方便，还要dump出异或流。就直接动调得到，一个清晰明了的tea结构加密：</p><p><img src="https://i.loli.net/2021/04/12/AJnycbCNZvKH8kF.png" alt="image-20210411230306051"></p><p>解密：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ENC[] = &#123;<span class="number">153</span>, <span class="number">161</span>, <span class="number">133</span>,  <span class="number">85</span>, <span class="number">104</span>,  <span class="number">93</span>, <span class="number">130</span>, <span class="number">126</span>,  <span class="number">57</span>,   <span class="number">0</span>, </span><br><span class="line">   						<span class="number">77</span>, <span class="number">148</span>,  <span class="number">67</span>, <span class="number">105</span>, <span class="number">114</span>, <span class="number">113</span>,   <span class="number">6</span>,  <span class="number">67</span>,  <span class="number">81</span>, <span class="number">106</span>, </span><br><span class="line">   						 <span class="number">0</span>, <span class="number">173</span>,  <span class="number">20</span>,  <span class="number">75</span>,  <span class="number">63</span>,  <span class="number">13</span>, <span class="number">210</span>, <span class="number">100</span>,  <span class="number">21</span>, <span class="number">219</span>, </span><br><span class="line">   						<span class="number">55</span>, <span class="number">159</span></span><br><span class="line">						&#125;;</span><br><span class="line">						</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> v5 = <span class="number">0x6B696C69</span>,</span><br><span class="line">    		 v4 = <span class="number">0x79645F65</span>,</span><br><span class="line">    		 v3 = <span class="number">0x696D616E</span>,</span><br><span class="line">    		 v2 = <span class="number">0x67626463</span>;</span><br><span class="line">    		 </span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">int</span> <span class="title">get_delat</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">int</span> ans = <span class="number">0</span>, delat = <span class="number">0x9E3779B9</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">		ans += delat;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">tea_decode</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">unsigned</span> <span class="keyword">int</span> *enc = (<span class="keyword">unsigned</span> <span class="keyword">int</span> *)(ENC+<span class="number">8</span>*i);</span><br><span class="line">		<span class="keyword">unsigned</span> <span class="keyword">int</span> delat = get_delat();</span><br><span class="line">		<span class="keyword">for</span>(j = <span class="number">31</span>; j &gt;= <span class="number">0</span>; j--)</span><br><span class="line">		&#123;</span><br><span class="line">			enc[<span class="number">1</span>] -= (enc[<span class="number">0</span>] + delat) ^ (enc[<span class="number">0</span>]*<span class="number">16</span>+v3) ^ ((enc[<span class="number">0</span>] &gt;&gt; <span class="number">5</span>)+v2);</span><br><span class="line">			enc[<span class="number">0</span>] -= (enc[<span class="number">1</span>] + delat) ^ (enc[<span class="number">1</span>]*<span class="number">16</span>+v5) ^ ((enc[<span class="number">1</span>] &gt;&gt; <span class="number">5</span>)+v4);</span><br><span class="line">			delat -= <span class="number">0x9E3779B9</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">	</span><br><span class="line">	tea_decode();</span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%c"</span>, ENC[i]);</span><br><span class="line">	&#125; </span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">//MRCTF&#123;Dyn4m1c_d3buG_1s_a_ki11eR&#125;</span></span><br></pre></td></tr></table></figure><h3 id="MR-Register"><a href="#MR-Register" class="headerlink" title="MR_Register"></a>MR_Register</h3><p>考点：Debug Blocker技术。</p><p>程序的关键在子进程。分析方法很多，但绝大多数，只要找到这个技术关键点，静态分析和动调父进程看子进程反馈就好了，如果数据复杂了，可以附加调试看内存加以辅助。</p><p>首先根据函数的特征结构找到main函数，</p><p><img src="https://i.loli.net/2021/04/12/RXUsE7vLtpea9gl.png" alt="image-20210411235747150"></p><p>来看main函数，刚刚开始看的时候疑惑了一会儿，为什么这个在调试状态下才执行程序的关键逻辑，经过后面的创建进程函数发现：其实这里的if else语句就区别了父进程与子进程执行不同的语句，因为创建出的子进程是调试模式运行的。这里关注一下创建进程的<strong>dwCreationFlags</strong>参数，分析程序是将其转换一下枚举的含义好看一些。</p><p><img src="https://i.loli.net/2021/04/12/2i1PyKHlcACXqog.png" alt="image-20210412111156696"></p><blockquote><p>dwCreationFlags标识了影响新进程创建方式的标志：</p><p><strong>DEBUG_PROCESS：如果这个标志被设置，调用进程将被当作一个调试程序，并且新进程会被当作被调试的进程。系统把被调试程序发生的所有调试事件通知给调试器。</strong></p><p><strong>DEBUG_ONLY_THIS_PROCESS：如果这个标志被设置，调用进程将被当作一个调试程序，并且新进程会被当作被调试的进程。系统把被调试程序发生的所有调试事件通知给调试器。</strong></p><p><strong>上面2个不同点在于DEBUG_PROCESS会调试被调试进程以及它的所有子进程，而DEBUG_ONLY_THIS_PROCESS只调试被调试进程，不调试它的子进程。</strong></p></blockquote><p>继续就是分析后面父进程处理子进程异常的部分sub_40188D()：</p><p><img src="https://i.loli.net/2021/04/12/NsBlrSXueFjwH2C.png" alt="image-20210412111950176"></p><p>关键是看DebugEvent.dwDebugEventCode == 1的活动：接受处理来自子进程的异常，进而修改子进程代码。</p><p><img src="https://i.loli.net/2021/04/12/szbXIDkcymFJGUo.png" alt="image-20210412112837615"></p><p>所以现在关键就是要去寻找子进程要执行函数中出现触发异常地方，进而对着父进程处理模块分析。这里我直接调试了下父进程，记录它处理子进程异常的位置和处理方式，随后自己用idapython去patch一下。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">第一次交互：通过除<span class="number">0</span>异常触发</span><br><span class="line"><span class="keyword">for</span> ( i = <span class="number">374</span>; i &gt;= <span class="number">0</span>; --i )</span><br><span class="line">    Buffer[i] ^= Buffer[i + <span class="number">1</span>] ^ i;             <span class="comment">// 对表进行了一个简单异或运算。</span></span><br><span class="line">  Buffer[<span class="number">375</span>] = <span class="number">120</span>;</span><br><span class="line">	rip += <span class="number">2</span>;</span><br><span class="line">	</span><br><span class="line">  </span><br><span class="line">第二次交互：通过int3交互，解密代码。</span><br><span class="line">地址：<span class="number">0x0000401E1C</span></span><br><span class="line"><span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">0x57D</span>; ++i )</span><br><span class="line">    *((_BYTE *)v5 + i) ^= i;</span><br><span class="line">	  </span><br><span class="line">	rip += <span class="number">2</span>;</span><br><span class="line">	</span><br><span class="line">第三次，在patch后的代码第一次遇到int3,触发异常交互：</span><br><span class="line">	rip += <span class="number">2</span></span><br></pre></td></tr></table></figure><p>patch文件，并nop无用的代码：</p><p><img src="https://i.loli.net/2021/04/14/2xEwBcXAsW4thbu.png" alt="mwGU5aZ38l4PAWc"></p><p>随后分析程序的关键流程，也就是子进程执行的，先创建一个文件，将输入进行加密后的数据写入该文件中，最后取出文件中的数据与指定编码数据对比。</p><p>而关键加密函数就是之前patch后的：就是用我们的输入可见字符，因为最高为0，所以只用了7位，分成3 3 1三部分作为index，置换表的过程。这里的email其实并没有作为比较，看到最后用了有一个异或操作，而在最后的比对过程中也有一个同样的操作，就还原了，所以密文就是不经过异或加密后的结果。<br><img src="https://i.loli.net/2021/04/12/wfFu2ZJQS6IL4N1.png" alt="image-20210412114342071"></p><p>最后先爆破，再进行一个bytes.fromhex()，最后一个减法。比赛时赶时间写的，比较水，用python处理起来方便一些。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> enc[] = &#123;<span class="number">71</span>, <span class="number">90</span>, <span class="number">53</span>, <span class="number">121</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">105</span>, <span class="number">71</span>, <span class="number">88</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">53</span>, <span class="number">122</span>, <span class="number">71</span>, <span class="number">88</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">87</span>, <span class="number">72</span>, <span class="number">108</span>, <span class="number">72</span>, <span class="number">108</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">88</span>, <span class="number">53</span>, <span class="number">119</span>, <span class="number">71</span>, <span class="number">86</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">90</span>, <span class="number">53</span>, <span class="number">119</span>, <span class="number">71</span>, <span class="number">89</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">107</span>, <span class="number">53</span>, <span class="number">118</span>, <span class="number">71</span>, <span class="number">106</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">53</span>, <span class="number">120</span>, <span class="number">72</span>, <span class="number">108</span>, <span class="number">53</span>, <span class="number">121</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">87</span>, <span class="number">71</span>, <span class="number">90</span>, <span class="number">53</span>, <span class="number">118</span>, <span class="number">71</span>, <span class="number">87</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">88</span>, <span class="number">71</span>, <span class="number">87</span>, <span class="number">72</span>, <span class="number">108</span>, <span class="number">53</span>, <span class="number">121</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">89</span>, <span class="number">71</span>, <span class="number">106</span>, <span class="number">53</span>, <span class="number">118</span>, <span class="number">71</span>, <span class="number">107</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">105</span>, <span class="number">72</span>, <span class="number">108</span>, <span class="number">71</span>, <span class="number">106</span>, <span class="number">71</span>, <span class="number">90</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">72</span>, <span class="number">108</span>, <span class="number">53</span>, <span class="number">84</span>, <span class="number">72</span>, <span class="number">108</span>, <span class="number">71</span>, <span class="number">86</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">53</span>, <span class="number">122</span>, <span class="number">72</span>, <span class="number">108</span>, <span class="number">71</span>, <span class="number">90</span>, <span class="number">71</span>, <span class="number">89</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">87</span>, <span class="number">71</span>, <span class="number">107</span>, <span class="number">72</span>, <span class="number">108</span>, <span class="number">71</span>, <span class="number">88</span>, <span class="number">71</span>, <span class="number">107</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">88</span>, <span class="number">71</span>, <span class="number">106</span>, <span class="number">71</span>, <span class="number">86</span>, <span class="number">72</span>, <span class="number">109</span>, <span class="number">53</span>, <span class="number">121</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">89</span>, <span class="number">53</span>, <span class="number">121</span>, <span class="number">72</span>, <span class="number">109</span>, <span class="number">71</span>, <span class="number">88</span>, <span class="number">71</span>, <span class="number">106</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">106</span>, <span class="number">71</span>, <span class="number">89</span>, <span class="number">53</span>, <span class="number">118</span>, <span class="number">71</span>, <span class="number">89</span>, <span class="number">72</span>, <span class="number">108</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">53</span>, <span class="number">118</span>, <span class="number">71</span>, <span class="number">87</span>, <span class="number">71</span>, <span class="number">89</span>, <span class="number">53</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">105</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">87</span>, <span class="number">71</span>, <span class="number">86</span>, <span class="number">71</span>, <span class="number">90</span>, <span class="number">53</span>, <span class="number">122</span>, <span class="number">71</span>, <span class="number">105</span>, <span class="number">53</span>, <span class="number">120</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">87</span>, <span class="number">53</span>, <span class="number">118</span>, <span class="number">71</span>, <span class="number">106</span>, <span class="number">71</span>, <span class="number">88</span>, <span class="number">71</span>, <span class="number">105</span>, <span class="number">71</span>, <span class="number">88</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">88</span>, <span class="number">53</span>, <span class="number">118</span>, <span class="number">53</span>, <span class="number">119</span>, <span class="number">71</span>, <span class="number">87</span>, <span class="number">71</span>, <span class="number">88</span>, <span class="number">71</span>, <span class="number">88</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">90</span>, <span class="number">71</span>, <span class="number">105</span>, <span class="number">71</span>, <span class="number">87</span>, <span class="number">71</span>, <span class="number">89</span>, <span class="number">53</span>, <span class="number">119</span>, <span class="number">71</span>, <span class="number">89</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">106</span>, <span class="number">53</span>, <span class="number">84</span>, <span class="number">53</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">105</span>, <span class="number">71</span>, <span class="number">89</span>, <span class="number">71</span>, <span class="number">90</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">53</span>, <span class="number">119</span>, <span class="number">71</span>, <span class="number">90</span>, <span class="number">53</span>, <span class="number">121</span>, <span class="number">72</span>, <span class="number">109</span>, <span class="number">71</span>, <span class="number">105</span>, <span class="number">71</span>, <span class="number">105</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">87</span>, <span class="number">71</span>, <span class="number">88</span>, <span class="number">71</span>, <span class="number">90</span>, <span class="number">72</span>, <span class="number">109</span>, <span class="number">53</span>, <span class="number">122</span>, <span class="number">53</span>, <span class="number">119</span>, <span class="number">72</span>, <span class="number">109</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">87</span>, <span class="number">53</span>, <span class="number">121</span>, <span class="number">72</span>, <span class="number">109</span>, <span class="number">71</span>, <span class="number">107</span>, <span class="number">72</span>, <span class="number">108</span>, <span class="number">71</span>, <span class="number">106</span>, <span class="number">53</span>, <span class="number">121</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">88</span>, <span class="number">53</span>, <span class="number">84</span>, <span class="number">53</span>, <span class="number">122</span>, <span class="number">71</span>, <span class="number">87</span>, <span class="number">71</span>, <span class="number">107</span>, <span class="number">72</span>, <span class="number">109</span>, <span class="number">53</span>, <span class="number">121</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">90</span>, <span class="number">53</span>, <span class="number">121</span>, <span class="number">71</span>, <span class="number">107</span>, <span class="number">72</span>, <span class="number">109</span>, <span class="number">71</span>, <span class="number">86</span>, <span class="number">71</span>, <span class="number">106</span>, <span class="number">53</span>, <span class="number">119</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">107</span>, <span class="number">53</span>, <span class="number">121</span>, <span class="number">71</span>, <span class="number">105</span>, <span class="number">53</span>, <span class="number">118</span>, <span class="number">72</span>, <span class="number">108</span>, <span class="number">71</span>, <span class="number">90</span>, <span class="number">71</span>, <span class="number">87</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">53</span>, <span class="number">120</span>, <span class="number">53</span>, <span class="number">118</span>, <span class="number">53</span>, <span class="number">121</span>, <span class="number">71</span>, <span class="number">89</span>, <span class="number">72</span>, <span class="number">108</span>, <span class="number">53</span>, <span class="number">120</span>, <span class="number">53</span>, <span class="number">121</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">71</span>, <span class="number">87</span>, <span class="number">71</span>, <span class="number">90</span>, <span class="number">72</span>, <span class="number">108</span>, <span class="number">71</span>, <span class="number">88</span>, <span class="number">53</span>, <span class="number">122</span>, <span class="number">71</span>, <span class="number">87</span>, <span class="number">72</span>, <span class="number">108</span>, <span class="number">53</span>, <span class="number">119</span>, <span class="number">69</span>, <span class="number">120</span>&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> table[<span class="number">9</span>][<span class="number">9</span>] = &#123;<span class="string">"ABCDEFGH"</span>, <span class="string">"12345678"</span>, <span class="string">"0IJKLMNO"</span>, <span class="string">"+OPQRStu"</span>, </span><br><span class="line">					<span class="string">"\\vwxyzTU"</span>, <span class="string">"abcdefgh"</span>, <span class="string">"VWXYZijk"</span>, <span class="string">"lmnopqrs"</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i, j, v25, v24, v23, ans1, ans2;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">12</span>; i &lt; <span class="keyword">sizeof</span>(enc)<span class="number">-1</span>; i += <span class="number">2</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span>(j = <span class="number">32</span>; j &lt; <span class="number">127</span>; j++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">char</span> ch = j;</span><br><span class="line">			v25 = (ch &gt;&gt; <span class="number">6</span>) &amp; <span class="number">1</span>;</span><br><span class="line">    		v24 = (ch &gt;&gt; <span class="number">3</span>) &amp; <span class="number">7</span>;</span><br><span class="line">    		v23 =  ch &amp; <span class="number">7</span>;</span><br><span class="line">    		ans1 = table[v25][v24];</span><br><span class="line">    		ans2 = table[v24][v23];</span><br><span class="line">    		</span><br><span class="line">    		<span class="keyword">if</span>(ans1 == enc[i] &amp;&amp; ans2 == enc[i+<span class="number">1</span>])</span><br><span class="line">    		&#123;</span><br><span class="line">    			<span class="built_in">putchar</span>(j);</span><br><span class="line">    			<span class="keyword">break</span>;</span><br><span class="line">    		&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">		</span><br><span class="line">	<span class="comment">//printf("%d %d", ans1, ans2);	</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> enc[<span class="number">100</span>] =</span><br><span class="line">&#123;</span><br><span class="line">  <span class="number">0x4d</span>, <span class="number">0x52</span>, <span class="number">0xe2</span>, <span class="number">0x188</span>, <span class="number">0x2b0</span>, <span class="number">0x4b3</span>, <span class="number">0x7a6</span>, <span class="number">0xc8d</span>, <span class="number">0x14a1</span>, <span class="number">0x218d</span>, <span class="number">0x36a7</span>, <span class="number">0x5864</span>, <span class="number">0x8f80</span>, <span class="number">0xe843</span>, <span class="number">0x17827</span>, <span class="number">0x2609d</span>, <span class="number">0x3d926</span>, <span class="number">0x63a38</span>, <span class="number">0xa13c5</span>, <span class="number">0x104e5c</span>, <span class="number">0x1a6252</span>, <span class="number">0x2ab122</span>, <span class="number">0x4513b3</span>, <span class="number">0x6fc534</span>, <span class="number">0xb4d955</span>, <span class="number">0x1249eb9</span>, <span class="number">0x1d9786d</span>, <span class="number">0x2fe179d</span>, <span class="number">0x4d7906b</span>, <span class="number">0x7d5a841</span>, <span class="number">0xcad38cd</span>, <span class="number">0x1482e18b</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">char</span> flag[<span class="number">100</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> init = enc[<span class="number">0</span>]+enc[<span class="number">1</span>];</span><br><span class="line">	</span><br><span class="line">	flag[<span class="number">0</span>] = enc[<span class="number">0</span>], flag[<span class="number">1</span>] = enc[<span class="number">1</span>];</span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">2</span>; i &lt; <span class="number">100</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		flag[i] = enc[i]-enc[i<span class="number">-1</span>]-enc[i<span class="number">-2</span>];</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++)</span><br><span class="line">		<span class="built_in">putchar</span>(flag[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//MRCTF&#123;C4n_y0u_d3bug_1t?_n0_wa9!&#125;</span></span><br></pre></td></tr></table></figure><h3 id="EzGame"><a href="#EzGame" class="headerlink" title="EzGame"></a>EzGame</h3><p>游戏真好玩。</p><p>之前嘶吼CTF做过一个魔塔的游戏，也是有几个通关条件但更苛刻，但是那个并不是unity3d写的，直接逆向程序看游戏的逻辑找每个关键点还是能分析。这个游戏本身用unity3d写难度就大了很多，还对一个dll进行Themida / Winlicense v3.0.0.0 - 3.0.4.0加壳。</p><p>搞了些时间，没有把程序正常调试起来，开始打用CE的主意。。</p><p>常规的通过星星数的增加，不断再次扫描缩小范围找到存放其值的内存所在的位置。</p><p><img src="https://i.loli.net/2021/04/12/O6b8jr5AfghM9q3.png" alt="image-20210412125603706"></p><p>因为最后获得flag的还有一个条件就是死亡次数不能太多，那就还有一个记录死亡次数的变量，同样的方法找到内存位置。但其它三个条件是否达成标志的内存位置呢。</p><p>这时候我观察我记录下的星星数和死亡次数的内存地址：可以发现这2个内存地址隔的很近，这就让我想到其余判断条件的内存地址也是在这块区域，就在附近。</p><p><img src="https://i.loli.net/2021/04/12/FjxvnrsNSMdKLcD.png" alt="image-20210412130845062"></p><p>开始试探寻找另外三个条件的内存位置。</p><p>因为Eat Cookie是可实现的，所以浏览相关内存区域后我去Eat Cookie，然后看内存变化。</p><p>发现下图中的内存位置变了，然后我以为这个标志是四字节数据，其后面跟着的是6是死亡次数，那再后面的或许就是其余2个条件的标志内存区域吧。</p><p><img src="https://i.loli.net/2021/04/12/f7tDeKoRiP6YsQd.png" alt="image-20210412131401847"></p><p>开始把后面所有的数据作为4字节数据，然后都改为1，回到游戏，发现其余2个条件并没有变为True。。。</p><p>但还有一个条件GoHome也是可以打游戏到达的，到达后再次观察内存变化，发现了端倪，其实3个条件的标志变量是一个字节的数据，也就是存Eat Cookie标志内存地址跟着的2个字节。</p><p>现在把所有条件通过修改内存达成，GetFlag：</p><p><img src="https://i.loli.net/2021/04/12/CrNxG7igVQHTWja.png" alt="image-20210412132340392"></p><p>其实猜也是，不会这样就把flag得到了，，之前嘶吼的魔塔游戏就有很多判断，步数啊，血量，走的路径等各种参数去计算出flag。这个题应该也是这样的。。</p><p>在增加星星数时我之前观察到了后面有8个字节的数据在不断发生变化，而要得到flag就要星星数正确，而星星数又影响那8字节数据，自然想到那8字节数据影响着最后flag。。</p><p>这时候我有2个想法：</p><ul><li><p>一是找方法计算出星星数为105时的8字节数据；</p></li><li><p>二是找到记录所能跳高度的内存位置或记录当前位置的参数，修改后达到外挂一样，将星星数一个一个吃掉。</p></li></ul><p>第二个想法尝试了一下，不断变化位置，并没有在附近的内存中发现变化，倒是发现了记录当前已经跳动步数的内存位置，然后就没有后续了（。。</p><p>然后尝试找出计算8字节数据的方法，，先dump出几组数据观察了一下：发现奇数组和偶数组对应2个不同lfsr结构，关键在于最后一个字节移位（也是一个lfsr结构）后填入新一组的第一个位置。但是不知道每次循环填充到最高的位0或1是怎么计算的决定的。。<br><img src="https://i.loli.net/2021/04/12/DqVs6Xo5rTMIWlA.png" alt="image-20210412135221959"></p><p>其实这里都知道内存的地址了，要是把程序调试起来，通过ce的是什么访问这个地址，得到操作目标数据的指令地址后在调试器中去对应找到关键代码就很简单了，然而这个游戏我没能调试起来。</p><p>但还有一个办法：dump出当时的内存，拖进ida中分析，一样和调试一样。。</p><p>有了这个思路，先是直接定位到最后GetFlag时要进行比较的代码，发现有取出那8字节数据作为key去去进行rc4解密，以为有直接比较key是否正确的地方，但并没有发现。然后又老老实实定位到计算生成key的地方：</p><p><img src="https://i.loli.net/2021/04/12/RC47oJFqrIK2vaN.png" alt="image-20210412184108621"></p><p>上面的算法中有一个未知量，v0，就是要运行的次数，，我是把1-64都打印了出来，在v0 == 8时，得到正确的结果。</p><p>最后就是打印出星星数为105时的目标值：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> init[] = &#123;<span class="number">0x4E</span>, <span class="number">0x51</span>, <span class="number">0x14</span>, <span class="number">0xA1</span>, <span class="number">0xFA</span>, <span class="number">0xEE</span>, <span class="number">0xDB</span>, <span class="number">0xEA</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">fun</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	__int64 v2, v3, v4;</span><br><span class="line">	<span class="keyword">char</span> v5;</span><br><span class="line">	<span class="keyword">unsigned</span> __int64 v6;</span><br><span class="line">	__int64 result;</span><br><span class="line">	<span class="keyword">int</span> v0 = <span class="number">8</span>, i;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">do</span>&#123;</span><br><span class="line">		v2 = <span class="number">0</span>;</span><br><span class="line">    	v3 = <span class="number">0</span>;</span><br><span class="line">    	v4 = <span class="number">1</span>;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">do</span></span><br><span class="line">		&#123;</span><br><span class="line">			v5 = v3++ &amp; <span class="number">0x3f</span>;</span><br><span class="line">			v6 = v4 &amp; (*((__int64 *)init));</span><br><span class="line">			v4 = (v4 &lt;&lt; <span class="number">1</span>) | (v4 &gt;&gt; <span class="number">63</span>);</span><br><span class="line">			v2 ^= v6 &gt;&gt; v5; </span><br><span class="line">			</span><br><span class="line">		&#125;<span class="keyword">while</span>(v3 &lt; <span class="number">64</span>);</span><br><span class="line">		</span><br><span class="line">		result = v2 | <span class="number">2</span>* (*((__int64 *)init));</span><br><span class="line">		(*((__int64 *)init)) = result;</span><br><span class="line">			</span><br><span class="line">		--v0;</span><br><span class="line">	&#125;<span class="keyword">while</span>(v0);</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i, j;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">3</span>; i &lt;= <span class="number">105</span>; i += <span class="number">2</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		fun();</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">8</span>; j++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"%x "</span>, init[j]);</span><br><span class="line">		&#125; </span><br><span class="line">		</span><br><span class="line">		<span class="built_in">putchar</span>(<span class="number">10</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//dd b7 d5 3b 45 51 84 ea</span></span><br></pre></td></tr></table></figure><p>修改游戏内存，得到flag。</p><p><img src="https://i.loli.net/2021/04/12/p2RIdzDjMWwXZqG.png" alt="image-20210412184539407"></p><h3 id="MR-CheckIN"><a href="#MR-CheckIN" class="headerlink" title="MR_CheckIN"></a>MR_CheckIN</h3><p>安卓题，jeb反编译后，在MainActivity的onCreate方法找到调用了一个监听文本框输入的类。也就是当我们输入password长度为39时才将SIGNIN按钮启动。。</p><p><img src="https://i.loli.net/2021/04/12/RKEgf5mp1rlGXyQ.png" alt="image-20210412185333718"></p><p>后面就是处理从文本框输入的内容，username要为MRCTF，然后检查了password的格式MRCTF{}，接着passwd的6-13进行md5加密后与编码的数据比较，这个在线解密一下就好了：<strong>Andr01d</strong>，剩下的数据传入check2函数进行运算检查。</p><p><img src="https://i.loli.net/2021/04/12/rtjRiSdXNP5Klcg.png" alt="image-20210412185731359"></p><p>check2函数就是生成一个密钥序列然后与输入异或后与编码数据比较：<br><img src="https://i.loli.net/2021/04/12/r5QGPNgA2azXcWR.png" alt="image-20210412190659182"></p><p>我开始直接把上面生成密钥序列的next方法复制到java中运行，但得到密钥序列一直不对。。</p><p>然后用了最笨的方法，，单步调试一步一步得到密钥序列，其实把最后那个判断条件改一下，得到这个序列就方便了。。</p><p>密钥序列：<strong>[49, 49, 49, 50, 53, 52, 55, 48, 54, 48, 53, 48, 48, 52, 48, 48, 48, 53, 50, 48, 49, 48, 48, 48, 48]</strong></p><p>最后异或一下：</p><p><img src="https://i.loli.net/2021/04/12/sGjmcnix6TPkBAq.png" alt="image-20210412191628542"></p><h3 id="古神的低语"><a href="#古神的低语" class="headerlink" title="古神的低语"></a>古神的低语</h3><p>魔改过的平坦化混淆，，用脚本没去掉，然后就是硬看了。。</p><p><img src="https://i.loli.net/2021/04/14/mJj6gvVdWCaYAhw.png" alt="image-20210413181523944"></p><p>开始对输入的一些操作，判断长度和对username进行bytes.fromhex()的操作。</p><p><img src="https://i.loli.net/2021/04/12/EW7mQ3A2kHTtMJc.png" alt="image-20210412193243190"></p><p>之后就是那个很大的函数了，记为mixFuction，也是整个题的关键，，什么操作都调用了它。</p><p>首先第一次调试的时候，在内存中找到了二张表，搜索到这是祖冲之序列密码，有密钥与iv。再仔细分析第一次调用那个mixFuction函数，发现传入username的hex.decode的形式和ezivforefolwenc，猜测这是将username作为key，ezivforefolwenc作为iv，进行祖冲序列密码的初始化。</p><p>然后第二次调用mixFunction，传入参数8和一个指针，单步步过这个函数发现生成32字节数据，从传入的参数为8，和这个序列密码的生成密钥流的性质：32位4字节密钥为一个生成单元。我又自己用这个相同的密钥和iv模拟了生成的密钥，然后对比，，果然一样。。</p><p><img src="https://i.loli.net/2021/04/12/yiX6IH4obUWvgTM.png" alt="image-20210412194741393"></p><p>接着调用的一个mixFunction进行了赋值操作，直接单步步过后看变化。</p><p>继续又调用的两次mixFunction传入一个key和输入的passwd，分2次加密，每次加密16字节，分组密码的特征了。单步步入调试mixFunction很卡，，直接对passwd下内存访问断点，发现开始用传入的key和passwd进行一个异或操作，继续F9，又断下来，，一个字节替换操作，而从盒子看，明显aes的s盒，哈哈被发现了，那之前就是初始轮了。</p><p>后面是用之前生成的密钥流加密：</p><p><img src="https://i.loli.net/2021/04/12/65g7iN1jonLYG2D.png" alt="image-20210412200958875"></p><p>其中又调用了mixFunction函数对密钥流进行一个序列操作，调试到关键位置，得到加密算法。</p><p><img src="https://i.loli.net/2021/04/12/oG3p7UKMH2av6BN.png" alt="image-20210412202528482"></p><p>最后还有一个mixFunction：循环移位操作。</p><p><img src="https://i.loli.net/2021/04/12/b72eDcHfSz43XPd.png" alt="image-20210412203433118"></p><p>最后整体上，整个加密就类似tea结构，解密：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> key[<span class="number">4</span>][<span class="number">256</span>][<span class="number">4</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> ENC[] =</span><br><span class="line">&#123;</span><br><span class="line">  <span class="number">208</span>, <span class="number">161</span>, <span class="number">129</span>, <span class="number">188</span>, <span class="number">124</span>, <span class="number">155</span>,   <span class="number">2</span>, <span class="number">228</span>,  <span class="number">47</span>,  <span class="number">51</span>, </span><br><span class="line">   <span class="number">54</span>, <span class="number">232</span>, <span class="number">187</span>,  <span class="number">18</span>, <span class="number">146</span>, <span class="number">244</span>,  <span class="number">18</span>, <span class="number">178</span>, <span class="number">177</span>, <span class="number">115</span>, </span><br><span class="line">  <span class="number">243</span>, <span class="number">219</span>, <span class="number">248</span>, <span class="number">195</span>, <span class="number">252</span>, <span class="number">223</span>, <span class="number">212</span>,  <span class="number">80</span>, <span class="number">220</span>, <span class="number">140</span>, </span><br><span class="line">   <span class="number">91</span>, <span class="number">233</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> enc_stream[] = &#123;<span class="number">3691317505</span>, <span class="number">783378847</span>, <span class="number">3109790973</span>, <span class="number">2450366240</span>,</span><br><span class="line">							 <span class="number">1882631107</span>, <span class="number">1581884682</span>, <span class="number">2916488768</span>, <span class="number">1817239551</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">int</span> <span class="title">mul_2</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">int</span> a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i = <span class="number">0</span>, cnt = <span class="number">0</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		cnt += ((a&gt;&gt;i)&amp;<span class="number">1</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//printf("%d", cnt);</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span>(cnt%<span class="number">2</span> == <span class="number">0</span>)</span><br><span class="line">		<span class="keyword">return</span> a*<span class="number">2</span>;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="keyword">return</span> ((a*<span class="number">2</span>) | <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">gen_key</span><span class="params">(<span class="keyword">int</span> index)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">int</span> i, j, v43, v44;</span><br><span class="line">	</span><br><span class="line">	v44 = enc_stream[<span class="number">2</span>*index], v43 = enc_stream[<span class="number">2</span>*index+<span class="number">1</span>];</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">256</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		v44 = mul_2(v43);</span><br><span class="line">		v43 = mul_2(v44);</span><br><span class="line">		</span><br><span class="line">		key[index][i][<span class="number">0</span>] = v44 &gt;&gt; <span class="number">7</span>;</span><br><span class="line">		key[index][i][<span class="number">1</span>] = v43 &lt;&lt; <span class="number">18</span>;</span><br><span class="line">		key[index][i][<span class="number">2</span>] = v43 &gt;&gt; <span class="number">7</span>;</span><br><span class="line">		key[index][i][<span class="number">3</span>] = v44 &lt;&lt; <span class="number">18</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">int</span> <span class="title">ror</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">int</span> a, <span class="keyword">unsigned</span> <span class="keyword">int</span> i)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">int</span> ans = (a &gt;&gt; i) | (a &lt;&lt; (<span class="number">0x20</span>-i));</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> ans; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i, j;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		gen_key(i);</span><br><span class="line">		<span class="keyword">unsigned</span> <span class="keyword">int</span> tmp;</span><br><span class="line">		<span class="keyword">unsigned</span> <span class="keyword">int</span> *enc = (<span class="keyword">unsigned</span> <span class="keyword">int</span> *)(ENC+<span class="number">8</span>*i);</span><br><span class="line">		tmp = enc[<span class="number">1</span>];</span><br><span class="line">		enc[<span class="number">1</span>] = enc[<span class="number">0</span>];</span><br><span class="line">		enc[<span class="number">0</span>] ^= tmp;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">for</span>(j = <span class="number">255</span>; j &gt;= <span class="number">0</span>; j--)</span><br><span class="line">		&#123;</span><br><span class="line">			enc[<span class="number">1</span>] += ror(enc[<span class="number">0</span>], j&amp;<span class="number">0x1f</span>) ^ key[i][j][<span class="number">1</span>] | key[i][j][<span class="number">0</span>];</span><br><span class="line">			enc[<span class="number">0</span>] += ror(enc[<span class="number">1</span>], j&amp;<span class="number">0x1f</span>) ^ key[i][j][<span class="number">3</span>] | key[i][j][<span class="number">2</span>];	</span><br><span class="line">		&#125;	</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//printf("%x ", ror(0x00C68E92E3, 2));</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%d, "</span>, ENC[i]); </span><br><span class="line">	&#125; </span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>aes解密：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>cry = AES.new(<span class="string">b"ezkeyforenc"</span>+bytes(<span class="number">5</span>), AES.MODE_ECB)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>flag = cry.decrypt(bytes([<span class="number">138</span>, <span class="number">103</span>, <span class="number">149</span>, <span class="number">61</span>, <span class="number">251</span>, <span class="number">35</span>, <span class="number">47</span>, <span class="number">155</span>, <span class="number">4</span>, <span class="number">129</span>, <span class="number">228</span>, <span class="number">119</span>, <span class="number">7</span>, <span class="number">137</span>, <span class="number">132</span>, <span class="number">118</span>, <span class="number">214</span>, <span class="number">137</span>, <span class="number">47</span>, <span class="number">233</span>, <span class="number">229</span>, <span class="number">148</span>, <span class="number">23</span>, <span class="number">181</span>, <span class="number">45</span>, <span class="number">203</span>, <span class="number">80</span>, <span class="number">45</span>, <span class="number">251</span>, <span class="number">101</span>, <span class="number">6</span>, <span class="number">224</span>]))</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>flag</span><br><span class="line"><span class="string">b'really_ez_flatten_obfu_can_u_fix'</span></span><br></pre></td></tr></table></figure><p>最后解密还原得到的一个音频文件，这不杂项。。</p><p>找到这个：</p><p><img src="https://i.loli.net/2021/04/12/JcSsjlAgELORaku.png" alt="image-20210412203830511"></p><p>然后，，，倒放音频听到flag。</p></div><div><ul class="post-copyright"><li class="post-copyright-author"> <strong>Post author:</strong> ooo</li><li class="post-copyright-link"> <strong>Post link:</strong> <a href="https://bxb0.github.io/2021/04/12/2021MRCTF/" title="2021MRCTF">https://bxb0.github.io/2021/04/12/2021MRCTF/</a></li><li class="post-copyright-license"> <strong>Copyright Notice:</strong> All articles in this blog are licensed under<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i> BY-NC-SA</a> unless stating additionally.</li></ul></div><div><div><div style="text-align:center;color:#ccc;font-size:14px">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div></div></div><footer class="post-footer"><div class="post-nav"><div class="post-nav-item"><a href="/2021/04/03/2021%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E8%99%8E%E7%AC%A6%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" rel="prev" title="2021数字中国创新大赛虎符网络安全"><i class="fa fa-chevron-left"></i> 2021数字中国创新大赛虎符网络安全</a></div><div class="post-nav-item"> <a href="/2021/04/17/%E5%BA%94%E7%94%A8%E5%AF%86%E7%A0%81%E5%AD%A6/" rel="next" title="应用密码学">应用密码学<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc"> Table of Contents</li><li class="sidebar-nav-overview"> Overview</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Reverse"><span class="nav-number">1.</span> <span class="nav-text">Reverse</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Real-CHECKIN"><span class="nav-number">1.1.</span> <span class="nav-text">Real_CHECKIN</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Dynamic-Debug"><span class="nav-number">1.2.</span> <span class="nav-text">Dynamic Debug</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MR-Register"><span class="nav-number">1.3.</span> <span class="nav-text">MR_Register</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#EzGame"><span class="nav-number">1.4.</span> <span class="nav-text">EzGame</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MR-CheckIN"><span class="nav-number">1.5.</span> <span class="nav-text">MR_CheckIN</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#古神的低语"><span class="nav-number">1.6.</span> <span class="nav-text">古神的低语</span></a></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><p class="site-author-name" itemprop="name">ooo</p><div class="site-description" itemprop="description">0x446e37fb</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">49</span> <span class="site-state-item-name">posts</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/"><span class="site-state-item-count">16</span> <span class="site-state-item-name">categories</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/"><span class="site-state-item-count">3</span> <span class="site-state-item-name">tags</span></a></div></nav></div><div class="cc-license motion-element" itemprop="license"> <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a></div><div class="links-of-blogroll motion-element"><div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i> Links</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"> <a href="https://i0gan.github.io/" title="https:&#x2F;&#x2F;i0gan.github.io&#x2F;" rel="noopener" target="_blank">i0gan</a></li><li class="links-of-blogroll-item"> <a href="http://pipinstall.cn/" title="http:&#x2F;&#x2F;pipinstall.cn" rel="noopener" target="_blank">ttfpx</a></li><li class="links-of-blogroll-item"> <a href="https://vino0o0o.github.io/" title="https:&#x2F;&#x2F;vino0o0o.github.io&#x2F;" rel="noopener" target="_blank">Vino0o0o</a></li><li class="links-of-blogroll-item"> <a href="https://github.com/Firebasky" title="https:&#x2F;&#x2F;github.com&#x2F;Firebasky" rel="noopener" target="_blank">Firebasky</a></li><li class="links-of-blogroll-item"> <a href="http://xuan.pipinstall.cn/" title="http:&#x2F;&#x2F;xuan.pipinstall.cn&#x2F;" rel="noopener" target="_blank">xuan</a></li><li class="links-of-blogroll-item"> <a href="https://hack-for.fun/" title="https:&#x2F;&#x2F;hack-for.fun&#x2F;" rel="noopener" target="_blank">M0nk3y</a></li><li class="links-of-blogroll-item"> <a href="http://happi0.gitee.io/" title="http:&#x2F;&#x2F;happi0.gitee.io&#x2F;" rel="noopener" target="_blank">happi0</a></li><li class="links-of-blogroll-item"> <a href="https://the_itach1.gitee.io/" title="https:&#x2F;&#x2F;the_itach1.gitee.io&#x2F;" rel="noopener" target="_blank">The_Itach1</a></li></ul></div></div><div class="back-to-top motion-element"><i class="fa fa-arrow-up"></i> <span>0%</span></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> &copy; <span itemprop="copyrightYear">2022</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">ooo</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-chart-area"></i></span> <span class="post-meta-item-text">Symbols count total:</span> <span title="Symbols count total">406k</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-coffee"></i></span> <span class="post-meta-item-text">Reading time total &asymp;</span> <span title="Reading time total">6:09</span></div></div></footer></div><script src="/lib/anime.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script><script type="text/javascript" src="/js/src/clicklove.js"></script><script type="text/javascript" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,model:{jsonPath:"/live2dw/assets/wanko.model.json"},display:{position:"left",width:150,height:300},mobile:{show:!0},log:!1})</script></body></html>